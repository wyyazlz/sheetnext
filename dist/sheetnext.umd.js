/**
 * SheetNext v0.2.0
 * Copyright (c) 2026 www.sheetnext.com
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Homepage: www.sheetnext.com
 * Build Date: 2026-02-28T04:35:48.238Z
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).SheetNext=e()}(this,function(){"use strict";const t={"n":"number","s":"string","inlineStr":"string","str":"string","b":"boolean","e":"error","d":"date"},e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"yyyy/m/d",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"yyyy/m/d h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",27:'yyyy"年"m"月"',28:'m"月"d"日"',29:'m"月"d"日"',30:"m-d-yy",31:'yyyy"年"m"月"d"日"',32:'h"时"mm"分"',33:'h"时"mm"分"ss"秒"',34:'上午/下午h"时"mm"分"',35:'上午/下午h"时"mm"分"ss"秒"',36:'yyyy"年"m"月"',50:'yyyy"年"m"月"',51:'m"月"d"日"',52:'yyyy"年"m"月"',53:'m"月"d"日"',54:'m"月"d"日"',55:'上午/下午h"时"mm"分"',56:'上午/下午h"时"mm"分"ss"秒"',57:'yyyy"年"m"月"',58:'m"月"d"日"'},n={"black":"#000000","red":"#FF0000","green":"#00FF00","blue":"#0000FF","yellow":"#FFFF00","magenta":"#FF00FF","cyan":"#00FFFF","white":"#FFFFFF","color1":"#000000","color2":"#FFFFFF","color3":"#FF0000","color4":"#00FF00","color5":"#0000FF","color6":"#FFFF00","color7":"#FF00FF","color8":"#00FFFF"},i={"=":(t,e)=>t===e,"<>":(t,e)=>t!==e,">":(t,e)=>t>e,"<":(t,e)=>t<e,">=":(t,e)=>t>=e,"<=":(t,e)=>t<=e},r=new Map,o={LITERAL:1,CONDITION:2,COLOR:3,LOCALE:4,DIGIT_0:10,DIGIT_HASH:11,DIGIT_Q:12,DECIMAL:13,THOUSAND:14,PERCENT:15,EXPONENT:16,FRACTION:17,DATE_Y:20,DATE_M:21,DATE_D:22,TIME_H:23,TIME_S:24,TIME_ELAPSED:25,AMPM:26,FILL:30,SKIP:31,AT:32};function a(t,a,h){if(null==t||""===t)return"";if(!a||"General"===a)return"boolean"==typeof t?{text:t?"TRUE":"FALSE",color:null}:"number"==typeof t?{text:s(t),color:null}:{text:String(t),color:null};"number"==typeof a&&(a=e[a]||"General");const u=function(t){if(r.has(t))return r.get(t);const e=function(t){if(!t||"General"===t)return{sections:[{type:"general",tokens:[]}]};const e=[];let i="",r=!1,a=!1;for(let n=0;n<t.length;n++){const o=t[n];'"'===o?r=!r:"["===o?a=!0:"]"===o&&(a=!1),";"!==o||r||a?i+=o:(e.push(i),i="")}return e.push(i),{sections:e.map((t,i)=>function(t,e,i){const r=function(t){const e=[];let i=0,r=t.length;for(;i<r;){const a=t[i];if("["===a){const r=t.indexOf("]",i);if(-1===r){e.push({type:o.LITERAL,value:a}),i++;continue}const s=t.slice(i+1,r),l=s.toLowerCase(),c=s.match(/^([<>=]+)(-?\d+\.?\d*)$/);if(c)e.push({type:o.CONDITION,op:c[1],value:parseFloat(c[2])});else if(n[l])e.push({type:o.COLOR,value:n[l]});else if(s.startsWith("$")){const t=s.match(/^\$([^-]*)-?(.*)$/);e.push({type:o.LOCALE,symbol:t?.[1]||"",code:t?.[2]||""})}else/^[hms]{1,2}$/i.test(s)?e.push({type:o.TIME_ELAPSED,unit:l[0],len:s.length}):e.push({type:o.LITERAL,value:""});i=r+1;continue}if('"'===a){const n=t.indexOf('"',i+1);if(-1===n){i++;continue}e.push({type:o.LITERAL,value:t.slice(i+1,n)}),i=n+1;continue}if("\\"===a&&i+1<r){e.push({type:o.LITERAL,value:t[i+1]}),i+=2;continue}if("*"===a&&i+1<r){e.push({type:o.FILL,value:t[i+1]}),i+=2;continue}if("_"===a&&i+1<r){e.push({type:o.SKIP,value:t[i+1]}),i+=2;continue}const s=t.slice(i).match(/^(AM\/PM|A\/P)/i);if(s){e.push({type:o.AMPM,value:s[0]}),i+=s[0].length;continue}const l=t.slice(i).match(/^(yyyy|yy|y|mmmm|mmm|mm|m|dddd|ddd|dd|d|hh|h|ss|s)/i);if(l){const t=l[0].toLowerCase();let n;"y"===t[0]?n=o.DATE_Y:"m"===t[0]?n=o.DATE_M:"d"===t[0]?n=o.DATE_D:"h"===t[0]?n=o.TIME_H:"s"===t[0]&&(n=o.TIME_S),e.push({type:n,value:t,len:t.length}),i+=l[0].length;continue}if("E"!==a&&"e"!==a||!(i+1<r)||"+"!==t[i+1]&&"-"!==t[i+1]){switch(a){case"0":e.push({type:o.DIGIT_0});break;case"#":e.push({type:o.DIGIT_HASH});break;case"?":e.push({type:o.DIGIT_Q});break;case".":e.push({type:o.DECIMAL});break;case",":e.push({type:o.THOUSAND});break;case"%":e.push({type:o.PERCENT});break;case"/":e.push({type:o.FRACTION});break;case"@":e.push({type:o.AT});break;case" ":e.push({type:o.LITERAL,value:" "});break;case":":e.push({type:o.LITERAL,value:":"});break;case"-":e.push({type:o.LITERAL,value:"-"});break;case"(":case")":case"年":case"月":case"日":case"时":case"分":case"秒":e.push({type:o.LITERAL,value:a});break;default:/[^\s]/.test(a)&&e.push({type:o.LITERAL,value:a})}i++}else e.push({type:o.EXPONENT,sign:t[i+1]}),i+=2}return e}(t),a={tokens:[],condition:null,color:null,locale:null,type:"number"},s=[];for(const n of r)n.type===o.CONDITION?a.condition={op:n.op,value:n.value}:n.type===o.COLOR?a.color=n.value:n.type===o.LOCALE?(a.locale=n,n.symbol&&s.push({type:o.LITERAL,value:n.symbol})):s.push(n);const l=s.some(t=>[o.DATE_Y,o.DATE_D].includes(t.type)),c=s.some(t=>[o.TIME_H,o.TIME_S,o.TIME_ELAPSED,o.AMPM].includes(t.type)),h=s.some(t=>t.type===o.FRACTION);return!s.some(t=>t.type===o.AT)||l||c?a.type=l||c?"datetime":h?"fraction":"number":a.type="text","datetime"===a.type&&function(t){for(let e=0;e<t.length;e++){if(t[e].type!==o.DATE_M)continue;let n=!1;for(let i=e-1;i>=0;i--){const e=t[i].type;if(e===o.TIME_H||e===o.TIME_ELAPSED){n=!0;break}if(e===o.DATE_Y||e===o.DATE_D)break;if([o.DIGIT_0,o.DIGIT_HASH].includes(e))break}if(!n)for(let i=e+1;i<t.length;i++){const e=t[i].type;if(e===o.TIME_S){n=!0;break}if(e===o.DATE_Y||e===o.DATE_D)break;if([o.DIGIT_0,o.DIGIT_HASH].includes(e))break}n&&(t[e].isMinute=!0)}}(s),a.tokens=s,!a.condition&&i<=4&&(1===i?a.condition=null:2===i?a.condition=0===e?{op:">=",value:0}:{op:"<",value:0}:i>=3&&(0===e?a.condition={op:">",value:0}:1===e?a.condition={op:"<",value:0}:2===e&&(a.condition={op:"=",value:0}))),a}(t,i,e.length))}}(t);if(r.size>=200){const t=r.keys().next().value;r.delete(t)}return r.set(t,e),e}(a),d="number"==typeof t?t:parseFloat(t);if(isNaN(d)){const e=u.sections.find(t=>"text"===t.type);return e?{text:l(String(t),e.tokens),color:e.color}:{text:String(t),color:null}}let f,p=u.sections[0];if(u.sections.length>1)for(const e of u.sections)if("text"!==e.type&&(!e.condition||i[e.condition.op]?.(d,e.condition.value))){p=e;break}switch(p.type){case"general":f=s(d);break;case"text":f=l(String(t),p.tokens);break;case"datetime":f=function(t,e){if(isNaN(t))return"";const n=c(t);if(!n)return String(t);const i=24*t*60*60*1e3;let r="",a=e.some(t=>t.type===o.AMPM),s=n.getHours(),l=s%12||12,h=s<12?"AM":"PM";for(const c of e)switch(c.type){case o.DATE_Y:c.len>=4?r+=n.getFullYear():c.len>=2?r+=String(n.getFullYear()%100).padStart(2,"0"):r+=n.getFullYear()%100;break;case o.DATE_M:if(c.isMinute)r+=c.len>=2?String(n.getMinutes()).padStart(2,"0"):n.getMinutes();else{const t=n.getMonth()+1;c.len>=4?r+=["","一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][t]:3===c.len?r+=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t]:2===c.len?r+=String(t).padStart(2,"0"):r+=t}break;case o.DATE_D:const t=n.getDate(),e=n.getDay();c.len>=4?r+=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][e]:3===c.len?r+=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e]:2===c.len?r+=String(t).padStart(2,"0"):r+=t;break;case o.TIME_H:const u=a?l:s;r+=c.len>=2?String(u).padStart(2,"0"):u;break;case o.TIME_S:r+=c.len>=2?String(n.getSeconds()).padStart(2,"0"):n.getSeconds();break;case o.TIME_ELAPSED:const d=Math.floor(i/36e5),f=Math.floor(i/6e4),p=Math.floor(i/1e3);"h"===c.unit?r+=c.len>=2?String(d).padStart(2,"0"):d:"m"===c.unit?r+=c.len>=2?String(f).padStart(2,"0"):f:"s"===c.unit&&(r+=c.len>=2?String(p).padStart(2,"0"):p);break;case o.AMPM:r+=c.value.includes("/")?s<12?c.value.split("/")[0]:c.value.split("/")[1]:h;break;case o.LITERAL:r+=c.value;break;case o.SKIP:r+=" ";break;case o.DECIMAL:r+=".";break;case o.DIGIT_0:const m=n.getMilliseconds();r+=String(Math.floor(m/100));break;case o.FRACTION:r+="/"}return r}(d,p.tokens);break;case"fraction":f=function(t,e){if(isNaN(t))return String(t);const n=t<0,i=Math.abs(t),r=Math.floor(i);let a=i-r;e.some(t=>t.type===o.DIGIT_HASH||t.type===o.DIGIT_0);let s,l,c=e.findIndex(t=>t.type===o.FRACTION),h=e.slice(c+1).filter(t=>[o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q].includes(t.type)),u=0,d=h.length;if(h.every(t=>t.type===o.DIGIT_0)){const t=e.slice(c+1).filter(t=>t.type===o.LITERAL).map(t=>t.value).join("");/^\d+$/.test(t)&&(u=parseInt(t))}if(u>0)l=u,s=Math.round(a*l);else{const t=function(t,e){if(0===t)return[0,1];let n=1,i=0,r=0,o=1,a=t;for(;;){const t=Math.floor(a);let s=t*n+i,l=t*r+o;if(l>e)break;if(i=n,n=s,o=r,r=l,a-t<1e-10)break;a=1/(a-t)}return[n,r]}(a,Math.pow(10,d)-1);s=t[0],l=t[1]}if(s>0){const t=function(t,e){for(t=Math.abs(t),e=Math.abs(e);e;){const n=e;e=t%e,t=n}return t}(s,l);s/=t,l/=t}let f="";return(r>0||0===s)&&(f=String(r),s>0&&(f+=" ")),s>0&&(f+=`${String(s).padStart(d," ")}/${String(l).padStart(d," ")}`),(n&&"0"!==f?"-":"")+f.trim()}(d,p.tokens);break;default:f=function(t,e){if(isNaN(t))return String(t);let n=Math.abs(t),i=t<0,r="",a=e.some(t=>t.type===o.PERCENT),s=e.some(t=>t.type===o.EXPONENT),l=e.some(t=>t.type===o.FILL),c=0,h=!1;for(let d=e.length-1;d>=0;d--){const t=e[d];if([o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q,o.DECIMAL].includes(t.type)){h=!0;break}t.type!==o.THOUSAND||h||c++}a&&(n*=100),c>0&&(n/=Math.pow(1e3,c)),r=s?function(t,e){const n=e.find(t=>t.type===o.EXPONENT),i=n?.sign||"+";let r=0,a=!1;for(const d of e)if(d.type===o.DECIMAL)a=!0;else{if(d.type===o.EXPONENT)break;a&&d.type===o.DIGIT_0&&r++}let s=t.toExponential(r),[l,c]=s.split("e"),h=parseInt(c),u=l+"E";return("+"===i||h>=0)&&(u+=h>=0?"+":""),u+=h,u}(n,e):function(t,e,n=!1){let i=[],r=[],a=!1,s=!1;for(const m of e)m.type!==o.DECIMAL?([o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q].includes(m.type)&&(a?r:i).push(m),m.type!==o.THOUSAND||a||(s=!0)):a=!0;const l=r.length;let c=l>0?t.toFixed(l):Math.round(t).toString(),[h,u=""]=c.split(".");const d=i.filter(t=>t.type===o.DIGIT_0).length||1;if(h=h.padStart(d,"0"),s&&(h=h.replace(/\B(?=(\d{3})+(?!\d))/g,",")),r.length>0){u=u.padEnd(r.length,"0");let t=0;for(let e=r.length-1;e>=0&&r[e].type===o.DIGIT_HASH&&"0"===u[e];e--)t++;t>0&&(u=u.slice(0,-t))}const f=u?h+"."+u:h;if(n)return function(t,e){let n="",i="",r="",a=" ",s="prefix";for(const c of t){if(c.type===o.FILL){a=c.value,s="afterFill";continue}const t=[o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q,o.DECIMAL,o.THOUSAND].includes(c.type);if("prefix"===s)t?s="number":c.type===o.LITERAL?n+=c.value:c.type===o.SKIP&&(n+=" ");else if("afterFill"===s)t?s="number":c.type===o.LITERAL?i+=c.value:c.type===o.SKIP&&(i+=" ");else if("number"===s){if(t)continue;s="suffix",c.type===o.LITERAL?r+=c.value:c.type===o.SKIP?r+=" ":c.type===o.PERCENT&&(r+="%")}else"suffix"===s&&(c.type===o.LITERAL?r+=c.value:c.type===o.SKIP?r+=" ":c.type===o.PERCENT&&(r+="%"))}let l=i+e;return i&&i.trim()&&/^0+(\.0+)?$/.test(e)&&(l=i+e.replace(/[0.]/g," ")),{isAccounting:!0,prefix:n,fill:a,number:l,suffix:r}}(e,f);let p="";for(const m of e)switch(m.type){case o.DIGIT_0:case o.DIGIT_HASH:case o.DIGIT_Q:break;case o.DECIMAL:p+=f,h="",u="";break;case o.THOUSAND:break;case o.PERCENT:p+="%";break;case o.LITERAL:p+=m.value;break;case o.SKIP:p+=" ";break;case o.FILL:p+=m.value}if(!e.some(t=>t.type===o.DECIMAL)){let t=!1,n=!1;for(let i=0;i<e.length;i++){const r=e[i].type;if([o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q].includes(r)){if(!n&&i>0)for(let n=i-1;n>=0;n--){if(e[n].type===o.LITERAL)for(let i=n-1;i>=0;i--)if([o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q].includes(e[i].type)){t=!0;break}if(t)break}n=!0}else e[i].type===o.LITERAL&&(n=!1)}if(t){const t=[];let n=0,i=!1;for(const c of e)[o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q].includes(c.type)?(n++,c.type===o.DIGIT_0&&(i=!0)):c.type===o.THOUSAND||(n>0&&(t.push({type:"digits",count:n,hasZero:i}),n=0,i=!1),c.type===o.LITERAL?t.push({type:"literal",value:c.value}):c.type===o.SKIP?t.push({type:"literal",value:" "}):c.type===o.PERCENT&&t.push({type:"literal",value:"%"}));n>0&&t.push({type:"digits",count:n,hasZero:i});const r=t.filter(t=>"digits"===t.type);let a=h,s=a.length;for(let e=r.length-1;e>=0;e--){const t=r[e];s>=t.count?(t.result=a.slice(s-t.count,s),s-=t.count):s>0?(t.result=a.slice(0,s).padStart(t.count,t.hasZero?"0":""),s=0):t.result=t.hasZero?"0".repeat(t.count):""}s>0&&r.length>0&&(r[0].result=a.slice(0,s)+r[0].result),p="";let l=0;for(const e of t)"digits"===e.type?(p+=r[l].result,l++):p+=e.value}else if(e.findIndex(t=>[o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q].includes(t.type))>=0){let t="",n="",i=!1;for(const r of e)[o.DIGIT_0,o.DIGIT_HASH,o.DIGIT_Q,o.THOUSAND].includes(r.type)?i=!0:r.type!==o.PERCENT?r.type!==o.LITERAL?r.type!==o.SKIP||(i?n+=" ":t+=" "):i?n+=r.value:t+=r.value:n+="%";p=t+h+n}}return p||h}(n,e,l);const u=e.some(t=>t.type===o.LITERAL&&"("===t.value);return i&&!u&&(e.some(t=>t.type===o.LITERAL&&"-"===t.value)||(r&&r.isAccounting?r.number="-"+r.number:r="-"+r)),r}(d,p.tokens)}return f&&f.isAccounting?{text:f.prefix+f.number+f.suffix,color:p.color,accounting:f}:{text:f,color:p.color}}function s(t){if("number"!=typeof t)return String(t??"");if(!isFinite(t))return t>0?"∞":"-∞";if(0===t)return"0";const e=Math.abs(t);if(e>=1e11||e<1e-9&&0!==e)return t.toExponential(5).replace(/\.?0+e/,"E").replace("e","E");let n=t.toPrecision(10);return n.includes(".")&&(n=n.replace(/\.?0+$/,"")),n}function l(t,e){let n="";for(const i of e)i.type===o.AT?n+=t:i.type===o.LITERAL?n+=i.value:i.type===o.SKIP&&(n+=" ");return n||t}function c(t){if("number"!=typeof t||isNaN(t))return null;let e=t;t>60?e-=1:60===t&&(e=59);const n=new Date(1899,11,30),i=Math.floor(e),r=e-i,o=new Date(n);if(o.setDate(o.getDate()+i),r>0){const t=Math.round(24*r*60*60*1e3);o.setTime(o.getTime()+t)}return o}function h(t){if(!(t instanceof Date))return t;const e=new Date(1899,11,30);let n=(t.getTime()-e.getTime())/864e5;return n>=60&&(n+=1),n}function u(t){return"number"==typeof t?c(t):t instanceof Date?h(t):t}const d=(t,e,n,i)=>{const r=Number(n),o=Number(i);switch(e){case"between":return null!==o&&t>=r&&t<=o;case"notBetween":return null!==o&&(t<r||t>o);case"equal":return t===r;case"notEqual":return t!==r;case"greaterThan":return t>r;case"lessThan":return t<r;case"greaterThanOrEqual":return t>=r;case"lessThanOrEqual":return t<=r;default:return!0}};function f(t){if("string"!=typeof t)return t;const e="#"===t.charAt(0)?t.slice(1):t;return 3===e.length?"FF"+e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:6===e.length?"FF"+e:t}function p(t){if(void 0!==t.colorTheme&&null!==t.colorTheme&&""!==t.colorTheme){const e={_$theme:String(t.colorTheme)};return void 0!==t.colorTint&&null!==t.colorTint&&""!==t.colorTint&&(e._$tint=String(t.colorTint)),e}return void 0!==t.colorIndexed&&null!==t.colorIndexed&&""!==t.colorIndexed?{_$indexed:String(t.colorIndexed)}:void 0!==t.colorAuto&&null!==t.colorAuto&&""!==t.colorAuto?{_$auto:String(t.colorAuto)}:t.color?{_$rgb:f(t.color)}:null}function m(t){if(!t||!t.type||"none"===t.type)return!1;if("pattern"===t.type){const e=t.pattern||"none",n=!!t.fgColor||!!t.bgColor;return"none"!==e||n}return!0}function g(t){if(!t)return!1;const e=t=>!(!t||!t.style&&!t.color);return!!(e(t.top)||e(t.right)||e(t.bottom)||e(t.left))||!!t.diagonal&&e(t.diagonal)&&(!0===t.diagonalDown||!0===t.diagonalUp||void 0===t.diagonalDown&&void 0===t.diagonalUp)}function v(t){const e={top:"",right:"",bottom:"",left:"",diagonal:"",...t},n={};["left","right","top","bottom","diagonal"].forEach(t=>{const i=e[t];i?(n[t]={},i.style&&(n[t]._$style=i.style),i.color&&(n[t].color={_$rgb:f(i.color)}),Object.keys(n[t]).length||(n[t]="")):n[t]=""});const i=e.diagonal&&(!0===e.diagonalDown||void 0===e.diagonalDown&&void 0===e.diagonalUp),r=e.diagonal&&!0===e.diagonalUp;return i&&(n._$diagonalDown="1"),r&&(n._$diagonalUp="1"),{key:JSON.stringify(e),node:n}}function y(t,n){const i=function(t,n,i={}){if(!t||0===Object.keys(t).length)return null;const r={_$numFmtId:0,_$fontId:0,_$fillId:0,_$borderId:0,_$xfId:0};if(t.alignment&&(r.alignment={},t.alignment.horizontal&&(r.alignment._$horizontal=t.alignment.horizontal),t.alignment.vertical&&(r.alignment._$vertical=t.alignment.vertical),t.alignment.wrapText&&(r.alignment._$wrapText="1"),t.alignment.shrinkToFit&&(r.alignment._$shrinkToFit="1"),t.alignment.indent&&(r.alignment._$indent=t.alignment.indent),t.alignment.textRotation&&(r.alignment._$textRotation=t.alignment.textRotation)),t.font){const e=t.font,i=JSON.stringify(e);if(n.buildStyle.fonts[i])r._$fontId=n.buildStyle.fonts[i];else{r._$fontId=n.buildStyle.fonts[i]=n.buildStyle.fontC++;const t={};e.bold&&(t.b=""),e.italic&&(t.i=""),e.strike&&(t.strike=""),e.underline&&(t.u="single"===e.underline?"":{_$val:e.underline}),e.size&&(t.sz={_$val:e.size});const o=p(e);o&&(t.color=o),e.name&&(t.name={_$val:e.name}),e.charset&&(t.charset={_$val:e.charset}),e.outline&&(t.outline=""),e.vertAlign&&(t.vertAlign={_$val:e.vertAlign}),n.o.styleSheet.fonts.font.push(t)}r._$applyFont="1"}if(!i.skipFillForTable&&m(t.fill)){const e=t.fill,i=JSON.stringify(e);if(n.buildStyle.fills[i])r._$fillId=n.buildStyle.fills[i];else{r._$fillId=n.buildStyle.fills[i]=n.buildStyle.fillC++;const t={};"pattern"===e.type?(t.patternFill={_$patternType:e.pattern||"solid"},e.fgColor&&(t.patternFill.fgColor={_$rgb:f(e.fgColor)}),e.bgColor&&(t.patternFill.bgColor={_$rgb:f(e.bgColor)})):"gradient"===e.type&&(t.gradientFill={},"path"===e.gradientType&&(t.gradientFill._$type="path"),e.degree&&(t.gradientFill._$degree=e.degree),e.left&&(t.gradientFill._$left=e.left),e.right&&(t.gradientFill._$right=e.right),e.top&&(t.gradientFill._$top=e.top),e.bottom&&(t.gradientFill._$bottom=e.bottom),e.stops&&Array.isArray(e.stops)?t.gradientFill.stop=e.stops.map(t=>{const e={};return e._$position=void 0!==t.position?t.position:0,t.color&&(e.color={_$rgb:f(t.color)}),e}):t.gradientFill.stop=[{_$position:0,color:{_$rgb:"FFFFFFFF"}},{_$position:1,color:{_$rgb:"FF000000"}}]),n.o.styleSheet.fills.fill.push(t)}r._$applyFill="1"}if(g(t.border)){const e=v(t.border),i=e.key;n.buildStyle.borders[i]?r._$borderId=n.buildStyle.borders[i]:(r._$borderId=n.buildStyle.borders[i]=n.buildStyle.borderC++,n.o.styleSheet.borders.border.push(e.node)),r._$applyBorder="1"}if(t.numFmt){const i=t.numFmt,o=JSON.stringify(i);if(n.buildStyle.numFmts[o])r._$numFmtId=n.buildStyle.numFmts[o];else{const t=Object.entries(e).find(([t,e])=>e===i)?.[0];t?r._$numFmtId=t:(r._$numFmtId=n.buildStyle.numFmtC++,n.o.styleSheet.numFmts.numFmt.push({_$numFmtId:r._$numFmtId,_$formatCode:i})),n.buildStyle.numFmts[o]=r._$numFmtId}r._$applyNumberFormat="1"}if(t.protection){const e={};!1===t.protection.locked&&(e._$locked="0"),!0===t.protection.hidden&&(e._$hidden="1"),Object.keys(e).length>0&&(r.protection=e,r._$applyProtection="1")}return r}(t,n);if(!i)return null;const r=JSON.stringify(i);if(null!=n.buildStyle.xf[r])return n.buildStyle.xf[r];{const t=n.buildStyle.xf[r]=n.buildStyle.xfC++;return n.o.styleSheet.cellXfs.xf.push(i),t}}class b{constructor(t,e,n){this.cIndex=n,this.row=e,this.$=e.$,this.S=t??{},this.isMerged=!1,this.master=null,this.F=null,this._=null,this.O=void 0,this.P=void 0,this.B=void 0,this.H=void 0,this.U=void 0,this.K=void 0,this.W=null,this.j=null,this.q=null,this.G=null,this.Y=!1,this.J()}J(){let{_$t:e,v:n,f:i,is:r}=this.S;this.P=t[e],this.P||(/[dmyhs]/i.test((this.numFmt??"").replaceAll("[Red]",""))?this.P=void 0:this.P="number");const o=this.type;if(i){if("string"==typeof i)this.B=`=${i}`;else if("shared"===i._$t)if(i["#text"])this.$.et[i._$si]={m:{r:this.row.rIndex,c:this.cIndex},f:i["#text"]},this.B=`=${i["#text"]}`;else{const t=this.$.et[i._$si],e=this.$.Utils.getFillFormula(t.f,t.m.r,t.m.c,this.row.rIndex,this.cIndex);this.B=`=${e??"公式加载错误"}`}else this.B=`=${i?.["#text"]??""}`;this.H=["date","dateTime","time","number"].includes(o)&&n?Number(n):n}else{if(n||r)if("s"===e){const t=this.$.Xml.nt(n);this.B=t.text,t.richText&&(this.W=t.richText)}else if("inlineStr"===e)if(r?.r){const t=Array.isArray(r.r)?r.r:[r.r],e=[];let n=!1;for(const i of t){const t="string"==typeof i.t?i.t:i.t?.["#text"]??"",r=this.$.Xml.it(i.rPr);r&&(n=!0),e.push({text:t,font:r||{}})}this.B=e.map(t=>t.text).join(""),n&&(this.W=e)}else this.B=r?.t??r;else this.B=e&&"n"!=e?n:Number(n);else this.B="";["date","dateTime","time"].includes(o)&&this.B?(this.H=this.B,this.B=u(Number(this.B))):this.H=this.B}"string"==typeof this.H&&(this.H=this.$.Utils.decodeEntities(this.H)),"string"==typeof this.B&&(this.B=this.$.Utils.decodeEntities(this.B))}set editVal(t){const e=this.B,n=this.P;if(this.$.Event.emit("beforeCellEdit",{cell:this,sheet:this.row.sheet,row:this.row.rIndex,col:this.cIndex,oldValue:e,newValue:t}).canceled)return;if("manual"!==this.$.calcMode&&(this.H=void 0,this.U=void 0,this.K=void 0),this.W&&(this.W=null),null==t||""===t||null==t||Number.isNaN(t))this.P=void 0,this.B="";else if(isNaN(t))if(t?.trim?.().startsWith("="))this.B=t.trim(),this.P=void 0;else if(/^(true|false)$/i.test(t))this.B="TRUE"==t.toUpperCase(),this.P="boolean";else{const{date:e,numfmt:n,type:i}=function(t){if("string"!=typeof t)return null;const e=(new Date).getFullYear(),n=[[/^(\d{4})[-\/](\d{1,2})[-\/](\d{1,2})(?: (\d{1,2}):(\d{1,2})(?::(\d{1,2}))?)?$/,(t,e,n,i=0,r=0,o=0)=>{const a=i||r||o;return{date:new Date(t,e-1,n,i,r,o),numfmt:a?o?"yyyy/m/d h:mm:ss":"yyyy/m/d h:mm":"yyyy/m/d",type:a?"dateTime":"date"}}],[/^(\d{4})年(\d{1,2})月(\d{1,2})日$/,(t,e,n)=>({date:new Date(t,e-1,n),numfmt:'yyyy"年"m"月"d"日"',type:"date"})],[/^(\d{4})年(\d{1,2})月$/,(t,e)=>({date:new Date(t,e-1,1),numfmt:'yyyy"年"m"月"',type:"date"})],[/^(\d{1,2})月(\d{1,2})日$/,(t,n)=>({date:new Date(e,t-1,n),numfmt:'m"月"d"日"',type:"date"})],[/^(\d{1,2})[-\/](\d{1,2})$/,(t,n)=>({date:new Date(e,t-1,n),numfmt:"m/d",type:"date"})]];for(const[i,r]of n){const e=t.match(i);if(e)return r(...e.slice(1).map(t=>void 0===t?t:+t))}return null}(t)??{};e?(this.B=e,this.P=i,this.style.numFmt||(this.style.numFmt=n)):/^\d{1,2}:\d{1,2}(:\d{1,2})?$/.test(t)?(this.B=new Date(`1899/12/31 ${t}`),this.P="time",this.style.numFmt||(this.style.numFmt="h:mm")):(this.B=t,this.P="string")}else this.B=parseFloat(t),this.P=void 0;const i=this.B,r=this.P;if(e===i&&n===r)return;const o=this.row.sheet;this.$.st("cellEdit",{sheet:o,cell:this,row:this.row.rIndex,col:this.cIndex,oldValue:e,newValue:i,oldType:n,newType:r},()=>{const t="string"==typeof e&&e.startsWith("="),a=this.isFormula;if(t&&this.ot(),this.$.DependencyGraph&&((t||a)&&this.$.DependencyGraph.updateDependencies(this),e!==i)){const t=this.row.sheet.name;this.$.DependencyGraph.notifyChange(t,this.row.rIndex,this.cIndex)}e!==i&&this.row.sheet.Sparkline&&this.row.sheet.Sparkline.clearAllCache(),e!==i&&this.row.sheet.CF&&this.row.sheet.CF.clearAllCache(),e!==i&&this.row.sheet.Drawing&&this.row.sheet.Drawing.ct();const s={undo:()=>{this.B=e,this.P=n,this.H=void 0,this.U=void 0,this.K=void 0,this.$.DependencyGraph&&(this.$.DependencyGraph.updateDependencies(this),this.$.DependencyGraph.notifyChange(this.row.sheet.name,this.row.rIndex,this.cIndex)),this.row.sheet.Sparkline&&this.row.sheet.Sparkline.clearAllCache(),this.row.sheet.CF&&this.row.sheet.CF.clearAllCache(),this.row.sheet.Drawing&&this.row.sheet.Drawing.ct()},redo:()=>{this.B=i,this.P=r,this.H=void 0,this.U=void 0,this.K=void 0,this.$.DependencyGraph&&(this.$.DependencyGraph.updateDependencies(this),this.$.DependencyGraph.notifyChange(this.row.sheet.name,this.row.rIndex,this.cIndex)),this.row.sheet.Sparkline&&this.row.sheet.Sparkline.clearAllCache(),this.row.sheet.CF&&this.row.sheet.CF.clearAllCache(),this.row.sheet.Drawing&&this.row.sheet.Drawing.ct()}};o===this.$.activeSheet&&(s.activeCell={r:this.row.rIndex,c:this.cIndex}),this.$.UndoRedo.add(s),this.$.ht({type:"cellEdit",sheet:o,row:this.row.rIndex,col:this.cIndex,oldValue:e,newValue:i,oldType:n,newType:r}),this.$.Event.emit("afterCellEdit",{cell:this,sheet:o,row:this.row.rIndex,col:this.cIndex,oldValue:e,newValue:i})},{cancelable:!1})}get editVal(){if(this.B instanceof Date&&this.numFmt){const t=this.type;return"date"==t?this.B.toLocaleDateString():"time"==t?this.B.toLocaleTimeString():this.B.toLocaleString()}return this.B?.toString()??""}get richText(){return this.W}set richText(t){const e=this.W,n=this.B;this.W=t,this.U=void 0,this.H=void 0,this.K=void 0,t&&(this.B=t.map(t=>t.text).join("")),this.$.UndoRedo.add({undo:()=>{this.W=e,this.B=n,this.U=void 0,this.H=void 0,this.K=void 0},redo:()=>{this.W=t,this.B=t?t.map(t=>t.text).join(""):n,this.U=void 0,this.H=void 0,this.K=void 0}})}get showVal(){return null!=this.U?this.U:"boolean"==this.type?this.U=this.calcVal?"TRUE":"FALSE":"error"==this.P?this.U=this.calcVal??"":this.numFmt||["date","time","dateTime"].includes(this.P)?(this.K=a(this.calcVal,this.numFmt,this.P),this.U=(this.K?.text??"")+""):this.U=String(this.calcVal)}get accountingData(){return void 0===this.U&&this.showVal,this.K?.accounting}get calcVal(){if(null!=this.H)return this.H;if(this.q&&this.G){const t=this.q.calcVal;if(Array.isArray(t)&&Array.isArray(t[0])){const{r:e,c:n}=this.G;return this.H=t[e]?.[n]??""}return this.H=""}if(this.isFormula){let t=this.$.Formula.calcFormula(this.editVal.trim().substring(1),this);if(this.ut(),Array.isArray(t)&&Array.isArray(t[0])){const e=t.length,n=t[0].length;if(e>1||n>1){const i=this.row.sheet;let r=!1;for(let t=0;t<e&&!r;t++)for(let e=0;e<n&&!r;e++){if(0===t&&0===e)continue;const n=i.getCell(this.row.rIndex+t,this.cIndex+e);n&&void 0!==n.B&&""!==n.B&&n.q!==this&&(r=!0)}if(r)return this.H="#SPILL!";this.j={rows:e,cols:n},this.ft();for(let t=0;t<e;t++)for(let e=0;e<n;e++){if(0===t&&0===e)continue;const n=i.getCell(this.row.rIndex+t,this.cIndex+e);n&&(n.q=this,n.G={r:t,c:e},n.H=void 0,n.U=void 0)}return this.H=t[0][0]}return this.H=t[0][0]}return this.$.Formula.lastResultIsDate&&"number"==typeof t&&(this.numFmt||(t<1?(this.numFmt="h:mm",this.P="time"):Number.isInteger(t)?(this.numFmt="yyyy/m/d",this.P="date"):(this.numFmt="yyyy/m/d h:mm:ss",this.P="dateTime"))),t instanceof Error?(this.P="error",this.H=t.message):this.H=t}return this.B instanceof Date?this.H=u(this.B):this.H=this.B}ft(){if(!this.j)return;const t=this.row.sheet,{rows:e,cols:n}=this.j;for(let i=0;i<e;i++)for(let e=0;e<n;e++){if(0===i&&0===e)continue;const n=t.getCell(this.row.rIndex+i,this.cIndex+e);n&&n.q===this&&(n.q=null,n.G=null,n.H=void 0,n.U=void 0)}this.j=null}ut(){if(!this.$.DependencyGraph)return;const t=this.$.Formula.lastCalcVolatile,e=this.row.sheet.name;t&&!this.Y?(this.Y=!0,this.$.DependencyGraph.registerVolatile(e,this.row.rIndex,this.cIndex)):!t&&this.Y&&(this.Y=!1,this.$.DependencyGraph.unregisterVolatile(e,this.row.rIndex,this.cIndex))}ot(){this.Y&&this.$.DependencyGraph&&(this.Y=!1,this.$.DependencyGraph.unregisterVolatile(this.row.sheet.name,this.row.rIndex,this.cIndex))}get spillArray(){if(!this.j||!this.isFormula)return null;const t=this.$.Formula.calcFormula(this.editVal.trim().substring(1),this);return Array.isArray(t)?t:null}get isSpillSource(){return null!==this.j}get isSpillRef(){return null!==this.q}get horizontalAlign(){if(this.alignment?.horizontal)return this.alignment.horizontal;if("@"===this.numFmt)return"left";if(""===this.B||null==this.B)return"left";const t=this.type;return["date","dateTime","time","number"].includes(t)?"right":["error","boolean"].includes(t)?"center":"left"}get verticalAlign(){return this.alignment?.vertical||"center"}get hyperlink(){return this.F}set hyperlink(t){const e=this.F?{...this.F}:null,n=!e&&t&&Object.keys(t).length>0;if(n&&this.$.Event.hasListeners("beforeHyperlinkInsert")&&this.$.Event.emit("beforeHyperlinkInsert",{sheet:this.row.sheet,cell:this,row:this.row.rIndex,col:this.cIndex,hyperlink:t}).canceled)return;t&&0!=Object.keys(t).length?(this.F={...t},this.font={color:"#336699",underline:"single"}):this.F=null;const i=this.F?{...this.F}:null;this.$.UndoRedo.add({undo:()=>{this.F=e},redo:()=>{this.F=i}}),n&&this.$.Event.hasListeners("afterHyperlinkInsert")&&this.$.Event.emit("afterHyperlinkInsert",{sheet:this.row.sheet,cell:this,row:this.row.rIndex,col:this.cIndex,hyperlink:i})}get dataValidation(){return this._}set dataValidation(t){const e=JSON.parse(JSON.stringify(this._));let n=null;t&&Object.keys(t).length>0&&(n="list"==t.type?{showDropDown:!0,showErrorMessage:!0,showInputMessage:!0,...t}:{showInputMessage:!0,showErrorMessage:!0,...t}),this._=n,this.$.UndoRedo.add({undo:()=>{this._=e},redo:()=>{this._=n}})}get protection(){const t=this.style?.protection;return t?{locked:!1!==t.locked,hidden:!!t.hidden}:{locked:!0,hidden:!1}}set protection(t){const e=this.O?.protection?{...this.O.protection}:null;let n=null;if(t&&"object"==typeof t){const e=Object.prototype.hasOwnProperty.call(t,"locked")?!!t.locked:void 0,i=Object.prototype.hasOwnProperty.call(t,"hidden")?!!t.hidden:void 0;!1!==e&&!0!==i||(n={},void 0!==e&&(n.locked=e),void 0!==i&&(n.hidden=i))}this.O||(this.O={}),n?this.O.protection=n:this.O?.protection&&delete this.O.protection;const i=this.O?.protection?{...this.O.protection}:null;this.$.UndoRedo.add({undo:()=>{this.O||(this.O={}),e?this.O.protection={...e}:delete this.O.protection},redo:()=>{this.O||(this.O={}),i?this.O.protection={...i}:delete this.O.protection}})}get isLocked(){return!1!==this.protection.locked}get validData(){if(!this._)return!0;const t=this.calcVal,{type:e,operator:n,formula1:i,formula2:r,allowBlank:o}=this._,a=n||(["whole","decimal","date","time","textLength"].includes(e)&&r?"between":n);if(o&&(""===t||null==t))return!0;switch(e){case"list":return i.includes(t.toString());case"whole":return!!Number.isInteger(Number(t))&&d(Number(t),a,i,r);case"decimal":return!isNaN(Number(t))&&d(Number(t),a,i,r);case"textLength":return d(t.toString().length,a,i,r);case"custom":default:return!0;case"date":return t instanceof Date&&d(t.getTime(),a,new Date(i).getTime(),new Date(r).getTime());case"time":if(!(t instanceof Date))return!1;const e=3600*t.getHours()+60*t.getMinutes()+t.getSeconds(),n=new Date("1970/1/1 "+i),o=new Date("1970/1/1 "+r);return d(e,a,3600*n.getHours()+60*n.getMinutes()+n.getSeconds(),3600*o.getHours()+60*o.getMinutes()+o.getSeconds())}}get isFormula(){return"string"==typeof this.B&&this.B.startsWith("=")}get type(){if(this.P)return this.P;const t=this.calcVal;if("boolean"==typeof t)return this.P="boolean";if(/[dmyhs]/i.test(this.numFmt??"")){const t=this.numFmt,e=t.includes("h")||t.includes("s"),n=t.includes("y")||t.includes("d");return this.P=e&&n?"dateTime":e?"time":n?"date":"dateTime"}return null==t||"string"==typeof t&&""===t.trim()||isNaN(t)?this.B instanceof Error?this.P="error":this.P="string":this.P="number"}set type(t){this.P=t}get style(){return null!=this.O?this.O:this.S._$s?this.O=this.$.Xml.dt(this.S._$s):this.O={}}set style(t){const e=JSON.parse(JSON.stringify(this.O??{}));this.$.Event.hasListeners("beforeCellStyleChange")&&this.$.Event.emit("beforeCellStyleChange",{sheet:this.row.sheet,cell:this,row:this.row.rIndex,col:this.cIndex,oldStyle:e,newStyle:t}).canceled||(this.O=t??{},this.$.UndoRedo.add({undo:()=>{this.O=e},redo:()=>{this.O=t}}),this.$.Event.hasListeners("afterCellStyleChange")&&this.$.Event.emit("afterCellStyleChange",{sheet:this.row.sheet,cell:this,row:this.row.rIndex,col:this.cIndex,oldStyle:e,newStyle:t}))}get border(){const t=this.style?.border;if(t)return t;const e=this.row.sheet;if(!e.bt.size&&!e.yt.size)return{};const n=e.bt.has(this.row.rIndex)?this.row.wt?.border:null,i=e.yt.has(this.cIndex)?e.cols[this.cIndex]?.xt?.border:null;return n||i?n&&!i?n:!n&&i?i:{...i,...n}:{}}set border(t){0==Object.keys(t??{}).length&&(t=null);const e=JSON.parse(JSON.stringify(this.style.border??{}));if(t){const e=this.style.border=this.style.border||{};Object.keys(t).forEach(n=>{const i=t[n];["top","right","bottom","left","diagonal"].includes(n)?i&&"object"==typeof i?e[n]={color:"#000000",style:"thin",...e[n]??{},...i}:delete e[n]:"diagonalUp"!==n&&"diagonalDown"!==n?null==i?delete e[n]:e[n]=i:null==i?delete e[n]:e[n]=!!i}),Object.keys(e).length||delete this.style.border}else delete this.style.border;const n=JSON.parse(JSON.stringify(this.style.border??{}));this.$.UndoRedo.add({undo:()=>{this.style.border=e},redo:()=>{this.style.border=n}})}get fill(){const t=this.style?.fill;if(t)return t;const e=this.row.sheet;if(!e.bt.size&&!e.yt.size)return{};const n=e.bt.has(this.row.rIndex)?this.row.wt?.fill:null,i=e.yt.has(this.cIndex)?e.cols[this.cIndex]?.xt?.fill:null;return n||i?n&&!i?n:!n&&i?i:{...i,...n}:{}}set fill(t){0==Object.keys(t??{}).length&&(t=null);const e=JSON.parse(JSON.stringify(this.style.fill??{}));if(t){const e={...this.O.fill??{},...t},n=Object.prototype.hasOwnProperty.call(t,"fgColor")&&void 0!==t.fgColor&&null!==t.fgColor&&""!==t.fgColor,i=Object.prototype.hasOwnProperty.call(t,"type"),r=Object.prototype.hasOwnProperty.call(t,"pattern");n&&(i||(e.type="pattern"),r||(e.pattern="solid")),!e.type&&(e.pattern||e.fgColor||e.bgColor)&&(e.type="pattern"),"pattern"!==e.type||e.pattern||(e.pattern="solid"),this.O.fill=e}else delete this.O.fill;const n=JSON.parse(JSON.stringify(this.O.fill??{}));this.$.UndoRedo.add({undo:()=>{this.style.fill=e},redo:()=>{this.style.fill=n}})}get font(){const t=this.style?.font;if(t)return t;const e=this.row.sheet;if(!e.bt.size&&!e.yt.size)return{};const n=e.bt.has(this.row.rIndex)?this.row.wt?.font:null,i=e.yt.has(this.cIndex)?e.cols[this.cIndex]?.xt?.font:null;return n||i?n&&!i?n:!n&&i?i:{...i,...n}:{}}set font(t){0==Object.keys(t??{}).length&&(t=null);const e=JSON.parse(JSON.stringify(this.style.font??{}));if(t){const e={...this.O.font,...t};Object.prototype.hasOwnProperty.call(t,"color")&&(delete e.colorTheme,delete e.colorTint,delete e.colorIndexed,delete e.colorAuto),this.style.font=e}else delete this.style.font;const n=JSON.parse(JSON.stringify(this.style.font??{}));this.$.UndoRedo.add({undo:()=>{this.style.font=e},redo:()=>{this.style.font=n}})}get alignment(){const t=this.style?.alignment;if(t)return t;const e=this.row.sheet;if(!e.bt.size&&!e.yt.size)return{};const n=e.bt.has(this.row.rIndex)?this.row.wt?.alignment:null,i=e.yt.has(this.cIndex)?e.cols[this.cIndex]?.xt?.alignment:null;return n||i?n&&!i?n:!n&&i?i:{...i,...n}:{}}set alignment(t){0==Object.keys(t??{}).length&&(t=null);const e=JSON.parse(JSON.stringify(this.style.alignment??{}));t?this.style.alignment={...this.O.alignment,...t}:delete this.style.alignment;const n=JSON.parse(JSON.stringify(this.style.alignment??{}));this.$.UndoRedo.add({undo:()=>{this.style.alignment=e},redo:()=>{this.style.alignment=n}})}get numFmt(){const t=this.style?.numFmt;if(t)return t;const e=this.row.sheet;return(e.bt.size||e.yt.size)&&((e.bt.has(this.row.rIndex)?this.row.wt?.numFmt:null)||(e.yt.has(this.cIndex)?e.cols[this.cIndex]?.xt?.numFmt:null))||void 0}set numFmt(t){const e=this.style.numFmt,n=this.U,i=this.K;t?this.style.numFmt=t:delete this.style.numFmt,this.U=void 0,this.K=void 0;const r=this.style.numFmt,o=this.U,a=this.K;this.$.UndoRedo.add({undo:()=>{this.style.numFmt=e,this.U=n,this.K=i},redo:()=>{this.style.numFmt=r,this.U=o,this.K=a}})}get buildXml(){return function(t){let n={"v":"","_$r":`${t.$.Utils.numToChar(t.cIndex)}${t.row.rIndex+1}`};const i=t.$;if(t.isFormula)n={f:t.editVal.substring(1),...n};else if("boolean"===t.type)n._$t="b",n.v=t.B?"1":"0";else if(["time","dateTime","date"].includes(t.type))n.v=t.calcVal;else if("error"===t.type)n._$t="e",n.v=t.U;else if(isNaN(t.B)){n._$t="s";const e=i.o.sst;if(t.W){const r=JSON.stringify(t.W);if(void 0===i.o.sharedStringsObj[r]){i.o.sharedStringsObj[r]=Object.keys(i.o.sharedStringsObj).length,e._$uniqueCount++;const n=t.W.map(e=>{const n=e.font,i={};if(n&&Object.keys(n).length){const e={},r=t.font;e.rFont={_$val:n.name??r.name??"宋体"},(n.charset??r.charset)&&(e.charset={_$val:n.charset??r.charset}),(n.bold??r.bold)&&(e.b=""),(n.italic??r.italic)&&(e.i=""),(n.strike??r.strike)&&(e.strike=""),n.color&&(e.color={_$rgb:"FF"+n.color.replace("#","")}),e.sz={_$val:n.size??r.size??"11"};const o=n.underline??r.underline;o&&(e.u="single"===o?"":{_$val:o}),n.vertAlign&&(e.vertAlign={_$val:n.vertAlign}),i.rPr=e}return i.t=e.text,i});e.si.push({r:n})}e._$count++,n.v=i.o.sharedStringsObj[r]}else{const r=t.editVal;void 0===i.o.sharedStringsObj[r]&&(i.o.sharedStringsObj[r]=Object.keys(i.o.sharedStringsObj).length,e._$uniqueCount++,e.si.push({t:r})),e._$count++,n.v=i.o.sharedStringsObj[r]}}else n.v=t.editVal;const r="string"==typeof t.editVal&&t.editVal.includes("\n");if(0==Object.keys(t.style).length&&!r)return n;const o=function(t){const n={_$numFmtId:0,_$fontId:0,_$fillId:0,_$borderId:0,_$xfId:0},i=t.$;if(t.O.alignment&&(n.alignment={},t.alignment.horizontal&&(n.alignment._$horizontal=t.alignment.horizontal),t.alignment.vertical&&(n.alignment._$vertical=t.alignment.vertical),t.alignment.wrapText&&(n.alignment._$wrapText="1"),t.alignment.shrinkToFit&&(n.alignment._$shrinkToFit="1"),t.alignment.indent&&(n.alignment._$indent=t.alignment.indent),t.alignment.textRotation&&(n.alignment._$textRotation=t.alignment.textRotation)),t.O.font){const e=t.font,r=JSON.stringify(e);if(i.buildStyle.fonts[r])n._$fontId=i.buildStyle.fonts[r];else{n._$fontId=i.buildStyle.fonts[r]=i.buildStyle.fontC++;const t={};e.bold&&(t.b=""),e.italic&&(t.i=""),e.strike&&(t.strike=""),e.underline&&(t.u="single"===e.underline?"":{_$val:e.underline}),e.size&&(t.sz={_$val:e.size});const o=p(e);o&&(t.color=o),e.name&&(t.name={_$val:e.name}),e.charset&&(t.charset={_$val:e.charset}),e.outline&&(t.outline=""),e.vertAlign&&(t.vertAlign={_$val:e.vertAlign}),i.o.styleSheet.fonts.font.push(t)}n._$applyFont="1"}const r=function(t){const e=t.row?.sheet;if(!e?.Table||0===e.Table.size)return!1;let n=!1;return e.Table.forEach(e=>{e.isDataCell(t.row.rIndex,t.cIndex)&&(n=!0)}),n}(t);if(!r&&m(t.O?.fill)){const e=t.fill,r=JSON.stringify(e);if(i.buildStyle.fills[r])n._$fillId=i.buildStyle.fills[r];else{n._$fillId=i.buildStyle.fills[r]=i.buildStyle.fillC++;const t={};"pattern"===e.type?(t.patternFill={_$patternType:e.pattern||"solid"},e.fgColor&&(t.patternFill.fgColor={_$rgb:f(e.fgColor)}),e.bgColor&&(t.patternFill.bgColor={_$rgb:f(e.bgColor)})):"gradient"===e.type&&(t.gradientFill={},"path"===e.gradientType&&(t.gradientFill._$type="path"),e.degree&&(t.gradientFill._$degree=e.degree),e.left&&(t.gradientFill._$left=e.left),e.right&&(t.gradientFill._$right=e.right),e.top&&(t.gradientFill._$top=e.top),e.bottom&&(t.gradientFill._$bottom=e.bottom),e.stops&&Array.isArray(e.stops)?t.gradientFill.stop=e.stops.map(t=>{const e={};return e._$position=void 0!==t.position?t.position:0,t.color&&(e.color={_$rgb:f(t.color)}),e}):t.gradientFill.stop=[{_$position:0,color:{_$rgb:"FFFFFFFF"}},{_$position:1,color:{_$rgb:"FF000000"}}]),i.o.styleSheet.fills.fill.push(t)}n._$applyFill="1"}if(g(t.O?.border)){const e=v(t.border),r=e.key;i.buildStyle.borders[r]?n._$borderId=i.buildStyle.borders[r]:(n._$borderId=i.buildStyle.borders[r]=i.buildStyle.borderC++,i.o.styleSheet.borders.border.push(e.node)),n._$applyBorder="1"}if(t.O.numFmt){const r=t.numFmt,o=JSON.stringify(r);if(i.buildStyle.numFmts[o])n._$numFmtId=i.buildStyle.numFmts[o];else{const t=Object.entries(e).find(([t,e])=>e===r)?.[0];t?n._$numFmtId=t:(n._$numFmtId=i.buildStyle.numFmtC++,i.o.styleSheet.numFmts.numFmt.push({_$numFmtId:n._$numFmtId,_$formatCode:r})),i.buildStyle.numFmts[o]=n._$numFmtId}n._$applyNumberFormat="1"}if(t.O?.protection){const e={};!1===t.O.protection.locked&&(e._$locked="0"),!0===t.O.protection.hidden&&(e._$hidden="1"),Object.keys(e).length>0&&(n.protection=e,n._$applyProtection="1")}return n}(t);r&&(o.alignment||(o.alignment={}),o.alignment._$wrapText="1");const a=JSON.stringify(o);return null!=i.buildStyle.xf[a]?n._$s=i.buildStyle.xf[a]:(n._$s=i.buildStyle.xf[a]=i.buildStyle.xfC++,i.o.styleSheet.cellXfs.xf.push(o)),n}(this)}get $t(){return![void 0,null,""].includes(this.editVal)||Object.keys(this.style).length>0||this._||this.F}}class x{#t;#e;#n;#i;#r;#o=null;constructor(t,e,n){this.sheet=e,this.rIndex=n,this.cells=[],this.$=e.SN,this.S=t??{},this.#t=this.S._$ht?Math.round(1.333*this.S._$ht):this.sheet.defaultRowHeight,this.#e="1"==this.S._$hidden,this.#n=!1,this.#i=Math.max(0,Math.min(7,Math.floor(Number(this.S._$outlineLevel)||0))),this.#r="1"==this.S._$collapsed,this.S._$s&&"1"==this.S._$customFormat&&(this.#o=this.$.Xml.dt(this.S._$s),this.#o&&Object.keys(this.#o).length>0&&this.sheet.bt.add(n)),this.init()}init(){this.S.c&&(Array.isArray(this.S.c)||(this.S.c=[this.S.c]),this.S.c.forEach(t=>{const e=this.sheet.Utils.charToNum(t._$r.replace(/\d/g,""));this.cells[e]=new b(t,this,e)}))}get Mt(){return this.#t}set Mt(t){this.#t=t,this.sheet.Ct=void 0}get St(){return this.#e}set St(t){this.#e!==t&&(this.#e=t,this.sheet.Ct=void 0,this.sheet.Rt=(this.sheet.Rt||0)+1)}get At(){return this.#n}set At(t){const e=!!t;this.#n!==e&&(this.#n=e,this.sheet.Ct=void 0,this.sheet.Rt=(this.sheet.Rt||0)+1)}get kt(){return this.#i}set kt(t){this.#i=Math.max(0,Math.min(7,Math.floor(Number(t)||0)))}get Tt(){return this.#r}set Tt(t){this.#r=!!t}get height(){return this.#t}set height(t){const e=this.#t;if(e!==t){if(this.$.Event.hasListeners("beforeRowResize")&&this.$.Event.emit("beforeRowResize",{sheet:this.sheet,row:this.rIndex,oldHeight:e,newHeight:t}).canceled)return;return this.$.st("rowResize",{sheet:this.sheet,row:this.rIndex,oldHeight:e,newHeight:t},()=>{this.$.UndoRedo.add({undo:()=>{this.Mt=e},redo:()=>{this.Mt=t}}),this.Mt=t,this.$.ht({type:"row",action:"resize",sheet:this.sheet,row:this.rIndex,oldHeight:e,newHeight:t}),this.$.Event.hasListeners("afterRowResize")&&this.$.Event.emit("afterRowResize",{sheet:this.sheet,row:this.rIndex,oldHeight:e,newHeight:t})})}}get hidden(){return this.#e||this.#n}set hidden(t){const e=this.#e,n=!!t;if(e===n)return;const i=n?"RowHide":"RowUnhide";return this.$.Event.hasListeners(`before${i}`)&&this.$.Event.emit(`before${i}`,{sheet:this.sheet,row:this.rIndex,oldHidden:e,newHidden:n}).canceled?void 0:this.$.st("rowHidden",{sheet:this.sheet,row:this.rIndex,oldHidden:e,newHidden:n},()=>{this.$.UndoRedo.add({undo:()=>{this.St=e},redo:()=>{this.St=n}}),this.St=n,this.$.ht({type:"row",action:n?"hide":"unhide",sheet:this.sheet,row:this.rIndex,oldHidden:e,newHidden:n}),this.$.Event.hasListeners(`after${i}`)&&this.$.Event.emit(`after${i}`,{sheet:this.sheet,row:this.rIndex,oldHidden:e,newHidden:n})})}get outlineLevel(){return this.#i}set outlineLevel(t){const e=this.#i,n=Math.max(0,Math.min(7,Math.floor(Number(t)||0)));if(e!==n)return this.$.st("rowOutlineLevel",{sheet:this.sheet,row:this.rIndex,oldOutlineLevel:e,newOutlineLevel:n},()=>{this.$.UndoRedo.add({undo:()=>{this.kt=e},redo:()=>{this.kt=n}}),this.kt=n,this.$.ht({type:"row",action:"outlineLevel",sheet:this.sheet,row:this.rIndex,oldOutlineLevel:e,newOutlineLevel:n})})}get collapsed(){return this.#r}set collapsed(t){const e=this.#r,n=!!t;if(e!==n)return this.$.st("rowCollapsed",{sheet:this.sheet,row:this.rIndex,oldCollapsed:e,newCollapsed:n},()=>{this.$.UndoRedo.add({undo:()=>{this.Tt=e},redo:()=>{this.Tt=n}}),this.Tt=n,this.$.ht({type:"row",action:"collapsed",sheet:this.sheet,row:this.rIndex,oldCollapsed:e,newCollapsed:n})})}get $t(){return!!(this.#t!==this.sheet.defaultRowHeight||this.hidden||this.#o||this.#i>0||this.#r)||!!this.cells.some(t=>t?.$t)}get wt(){return this.#o}set wt(t){this.#o=t,t?this.sheet.bt.add(this.rIndex):this.sheet.bt.delete(this.rIndex)}get style(){return this.#o||{}}set style(t){const e=this.#o,n=this.sheet.bt.has(this.rIndex);this.wt=t?{...t}:null,this.$.UndoRedo.add({undo:()=>{this.#o=e,n?this.sheet.bt.add(this.rIndex):this.sheet.bt.delete(this.rIndex)},redo:()=>{this.wt=t?{...t}:null}})}get font(){return this.#o?.font||{}}set font(t){const e=t?{...this.#o?.font,...t}:void 0;e&&Object.prototype.hasOwnProperty.call(t,"color")&&(delete e.colorTheme,delete e.colorTint,delete e.colorIndexed,delete e.colorAuto);const n={...this.#o,font:e};n.font||delete n.font,this.style=Object.keys(n).length?n:null}get fill(){return this.#o?.fill||{}}set fill(t){const e={...this.#o,fill:t?{type:"pattern",pattern:"solid",...this.#o?.fill,...t}:void 0};e.fill||delete e.fill,this.style=Object.keys(e).length?e:null}get alignment(){return this.#o?.alignment||{}}set alignment(t){const e={...this.#o,alignment:t?{...this.#o?.alignment,...t}:void 0};e.alignment||delete e.alignment,this.style=Object.keys(e).length?e:null}get border(){return this.#o?.border||{}}set border(t){let e;t&&(e={...this.#o?.border||{}},Object.keys(t).forEach(n=>{const i=t[n];["top","right","bottom","left","diagonal"].includes(n)?i&&"object"==typeof i?e[n]={color:"#000000",style:"thin",...e[n]||{},...i}:delete e[n]:"diagonalUp"!==n&&"diagonalDown"!==n?null==i?delete e[n]:e[n]=i:null==i?delete e[n]:e[n]=!!i}),Object.keys(e).length||(e=void 0));const n={...this.#o,border:e};n.border||delete n.border,this.style=Object.keys(n).length?n:null}get numFmt(){return this.#o?.numFmt}set numFmt(t){const e={...this.#o,numFmt:t||void 0};e.numFmt||delete e.numFmt,this.style=Object.keys(e).length?e:null}}class w{#a;#e;#i;#r;#o=null;constructor(t,e,n){this.sheet=e,this.cIndex=n,this.$=e.SN,this.S=t??{},this.#e="1"==this.S._$hidden,this.#a=this.S._$width?Math.round(7.5*this.S._$width):this.sheet.defaultColWidth,this.#i=Math.max(0,Math.min(7,Math.floor(Number(this.S._$outlineLevel)||0))),this.#r="1"==this.S._$collapsed,this.S._$style&&(this.#o=this.$.Xml.dt(this.S._$style),this.#o&&Object.keys(this.#o).length>0&&this.sheet.yt.add(n))}get cells(){return this.sheet.rows.map(t=>t.cells[this.cIndex])}get Nt(){return this.#a}set Nt(t){this.#a=t,this.sheet.Ft=void 0}get St(){return this.#e}set St(t){this.#e=t,this.sheet.Ft=void 0}get kt(){return this.#i}set kt(t){this.#i=Math.max(0,Math.min(7,Math.floor(Number(t)||0)))}get Tt(){return this.#r}set Tt(t){this.#r=!!t}get width(){return this.#a}set width(t){const e=this.#a;if(e!==t){if(this.$.Event.hasListeners("beforeColResize")&&this.$.Event.emit("beforeColResize",{sheet:this.sheet,col:this.cIndex,oldWidth:e,newWidth:t}).canceled)return;return this.$.st("colResize",{sheet:this.sheet,col:this.cIndex,oldWidth:e,newWidth:t},()=>{this.$.UndoRedo.add({undo:()=>{this.Nt=e},redo:()=>{this.Nt=t}}),this.Nt=t,this.$.ht({type:"col",action:"resize",sheet:this.sheet,col:this.cIndex,oldWidth:e,newWidth:t}),this.$.Event.hasListeners("afterColResize")&&this.$.Event.emit("afterColResize",{sheet:this.sheet,col:this.cIndex,oldWidth:e,newWidth:t})})}}get hidden(){return this.#e}set hidden(t){const e=this.#e,n=!!t;if(e===n)return;const i=n?"ColHide":"ColUnhide";return this.$.Event.hasListeners(`before${i}`)&&this.$.Event.emit(`before${i}`,{sheet:this.sheet,col:this.cIndex,oldHidden:e,newHidden:n}).canceled?void 0:this.$.st("colHidden",{sheet:this.sheet,col:this.cIndex,oldHidden:e,newHidden:n},()=>{this.$.UndoRedo.add({undo:()=>{this.St=e},redo:()=>{this.St=n}}),this.St=n,this.$.ht({type:"col",action:n?"hide":"unhide",sheet:this.sheet,col:this.cIndex,oldHidden:e,newHidden:n}),this.$.Event.hasListeners(`after${i}`)&&this.$.Event.emit(`after${i}`,{sheet:this.sheet,col:this.cIndex,oldHidden:e,newHidden:n})})}get outlineLevel(){return this.#i}set outlineLevel(t){const e=this.#i,n=Math.max(0,Math.min(7,Math.floor(Number(t)||0)));if(e!==n)return this.$.st("colOutlineLevel",{sheet:this.sheet,col:this.cIndex,oldOutlineLevel:e,newOutlineLevel:n},()=>{this.$.UndoRedo.add({undo:()=>{this.kt=e},redo:()=>{this.kt=n}}),this.kt=n,this.$.ht({type:"col",action:"outlineLevel",sheet:this.sheet,col:this.cIndex,oldOutlineLevel:e,newOutlineLevel:n})})}get collapsed(){return this.#r}set collapsed(t){const e=this.#r,n=!!t;if(e!==n)return this.$.st("colCollapsed",{sheet:this.sheet,col:this.cIndex,oldCollapsed:e,newCollapsed:n},()=>{this.$.UndoRedo.add({undo:()=>{this.Tt=e},redo:()=>{this.Tt=n}}),this.Tt=n,this.$.ht({type:"col",action:"collapsed",sheet:this.sheet,col:this.cIndex,oldCollapsed:e,newCollapsed:n})})}get $t(){return!!(this.#a!==this.sheet.defaultColWidth||this.#e||this.#o||this.#i>0||this.#r)}get xt(){return this.#o}set xt(t){this.#o=t,t?this.sheet.yt.add(this.cIndex):this.sheet.yt.delete(this.cIndex)}get style(){return this.#o||{}}set style(t){const e=this.#o,n=this.sheet.yt.has(this.cIndex);this.xt=t?{...t}:null,this.$.UndoRedo.add({undo:()=>{this.#o=e,n?this.sheet.yt.add(this.cIndex):this.sheet.yt.delete(this.cIndex)},redo:()=>{this.xt=t?{...t}:null}})}get font(){return this.#o?.font||{}}set font(t){const e=t?{...this.#o?.font,...t}:void 0;e&&Object.prototype.hasOwnProperty.call(t,"color")&&(delete e.colorTheme,delete e.colorTint,delete e.colorIndexed,delete e.colorAuto);const n={...this.#o,font:e};n.font||delete n.font,this.style=Object.keys(n).length?n:null}get fill(){return this.#o?.fill||{}}set fill(t){const e={...this.#o,fill:t?{type:"pattern",pattern:"solid",...this.#o?.fill,...t}:void 0};e.fill||delete e.fill,this.style=Object.keys(e).length?e:null}get alignment(){return this.#o?.alignment||{}}set alignment(t){const e={...this.#o,alignment:t?{...this.#o?.alignment,...t}:void 0};e.alignment||delete e.alignment,this.style=Object.keys(e).length?e:null}get border(){return this.#o?.border||{}}set border(t){let e;t&&(e={...this.#o?.border||{}},Object.keys(t).forEach(n=>{const i=t[n];["top","right","bottom","left","diagonal"].includes(n)?i&&"object"==typeof i?e[n]={color:"#000000",style:"thin",...e[n]||{},...i}:delete e[n]:"diagonalUp"!==n&&"diagonalDown"!==n?null==i?delete e[n]:e[n]=i:null==i?delete e[n]:e[n]=!!i}),Object.keys(e).length||(e=void 0));const n={...this.#o,border:e};n.border||delete n.border,this.style=Object.keys(n).length?n:null}get numFmt(){return this.#o?.numFmt}set numFmt(t){const e={...this.#o,numFmt:t||void 0};e.numFmt||delete e.numFmt,this.style=Object.keys(e).length?e:null}}class S{constructor(t,e){this.sheet=e,this.id=t.id??`comment_${Date.now()}_${Math.random()}`,this.cellRef=t.cellRef,this.author=t.author??"未知作者",this.text=t.text??"",this.visible=t.visible??!1,this.width=t.width??144,this.height=t.height??72,this.marginLeft=t.marginLeft??107,this.marginTop=t.marginTop??7,this._t=null,this.Et=null}get cellPos(){return this.Et||(this.Et=this.sheet.SN.Utils.cellStrToNum(this.cellRef)),this.Et}It(){if(this._t)return this._t;const{r:t,c:e}=this.cellPos,n=this.sheet.getCellInViewInfo(t,e);if(!n)return null;const i=1.33;return this._t={x:n.x+this.marginLeft*i,y:n.y+this.marginTop*i,width:this.width*i,height:this.height*i},this._t}zt(){this._t=null}Dt(){return{ref:this.cellRef,authorId:0,text:{t:this.text}}}Lt(){return{visible:this.visible,width:this.width,height:this.height,marginLeft:this.marginLeft,marginTop:this.marginTop}}}function C(t,e,n){return t?.Event?.hasListeners?.(e)?t.Event.emit(e,n):null}class T{constructor(t){this.sheet=t,this.map=new Map,this.Ot=["未知作者"]}parse(t){const e=this.Pt();if(!e)return;const n=this.sheet.SN.Xml.getWsRelsFileTarget(this.sheet.rId,e),i=this.sheet.SN.Xml.obj[n];if(!i)return;let r=null;if(t?.legacyDrawing){const e=t.legacyDrawing["_$r:id"],n=this.sheet.SN.Xml.getWsRelsFileTarget(this.sheet.rId,e);r=this.sheet.SN.Xml.obj[n]}const o=this.sheet.SN.Utils.objToArr(i.comments?.authors?.author);o.length>0&&(this.Ot=o),this.sheet.SN.Utils.objToArr(i.comments?.commentList?.Comment).forEach((t,e)=>{const n=t._$ref,i=parseInt(t._$authorId??0),o=this.Ot[i]??"未知作者";let a="";const s=t.text;s&&("string"==typeof s.t?a=s.t:Array.isArray(s.r)?a=s.r.map(t=>t.t??"").join(""):s.t?.["#text"]&&(a=s.t["#text"]));const l=this.Vt(o),c=this.Bt(a),h=this.Ht(r,e),u=new S({cellRef:n,author:l,text:c,...h},this.sheet);this.map.set(n,u)})}Ht(t,e){return t?{visible:!1,width:144,height:72,marginLeft:107,marginTop:7}:{}}Pt(){const t=this.sheet.SN.Xml.relationship.find(t=>t._$Id===this.sheet.rId);if(!t)return null;const e=t._$Target,n=this.sheet.SN.Xml.getRelsByTarget(e);if(!n)return null;const i=n.find(t=>t._$Type?.includes("comments"));return i?._$Id}add(t={}){const{cellRef:e}=t;if(!e)return null;const n=this.sheet.SN,i={sheet:this.sheet,cellRef:e,config:t},r=C(n,"beforeCommentAdd",i);if(r?.canceled)return null;this.map.has(e)&&this.remove(e);const o=new S({cellRef:e,author:t.author??"未知作者",text:t.text??"",visible:t.visible??!1,width:t.width,height:t.height,marginLeft:t.marginLeft,marginTop:t.marginTop},this.sheet);return this.Ot.includes(o.author)||this.Ot.push(o.author),this.map.set(e,o),C(n,"afterCommentAdd",{...i,comment:o}),o}get(t){return this.map.get(t)??null}remove(t){const e=this.map.get(t)??null,n={sheet:this.sheet,cellRef:t,comment:e},i=C(this.sheet.SN,"beforeCommentRemove",n);if(i?.canceled)return!1;const r=this.map.delete(t);return r&&C(this.sheet.SN,"afterCommentRemove",n),r}getAll(){return Array.from(this.map.values())}clearCache(){this.map.forEach(t=>t.zt())}toXmlObject(){if(0===this.map.size)return null;const t=[],e=new Map;this.Ot.forEach(n=>{const i=this.Vt(n);t.includes(i)||t.push(i),e.set(n,t.indexOf(i))});const n=Array.from(this.map.values()).map((t,n)=>{const i=e.get(t.author)??0,r=t.uid??`{${this.Ut()}}`;return{text:{t:this.Bt(t.text)},"_$ref":t.cellRef,"_$authorId":String(i),"_$shapeId":`_x0000_s${1026+n}`,"_$xr:uid":r}});return{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},comments:{authors:{author:1===t.length?t[0]:t},commentList:{comment:1===n.length?n[0]:n},"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","_$mc:Ignorable":"xr","_$xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}}}Vt(t){return t&&t.startsWith("tc=")?"":t||""}Bt(t){if(!t)return"";const e=t.indexOf("注释:\n");if(-1!==e)return t.substring(e+4).replace(/^[\s]+/,"");if(t.startsWith("[线程批注]")){const e=t.split("\n"),n=e[e.length-1].trim();if(n)return n}return t}Ut(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16).toUpperCase()})}}const $="__sheet__";function M(t){return t?.s&&t?.e?{s:{r:t.s.r,c:t.s.c},e:{r:t.e.r,c:t.e.c}}:null}function A(t){if(!t?.s||!t?.e)return null;const e=Math.min(t.s.r,t.e.r),n=Math.max(t.s.r,t.e.r);return{s:{r:e,c:Math.min(t.s.c,t.e.c)},e:{r:n,c:Math.max(t.s.c,t.e.c)}}}class N{constructor(t){this.sheet=t,this.$=t.SN,this.Kt=$,this.Wt=$,this.jt=new Map,this.jt.set($,this.qt($,{ownerType:"sheet",ownerId:null})),this.Gt=new Set}qt(t,e={}){return{id:t,ownerType:e.ownerType||"sheet",ownerId:e.ownerId??null,ref:null,range:null,columns:new Map,hiddenRows:new Set,sortState:null}}Xt(t=null){return null==t||"sheet"===t?this.Kt:t}Yt(t=null,e=!1,n={}){const i=this.Xt(t);return!this.jt.has(i)&&e&&this.jt.set(i,this.qt(i,n)),this.jt.get(i)||null}Jt(){return this.Yt(this.Kt,!0,{ownerType:"sheet",ownerId:null})}Zt(t,e,n={}){const i=A(e);return t.range=i,t.ref=i?this.$.Utils.rangeNumToStr(i):null,i?!0!==n.keepFilters?(t.columns.clear(),t.sortState=null,void t.hiddenRows.clear()):(Array.from(t.columns.keys()).forEach(e=>{(e<i.s.c||e>i.e.c)&&t.columns.delete(e)}),t.sortState&&(t.sortState.colIndex<i.s.c||t.sortState.colIndex>i.e.c)&&(t.sortState=null),void t.hiddenRows.clear()):(t.columns.clear(),t.sortState=null,void t.hiddenRows.clear())}Qt(t){if(!t?.range)return new Set;if(0===t.columns.size)return new Set;const e=new Set,n=t.range,i=this.sheet;for(let r=n.s.r+1;r<=n.e.r;r++){let n=!1;for(const[e,o]of t.columns){const t=i.getCell(r,e).editVal;if(!this.te(t,o)){n=!0;break}}n&&e.add(r)}return e}ee(){const t=new Set;this.jt.forEach(e=>{e?.range&&0!==e.hiddenRows.size&&e.hiddenRows.forEach(e=>t.add(e))});const e=this.Gt,n=[],i=[];return e.forEach(e=>{if(!t.has(e)){const t=this.sheet.rows[e];t&&(t.At=!1),i.push(e)}}),t.forEach(t=>{e.has(t)||(this.sheet.getRow(t).At=!0,n.push(t))}),this.Gt=t,{hiddenRowsAdded:n,hiddenRowsRemoved:i}}ne(t,e){return{scopeId:t,ownerType:e?.ownerType||"sheet",ownerId:e?.ownerId??null}}get ref(){return this.Jt().ref}set ref(t){if(!t)return void this.clear(this.Kt);const e=this.sheet.rangeStrToNum(t);this.setRange(e,this.Kt)}get re(){return this.ref}set re(t){const e=this.Jt();t?(e.ref=t,e.range=this.sheet.rangeStrToNum(t)):(e.ref=null,e.range=null)}get range(){return this.Jt().range}get se(){return this.range}set se(t){const e=this.Jt(),n=A(t);e.range=n,e.ref=n?this.$.Utils.rangeNumToStr(n):null}get columns(){return this.Jt().columns}get sortState(){return this.Jt().sortState}set sortState(t){this.Jt().sortState=t||null}get enabled(){const t=this.Jt();return!!t?.range}get headerRow(){return this.Jt()?.range?.s?.r??0}get hasActiveFilters(){return this.Jt().columns.size>0}get oe(){return this.Gt}get activeScopeId(){return this.Wt}setActiveScope(t){const e=this.Xt(t);return this.jt.has(e)&&(this.Wt=e),this.Wt}getTableScopeId(t){return`table:${t}`}isScopeEnabled(t=null){const e=this.Yt(t);return!!e?.range}hasActiveFiltersInScope(t=null){const e=this.Yt(t);return!!e&&e.columns.size>0}hasAnyActiveFilters(){for(const t of this.jt.values())if(t.columns.size>0)return!0;return!1}getScopeRange(t=null){const e=this.Yt(t);return e?.range||null}getScopeHeaderRow(t=null){const e=this.Yt(t);return e?.range?.s?.r??0}getColumnFilter(t,e=null){const n=this.Yt(e);return n?.columns?.get(t)||null}getEnabledScopes(){return Array.from(this.jt.values()).filter(t=>!!t?.range).sort((t,e)=>t.range.s.r!==e.range.s.r?t.range.s.r-e.range.s.r:t.range.s.c!==e.range.s.c?t.range.s.c-e.range.s.c:t.id.localeCompare(e.id)).map(t=>({scopeId:t.id,ownerType:t.ownerType,ownerId:t.ownerId,range:M(t.range),headerRow:t.range.s.r}))}ae(t){return t?.range?{s:{r:t.range.s.r,c:t.range.s.c},e:{r:t.showTotalsRow?t.range.e.r-1:t.range.e.r,c:t.range.e.c}}:null}registerTableScope(t,e={}){if(!t?.id)return null;const n=this.getTableScopeId(t.id),i=this.Yt(n,!0,{ownerType:"table",ownerId:t.id});i.ownerType="table",i.ownerId=t.id;const r=M(i.range),o=A(e.range||this.ae(t));if(!o)return this.unregisterTableScope(t.id,e),null;const a=!1!==e.keepFilters;if(this.Zt(i,o,{keepFilters:a}),e.autoFilterXml){const t=this.le(e.autoFilterXml,o);this.ce(i,t,{restoreHiddenRowsFromSheet:!0===e.restoreHiddenRowsFromSheet})}var s,l;return i.columns.size>0?this.he(n,{silent:!0===e.silent,emitEvents:!1,recordChange:!1,recalculate:!0!==e.silent}):(i.hiddenRows.clear(),this.ee(),!0===e.silent||(s=r,l=i.range,!s&&!l||s&&l&&s.s.r===l.s.r&&s.s.c===l.s.c&&s.e.r===l.e.r&&s.e.c===l.e.c)||this.$.ue()),n}unregisterTableScope(t,e={}){const n=this.getTableScopeId(t),i=this.Yt(n);if(!i)return;const r=i.hiddenRows.size>0;this.jt.delete(n),this.Wt===n&&(this.Wt=this.Kt),r&&this.ee(),!0!==e.silent&&this.$.ue()}setRange(t,e=this.Kt){const n=this.Xt(e),i=this.Yt(n,!0,{ownerType:n===this.Kt?"sheet":"custom",ownerId:null});let r=t;if(r||(r=this.fe()),r=A(r),!r)return;const o=this.ne(n,i);return this.$.Event.hasListeners("beforeAutoFilter")&&this.$.Event.emit("beforeAutoFilter",{sheet:this.sheet,action:"setRange",range:r,...o}).canceled||this.$.Event.emit("beforeAutoFilterSetRange",{sheet:this.sheet,range:r,...o}).canceled?void 0:this.$.st("autoFilterSetRange",{sheet:this.sheet,range:r,scopeId:n},()=>{this.Zt(i,r,{keepFilters:!1}),this.ee(),this.$.ht({type:"autoFilter",action:"setRange",sheet:this.sheet,range:r,scopeId:n}),this.$.ue(),this.$.Event.emit("afterAutoFilterSetRange",{sheet:this.sheet,range:r,...o})})}fe(){const t=this.sheet,e=t.activeAreas;if(e.length>0){const t=e[0];if(t.s.r!==t.e.r||t.s.c!==t.e.c)return t}const n=t.activeCell;let i=n.r,r=n.r,o=n.c,a=n.c;for(;i>0&&this.de(i-1,n.c);)i--;for(;r<t.rowCount-1&&this.de(r+1,n.c);)r++;for(;o>0&&this.de(n.r,o-1);)o--;for(;a<t.colCount-1&&this.de(n.r,a+1);)a++;return r===i&&(r=Math.min(i+100,t.rowCount-1)),{s:{r:i,c:o},e:{r,c:a}}}de(t,e){const n=this.sheet.getCell(t,e);return void 0!==n.editVal&&null!==n.editVal&&""!==n.editVal}isColumnInRange(t,e=null){const n=this.Yt(e);return!!n?.range&&t>=n.range.s.c&&t<=n.range.e.c}isHeaderRow(t,e=null){const n=this.Yt(e);return!!n?.range&&t===n.range.s.r}getColumnValues(t,e=null){const n=this.Yt(e);if(!n?.range)return[];const i=new Map,r=this.sheet;for(let o=n.range.s.r+1;o<=n.range.e.r;o++){const e=r.getCell(o,t),n=e.editVal,a=e.showVal??n??"",s=String(n??"");i.has(s)?i.get(s).count++:i.set(s,{value:n,text:""===a?this.$.t("core.autoFilter.autoFilter.blank"):String(a),count:1,isEmpty:""===n||null==n})}return Array.from(i.values()).sort((t,e)=>{if(t.isEmpty&&!e.isEmpty)return 1;if(!t.isEmpty&&e.isEmpty)return-1;const n="number"==typeof t.value,i="number"==typeof e.value;return n&&!i?-1:!n&&i?1:n&&i?t.value-e.value:String(t.text).localeCompare(String(e.text))})}setColumnFilter(t,e,n=null){const i=this.Xt(n),r=this.Yt(i);if(!r?.range)return;const o=this.ne(i,r);if(this.$.Event.hasListeners("beforeAutoFilter")&&this.$.Event.emit("beforeAutoFilter",{sheet:this.sheet,action:"setColumnFilter",colIndex:t,filter:e,...o}).canceled)return;const a=r.columns.get(t);return this.$.Event.emit("beforeAutoFilterSetColumnFilter",{sheet:this.sheet,colIndex:t,filter:e,prevFilter:a,...o}).canceled?void 0:this.$.st("autoFilterSetColumnFilter",{sheet:this.sheet,colIndex:t,filter:e,scopeId:i},()=>{e&&("values"!==e.type||e.values&&0!==e.values.length)?r.columns.set(t,e):r.columns.delete(t),this.$.ht({type:"autoFilter",action:"setColumnFilter",sheet:this.sheet,colIndex:t,filter:e,prevFilter:a,scopeId:i}),this.he(i),this.$.Event.emit("afterAutoFilterSetColumnFilter",{sheet:this.sheet,colIndex:t,filter:e,prevFilter:a,...o})})}clearColumnFilter(t,e=null){const n=this.Xt(e),i=this.Yt(n);if(!i?.range)return;const r=this.ne(n,i);if(this.$.Event.hasListeners("beforeAutoFilter")&&this.$.Event.emit("beforeAutoFilter",{sheet:this.sheet,action:"clearColumnFilter",colIndex:t,...r}).canceled)return;const o=i.columns.get(t);return this.$.Event.emit("beforeAutoFilterClearColumnFilter",{sheet:this.sheet,colIndex:t,prevFilter:o,...r}).canceled?void 0:this.$.st("autoFilterClearColumnFilter",{sheet:this.sheet,colIndex:t,scopeId:n},()=>{i.columns.delete(t),this.$.ht({type:"autoFilter",action:"clearColumnFilter",sheet:this.sheet,colIndex:t,prevFilter:o,scopeId:n}),this.he(n),this.$.Event.emit("afterAutoFilterClearColumnFilter",{sheet:this.sheet,colIndex:t,prevFilter:o,...r})})}clearAllFilters(t=null){const e=this.Xt(t),n=this.Yt(e);if(!n?.range)return;const i=this.ne(e,n);if(this.$.Event.hasListeners("beforeAutoFilter")&&this.$.Event.emit("beforeAutoFilter",{sheet:this.sheet,action:"clearAllFilters",...i}).canceled)return;const r=new Map(n.columns);return this.$.Event.emit("beforeAutoFilterClearAllFilters",{sheet:this.sheet,filters:r,...i}).canceled?void 0:this.$.st("autoFilterClearAllFilters",{sheet:this.sheet,scopeId:e},()=>{n.columns.clear(),this.$.ht({type:"autoFilter",action:"clearAllFilters",sheet:this.sheet,filters:r,scopeId:e}),this.he(e),this.$.Event.emit("afterAutoFilterClearAllFilters",{sheet:this.sheet,...i})})}clear(t=this.Kt){const e=this.Xt(t),n=this.Yt(e);if(!n)return;const i=this.ne(e,n);if(this.$.Event.hasListeners("beforeAutoFilter")&&this.$.Event.emit("beforeAutoFilter",{sheet:this.sheet,action:"clear",...i}).canceled)return;const r=n.ref,o=M(n.range),a=new Map(n.columns);return this.$.Event.emit("beforeAutoFilterClear",{sheet:this.sheet,ref:r,range:o,...i}).canceled?void 0:this.$.st("autoFilterClear",{sheet:this.sheet,scopeId:e},()=>{n.ref=null,n.range=null,n.columns.clear(),n.sortState=null,n.hiddenRows.clear();const t=this.ee();this.$.ht({type:"autoFilter",action:"clear",sheet:this.sheet,ref:r,range:o,filters:a,hiddenRowsAdded:t.hiddenRowsAdded,hiddenRowsRemoved:t.hiddenRowsRemoved,scopeId:e}),this.$.DependencyGraph&&"manual"!==this.$.calcMode&&this.$.DependencyGraph.recalculateVolatile(),this.$.ue(),this.$.Event.emit("afterAutoFilterClear",{sheet:this.sheet,ref:r,range:o,...i})})}he(t=null,e={}){const n=this.Xt(t),i=this.Yt(n);if(!i?.range)return;const r=!1!==e.emitEvents,o=!1!==e.recordChange,a=!0===e.silent,s=!1!==e.recalculate,l=this.ne(n,i),c=()=>{const t=i.hiddenRows,e=this.Qt(i),c=[],h=[];t.forEach(t=>{e.has(t)||h.push(t)}),e.forEach(e=>{t.has(e)||c.push(e)}),i.hiddenRows=e;const u=this.ee();o&&this.$.ht({type:"autoFilter",action:"apply",sheet:this.sheet,hiddenRowsAdded:c,hiddenRowsRemoved:h,allHiddenRowsAdded:u.hiddenRowsAdded,allHiddenRowsRemoved:u.hiddenRowsRemoved,scopeId:n}),s&&this.$.DependencyGraph&&"manual"!==this.$.calcMode&&this.$.DependencyGraph.recalculateVolatile(),a||this.$.ue(),r&&this.$.Event.emit("afterAutoFilterApply",{sheet:this.sheet,range:i.range,hiddenRowsAdded:c,hiddenRowsRemoved:h,allHiddenRowsAdded:u.hiddenRowsAdded,allHiddenRowsRemoved:u.hiddenRowsRemoved,...l})};return r&&this.$.Event.emit("beforeAutoFilterApply",{sheet:this.sheet,range:i.range,columns:i.columns,...l}).canceled?void 0:o?this.$.st("autoFilterApply",{sheet:this.sheet,range:i.range,scopeId:n},c,{joinParent:!1}):void c()}te(t,e){if("values"===e.type){const n=String(t??"");return e.values.some(t=>String(t??"")===n)}return"custom"!==e.type||this.me(t,e.filters,e.and)}me(t,e,n=!0){if(!e||0===e.length)return!0;const i=e.map(e=>this.pe(t,e));return n?i.every(Boolean):i.some(Boolean)}pe(t,e){const{operator:n,value:i}=e,r="number"==typeof t?t:parseFloat(t),o=parseFloat(i),a=String(t??"").toLowerCase(),s=String(i??"").toLowerCase();switch(n){case"equal":return a===s;case"notEqual":return a!==s;case"greaterThan":return r>o;case"greaterThanOrEqual":return r>=o;case"lessThan":return r<o;case"lessThanOrEqual":return r<=o;case"beginsWith":return a.startsWith(s);case"endsWith":return a.endsWith(s);case"contains":return a.includes(s);case"notContains":return!a.includes(s);default:return!0}}hasFilter(t,e=null){const n=this.Yt(e);return!!n&&n.columns.has(t)}setSortState(t,e,n=null){const i=this.Yt(n);i&&(i.sortState={colIndex:t,order:e})}getSortOrder(t,e=null){const n=this.Yt(e);return n?.sortState&&n.sortState.colIndex===t?n.sortState.order:null}isRowFilteredHidden(t){return this.Gt.has(t)}le(t,e=null){if(!t)return null;const n=A(e),i=t._$ref,r=i?A(this.sheet.rangeStrToNum(i)):n;if(!r)return null;const o={ref:i||this.$.Utils.rangeNumToStr(r),range:r,columns:new Map,sortState:null},a=t.filterColumn;a&&(Array.isArray(a)?a:[a]).forEach(t=>{const e=parseInt(t._$colId,10);if(!Number.isFinite(e))return;const n=r.e.c-r.s.c+1;let i=e;if(e>=0&&e<n&&(i=r.s.c+e),t.filters){const e=t.filters.filter,n=[];e&&(Array.isArray(e)?e:[e]).forEach(t=>{n.push(t._$val)}),"1"===t.filters._$blank&&n.push(""),o.columns.set(i,{type:"values",values:n})}if(t.customFilters){const e=t.customFilters.customFilter,n=[];e&&(Array.isArray(e)?e:[e]).forEach(t=>{n.push({operator:t._$operator||"equal",value:t._$val})});const r="1"===t.customFilters._$and;o.columns.set(i,{type:"custom",filters:n,and:r})}});const s=t.sortState;if(s){const t=s.sortCondition;if(t){const e=Array.isArray(t)?t[0]:t,n=e._$ref;if(n){const t=String(n).toUpperCase().match(/\$?([A-Z]+)/);if(t){const n=this.$.Utils.charToNum(t[1]),i="1"===e._$descending;o.sortState={colIndex:n,order:i?"desc":"asc",ref:s._$ref}}}}}return o}ce(t,e,n={}){if(t){if(!e?.range)return t.ref=null,t.range=null,t.columns.clear(),t.sortState=null,t.hiddenRows.clear(),void this.ee();if(t.ref=e.ref,t.range=e.range,t.columns=e.columns,t.sortState=e.sortState,t.hiddenRows=new Set,!0===n.restoreHiddenRowsFromSheet&&t.columns.size>0)for(let e=t.range.s.r+1;e<=t.range.e.r;e++){const n=this.sheet.rows[e];n&&n.St&&(n.St=!1,t.hiddenRows.add(e))}this.ee()}}parse(t){const e=t?.AutoFilter;if(!e)return;const n=this.Jt(),i=this.le(e,null);i&&this.ce(n,i,{restoreHiddenRowsFromSheet:!0})}parseScope(t,e,n={}){const i=this.Yt(t,!0,{ownerType:n.ownerType||"custom",ownerId:n.ownerId??null}),r=this.le(e,n.range||null);r&&this.ce(i,r,{restoreHiddenRowsFromSheet:!0===n.restoreHiddenRowsFromSheet})}ve(t){if(!t?.ref||!t?.range)return null;const e={"_$ref":t.ref};if(t.columns.size>0){e.filterColumn=[];for(const[n,i]of t.columns){const r=n-t.range.s.c;if(!Number.isFinite(r)||r<0)continue;const o={"_$colId":String(r)};if("values"===i.type){o.filters={},i.values.some(t=>""===t||null==t)&&(o.filters._$blank="1");const t=i.values.filter(t=>""!==t&&null!=t);t.length>0&&(o.filters.filter=t.map(t=>({"_$val":String(t)})))}else"custom"===i.type&&(o.customFilters={},i.and&&(o.customFilters._$and="1"),o.customFilters.customFilter=i.filters.map(t=>({"_$operator":t.operator,"_$val":String(t.value)})));e.filterColumn.push(o)}}if(t.sortState){const n=t.range,i=this.$.Utils.rangeNumToStr({s:{r:n.s.r+1,c:n.s.c},e:{r:n.e.r,c:n.e.c}}),r=this.$.Utils.numToChar(t.sortState.colIndex),o=`${r}${n.s.r+1}:${r}${n.e.r+1}`;e.sortState={"_$ref":i,sortCondition:{"_$ref":o}},"desc"===t.sortState.order&&(e.sortState.sortCondition._$descending="1")}return e}buildXml(t=this.Kt){const e=this.Yt(t);return this.ve(e)}}function k(t,e){if("object"==typeof t&&t){if(t._$rgb)return"#"+t._$rgb.substring(2);if(t._$indexed)return["#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#000000","#ffffff","#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#800000","#008000","#000080","#808000","#800080","#008080","#c0c0c0","#808080","#9999ff","#993366","#ffffcc","#ccffff","#660066","#ff8080","#0066cc","#ccccff","#000080","#ff00ff","#ffff00","#00ffff","#800080","#800000","#008080","#0000ff","#00ccff","#ccffff","#ccffcc","#ffff99","#99ccff","#ff99cc","#cc99ff","#ffcc99","#3366ff","#33cccc","#99cc00","#ffcc00","#ff9900","#ff6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"][Number(t._$indexed)]??"#000000";if(t._$theme)return R(parseFloat(t._$theme),parseFloat(t._$tint??0),e);if(t._$val){const n={"lt1":0,"dk1":1,"lt2":2,"dk2":3,"accent1":4,"accent2":5,"accent3":6,"accent4":7,"accent5":8,"accent6":9,"hlink":10,"folHlink":11}[t._$val];if(void 0!==n&&e){let i=0;return t["a:tint"]?._$val?i=parseFloat(t["a:tint"]._$val)/1e5:t["a:shade"]?._$val&&(i=-parseFloat(t["a:shade"]._$val)/1e5),R(n,i,e)}return"#000000"}return"#000000"}}function R(t,e,n){if(!n?.Xml)return"#000000";const i=(n.Xml.clrScheme??n.Xml.clrSchemeTp)[["a:lt1","a:dk1","a:lt2","a:dk2","a:accent1","a:accent2","a:accent3","a:accent4","a:accent5","a:accent6","a:hlink","a:folHlink"][t]];if(!i)throw new Error("Invalid theme index");let r;if(i["a:srgbClr"]?r=i["a:srgbClr"]._$val:i["a:sysClr"]&&(r=i["a:sysClr"]._$lastClr),!r)throw new Error("Invalid color structure");return"#"+function(t,e){const n=255,i=240,r=(t,e,n)=>Math.min(n,Math.max(e,t)),o=parseInt(t.slice(0,2),16)/n,a=parseInt(t.slice(2,4),16)/n,s=parseInt(t.slice(4,6),16)/n,l=Math.max(o,a,s),c=Math.min(o,a,s),h=l-c;let u=0,d=0,f=(l+c)/2;h>0&&(d=f>.5?h/(2-l-c):h/(l+c),u=l===o?(a-s)/h+(a<s?6:0):l===a?(s-o)/h+2:(o-a)/h+4,u/=6);let p=f*i;e<0?p*=1+e:p=p*(1-e)+(i-i*(1-e)),f=r(p/i,0,1);const m=(t,e,n)=>{let i=n;return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t};let g,v,y;if(0===d)g=f,v=f,y=f;else{const t=f<.5?f*(1+d):f+d-f*d,e=2*f-t;g=m(e,t,u+1/3),v=m(e,t,u),y=m(e,t,u-1/3)}return((1<<24)+(r(Math.round(g*n),0,n)<<16)+(r(Math.round(v*n),0,n)<<8)+r(Math.round(y*n),0,n)).toString(16).slice(1).toUpperCase()}(r,e)}const _={"TableStyleDark6":{0:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[8,-.499985],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[8,-.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[8,-.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[8,-.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,-.249977]},8:{"ff":"#000000"}},"TableStyleMedium2":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[4,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,.799982]},8:{"ff":"#000000"}},"TableStyleDark2":{0:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[4,-.499985],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[4,-.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[4,-.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[4,-.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,-.249977]},8:{"ff":"#000000"}},"TableStyleDark9":{0:{"h":1,"s":1,"fb":[4,.799982]},1:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[4,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,.599994]},8:{"ff":"#000000"}},"TableStyleMedium24":{0:{"h":1,"s":1,"fb":[5,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[5,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[5,.599994]},8:{"ff":"#000000"}},"TableStyleMedium28":{0:{"h":1,"s":1,"fb":[9,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[9,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[9,.599994]},8:{"ff":"#000000"}},"TableStyleDark3":{0:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[5,-.499985],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[5,-.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[5,-.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[5,-.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[5,-.249977]},8:{"ff":"#000000"}},"TableStyleLight16":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[4,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,.799982]},8:{"ff":"#000000"}},"TableStyleMedium18":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleDark1":{0:{"h":1,"s":1,"fb":[1,.449995],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[1,.149998],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[1,.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[1,.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[1,.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[1,.249977]},8:{"ff":"#000000"}},"TableStyleMedium10":{0:{"h":1,"s":1,"fb":[5,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[5,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[5,.599994]},8:{"ff":"#000000"}},"TableStyleLight1":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleMedium14":{0:{"h":1,"s":1,"fb":[9,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[9,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[9,.599994]},8:{"ff":"#000000"}},"TableStyleDark4":{0:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[6,-.499985],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[6,-.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[6,-.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[6,-.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,-.249977]},8:{"ff":"#000000"}},"TableStyleMedium8":{0:{"h":1,"s":1,"fb":[0,-.149998],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.349986]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.349986]},8:{"ff":"#000000"}},"TableStyleLight15":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleLight21":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[9,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[9,.799982]},8:{"ff":"#000000"}},"TableStyleDark7":{0:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[9,-.499985],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[9,-.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[9,-.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[9,-.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[9,-.249977]},8:{"ff":"#000000"}},"TableStyleLight17":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[5,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[5,.799982]},8:{"ff":"#000000"}},"TableStyleMedium20":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleMedium23":{0:{"h":1,"s":1,"fb":[4,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[4,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,.599994]},8:{"ff":"#000000"}},"TableStyleMedium4":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[6,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,.799982]},8:{"ff":"#000000"}},"TableStyleLight4":{0:{"h":1,"s":1,"ff":[6,-.249977],"b":1},1:{"h":1,"s":1,"ff":[6,-.249977],"b":1},2:{"h":1,"s":1,"ff":[6,-.249977],"b":1},3:{"h":1,"s":1,"ff":[6,-.249977],"b":1},4:{"h":1,"s":1,"ff":[6,-.249977],"b":1},5:{"h":1,"s":1,"fb":[6,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,.799982]},8:{"ff":"#000000"}},"TableStyleMedium3":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[5,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[5,.799982]},8:{"ff":"#000000"}},"TableStyleMedium13":{0:{"h":1,"s":1,"fb":[8,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[8,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,.599994]},8:{"ff":"#000000"}},"TableStyleMedium9":{0:{"h":1,"s":1,"fb":[4,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[4,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,.599994]},8:{"ff":"#000000"}},"TableStyleLight11":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleLight5":{0:{"h":1,"s":1,"ff":[7,-.249977],"b":1},1:{"h":1,"s":1,"ff":[7,-.249977],"b":1},2:{"h":1,"s":1,"ff":[7,-.249977],"b":1},3:{"h":1,"s":1,"ff":[7,-.249977],"b":1},4:{"h":1,"s":1,"ff":[7,-.249977],"b":1},5:{"h":1,"s":1,"fb":[7,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[7,.799982]},8:{"ff":"#000000"}},"TableStyleLight13":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleMedium21":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleMedium17":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleLight18":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[6,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,.799982]},8:{"ff":"#000000"}},"TableStyleLight8":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleLight14":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleMedium15":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleLight19":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[7,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[7,.799982]},8:{"ff":"#000000"}},"TableStyleMedium11":{0:{"h":1,"s":1,"fb":[6,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[6,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[6,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,.599994]},8:{"ff":"#000000"}},"TableStyleLight2":{0:{"h":1,"s":1,"ff":[4,-.249977],"b":1},1:{"h":1,"s":1,"ff":[4,-.249977],"b":1},2:{"h":1,"s":1,"ff":[4,-.249977],"b":1},3:{"h":1,"s":1,"ff":[4,-.249977],"b":1},4:{"h":1,"s":1,"ff":[4,-.249977],"b":1},5:{"h":1,"s":1,"fb":[4,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[4,.799982]},8:{"ff":"#000000"}},"TableStyleMedium6":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[8,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[8,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,.799982]},8:{"ff":"#000000"}},"TableStyleMedium5":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[7,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[7,.799982]},8:{"ff":"#000000"}},"TableStyleMedium25":{0:{"h":1,"s":1,"fb":[6,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[6,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,.599994]},8:{"ff":"#000000"}},"TableStyleMedium27":{0:{"h":1,"s":1,"fb":[8,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[8,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,.599994]},8:{"ff":"#000000"}},"TableStyleMedium26":{0:{"h":1,"s":1,"fb":[7,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[7,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[7,.599994]},8:{"ff":"#000000"}},"TableStyleMedium19":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleLight3":{0:{"h":1,"s":1,"ff":[5,-.249977],"b":1},1:{"h":1,"s":1,"ff":[5,-.249977],"b":1},2:{"h":1,"s":1,"ff":[5,-.249977],"b":1},3:{"h":1,"s":1,"ff":[5,-.249977],"b":1},4:{"h":1,"s":1,"ff":[5,-.249977],"b":1},5:{"h":1,"s":1,"fb":[5,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[5,.799982]},8:{"ff":"#000000"}},"TableStyleMedium12":{0:{"h":1,"s":1,"fb":[7,.799982],"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[7,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[7,.599994]},8:{"ff":"#000000"}},"TableStyleLight10":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[5,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleLight9":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleDark5":{0:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"fb":[7,-.499985],"ff":[0,0],"b":1},3:{"h":1,"s":1,"fb":[7,-.249977],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[7,-.249977],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[7,-.249977]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[7,-.249977]},8:{"ff":"#000000"}},"TableStyleLight20":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[8,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,.799982]},8:{"ff":"#000000"}},"TableStyleLight12":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1},6:{"h":1,"s":1},7:{"h":1,"s":1},8:{"h":1,"s":1}},"TableStyleDark8":{0:{"h":1,"s":1,"fb":[0,-.149998]},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.349986]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.349986]},8:{"ff":"#000000"}},"TableStyleMedium7":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[9,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[9,.799982]},8:{"ff":"#000000"}},"TableStyleLight6":{0:{"h":1,"s":1,"ff":[8,-.249977],"b":1},1:{"h":1,"s":1,"ff":[8,-.249977],"b":1},2:{"h":1,"s":1,"ff":[8,-.249977],"b":1},3:{"h":1,"s":1,"ff":[8,-.249977],"b":1},4:{"h":1,"s":1,"ff":[8,-.249977],"b":1},5:{"h":1,"s":1,"fb":[8,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,.799982]},8:{"ff":"#000000"}},"TableStyleDark10":{0:{"h":1,"s":1,"fb":[6,.799982]},1:{"h":1,"s":1,"fb":[7,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[6,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[6,.599994]},8:{"ff":"#000000"}},"TableStyleMedium1":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[1,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleDark11":{0:{"h":1,"s":1,"fb":[8,.799982]},1:{"h":1,"s":1,"fb":[9,0],"ff":[0,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[8,.599994]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[8,.599994]},8:{"ff":"#000000"}},"TableStyleMedium22":{0:{"h":1,"s":1,"fb":[0,-.149998],"ff":[1,0],"b":1},1:{"h":1,"s":1,"ff":[1,0],"b":1},2:{"h":1,"s":1,"ff":[1,0],"b":1},3:{"h":1,"s":1,"ff":[1,0],"b":1},4:{"h":1,"s":1,"ff":[1,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.349986]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.349986]},8:{"ff":"#000000"}},"TableStyleMedium16":{0:{"h":1,"s":1,"ff":[1,0],"b":1},1:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},2:{"h":1,"s":1},3:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},4:{"h":1,"s":1,"fb":[4,0],"ff":[0,0],"b":1},5:{"h":1,"s":1,"fb":[0,-.149998]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[0,-.149998]},8:{"ff":"#000000"}},"TableStyleLight7":{0:{"h":1,"s":1,"ff":[9,-.249977],"b":1},1:{"h":1,"s":1,"ff":[9,-.249977],"b":1},2:{"h":1,"s":1,"ff":[9,-.249977],"b":1},3:{"h":1,"s":1,"ff":[9,-.249977],"b":1},4:{"h":1,"s":1,"ff":[9,-.249977],"b":1},5:{"h":1,"s":1,"fb":[9,.799982]},6:{"ff":"#000000"},7:{"h":1,"s":1,"fb":[9,.799982]},8:{"ff":"#000000"}}},I={light:"#DCE6F1",medium:"#4F81BD",dark:"#1F497D"},F={light:"#FDE9D9",medium:"#F79646",dark:"#E26B0A"},E={light:"#D9D9D9",medium:"#808080",dark:"#404040"},D={light:"#FFF2CC",medium:"#FFCC00",dark:"#BF9000"},L={light:"#DAEEF3",medium:"#4BACC6",dark:"#1D6A7C"},P={light:"#EBF1DE",medium:"#9BBB59",dark:"#4F6228"},z={light:"#E5DFEC",medium:"#8064A2",dark:"#4C3B5F"},O={light:"#F2DCDB",medium:"#C0504D",dark:"#952D2A"};function B(t,e,n){const{light:i,medium:r,dark:o}=e;return"light"===n?{name:t,headerBg:null,headerFg:o,headerBorder:r,rowStripe1:null,rowStripe2:i,border:"#D9D9D9",firstColumnBg:null,lastColumnBg:null,totalsBg:null}:"medium"===n?{name:t,headerBg:r,headerFg:"#FFFFFF",headerBorder:r,rowStripe1:"#FFFFFF",rowStripe2:i,border:r,firstColumnBg:i,lastColumnBg:i,totalsBg:i}:{name:t,headerBg:o,headerFg:"#FFFFFF",headerBorder:o,rowStripe1:r,rowStripe2:i,border:o,firstColumnBg:r,lastColumnBg:r,totalsBg:r}}const V={TableStyleLight1:B("TableStyleLight1",E,"light"),TableStyleLight2:B("TableStyleLight2",I,"light"),TableStyleLight3:B("TableStyleLight3",F,"light"),TableStyleLight4:B("TableStyleLight4",E,"light"),TableStyleLight5:B("TableStyleLight5",D,"light"),TableStyleLight6:B("TableStyleLight6",L,"light"),TableStyleLight7:B("TableStyleLight7",P,"light"),TableStyleLight8:B("TableStyleLight8",I,"light"),TableStyleLight9:B("TableStyleLight9",F,"light"),TableStyleLight10:B("TableStyleLight10",E,"light"),TableStyleLight11:B("TableStyleLight11",I,"light"),TableStyleLight12:B("TableStyleLight12",F,"light"),TableStyleLight13:B("TableStyleLight13",D,"light"),TableStyleLight14:B("TableStyleLight14",L,"light"),TableStyleLight15:B("TableStyleLight15",P,"light"),TableStyleLight16:B("TableStyleLight16",z,"light"),TableStyleLight17:B("TableStyleLight17",O,"light"),TableStyleLight18:B("TableStyleLight18",I,"light"),TableStyleLight19:B("TableStyleLight19",F,"light"),TableStyleLight20:B("TableStyleLight20",E,"light"),TableStyleLight21:B("TableStyleLight21",I,"light"),TableStyleMedium1:B("TableStyleMedium1",E,"medium"),TableStyleMedium2:B("TableStyleMedium2",I,"medium"),TableStyleMedium3:B("TableStyleMedium3",F,"medium"),TableStyleMedium4:B("TableStyleMedium4",E,"medium"),TableStyleMedium5:B("TableStyleMedium5",D,"medium"),TableStyleMedium6:B("TableStyleMedium6",L,"medium"),TableStyleMedium7:B("TableStyleMedium7",P,"medium"),TableStyleMedium8:B("TableStyleMedium8",I,"medium"),TableStyleMedium9:B("TableStyleMedium9",F,"medium"),TableStyleMedium10:B("TableStyleMedium10",E,"medium"),TableStyleMedium11:B("TableStyleMedium11",I,"medium"),TableStyleMedium12:B("TableStyleMedium12",F,"medium"),TableStyleMedium13:B("TableStyleMedium13",D,"medium"),TableStyleMedium14:B("TableStyleMedium14",L,"medium"),TableStyleMedium15:B("TableStyleMedium15",P,"medium"),TableStyleMedium16:B("TableStyleMedium16",z,"medium"),TableStyleMedium17:B("TableStyleMedium17",O,"medium"),TableStyleMedium18:B("TableStyleMedium18",I,"medium"),TableStyleMedium19:B("TableStyleMedium19",F,"medium"),TableStyleMedium20:B("TableStyleMedium20",E,"medium"),TableStyleMedium21:B("TableStyleMedium21",I,"medium"),TableStyleMedium22:B("TableStyleMedium22",F,"medium"),TableStyleMedium23:B("TableStyleMedium23",E,"medium"),TableStyleMedium24:B("TableStyleMedium24",D,"medium"),TableStyleMedium25:B("TableStyleMedium25",L,"medium"),TableStyleMedium26:B("TableStyleMedium26",P,"medium"),TableStyleMedium27:B("TableStyleMedium27",z,"medium"),TableStyleMedium28:B("TableStyleMedium28",O,"medium"),TableStyleDark1:B("TableStyleDark1",E,"dark"),TableStyleDark2:B("TableStyleDark2",I,"dark"),TableStyleDark3:B("TableStyleDark3",F,"dark"),TableStyleDark4:B("TableStyleDark4",E,"dark"),TableStyleDark5:B("TableStyleDark5",D,"dark"),TableStyleDark6:B("TableStyleDark6",L,"dark"),TableStyleDark7:B("TableStyleDark7",P,"dark"),TableStyleDark8:B("TableStyleDark8",I,"dark"),TableStyleDark9:B("TableStyleDark9",F,"dark"),TableStyleDark10:B("TableStyleDark10",z,"dark"),TableStyleDark11:B("TableStyleDark11",O,"dark")};function H(...t){for(const e of t)if(void 0!==e)return e}function U(t,e){if(Array.isArray(t)&&t.length>=2){if(!e?.Xml)return;const[n,i]=t;try{return R(n,i,e)}catch(t){return}}if("string"==typeof t)return t}function q(t,e,n){const i=t?.[e];if(!i)return{hasFormat:!1,bgColor:void 0,fgColor:void 0,isBold:void 0,stripeSize:1};const r=1===i.h;if(!r)return{hasFormat:!1,bgColor:void 0,fgColor:void 0,isBold:void 0,stripeSize:i.s||1};const o=Object.prototype.hasOwnProperty.call(i,"fb"),a=Object.prototype.hasOwnProperty.call(i,"ff"),s=o?U(i.fb,n):null;return{hasFormat:r,bgColor:o?s:null,fgColor:a?U(i.ff,n):void 0,isBold:1===i.b||void 0,stripeSize:i.s||1}}function K(t,e){if(null===t)return null;const n=V[t]||V.TableStyleMedium2,i=_[t];if(!i)return{...n,be:!1};const r=q(i,"0",e),o=q(i,"1",e),a=q(i,"2",e),s=q(i,"3",e),l=q(i,"4",e),c=q(i,"5",e),h=q(i,"6",e),u=q(i,"7",e),d=q(i,"8",e),f=H(c.bgColor,r.bgColor,n.rowStripe1),p=H(h.bgColor,r.bgColor,n.rowStripe2);return{be:!0,name:n.name||t,headerBg:H(o.bgColor,r.bgColor,n.headerBg),headerFg:H(o.fgColor,r.fgColor,n.headerFg),headerBold:H(o.isBold,!0),headerBorder:n.headerBorder,dataBg:H(r.bgColor,n.dataBg,null),dataFg:H(r.fgColor,n.dataFg,null),dataBold:H(n.dataBold,!1),rowStripe1:f,rowStripe2:p,rowStripe1Size:c.stripeSize||1,rowStripe2Size:h.stripeSize||c.stripeSize||1,columnStripe1:H(u.bgColor,n.columnStripe1,void 0),columnStripe2:H(d.bgColor,n.columnStripe2,void 0),columnStripe1Size:u.stripeSize||1,columnStripe2Size:d.stripeSize||u.stripeSize||1,firstColumnBg:s.hasFormat?H(s.bgColor,r.bgColor,null):n.firstColumnBg,firstColumnFg:H(s.fgColor,r.fgColor,n.firstColumnFg,n.dataFg,null),firstColumnBold:H(s.isBold,n.firstColumnBold,!1),lastColumnBg:l.hasFormat?H(l.bgColor,r.bgColor,null):n.lastColumnBg,lastColumnFg:H(l.fgColor,r.fgColor,n.lastColumnFg,n.dataFg,null),lastColumnBold:H(l.isBold,n.lastColumnBold,!1),totalsBg:H(a.bgColor,r.bgColor,n.totalsBg),totalsFg:H(a.fgColor,r.fgColor,n.totalsFg,n.dataFg,null),totalsBold:H(a.isBold,!0),border:n.border}}const W={light:Object.keys(V).filter(t=>t.startsWith("TableStyleLight")),medium:Object.keys(V).filter(t=>t.startsWith("TableStyleMedium")),dark:Object.keys(V).filter(t=>t.startsWith("TableStyleDark"))};function j(t,e){const n=K(t,e)||V[t];return n?{header:n.headerBg||"#FFFFFF",stripe1:n.rowStripe1||"#FFFFFF",stripe2:n.rowStripe2||"#F2F2F2",border:n.border||"#D9D9D9"}:null}function G(t){if(!t||"string"!=typeof t)return null;const[e,n]=t.split(":");if(!e)return null;const i=Y(e);return{s:i,e:n?Y(n):{...i}}}function X(t){if(!t||!t.s)return"";const e=Z(t.s.r,t.s.c),n=Z(t.e.r,t.e.c);return e===n?e:`${e}:${n}`}function Y(t){const e=t.match(/^([A-Z]+)(\d+)$/i);if(!e)return{r:0,c:0};const n=function(t){let e=0;for(let n=0;n<t.length;n++)e=26*e+(t.charCodeAt(n)-64);return e-1}(e[1]);return{r:parseInt(e[2],10)-1,c:n}}function Z(t,e){return function(t){let e="",n=t+1;for(;n>0;)n--,e=String.fromCharCode(65+n%26)+e,n=Math.floor(n/26);return e}(e)+(t+1)}const J={sum:109,average:101,count:103,countNums:102,max:104,min:105,stdDev:107,var:110},Q={sum:"sum",average:"average",count:"count",countnums:"countNums",max:"max",min:"min",stddev:"stdDev",var:"var"};class tt{constructor(t,e={}){this.sheet=t,this.id=e.id||this.ge(),this.ye=e.name||`表${this.id}`,this.we=e.displayName||this.ye;const n=e.rangeRef??e.ref??null;this.re=n?G(n):null,this.columns=e.columns||[],this.xe=e.styleId||"TableStyleMedium2",this.showHeaderRow=e.showHeaderRow??!0,this.$e=e.showTotalsRow??!1,this.showFirstColumn=e.showFirstColumn??!1,this.showLastColumn=e.showLastColumn??!1,this.showRowStripes=e.showRowStripes??!0,this.showColumnStripes=e.showColumnStripes??!1,this.Me=e.autoFilterEnabled??!0,this.Ce=!0===e.Ce,this.Se=null,this.Re=-1,this.Ae=-1,this.ke=-1,this.headerRowDxfId=e.headerRowDxfId,this.dataDxfId=e.dataDxfId,this.headerRowBorderDxfId=e.headerRowBorderDxfId,this.tableBorderDxfId=e.tableBorderDxfId,this.totalsRowBorderDxfId=e.totalsRowBorderDxfId,this.Te=null,this.Ne=null,this.Fe=null,this._e=new Map}ge(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}get name(){return this.ye}set name(t){if(!t||"string"!=typeof t)throw new Error("请输入有效的表名");const e=t.trim();if(!e)throw new Error("表名不能为空");const n=this.ye;if(n===e)return;const i=this.sheet.Table.getByName(e);if(i&&i!==this)throw new Error(`表名 "${e}" 已被使用`);this.sheet.SN.Event.hasListeners("beforeTableRename")&&this.sheet.SN.Event.emit("beforeTableRename",{sheet:this.sheet,table:this,oldName:n,newName:e}).canceled||(this.ye=e,this.we=e,this.sheet.Table.Ee(n,e,this),this.sheet.SN.Event.hasListeners("afterTableRename")&&this.sheet.SN.Event.emit("afterTableRename",{sheet:this.sheet,table:this,oldName:n,newName:e}))}get displayName(){return this.we}set displayName(t){this.we=t}get styleId(){return this.xe}set styleId(t){const e=this.xe??null;let n=null;if(null===t)n=null;else{if(!V[t])return;n=t}if(e!==n){if(this.sheet.SN.Event.hasListeners("beforeTableStyleChange")&&this.sheet.SN.Event.emit("beforeTableStyleChange",{sheet:this.sheet,table:this,oldStyle:e,newStyle:n}).canceled)return;this.xe=n,this.Ie(),this.sheet.SN.Event.hasListeners("afterTableStyleChange")&&this.sheet.SN.Event.emit("afterTableStyleChange",{sheet:this.sheet,table:this,oldStyle:e,newStyle:n})}}get showTotalsRow(){return this.$e}set showTotalsRow(t){if(!this.re)return;const e=!!t;if(this.$e===e)return;const n=this.$e;this.sheet.SN.Event.hasListeners("beforeTableTotalsRowToggle")&&this.sheet.SN.Event.emit("beforeTableTotalsRowToggle",{sheet:this.sheet,table:this,oldValue:n,newValue:e}).canceled||(e?this.re.e.r+=1:this.re.e.r-=1,this.$e=e,e&&this.applyTotalsRow({initializeDefaults:!0,force:!0}),this.ze(),this.sheet.SN.Event.hasListeners("afterTableTotalsRowToggle")&&this.sheet.SN.Event.emit("afterTableTotalsRowToggle",{sheet:this.sheet,table:this,oldValue:n,newValue:e}))}get autoFilterEnabled(){return this.Me}set autoFilterEnabled(t){const e=!!t,n=this.Me;if(n!==e){if(this.sheet.SN.Event.hasListeners("beforeTableAutoFilterToggle")&&this.sheet.SN.Event.emit("beforeTableAutoFilterToggle",{sheet:this.sheet,table:this,oldValue:n,newValue:e}).canceled)return;this.Me=e,e?this.ze():this.sheet.AutoFilter.unregisterTableScope(this.id),this.sheet.SN.Event.hasListeners("afterTableAutoFilterToggle")&&this.sheet.SN.Event.emit("afterTableAutoFilterToggle",{sheet:this.sheet,table:this,oldValue:n,newValue:e})}}get ref(){return this.re?X(this.re):null}set ref(t){this.re="string"==typeof t?G(t):t}get range(){return this.re}get headerRowIndex(){return this.showHeaderRow&&this.re?this.re.s.r:-1}get dataStartRow(){return this.re?this.showHeaderRow?this.re.s.r+1:this.re.s.r:-1}get dataEndRow(){return this.re?this.showTotalsRow?this.re.e.r-1:this.re.e.r:-1}get totalsRowIndex(){return this.showTotalsRow&&this.re?this.re.e.r:-1}get style(){if(null===this.xe)return null;const t=this.sheet?.SN?.Xml?.clrScheme||this.sheet?.SN?.Xml?.clrSchemeTp||null;if(this.Te&&this.Ne===this.xe&&this.Fe===t)return this.Te;const e=K(this.xe,this.sheet?.SN)||V.TableStyleMedium2;return this.Te=e,this.Ne=this.xe,this.Fe=t,e}contains(t,e){if(!this.re)return!1;const{s:n,e:i}=this.re;return t>=n.r&&t<=i.r&&e>=n.c&&e<=i.c}isHeaderCell(t,e){return this.showHeaderRow&&this.contains(t,e)&&t===this.re.s.r}isTotalsCell(t,e){return this.showTotalsRow&&this.contains(t,e)&&t===this.re.e.r}isDataCell(t,e){return!!this.contains(t,e)&&!this.isHeaderCell(t,e)&&!this.isTotalsCell(t,e)}getDataRowIndex(t){if(!this.re)return-1;const e=this.dataStartRow,n=this.dataEndRow;if(t<e||t>n)return-1;const i=this.sheet.Rt||0;if(!this.Se||this.Re!==e||this.Ae!==n||this.ke!==i){const t=new Int32Array(n-e+1);t.fill(-1);let r=0;for(let i=e;i<=n;i++)this.sheet.getRow(i).hidden||(t[i-e]=r,r+=1);this.Se=t,this.Re=e,this.Ae=n,this.ke=i}return this.Se[t-e]??-1}getColumnIndex(t){return this.re?t<this.re.s.c||t>this.re.e.c?-1:t-this.re.s.c:-1}getColumn(t){return this.columns[t]||null}De(t){if(null==t||""===t)return null;const e=Number.parseInt(t,10);return!Number.isInteger(e)||e<0?null:e}Le(t){const e=this.De(t);if(null===e)return null;if(this._e.has(e))return this._e.get(e);const n=this.sheet?.SN?.Xml?.Oe?.(e)||null;return this._e.set(e,n),n}Pe(){return this.Le(this.headerRowDxfId)}Ve(t){const e=this.getColumn(t),n=e?.dataDxfId??this.dataDxfId;return this.Le(n)}Ie(){let t=!1;const e=e=>{void 0!==this[e]&&null!==this[e]&&""!==this[e]&&(this[e]=void 0,t=!0)};e("headerRowDxfId"),e("dataDxfId"),e("headerRowBorderDxfId"),e("tableBorderDxfId"),e("totalsRowBorderDxfId");for(const n of this.columns)n&&void 0!==n.dataDxfId&&null!==n.dataDxfId&&""!==n.dataDxfId&&(delete n.dataDxfId,t=!0);t&&this._e.clear()}getColumnIndexByName(t){return this.columns.findIndex(e=>e.name===t)}resize(t){const e=this.re,n="string"==typeof t?G(t):t;if(this.sheet.SN.Event.hasListeners("beforeTableResize")&&this.sheet.SN.Event.emit("beforeTableResize",{sheet:this.sheet,table:this,oldRef:e,newRef:n}).canceled)return;this.re=n;const i=this.re.e.c-this.re.s.c+1;for(;this.columns.length<i;)this.columns.push({id:this.columns.length+1,name:`列${this.columns.length+1}`});this.columns.length>i&&(this.columns=this.columns.slice(0,i)),this.showTotalsRow&&this.applyTotalsRow({initializeDefaults:!0}),this.autoFilterEnabled&&this.ze(),this.sheet.SN.Event.hasListeners("afterTableResize")&&this.sheet.SN.Event.emit("afterTableResize",{sheet:this.sheet,table:this,oldRef:e,newRef:this.re})}syncColumnNames(){if(!this.showHeaderRow||!this.re)return;const t=this.re.s.r,e=this.re.e.c-this.re.s.c+1;for(;this.columns.length<e;)this.columns.push({id:this.columns.length+1,name:`列${this.columns.length+1}`});for(let n=this.re.s.c;n<=this.re.e.c;n++){const e=this.sheet.getCell(t,n),i=n-this.re.s.c,r=e.calcVal??e.v;this.columns[i].name=r?.toString()||`列${i+1}`}}ze(){this.autoFilterEnabled&&this.re&&this.sheet.AutoFilter.registerTableScope(this,{keepFilters:!0})}Be(t){if(null==t)return null;const e=String(t).trim();if(!e)return null;const n=e.toLowerCase();return"none"===n||"null"===n?null:Q[n]||null}He(t){for(;this.columns.length<=t;)this.columns.push({id:this.columns.length+1,name:`列${this.columns.length+1}`});const e=this.columns[t];return e.id||(e.id=t+1),e.name||(e.name=`列${t+1}`),e}Ue(t){if(!this.re||t<0)return!1;if(this.dataEndRow<this.dataStartRow)return!1;const e=this.re.s.c+t;let n=!1;for(let i=this.dataStartRow;i<=this.dataEndRow;i++){const t=this.sheet.rows[i],r=t?.cells?.[e];if(!r)continue;const o=r.type;if("date"===o||"dateTime"===o||"time"===o)continue;const a=r.calcVal;"number"==typeof a&&Number.isFinite(a)&&(n=!0)}return n}Ke(t,e){const n=this.Be(e);if(!n)return"";const i=J[n];if(!i)return"";if(this.dataEndRow<this.dataStartRow)return"=0";const r=this.re.s.c+t;return`=SUBTOTAL(${i},${Z(this.dataStartRow,r)}:${Z(this.dataEndRow,r)})`}We(){if(!this.re)return;const t=this.re.e.c-this.re.s.c+1;if(t<=0)return;const e=this.He(0);e.totalsRowFunction||e.totalsRowLabel||(e.totalsRowLabel="总计");for(let n=0;n<t;n++){const t=this.He(n);t.totalsRowFunction||t.totalsRowLabel||this.Ue(n)&&(t.totalsRowFunction="sum")}}je(t,e={}){if(!this.showTotalsRow||!this.re)return;const n=!0===e.force,i=this.totalsRowIndex;if(i<0)return;const r=this.He(t);if("custom"===(r.totalsRowFunction??"").toString().trim().toLowerCase())return;const o=this.Ke(t,r.totalsRowFunction),a=(r.totalsRowLabel??"").toString(),s=o||a;if(!n&&!s)return;const l=this.sheet.getCell(i,this.re.s.c+t);l.editVal!==s&&(l.editVal=s)}applyTotalsRow(t={}){if(!this.showTotalsRow||!this.re)return;const e=this.re.e.c-this.re.s.c+1;if(!(e<=0)){for(;this.columns.length<e;)this.columns.push({id:this.columns.length+1,name:`列${this.columns.length+1}`});t.initializeDefaults&&this.We();for(let n=0;n<e;n++)this.je(n,{force:!0===t.force})}}setTotalsFunction(t,e){if(!this.re)return;const n=this.re.e.c-this.re.s.c+1;if(t<0||t>=n)throw new Error("Column index is out of table range");const i=null==e?"":String(e).trim(),r=this.Be(i),o=i.toLowerCase();if(!r&&i&&"none"!==o&&"null"!==o)throw new Error(`Unsupported totals function: ${e}`);const a=this.He(t);a.totalsRowFunction=r,r?a.totalsRowLabel=null:0!==t||a.totalsRowLabel||(a.totalsRowLabel="总计"),this.showTotalsRow?this.je(t,{force:!0}):this.showTotalsRow=!0}convertToRange(){this.autoFilterEnabled&&this.sheet.AutoFilter.unregisterTableScope(this.id),this.sheet.Table.remove(this.id)}toJSON(){return{id:this.id,name:this.name,displayName:this.displayName,ref:this.ref,columns:this.columns,styleId:this.styleId,showHeaderRow:this.showHeaderRow,showTotalsRow:this.showTotalsRow,showFirstColumn:this.showFirstColumn,showLastColumn:this.showLastColumn,showRowStripes:this.showRowStripes,showColumnStripes:this.showColumnStripes,autoFilterEnabled:this.autoFilterEnabled,headerRowDxfId:this.headerRowDxfId,dataDxfId:this.dataDxfId,headerRowBorderDxfId:this.headerRowBorderDxfId,tableBorderDxfId:this.tableBorderDxfId,totalsRowBorderDxfId:this.totalsRowBorderDxfId}}static fromJSON(t,e){return new tt(t,e)}}class et{constructor(t){this.sheet=t,this.qe=new Map}get size(){return this.qe.size}getAll(){return Array.from(this.qe.values())}get(t){return this.qe.get(t)||null}getByName(t){for(const e of this.qe.values())if(e.name===t||e.displayName===t)return e;return null}getTableAt(t,e){for(const n of this.qe.values())if(n.contains(t,e))return n;return null}add(t={}){if(t.name||(t.name=function(t,e="表"){let n=1,i=`${e}${n}`;const r=new Set;for(t.forEach(t=>r.add(t.name));r.has(i);)n++,i=`${e}${n}`;return i}(this.qe)),t.displayName||(t.displayName=t.name),this.sheet.SN.Event.hasListeners("beforeTableAdd")&&this.sheet.SN.Event.emit("beforeTableAdd",{sheet:this.sheet,options:t}).canceled)return null;const e=new tt(this.sheet,t);this.qe.set(e.id,e);const n=!0===t.Ce;return!n&&e.showHeaderRow&&e.range&&e.syncColumnNames(),!n&&e.showTotalsRow&&e.range&&e.applyTotalsRow({initializeDefaults:!0,force:!0}),e.autoFilterEnabled&&e.range&&this.sheet.AutoFilter.registerTableScope(e,{keepFilters:!1,silent:n,autoFilterXml:t.Ge||null,restoreHiddenRowsFromSheet:n}),this.sheet.SN.Event.hasListeners("afterTableAdd")&&this.sheet.SN.Event.emit("afterTableAdd",{sheet:this.sheet,table:e,options:t}),e}createFromSelection(t,e={}){const n={s:{r:Math.min(t.s.r,t.e.r),c:Math.min(t.s.c,t.e.c)},e:{r:Math.max(t.s.r,t.e.r),c:Math.max(t.s.c,t.e.c)}},i=t=>null==t||""===t.toString().trim();for(const s of this.qe.values())if(this.Xe(n,s.range))throw new Error("选区与现有表格重叠");const r=n.e.c-n.s.c+1,o=[],a=!1!==e.showHeaderRow;for(let s=0;s<r;s++){const t=n.s.c+s,e=`列${s+1}`;let r=e;if(a){const o=this.sheet.getCell(n.s.r,t),a=o.calcVal??o.v??o.editVal;i(a)?o.editVal=e:r=a.toString()}o.push({id:s+1,name:r})}return this.add({...e,rangeRef:X(n),columns:o,showHeaderRow:a})}remove(t){const e=this.qe.get(t);if(e){if(this.sheet.SN.Event.hasListeners("beforeTableRemove")&&this.sheet.SN.Event.emit("beforeTableRemove",{sheet:this.sheet,table:e,id:t}).canceled)return!1;e.autoFilterEnabled&&this.sheet.AutoFilter.unregisterTableScope(e.id);const n=this.qe.delete(t);return n&&this.sheet.SN.Event.hasListeners("afterTableRemove")&&this.sheet.SN.Event.emit("afterTableRemove",{sheet:this.sheet,table:e,id:t}),n}return!1}removeByName(t){const e=this.getByName(t);return!!e&&this.remove(e.id)}Ee(t,e,n){}Xe(t,e){return!(!t||!e||t.e.r<e.s.r||t.s.r>e.e.r||t.e.c<e.s.c||t.s.c>e.e.c)}forEach(t){this.qe.forEach(t)}toJSON(){return this.getAll().map(t=>t.toJSON())}fromJSON(t){this.qe.forEach(t=>{t.autoFilterEnabled&&this.sheet.AutoFilter.unregisterTableScope(t.id,{silent:!0})}),this.qe.clear(),Array.isArray(t)&&t.forEach(t=>{const e=tt.fromJSON(this.sheet,t);this.qe.set(e.id,e),e.autoFilterEnabled&&e.range&&this.sheet.AutoFilter.registerTableScope(e,{keepFilters:!1,silent:!0})})}}const nt=Object.freeze({SYSTEM:-2e3,PROTECTION:-1e3,PLUGIN:-500,NORMAL:0,LATE:500,AUDIT:1e3}),it=Object.freeze({ALL:"all",VALUE:"value",FORMULA:"formula",FORMAT:"format",NO_BORDER:"noBorder",COLUMN_WIDTH:"colWidth",COMMENT:"comment",VALIDATION:"validation",TRANSPOSE:"transpose",VALUE_NUMBER_FORMAT:"valueNumberFormat",ALL_MERGE_CONDITIONAL:"allMergeConditional",FORMULA_NUMBER_FORMAT:"formulaNumberFormat"}),rt=Object.freeze({NONE:"none",ADD:"add",SUBTRACT:"sub",MULTIPLY:"mul",DIVIDE:"div"}),ot=Object.freeze({TWO_CELL:"twoCell",ONE_CELL:"oneCell",ABSOLUTE:"absolute"}),at=Object.freeze({CHART:"chart",IMAGE:"image",SHAPE:"shape",SLICER:"slicer"}),st=Object.freeze({LIST:"list",WHOLE:"whole",DECIMAL:"decimal",DATE:"date",TIME:"time",TEXT_LENGTH:"textLength",CUSTOM:"custom"}),lt=Object.freeze({BETWEEN:"between",NOT_BETWEEN:"notBetween",EQUAL:"equal",NOT_EQUAL:"notEqual",GREATER_THAN:"greaterThan",GREATER_THAN_OR_EQUAL:"greaterThanOrEqual",LESS_THAN:"lessThan",LESS_THAN_OR_EQUAL:"lessThanOrEqual"}),ct=Object.freeze({EQUAL:"equal",NOT_EQUAL:"notEqual",GREATER_THAN:"greaterThan",GREATER_THAN_OR_EQUAL:"greaterThanOrEqual",LESS_THAN:"lessThan",LESS_THAN_OR_EQUAL:"lessThanOrEqual",BEGINS_WITH:"beginsWith",ENDS_WITH:"endsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains"}),ht=Object.freeze({CELL_VALUE:"cellIs",TEXT_CONTAINS:"containsText",DATE_OCCURRING:"timePeriod",TOP_BOTTOM:"top10",ABOVE_AVERAGE:"aboveAverage",DUPLICATE:"duplicateValues",UNIQUE:"uniqueValues",DATA_BAR:"dataBar",COLOR_SCALE:"colorScale",ICON_SET:"iconSet",EXPRESSION:"expression"}),ut=Object.freeze({ASC:"asc",DESC:"desc"}),dt=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify",FILL:"fill",DISTRIBUTED:"distributed"}),ft=Object.freeze({TOP:"top",CENTER:"center",BOTTOM:"bottom",JUSTIFY:"justify",DISTRIBUTED:"distributed"}),pt=Object.freeze({NONE:"none",THIN:"thin",MEDIUM:"medium",THICK:"thick",DASHED:"dashed",DOTTED:"dotted",DOUBLE:"double"}),mt={EventPriority:nt,PasteMode:it,PasteOperation:rt,AnchorType:ot,DrawingType:at,ValidationType:st,ValidationOperator:lt,FilterOperator:ct,CFType:ht,SortOrder:ut,HorizontalAlign:dt,VerticalAlign:ft,BorderStyle:pt};class gt{constructor(t,e,n){this.type=t,this.data=e,this.target=n,this.canceled=!1,this.stopped=!1,this.cancelReason=null,this.timestamp=Date.now(),this.Ye=null}cancel(t=""){this.canceled=!0,this.cancelReason=t,t&&this.target?.Utils?.toast&&this.target.Utils.toast(t)}stopPropagation(){this.stopped=!0}waitUntil(t){t&&"function"==typeof t.then&&(this.Ye||(this.Ye=[]),this.Ye.push(t))}}class vt{constructor(){this.Je=new Map,this.Ze=new WeakSet}on(t,e,n={}){if("function"!=typeof e)return this;const{id:i=null,priority:r=0,once:o=!1}=n;let a=this.Je.get(t);if(a||(a=[],this.Je.set(t,a)),i){const t=a.findIndex(t=>t.id===i);-1!==t&&a.splice(t,1)}const s={handler:e,id:i,priority:r};o&&this.Ze.add(s);const l=this.Qe(a,r);return a.splice(l,0,s),this}once(t,e,n={}){return this.on(t,e,{...n,once:!0})}off(t,e){const n=this.Je.get(t);if(!n)return this;if(void 0===e)return this.Je.delete(t),this;const i=n.findIndex(t=>t.id===e||t.handler===e);if(-1!==i){const[t]=n.splice(i,1);this.Ze.delete(t)}return this}offAll(){return this.Je.clear(),this}emit(t,e={}){const n=new gt(t,e,this),i=this.Je.get(t);if(!i||0===i.length)return n;const r=i.slice(),o=[];for(const a of r){if(n.stopped)break;try{a.handler.call(this,n)}catch(t){}this.Ze.has(a)&&(this.Ze.delete(a),o.push(a))}if(o.length>0)for(const a of o){const t=i.indexOf(a);-1!==t&&i.splice(t,1)}return n}async emitAsync(t,e={}){const n=new gt(t,e,this),i=this.Je.get(t);if(!i||0===i.length)return n;const r=i.slice(),o=[];for(const a of r){if(n.stopped)break;try{const t=a.handler.call(this,n);t&&"function"==typeof t.then&&await t}catch(t){}this.Ze.has(a)&&(this.Ze.delete(a),o.push(a))}if(n.Ye&&n.Ye.length>0){const t=await Promise.allSettled(n.Ye);for(const e of t)e.status}if(o.length>0)for(const a of o){const t=i.indexOf(a);-1!==t&&i.splice(t,1)}return n}hasListeners(t){const e=this.Je.get(t);return e&&e.length>0}listenerCount(t){if(t){const e=this.Je.get(t);return e?e.length:0}let e=0;for(const n of this.Je.values())e+=n.length;return e}listEvents(){const t=[];for(const[e,n]of this.Je.entries())t.push({event:e,count:n.length});return t}Qe(t,e){let n=0,i=t.length;for(;n<i;){const r=n+i>>>1;t[r].priority<=e?n=r+1:i=r}return n}}const yt=["selectLockedCells","selectUnlockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables","objects"],bt={selectLockedCells:!0,selectUnlockedCells:!0,formatCells:!1,formatColumns:!1,formatRows:!1,insertColumns:!1,insertRows:!1,insertHyperlinks:!1,deleteColumns:!1,deleteRows:!1,sort:!1,autoFilter:!1,pivotTables:!1,objects:!1};function xt(t){const e=String(t??"");if(!e)return"";let n=0;for(let i=0;i<e.length;i++)n=n>>14&1|n<<1&32767,n^=e.charCodeAt(i);return n=n>>14&1|n<<1&32767,n^=e.length,n^=52811,n.toString(16).toUpperCase().padStart(4,"0")}function wt(t,e){return null==t?e:!0===t||!1===t?t:1===t||"1"===t||0!==t&&"0"!==t&&e}class St{constructor(t){this.tn=t,this.nn=!1,this.rn={...bt},this.sn=null,this.an=null,this.ln=null,this.hn=null,this.un=null,this.dn=!1}get SN(){return this.tn.SN}mn(t,e){return this.SN.t(t,e)}get enabled(){return this.nn}get selectLockedCells(){return this.rn.selectLockedCells}set selectLockedCells(t){this.pn("selectLockedCells",!!t)}get selectUnlockedCells(){return this.rn.selectUnlockedCells}set selectUnlockedCells(t){this.pn("selectUnlockedCells",!!t)}get formatCells(){return this.rn.formatCells}set formatCells(t){this.pn("formatCells",!!t)}get formatColumns(){return this.rn.formatColumns}set formatColumns(t){this.pn("formatColumns",!!t)}get formatRows(){return this.rn.formatRows}set formatRows(t){this.pn("formatRows",!!t)}get insertColumns(){return this.rn.insertColumns}set insertColumns(t){this.pn("insertColumns",!!t)}get insertRows(){return this.rn.insertRows}set insertRows(t){this.pn("insertRows",!!t)}get insertHyperlinks(){return this.rn.insertHyperlinks}set insertHyperlinks(t){this.pn("insertHyperlinks",!!t)}get deleteColumns(){return this.rn.deleteColumns}set deleteColumns(t){this.pn("deleteColumns",!!t)}get deleteRows(){return this.rn.deleteRows}set deleteRows(t){this.pn("deleteRows",!!t)}get sort(){return this.rn.sort}set sort(t){this.pn("sort",!!t)}get autoFilter(){return this.rn.autoFilter}set autoFilter(t){this.pn("autoFilter",!!t)}get pivotTables(){return this.rn.pivotTables}set pivotTables(t){this.pn("pivotTables",!!t)}get objects(){return this.rn.objects}set objects(t){this.pn("objects",!!t)}enable(t={}){return yt.forEach(e=>{void 0!==t[e]?this.rn[e]=!!t[e]:this.rn[e]=bt[e]}),t.passwordHash?this.sn=String(t.passwordHash).toUpperCase():t.password?this.sn=xt(t.password):this.sn=null,this.an=t.algorithmName||null,this.ln=t.hashValue||null,this.hn=t.saltValue||null,this.un=void 0!==t.spinCount?Number(t.spinCount):null,this.nn=!0,this.vn(),this}disable(t){if(!this.nn)return{ok:!0};const e=this.verifyPassword(t);return e.ok?(this.bn(),this.nn=!1,this.sn=null,this.an=null,this.ln=null,this.hn=null,this.un=null,{ok:!0}):e}verifyPassword(t){if(!this.nn)return{ok:!0};if(!this.sn&&!this.ln)return{ok:!0};const e=String(t??"");return e?this.sn?xt(e)===this.sn?{ok:!0}:{ok:!1,message:this.mn("core.sheet.sheetProtection.prompt.passwordIncorrect")}:{ok:!1,message:this.mn("core.sheet.sheetProtection.prompt.advancedNotSupported")}:{ok:!1,message:this.mn("core.sheet.sheetProtection.prompt.enterPassword")}}getOptions(){return this.nn?{sheet:!0,...this.rn,passwordHash:this.sn,algorithmName:this.an,hashValue:this.ln,saltValue:this.hn,spinCount:this.un}:null}isCellLocked(t){return!t||!1!==t.protection?.locked}isCellSelectable(t){if(!this.nn)return!0;const e=!1!==this.rn.selectLockedCells,n=!1!==this.rn.selectUnlockedCells;return!(!e&&!n)&&(this.isCellLocked(t)?e:n)}isAreaSelectable(t){if(!this.nn)return!0;const e=!1!==this.rn.selectLockedCells,n=!1!==this.rn.selectUnlockedCells;if(!e&&!n)return!1;const i="string"==typeof t?this.tn.rangeStrToNum(t):t;if(!i?.s||!i?.e)return!0;const r=Math.min(i.s.r,i.e.r),o=Math.max(i.s.r,i.e.r),a=Math.min(i.s.c,i.e.c),s=Math.max(i.s.c,i.e.c);for(let l=r;l<=o;l++)for(let t=a;t<=s;t++){const i=this.tn.getCell(l,t),r=this.isCellLocked(i);if(r&&!e||!r&&!n)return!1}return!0}areAreasSelectable(t){return!this.nn||!t||0===t.length||t.every(t=>this.isAreaSelectable(t))}isSelectionVisible(){return!this.nn||!1!==this.rn.selectLockedCells||!1!==this.rn.selectUnlockedCells}setCellProtection(t,e={}){const n=t?Array.isArray(t)?t:[t]:this.tn.activeAreas,i=Object.prototype.hasOwnProperty.call(e,"locked"),r=Object.prototype.hasOwnProperty.call(e,"hidden");(i||r)&&n.forEach(t=>{const n="string"==typeof t?this.tn.rangeStrToNum(t):t;this.tn.eachCells(n,(t,n)=>{const o=this.tn.getCell(t,n),a=o.protection||{};o.protection={locked:i?!!e.locked:a.locked,hidden:r?!!e.hidden:a.hidden}})})}buildXmlNode(){if(!this.nn)return null;const t={"_$sheet":"1"};return yt.forEach(e=>{t[`_$${e}`]=this.rn[e]?"1":"0"}),this.sn&&(t._$password=this.sn),this.an&&(t._$algorithmName=this.an),this.ln&&(t._$hashValue=this.ln),this.hn&&(t._$saltValue=this.hn),null===this.un||Number.isNaN(this.un)||(t._$spinCount=String(this.un)),t}pn(t,e){this.rn[t]!==e&&(this.rn[t]=e,this.nn&&(this.bn(),this.vn()))}gn(t){return`protection_${this.tn.name}_${t}`}vn(){this.dn&&this.bn();const t=this.tn,e=this.SN,n=this.rn,i=(t,n)=>e.t(t,n);e.Event.on("beforeCellEdit",n=>{if(n.data.sheet===t&&this.isCellLocked(n.data.cell)){const t=i("core.sheet.sheetProtection.message.cellProtected");n.cancel(t),e.Utils.toast(t)}},{id:this.gn("cellEdit"),priority:nt.PROTECTION}),n.insertRows||e.Event.on("beforeInsertRows",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.insertRowsDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("insertRows"),priority:nt.PROTECTION}),n.insertColumns||e.Event.on("beforeInsertColumns",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.insertColsDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("insertColumns"),priority:nt.PROTECTION}),n.deleteRows||e.Event.on("beforeDeleteRows",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.deleteRowsDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("deleteRows"),priority:nt.PROTECTION}),n.deleteColumns||e.Event.on("beforeDeleteColumns",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.deleteColsDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("deleteColumns"),priority:nt.PROTECTION}),n.formatCells||(e.Event.on("beforeMerge",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.mergeDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("merge"),priority:nt.PROTECTION}),e.Event.on("beforeUnmerge",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.unmergeDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("unmerge"),priority:nt.PROTECTION}),e.Event.on("beforeCellStyleChange",n=>{if(n.data.sheet===t&&this.isCellLocked(n.data.cell)){const t=i("core.sheet.sheetProtection.message.styleDenied");n.cancel(t),e.Utils.toast(t)}},{id:this.gn("cellStyle"),priority:nt.PROTECTION})),n.formatRows||(e.Event.on("beforeRowResize",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.rowResizeDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("rowResize"),priority:nt.PROTECTION}),e.Event.on("beforeRowHide",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.rowHideDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("rowHide"),priority:nt.PROTECTION}),e.Event.on("beforeRowUnhide",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.rowUnhideDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("rowUnhide"),priority:nt.PROTECTION})),n.formatColumns||(e.Event.on("beforeColResize",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.colResizeDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("colResize"),priority:nt.PROTECTION}),e.Event.on("beforeColHide",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.colHideDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("colHide"),priority:nt.PROTECTION}),e.Event.on("beforeColUnhide",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.colUnhideDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("colUnhide"),priority:nt.PROTECTION})),n.insertHyperlinks||e.Event.on("beforeHyperlinkInsert",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.hyperlinkDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("hyperlink"),priority:nt.PROTECTION}),n.sort||e.Event.on("beforeSort",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.sortDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("sort"),priority:nt.PROTECTION}),n.autoFilter||e.Event.on("beforeAutoFilter",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.autoFilterDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("autoFilter"),priority:nt.PROTECTION}),n.pivotTables||e.Event.on("beforePivotTableChange",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.pivotDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("pivotTable"),priority:nt.PROTECTION}),n.objects||(e.Event.on("beforeDrawingAdd",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.addObjectDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("drawingAdd"),priority:nt.PROTECTION}),e.Event.on("beforeDrawingRemove",n=>{if(n.data.sheet!==t)return;const r=i("core.sheet.sheetProtection.message.removeObjectDenied");n.cancel(r),e.Utils.toast(r)},{id:this.gn("drawingRemove"),priority:nt.PROTECTION}));const r=!1!==n.selectLockedCells,o=!1!==n.selectUnlockedCells;if(!r||!o){let n=0;const a=t=>{const i=Date.now();i-n<500||(n=i,e.Utils.toast(t))};e.Event.on("beforeSelectionChange",e=>{if(e.data.sheet===t){if("activeCell"===e.data.type&&e.data.newCell){const n=t.getCell(e.data.newCell.r,e.data.newCell.c),s=this.isCellLocked(n);if(s&&!r){const t=i("core.sheet.sheetProtection.message.cannotSelectLocked");e.cancel(t),a(t)}else if(!s&&!o){const t=i("core.sheet.sheetProtection.message.cannotSelectUnlocked");e.cancel(t),a(t)}return}if("activeAreas"===e.data.type&&e.data.newAreas?.length)for(const t of e.data.newAreas)if(!this.isAreaSelectable(t)){const t=i(r?"core.sheet.sheetProtection.message.cannotSelectUnlocked":"core.sheet.sheetProtection.message.cannotSelectLocked");e.cancel(t),a(t);break}}},{id:this.gn("selection"),priority:nt.PROTECTION})}this.dn=!0}bn(){if(!this.dn)return;const t=this.SN,e=["beforeCellEdit","beforeInsertRows","beforeInsertColumns","beforeDeleteRows","beforeDeleteColumns","beforeMerge","beforeUnmerge","beforeCellStyleChange","beforeRowResize","beforeRowHide","beforeRowUnhide","beforeColResize","beforeColHide","beforeColUnhide","beforeHyperlinkInsert","beforeSort","beforeAutoFilter","beforePivotTableChange","beforeDrawingAdd","beforeDrawingRemove","beforeSelectionChange"];["cellEdit","insertRows","insertColumns","deleteRows","deleteColumns","merge","unmerge","cellStyle","rowResize","rowHide","rowUnhide","colResize","colHide","colUnhide","hyperlink","sort","autoFilter","pivotTable","drawingAdd","drawingRemove","selection"].forEach((n,i)=>{t.Event.off(e[i],this.gn(n))}),this.dn=!1}}function Ct(t,e,n={}){const{order:i="asc",nulls:r="last",locale:o="zh-CN",customOrder:a,caseSensitive:s=!1}=n,l="asc"===i?1:-1;if(a?.length){const n=a.indexOf(t),i=a.indexOf(e);if(-1!==n&&-1!==i)return(n-i)*l;if(-1!==n)return-1;if(-1!==i)return 1}const c=null==t||""===t,h=null==e||""===e;if(c&&h)return 0;if(c)return"last"===r?1:-1;if(h)return"last"===r?-1:1;const u="number"==typeof t?t:parseFloat(t),d="number"==typeof e?e:parseFloat(e);if(!isNaN(u)&&!isNaN(d))return(u-d)*l;let f=String(t),p=String(e);return s?f<p?-1*l:f>p?1*l:0:f.localeCompare(p,o,{sensitivity:"base"})*l}function Tt(t,e,n){const i=t.SN,r="string"==typeof e?t.rangeStrToNum(e):e,o=r.s.r,a=r.e.r,s=r.s.c,l=r.e.c;if(o>a)return!1;if(t.areaHaveMerge({s:{r:o,c:s},e:{r:a,c:l}}))return i.Utils.toast(i.t("core.utils.sortUtils.toast.msg001")),!1;const c=(Array.isArray(n)?n:[n]).map(t=>({...t,col:"string"==typeof t.col?i.Utils.charToNum(t.col):t.col})),h=[];for(let f=o;f<=a;f++){const e=t.getRow(f);h.push({idx:f,cells:e?.cells?.slice()||[],values:c.map(e=>t.getCell(f,e.col)?.showVal)})}const u=h.map(t=>t.cells.slice());h.sort((t,e)=>{for(let n=0;n<c.length;n++){const i=Ct(t.values[n],e.values[n],{order:c[n].order||"asc",customOrder:c[n].customOrder});if(0!==i)return i}return 0});const d=h.map(t=>t.cells);for(let f=0;f<h.length;f++){const e=t.getRow(o+f);e&&(e.cells=d[f],e.cells.forEach((t,n)=>{t&&(t.row=e,t.cIndex=n)}))}return i.UndoRedo.add({undo:()=>{for(let e=0;e<u.length;e++){const n=t.getRow(o+e);n&&(n.cells=u[e],n.cells.forEach((t,e)=>{t&&(t.row=n,t.cIndex=e)}))}i.ue()},redo:()=>{for(let e=0;e<d.length;e++){const n=t.getRow(o+e);n&&(n.cells=d[e],n.cells.forEach((t,e)=>{t&&(t.row=n,t.cIndex=e)}))}i.ue()}}),!0}const $t=[{key:"nonSpace",regex:/[^\s]+/g},{key:"alphaNum",regex:/[A-Za-z0-9]+/g},{key:"alpha",regex:/[A-Za-z]+/g},{key:"digit",regex:/\d+/g},{key:"cjk",regex:/[\u4E00-\u9FFF]+/g}],Mt=[" ","-","_","/","\\",".",",",";",":","|","@","#"],At=[" ","-","_","/","\\",".",",",";",":","(",")","+"];function Nt(t){return null==t?"":String(t)}function kt(t,e){return"whitespace"===e?Nt(t).trim().split(/\s+/).filter(Boolean):Nt(t).split(e).filter(t=>""!==t)}function Rt(t,e,n){if(!Array.isArray(t)||0===t.length)return"";if("start"===e)return t[n]??"";const i=t.length-n;return i>=0&&i<t.length?t[i]:""}function _t(t){return Nt(t).replace(/[A-Za-z]+/g,t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase())}const It={tab:"\t","\\t":"\t",comma:",",semicolon:";",space:" "};function Ft(t,e,n){return"row"===e?t.getRow(n):t.getCol(n)}function Et(t,e,n){n.forEach(n=>{const i=Ft(t,e,n.index);i.kt=n.outlineLevel,i.Tt=n.collapsed})}function Dt(t,e,n={},i="row",r=1){const o=function(t,e){const n=t.activeAreas?.length?t.activeAreas:[{s:t.activeCell,e:t.activeCell}],i=e??n,r=Array.isArray(i)?i:[i],o=[];return r.forEach(e=>{const n=(i="string"==typeof e?t.rangeStrToNum(e):e,i?.s&&i?.e?{s:{r:Math.min(i.s.r,i.e.r),c:Math.min(i.s.c,i.e.c)},e:{r:Math.max(i.s.r,i.e.r),c:Math.max(i.s.c,i.e.c)}}:null);var i;n&&o.push(n)}),o}(t,e),a=function(t,e){const n="row"===e?"r":"c",i=new Set;return t.forEach(t=>{const e=t.s[n],r=t.e[n];for(let n=e;n<=r;n++)i.add(n)}),Array.from(i).sort((t,e)=>t-e)}(o,i),s="row"===i?"rows":"cols",l=`${r>0?"group":"ungroup"}${"row"===i?"Rows":"Cols"}`,c=`${r>0?"Group":"Ungroup"}${"row"===i?"Rows":"Cols"}`,h=function(t){const e=Number(t);return Number.isFinite(e)?Math.max(1,Math.min(7,Math.round(e))):7}(n.maxLevel);if(0===a.length)return{success:!1,canceled:!0,changedCount:0,[`${i}Count`]:0};if(t.SN.Event.hasListeners(`before${c}`)&&t.SN.Event.emit(`before${c}`,{sheet:t,[s]:a,areas:o,maxLevel:h}).canceled)return{success:!1,canceled:!0,changedCount:0,[`${i}Count`]:a.length};const u=function(t,e,n){return n.map(n=>{const i=Ft(t,e,n);return{index:n,outlineLevel:i.kt??0,collapsed:i.Tt??!1}})}(t,i,a);let d=0,f=0;const p=u.map(t=>{const e=t.outlineLevel;let n=Math.max(0,Math.min(h,e+r)),i=t.collapsed;return 0===n&&(i=!1),r>0&&e>=h&&f++,n===e&&i===t.collapsed||d++,{index:t.index,outlineLevel:n,collapsed:i}}),m={success:!0,[s]:a,[`${i}Count`]:a.length,changedCount:d,maxLevel:h,limitedCount:f};return 0===d?m:t.SN.st(l,{sheet:t,[s]:a,changedCount:d,maxLevel:h},()=>(t.SN.UndoRedo.add({undo:()=>Et(t,i,u),redo:()=>Et(t,i,p)}),Et(t,i,p),t.SN.ht({type:"outline",action:l,sheet:t,[s]:a,changedCount:d,maxLevel:h}),t.SN.Event.emit(`after${c}`,{sheet:t,[s]:a,changedCount:d,maxLevel:h,limitedCount:f}),m))}const Lt={average:1,countNums:2,count:3,max:4,min:5,product:6,stdev:7,stdevp:8,sum:9,var:10,varp:11};function Pt(t,e){if(Number.isInteger(e)&&e>=0)return e;if("string"==typeof e){const n=e.replace(/\$/g,"").trim().toUpperCase();if(/^[A-Z]+$/.test(n))return t.Utils.charToNum(n);if(/^\d+$/.test(n))return Number(n)}return null}function zt(t){const e=String(t??"sum").trim();if(!e)return"sum";if(Lt[e])return e;const n=e.toLowerCase();return Lt[n]?n:"avg"===n?"average":"counta"===n?"count":"countnum"===n||"countnums"===n?"countNums":"stddev"===n?"stdev":"stddevp"===n?"stdevp":"sum"}function Ot(t){const e=t.calcVal;if(null==e||""===e)return"__blank__";const n=typeof e;return"number"===n&&Number.isNaN(e)?"number:NaN":`${n}:${String(e)}`}function Bt(t){const e=t.showVal;return null==e||""===e?"空白":String(e)}function Vt(t,e,n){return t.Utils.cellNumToStr({r:e,c:n})}function Ht(t,e,n){return n.some(n=>{return"string"==typeof(i=t.getCell(e,n).editVal)&&/^\s*=SUBTOTAL\s*\(/i.test(i);var i})}function Ut(t,e,n){const i=t.getCell(e,n);i.font={...i.font||{},bold:!0}}const qt=new Set(["sum","average","max","min","product","countNums","stdev","stdevp","var","varp"]);function Kt(t){if("number"==typeof t&&Number.isFinite(t))return t;if("string"==typeof t){const e=t.trim();if(!e)return null;const n=Number(e);if(Number.isFinite(n))return n}return null}function Wt(t){return""===t||null==t}function jt(t,e){if("count"===t)return e.filter(t=>!Wt(t.raw)).length;const n=e.map(t=>t.num).filter(t=>Number.isFinite(t));switch(t){case"sum":return n.length?n.reduce((t,e)=>t+e,0):"";case"average":return n.length?n.reduce((t,e)=>t+e,0)/n.length:"";case"max":return n.length?Math.max(...n):"";case"min":return n.length?Math.min(...n):"";case"product":return n.length?n.reduce((t,e)=>t*e,1):"";case"countnums":case"countNums":return n.length;case"stdev":{if(n.length<=1)return"";const t=n.reduce((t,e)=>t+e,0)/n.length,e=n.reduce((e,n)=>e+Math.pow(n-t,2),0)/(n.length-1);return Math.sqrt(e)}case"stdevp":{if(0===n.length)return"";const t=n.reduce((t,e)=>t+e,0)/n.length,e=n.reduce((e,n)=>e+Math.pow(n-t,2),0)/n.length;return Math.sqrt(e)}case"var":{if(n.length<=1)return"";const t=n.reduce((t,e)=>t+e,0)/n.length;return n.reduce((e,n)=>e+Math.pow(n-t,2),0)/(n.length-1)}case"varp":{if(0===n.length)return"";const t=n.reduce((t,e)=>t+e,0)/n.length;return n.reduce((e,n)=>e+Math.pow(n-t,2),0)/n.length}default:throw new Error("不支持的合并计算函数")}}const Gt=new Set(["list","whole","decimal","textLength","date","time","custom"]),Xt=new Set(["whole","decimal","textLength","date","time"]),Yt=new Set(["between","notBetween"]);function Zt(t,e){const n=t.activeAreas?.length?t.activeAreas:[{s:t.activeCell,e:t.activeCell}],i=e??n,r=Array.isArray(i)?i:[i],o=[];return r.forEach(e=>{const n=(i="string"==typeof e?t.rangeStrToNum(e):e,i?.s&&i?.e?{s:{r:Math.min(i.s.r,i.e.r),c:Math.min(i.s.c,i.e.c)},e:{r:Math.max(i.s.r,i.e.r),c:Math.max(i.s.c,i.e.c)}}:null);var i;n&&o.push(n)}),o}function Jt(t){return null==t?t:JSON.parse(JSON.stringify(t))}const Qt=t=>{if("string"!=typeof t)return;const e=t.match(/DATE\((\d+),\s*(\d+),\s*(\d+)\)/);if(e){const[,t,n,i]=e;return`${t}/${String(n).padStart(2,"0")}/${String(i).padStart(2,"0")}`}const n=t.match(/^"(\d{4})\/(\d{1,2})\/(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})"$/);if(n){const[,t,e,i,r,o,a]=n;return`${t}/${String(e).padStart(2,"0")}/${String(i).padStart(2,"0")} ${String(r).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(a).padStart(2,"0")}`}return t},te=t=>{const[,e,n,i]=t.match(/TIME\((\d+),\s*(\d+),\s*(\d+)\)/);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`};function ee(t,e){let n={"c":Math.min(e.s.c,e.e.c),"r":Math.min(e.s.r,e.e.r)},i={"c":Math.max(e.s.c,e.e.c),"r":Math.max(e.s.r,e.e.r)};return t.e.c<n.c||t.s.c>i.c||t.e.r<n.r||t.s.r>i.r?e:{"s":{"c":Math.min(t.s.c,n.c),"r":Math.min(t.s.r,n.r)},"e":{"c":Math.max(t.e.c,i.c),"r":Math.max(t.e.r,i.r)}}}function ne(t){const e=this,n=e.getCell(t.r,t.c);if(!n.isMerged)return;const i=e.merges.findIndex(t=>t.s.r===n.master.r&&t.s.c===n.master.c);if(-1===i)return;const r=e.merges[i],o=JSON.parse(JSON.stringify(r)),a=[];e.eachCells(r,(t,n)=>{const i=e.getCell(t,n);a.push({r:t,c:n,isMerged:i.isMerged,master:i.master?{...i.master}:null})}),e.eachCells(r,(t,n)=>{const i=e.getCell(t,n);i.isMerged=!1,i.master=null}),e.merges.splice(i,1),e.SN.UndoRedo.add({undo:()=>{e.eachCells(o,(t,n)=>{const i=e.getCell(t,n);i.isMerged=!0,i.master={r:o.s.r,c:o.s.c}}),e.merges.push(o)},redo:()=>{e.eachCells(o,(t,n)=>{const i=e.getCell(t,n);i.isMerged=!1,i.master=null});const t=e.merges.findIndex(t=>t.s.r===o.s.r&&t.s.c===o.s.c);-1!==t&&e.merges.splice(t,1)}})}function ie(t,e=!1){const n=this;if(t.s.r===t.e.r&&t.s.c===t.e.c)return;const i=[],r=new Set;n.eachCells(t,(t,e)=>{const o=n.getCell(t,e);if(o.isMerged&&o.master){const t=`${o.master.r},${o.master.c}`;if(!r.has(t)){r.add(t);const e=n.merges.find(t=>t.s.r===o.master.r&&t.s.c===o.master.c);e&&i.push(JSON.parse(JSON.stringify(e)))}}});const o=JSON.parse(JSON.stringify(n.merges)),a=[],s=n.getCell(t.s.r,t.s.c).O?JSON.parse(JSON.stringify(n.getCell(t.s.r,t.s.c).O)):null;[...i,t].forEach(t=>{n.eachCells(t,(t,e)=>{if(!a.find(n=>n.r===t&&n.c===e)){const i=n.getCell(t,e);a.push({r:t,c:e,isMerged:i.isMerged,master:i.master?{...i.master}:null})}})}),i.forEach(t=>{n.eachCells(t,(t,e)=>{const i=n.getCell(t,e);i.isMerged=!1,i.master=null});const e=n.merges.findIndex(e=>e.s.r===t.s.r&&e.s.c===t.s.c);-1!==e&&n.merges.splice(e,1)}),n.eachCells(t,(e,i)=>{const r=n.getCell(e,i);r.isMerged=!0,r.master={r:t.s.r,c:t.s.c}}),n.merges.push(t),e&&(n.getCell(t.s.r,t.s.c).alignment={horizontal:"center",vertical:"center"}),n.SN.UndoRedo.add({undo:()=>{n.merges=JSON.parse(JSON.stringify(o)),a.forEach(t=>{const e=n.getCell(t.r,t.c);e.isMerged=t.isMerged,e.master=t.master}),e&&(n.getCell(t.s.r,t.s.c).O=s)},redo:()=>{i.forEach(t=>{n.eachCells(t,(t,e)=>{const i=n.getCell(t,e);i.isMerged=!1,i.master=null});const e=n.merges.findIndex(e=>e.s.r===t.s.r&&e.s.c===t.s.c);-1!==e&&n.merges.splice(e,1)}),n.eachCells(t,(e,i)=>{const r=n.getCell(e,i);r.isMerged=!0,r.master={r:t.s.r,c:t.s.c}}),n.merges.push(t),e&&(n.getCell(t.s.r,t.s.c).alignment={horizontal:"center",vertical:"center"})}})}function re(t){if(!t)return{show:!1};const e=t?._$pos,n={orient:"horizontal"};switch(e){case"t":n.top=40,n.left="center";break;case"l":n.left="left",n.top="middle",n.orient="vertical";break;case"r":n.right="right",n.top="middle",n.orient="vertical";break;default:n.bottom=10,n.left="center"}return n}function oe(t,e){const n=t?.["cx:f"],i="string"==typeof n?n:n?.["#text"];return i?pe(i,e):""}function ae(t,e){const n=t?.["cx:tx"]?.["cx:txData"]?.["cx:f"];if("string"==typeof n)return pe(n,e);const i=t?.["cx:tx"]?.["cx:txData"]?.["cx:v"];return"string"==typeof i?i:""}function se(t,e){const n=Math.max(t.length,e.length),i=[];for(let r=0;r<n;r++)i.push({name:t[r]??`类别${r+1}`,value:e[r]??0});return i}const le=(t,e=null)=>{const n={color:["#4472C4","#ED7D31","#FFC000","#70AD47","#5B9BD5","#A5A5A5","#264478","#9E480E","#997300","#375623","#1F4E79","#636363"],backgroundColor:"#ffffff",title:{text:e?.t?e.t("chart.defaultTitle"):"Chart Title",left:"center",top:10,textStyle:{fontSize:18,fontWeight:"normal"}},legend:{orient:"horizontal",left:"center",textStyle:{fontSize:14}}};t.legend?.bottom||t.legend?.top||(t.legend={bottom:10,...t.legend}),t.xAxis&&(Array.isArray(t.xAxis)?t.xAxis.forEach((e,n)=>{t.xAxis[n].axisTick={show:!1,...e.axisTick||{}}}):t.xAxis.axisTick={show:!1,...t.xAxis.axisTick||{}}),t.yAxis&&(Array.isArray(t.yAxis)?t.yAxis.forEach((e,n)=>{t.yAxis[n].axisTick={show:!1,...e.axisTick||{}}}):t.yAxis.axisTick={show:!1,...t.yAxis.axisTick||{}}),t.tooltip={trigger:"none",show:!1},t.animation=!1,t.animationDuration=0,t.silent=!0,t=ce(n,t);const i={};Array.isArray(t.series)&&t.series.forEach((e,n)=>{if(i[e.type]=!0,e.emphasis={...e.emphasis||{},scale:!1},e.large=!0,e.largeThreshold=0,e.progressive=500,e.progressiveThreshold=1e3,"radar"==e.type)t.radar={center:t.legend.top?["50%","63%"]:["50%","54%"],radius:"50%",...t.radar},t.series[n]={symbolSize:0,...t.series[n]};else if("pie"==e.type)t.series[n]={radius:"50%",label:{show:!1},labelLine:{show:!1},...t.series[n]};else if("scatter"==e.type){t.xAxis.splitLine={show:!0,...t.xAxis.splitLine??{}};const e={symbolSize:7.5,...t.series[n]};"function"==typeof e.symbolSize||e.__bubble,e.large=!1,t.series[n]=e}else if("sunburst"==e.type){const e=t.series[n]||{};t.series[n]={...e,radius:e.radius||["35%","75%"],center:e.center||["50%","55%"],sort:e.sort??null,nodeClick:e.nodeClick??!1,label:{show:!0,rotate:"radial",color:"#ffffff",...e.label||{}},itemStyle:{borderWidth:2,borderColor:"#ffffff",...e.itemStyle||{}}}}else if("treemap"==e.type){const e=t.series[n]||{},i=Array.isArray(t.legend?.data)&&t.legend.data.length>0?t.legend.data:Array.isArray(e.data)?e.data.map(t=>t?.name).filter(Boolean):[];t.series[n]={...e,leafDepth:e.leafDepth??1,label:{show:!0,position:"insideTopLeft",color:"#ffffff",...e.label||{}},upperLabel:{show:!1,...e.upperLabel||{}},breadcrumb:{show:!1,...e.breadcrumb||{}},itemStyle:{borderWidth:2,borderColor:"#ffffff",...e.itemStyle||{}}},t.legend={...t.legend||{},show:!0,top:t.legend?.top??40,left:t.legend?.left??"center",data:i}}else if("funnel"==e.type)t.series[n]={sort:"none",gap:6,minSize:"90%",maxSize:"90%",funnelAlign:"center",colorBy:"series",itemStyle:{color:"#4472C4",...t.series[n]?.itemStyle||{}},label:{show:!0,position:"inside",formatter:"{c}",color:"#ffffff",align:"center",verticalAlign:"middle"},labelLine:{show:!1},top:40,bottom:20,...t.series[n]};else if("histogram"===t.__chartType&&"bar"==e.type)t.series[n]={barGap:"0%",barCategoryGap:"0%",...t.series[n]};else if("line"==e.type){const e=t.series[n]||{},i=!0===e.showSymbol,r=i?e.symbolSize??7.5:0;t.series[n]={...e,showSymbol:i,symbolSize:r}}}),t.grid={top:t.legend.top?t.legend.top+30:50,bottom:t.legend.bottom?t.legend.bottom+30:10,left:20,right:20,containLabel:!0,...t.grid};const r={line:{width:25,height:3},bar:{width:8,height:8},scatter:{width:6,height:6},pie:{width:6,height:6},radar:{width:25,height:3}},o=Object.keys(i);return 1===o.length&&r[o[0]]?(t.legend.itemWidth=r[o[0]].width,t.legend.itemHeight=r[o[0]].height):(t.legend.itemWidth=r.bar.width,t.legend.itemHeight=r.bar.height),t};function ce(t,e){for(const n in e){const i=e[n];t.hasOwnProperty(n)&&he(t[n])&&he(i)?ce(t[n],i):t[n]=i}return t}function he(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)}const ue=t=>{if(!t)return{show:!1};const e={orient:"horizontal"},n=t["c:legendPos"]?._$val;switch(n){case"t":e.top=40,e.left="center";break;case"l":e.left="left",e.top="middle",e.orient="vertical";break;case"r":e.right="right",e.top="middle",e.orient="vertical";break;default:e.bottom=10,e.left="center"}const i=me(t,["c:layout","c:manualLayout"]);if(i){const t=i["c:x"]?._$val,n=i["c:y"]?._$val;null!=t&&(e.left=100*t+"%",delete e.right),null!=n&&(e.top=100*n+"%",delete e.bottom)}const r=me(t,["c:txPr","a:p","a:pPr","a:defRPr"]);return r&&r._$sz&&(e.textStyle=e.textStyle||{},e.textStyle.fontSize=Number(r._$sz)/100*1.333),e},de=t=>{const e={textStyle:{}},n=me(t,["c:tx","c:rich","a:p","a:r"]);n&&(Array.isArray(n)?e.text=n.map(t=>t["a:t"]).join(""):n["a:t"]&&(e.text=n["a:t"]));const i=n?.["a:rPr"];i&&(e.textStyle.fontSize=i?._$sz/100*1.333||18,e.textStyle.fontWeight="1"==i?._$b?"bold":"normal","1"==i?._$i&&(e.textStyle.fontStyle="italic"));const r=me(t,["c:layout","c:manualLayout"]);if(r){const t=r["c:x"]?._$val,n=r["c:y"]?._$val;null!=t&&(e.left=100*t+"%"),null!=n&&(e.top=100*n+"%")}return e},fe=t=>t?Array.isArray(t)?t:[t]:[];function pe(t,e){if("string"!=typeof t)return"";const n=t.trim(),i=n.startsWith("=")?n.slice(1):n;if(i.includes("!"))return i;const r=e?.yn?.[i];return"string"==typeof r?r:i}const me=(t,e)=>e.reduce((t,e)=>t&&null!=t[e]?t[e]:void 0,t),ge=t=>{const e=me(t,["c:cat","c:strRef","c:f"]);if(e)return e;const n=me(t,["c:cat","c:strLit","c:pt"]);return Array.isArray(n)?n.map(t=>t["c:v"]):[]};function ve(t){return"string"==typeof t&&/^(?:'[^']+'|[^'!]+)!\$?[A-Za-z]{1,3}\$?\d+(?::\$?[A-Za-z]{1,3}\$?\d+)?$/.test(t)}function ye(t,e){if("string"!=typeof t)return[];const n=pe(t,e);if(!n.includes("!"))return[];let i,r;[i,r]=n.split("!"),i.startsWith("'")&&i.endsWith("'")&&(i=i.slice(1,-1));const o=[];return e.getSheet(i).eachCells(r,(t,n)=>{o.push(i+"!"+e.Utils.cellNumToStr({r:t,c:n}))}),o}const be=["line","straightConnector1","bentConnector3","curvedConnector3"],xe=new Set(["wordArtVert","wordArtVertRtl","eaVert","vert","vert270","mongolianVert"]);function we(t){return Array.isArray(t)?t:null==t||""===t?[]:[t]}class Se{constructor(t,e){this.sheet=e,this.P=t.type,this.id="rId"+ ++e.wn,this.inView=!1,this.anchorType=t.anchorType??"twoCell",this.xmlDetail=t.xmlDetail??null;const n={r:e.vi.rowArr[0]??0,c:e.vi.colArr[0]??0},i=t.startCell;this.xn="string"==typeof i?e.Utils.cellStrToNum(i):i??n,this.$n=t.offsetX??0,this.Mn=t.offsetY??0,"image"===t.type?(this.Nt=t.width??null,this.Mt=t.height??null):"shape"===t.type?(this.Nt=t.width??100,this.Mt=t.height??100):"slicer"===t.type?(this.Nt=t.width??180,this.Mt=t.height??220):(this.Nt=t.width??460,this.Mt=t.height??260),this.Cn=(t.chartOption&&le(t.chartOption,e?.SN))??null,this.Sn=null,this.Rn=null,this.An=null,this.kn=!1,this.Tn=t.imageBase64??null,this.Nn=null,this.Fn=t.rotation??0,this._n=null,this.En=0,this.In=0,this.shapeType=t.shapeType??"rect",this.isConnector=be.includes(this.shapeType),this.isTextBox=!this.isConnector&&!!(t.isTextBox??t.textBox);const r=this.isConnector?{fill:"none",stroke:"#000000",strokeWidth:1,textColor:"#000000",fontSize:14,startArrow:"none",endArrow:"none"}:this.isTextBox?{fill:"#FFFFFF",stroke:"#7F7F7F",strokeWidth:.75,textColor:"#000000",fontSize:11,textAlign:"l",textDirection:"horizontal",startArrow:"none",endArrow:"none"}:{fill:"#4472C4",stroke:"#000000",strokeWidth:1,textColor:"#000000",fontSize:14,textDirection:"horizontal",startArrow:"none",endArrow:"none"};if(this.shapeStyle={...r,...t.shapeStyle??{}},this.shapeStyle.textDirection||(this.shapeStyle.textDirection="horizontal"),this.isTextBox&&!this.shapeStyle.textAlign&&(this.shapeStyle.textAlign="l"),t.arrows)switch(t.arrows){case"none":this.shapeStyle.startArrow="none",this.shapeStyle.endArrow="none";break;case"end":this.shapeStyle.startArrow="none",this.shapeStyle.endArrow="arrow";break;case"both":this.shapeStyle.startArrow="arrow",this.shapeStyle.endArrow="arrow"}if(this.shapeText=t.shapeText??"","shape"===this.type&&this.xmlDetail){const t=function(t,e){if(!t)return null;const n=t["xdr:spPr"],i=t["xdr:style"],r=t["xdr:txBody"],o=n?.["a:prstGeom"],a=o?._$prst||"rect",s=be.includes(a),l=!s&&"1"===t["xdr:nvSpPr"]?.["xdr:cNvSpPr"]?._$txBox,c={fill:s?"none":"#FFFFFF",stroke:"#000000",strokeWidth:1,textColor:"#000000",fontSize:11,textDirection:"horizontal",startArrow:"none",endArrow:"none"};l&&(c.textAlign="l",c.strokeWidth=.75);const h=n?.["a:solidFill"];if(h){const t=k(h["a:srgbClr"]||h["a:schemeClr"]||h["a:sysClr"],e);t&&(c.fill=t)}if(i?.["a:fillRef"]){const t=i["a:fillRef"],n=k(t["a:schemeClr"]||t["a:srgbClr"],e);n&&"0"!==t._$idx&&(c.fill=n)}const u=n?.["a:ln"];if(u){c.strokeWidth=(parseInt(u._$w)||9525)/12700;const t=u["a:solidFill"];if(t){const n=k(t["a:srgbClr"]||t["a:schemeClr"]||t["a:sysClr"],e);n&&(c.stroke=n)}if(s){const t=u["a:headEnd"];t?._$type&&(c.startArrow=t._$type);const e=u["a:tailEnd"];e?._$type&&(c.endArrow=e._$type)}}if(i?.["a:lnRef"]){const t=i["a:lnRef"],n=k(t["a:schemeClr"]||t["a:srgbClr"],e);n&&"0"!==t._$idx&&(c.stroke=n)}const d=r?.["a:bodyPr"];var f;f=d?._$vert,xe.has(String(f||""))&&(c.textDirection="vertical");let p="";const m=we(r?.["a:p"]);let g=!1;if(m.length){const t=[];let n=null;const r=m[0];m.forEach(e=>{const i=we(e?.["a:r"]);!n&&i.length&&(n=i[0]),t.push(i.filter(t=>void 0!==t?.["a:t"]).map(t=>t["a:t"]).join("")),e?.["a:pPr"]?._$algn&&(g=!0,c.textAlign=e["a:pPr"]._$algn)}),p=t.join("\n"),n?.["a:rPr"]?._$sz?c.fontSize=parseInt(n["a:rPr"]._$sz)/100:r?.["a:endParaRPr"]?._$sz&&(c.fontSize=parseInt(r["a:endParaRPr"]._$sz)/100);let o=!1;if(n?.["a:rPr"]){const t=n["a:rPr"],i=k(t["a:solidFill"]?.["a:srgbClr"]||t["a:solidFill"]?.["a:schemeClr"],e);i&&(c.textColor=i,o=!0)}if(!o&&i?.["a:fontRef"]){const t=i["a:fontRef"],n=k(t["a:schemeClr"]||t["a:srgbClr"],e);n&&(c.textColor=n)}}return l&&"vertical"===c.textDirection&&!g&&(c.textAlign="r"),{shapeType:a,shapeStyle:c,shapeText:p,isTextBox:l}}(this.xmlDetail,e.SN,this.isConnector);t&&(this.shapeType=t.shapeType,this.isConnector=be.includes(t.shapeType),this.isTextBox=!this.isConnector&&(t.isTextBox??this.isTextBox),this.shapeStyle={...this.shapeStyle,...t.shapeStyle},this.shapeStyle.textDirection||(this.shapeStyle.textDirection="horizontal"),this.isTextBox&&!this.shapeStyle.textAlign&&(this.shapeStyle.textAlign="l"),this.shapeText=t.shapeText)}this.zn=null,"image"===this.type&&this.Tn&&(this.zn=this.Dn())}get type(){return this.P}updIndex(t){const e=this.sheet.Drawing.getAll(),n=e.indexOf(this);if(-1!==n)switch(t){case"up":n<e.length-1&&([e[n],e[n+1]]=[e[n+1],e[n]]);break;case"down":n>0&&([e[n],e[n-1]]=[e[n-1],e[n]]);break;case"top":e.splice(n,1),e.push(this);break;case"bottom":e.splice(n,1),e.unshift(this)}}get imageBytes(){const t=this.imageBase64.split(",")[1],e=atob(t),n=e.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=e.charCodeAt(r);return{Ln:i}}get imageSuffix(){return this.Nn?this.Nn:this.Nn=this.imageBase64.match(/^data:image\/([^;]+);base64,/)?.[1]||null}get imageBase64(){if(this.Tn)return this.Tn;if(this.xmlDetail){const t=this.xmlDetail.name.split(".").at(-1);return this.Nn=t,this.Tn=`data:image/${t};base64,`+btoa(this.xmlDetail.asBinary())}return""}set imageBase64(t){t?.startsWith("data:image")||(t="data:image/png;base64,"+t),this.Tn=t,this.Nn=null,this.drawCache=null}get updRender(){return this.kn}set updRender(t){this.kn=t,t&&(this.Rn=null,this.drawCache=null)}get startCell(){return this.xn}set startCell(t){this.xn=t,this.Sn=null}get drawCache(){return this.An}set drawCache(t){this.An&&(this.An instanceof HTMLCanvasElement&&(this.An.width=0,this.An.height=0),this.An?.remove?.()),this.An=t}get area(){if("twoCell"===this.anchorType&&this._n)return{s:{r:this.xn.r,c:this.xn.c,offsetX:this.$n,offsetY:this.Mn},e:{r:this._n.r,c:this._n.c,offsetX:this.En,offsetY:this.In}};if(this.Sn)return this.Sn;let t=this.width+this.offsetX,e=this.startCell.c;for(;t>this.sheet.getCol(e).width;)t-=this.sheet.getCol(e).width,e++;const n=t;let i=this.height+this.offsetY,r=this.startCell.r;for(;i>this.sheet.getRow(r).height;)i-=this.sheet.getRow(r).height,r++;const o=i;return this.Sn={s:{"r":this.startCell.r,"c":this.startCell.c,"offsetX":this.offsetX,"offsetY":this.offsetY},e:{"r":r,"c":e,"offsetX":n,"offsetY":o}}}get offsetX(){return this.$n}set offsetX(t){if(t>this.sheet.getCol(this.startCell.c).width)throw new Error("offsetX exceeds start cell width");this.$n=t,this.Sn=null}get offsetY(){return this.Mn}set offsetY(t){if(t>this.sheet.getRow(this.startCell.r).height)throw new Error("offsetY exceeds start cell height");this.Mn=t,this.Sn=null}get rotation(){return this.Fn}set rotation(t){this.Fn=(t%360+360)%360}get width(){if("twoCell"===this.anchorType&&this._n){let t=-this.$n;for(let e=this.xn.c;e<this._n.c;e++)t+=this.sheet.getCol(e).width;return t+this.En}if(null===this.Nt&&this.Sn){let t=0;for(let e=this.Sn.s.c;e<=this.Sn.e.c;e++)t+=this.sheet.getCol(e).width;this.Nt=t-this.Sn.s.offsetX-(this.sheet.getCol(this.Sn.e.c).width-this.Sn.e.offsetX)}return this.Nt}set width(t){this.Nt=t,this.Sn=null,"twoCell"===this.anchorType&&this.On()}get height(){if("twoCell"===this.anchorType&&this._n){let t=-this.Mn;for(let e=this.xn.r;e<this._n.r;e++)t+=this.sheet.getRow(e).height;return t+this.In}if(null===this.Mt&&this.Sn){let t=0;for(let e=this.Sn.s.r;e<=this.Sn.e.r;e++)t+=this.sheet.getRow(e).height;this.Mt=t-this.Sn.s.offsetY-(this.sheet.getRow(this.Sn.e.r).height-this.Sn.e.offsetY)}return this.Mt}set height(t){this.Mt=t,this.Sn=null,"twoCell"===this.anchorType&&this.On()}get chartOption(){return this.Cn||(this.Cn=((t,e)=>{if(!t)return null;if(t["cx:chartSpace"]||t["cx:chartData"])return function(t,e){const n=t["cx:chartSpace"]||t,i=n?.["cx:chart"],r=i?.["cx:plotArea"],o=r?.["cx:plotAreaRegion"],a=fe(o?.["cx:series"]),s=fe(n?.["cx:chartData"]?.["cx:data"]),l=new Map;s.forEach(t=>{const n=t?._$id;if(null==n)return;const i=oe(t?.["cx:strDim"],e),r=oe(t?.["cx:numDim"],e);l.set(String(n),{catRef:i,valRef:r})});const c=a[0]?._$layoutId,h=a.map(t=>"1"===t?._$hidden),u=a.some(t=>t?.["cx:layoutPr"]?.["cx:binning"]),d={title:(f=i?.["cx:title"],{text:function(t){const e=t?.["cx:txData"]?.["cx:v"];return"string"==typeof e?e:Array.isArray(e)?e.join(""):""}(f?.["cx:tx"])}),legend:re(i?.["cx:legend"]),series:[]};var f;if(!c)return le(d,e);const p=a.filter(t=>"1"!==t?._$hidden),m=p.length?p:a,g=m[0]||a[0],v=String(g?.["cx:dataId"]?._$val??0),y=l.get(v)||{},b=a.map((t,n)=>{const i=String(t?.["cx:dataId"]?._$val??n),r=l.get(i)||{};return{name:ae(t,e)||"系列"+(n+1),data:r.valRef||""}});if("sunburst"===c||"treemap"===c){const t=c;if(1===m.length){const n=se(ye(y.catRef,e),ye(y.valRef,e));d.series=[{name:ae(g,e)||"",type:t,data:n}],d.legend="treemap"===t?{...d.legend||{},show:!0,data:n.map(t=>t.name),top:40,left:"center"}:{...d.legend||{},show:!1}}else{const n=m.map((t,n)=>{const i=String(t?.["cx:dataId"]?._$val??n),r=l.get(i)||{},o=se(ye(r.catRef,e),ye(r.valRef,e));return{name:ae(t,e)||"系列"+(n+1),children:o}});d.series=[{type:t,data:n}]}d.__chartType=t,d.__excelHidden=h,d.__excelRef={categories:y.catRef||"",series:b}}else if("funnel"===c){const t=se(ye(y.catRef,e),ye(y.valRef,e));d.series=[{name:ae(g,e)||"",type:"funnel",data:t}],d.__chartType="funnel",d.__excelHidden=h,d.__excelRef={categories:y.catRef||"",series:b}}else if("waterfall"===c){const t=ye(y.catRef,e),n=ye(y.valRef,e);d.__chartType="waterfall",d.__waterfall={categories:t,values:n,seriesName:ae(g,e)||""},d.__excelHidden=h,d.__excelRef={categories:y.catRef||"",series:b}}else if("clusteredColumn"===c){const t=u,n=ye(y.catRef,e);if(d.xAxis={type:"category",data:n},d.yAxis={type:"value"},d.series=m.map((t,n)=>{const i=String(t?.["cx:dataId"]?._$val??n),r=ye((l.get(i)||{}).valRef,e);return{name:ae(t,e)||"系列"+(n+1),type:"bar",data:r}}),t){const t=g?.["cx:layoutPr"]?.["cx:binning"];d.__chartType="histogram",d.__histogram={intervalClosed:t?._$intervalClosed||"r"}}d.__excelHidden=h,d.__excelRef={categories:y.catRef||"",series:b}}return le(d,e)}(t,e);const n=(t=t["c:chartSpace"])["c:chart"],i=n["c:plotArea"],r=n["c:legend"],o=n["c:title"],a={title:de(o),legend:ue(r),series:[]};let s=null;const l=(t,n,i,r={})=>{let o;switch(n){case"scatter":{let n=[];const i=me(t,["c:xVal","c:numRef","c:f"])||me(t,["c:xVal","c:strRef","c:f"]);if(i){n=ye(i,e);const r=me(t,["c:xVal","c:numLit","c:pt"])||me(t,["c:xVal","c:strLit","c:pt"]);r&&(n=r.map(t=>t["c:v"]))}let r=[];const a=me(t,["c:yVal","c:numRef","c:f"])||me(t,["c:yVal","c:strRef","c:f"]);if(a){r=ye(a,e);const n=me(t,["c:yVal","c:numLit","c:pt"])||me(t,["c:yVal","c:strLit","c:pt"]);n&&(r=n.map(t=>t["c:v"]))}o=n.map((t,e)=>[t,r[e]]);break}case"pie":{let n=[],i=[];const r=me(t,["c:val","c:numRef","c:f"]);if(r)n=ye(r,e);else{const e=me(t,["c:val","c:numLit","c:pt"]);e&&(n=e.map(t=>t["c:v"]))}const a=me(t,["c:cat","c:strRef","c:f"]);if(a)i=ye(a,e);else{const e=me(t,["c:cat","c:numLit","c:pt"]);e&&(i=e.map(t=>t["c:v"]))}o=n.map((t,e)=>({name:i[e],value:t}));break}case"radar":{const e=me(t,["c:val","c:numRef","c:f"]);if(e){o=[{value:e}];break}const n=me(t,["c:val","c:numLit","c:pt"]);o=n?n.map(t=>t["c:v"]):[];break}default:{const e=me(t,["c:val","c:numRef","c:f"]);if(e){o=e;break}const n=me(t,["c:val","c:numLit","c:pt"]);if(n){o=n.map(t=>t["c:v"]);break}o=[]}}return{name:me(t,["c:tx","c:strRef","c:f"])??me(t,["c:tx","c:v"])??`系列${i+1}`,type:n,data:o,...r}},c=[["c:lineChart",()=>{const t=fe(i["c:lineChart"]["c:ser"]);s||(s=ge(t[0])),t.forEach((t,e)=>{const n=t?.["c:marker"],i=n?.["c:symbol"]?._$val,r=Number(n?.["c:size"]?._$val),o=!!i&&"none"!==i,s=Number.isFinite(r)&&r>0?96*r/72:void 0;a.series.push(l(t,"line",e,{showSymbol:o,symbolSize:s}))})}],["c:barChart",()=>{const t=i["c:barChart"],e=t["c:barDir"]?._$val,n="bar"===e,r=fe(t["c:ser"]),o={};"stacked"==t["c:grouping"]?._$val&&(o.stack="total"),s||(s=ge(r[0])),r.forEach((t,e)=>a.series.push(l(t,"bar",e,o)));const c=Math.round((me(i,["c:catAx","c:txPr","a:p","a:pPr","a:defRPr","_$sz"])??900)/75),h=Math.round((me(i,["c:valAx","c:txPr","a:p","a:pPr","a:defRPr","_$sz"])??900)/75);a.xAxis=n?{type:"value",axisLabel:{fontSize:h}}:{type:"category",data:s,axisLabel:{fontSize:c}},a.yAxis=n?{type:"category",data:s,axisLabel:{fontSize:c}}:{type:"value",axisLabel:{fontSize:h}}}],["c:areaChart",()=>{const t=fe(i["c:areaChart"]["c:ser"]);s||(s=ge(t[0])),t.forEach((t,e)=>a.series.push(l(t,"line",e,{areaStyle:{}})))}],["c:scatterChart",()=>{const t=fe(i["c:scatterChart"]["c:ser"]);s||(s=ge(t[0])),t.forEach((t,e)=>a.series.push(l(t,"scatter",e,{symbolSize:96*(+t?.["c:marker"]?.["c:symbolSize"]||5)/72||5})))}],["c:pieChart",()=>{const t=fe(i["c:pieChart"]["c:ser"])[0];a.series.push(l(t,"pie",1))}],["c:doughnutChart",()=>{const t=fe(i["c:doughnutChart"]["c:ser"])[0];a.series.push(l(t,"pie",1,{radius:["40%","50%"]}))}],["c:radarChart",()=>{const t=fe(i["c:radarChart"]["c:ser"]);let n=me(t[0],["c:cat","c:strRef","c:f"])??me(t[0],["c:cat","c:strLit","c:pt"])??[];n="string"==typeof n?ye(n,e):n.map(t=>t["c:v"]),a.radar={indicator:n.map(t=>({name:t}))},a.series[0]={name:"",type:"radar",data:t.map((t,e)=>{const n=l(t,"radar",e);return{name:n.name,value:n.data[0].value}})}}]];c.forEach(([t,e])=>{i[t]&&e()}),!a.xAxis&&s&&(a.xAxis={type:"category",data:s},Array.isArray(s)&&0==s.length&&delete a.xAxis.data,a.yAxis={type:"value"});const h=me(i,["c:layout","c:manualLayout"]);if(h){const t=parseFloat(h["c:x"]?._$val),e=parseFloat(h["c:y"]?._$val),n=parseFloat(h["c:w"]?._$val),i=parseFloat(h["c:h"]?._$val);isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||(a.grid={left:100*t+"%",top:100*e+"%",right:100*(1-t-n)+"%",bottom:100*(1-e-i)+"%",containLabel:!0})}return le(a,e)})(this.xmlDetail,this.sheet.SN)),this.Cn}set chartOption(t){"chart"==this.type&&(t=le(t,this.sheet?.SN)),this.Cn=t,this.Rn=null,this.Pn=void 0,this.drawCache=null}get renderOption(){return this.Rn?this.Rn:(this.Pn=/(?:'[^']+'|[^'!]+)!\$?[A-Za-z]{1,3}\$?\d+/.test(JSON.stringify(this.chartOption)),this.Rn=((t,e)=>{const n=/^(?:'[^']+'|[^'!]+)!\$?[A-Za-z]{1,3}\$?\d+(?::\$?[A-Za-z]{1,3}\$?\d+)?$/,i=JSON.parse(JSON.stringify(t),(t,i)=>"string"==typeof i&&n.test(i)?((t,e)=>{if("string"!=typeof t)return"";const n=pe(t,e);if(!n.includes("!"))return"";const i=n.split("!"),r=i[0].replaceAll("'",""),o=i[1].replaceAll("$",""),a=[],s=e.getSheet(r);return o.includes(":")?(s.eachCells(o,(t,e)=>a.push(s.getCell(t,e).calcVal)),a):s.getCell(o).calcVal})(i,e):i);if(i.__percent&&Array.isArray(i.series)){const t=i.series.filter(t=>Array.isArray(t.data)&&t.data.length>0);if(t.length>0){const e=t[0].data.length,n=new Array(e).fill(0);t.forEach(t=>t.data.forEach((t,e)=>{n[e]+=Number(t)||0})),t.forEach(t=>{t.data=t.data.map((t,e)=>{const i=n[e];return i?Math.round((Number(t)||0)/i*1e4)/100:0})})}}if(i.series.forEach(t=>{if("scatter"===t.type&&(t.data=t.data.map((t,e)=>{const n=Number(t[0]),i=Number(t[1]),r=Array.isArray(t)&&t.length>2?t[2]:void 0,o=Number.isNaN(n)?e:n,a=Number.isNaN(i)?e:i;return void 0!==r?[o,a,r]:[o,a]}),t.__bubble)){t.large=!1;const e=t.data.map(t=>Array.isArray(t)?Number(t[2]??t[1]??t[0]):Number(t)).filter(t=>Number.isFinite(t)),n=Number.isFinite(t.__bubbleMin)?t.__bubbleMin:Math.min(...e),i=Number.isFinite(t.__bubbleMax)?t.__bubbleMax:Math.max(...e),r=6,o=30;if(Number.isFinite(n)&&Number.isFinite(i)&&i!==n)t.symbolSize=t=>{const e=Array.isArray(t)?t[2]??t[1]??t[0]:t,a=Number.isFinite(Number(e))?Number(e):n;return r+(a-n)/(i-n)*(o-r)};else{const e=(r+o)/2;t.symbolSize=()=>e}}}),i.series?.some(t=>"radar"===t.type)&&i.radar?.indicator){const t=[].concat(...i.series.filter(t=>"radar"===t.type).flatMap(t=>t.data.map(t=>t.value))).filter(t=>"number"==typeof t&&!isNaN(t));if(t.length>0){const e=Math.ceil(1.1*Math.max(...t));i.radar.indicator.forEach(t=>{t.max||(t.max=e)})}const e=i.radar.indicator.length,n=Math.floor(e/4);i.radar.indicator.reverse(),i.radar.indicator=[...i.radar.indicator.slice(-n),...i.radar.indicator.slice(0,-n)],i.series.forEach(t=>{"radar"===t.type&&t.data.forEach(t=>{Array.isArray(t.value)&&(t.value.reverse(),t.value=[...t.value.slice(-n),...t.value.slice(0,-n)])})})}if("waterfall"===i.__chartType&&i.__waterfall){const t=Array.isArray(i.__waterfall.categories)?i.__waterfall.categories:[],e=(Array.isArray(i.__waterfall.values)?i.__waterfall.values:[]).map(t=>{const e=Number(t);return Number.isFinite(e)?e:0}),n=i.__waterfall.seriesName||i.title?.text||"瀑布";let r=0;const o=[],a=e.map(t=>{const e=r;return r+=t,o.push(e),t}),s="#4472C4",l="#ED7D31",c="#FFC000",h=t=>(a[t.dataIndex]??0)>=0?s:l;i.xAxis={type:"category",data:t},i.yAxis={type:"value"},i.xAxis.axisTick={alignWithLabel:!0},!1!==i.legend?.show&&(i.legend={...i.legend||{},data:["增加","减少","总计"],selectedMode:!1,top:i.legend?.top??40,left:i.legend?.left??"center"});const u=t.map(()=>null);i.series=[{name:"辅助",type:"bar",stack:"total",barWidth:"40%",itemStyle:{color:"transparent"},emphasis:{disabled:!0},data:o},{name:n,type:"bar",stack:"total",barWidth:"40%",itemStyle:{color:h},label:{show:!0,position:"top",color:"#595959"},data:a},{name:"增加",type:"bar",stack:"total",barWidth:"40%",data:u,silent:!0,itemStyle:{color:s}},{name:"减少",type:"bar",stack:"total",barWidth:"40%",data:u,silent:!0,itemStyle:{color:l}},{name:"总计",type:"bar",stack:"total",barWidth:"40%",data:u,silent:!0,itemStyle:{color:c}}]}if("histogram"===i.__chartType&&Array.isArray(i.series)){const t=i.series[0],e=(Array.isArray(t?.data)?t.data:[]).map(t=>{const e=Number(t);return Number.isFinite(e)?e:null}).filter(t=>null!=t);if(e.length>0){const n=i.__histogram?.intervalClosed||"r",r=e.reduce((t,e)=>t+e,0)/e.length,o=e.reduce((t,e)=>t+Math.pow(e-r,2),0)/e.length,a=Math.sqrt(o),s=Math.max(...e)-Math.min(...e);let l=a>0?3.5*a/Math.cbrt(e.length):s||1;(!Number.isFinite(l)||l<=0)&&(l=s||1);const c=(()=>{const t=Math.abs(l);if(t<1){const e=Math.pow(10,Math.floor(Math.log10(t))),n=t/e;return(n<=1?1:n<=2?2:n<=5?5:10)*e}return t<10?Math.ceil(t):t<100?5*Math.ceil(t/5):t<1e3?10*Math.ceil(t/10):100*Math.ceil(t/100)})(),h=Math.min(...e);let u=Math.max(1,Math.ceil((Math.max(...e)-h)/c)),d=Array.from({length:u+1},(t,e)=>h+e*c);d[d.length-1]<Math.max(...e)&&(d=d.concat(d[d.length-1]+c)),u=d.length-1;const f=new Array(u).fill(0);e.forEach(t=>{let e;e="r"===n?t<=d[0]?0:Math.ceil((t-d[0])/c)-1:Math.floor((t-d[0])/c),e<0&&(e=0),e>=u&&(e=u-1),f[e]+=1});const p=t=>{if(!Number.isFinite(t))return"";const e=Math.round(1e3*t)/1e3;return Number.isInteger(e)?String(e):String(e).replace(/\.?0+$/,"")},m=f.map((t,e)=>{const i=p(d[e]),r=p(d[e+1]);return"l"===n?`[${i}, ${r}${e===u-1?"]":")"}`:0===e?`[${i}, ${r}]`:`(${i}, ${r}]`});i.legend={...i.legend||{},show:!1},i.xAxis={type:"category",data:m},i.xAxis.axisLabel={...i.xAxis.axisLabel||{},margin:4},i.yAxis={type:"value"},i.series=[{name:t?.name||i.title?.text||"直方图",type:"bar",data:f,barGap:"0%",barCategoryGap:"0%"}],i.grid={...i.grid||{},bottom:5}}}return i})(this.chartOption,this.sheet.SN))}On(){if(null===this.Nt||null===this.Mt)return;let t=this.Nt+this.$n,e=this.xn.c;for(;t>this.sheet.getCol(e).width;)t-=this.sheet.getCol(e).width,e++;let n=this.Mt+this.Mn,i=this.xn.r;for(;n>this.sheet.getRow(i).height;)n-=this.sheet.getRow(i).height,i++;this._n={r:i,c:e},this.En=t,this.In=n}Vn(t,e){"absolute"!==this.anchorType&&(this.xn.r>=t&&(this.xn={...this.xn,r:this.xn.r+e}),"twoCell"===this.anchorType&&this._n&&this._n.r>=t&&(this._n={...this._n,r:this._n.r+e}),this.Sn=null)}Bn(t,e){if("absolute"===this.anchorType)return;const n=t+e;this.xn.r>=n?this.xn={...this.xn,r:this.xn.r-e}:this.xn.r>=t&&(this.xn={...this.xn,r:t},this.Mn=0),"twoCell"===this.anchorType&&this._n&&(this._n.r>=n?this._n={...this._n,r:this._n.r-e}:this._n.r>=t&&(this._n={...this._n,r:t},this.In=0)),this.Sn=null}Hn(t,e){"absolute"!==this.anchorType&&(this.xn.c>=t&&(this.xn={...this.xn,c:this.xn.c+e}),"twoCell"===this.anchorType&&this._n&&this._n.c>=t&&(this._n={...this._n,c:this._n.c+e}),this.Sn=null)}Un(t,e){if("absolute"===this.anchorType)return;const n=t+e;this.xn.c>=n?this.xn={...this.xn,c:this.xn.c-e}:this.xn.c>=t&&(this.xn={...this.xn,c:t},this.$n=0),"twoCell"===this.anchorType&&this._n&&(this._n.c>=n?this._n={...this._n,c:this._n.c-e}:this._n.c>=t&&(this._n={...this._n,c:t},this.En=0)),this.Sn=null}}Object.assign(Se.prototype,{Dn:async function(){const t=new Image;if(await new Promise((e,n)=>{t.onload=e,t.onerror=n,t.src=this.Tn}),null===this.Nt||null===this.Mt){let e,n;t.naturalWidth>200||t.naturalHeight>200?(e=.75*t.naturalWidth,n=.75*t.naturalHeight):(e=t.naturalWidth,n=t.naturalHeight);const i=816;if(e>i){const t=i/e;e=i,n*=t}this.Nt=Math.round(e),this.Mt=Math.round(n),"twoCell"===this.anchorType&&this.On()}return this.An=t,t}}),Object.assign(Se.prototype,{buildShapeXml:function(t){const e=this,n=e.shapeType||"rect",i=e.shapeStyle||{},r=e.shapeText||"",o=e.isConnector,a=!o&&!!e.isTextBox,s="vertical"===i.textDirection?"vertical":"horizontal",l=e.sheet.SN,c=l.Utils.pxToEmu(e.width),h=l.Utils.pxToEmu(e.height),u=Math.round(12700*(i.strokeWidth||1));if(o){const e={"_$w":u.toString()};return i.startArrow&&"none"!==i.startArrow&&(e["a:headEnd"]={"_$type":i.startArrow}),i.endArrow&&"none"!==i.endArrow&&(e["a:tailEnd"]={"_$type":i.endArrow}),{"xdr:nvCxnSpPr":{"xdr:cNvPr":{"_$id":(t+1).toString(),"_$name":`连接符 ${t+1}`},"xdr:cNvCxnSpPr":""},"xdr:spPr":{"a:xfrm":{"a:off":{"_$x":"0","_$y":"0"},"a:ext":{"_$cx":c.toString(),"_$cy":h.toString()}},"a:prstGeom":{"a:avLst":"","_$prst":n},"a:ln":e},"xdr:style":{"a:lnRef":{"a:schemeClr":{"_$val":"accent1"},"_$idx":"1"},"a:fillRef":{"a:schemeClr":{"_$val":"accent1"},"_$idx":"0"},"a:effectRef":{"a:schemeClr":{"_$val":"accent1"},"_$idx":"0"},"a:fontRef":{"a:schemeClr":{"_$val":"tx1"},"_$idx":"minor"}},"_$macro":""}}const d="vertical"===s?"r":"l",f=function(t,e,n){const i=Math.round(100*n).toString(),r=String(t||"").split("\n"),o={"_$lang":"zh-CN","_$altLang":"en-US","_$sz":i},a={"_$lang":"zh-CN","_$altLang":"en-US","_$sz":i};return r.map(t=>{const n={"a:pPr":{"_$algn":e}};return""!==t&&(n["a:r"]={"a:rPr":o,"a:t":t}),n["a:endParaRPr"]=a,n})}(r,i.textAlign||d,i.fontSize||11),p={"_$vertOverflow":"clip","_$horzOverflow":"clip","_$wrap":"square","_$rtlCol":"0","_$anchor":"t"};"vertical"===s&&(p._$vert="wordArtVertRtl");const m={"a:xfrm":{"a:off":{"_$x":"0","_$y":"0"},"a:ext":{"_$cx":c.toString(),"_$cy":h.toString()}},"a:prstGeom":{"a:avLst":"","_$prst":n}};return e.Fn&&(m["a:xfrm"]._$rot=Math.round(6e4*e.Fn).toString()),a&&(m["a:solidFill"]={"a:schemeClr":{"_$val":"lt1"}},m["a:ln"]={"_$w":u.toString(),"_$cmpd":"sng","a:solidFill":{"a:schemeClr":{"a:shade":{"_$val":"50000"},"_$val":"lt1"}}}),{"xdr:nvSpPr":{"xdr:cNvPr":{"a:extLst":{"a:ext":{"a16:creationId":{"_$xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main","_$id":`{${"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16).toUpperCase()})}}`},"_$uri":"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},"_$id":(t+1).toString(),"_$name":a?`文本框 ${t+1}`:`${"rect"===n?"矩形":"ellipse"===n?"椭圆":"形状"} ${t+1}`},"xdr:cNvSpPr":a?{"_$txBox":"1"}:""},"xdr:spPr":m,"xdr:style":a?{"a:lnRef":{"a:scrgbClr":{"_$r":"0","_$g":"0","_$b":"0"},"_$idx":"0"},"a:fillRef":{"a:scrgbClr":{"_$r":"0","_$g":"0","_$b":"0"},"_$idx":"0"},"a:effectRef":{"a:scrgbClr":{"_$r":"0","_$g":"0","_$b":"0"},"_$idx":"0"},"a:fontRef":{"a:schemeClr":{"_$val":"dk1"},"_$idx":"minor"}}:{"a:lnRef":{"a:schemeClr":{"a:shade":{"_$val":"15000"},"_$val":"accent1"},"_$idx":"2"},"a:fillRef":{"a:schemeClr":{"_$val":"accent1"},"_$idx":"1"},"a:effectRef":{"a:schemeClr":{"_$val":"accent1"},"_$idx":"0"},"a:fontRef":{"a:schemeClr":{"_$val":"lt1"},"_$idx":"minor"}},"xdr:txBody":{"a:bodyPr":p,"a:lstStyle":"","a:p":1===f.length?f[0]:f},"_$macro":"","_$textlink":""}}});class Ce{constructor(t){this.sheet=t,this.map=new Map,this.Kn=[]}addChart(t,e){return this.Wn({...e,type:"chart",chartOption:t})}addImage(t,e){return this.Wn({...e,type:"image",imageBase64:t})}addShape(t,e){return this.Wn({...e,type:"shape",shapeType:t})}Wn(t){const e={chart:()=>t.chartOption?null:"必要参数缺失：chartOption",image:()=>t.imageBase64?null:"必要参数缺失：imageBase64",shape:()=>null,slicer:()=>null};if(!e[t.type])return this.sheet.SN.Utils.toast(this.sheet.SN.t("core.drawing.drawing.toast.unsupportedType",{type:t.type}));const n=e[t.type]();if(n){const e={chart:"图表",image:"图片",shape:"形状",slicer:"切片器"}[t.type]||"图形";return this.sheet.SN.Utils.toast(this.sheet.SN.t("core.drawing.drawing.toast.createFailedByType",{label:e,error:n}))}if(this.sheet.SN.Event.hasListeners("beforeDrawingAdd")&&this.sheet.SN.Event.emit("beforeDrawingAdd",{sheet:this.sheet,config:t}).canceled)return null;const i=new Se(t,this.sheet);return this.sheet.wn=Math.max(this.sheet.wn,parseInt(i.id.replace("rId",""))||0),this.map.set(i.id,i),this.Kn.push(i),this.sheet.SN.Event.hasListeners("afterDrawingAdd")&&this.sheet.SN.Event.emit("afterDrawingAdd",{sheet:this.sheet,config:t,drawing:i}),i}remove(t){const e=this.map.get(t);if(!e)return;if(this.sheet.SN.Event.hasListeners("beforeDrawingRemove")&&this.sheet.SN.Event.emit("beforeDrawingRemove",{sheet:this.sheet,drawing:e,id:t}).canceled)return;this.map.delete(t);const n=this.Kn.indexOf(e);n>-1&&this.Kn.splice(n,1),this.sheet.SN.Event.hasListeners("afterDrawingRemove")&&this.sheet.SN.Event.emit("afterDrawingRemove",{sheet:this.sheet,drawing:e,id:t})}get(t){return this.map.get(t)||null}getByCell(t){return"string"==typeof t&&(t=this.sheet.Utils.cellStrToNum(t)),this.Kn.filter(e=>{const{s:n,e:i}=e.area;return t.r>=n.r&&t.r<=i.r&&t.c>=n.c&&t.c<=i.c})}getAll(){return this.Kn}jn(t){if(!t?.drawing)return;const e=t.drawing["_$r:id"],n=this.sheet.SN.Xml.getWsRelsFileTarget(this.sheet.rId,e),i=this.sheet.SN.Xml.obj[n];if(!i)return;const r=this.sheet.SN.Utils.objToArr(i["xdr:wsDr"]["xdr:oneCellAnchor"]).map(t=>({...t,__anchorType:"oneCell"})),o=this.sheet.SN.Utils.objToArr(i["xdr:wsDr"]["xdr:twoCellAnchor"]).map(t=>{const e=t._$editAs,n="absolute"===e?"absolute":"oneCell"===e?"oneCell":"twoCell";return{...t,__anchorType:n}}),a=this.sheet.SN.Utils.objToArr(i["xdr:wsDr"]["xdr:absoluteAnchor"]).map(t=>({...t,__anchorType:"absolute"})),s=[].concat(r,o,a),l=this.sheet.SN.Utils.objToArr(this.sheet.SN.Xml.getRelsByTarget(n));s.forEach(t=>{const e=this.qn(t,l);e&&(this.map.set(e.id,e),this.Kn.push(e))})}qn(t,e){let n,i,r;const o=this.sheet.SN.Utils.objToArr(e),a=(()=>{if(t["xdr:graphicFrame"])return t["xdr:graphicFrame"];const e=t["mc:AlternateContent"];if(!e)return null;const n=this.sheet.SN.Utils.objToArr(e["mc:Choice"]);for(const t of n)if(t?.["xdr:graphicFrame"])return t["xdr:graphicFrame"];return null})();if(a){const t=a["a:graphic"]?.["a:graphicData"];if(String(t?._$uri||"").toLowerCase().includes("/slicer"))return null;const e=t?.["c:chart"]||t?.["cx:chart"];if(i=e?.["_$r:id"],!i)return null;n="chart";const s=o.find(t=>t._$Id===i),l=s?s._$Target.replace("..","xl"):null;r=l?this.sheet.SN.Xml.obj[l]:null}else if(t["xdr:pic"]){if(n="image",i=t["xdr:pic"]?.["xdr:blipFill"]?.["a:blip"]?.["_$r:embed"],!i)return null;const e=o.find(t=>t._$Id===i),a=e?e._$Target.replace("..","xl"):null;r=a?this.sheet.SN.Xml.obj[a]:null}else if(t["xdr:cxnSp"]){n="shape";const e=t["xdr:cxnSp"];r=e,i=e["xdr:nvCxnSpPr"]["xdr:cNvPr"]._$id}else if(t["xdr:sp"]){n="shape";const e=t["xdr:sp"];r=e,i=e["xdr:nvSpPr"]["xdr:cNvPr"]._$id}if(!n)return null;const s=new Se({type:n,startCell:t["xdr:from"]?{r:+t["xdr:from"]["xdr:row"],c:+t["xdr:from"]["xdr:col"]}:{r:0,c:0},xmlDetail:r,anchorType:t.__anchorType},this.sheet),l=t["xdr:pic"]?.["xdr:spPr"]||t["xdr:sp"]?.["xdr:spPr"]||t["xdr:cxnSp"]?.["xdr:spPr"],c=l?.["a:xfrm"]?._$rot;if(c&&(s.Fn=+c/6e4),"absolute"===t.__anchorType&&t["xdr:pos"]){const e=this.sheet.Utils.emuToPx(+t["xdr:pos"]._$x),n=this.sheet.Utils.emuToPx(+t["xdr:pos"]._$y),i=this.sheet.Utils.emuToPx(+t["xdr:ext"]._$cx),r=this.sheet.Utils.emuToPx(+t["xdr:ext"]._$cy);s.Sn={s:{r:0,c:0,offsetX:e,offsetY:n},e:{r:0,c:0,offsetX:e+i,offsetY:n+r}},s.Nt=i,s.Mt=r,s.$n=e,s.Mn=n}else s.Sn={s:{r:+t["xdr:from"]["xdr:row"],c:+t["xdr:from"]["xdr:col"],offsetX:this.sheet.Utils.emuToPx(+t["xdr:from"]["xdr:colOff"]),offsetY:this.sheet.Utils.emuToPx(+t["xdr:from"]["xdr:rowOff"])},e:{r:+t["xdr:to"]["xdr:row"],c:+t["xdr:to"]["xdr:col"],offsetX:this.sheet.Utils.emuToPx(+t["xdr:to"]["xdr:colOff"]),offsetY:this.sheet.Utils.emuToPx(+t["xdr:to"]["xdr:rowOff"])}},s.$n=s.Sn.s.offsetX,s.Mn=s.Sn.s.offsetY,"twoCell"===s.anchorType&&(s._n={r:s.Sn.e.r,c:s.Sn.e.c},s.En=s.Sn.e.offsetX,s.In=s.Sn.e.offsetY);return this.sheet.getCell(s.Sn.e.r,s.Sn.e.c),s}Gn(){this.Kn.forEach(t=>{t.An=null,t.Rn=null})}ct(){for(const t of this.Kn)t.Pn&&(t.Rn=null,t.An=null)}Xn(t,e){for(const n of this.Kn)n.Vn(t,e)}Yn(t,e){for(const n of this.Kn)n.Bn(t,e)}Jn(t,e){for(const n of this.Kn)n.Hn(t,e)}Zn(t,e){for(const n of this.Kn)n.Un(t,e)}Qn(){return 0===this.Kn.length?null:{drawings:this.Kn,count:this.Kn.length}}}class Te{constructor(t,e){this.sheet=e,this.r=t.r,this.c=t.c,this.sqref=t.sqref,this.formula=t.formula,this.group=t.group,this.ti=null,this.ei=null}get key(){return`${this.r}:${this.c}`}get type(){return this.group.type}set type(t){this.group.type=t}get colors(){return this.group.colors}set colors(t){this.group.colors=t}getData(){if(this.ti)return this.ti;const t=this.formula.match(/^(.+?)!(.+)$/);if(!t)return[];const[,e,n]=t,i=e.replace(/^'|'$/g,""),r=this.sheet.SN.getSheet(i)||this.sheet,o=r.rangeStrToNum(n),a=[];return r.eachCells(o,(t,e)=>{const n=r.getCell(t,e),i=n.calcVal??n.editVal;if(null!=i&&""!==i){const t=parseFloat(i);a.push(isNaN(t)?null:t)}else a.push(null)}),this.ti=a,a}zt(){this.ti=null,this.ei=null}Dt(){return{"xm:f":this.formula,"xm:sqref":this.sqref}}}const $e={series:"#376092",negative:"#D00000",axis:"#000000",markers:"#D00000",first:"#D00000",last:"#D00000",high:"#D00000",low:"#D00000"};class Me{constructor(t){this.sheet=t,this.map=new Map,this.groups=[]}add(t){const e=this.sheet.SN,n="string"==typeof t.cellRef?e.Utils.cellStrToNum(t.cellRef):t.cellRef,i=n.r,r=n.c,{formula:o,type:a="line",colors:s={}}=t;if(e.Event.hasListeners("beforeSparklineAdd")&&e.Event.emit("beforeSparklineAdd",{sheet:this.sheet,config:t}).canceled)return null;let l=this.groups.find(t=>t.type===a);l||(l=this.ni(a,s),this.groups.push(l));const c=new Te({r:i,c:r,sqref:e.Utils.cellNumToStr({r:i,c:r}),formula:o,group:l},this.sheet);return this.map.set(c.key,c),e.Event.hasListeners("afterSparklineAdd")&&e.Event.emit("afterSparklineAdd",{sheet:this.sheet,config:t,sparkline:c}),c}remove(t){const e="string"==typeof t?this.sheet.SN.Utils.cellStrToNum(t):t,n=e.r,i=e.c,r=`${n}:${i}`,o=this.map.get(r);if(!o)return!1;const a=this.sheet.SN;return!(a.Event.hasListeners("beforeSparklineRemove")&&a.Event.emit("beforeSparklineRemove",{sheet:this.sheet,sparkline:o,r:n,c:i}).canceled||(this.map.delete(r),a.Event.hasListeners("afterSparklineRemove")&&a.Event.emit("afterSparklineRemove",{sheet:this.sheet,sparkline:o,r:n,c:i}),0))}get(t){const e="string"==typeof t?this.sheet.SN.Utils.cellStrToNum(t):t;return this.map.get(`${e.r}:${e.c}`)??null}getAll(){return Array.from(this.map.values())}clearCache(t,e){const n="number"==typeof t?{r:t,c:e}:t,i=this.get(n);i&&i.zt()}clearAllCache(){this.map.forEach(t=>t.zt())}parse(t){const e=t?.extLst;if(!e)return;const n=(Array.isArray(e.ext)?e.ext:[e.ext]).find(t=>"{05C60535-1F16-4fd2-B633-F4F36F0B64E0}"===t._$uri);if(!n)return;const i=n["x14:sparklineGroups"]?.["x14:sparklineGroup"];i&&(Array.isArray(i)?i:[i]).forEach((t,e)=>{const n=this.ii(t,e);this.groups.push(n);const i=t["x14:sparklines"]?.["x14:sparkline"];i&&(Array.isArray(i)?i:[i]).forEach(t=>{const e=this.ri(t,n);this.map.set(e.key,e)})})}ii(t,e){const n={...$e};return Object.entries({series:"x14:colorSeries",negative:"x14:colorNegative",axis:"x14:colorAxis",markers:"x14:colorMarkers",first:"x14:colorFirst",last:"x14:colorLast",high:"x14:colorHigh",low:"x14:colorLow"}).forEach(([e,i])=>{const r=this.oi(t[i]);r&&(n[e]=r)}),{id:e,type:t._$type||"line",lineWeight:t._$lineWeight?parseFloat(t._$lineWeight):.75,manualMax:t._$manualMax?parseFloat(t._$manualMax):null,manualMin:t._$manualMin?parseFloat(t._$manualMin):null,dateAxis:"1"===t._$dateAxis,markers:"1"===t._$markers,high:"1"===t._$high,low:"1"===t._$low,first:"1"===t._$first,last:"1"===t._$last,negative:"1"===t._$negative,displayEmptyCellsAs:t._$displayEmptyCellsAs||"gap",colors:n}}ri(t,e){const n=t["xm:sqref"],i=t["xm:f"],r=this.sheet.SN.Utils.cellStrToNum(n);return new Te({r:r.r,c:r.c,sqref:n,formula:i,group:e},this.sheet)}oi(t){if(!t)return null;const e=t._$rgb;return e?"#"+e.slice(2):null}ni(t,e={}){return{id:this.groups.length,type:t,displayEmptyCellsAs:"gap",colors:{series:e.series||$e.series,negative:e.negative||$e.negative,axis:e.axis||$e.axis,markers:e.markers||$e.markers,first:e.first||$e.first,last:e.last||$e.last,high:e.high||$e.high,low:e.low||$e.low},lineWeight:.75,manualMax:null,manualMin:null,dateAxis:!1,markers:!1,high:!1,low:!1,first:!1,last:!1,negative:!1}}toXmlObj(){if(0===this.groups.length)return null;const t=this.groups.map(t=>{const e=this.getAll().filter(e=>e.group.id===t.id);if(0===e.length)return null;const n={"x14:colorSeries":{"_$rgb":"FF"+t.colors.series.slice(1)},"x14:colorNegative":{"_$rgb":"FF"+t.colors.negative.slice(1)},"x14:colorAxis":{"_$rgb":"FF"+t.colors.axis.slice(1)},"x14:colorMarkers":{"_$rgb":"FF"+t.colors.markers.slice(1)},"x14:colorFirst":{"_$rgb":"FF"+t.colors.first.slice(1)},"x14:colorLast":{"_$rgb":"FF"+t.colors.last.slice(1)},"x14:colorHigh":{"_$rgb":"FF"+t.colors.high.slice(1)},"x14:colorLow":{"_$rgb":"FF"+t.colors.low.slice(1)},"x14:sparklines":{"x14:sparkline":e.map(t=>t.Dt())},"_$displayEmptyCellsAs":t.displayEmptyCellsAs};return"line"!==t.type&&(n._$type=t.type),.75!==t.lineWeight&&(n._$lineWeight=t.lineWeight.toString()),null!==t.manualMax&&(n._$manualMax=t.manualMax.toString()),null!==t.manualMin&&(n._$manualMin=t.manualMin.toString()),t.dateAxis&&(n._$dateAxis="1"),t.markers&&(n._$markers="1"),t.high&&(n._$high="1"),t.low&&(n._$low="1"),t.first&&(n._$first="1"),t.last&&(n._$last="1"),t.negative&&(n._$negative="1"),n}).filter(Boolean);return 0===t.length?null:{"ext":[{"x14:sparklineGroups":{"x14:sparklineGroup":t,"_$xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},"_$uri":"{05C60535-1F16-4fd2-B633-F4F36F0B64E0}","_$xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}]}}}class Ae{constructor(t,e){this.sheet=e,this.type=t.type,this.priority=t.priority,this.sqref=t.sqref,this.stopIfTrue=t.stopIfTrue||!1,this.dxf=t.dxf||null,this.needsRangeData=!1,this.$=e.SN,this.li={...t},this.ci=new Map,this.hi=null}evaluate(t,e,n,i){return!1}getFormat(t,e,n,i){return this.evaluate(t,e,n,i)&&this.dxf?{...this.dxf}:null}getRangeData(){if(this.hi)return this.hi;const t=this.sheet.rangeStrToNum(this.sqref),e=[],n=[],i=new Map,r=this.sheet.rows;for(const s in r){const o=parseInt(s);if(o<t.s.r||o>t.e.r)continue;const a=r[s];if(a.cells)for(const r in a.cells){const s=parseInt(r);if(s<t.s.c||s>t.e.c)continue;const l=a.cells[r].calcVal;"number"!=typeof l||isNaN(l)||e.push({r:o,c:s,val:l});const c=String(l??"");i.has(c)||i.set(c,[]),i.get(c).push({r:o,c:s}),null!=l&&""!==l&&n.push({r:o,c:s,val:c})}}const o=[...e].sort((t,e)=>t.val-e.val),a=e.map(t=>t.val);return this.hi={values:e,textValues:n,sorted:o,cellMap:i,min:o.length>0?o[0].val:0,max:o.length>0?o[o.length-1].val:0,avg:a.length>0?a.reduce((t,e)=>t+e,0)/a.length:0,count:e.length,totalCount:n.length},this.hi}resolveFormula(t,e,n){if(null==t)return null;if("number"==typeof t)return t;const i=String(t).trim(),r=parseFloat(i);if(!isNaN(r)&&String(r)===i)return r;if(this.$.Formula)try{return this.$.Formula.calcFormula(i,{row:{rIndex:e},cIndex:n})}catch(t){return null}return i}zt(){this.ci.clear(),this.hi=null}Dt(t){const e={"_$type":this.type,"_$priority":String(this.priority)};return this.stopIfTrue&&(e._$stopIfTrue="1"),this.dxf&&(e._$dxfId=String(t.getDxfId(this.dxf))),this.ui(e,t),e}ui(t,e){}}function Ne(t){if(!t)return[0,0,0];if(t.startsWith("#")){const e=t.slice(1);if(6===e.length)return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)];if(3===e.length)return[parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16)]}const e=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);return e?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]:[0,0,0]}function ke(t){return"#"+t.map(t=>Math.max(0,Math.min(255,Math.round(t))).toString(16).padStart(2,"0")).join("")}function Re(t,e,n){const i=Ne(t),r=Ne(e);return ke([i[0]+(r[0]-i[0])*n,i[1]+(r[1]-i[1])*n,i[2]+(r[2]-i[2])*n])}function _e(t,e,n){if(!t)return 0;const{sorted:i,min:r,max:o,avg:a,count:s}=e,l=i.map(t=>t.val);switch(t.type){case"min":return r;case"max":return o;case"num":return t.val??0;case"percent":return r+(o-r)*(t.val??0)/100;case"percentile":return function(t,e){if(0===t.length)return 0;if(1===t.length)return t[0];const n=e/100*(t.length-1),i=Math.floor(n),r=Math.ceil(n),o=n-i;return i===r?t[i]:t[i]*(1-o)+t[r]*o}(l,t.val??50);case"formula":return n?n(t.val):0;case"autoMin":return Math.min(0,r);case"autoMax":return Math.max(0,o);default:return 0}}function Ie(t){return"string"==typeof t&&["#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#NULL!","#GETTING_DATA","#SPILL!","#CALC!"].includes(t)}function Fe(t){return null==t||""===t}function Ee(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()}function De(t){return t?"FF"+(t.startsWith("#")?t.slice(1):t).toUpperCase():"FF000000"}class Le extends Ae{constructor(t,e){super(t,e),this.operator=t.operator||"equal",this.formula1=t.formula1,this.formula2=t.formula2}evaluate(t,e,n,i){const r=t.calcVal,o=this.resolveFormula(this.formula1,e,n),a=this.resolveFormula(this.formula2,e,n);return"number"==typeof r&&"number"==typeof o?function(t,e,n,i){if(null==t)return!1;switch(e){case"greaterThan":return t>n;case"lessThan":return t<n;case"equal":return t===n;case"notEqual":return t!==n;case"greaterThanOrEqual":return t>=n;case"lessThanOrEqual":return t<=n;case"between":return t>=n&&t<=i;case"notBetween":return t<n||t>i;default:return!1}}(r,this.operator,o,a):"equal"===this.operator?String(r)===String(o):"notEqual"===this.operator&&String(r)!==String(o)}ui(t,e){t._$operator=this.operator;const n=[];null!==this.formula1&&void 0!==this.formula1&&n.push(String(this.formula1)),null!==this.formula2&&void 0!==this.formula2&&n.push(String(this.formula2)),n.length>0&&(t.formula=n)}}class Pe extends Ae{constructor(t,e){super(t,e),this.cfvos=t.cfvos||[{type:"min"},{type:"max"}],this.colors=t.colors||["#F8696B","#63BE7B"],this.needsRangeData=!0}evaluate(t,e,n,i){return"number"==typeof t.calcVal&&!isNaN(t.calcVal)}getFormat(t,e,n,i){const r=t.calcVal;if("number"!=typeof r||isNaN(r))return null;i||(i=this.getRangeData());const o=this.cfvos.map(t=>_e(t,i,t=>this.resolveFormula(t,e,n)));return{fill:{type:"pattern",pattern:"solid",fgColor:this.di(r,o)},mi:!0}}di(t,e){const n=this.colors;if(2===n.length){const[i,r]=e;if(r===i)return n[0];const o=Math.max(0,Math.min(1,(t-i)/(r-i)));return Re(n[0],n[1],o)}if(n.length>=3){const[i,r,o]=e;let a;return a=t<=r?i===r?0:(t-i)/(r-i)*.5:r===o?1:.5+(t-r)/(o-r)*.5,a=Math.max(0,Math.min(1,a)),function(t,e,n,i){return i<=.5?Re(t,e,2*i):Re(e,n,2*(i-.5))}(n[0],n[1],n[2],a)}return n[0]||"#FFFFFF"}ui(t,e){t.colorScale={cfvo:this.cfvos.map(t=>{const e={"_$type":t.type};return null!==t.val&&void 0!==t.val&&(e._$val=String(t.val)),e}),color:this.colors.map(t=>({"_$rgb":De(t)}))}}}class ze extends Ae{constructor(t,e){super(t,e),this.minCfvo=t.minCfvo||{type:"min"},this.maxCfvo=t.maxCfvo||{type:"max"},this.color=t.color||"#638EC6",this.showValue=!1!==t.showValue,this.gradient=!1!==t.gradient,this.negativeColor=t.negativeColor||"#FF0000",this.borderColor=t.borderColor||null,this.negativeBorderColor=t.negativeBorderColor||null,this.axisColor=t.axisColor||"#000000",this.direction=t.direction||"context",this.minLength=t.minLength??10,this.maxLength=t.maxLength??90,this.needsRangeData=!0}evaluate(t,e,n,i){return"number"==typeof t.calcVal&&!isNaN(t.calcVal)}getFormat(t,e,n,i){const r=t.calcVal;if("number"!=typeof r||isNaN(r))return null;i||(i=this.getRangeData());const o=_e(this.minCfvo,i,t=>this.resolveFormula(t,e,n)),a=_e(this.maxCfvo,i,t=>this.resolveFormula(t,e,n));let s,l=null;if(o<0&&a>0){const t=a-o;l=Math.abs(o)/t,s=r>=0?r/a:r/o}else s=a===o?.5:(r-o)/(a-o);s=Math.max(-1,Math.min(1,s));const c=this.minLength/100,h=c+(this.maxLength/100-c)*Math.abs(s);return{dataBar:{percent:r<0?-h:h,color:r>=0?this.color:this.negativeColor,gradient:this.gradient,borderColor:r>=0?this.borderColor:this.negativeBorderColor,showValue:this.showValue,axisPosition:l,axisColor:this.axisColor,direction:this.direction,isNegative:r<0}}}ui(t,e){const n=[{"_$type":this.minCfvo.type},{"_$type":this.maxCfvo.type}];null!==this.minCfvo.val&&void 0!==this.minCfvo.val&&(n[0]._$val=String(this.minCfvo.val)),null!==this.maxCfvo.val&&void 0!==this.maxCfvo.val&&(n[1]._$val=String(this.maxCfvo.val)),t.dataBar={cfvo:n,color:{"_$rgb":De(this.color)}},this.showValue||(t.dataBar._$showValue="0"),10!==this.minLength&&(t.dataBar._$minLength=String(this.minLength)),90!==this.maxLength&&(t.dataBar._$maxLength=String(this.maxLength))}}const Oe={"3Arrows":{count:3,icons:["arrowDown","arrowSide","arrowUp"]},"3ArrowsGray":{count:3,icons:["arrowDownGray","arrowSideGray","arrowUpGray"]},"3Flags":{count:3,icons:["flagRed","flagYellow","flagGreen"]},"3Signs":{count:3,icons:["signRed","signYellow","signGreen"]},"3Symbols":{count:3,icons:["symbolX","symbolExclaim","symbolCheck"]},"3Symbols2":{count:3,icons:["symbolX2","symbolExclaim2","symbolCheck2"]},"3TrafficLights1":{count:3,icons:["lightRed","lightYellow","lightGreen"]},"3TrafficLights2":{count:3,icons:["lightRed2","lightYellow2","lightGreen2"]},"3Stars":{count:3,icons:["starEmpty","starHalf","starFull"]},"3Triangles":{count:3,icons:["triangleDown","triangleDash","triangleUp"]},"4Arrows":{count:4,icons:["arrowDown","arrowTiltDown","arrowTiltUp","arrowUp"]},"4ArrowsGray":{count:4,icons:["arrowDownGray","arrowTiltDownGray","arrowTiltUpGray","arrowUpGray"]},"4Rating":{count:4,icons:["rating1","rating2","rating3","rating4"]},"4RedToBlack":{count:4,icons:["circleBlack","circleGray","circlePink","circleRed"]},"4TrafficLights":{count:4,icons:["lightBlack","lightRed","lightYellow","lightGreen"]},"5Arrows":{count:5,icons:["arrowDown","arrowTiltDown","arrowSide","arrowTiltUp","arrowUp"]},"5ArrowsGray":{count:5,icons:["arrowDownGray","arrowTiltDownGray","arrowSideGray","arrowTiltUpGray","arrowUpGray"]},"5Boxes":{count:5,icons:["box0","box1","box2","box3","box4"]},"5Quarters":{count:5,icons:["quarter0","quarter1","quarter2","quarter3","quarter4"]},"5Rating":{count:5,icons:["rating1","rating2","rating3","rating4","rating5"]}};class Be extends Ae{constructor(t,e){super(t,e);const n=t.iconSet&&"object"==typeof t.iconSet?t.iconSet:null;this.iconSet=("string"==typeof t.iconSet?t.iconSet:n?.iconSet)||"3TrafficLights1",this.cfvos=t.cfvos||n?.cfvo||this.pi(),this.reverse=("boolean"==typeof t.reverse?t.reverse:n?.reverse)||!1;const i=void 0!==t.showValue?t.showValue:n?.showValue;this.showValue=!1!==i,this.needsRangeData=!0}pi(){const t=Oe[this.iconSet];if(!t)return[{type:"percent",val:0}];const e=t.count,n=[];for(let i=0;i<e;i++)n.push({type:"percent",val:Math.round(100*i/e)});return n}evaluate(t,e,n,i){return"number"==typeof t.calcVal&&!isNaN(t.calcVal)}getFormat(t,e,n,i){const r=t.calcVal;if("number"!=typeof r||isNaN(r))return null;i||(i=this.getRangeData());const o=this.cfvos.map(t=>_e(t,i,t=>this.resolveFormula(t,e,n)));let a=this.bi(r,o);if(this.reverse){const t=Oe[this.iconSet];t&&(a=t.count-1-a)}return{icon:{set:this.iconSet,index:a,showValue:this.showValue}}}bi(t,e){for(let n=e.length-1;n>=0;n--)if(t>=e[n])return n;return 0}ui(t,e){const n="string"==typeof this.iconSet?this.iconSet:"3TrafficLights1";t.iconSet={"_$iconSet":n,cfvo:this.cfvos.map(t=>{const e={"_$type":t.type};return null!==t.val&&void 0!==t.val&&(e._$val=String(t.val)),e})},this.reverse&&(t.iconSet._$reverse="1"),this.showValue||(t.iconSet._$showValue="0")}}class Ve extends Ae{constructor(t,e){super(t,e),this.text=t.text||""}evaluate(t,e,n,i){const r=t.calcVal;if(null==r)return!1;const o=String(r),a=String(this.text);switch(this.type){case"containsText":return o.includes(a);case"notContainsText":return!o.includes(a);case"beginsWith":return o.startsWith(a);case"endsWith":return o.endsWith(a);default:return!1}}ui(t,e){const n=String(this.text??"");t._$text=n;const i=String(this.sqref||"").split(/\s+/).find(Boolean)||"A1";let r="A1";try{if(this.sheet?.rangeStrToNum&&this.sheet?.Utils?.numToChar){const t=this.sheet.rangeStrToNum(i);r=`${this.sheet.Utils.numToChar(t.s.c)}${t.s.r+1}`}}catch(t){r="A1"}const o=n.replace(/"/g,'""');switch(this.type){case"containsText":t._$operator="containsText",t.formula=`NOT(ISERROR(SEARCH("${o}",${r})))`;break;case"notContainsText":t._$operator="notContains",t.formula=`ISERROR(SEARCH("${o}",${r}))`;break;case"beginsWith":t._$operator="beginsWith",t.formula=`LEFT(${r},LEN("${o}"))="${o}"`;break;case"endsWith":t._$operator="endsWith",t.formula=`RIGHT(${r},LEN("${o}"))="${o}"`}}}class He extends Ae{constructor(t,e){super(t,e),this.needsRangeData=!0}evaluate(t,e,n,i){const r=t.calcVal;if(null==r||""===r)return!1;i||(i=this.getRangeData());const o=String(r),a=i.cellMap.get(o);if(!a)return!1;const s=a.length>1;return"duplicateValues"===this.type?s:"uniqueValues"===this.type&&!s}ui(t,e){}}class Ue extends Ae{constructor(t,e){super(t,e),this.rank=t.rank||10,this.percent=t.percent||!1,this.bottom=t.bottom||!1,this.needsRangeData=!0}evaluate(t,e,n,i){const r=t.calcVal;if("number"!=typeof r||isNaN(r))return!1;i||(i=this.getRangeData());const{sorted:o,count:a}=i;if(0===a)return!1;let s,l;return s=this.percent?Math.max(1,Math.ceil(a*this.rank/100)):Math.min(this.rank,a),this.bottom?(l=o[s-1]?.val,r<=l):(l=o[a-s]?.val,r>=l)}ui(t,e){t._$rank=String(this.rank),this.percent&&(t._$percent="1"),this.bottom&&(t._$bottom="1")}}class qe extends Ae{constructor(t,e){super(t,e),this.aboveAverage=!1!==t.aboveAverage,this.equalAverage=t.equalAverage||!1,this.stdDev=t.stdDev||0,this.needsRangeData=!0}evaluate(t,e,n,i){const r=t.calcVal;if("number"!=typeof r||isNaN(r))return!1;i||(i=this.getRangeData());const{avg:o,values:a}=i;let s=o;if(this.stdDev>0){const t=function(t,e){if(0===t.length)return 0;const n=t.map(t=>Math.pow(t-e,2)).reduce((t,e)=>t+e,0)/t.length;return Math.sqrt(n)}(a.map(t=>t.val),o);s=this.aboveAverage?o+t*this.stdDev:o-t*this.stdDev}return this.aboveAverage?this.equalAverage?r>=s:r>s:this.equalAverage?r<=s:r<s}ui(t,e){this.aboveAverage||(t._$aboveAverage="0"),this.equalAverage&&(t._$equalAverage="1"),this.stdDev>0&&(t._$stdDev=String(this.stdDev))}}const Ke=864e5,We=7*Ke;class je extends Ae{constructor(t,e){super(t,e),this.timePeriod=t.timePeriod||"today"}evaluate(t,e,n,i){const r=t.calcVal;if("number"!=typeof r||isNaN(r))return!1;const o=(a=r,new Date(1899,11,30).getTime()+864e5*a);var a;const s=new Date(o),l=new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime(),c=Ee(),h=function(){const t=(new Date).getDay();return Ee()-864e5*t}(),u=function(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).getTime()}(),d=new Date;switch(this.timePeriod){case"today":return l===c;case"yesterday":return l===c-Ke;case"tomorrow":return l===c+Ke;case"last7Days":return l>=c-6*Ke&&l<=c;case"lastWeek":return l>=h-We&&l<h;case"thisWeek":return l>=h&&l<h+We;case"nextWeek":return l>=h+We&&l<h+2*We;case"lastMonth":{const t=new Date(d.getFullYear(),d.getMonth()-1,1).getTime(),e=new Date(d.getFullYear(),d.getMonth(),1).getTime();return l>=t&&l<e}case"thisMonth":{const t=new Date(d.getFullYear(),d.getMonth()+1,1).getTime();return l>=u&&l<t}case"nextMonth":{const t=new Date(d.getFullYear(),d.getMonth()+1,1).getTime(),e=new Date(d.getFullYear(),d.getMonth()+2,1).getTime();return l>=t&&l<e}default:return!1}}ui(t,e){t._$timePeriod=this.timePeriod}}class Ge extends Ae{constructor(t,e){super(t,e)}evaluate(t,e,n,i){const r=t.calcVal;switch(this.type){case"containsBlanks":return Fe(r);case"notContainsBlanks":return!Fe(r);case"containsErrors":return Ie(r);case"notContainsErrors":return!Ie(r);default:return!1}}ui(t,e){}}class Xe extends Ae{constructor(t,e){super(t,e),this.formula=t.formula||""}evaluate(t,e,n,i){if(!this.formula)return!1;const r=this.resolveFormula(this.formula,e,n);return"boolean"==typeof r?r:"number"==typeof r&&0!==r}ui(t,e){this.formula&&(t.formula=[String(this.formula)])}}function Ye(t,e){switch(t.type){case"cellIs":return new Le(t,e);case"colorScale":return new Pe(t,e);case"dataBar":return new ze(t,e);case"iconSet":return new Be(t,e);case"containsText":case"notContainsText":case"beginsWith":case"endsWith":return new Ve(t,e);case"duplicateValues":case"uniqueValues":return new He(t,e);case"top10":return new Ue(t,e);case"aboveAverage":return new qe(t,e);case"timePeriod":return new je(t,e);case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return new Ge(t,e);case"expression":return new Xe(t,e);default:return new Ae(t,e)}}class Ze{constructor(t){this.sheet=t,this.rules=[],this.gi=new Map,this.hi=new Map,this.yi=[],this.wi=new Map}add(t={}){const{rangeRef:e}=t;if(!e)return null;const n=Ye({...t,sqref:e,priority:t.priority??this.xi()},this.sheet);return this.rules.push(n),this.$i(),this.clearRangeCache(e),n}remove(t){if(t<0||t>=this.rules.length)return!1;const e=this.rules[t];return this.rules.splice(t,1),this.clearRangeCache(e.sqref),!0}get(t){return this.rules[t]??null}getAll(){return this.rules}xi(){return 0===this.rules.length?1:Math.max(...this.rules.map(t=>t.priority))+1}parse(t){const e=t?.conditionalFormatting;if(!e)return;const n=Array.isArray(e)?e:[e],i=this.sheet.SN.Xml.obj["xl/styles.xml"]?.styleSheet?.dxfs?.dxf||[],r=Array.isArray(i)?i:[i];for(const o of n){const t=o._$sqref,e=o.cfRule;if(!e)continue;const n=Array.isArray(e)?e:[e];for(const i of n){const e=Ye(this.Mi(i,t,r),this.sheet);this.rules.push(e)}}this.$i()}Mi(t,e,n){const i={type:t._$type,priority:parseInt(t._$priority)||1,sqref:e,stopIfTrue:"1"===t._$stopIfTrue},r=t._$dxfId;if(void 0!==r&&(i.dxf=this.Ci(n[parseInt(r)])),t.formula){const e=Array.isArray(t.formula)?t.formula:[t.formula];i.formula1=e[0],i.formula2=e[1]}if(t._$operator&&(i.operator=t._$operator),t._$text&&(i.text=t._$text),t._$timePeriod&&(i.timePeriod=t._$timePeriod),void 0!==t._$aboveAverage&&(i.aboveAverage="0"!==t._$aboveAverage),void 0!==t._$equalAverage&&(i.equalAverage="1"===t._$equalAverage),void 0!==t._$stdDev&&(i.stdDev=parseInt(t._$stdDev)),void 0!==t._$rank&&(i.rank=parseInt(t._$rank)),void 0!==t._$percent&&(i.percent="1"===t._$percent),void 0!==t._$bottom&&(i.bottom="1"===t._$bottom),t.colorScale){const e=this.Si(t.colorScale);e&&(i.cfvos=e.cfvo,i.colors=e.colors)}if(t.dataBar){const e=this.Ri(t.dataBar);if(e){const t=Array.isArray(e.cfvo)?e.cfvo:[];i.minCfvo=t[0]||{type:"min"},i.maxCfvo=t[1]||{type:"max"},i.color=e.color,i.showValue=e.showValue,i.minLength=e.minLength,i.maxLength=e.maxLength}}if(t.iconSet){const e=this.Ai(t.iconSet);e&&(i.iconSet=e.iconSet,i.cfvos=e.cfvo,i.showValue=e.showValue,i.reverse=e.reverse)}return i}Ci(t){if(!t)return null;const e={};if(t.font&&(e.font={},t.font.b&&(e.font.bold=!0),t.font.i&&(e.font.italic=!0),t.font.strike&&(e.font.strike=!0),t.font.u&&(e.font.underline=!0),t.font.color&&(e.font.color=this.oi(t.font.color))),t.fill?.patternFill){e.fill={};const n=t.fill.patternFill;n.bgColor?e.fill.fgColor=this.oi(n.bgColor):n.fgColor&&(e.fill.fgColor=this.oi(n.fgColor))}if(t.border){e.border={};const n=["top","bottom","left","right"];for(const i of n)t.border[i]&&(e.border[i]={style:t.border[i]._$style||"thin",color:t.border[i].color?this.oi(t.border[i].color):"#000000"})}return Object.keys(e).length>0?e:null}oi(t){if(!t)return null;if(t._$rgb){const e=t._$rgb;return"#"+(8===e.length?e.slice(2):e)}return void 0!==t._$theme?this.sheet.SN.Xml.getThemeColor(parseInt(t._$theme),parseFloat(t._$tint||0)):void 0!==t._$indexed?this.sheet.SN.Xml.getIndexedColor(parseInt(t._$indexed)):null}Si(t){const e=t.cfvo,n=t.color;if(!e||!n)return null;const i=Array.isArray(e)?e:[e],r=Array.isArray(n)?n:[n];return{cfvo:i.map(t=>({type:t._$type,val:void 0!==t._$val?parseFloat(t._$val):void 0})),colors:r.map(t=>this.oi(t))}}Ri(t){const e=t.cfvo;return e?{cfvo:(Array.isArray(e)?e:[e]).map(t=>({type:t._$type,val:void 0!==t._$val?parseFloat(t._$val):void 0})),color:t.color?this.oi(t.color):"#638EC6",showValue:"0"!==t._$showValue,minLength:parseInt(t._$minLength)||10,maxLength:parseInt(t._$maxLength)||90}:null}Ai(t){const e=t.cfvo;if(!e)return null;const n=Array.isArray(e)?e:[e];return{iconSet:t._$iconSet||"3TrafficLights1",cfvo:n.map(t=>({type:t._$type,val:void 0!==t._$val?parseFloat(t._$val):void 0,gte:"0"!==t._$gte})),showValue:"0"!==t._$showValue,reverse:"1"===t._$reverse}}getFormat(t,e){const n=`${t}:${e}`;if(this.gi.has(n))return this.gi.get(n);const i=this.sheet.getCell(t,e);if(!i)return null;let r=null;for(const o of this.rules){if(!this.ki(t,e,o.sqref))continue;const n=o.needsRangeData?this.Ti(o.sqref):null,a=o.getFormat(i,t,e,n);if(a&&(r=r?this.Ni(r,a):a,o.stopIfTrue))break}return this.gi.set(n,r),r}clearAllCache(){this.gi.clear(),this.hi.clear();for(const t of this.rules)t.zt()}clearRangeCache(t){this.hi.delete(t);const e=t.split(" ");for(const n of e){if(!n)continue;const t=this.sheet.rangeStrToNum(n);for(const e of this.gi.keys()){const[n,i]=e.split(":").map(Number);n>=t.s.r&&n<=t.e.r&&i>=t.s.c&&i<=t.e.c&&this.gi.delete(e)}}}toXmlObject(){if(0===this.rules.length)return null;const t=new Map;for(const n of this.rules)t.has(n.sqref)||t.set(n.sqref,[]),t.get(n.sqref).push(n);const e=[];return t.forEach((t,n)=>{t.sort((t,e)=>t.priority-e.priority),e.push({"_$sqref":n,cfRule:t.map(t=>t.Dt(this))})}),e.length>0?e:null}getDxfId(t){const e=JSON.stringify(t);if(this.wi.has(e))return this.wi.get(e);const n=this.yi.length;return this.yi.push(t),this.wi.set(e,n),n}getDxfList(){return this.yi}ki(t,e,n){const i=n.split(" ");for(const r of i){const n=this.sheet.rangeStrToNum(r);if(t>=n.s.r&&t<=n.e.r&&e>=n.s.c&&e<=n.e.c)return!0}return!1}Ti(t){if(this.hi.has(t))return this.hi.get(t);const e=this.rules.find(e=>e.sqref===t);if(e){const n=e.getRangeData();return this.hi.set(t,n),n}return null}$i(){this.rules.sort((t,e)=>t.priority-e.priority)}Ni(t,e){const n={...t};return e.fill&&(n.fill=e.fill),e.font&&(n.font={...t.font,...e.font}),e.border&&(n.border={...t.border,...e.border}),e.dataBar&&!t.dataBar&&(n.dataBar=e.dataBar),e.icon&&!t.icon&&(n.icon=e.icon),e.colorScale&&!t.colorScale&&(n.colorScale=e.colorScale),n}}function Je(t){if(null==t||""===t)return;const e=Number.parseInt(t,10);return Number.isNaN(e)?void 0:e}function Qe(t){return null==t||""===t}function tn(t){if(Qe(t))return"m:";if(t instanceof Date)return`d:${t.toISOString()}`;const e=typeof t;return"number"===e?`n:${t}`:"boolean"===e?"b:"+(t?1:0):`s:${String(t)}`}function en(t){return Qe(t)?"(blank)":t instanceof Date?t.toISOString():String(t)}class nn{constructor(t,e={}){this.cacheId=e.cacheId??this.Fi(t),this.sourceType=e.sourceType??"table",this.sourceSheet=e.sourceSheet??null,this.sourceName=e.sourceName??null,this.sourceId=e.sourceId??null,this.fieldIndex=Number.isFinite(e.fieldIndex)?e.fieldIndex:0,this.fieldName=e.fieldName??"",this.items=[],this.$=t,this._i=new Map,this.Ei=0,this.Ii=!0}Fi(t=this.$){const e=t?.zi?Array.from(t.zi.keys()):[];let n=0;return e.forEach(t=>{t>n&&(n=t)}),n+1}get version(){return this.Ei}markDirty(){this.Ii=!0}getItemMap(){return this._i}getItems({force:t=!1}={}){return(this.Ii||t)&&this.refresh(),this.items}getSourceSheet(){return this.sourceSheet?this.$.getSheet(this.sourceSheet):null}getSourceTable(){const t=this.getSourceSheet();if(!t?.Table)return null;if(this.sourceId){const e=t.Table.get(this.sourceId);if(e)return e}return this.sourceName?t.Table.getByName(this.sourceName):null}getSourcePivotTable(){const t=this.getSourceSheet();return t?.PivotTable&&this.sourceName&&t.PivotTable.get(this.sourceName)||null}refresh(){"pivot"===this.sourceType?this.Di():this.Li(),this.Ii=!1,this.Ei+=1}Li(){const t=this.getSourceTable();if(!t?.range)return this.items=[],void(this._i=new Map);const e=t.sheet,n=t.range,i=n.s.c+this.fieldIndex,r=n.s.r+(t.showHeaderRow?1:0),o=t.showTotalsRow?n.e.r-1:n.e.r,a=[],s=new Map;for(let l=r;l<=o;l++){const t=e.getCell(l,i),n=t.calcVal??t.editVal,r=tn(n);if(s.has(r)){s.get(r).count+=1;continue}const o={key:r,value:Qe(n)?null:n,text:en(n),count:1};s.set(r,o),a.push(o)}this.items=a,this._i=s}Di(){const t=this.getSourcePivotTable(),e=t?.cache,n=e?.fields?.[this.fieldIndex],i=n?.sharedItems?.values??[],r=[],o=new Map;i.forEach((e,n)=>{const i=e?.value??null,a=tn(i);if(o.has(a))return;const s={key:a,value:i,text:t?.Oi?.(this.fieldIndex,n)??en(i),sharedIndex:n,count:0};o.set(a,s),r.push(s)}),this.items=r,this._i=o}}const rn={"zk":'<path d="M304 400L512 608L720 400" fill="none" stroke="currentColor" stroke-width="72" stroke-linecap="round" stroke-linejoin="round"/>',tupian1:'<path d="M300.8 179.2c70.4 0 134.4 57.6 134.4 134.4C435.2 384 377.6 448 300.8 448c-70.4-6.4-134.4-64-134.4-140.8 0-70.4 64-128 134.4-128zM51.2 57.6h921.6c19.2 0 38.4 19.2 38.4 38.4v774.4c0 19.2-19.2 38.4-38.4 38.4H51.2c-19.2 0-38.4-19.2-38.4-38.4V96c0-19.2 19.2-38.4 38.4-38.4z m883.2 76.8H89.6v550.4l179.2-179.2c6.4-6.4 25.6-6.4 32 0L441.6 640l204.8-204.8c6.4-6.4 25.6-6.4 32 0l256 256V134.4zM89.6 748.8V832h844.8v-70.4l-275.2-275.2-185.6 185.6 64 64c6.4 6.4 6.4 25.6 0 32-6.4 6.4-25.6 6.4-32 0l-83.2-83.2-134.4-134.4-198.4 198.4z m211.2-524.8c-44.8 0-83.2 38.4-83.2 83.2 0 51.2 38.4 89.6 89.6 89.6 51.2 0 89.6-38.4 89.6-89.6-6.4-44.8-44.8-83.2-96-83.2z" fill="<path d="M843.494457 366.687361a38.59867 38.59867 0 1 1 38.598669-38.598669 38.59867 38.59867 0 0 1-38.598669 38.598669z m0-170.288248a134.527716 134.527716 0 1 0 134.527716 134.527716 134.527716 134.527716 0 0 0-134.527716-136.798226z m252.594235 388.824834l-157.232816-67.547672a47.68071 47.68071 0 0 0-56.76275 0l-207.184035 139.636364L380.310421 290.05765a48.248337 48.248337 0 0 0-70.385809 0L95.929047 507.45898V95.929047h1000.159645z m0 345.117516H95.929047v-283.813747L340.576497 392.230599l288.922394 359.308204a47.68071 47.68071 0 0 0 63.006652 7.946785l215.698448-144.745012 187.884701 88.54989z m0-930.341463H95.929047A95.929047 95.929047 0 0 0 0 95.929047v832.141906A95.929047 95.929047 0 0 0 95.929047 1021.72949h1000.159645A95.929047 95.929047 0 0 0 1192.017738 928.070953V95.929047A95.929047 95.929047 0 0 0 1096.088692 0z" fill="currentColor"></path>" p-id="4931"></path>',"arrow-left":'<path d="M675.44491137 79.89165958c19.38596386-19.38596386 50.82821669-19.38596386 70.14567844 0a49.5951872 49.5951872 0 0 1 0.54801325 69.59766521l-0.54801325 0.61651414-361.96266195 361.89416107 361.89416107 361.89416107a49.5951872 49.5951872 0 0 1 0.54801324 69.5976652l-0.54801324 0.61651415a49.5951872 49.5951872 0 0 1-69.59766642 0.54801323l-0.61651415-0.54801323-396.89849817-397.0355012a49.5951872 49.5951872 0 0 1-0.54801325-69.59766519l0.54801325-0.61651536 397.03550118-396.96699909z" fill="currentColor"/>',"arrow-right":'<path d="M348.55508863 79.89165958c-19.38596386-19.38596386-50.82821669-19.38596386-70.14567844 0a49.5951872 49.5951872 0 0 0-0.54801325 69.59766521l0.54801325 0.61651414 361.96266195 361.89416107-361.89416107 361.89416107a49.5951872 49.5951872 0 0 0-0.54801324 69.5976652l0.54801324 0.61651415a49.5951872 49.5951872 0 0 0 69.59766642 0.54801323l0.61651415-0.54801323 396.89849817-397.0355012a49.5951872 49.5951872 0 0 0 0.54801325-69.59766519l-0.54801325-0.61651536-397.03550118-396.96699909z" fill="currentColor"/>',tp:'<path d="M906.666667 160v704h-768v-704h768z m-167.061334 366.4l-216.405333 180.096-140.565333-110.890667L202.666667 741.141333V800h640v-188.117333l-103.061334-85.482667zM842.666667 224h-640v434.837333l179.477333-145.130666 139.968 110.421333 217.450667-180.906667 103.104 85.504V224z m-437.333334 42.666667a96 96 0 1 1 0 192 96 96 0 0 1 0-192z m0 64a32 32 0 1 0 0 64 32 32 0 0 0 0-64z"></path>',html:'<path d="M82.816 42.688h858.368l-46.848 819.52L512 1005.568l-382.336-143.36L82.816 42.688zM173.184 128l38.528 673.792L512 914.432l300.352-112.64L850.816 128H173.184zM241.92 213.312h540.16l-4.928 86.08-73.344-0.704H332.288l8.192 144h428.48l-17.28 302.336L512 834.88l-239.68-89.856-8.32-144.576h86.4l1.856 47.808 2.048 36.352L512 743.744l157.696-59.136 8.96-156.544H259.84L241.92 213.312z"></path>',bingtu:'<path d="M833.94381852 556.8110594l52.83235372 3.54705732C872.85335505 767.8750595 698.8453863 930.39551702 490.64030124 930.39551702 271.68857985 930.39551702 93.60448298 752.31142015 93.60448298 533.35969876c0-206.72333613 161.30236552-380.62496338 367.28482676-395.92406689l3.91705576 52.77962284C286.35227107 203.44992786 146.54317819 354.1647303 146.54317819 533.35969876c0 189.72980068 154.36732237 344.09800195 344.09712305 344.09800196 180.46579307 0 331.23332636-140.81538164 343.30351728-320.64664132zM940.61393581 480.36827268v26.46934717l-26.52207891 0.89994726h-396.08226122V83.33333333L544.53167458 83.38606419C762.95344714 83.86240413 940.61393581 261.99923187 940.61393581 480.36827268z m-53.67957012-25.56852099C875.13046755 286.9859512 739.97842555 150.77664739 570.94741198 137.43563187v317.36324091H886.93348679z" ></path>',tiaojiangeshi:'<path d="M816.544 64c15.584 0 28.416 11.84 29.952 27.04l0.16 3.072v438.848l77.76 199.264-168.448 218.336H138.592l-4.352-0.224a42.688 42.688 0 0 1-38.08-38.08l-0.224-4.352V94.144l0.16-3.104a30.144 30.144 0 0 1 26.88-26.88L126.048 64h690.496zM143.936 902.56h164.992v-157.696H143.936v157.696z m212.992-205.696h148.896v48h-148.896v157.696h375.456l137.44-178.176L801.92 550.4a48 48 0 0 1-3.296-17.44v-3.2h-198.208v68.544h-48v-68.544h-195.52v167.104z m-212.992 0h164.992v-167.104H143.936v167.104z m0-215.104h164.992V304H143.936v177.76z m212.992 0h195.52V304h-195.52v177.76z m243.52 0h198.208V304h-198.208v177.76zM143.936 251.2h654.72V112H143.936v139.2z" fill="currentColor" ></path><path d="M477.216 537.504c0-33.28 26.944-60.224 60.224-60.224h361.408c33.28 0 60.224 26.976 60.224 60.224v361.408c0 33.28-26.944 60.256-60.224 60.256H537.44a60.224 60.224 0 0 1-60.224-60.256V537.504z" fill="#36c" ></path><path d="M745.088 594.784a24 24 0 0 1 43.424 20.416l-9.504 20.192h68.48a24 24 0 0 1 0 48h-91.04l-32.768 69.664h123.808a24 24 0 0 1 0 48H701.12l-20.384 43.264a24 24 0 0 1-43.424-20.416l10.72-22.848h-59.2a24 24 0 0 1 0-48h81.76l32.8-69.664h-114.56a24 24 0 0 1 0-48h137.12l19.136-40.64z" fill="#fff" ></path>',component:'<path d="M56.88888853 284.4444448a182.0444448 182.0444448 0 0 1 182.0444448-182.0444448h546.13333334a182.0444448 182.0444448 0 1 1 0 364.08888853H238.93333333a182.0444448 182.0444448 0 0 1-182.0444448-182.04444373z m68.26666667 0a113.77777813 113.77777813 0 1 0 227.55555627 0 113.77777813 113.77777813 0 0 0-227.55555627 0z m295.82222293 0c0 43.05351147-14.9504 82.60266667-39.936 113.77777707H785.06666667a113.77777813 113.77777813 0 0 0 0-227.5555552H381.04177813A181.2707552 181.2707552 0 0 1 420.97777813 284.4444448zM56.88888853 739.5555552a182.0444448 182.0444448 0 0 1 182.0444448-182.04444373h546.13333334a182.0444448 182.0444448 0 1 1 0 364.08888853H238.93333333a182.0444448 182.0444448 0 0 1-182.0444448-182.0444448z m728.17777814-113.77777707a113.77777813 113.77777813 0 1 0 0 227.5555552 113.77777813 113.77777813 0 0 0 0-227.5555552z m-142.1084448 227.5555552A181.2707552 181.2707552 0 0 1 603.02222187 739.5555552c0-43.05351147 14.9504-82.60266667 39.936-113.77777707H238.93333333a113.77777813 113.77777813 0 0 0 0 227.5555552h404.02488854z" ></path>',qingchugeshi1:'<path d="M416.42666667 908.8c-81.92 0-157.01333333-34.13333333-211.62666667-95.57333334l-116.05333333-116.05333333c-13.65333333-13.65333333-27.30666667-40.96-27.30666667-61.44s6.82666667-47.78666667 27.30666667-61.44l450.56-464.21333333c34.13333333-34.13333333 88.74666667-34.13333333 122.88 0l259.41333333 273.06666666c34.13333333 34.13333333 34.13333333 88.74666667 0 122.88l-293.54666667 307.2c-54.61333333 61.44-129.70666667 95.57333333-211.62666666 95.57333334z m184.32-750.93333334s-6.82666667 0-13.65333334 6.82666667L143.36 622.08c-6.82666667 6.82666667-6.82666667 13.65333333-6.82666667 13.65333333s0 6.82666667 6.82666667 13.65333333l116.05333333 116.05333334c40.96 47.78666667 102.4 75.09333333 163.84 75.09333333 61.44 0 122.88-27.30666667 163.84-68.26666667L873.81333333 465.06666666c6.82666667-6.82666667 6.82666667-20.48 0-27.30666666l-259.41333333-273.06666667c0-6.82666667-6.82666667-6.82666667-13.65333333-6.82666667z" fill="currentColor" ></path><path d="M282.0096 419.87413333l49.69813333-46.83093333 342.016 362.496-49.69813333 46.83093333zM921.6 908.8H375.46666667c-20.48 0-34.13333333-13.65333333-34.13333334-34.13333334s13.65333333-34.13333333 34.13333334-34.13333333h546.13333333c20.48 0 34.13333333 13.65333333 34.13333333 34.13333333s-13.65333333 34.13333333-34.13333333 34.13333334z" fill="currentColor" ></path>',wenzixuanzhuan:'<path d="M639.872 99.328l-87.04 87.04 88.384 88.448-54.336 54.336-115.584-115.648a38.4 38.4 0 0 1-4.032-49.536l4.032-4.736L585.6 44.992l54.336 54.336z" ></path><path d="M844.8 240.896c64.64 64.64 94.336 151.808 96 251.328v18.816l-76.8-1.344c1.6-88.32-21.504-162.432-73.536-214.464-52.096-52.16-123.136-77.76-198.016-72.192l-15.04 1.536-86.656 2.688-2.432-76.8 82.88-2.368a325.888 325.888 0 0 1 273.6 92.8zM536.96 384c19.392 0 35.52 14.4 38.528 33.28l0.512 6.4v134.272H497.92l-0.064-94.528H142.08v94.528H64V423.744c0-19.776 14.144-36.16 32.704-39.232l6.4-0.512H536.96z" ></path><path d="M320 384c19.392 0 35.52 14.4 38.528 33.28l0.512 6.4v496.64c0 21.888-17.472 39.68-39.04 39.68a39.296 39.296 0 0 1-38.528-33.28l-0.512-6.4V423.68c0-21.888 17.472-39.68 39.04-39.68z" ></path><path d="M428.48 880.576V960h-216.96v-79.424z" ></path>',textWrap:'<path d="M657.63555555 781.93777778h72.81777778a121.36296334 121.36296334 0 1 0 0-242.72592554H75.09333333v-97.09037114h655.36a218.45333333 218.45333333 0 1 1 0 436.90666667H657.63555555v97.09037113l-194.18074112-145.63555556 194.18074112-145.63555555v97.09036999zM75.09333333 102.30518557h873.81333334v97.09036999H75.09333333V102.30518557z m291.27111112 679.63259221v97.09036999H75.09333333v-97.09036999h291.27111112z" ></path>',clear:'<path d="M1011.43552 981.92384l-68.4032-394.40384h23.10144c18.5856 0 33.54624-14.97088 33.54624-33.55648V306.16576c0-18.5856-14.97088-33.55648-33.54624-33.55648H648.6528V37.71392c0-18.5856-14.97088-33.55648-33.55648-33.55648H408.59648c-18.5856 0-33.55648 14.97088-33.55648 33.55648v234.88512H57.5488c-18.5856 0-33.54624 14.97088-33.54624 33.55648v247.79776c0 18.5856 14.97088 33.55648 33.54624 33.55648h23.10144L12.24704 981.9136c-0.38912 1.9456-0.512 3.87072-0.512 5.6832 0 18.5856 14.97088 33.54624 33.55648 33.54624h933.10976c1.93536 0 3.88096-0.12288 5.6832-0.512 18.31936-3.08224 30.57664-20.51072 27.35104-38.7072zM114.33984 362.94656h351.03744V94.50496h92.928v268.4416h351.03744v134.22592H114.33984V362.94656zM718.336 930.816V729.48736c0-5.6832-4.64896-10.33216-10.32192-10.33216h-61.952c-5.67296 0-10.32192 4.64896-10.32192 10.33216V930.816H387.9424V729.48736c0-5.6832-4.64896-10.33216-10.32192-10.33216h-61.952c-5.67296 0-10.32192 4.64896-10.32192 10.33216V930.816H112.78336l58.20416-335.55456h681.5744L910.76608 930.816H718.336z m0 0" fill="currentColor" ></path>',plus:'<path d="M97.96266667 467.28533333h828.07466666a44.71466667 44.71466667 0 0 1 0 89.42933334H97.96266667a44.71466667 44.71466667 0 1 1 0-89.42933334z" ></path><path d="M467.28533333 926.03733333V97.96266667a44.71466667 44.71466667 0 0 1 89.42933334 0v828.07466666a44.71466667 44.71466667 0 1 1-89.42933334 0z" ></path>',minus:'<path d="M125.36456912 567.23363335h773.27086176a55.12316522 55.12316522 0 0 0 51.03587683-76.38811433A55.06793246 55.06793246 0 0 0 898.63543088 456.76636665H125.36456912a55.12316522 55.12316522 0 0 0-45.89914897 85.94353368A55.0126984 55.0126984 0 0 0 125.36456912 567.23363335z" ></path>',fullscreen:'<path d="M136.53333333 68.33493333l204.8 0.2048a34.13333333 34.13333333 0 0 1 0 68.26666667l-204.8-0.2048V341.33333333a34.13333333 34.13333333 0 0 1-68.26666666 0V68.26666667h68.26666666z m0 887.33013334V955.73333333H68.26666667V682.66666667a34.13333333 34.13333333 0 1 1 68.26666666 0v204.73173333l204.8-0.2048a34.13333333 34.13333333 0 1 1 0 68.26666667zM887.46666667 68.33493333V68.26666667h68.26666666v273.06666666a34.13333333 34.13333333 0 1 1-68.26666666 0V136.6016l-204.8 0.2048a34.13333333 34.13333333 0 1 1 0-68.26666667z m0 887.33013334l-204.8-0.2048a34.13333333 34.13333333 0 0 1 0-68.26666667l204.8 0.2048V682.66666667a34.13333333 34.13333333 0 1 1 68.26666666 0v273.06666666h-68.26666666z" ></path>',xiaochuangbofang:'<path d="M921.6 102.4a45.51111147 45.51111147 0 0 1 45.51111147 45.51111147v318.57777706h-91.02222294V193.42222187H147.91111147v637.15555626h273.06666666v91.02222187H102.4a45.51111147 45.51111147 0 0 1-45.51111147-45.51111147V147.91111147a45.51111147 45.51111147 0 0 1 45.51111147-45.51111147h819.2z m0 455.11111147a45.51111147 45.51111147 0 0 1 45.51111147 45.5111104v273.06666666a45.51111147 45.51111147 0 0 1-45.51111147 45.51111147h-364.08888853a45.51111147 45.51111147 0 0 1-45.51111147-45.51111147v-273.06666666a45.51111147 45.51111147 0 0 1 45.51111147-45.5111104h364.08888853z m-45.51111147 91.02222186h-273.06666666v182.0444448h273.06666666v-182.0444448zM271.10968853 252.26808853l102.4 102.4L466.48888853 261.68888853V512H216.17777813l92.9792-92.9792-102.4-102.4 64.3527104-64.35271147z" ></path>',dongjie:'<path d="M951.90520135 72.09479865v879.8104027H72.09479865V72.09479865h879.8104027z m-62.8436006 471.32700091h-341.05221788V889.06160075H889.06160075v-345.63980119z m-403.8958185 43.80198979L183.32797085 889.06160075h301.8378114v-301.8378114z m-45.05886128-43.80198979H134.93839925v305.16852319l305.16852172-305.16852319zM889.06160075 183.39081494L591.87421526 480.57820044H889.06160075V183.39081494z m-403.8958185-0.18853079L185.96740206 480.57820044h299.19838019V183.20228415zM444.63166018 134.93839925H134.93839925v307.80795293L444.63166018 134.93839925z m403.95866257 0h-300.58093988v300.58093989L848.59032275 134.93839925z" fill="currentColor" ></path>',tubiao:'<path d="M304 682.666667H165.333333a37.373333 37.373333 0 0 0-37.333333 37.333333v224a37.373333 37.373333 0 0 0 37.333333 37.333333h138.666667a37.373333 37.373333 0 0 0 37.333333-37.333333v-224a37.373333 37.373333 0 0 0-37.333333-37.333333z m-5.333333 256H170.666667v-213.333334h128z m304-384H464a37.373333 37.373333 0 0 0-37.333333 37.333333v352a37.373333 37.373333 0 0 0 37.333333 37.333333h138.666667a37.373333 37.373333 0 0 0 37.333333-37.333333V592a37.373333 37.373333 0 0 0-37.333333-37.333333z m-5.333334 384H469.333333V597.333333h128z m304-554.666667h-138.666666a37.373333 37.373333 0 0 0-37.333334 37.333333v522.666667a37.373333 37.373333 0 0 0 37.333334 37.333333h138.666666a37.373333 37.373333 0 0 0 37.333334-37.333333V421.333333a37.373333 37.373333 0 0 0-37.333334-37.333333z m-5.333333 554.666667h-128V426.666667h128z m42.666667-874.666667v128a21.333333 21.333333 0 0 1-42.666667 0V115.5L633.753333 377.753333a21.333333 21.333333 0 0 1-30.173333 0L490.666667 264.833333 164.42 591.086667a21.333333 21.333333 0 0 1-30.173333-30.173334l341.333333-341.333333a21.333333 21.333333 0 0 1 30.173333 0L618.666667 332.5 865.833333 85.333333H789.333333a21.333333 21.333333 0 0 1 0-42.666666h128a21.213333 21.213333 0 0 1 14.993334 6.16l0.046666 0.046666A21.213333 21.213333 0 0 1 938.666667 64z" fill="currentColor" ></path>',qingchugeshi:'<path d="M936.1 899.8H90.2C74.6 899.8 62 912.4 62 928s12.6 28.2 28.2 28.2h845.9c15.6 0 28.2-12.6 28.2-28.2s-12.6-28.2-28.2-28.2zM271.7 822.6h241.2l19.8-8.1 423.2-415.6v-40.2L653.8 62h-39.5L70.4 596v40.2l181.5 178.3 19.8 8.1z m362.3-701l261.8 257.1L570.9 698 309 440.8l325-319.2zM268.8 480.3l261.9 257.2-29.2 28.7H283.2l-152.7-150 138.3-135.9z" ></path>',gongshi:'<path d="M423.472 480.08l-249.12-315.632h252.672s88.944-7.104 120.976 39.008 42.704 117.04 42.704 117.04h32.032l-14.224-216.352H0v31.92l313.136 383.024L0 884.384v35.472h622.736l39.152-241.184-32.032-7.088s-10.672 53.2-53.376 102.848c-42.704 49.664-209.968 42.56-209.968 42.56H142.336l281.136-336.912zM833.568 512.976l-10.4-27.408c-7.6-19.36-11.728-29.84-12.4-31.408l-16.08-35.744c-11.408-25.6-22.352-38.432-32.864-38.432-15.888 0-28.4 14.832-37.552 44.448-6.72-2.448-10.08-6.016-10.08-10.704 0-13.792 8.048-29.616 24.08-47.424 16.096-17.824 30.528-26.72 43.264-26.72 24.976 0 50.832 35.856 77.68 107.584l6.848 17.68 7.728-12.336c47.616-75.28 87.728-112.928 120.352-112.928 8.496 0 18.448 2.448 29.856 7.344l-40.608 42.432c-5.376-1.552-9.184-2.336-11.424-2.336-24.576 0-53.92 28.192-87.904 84.544l-9.712 16.24 7.664 20.512c29.408 80.88 53.568 121.312 72.704 121.312 17.536 0 30.896-12.496 40.112-37.424 6.256 4.016 9.376 8.128 9.376 12.368 0 11.152-8.928 24.512-26.816 40.096-17.888 15.584-33.28 23.408-46.272 23.408-25.936 0-52.416-36.432-79.456-109.264l-9.392-24.752-9.712 17.072c-45.6 77.968-89.2 116.944-130.784 116.944-15.632 0-28.928-3.888-39.888-11.6l38.88-37.872c6.72 6.688 14.544 10.016 23.488 10.016 25.232 0 53.664-25.472 85.152-76.416l17.44-28.128 6.72-11.104z" ></path>',alignTop:'<path d="M75.09333333 75.09333333h873.81333334v97.09037H75.09333333V75.09333333z m242.72592555 388.3614811v485.45185224H220.72888889V463.45481443H75.09333333l194.18074112-194.18073998 194.18073998 194.18073998H317.81925888z m485.45185223 0v485.45185224h-97.09036999V463.45481443h-145.63555555l194.18073998-194.18073998 194.18074112 194.18073998h-145.63555556z" ></path>',alignBottom:'<path d="M75.09333333 851.81629667h873.81333334v97.09037H75.09333333v-97.09037z m242.72592555-291.2711111h145.63555555l-194.18073998 194.18073998-194.18074112-194.18073998h145.63555556V75.09333333h97.09036999v485.45185224z m485.45185223 0h145.63555556l-194.18074112 194.18073998-194.18073998-194.18073998h145.63555555V75.09333333h97.09036999v485.45185224z" ></path>',alignVertically:'<path d="M75.09333333 463.45481443h873.81333334v97.09037114H75.09333333v-97.09037114z m728.17777778 339.81629668v145.63555556h-97.09036999v-145.63555556h-145.63555555l194.18073998-194.18074112 194.18074112 194.18074112h-145.63555556zM317.81925888 803.27111111v145.63555556H220.72888889v-145.63555556H75.09333333l194.18074112-194.18074112 194.18073998 194.18074112H317.81925888zM803.27111111 220.72888889h145.63555556l-194.18074112 194.18074112-194.18073998-194.18074112h145.63555555V75.09333333h97.09036999v145.63555556zM317.81925888 220.72888889h145.63555555l-194.18073998 194.18074112-194.18074112-194.18074112h145.63555556V75.09333333h97.09036999v145.63555556z" ></path>',bold:'<path d="M317.81925888 463.45481443h218.45333333a121.36296334 121.36296334 0 1 0 0-242.72592554H317.81925888v242.72592554z m485.45185223 218.45333334a218.45333333 218.45333333 0 0 1-218.45333333 218.45333333H220.72888889V123.6385189h315.54370332a218.45333333 218.45333333 0 0 1 158.06312334 369.23467776A218.35624334 218.35624334 0 0 1 803.27111111 681.90814777zM317.81925888 560.54518557v242.72592554h266.9985189a121.36296334 121.36296334 0 1 0 0-242.72592554H317.81925888z" ></path>',fontColor:'<path d="M669.57767111 609.09036999H354.42232889l-77.67229668 194.18074112H172.18370333l291.2711111-728.17777778h97.09037114l291.2711111 728.17777778h-104.56632888l-77.67229668-194.18074112z m-38.83614777-97.09036999L512 215.14619221 393.25847666 512h237.48304668zM75.09333333 900.3614811h873.81333334v97.09037113H75.09333333v-97.09037113z" ></path>',italic:'<path d="M667.34459259 926.25224651H253.09234608v-103.56306133h151.56454044l109.56971971-621.37837036H356.65540741V97.74775349h414.25224651v103.56306133h-151.56454044l-109.56971971 621.37837036H667.34459259z" ></path>',strikethrough:'<path d="M762.20188445 609.09036999c11.16539221 25.04931555 16.79663445 52.91425223 16.79663445 83.4977189 0 65.1476389-25.43767666 116.12008334-76.26448669 152.77169778C651.81013333 882.0114011 581.56524999 900.3614811 491.90229333 900.3614811c-79.61410333 0-158.40293888-18.49571555-236.41505223-55.53569109V735.30785223c73.7886811 42.57412779 149.27644445 63.88546333 226.51183445 63.88546332 123.83876779 0 185.92805888-35.53507555 186.36496555-106.65377222a107.28485888 107.28485888 0 0 0-31.45728-77.8179311l-5.82542222-5.67978666H75.09333333v-97.09037114h873.81333334v97.09037114h-186.70478222z m-197.96726557-145.63555556H299.80899555a198.35562667 198.35562667 0 0 1-23.35023445-25.34058666C255.4872411 411.02601443 245.0014811 378.30656 245.0014811 339.76168334c0-60.00184889 22.62205667-111.0228389 67.81762447-153.06296889C358.11176334 144.65858333 428.06537443 123.6385189 522.77703111 123.6385189c71.40996779 0 139.76158777 15.92282112 204.95777223 47.76846222v104.46923776c-58.25422222-33.35054222-122.09114112-50.00154112-191.55930112-50.00153998-120.39205888 0-180.53954333 37.96233443-180.53954332 113.88700444 0 20.38897778 10.58284999 38.15651555 31.74855111 53.35115776 21.16570112 15.19464334 47.28300999 27.28239445 78.30338332 36.40888889 30.09801443 8.73813333 62.96310557 20.09770667 98.54672555 33.93308444z" ></path>',underline:'<path d="M317.81925888 75.09333333v436.90666667a194.18074112 194.18074112 0 1 0 388.36148224 0V75.09333333h97.09036999v436.90666667a291.27111111 291.27111111 0 1 1-582.54222222 0V75.09333333h97.09036999zM123.6385189 900.3614811h776.7229622v97.09037113H123.6385189v-97.09037113z" ></path>',licai:'<path d="M512 710.4c-29.867 0-57.6-10.667-78.933-32l-85.334-85.333c-21.333-21.334-32-49.067-32-78.934 0-29.866 10.667-57.6 32-78.933l85.334-85.333c21.333-21.334 49.066-32 78.933-32 29.867 0 57.6 10.666 78.933 32l85.334 85.333c21.333 21.333 32 49.067 32 78.933 0 29.867-10.667 57.6-32 78.934L590.933 678.4c-21.333 19.2-49.066 32-78.933 32z m0-332.8c-12.8 0-25.6 4.267-34.133 14.933l-85.334 85.334C384 486.4 377.6 499.2 377.6 512c0 12.8 4.267 25.6 14.933 34.133l85.334 85.334c17.066 17.066 49.066 17.066 68.266 0l85.334-85.334C640 537.6 646.4 524.8 646.4 512c0-12.8-4.267-25.6-14.933-34.133l-85.334-85.334C537.6 384 524.8 377.6 512 377.6z" fill="#36c" ></path><path d="M512 979.2C253.867 979.2 44.8 770.133 44.8 512S253.867 44.8 512 44.8 979.2 253.867 979.2 512 770.133 979.2 512 979.2z m0-870.4c-221.867 0-403.2 181.333-403.2 403.2S290.133 915.2 512 915.2 915.2 733.867 915.2 512 733.867 108.8 512 108.8z" fill="currentColor" ></path>',alignCenter:'<path d="M75.09333333 170.66666667h873.81333334v97.09036999H75.09333333v-97.09036999z m97.09037 292.54222221h679.63259334v97.09037113H172.18370333v-97.09037113z m-97.09037 292.54222223h873.81333334v97.09037H75.09333333v-97.09037z" ></path>',alignJustify:'<path d="M75.09333333 102.30518557h873.81333334v97.09036999H75.09333333V102.30518557z m0 728.17777777h873.81333334v97.09037H75.09333333v-97.09037z m0-242.72592668h873.81333334v97.09037113H75.09333333v-97.09037113z m0-242.72592554h873.81333334v97.09036998H75.09333333V345.03111112z" ></path>',alignLeft:'<path d="M75 170h874v97H75V170z m0 293h680v97H75V463z m0 294h874v97H75V757z" ></path>',alignRight:'<path d="M75 170h874v97H75V170z m194 293h680v97H269V463z m-194 294h874v97H75V757z" ></path>',indentIncrease:'<path d="M75 170h874v97H75V170z m388 293h486v97H463V463z m-388 294h874v97H75V757z m194-242l-194 170V345l194 170z" ></path>',indentDecrease:'<path d="M75 170h874v97H75V170z m388 293h486v97H463V463z m-388 294h874v97H75V757z m194-242L75 345v340l194-170z" ></path>',xingzhuang:'<path d="M620.606061 0a62.060606 62.060606 0 0 1 62.060606 62.060606v188.943515C874.945939 273.997576 1024 437.651394 1024 636.121212c0 214.217697-173.661091 387.878788-387.878788 387.878788-198.469818 0-362.123636-149.054061-385.117091-341.333333H62.060606a62.060606 62.060606 0 0 1-62.060606-62.060606V62.060606a62.060606 62.060606 0 0 1 62.060606-62.060606h558.545455z m62.060606 297.937455V620.606061a62.060606 62.060606 0 0 1-62.060606 62.060606H297.937455C320.636121 849.159758 463.39103 977.454545 636.121212 977.454545c188.509091 0 341.333333-152.824242 341.333333-341.333333 0-172.730182-128.294788-315.485091-294.787878-338.183757zM620.606061 46.545455H62.060606a15.515152 15.515152 0 0 0-15.406545 13.699878L46.545455 62.060606v558.545455a15.515152 15.515152 0 0 0 13.699878 15.406545L62.060606 636.121212h186.181818c0-214.217697 173.661091-387.878788 387.878788-387.878788V62.060606a15.515152 15.515152 0 0 0-13.699879-15.406545L620.606061 46.545455z m15.515151 248.242424c-188.509091 0-341.333333 152.824242-341.333333 341.333333h325.818182a15.515152 15.515152 0 0 0 15.406545-13.699879L636.121212 620.606061V294.787879z" ></path>',beijingtupian:'<path d="M694.0444448 821.4755552H184.32c-69.17688853 0-127.43111147-58.25422187-127.43111147-127.4311104V184.32c0-69.17688853 58.25422187-127.43111147 127.43111147-127.43111147h509.7244448c69.17688853 0 127.43111147 58.25422187 127.4311104 127.43111147v509.7244448c0 69.17688853-58.25422187 127.43111147-127.4311104 127.4311104zM184.32 93.29777813C133.3475552 93.29777813 93.29777813 133.3475552 93.29777813 184.32v509.7244448c0 50.9724448 40.04977813 91.02222187 91.02222187 91.02222187h509.7244448c50.9724448 0 91.02222187-40.04977813 91.02222187-91.02222187V184.32c0-50.9724448-40.04977813-91.02222187-91.02222187-91.02222187H184.32z" ></path><path d="M839.68 967.11111147H329.9555552c-69.17688853 0-127.43111147-58.25422187-127.4311104-127.43111147h36.40888853c0 50.9724448 40.04977813 91.02222187 91.02222187 91.02222187h509.7244448c50.9724448 0 91.02222187-40.04977813 91.02222187-91.02222187V329.9555552c0-50.9724448-40.04977813-91.02222187-91.02222187-91.02222187v-36.40888853c69.17688853 0 127.43111147 58.25422187 127.43111147 127.4311104v509.7244448c0 69.17688853-58.25422187 127.43111147-127.43111147 127.43111147z" ></path>',dayinyulan1:'<path d="M878.153143 228.498286V100.790857H154.185143v127.707429H68.900571v457.874285h1.024v8.045715h84.114286v198.217143h0.292572V908.434286h723.821714V694.564571h84.992V228.352h-84.992zM193.682286 140.288h644.827428v88.210286H193.682286V140.288z m0 728.795429V480.109714h644.973714v388.973715H193.682286z m729.965714-214.016h-45.494857V440.612571H154.185143v214.454858H108.544V267.995429h815.104v387.072z" fill="currentColor" ></path><path d="M154.185143 312.027429h39.497143v39.497142h-39.497143zM239.030857 312.027429h39.497143v39.497142h-39.497143zM239.323429 569.197714h553.837714v39.497143H239.323429zM239.177143 740.790857h553.837714v39.497143H239.177143z" fill="currentColor" ></path>',dayinbiaotihuobiaotou:'<path d="M836.224 128H190.464C155.946667 128 128 155.946667 128 190.464v645.674667c0 34.474667 27.946667 62.421333 62.464 62.421333h645.674667c34.474667 0 62.421333-27.946667 62.421333-62.421333V190.421333A62.293333 62.293333 0 0 0 836.224 128zM190.464 183.04h645.632c4.138667 0 7.424 3.370667 7.424 7.424v155.818667H183.04V190.464c0-4.053333 3.370667-7.424 7.424-7.424z m645.76 660.565333H190.464a7.381333 7.381333 0 0 1-7.424-7.381333V401.322667h660.565333V836.266667a7.466667 7.466667 0 0 1-7.381333 7.381333z"></path>',fangxiang:'<path d="M409.002667 63.99999967a42.666667 42.666667 0 0 1 30.165333 12.501334l145.664 145.664a42.666667 42.666667 0 0 1 12.501333 30.165333V362.66666667h-42.666666V255.99999967h-96a53.333333 53.333333 0 0 1-53.077334-47.872L405.333333 202.66666667V106.66666667H128v512h128v42.666667H128a42.666667 42.666667 0 0 1-42.666667-42.666667V106.66666667a42.666667 42.666667 0 0 1 42.666667-42.666667h281.002667z m38.997333 81.706667V202.66666667a10.666667 10.666667 0 0 0 8.234667 10.368l2.432 0.298667h57.002666L448 145.70666667z" fill="currentColor" ></path><path d="M938.666667 771.66933367a42.666667 42.666667 0 0 1-12.501334 30.165333l-145.664 145.664a42.666667 42.666667 0 0 1-30.165333 12.501333H384a42.666667 42.666667 0 0 1-42.666667-42.666666V490.66666667a42.666667 42.666667 0 0 1 42.666667-42.666667h512a42.666667 42.666667 0 0 1 42.666667 42.666667v281.002667zM896 490.66666667H384v426.666667h362.666667v-96c0-27.605333 20.992-50.346667 47.872-53.077334l5.461333-0.256H896V490.66666667z m-106.666667 387.669333l67.626667-67.669333H800a10.666667 10.666667 0 0 0-10.368 8.234667l-0.298667 2.432v57.002666z" fill="currentColor" ></path><path d="M256 618.66666667h21.333333a21.333333 21.333333 0 1 1 0 42.666667H256v-42.666667zM597.333333 362.66666667v21.333333a21.333333 21.333333 0 1 1-42.666666 0V362.66666667h42.666666z" fill="currentColor" ></path><path d="M670.208 63.99999967L768 141.39733367v99.754666L821.290667 191.99999967l32.042666 29.568L746.666667 319.99999967 640 221.56799967 672.042667 191.99999967l50.773333 46.805334V159.10399967L640 93.52533367 670.208 63.99999967z" fill="#36c" ></path>',yemeiyejiao_01:'<path d="M883.2 200.533333l-102.4-102.4c-8.533333-8.533333-17.066667-12.8-29.866667-12.8H213.333333c-25.6 0-42.666667 17.066667-42.666666 42.666667v768c0 25.6 17.066667 42.666667 42.666666 42.666667h640c25.6 0 42.666667-17.066667 42.666667-42.666667V230.4c0-12.8-4.266667-21.333333-12.8-29.866667zM853.333333 896H213.333333V128h537.6L853.333333 230.4V896z" fill="currentColor" ></path><path d="M298.666667 256h469.333333v51.2H298.666667zM298.666667 725.333333h256v51.2H298.666667zM789.333333 640l4.266667-25.6h-34.133333l8.533333-55.466667h-29.866667l-8.533333 55.466667H682.666667l8.533333-55.466667h-29.866667l-8.533333 55.466667h-38.4l-4.266667 25.6h38.4l-12.8 85.333333h-29.866666l-8.533334 29.866667h34.133334l-12.8 55.466667h29.866666l8.533334-55.466667h46.933333l-4.266667 55.466667h29.866667l8.533333-55.466667h38.4l4.266667-25.6h-38.4l12.8-85.333333h34.133333z m-76.8 85.333333h-46.933333l12.8-85.333333H725.333333l-12.8 85.333333z" fill="currentColor" ></path>',suofang:'<path d="M123.09333333 165.44L268.48 310.82666667 310.08 269.12 312.10666667 267.2 168.96 123.94666667 317.65333333 123.94666667 317.65333333 62.18666667 61.33333333 62.18666667 61.33333333 316.8 123.09333333 316.8Z" ></path><path d="M309.86666667 754.66666667L268.16 712.96 266.24 710.93333333 123.09333333 854.08 123.09333333 705.49333333 61.33333333 705.49333333 61.33333333 961.81333333 315.84 961.81333333 315.84 900.05333333 164.48 900.05333333Z" ></path><path d="M706.34666667 62.18666667L706.34666667 123.94666667 855.04 123.94666667 713.81333333 265.17333333 711.89333333 267.2 753.6 308.90666667 755.52 310.72 900.90666667 165.44 900.90666667 316.8 962.66666667 316.8 962.66666667 62.18666667Z" ></path><path d="M900.90666667 854.18666667L757.65333333 711.04 715.94666667 752.74666667 714.13333333 754.66666667 859.41333333 900.05333333 708.05333333 900.05333333 708.05333333 961.81333333 962.66666667 961.81333333 962.66666667 705.49333333 900.90666667 705.49333333Z" ></path><path d="M512 276.37333333c-129.92 0-235.62666667 105.70666667-235.62666667 235.52S382.08 747.52 512 747.52 747.62666667 641.92 747.62666667 512 641.92 276.37333333 512 276.37333333zM685.86666667 512c0 95.89333333-77.97333333 173.86666667-173.86666667 173.86666667s-173.86666667-77.97333333-173.86666667-173.86666667c0-95.89333333 77.97333333-173.86666667 173.86666667-173.86666667S685.86666667 416.10666667 685.86666667 512z" ></path>',yby:'<path d="M53.894737 0h107.789474v1024H53.894737z"></path><path d="M862.315789 0h107.789474v1024h-107.789474z"></path><path d="M431.157895 269.473684h161.68421v161.684211H431.157895z"></path><path d="M431.157895 646.736842h161.68421v161.684211H431.157895z"></path>',biaoge:'<path d="M959.825022 384.002258V191.939717C959.825022 121.2479 902.517291 63.940169 831.825474 63.940169H191.939717C121.2479 63.940169 63.940169 121.2479 63.940169 191.939717v639.885757C63.940169 902.517291 121.2479 959.825022 191.939717 959.825022h639.885757c70.691817 0 127.999548-57.307731 127.999548-127.999548V384.002258zM146.66502 146.66502a63.737872 63.737872 0 0 1 45.336109-18.784682h639.997742A63.961844 63.961844 0 0 1 895.884854 192.001129V320.062089H127.880338V192.001129A63.737872 63.737872 0 0 1 146.66502 146.66502z m269.1267 461.308451v-223.971213h192.181751v223.971213h-192.181751z m192.181751 63.940169v223.971214h-192.181751v-223.971214h192.181751z m-256.12192-63.940169H127.880338v-223.971213h223.971213v223.971213z m-205.186531 269.235073a63.466939 63.466939 0 0 1-18.784682-45.209673V671.91364h223.971213v223.971214H192.001129a63.625887 63.625887 0 0 1-45.336109-18.67631z m749.219834-45.209673A63.763159 63.763159 0 0 1 831.998871 895.884854H671.91364v-223.971214h223.971214v160.085231z m0-224.0254h-223.971214v-223.971213h223.971214v223.971213z" ></path>',chazhao:'<path d="M1011.626842 928.757493l-251.866439-251.866439-3.935413-3.935413c55.095783-70.837436 86.579088-157.416524 86.579089-255.801852C842.404079 188.899829 653.50425 0 421.314876 0 189.125503 0 0.225674 188.899829 0.225674 421.089202c0 232.189373 188.899829 421.089202 421.089202 421.089203 94.449915 0 184.964416-31.483305 255.801852-86.579088l3.935413 3.935413 251.866439 251.866438c19.677066 19.677066 51.16037 15.741652 74.772849-7.870826 19.677066-23.612479 19.677066-55.095783 3.935413-74.772849M47.450631 421.089202c0-204.641482 169.222764-373.864245 373.864245-373.864245s373.864245 169.222764 373.864245 373.864245c0 102.320741-39.354131 192.835242-106.256153 259.737265l-3.935414 3.935414-3.935413 3.935413c-66.902023 66.902023-157.416524 106.256154-259.737265 106.256154-208.576895 0-373.864245-169.222764-373.864245-373.864246" fill="currentColor" ></path>',x_jiequ:'<path d="M841.3 225.3H96c-17.7 0-32-14.3-32-32s14.3-32 32-32h745.3c17.7 0 32 14.3 32 32s-14.4 32-32 32zM928.3 865.2H183c-17.7 0-32-14.3-32-32s14.3-32 32-32h745.3c17.7 0 32 14.3 32 32s-14.4 32-32 32z" ></path><path d="M183 763.3c-17.7 0-32-14.3-32-32V95.6c0-17.7 14.3-32 32-32s32 14.3 32 32v635.7c0 17.7-14.3 32-32 32zM833.2 958.8c-17.7 0-32-14.3-32-32V291.1c0-17.7 14.3-32 32-32s32 14.3 32 32v635.7c0 17.7-14.4 32-32 32zM381.9 457.3c-51.6 0-93.6-42-93.6-93.6s42-93.6 93.6-93.6 93.6 42 93.6 93.6-42 93.6-93.6 93.6z m0-123.1c-16.3 0-29.6 13.3-29.6 29.6s13.3 29.6 29.6 29.6 29.6-13.3 29.6-29.6-13.3-29.6-29.6-29.6zM740 766.3H320.6c-9.7 0-18.8-4.4-24.9-11.9-6.1-7.5-8.4-17.4-6.4-26.8 14.5-67.7 31.3-117.3 51.3-151.5 20.6-35.3 45.4-54.9 73.9-58.3 20.4-2.5 51 2.8 84.3 39.7 3.2-7.8 6.8-15.7 10.8-23.6 13.7-27 29.5-48.1 47.1-62.8 25-20.8 54.1-29 84.1-23.6 30.5 5.5 56.4 26.5 76.9 62.4 14 24.5 25.8 56.6 35.1 95.4 15.3 63.8 19 124.6 19.2 127.2 0.5 8.8-2.6 17.4-8.7 23.8s-14.5 10-23.3 10z m-379-64h343.8c-2.6-22.1-7.1-52.4-14.5-82.8-15.5-64.2-38.3-105-60.9-109-50-9-82.8 97-88.9 125.9-2.8 13.4-13.8 23.5-27.4 25.2-13.6 1.7-26.7-5.5-32.7-17.8-0.1-0.1-9.5-19.4-23.9-37.1-16-19.9-28.6-26.1-34.5-25.3-2.7 0.3-12.4 3.2-26.3 27.1-12.4 21.5-24.1 53-34.7 93.8z" ></path>',bingtuXianxing:'<path d="M512 64C264.8 64 64 264.8 64 512s200.8 448 448 448 448-200.8 448-448S759.2 64 512 64z m311.2 223.2L576 451.2V133.6c100.8 16.8 188.8 73.6 247.2 153.6zM512 896c-212 0-384-172-384-384s172-384 384-384v442.4l344-228.8c25.6 51.2 40 108.8 40 170.4 0 212-172 384-384 384z" ></path>',tubiaoZhuzhuangtu:'<path d="M163.84 880.64h122.88v-737.28h-122.88v737.28z m-40.96-778.24h204.8v819.2h-204.8v-819.2z m286.72 204.8h204.8v614.4h-204.8v-614.4z m40.96 573.44h122.88v-532.48h-122.88v532.48z m245.76-368.64h204.8v409.6h-204.8v-409.6z m40.96 368.64h122.88v-327.68h-122.88v327.68z" fill="currentColor" ></path>',fenlie:'<path d="M118.784 162.47466667v174.76266666h786.432v-174.76266666h-786.432z m-43.69066667-43.69066667h873.81333334v262.144h-873.81333334v-262.144z m364.81706667 356.07893333l72.0896 72.0896 72.0896-72.0896c8.73813333-8.73813333 21.84533333-8.73813333 30.58346667 0 8.73813333 8.73813333 8.73813333 21.84533333 0 30.58346667l-102.67306667 102.67306667-102.67306667-102.67306667c-8.73813333-8.73813333-8.73813333-21.84533333 0-30.58346667 8.73813333-8.73813333 21.84533333-8.73813333 30.58346667 0z m-364.81706667 168.20906667h393.216v262.144h-393.216v-262.144z m480.59733334 0h393.216v262.144h-393.216v-262.144z m-436.90666667 218.45333333h305.83466667v-174.76266666h-305.83466667v174.76266666z m480.59733333 0h305.83466667v-174.76266666h-305.83466667v174.76266666z" fill="currentColor" ></path>',luojiti:'<path d="M678.3 847.3V775H494.5c-18.2 0-33.2-14.9-33.2-33.2V505.6H343.9v73.6c0 18.3-14.9 33.2-33.2 33.2H97.1c-18.2 0-33.2-14.9-33.2-33.2V365.6c0-18.3 14.9-33.2 33.2-33.2h213.6c18.2 0 33.2 14.9 33.2 33.2v73.6h117.4V203c0-18.2 14.9-33.2 33.2-33.2h183.8V97.6c0-18.3 14.9-33.2 33.2-33.2h213.6c18.2 0 33.2 14.9 33.2 33.2v213.6c0 18.3-14.9 33.2-33.2 33.2H711.4c-18.2 0-33.2-14.9-33.2-33.2v-75H527.7v472.4h150.6v-75c0-18.3 14.9-33.2 33.2-33.2h213.6c18.2 0 33.2 14.9 33.2 33.2v213.6c0 18.3-14.9 33.2-33.2 33.2H711.4c-18.2 0-33.1-14.9-33.1-33.1zM130.2 398.8V546h147.3V398.8H130.2z m614.4-268.1V278h147.3V130.7H744.6z m0 536.1v147.3h147.3V666.8H744.6z m0 0" ></path>',wenbenkuang:'<path d="M341.333333 460.8V341.333333h341.333334v119.466667h-51.2c0-29.866667-21.333333-51.2-51.2-51.2h-17.066667v170.666667c0 29.866667 21.333333 51.2 51.2 51.2V682.666667H409.6v-51.2c29.866667 0 51.2-21.333333 51.2-51.2v-170.666667h-17.066667c-29.866667 0-51.2 21.333333-51.2 51.2H341.333333zM128 213.333333c-46.933333 0-85.333333-38.4-85.333333-85.333333s38.4-85.333333 85.333333-85.333333 85.333333 38.4 85.333333 85.333333-38.4 85.333333-85.333333 85.333333z m0 768c-46.933333 0-85.333333-38.4-85.333333-85.333333s38.4-85.333333 85.333333-85.333333 85.333333 38.4 85.333333 85.333333-38.4 85.333333-85.333333 85.333333zM896 213.333333c-46.933333 0-85.333333-38.4-85.333333-85.333333s38.4-85.333333 85.333333-85.333333 85.333333 38.4 85.333333 85.333333-38.4 85.333333-85.333333 85.333333z m0 768c-46.933333 0-85.333333-38.4-85.333333-85.333333s38.4-85.333333 85.333333-85.333333 85.333333 38.4 85.333333 85.333333-38.4 85.333333-85.333333 85.333333zM128 938.666667c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667-42.666667 17.066667-42.666667 42.666667 17.066667 42.666667 42.666667 42.666667zM896 170.666667c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667-42.666667 17.066667-42.666667 42.666667 17.066667 42.666667 42.666667 42.666667z m0 768c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667-42.666667 17.066667-42.666667 42.666667 17.066667 42.666667 42.666667 42.666667zM128 170.666667c25.6 0 42.666667-17.066667 42.666667-42.666667s-17.066667-42.666667-42.666667-42.666667-42.666667 17.066667-42.666667 42.666667 17.066667 42.666667 42.666667 42.666667z m170.666667-85.333334h170.666666v42.666667H298.666667V85.333333z m256 0h170.666666v42.666667h-170.666666V85.333333z m384 213.333334v170.666666h-42.666667V298.666667h42.666667z m0 256v170.666666h-42.666667v-170.666666h42.666667zM128 298.666667v170.666666H85.333333V298.666667h42.666667z m0 256v170.666666H85.333333v-170.666666h42.666667z m170.666667 341.333333h170.666666v42.666667H298.666667v-42.666667z m256 0h170.666666v42.666667h-170.666666v-42.666667z" fill="currentColor" ></path>',xianshi:'<path d="M512 224a508.48 508.48 0 0 1 444.16 272.64 32 32 0 0 1 0 32A508.48 508.48 0 0 1 512 800 508.48 508.48 0 0 1 67.84 527.36a32 32 0 0 1 0-32A508.48 508.48 0 0 1 512 224z m0 64a442.24 442.24 0 0 0-379.2 224A442.24 442.24 0 0 0 512 736a442.24 442.24 0 0 0 379.2-224A442.24 442.24 0 0 0 512 288z" ></path><path d="M640 512a128 128 0 1 1-128-128 128 128 0 0 1 128 128" ></path>',paixu:'<g transform="translate(512 0) scale(0.92 1) translate(-512 0)"><path d="M356.12444445 951.18222222c-22.528 0-40.96-18.432-40.96-40.96V113.77777778c0-22.528 18.432-40.96 40.96-40.96s40.96 18.432 40.96 40.96v796.44444444c0 22.528-18.432 40.96-40.96 40.96z" fill="currentColor" ></path><path d="M382.52088889 941.62488889c-17.29422222 14.44977778-43.23555555 12.17422222-57.68533334-5.00622222L84.87822222 650.69511111c-14.44977778-17.29422222-12.17422222-43.23555555 5.00622223-57.68533333 17.29422222-14.44977778 43.23555555-12.17422222 57.68533333 5.00622222l239.84355555 285.92355555c14.56355555 17.29422222 12.288 43.23555555-4.89244444 57.68533334zM667.87555555 72.81777778c22.528 0 40.96 18.432 40.96 40.96v796.44444444c0 22.528-18.432 40.96-40.96 40.96s-40.96-18.432-40.96-40.96V113.77777778c0-22.528 18.432-40.96 40.96-40.96z" fill="currentColor" ></path><path d="M641.47911111 82.37511111c17.29422222-14.44977778 43.23555555-12.17422222 57.68533334 5.00622222l239.84355555 285.92355556c14.44977778 17.29422222 12.17422222 43.23555555-5.00622222 57.68533333-17.29422222 14.44977778-43.23555555 12.17422222-57.68533333-5.00622222L636.47288889 140.06044445c-14.44977778-17.29422222-12.17422222-43.23555555 5.00622222-57.68533334z" fill="currentColor" ></path></g>',caiwu:'<path d="M512 64C264.8 64 64 264.8 64 512s200.8 448 448 448 448-200.8 448-448S759.2 64 512 64z m0 832c-212 0-384-172-384-384s172-384 384-384 384 172 384 384-172 384-384 384z m36-448H704v64H544.8v64H704v64H544.8v193.6h-64V640H320v-64h160.8v-64H320v-64h157.6L332 302.4l45.6-45.6 136 136 136-136 45.6 45.6L548 448z"></path>',chaxun:'<path d="M896 64H128c-35.296 0-64 28.704-64 64v768c0 35.296 28.704 64 64 64h592a32 32 0 1 0 0-64H128V128h768v592a32 32 0 1 0 64 0V128c0-35.296-28.704-64-64-64z" ></path><path d="M791.744 746.496A206.752 206.752 0 0 0 832 624c0-114.688-93.312-208-208-208S416 509.312 416 624s93.312 208 208 208a206.752 206.752 0 0 0 122.496-40.256l110.88 110.88a31.904 31.904 0 0 0 45.248 0 31.968 31.968 0 0 0 0-45.248l-110.88-110.88zM480 624c0-79.392 64.608-144 144-144s144 64.608 144 144-64.608 144-144 144-144-64.608-144-144zM800 264a32 32 0 0 0-32-32H256a32 32 0 0 0 0 64h512a32 32 0 0 0 32-32zM256 422.656a32 32 0 0 0 0 64h96a32 32 0 0 0 0-64H256z" ></path>',shaixuan:'<path d="M522.184 1024a39.123 39.123 0 0 1-19.4-5.173l-215.34-149.38a40.093 40.093 0 0 1-17.137-32.334V366.986L10.023 41.712l8.407-21.664A35.567 35.567 0 0 1 50.763 0.002h751.105l20.37 38.476-13.257 19.077-249.29 309.43v617.892A39.123 39.123 0 0 1 520.568 1024zM333.357 823.856L495.024 937.67V344.352L721.358 64.668H111.227l222.13 279.684zM74.69 16.815z" ></path><path d="M722.975 452.669h258.667q32.333 0 32.333 32.333 0 32.334-32.333 32.334H722.975q-32.334 0-32.334-32.334 0-32.333 32.334-32.333zM722.975 630.503h258.667q32.333 0 32.333 32.333t-32.333 32.333H722.975q-32.334 0-32.334-32.333t32.334-32.333zM722.975 808.336h258.667q32.333 0 32.333 32.334 0 32.333-32.333 32.333H722.975q-32.334 0-32.334-32.333 0-32.334 32.334-32.334z" ></path>',zhuizong:'<path d="M1012.064 486.981H948.75c-2.808-50.166-14.041-98.928-33.699-145.137-22.083-52.081-53.612-98.8-93.694-139.009-40.209-40.209-86.929-71.739-139.009-93.694-46.209-19.53-94.971-30.891-145.137-33.699V12.001H487.173v63.314c-50.166 2.808-98.928 14.169-145.137 33.699-52.081 22.083-98.8 53.612-139.009 93.694s-71.994 86.929-94.077 139.009c-19.53 46.209-30.891 94.971-33.699 145.137H11.936v50.166h63.441c2.808 50.166 14.169 98.928 33.699 145.137 22.083 52.081 53.612 98.8 93.694 139.009 40.209 40.209 86.929 71.739 139.009 93.694 46.209 19.53 94.971 30.891 145.137 33.699V1012H536.954v-63.441c50.166-2.808 98.928-14.041 145.137-33.699 52.081-22.083 98.8-53.612 139.009-93.694 40.209-40.209 71.739-86.929 93.694-139.01 19.53-46.209 30.891-94.971 33.699-145.137h63.314v-50.038h0.257z m-134.67 0H768.765c-5.744-59.484-31.657-114.629-74.419-157.391s-97.907-68.675-157.391-74.419V146.542c182.155 12.382 328.058 158.412 340.439 340.439zM511.936 719.812c-114.629 0-207.812-93.184-207.812-207.812s93.184-207.812 207.812-207.812S719.748 397.371 719.748 512s-93.183 207.812-207.812 207.812z m-25.019-573.27v108.629c-59.484 5.744-114.629 31.657-157.391 74.419s-68.675 97.907-74.292 157.391H146.478C158.86 304.954 304.89 158.924 486.917 146.542zM146.478 537.147h108.629c5.744 59.484 31.657 114.629 74.419 157.391 42.762 42.762 97.907 68.675 157.391 74.419v108.629C304.89 865.076 158.86 719.174 146.478 537.147z m390.605 340.311V768.829c59.484-5.744 114.629-31.657 157.391-74.419 42.762-42.762 68.675-97.907 74.419-157.391h108.501C865.013 719.174 719.11 865.076 537.083 877.458zM427.816 512" ></path>',Pi:'<path d="M842.666667 981.333333H181.333333a53.393333 53.393333 0 0 1-53.333333-53.333333V96a53.393333 53.393333 0 0 1 53.333333-53.333333h466.746667a52.986667 52.986667 0 0 1 37.713333 15.62l194.586667 194.586666a52.986667 52.986667 0 0 1 15.62 37.713334V928a53.393333 53.393333 0 0 1-53.333333 53.333333zM181.333333 85.333333a10.666667 10.666667 0 0 0-10.666666 10.666667v832a10.666667 10.666667 0 0 0 10.666666 10.666667h661.333334a10.666667 10.666667 0 0 0 10.666666-10.666667V298.666667h-160a53.393333 53.393333 0 0 1-53.333333-53.333334V85.333333z m501.333334 30.166667V245.333333a10.666667 10.666667 0 0 0 10.666666 10.666667h129.833334z m21.333333 652.5H320a21.333333 21.333333 0 0 1 0-42.666667h384a21.333333 21.333333 0 0 1 0 42.666667z m0-213.333333H320a21.333333 21.333333 0 0 1 0-42.666667h384a21.333333 21.333333 0 0 1 0 42.666667zM490.666667 298.666667H320a21.333333 21.333333 0 0 1 0-42.666667h170.666667a21.333333 21.333333 0 0 1 0 42.666667z" fill="currentColor" ></path>',Vi:'<path d="M128 373.333333V64a21.333333 21.333333 0 0 1 42.666667 0v309.333333a10.666667 10.666667 0 0 0 10.666666 10.666667h661.333334a10.666667 10.666667 0 0 0 10.666666-10.666667V64a21.333333 21.333333 0 0 1 42.666667 0v309.333333a53.393333 53.393333 0 0 1-53.333333 53.333334H181.333333a53.393333 53.393333 0 0 1-53.333333-53.333334z m714.666667 266.666667H181.333333a53.393333 53.393333 0 0 0-53.333333 53.333333v266.666667a21.333333 21.333333 0 0 0 42.666667 0v-266.666667a10.666667 10.666667 0 0 1 10.666666-10.666666h661.333334a10.666667 10.666667 0 0 1 10.666666 10.666666v266.666667a21.333333 21.333333 0 0 0 42.666667 0v-266.666667a53.393333 53.393333 0 0 0-53.333333-53.333333zM490.666667 512a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 0-42.666667z m128 0a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 0-42.666667z m128 0a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 0-42.666667z m-576 21.333333a21.333333 21.333333 0 0 0-21.333334-21.333333h-42.666666a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 21.333334-21.333334z m746.666666-21.333333h-42.666666a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 0-42.666667z m-554.666666 0a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 0-42.666667z m-128 0a21.333333 21.333333 0 0 0 0 42.666667h42.666666a21.333333 21.333333 0 0 0 0-42.666667z" fill="currentColor" ></path>',chaolianjie:'<path d="M611.2 368l-294.4 294.4c-6.4 6.4-9.6 16-9.6 22.4s3.2 16 9.6 22.4 16 9.6 22.4 9.6 16-3.2 22.4-9.6l294.4-294.4c6.4-6.4 9.6-16 9.6-22.4s-3.2-16-9.6-22.4c-12.8-12.8-32-12.8-44.8 0z" ></path><path d="M608 755.2l-99.2 99.2c-96 96-249.6 96-342.4 3.2-92.8-92.8-92.8-246.4 3.2-342.4L268.8 416c12.8-12.8 12.8-32 0-44.8s-32-12.8-44.8 0l-99.2 99.2C3.2 592 3.2 784 121.6 902.4 179.2 960 259.2 992 336 992c80 0 156.8-28.8 217.6-89.6l99.2-99.2c12.8-12.8 12.8-32 0-44.8s-32-16-44.8-3.2zM902.4 121.6c-57.6-57.6-131.2-86.4-214.4-86.4h-3.2c-83.2 0-160 35.2-217.6 92.8l-96 96c-12.8 12.8-12.8 32 0 44.8s32 12.8 44.8 0l96-96c48-48 108.8-73.6 172.8-73.6h3.2c64 0 121.6 25.6 166.4 70.4 92.8 92.8 92.8 246.4-3.2 345.6l-96 96c-12.8 12.8-12.8 32 0 44.8 6.4 6.4 16 9.6 22.4 9.6s16-3.2 22.4-9.6l96-96c121.6-124.8 124.8-320 6.4-438.4z" ></path>',zhexiantu:'<path d="M797.064 768c1.932 0.188 3.889 0.29 5.87 0.29 1.982 0 3.939-0.29 5.871-0.29h-11.741z m66.07-59.71c0-1.284-0.134-2.554-0.134-3.818v7.636c0-1.264 0.134-2.535 0.134-3.818z m-582.994 60c1.981 0 3.938-0.102 5.87-0.29h-11.74c1.932 0.188 3.889 0.29 5.87 0.29z" ></path><path d="M930 900H124V94c0-16.568-13.432-30-30-30S64 77.432 64 94v806c0 33.137 26.863 60 60 60h806c16.568 0 30-13.432 30-30s-13.432-30-30-30z" ></path><path d="M188.917 780.801a29.882 29.882 0 0 0 19.859 7.524c8.298 0 16.559-3.424 22.487-10.13l218.903-247.604 148.85 156.498 304.199-402.478c9.99-13.218 7.374-32.032-5.844-42.022-13.218-9.99-32.033-7.374-42.021 5.844L593.774 594.518 448.551 441.833 186.312 738.455c-10.975 12.413-9.808 31.372 2.605 42.346z" ></path>',dayinyulan:'<path d="M786.9996875 291.9996875H737V184.6503125c0-22.3003125-2.2996875-30.350625-6.7003125-38.5003125a45.45 45.45 0 0 0-18.9-18.9c-8.1496875-4.3996875-16.2-6.7003125-38.499375-6.7003125H351.0996875c-22.299375 0-30.3496875 2.300625-38.499375 6.7003125a45.45 45.45 0 0 0-18.9 18.9c-4.400625 8.1496875-6.7003125 16.2-6.7003125 38.5003125v107.349375h-49.9996875v-93.3c0-44.5996875 4.65-60.75 13.35-76.9996875 8.7-16.35 21.4996875-29.1496875 37.8-37.8496875 16.35-8.7 32.499375-13.35 76.9996875-13.35h293.6503125c44.5996875 0 60.75 4.65 76.9996875 13.35 16.35 8.7 29.1496875 21.4996875 37.8496875 37.8 8.7 16.299375 13.35 32.499375 13.35 76.9996875v93.4003125z m-300 150v50.000625h-150A49.9996875 49.9996875 0 0 0 287 542v300a49.9996875 49.9996875 0 0 0 49.9996875 49.9996875h150v50.000625h-150A100.0003125 100.0003125 0 0 1 237.0003125 842V542a100.0003125 100.0003125 0 0 1 99.999375-100.0003125h150z" ></path><path d="M936.9996875 492.0003125H887v-150a49.9996875 49.9996875 0 0 0-49.9996875-50.000625H186.9996875A49.9996875 49.9996875 0 0 0 137 342.0003125V542a49.9996875 49.9996875 0 0 0 49.9996875 49.9996875h50.000625v50.000625h-50.000625A100.0003125 100.0003125 0 0 1 87.0003125 542V342.0003125A100.0003125 100.0003125 0 0 1 186.9996875 242h650.000625a100.0003125 100.0003125 0 0 1 99.999375 100.0003125v150zM676.7 517.7496875c-143.1496875 0-255.4003125 78.4003125-255.4003125 178.700625s112.250625 178.65 255.4003125 178.65c143.1496875 0 255.4003125-78.350625 255.4003125-178.0003125S819.8496875 517.7496875 676.7 517.7496875z m0 307.2c-111.6 0-205.5496875-58.749375-205.5496875-128.499375S565.1496875 567.95 676.7 567.95c111.6 0 204.2503125 58.3996875 204.2503125 129.15 0 70.7503125-93 127.8496875-204.2503125 127.8496875z" ></path><path d="M676.7 604.4496875a91.65 91.65 0 1 0-0.6496875 183.3 91.65 91.65 0 0 0 0.6496875-183.3z m0 132.8503125a41.85 41.85 0 1 1 41.5003125-40.2 41.85 41.85 0 0 1-41.5003125 40.8496875v-0.6496875zM711.9996875 342.05H812q25.0003125 0 25.0003125 25.0003125 0 24.999375-25.0003125 24.999375H711.9996875q-24.999375 0-24.999375-24.999375 0-25.0003125 24.999375-25.0003125z" ></path>',tupian:'<path d="M831.99999969 992H192.00000031c-89.59999969 0-160.00000031-70.39999969-160.00000031-160.00000031V192.00000031c0-89.59999969 70.39999969-160.00000031 160.00000031-160.00000031h639.99999938c89.59999969 0 160.00000031 70.39999969 160.00000031 160.00000031v639.99999938c0 89.59999969-70.39999969 160.00000031-160.00000031 160.00000031zM192.00000031 96.00000031C137.6 96.00000031 96.00000031 137.6 96.00000031 192.00000031v639.99999938c0 54.40000031 41.59999969 96 96 96h639.99999938c54.40000031 0 96-41.59999969 96-96V192.00000031c0-54.40000031-41.59999969-96-96-96H192.00000031z" fill="currentColor" ></path><path d="M332.79999969 361.59999969m-60.79999969 0a60.79999969 60.79999969 0 1 0 121.60000031 0 60.79999969 60.79999969 0 1 0-121.60000031 0Z" fill="currentColor" ></path><path d="M240.00000031 835.20000031l-57.6-25.60000031 12.79999969-28.8c67.2-156.79999969 175.99999969-236.80000031 319.99999969-246.40000031 121.60000031-6.40000031 211.2-41.59999969 265.60000031-105.6l22.39999969-25.59999938 48 41.59999969-22.39999969 25.60000031c-67.2 76.8-172.8 121.60000031-310.39999969 127.99999969-118.39999969 6.40000031-204.79999969 73.60000031-262.40000062 208.00000031l-15.99999938 28.8z" fill="currentColor" ></path>',huyan_:'<path d="M512 921.6c-206.4384 0-469.67466667-182.40853333-469.67466667-324.94933333 0-141.99466667 263.23626667-322.7648 469.67466667-322.7648 210.80746667 0 469.67466667 178.03946667 469.67466667 322.7648 0 68.26666667-58.9824 150.18666667-158.37866667 217.9072-97.21173333 67.1744-213.53813333 107.04213333-311.296 107.04213333z m0-582.17813333c-190.0544 0-404.13866667 167.66293333-404.13866667 257.2288C107.86133333 686.76266667 321.9456 856.064 512 856.064c85.1968 0 187.32373333-35.49866667 274.15893333-95.57333333 78.6432-54.0672 129.97973333-118.51093333 129.97973334-164.38613334 0-45.32906667-50.7904-109.22666667-129.4336-162.74773333-86.8352-58.43626667-189.50826667-93.93493333-274.70506667-93.93493333z" ></path><path d="M512 850.05653333" fill="#b0b2bd" ></path><path d="M512 746.2912c-84.65066667 0-153.46346667-68.8128-153.46346667-153.46346667S427.34933333 439.36426667 512 439.36426667s153.46346667 68.8128 153.46346667 153.46346666-68.8128 153.46346667-153.46346667 153.46346667z m0-241.39093333c-48.60586667 0-87.92746667 39.3216-87.92746667 87.92746666s39.3216 87.92746667 87.92746667 87.92746667c48.60586667 0 87.92746667-39.3216 87.92746667-87.92746667s-39.3216-87.92746667-87.92746667-87.92746666zM197.97333333 312.66133333c-9.28426667 0-18.56853333-3.82293333-25.12213333-11.4688l-42.05226667-49.152c-11.4688-13.65333333-9.8304-34.4064 3.82293334-46.42133333 13.65333333-11.4688 34.4064-9.8304 46.42133333 3.82293333l42.05226667 49.152c11.4688 13.65333333 9.8304 34.4064-3.82293334 46.42133334-6.5536 4.9152-14.19946667 7.64586667-21.2992 7.64586666zM826.5728 312.66133333c-7.64586667 0-15.29173333-2.73066667-21.2992-7.64586666-13.65333333-11.4688-15.29173333-32.22186667-3.82293333-46.42133334l42.05226666-49.152c11.4688-13.65333333 32.22186667-15.29173333 46.42133334-3.82293333 13.65333333 11.4688 15.29173333 32.22186667 3.82293333 46.42133333l-42.05226667 49.152c-6.5536 7.09973333-15.83786667 11.4688-25.12213333 11.4688zM512.54613333 226.37226667c-18.0224 0-32.22186667-14.19946667-32.768-32.22186667L478.68586667 129.70666667c0-18.0224 14.19946667-32.768 32.22186666-33.31413334 18.0224-0.54613333 32.768 14.19946667 33.31413334 32.22186667l1.09226666 64.44373333c0 18.0224-14.19946667 33.31413333-32.768 33.31413334z" ></path>',huatifuhao:'<path d="M651.424 217.066667a32 32 0 0 1 62.485333 13.866666L682.261333 373.333333H800a32 32 0 0 1 31.946667 30.122667L832 405.333333a32 32 0 0 1-32 32H668.032l-33.184 149.333334H800a32 32 0 0 1 31.946667 30.122666L832 618.666667a32 32 0 0 1-32 32H620.629333l-34.72 156.266666a32 32 0 0 1-36.341333 24.661334l-1.845333-0.352a32 32 0 0 1-24.298667-38.186667L555.061333 650.666667H407.296l-34.72 156.288a32 32 0 0 1-36.341333 24.64l-1.845334-0.341334a32 32 0 0 1-24.298666-38.186666L341.728 650.666667 224 650.666667a32 32 0 0 1-31.946667-30.122667L192 618.666667a32 32 0 0 1 32-32h131.957333l33.184-149.333334H224a32 32 0 0 1-31.946667-30.122666L192 405.333333a32 32 0 0 1 32-32h179.36l34.730667-156.266666a32 32 0 0 1 36.341333-24.661334l1.845333 0.352a32 32 0 0 1 24.298667 38.186667l-31.648 142.378667h147.765333zM602.474667 437.333333H454.698667l-33.184 149.333334h147.776l33.184-149.333334z" ></path>',Bi:'<path d="M768 0c70.4 0 128 57.6 128 128v185.6h-64V128c0-38.4-25.6-64-64-64H128c-32 0-57.6 25.6-64 57.6V832c0 32 25.6 57.6 57.6 64h416v64H128c-70.4 0-128-57.6-128-128V128C0 57.6 57.6 0 128 0h640zM384 448c19.2 0 32 12.8 32 32S403.2 512 384 512H160c-19.2 0-32-12.8-32-32s12.8-32 32-32H384z m0-128c19.2 0 32 12.8 32 32S403.2 384 384 384H160c-19.2 0-32-12.8-32-32s12.8-32 32-32H384z m0-128c19.2 0 32 12.8 32 32S403.2 256 384 256H160c-19.2 0-32-12.8-32-32s12.8-32 32-32H384z m307.2 512c0-12.8-6.4-32-12.8-38.4L531.2 486.4l-6.4-6.4V448c0-6.4 6.4-12.8 12.8-12.8h403.2c12.8 0 19.2 6.4 19.2 12.8v25.6c0 6.4 0 6.4-6.4 6.4l-140.8 179.2c-6.4 12.8-12.8 25.6-12.8 38.4v204.8c0 6.4-6.4 12.8-6.4 12.8l-102.4 51.2V704z m256-320H544c-38.4 0-64 32-64 64v25.6c0 12.8 6.4 32 12.8 38.4l140.8 179.2 6.4 6.4v275.2c0 12.8 6.4 32 19.2 38.4 12.8 6.4 32 6.4 44.8 0l108.8-57.6c19.2-12.8 38.4-32 38.4-57.6v-192c0-6.4 0-6.4 6.4-6.4l140.8-179.2c6.4-12.8 12.8-25.6 12.8-38.4V448c0-32-25.6-64-64-64z" fill="currentColor" ></path>',qiuhe:'<path d="M541.103 533.019l-247.377-374.03H660.75c74.375 0 137.432 49.584 189.71 148.75h12.396l-26.409-196.716h-675.84l295.882 422.535-295.882 380.497h675.84L862.855 716.8h-12.396c-49.583 79.764-106.173 119.646-169.23 119.646H293.187L541.103 533.02z" fill="currentColor" ></path>',jisuan:'<path d="M884.82702222 75.09333333H139.17297778a64.07964445 64.07964445 0 0 0-64.07964445 64.07964445v745.65404444a64.07964445 64.07964445 0 0 0 64.07964445 64.07964445h745.65404444a64.07964445 64.07964445 0 0 0 64.07964445-64.07964445V139.17297778a64.07964445 64.07964445 0 0 0-64.07964445-64.07964445z m5.82542223 809.73368889a6.40796445 6.40796445 0 0 1-5.82542223 5.82542223H139.17297778a6.40796445 6.40796445 0 0 1-5.82542223-5.82542223V139.17297778a6.40796445 6.40796445 0 0 1 5.82542223-5.82542223h745.65404444a6.40796445 6.40796445 0 0 1 5.82542223 5.82542223z" ></path><path d="M424.61866667 308.11022222h-58.25422222v-58.25422222a29.12711111 29.12711111 0 0 0-58.25422223 0v58.25422222h-58.25422222a29.12711111 29.12711111 0 0 0 0 58.25422223h58.25422222v58.25422222a29.12711111 29.12711111 0 0 0 58.25422223 0v-58.25422222h58.25422222a29.12711111 29.12711111 0 0 0 0-58.25422223zM774.144 308.11022222h-174.76266667a29.12711111 29.12711111 0 0 0 0 58.25422223h174.76266667a29.12711111 29.12711111 0 0 0 0-58.25422223zM774.144 618.60522667h-174.76266667a29.12711111 29.12711111 0 0 0-29.12711111 29.12711111 29.12711111 29.12711111 0 0 0 29.12711111 29.12711111h174.76266667a29.12711111 29.12711111 0 0 0 29.12711111-29.12711111 29.12711111 29.12711111 0 0 0-29.12711111-29.12711111zM774.144 723.46282667h-174.76266667a29.12711111 29.12711111 0 0 0-29.12711111 29.12711111 29.12711111 29.12711111 0 0 0 29.12711111 29.12711111h174.76266667a29.12711111 29.12711111 0 0 0 29.12711111-29.12711111 29.12711111 29.12711111 0 0 0-29.12711111-29.12711111zM432.19171555 605.20675555a29.70965333 29.70965333 0 0 0-41.36049777 0l-53.59388445 53.59388445-53.59388444-53.59388445a29.12711111 29.12711111 0 1 0-41.36049778 41.36049778l53.59388444 53.59388445-53.59388444 53.59388444a29.12711111 29.12711111 0 0 0 0 40.77795556 29.12711111 29.12711111 0 0 0 41.36049778 0l53.59388444-53.59388445 53.59388445 53.59388445a29.12711111 29.12711111 0 0 0 41.36049777 0 29.12711111 29.12711111 0 0 0 0-40.77795556l-53.59388444-53.59388444 53.59388444-53.59388445a29.70965333 29.70965333 0 0 0 0-41.36049778z" ></path>',dayinsuofang:'<path d="M718.762836 536.670051H563.831304c-12.777858 0-22.361252 9.583394-22.361253 22.361253v154.931532c-1.597232 12.777858 7.986161 22.361252 20.76402 23.958485s22.361252-7.986161 23.958485-20.76402v-135.764745h132.57028c12.777858 1.597232 22.361252-7.986161 23.958485-20.76402s-7.986161-22.361252-20.76402-23.958485h-3.194465z m0 440.836114h-100.625634l110.209028-110.209028c7.986161-7.986161 7.986161-22.361252 0-31.944646-7.986161-7.986161-22.361252-7.986161-31.944646 0l-110.209028 110.209028V846.533117c1.597232-12.777858-7.986161-22.361252-20.76402-23.958485s-22.361252 7.986161-23.958485 20.76402V1007.853579c1.597232 6.388929 6.388929 12.777858 12.777859 14.37509l3.194464 1.597233h159.72323c12.777858 1.597232 22.361252-7.986161 23.958484-20.76402s-7.986161-22.361252-20.764019-23.958485c0-1.597232-1.597232-1.597232-1.597233-1.597232zM1027.028669 559.031304v-4.791697c-1.597232-4.791697-3.194465-7.986161-6.388929-11.180626s-6.388929-4.791697-11.180626-6.38893H851.333117c-12.777858-1.597232-22.361252 7.986161-23.958485 20.76402s7.986161 22.361252 20.76402 23.958485h103.820099l-110.209028 110.209028c-7.986161 7.986161-7.986161 22.361252 0 31.944646 7.986161 7.986161 22.361252 7.986161 31.944646 0l110.209028-110.209028v100.625634c-1.597232 12.777858 7.986161 22.361252 20.76402 23.958485s22.361252-7.986161 23.958485-20.76402v-3.194465L1027.028669 559.031304z m-22.361252 265.140561c-12.777858 0-22.361252 9.583394-22.361252 22.361252v132.57028H851.333117c-12.777858-1.597232-22.361252 7.986161-23.958485 20.76402s7.986161 22.361252 20.76402 23.958485H1006.26465c12.777858 0 22.361252-9.583394 22.361252-22.361252V846.533117c-1.597232-12.777858-11.180626-22.361252-23.958485-22.361252z" ></path><path d="M498.344779 824.171865H39.939111V39.930807h549.447909v196.459573h196.459573v261.946096h39.930807V198.056805h-1.597232L629.317828 3.194465V0H0.008303v864.102672h496.739244l1.597232-39.930807z m130.973049-766.671502l140.556442 138.959209h-140.556442V57.500363z" ></path>',zhuizongqibeifen:'<path d="M184 840c66.272 0 120-53.728 120-120 0-66.272-53.728-120-120-120-66.272 0-120 53.728-120 120 0 66.272 53.728 120 120 120z m0-48a72 72 0 1 1 0-144 72 72 0 0 1 0 144z" ></path><path d="M211.248 599.304l0.504-298.44c0.112-68.96 56.048-124.8 125-124.8 68.904 0 124.752 55.864 124.752 124.76v413.52c0 91.304 74.024 165.328 165.336 165.328 91.312 0 165.336-74.024 165.336-165.336v-370.56a24 24 0 1 0-48 0v370.56c0 64.8-52.528 117.336-117.336 117.336-64.8 0-117.336-52.536-117.336-117.336V300.824c0-95.408-77.344-172.752-172.752-172.752-95.432 0-172.84 77.28-173 172.712l-0.504 298.44a24 24 0 0 0 48 0.08z" ></path><path d="M568 272m24 0l48 0q24 0 24 24l0 0q0 24-24 24l-48 0q-24 0-24-24l0 0q0-24 24-24Z" ></path><path d="M864 272m24 0l48 0q24 0 24 24l0 0q0 24-24 24l-48 0q-24 0-24-24l0 0q0-24 24-24Z" ></path><path d="M792 152m0 24l0 48q0 24-24 24l0 0q-24 0-24-24l0-48q0-24 24-24l0 0q24 0 24 24Z" ></path>',fenleihuizong:'<path d="M437.59964957 603.89118066h420.69257443V397.50132622h-420.69257443v206.38985444z m0 70.94393401v183.81148956c0 16.02961977 13.03923712 29.02516622 29.1271111 29.02516622h362.43835222c16.08787399 0 29.12711111-12.99554645 29.12711111-29.02516622v-183.81148956h-420.69257443z m0-348.27772246h420.69257443V155.64435911c0-16.02961977-13.03923712-29.02516622-29.12711111-29.02516622h-362.43835222c-16.08787399 0-29.12711111 12.99554645-29.1271111 29.02516622V326.55739221z m29.1271111-270.88213333h362.43835222C884.57944178 55.67525888 929.48859221 100.43392 929.48859221 155.64435911v703.00224512C929.48859221 913.85704334 884.57458688 958.61570333 829.16996779 958.61570333h-362.44320712c-55.40462023 0-100.31862557-44.75866112-100.31862556-99.9690991V155.64435911C366.40813511 100.43392 411.31728555 55.67525888 466.72676067 55.67525888zM289.78926933 732.88059221c17.87433757 0 32.36507534 14.43733845 32.36507534 32.2485669 0 17.81122845-14.49073778 32.2485669-32.36507534 32.2485669h-143.49956778c-17.86948267 0-32.36022045-14.43733845-32.36022045-32.2485669V235.8264411c0-17.80637355 14.49073778-32.243712 32.36022045-32.243712h143.49956778c17.87433757 0 32.36507534 14.43733845 32.36507534 32.243712 0 17.81608334-14.49073778 32.2485669-32.36507534 32.2485669H178.64992199V732.88059221h111.13934734z" fill="currentColor" ></path>',xuanxiang:'<path d="M384.31 162.15c8.82 0 16 7.18 16 16v224c0 8.82-7.18 16-16 16h-224c-8.82 0-16-7.18-16-16v-224c0-8.82 7.18-16 16-16h224m0-64h-224c-44.18 0-80 35.82-80 80v224c0 44.18 35.82 80 80 80h224c44.18 0 80-35.82 80-80v-224c0-44.18-35.82-80-80-80zM383.79 607.69c8.82 0 16 7.18 16 16v224c0 8.82-7.18 16-16 16h-224c-8.82 0-16-7.18-16-16v-224c0-8.82 7.18-16 16-16h224m0-64h-224c-44.18 0-80 35.82-80 80v224c0 44.18 35.82 80 80 80h224c44.18 0 80-35.82 80-80v-224c0-44.18-35.82-80-80-80zM860.1 608c8.82 0 16 7.18 16 16v224c0 8.82-7.18 16-16 16h-224c-8.82 0-16-7.18-16-16V624c0-8.82 7.18-16 16-16h224m0-64h-224c-44.18 0-80 35.82-80 80v224c0 44.18 35.82 80 80 80h224c44.18 0 80-35.82 80-80V624c0-44.18-35.82-80-80-80zM912.21 113H585.22c-17.67 0-32 14.33-32 32s14.33 32 32 32h326.99c17.67 0 32-14.33 32-32s-14.32-32-32-32zM912.21 404H585.22c-17.67 0-32 14.33-32 32s14.33 32 32 32h326.99c17.67 0 32-14.33 32-32s-14.32-32-32-32zM910.18 258.5H583.19c-17.67 0-32 14.33-32 32s14.33 32 32 32h326.99c17.67 0 32-14.33 32-32s-14.32-32-32-32z" ></path><path d="M717 822.41c-12.14 0-24.3-4.19-34.02-12.6l-0.85-0.73-41.6-41.39c-12.53-12.46-12.58-32.73-0.12-45.25 12.46-12.53 32.73-12.58 45.25-0.12l31.88 31.72 90.49-79.12c13.3-11.63 33.52-10.28 45.15 3.03 11.63 13.3 10.28 33.52-3.03 45.15l-98.91 86.48c-9.7 8.54-21.96 12.83-34.24 12.83z m-7.89-61c-0.02 0.02-0.04 0.03-0.05 0.05l0.05-0.05z" ></path>',hanglieqiehuan:'<path d="M192 320H64a64 64 0 0 0-64 64v576a64 64 0 0 0 64 64h128a64 64 0 0 0 64-64V384a64 64 0 0 0-64-64z m0 672V960H64V384h128v576zM960 0H384a64 64 0 0 0-64 64v128a64 64 0 0 0 64 64h576a64 64 0 0 0 64-64V64a64 64 0 0 0-64-64z m0 224V192H384V64h576v128zM128 0a128 128 0 1 0 128 128 128 128 0 0 0-128-128z m0 192a64 64 0 1 1 64-64 64 64 0 0 1-64 64z m784 134.4l-192 110.72a32 32 0 0 0 0 55.68l60.16 34.56a801.92 801.92 0 0 1-252.16 256l-37.76-64a33.28 33.28 0 0 0-55.68 0l-110.72 192a32 32 0 0 0 27.52 48H576a32 32 0 0 0 27.52-48l-40.96-71.68a865.92 865.92 0 0 0 275.84-280.96l76.8 44.16A32 32 0 0 0 960 576V354.56a32 32 0 0 0-48-27.52zM407.04 896l55.68-96 55.68 96zM896 520.32l-96-55.68L896 409.6z" fill="currentColor" ></path>',jiancha:'<path d="M358.4 580.266667a34.133333 34.133333 0 0 1 34.048 31.573333L392.533333 614.4v65.826133C392.533333 784.554667 480.733867 870.4 588.8 870.4c106.376533 0 193.501867-83.2 196.1984-185.2928l0.068267-4.881067a34.133333 34.133333 0 0 1 68.181333-2.56l0.085333 2.56C853.333333 822.6304 734.173867 938.666667 588.8 938.666667c-143.547733 0-261.546667-113.134933-264.482133-253.098667L324.266667 680.209067V614.4a34.133333 34.133333 0 0 1 34.133333-34.133333z" fill="currentColor" ></path><path d="M204.8 68.266667a34.133333 34.133333 0 0 1 2.56 68.181333L204.8 136.533333H136.533333v221.866667c0 121.941333 99.925333 221.866667 221.866667 221.866667 120.200533 0 218.999467-97.0752 221.7984-216.661334L580.266667 358.4V136.533333h-68.266667a34.133333 34.133333 0 0 1-2.56-68.181333L512 68.266667h68.266667a68.266667 68.266667 0 0 1 68.181333 64.853333L648.533333 136.533333v221.866667c0 159.658667-130.474667 290.133333-290.133333 290.133333-157.815467 0-287.1296-127.488-290.082133-284.637866L68.266667 358.4V136.533333a68.266667 68.266667 0 0 1 64.853333-68.181333L136.533333 68.266667h68.266667z" fill="currentColor" ></path><path d="M819.2 426.666667a136.533333 136.533333 0 1 0 0.034133 273.1008A136.533333 136.533333 0 0 0 819.2 426.666667z m0 68.266666a68.266667 68.266667 0 1 1-0.034133 136.567467A68.266667 68.266667 0 0 1 819.2 494.933333z" fill="currentColor" ></path>',sandiantu:'<path d="M64 85.333333a21.333333 21.333333 0 0 1 21.333333 21.333334V853.333333h917.333334a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 0 1-21.333333 21.333334H21.333333a21.333333 21.333333 0 0 1-21.333333-21.333334v-810.666666A21.333333 21.333333 0 0 1 21.333333 85.333333h42.666667z m426.666667 469.333334a64 64 0 1 1 0 128 64 64 0 0 1 0-128zM341.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z m320-85.333333a64 64 0 1 1 0 128 64 64 0 0 1 0-128zM810.666667 256a42.666667 42.666667 0 1 1 0 85.333333 42.666667 42.666667 0 0 1 0-85.333333z" ></path>',calendar:'<path d="M833 128c0-53-43-96-96-96h-16c-53 0-96 43-96 96H400c0-53-43-96-96-96h-16c-53 0-96 43-96 96H64c-35.3 0-64 28.7-64 64v736c0 35.3 28.7 64 64 64h896c35.3 0 64-28.7 64-64V192c0-35.3-28.7-64-64-64H833zM729 96c22.1 0 40 17.9 40 40v80c0 22.1-17.9 40-40 40s-40-17.9-40-40v-80c0-22.1 17.9-40 40-40z m-433 0c22.1 0 40 17.9 40 40v80c0 22.1-17.9 40-40 40s-40-17.9-40-40v-80c0-22.1 17.9-40 40-40z m632 832H96c-17.7 0-32-14.3-32-32V448h896v448c0 17.7-14.3 32-32 32z m32-544H64V224c0-17.7 14.3-32 32-32h96v32c0 53 43 96 96 96h16c53 0 96-43 96-96v-32h225v24c0 57.4 46.6 104 104 104s104-46.6 104-104v-24h95c17.7 0 32 14.3 32 32v160z" ></path>',ungroup:'<path d="M951.68 337.92H842.88a41.6 41.6 0 0 0 0 83.84h64.64a32.64 32.64 0 0 1 32.64 32.64v453.76a32.64 32.64 0 0 1-32.64 32.64H454.4a32.64 32.64 0 0 1-32.64-32.64v-59.52a40.96 40.96 0 0 0-81.92 0v103.68A72.32 72.32 0 0 0 410.24 1024h541.44A72.32 72.32 0 0 0 1024 951.68V410.24a72.32 72.32 0 0 0-72.32-72.32zM176 603.52h-59.52a32.64 32.64 0 0 1-33.28-33.92V116.48a32.64 32.64 0 0 1 32.64-32.64H569.6a32.64 32.64 0 0 1 32.64 32.64v58.88a41.6 41.6 0 0 0 83.2 0V72.32A72.32 72.32 0 0 0 613.76 0H72.32A72.32 72.32 0 0 0 0 72.32v541.44a72.32 72.32 0 0 0 72.32 72.32h103.68a40.96 40.96 0 0 0 0-81.28z" ></path><path d="M655.36 368.64a41.6 41.6 0 0 0-58.88 0L512 453.12 427.52 368.64a41.6 41.6 0 0 0-58.88 58.88L453.12 512 368.64 596.48a41.6 41.6 0 0 0 58.88 58.88L512 570.88l84.48 84.48a41.6 41.6 0 0 0 58.88-58.88L570.88 512l84.48-84.48a41.6 41.6 0 0 0 0-58.88z" ></path>',shuxue:'<path d="M832 832H386.24L832 386.24z m-291.2-64H768v-227.2zM200 672H64v-136L507.2 93.12a96 96 0 0 1 135.68 135.68zM128 608h45.44L597.76 183.68a32 32 0 0 0-45.44-45.12L128 562.56z" ></path><path d="M439.136 206.208l45.28-45.248 90.496 90.496-45.28 45.248zM1024 1024H0v-77.12L946.88 0H1024zM77.44 960H960V77.12z" ></path>',fenyeyulan:'<path d="M864 64h-704C108.8 64 64 108.8 64 160v704c0 51.2 44.8 96 96 96h704c51.2 0 96-44.8 96-96v-704c0-51.2-44.8-96-96-96z m-384 448H339.2V128h140.8v384z m-320-384h115.2v384H128V160c0-19.2 12.8-32 32-32zM896 864c0 19.2-12.8 32-32 32h-704c-19.2 0-32-12.8-32-32V576h416V128h320c19.2 0 32 12.8 32 32v704z" ></path>',yichu:'<path d="M512 938.666667a426.666667 426.666667 0 1 1 426.666667-426.666667 426.666667 426.666667 0 0 1-426.666667 426.666667z m0-789.333334a362.666667 362.666667 0 1 0 362.666667 362.666667A362.666667 362.666667 0 0 0 512 149.333333z" fill="currentColor" ></path><path d="M672 544h-320a32 32 0 0 1 0-64h320a32 32 0 0 1 0 64z" fill="currentColor" ></path>',xiangmushishi:'<path d="M760.896 94C862.574 94 945 176.426 945 278.104v517.792C945 897.574 862.574 980 760.896 980H243.104C141.426 980 59 897.574 59 795.896V278.104C59 176.426 141.426 94 243.104 94h517.792z m0 59.834H243.104c-67.946 0-123.156 54.53-124.254 122.215l-0.016 2.055v517.792c0 67.946 54.53 123.156 122.215 124.254l2.055 0.016h517.792c67.946 0 123.156-54.53 124.254-122.215l0.016-2.055V278.104c0-67.946-54.53-123.156-122.215-124.254l-2.055-0.016z m-448.753 407.33c53.38 0 96.654 43.273 96.654 96.654 0 53.381-43.273 96.655-96.654 96.655-53.381 0-96.655-43.274-96.655-96.655 0-53.38 43.274-96.654 96.655-96.654z m0 46.026c-27.962 0-50.629 22.667-50.629 50.628 0 27.962 22.667 50.629 50.629 50.629 27.961 0 50.628-22.667 50.628-50.629 0-27.961-22.667-50.628-50.628-50.628z m487.875 20.71c16.523 0 29.917 13.395 29.917 29.917 0 16.523-13.394 29.917-29.917 29.917h-266.95c-16.523 0-29.917-13.394-29.917-29.917 0-16.522 13.394-29.917 29.917-29.917h266.95zM425.23 305.114c0.088 0.092 0.174 0.185 0.26 0.279 8.617 9.398 8.108 23.968-1.143 32.742l-110.51 104.812c-9.052 8.585-23.35 8.206-31.935-0.845a22.589 22.589 0 0 1-1.249-1.43 22.966 22.966 0 0 1-3.245-2.7l-59.546-59.546c-8.937-8.936-8.937-23.425 0-32.362 8.936-8.936 23.425-8.936 32.362 0l48.192 48.192 94.88-89.987c9.052-8.585 23.35-8.207 31.934 0.845z m374.788 39.728c16.523 0 29.917 13.394 29.917 29.916 0 16.523-13.394 29.917-29.917 29.917h-266.95c-16.523 0-29.917-13.394-29.917-29.917 0-16.522 13.394-29.916 29.917-29.916h266.95z" fill="currentColor" ></path>',xianshibili:'<path d="M935.808 150.20032l-51.65056-51.65056a9.78944 9.78944 0 0 0-13.76768 0L98.432 870.272a9.78944 9.78944 0 0 0 0 13.76768l51.65056 51.65056a9.7792 9.7792 0 0 0 13.76256 0l771.84-771.84c3.90144-3.65568 3.90144-9.87136 0.12288-13.64992zM263.74144 439.15264c96.72192 0 175.41632-78.6944 175.41632-175.41632 0-96.72704-78.6944-175.42144-175.41632-175.42144-96.72704 0-175.42144 78.6944-175.42144 175.42144 0 96.72192 78.6944 175.41632 175.42144 175.41632z m0-263.12704c48.3584 0 87.7056 39.35232 87.7056 87.71072s-39.3472 87.7056-87.7056 87.7056c-48.36352 0-87.71072-39.3472-87.71072-87.7056-0.00512-48.3584 39.3472-87.71072 87.71072-87.71072z m506.76224 419.05664c-96.72704 0-175.42656 78.69952-175.42656 175.42656s78.69952 175.41632 175.42656 175.41632 175.41632-78.68928 175.41632-175.41632-78.68928-175.42656-175.41632-175.42656z m0 263.12704c-48.36352 0-87.71584-39.3472-87.71584-87.7056 0-48.36352 39.35232-87.71584 87.71584-87.71584 48.3584 0 87.7056 39.35232 87.7056 87.71584 0 48.36352-39.34208 87.7056-87.7056 87.7056z" fill="currentColor" ></path>',picimingcheng:'<path d="M134.50666667 125.76h552.85333333v245.65333333c0 14.72 11.94666667 26.66666667 26.66666667 26.66666667s26.66666667-11.94666667 26.66666666-26.66666667V124.69333333c0-28.90666667-23.36-52.26666667-52.26666666-52.26666666H133.44c-28.90666667 0-52.26666667 23.36-52.26666667 52.26666666v693.65333334c0 28.90666667 23.36 52.26666667 52.26666667 52.26666666H401.06666667c14.72 0 26.66666667-11.94666667 26.66666666-26.66666666s-11.94666667-26.66666667-26.66666666-26.66666667H134.50666667V125.76z" ></path><path d="M568.64 260.90666667c0-14.72-11.94666667-26.66666667-26.66666667-26.66666667H279.89333333c-14.72 0-26.66666667 11.94666667-26.66666666 26.66666667s11.94666667 26.66666667 26.66666666 26.66666666h262.08c14.72 0 26.66666667-11.94666667 26.66666667-26.66666666zM568.64 416.21333333c0-14.72-11.94666667-26.66666667-26.66666667-26.66666666H279.89333333c-14.72 0-26.66666667 11.94666667-26.66666666 26.66666666s11.94666667 26.66666667 26.66666666 26.66666667h262.08c14.72 0 26.66666667-11.94666667 26.66666667-26.66666667zM279.89333333 544.74666667c-14.72 0-26.66666667 11.94666667-26.66666666 26.66666666s11.94666667 26.66666667 26.66666666 26.66666667h106.88c14.72 0 26.66666667-11.94666667 26.66666667-26.66666667s-11.94666667-26.66666667-26.66666667-26.66666666H279.89333333zM879.57333333 546.45333333c-44.37333333-44.37333333-103.25333333-68.8-165.97333333-68.8s-121.70666667 24.42666667-165.97333333 68.8c-44.37333333 44.37333333-68.8 103.25333333-68.8 165.97333334s24.42666667 121.70666667 68.8 165.97333333C592 922.77333333 650.88 947.2 713.6 947.2s121.70666667-24.42666667 165.97333333-68.8C923.84 834.13333333 948.26666667 775.25333333 948.26666667 712.53333333s-24.42666667-121.70666667-68.69333334-166.08zM716.05333333 893.97333333c-102.08 1.38666667-185.38666667-81.92-184-184 1.28-96.21333333 82.66666667-177.6 178.88-178.88 102.08-1.38666667 185.38666667 81.92 184 184-1.28 96.10666667-82.66666667 177.49333333-178.88 178.88z" ></path><path d="M707.73333333 712.53333333m-26.66666666 0a26.66666667 26.66666667 0 1 0 53.33333333 0 26.66666667 26.66666667 0 1 0-53.33333333 0Z" ></path><path d="M619.30666667 712.53333333m-26.66666667 0a26.66666667 26.66666667 0 1 0 53.33333333 0 26.66666667 26.66666667 0 1 0-53.33333333 0Z" ></path><path d="M796.05333333 712.53333333m-26.66666666 0a26.66666667 26.66666667 0 1 0 53.33333333 0 26.66666667 26.66666667 0 1 0-53.33333333 0Z" ></path>',Hi:'<path d="M532.93511147 64.2048L179.76888853 365.94346666c-11.6963552 10.0124448-19.34222187 23.9388448-21.39022186 39.18506667l-43.69066667 320.58026667a62.71431147 62.71431147 0 0 0 65.62702187 71.0883552l323.85706666-17.74933334c15.88337813-0.91022187 30.81102187-7.73688853 41.82471147-19.20568853l339.968-353.98542187a62.75982187 62.75982187 0 0 0-2.54862187-88.74666666l-266.8316448-250.90275627a62.71431147 62.71431147 0 0 0-83.69493333-2.00248853z m40.27733333 64.4892448l249.35537707 234.47324373-327.45244374 340.9692448-303.78666666 16.65706667 40.96-300.78293334 340.92373333-291.31662186zM171.89546667 882.63111146l636.01777813 1.36533334a36.18133333 36.18133333 0 0 1 4.36906667 72.0896l-4.55111147 0.27306666-636.01777813-1.36533333a36.18133333 36.18133333 0 0 1-4.36906667-72.0896l4.55111147-0.27306667z" ></path>',zhuti_04:'<path d="M986.543158 252.766316c-32.875789-30.181053-141.204211-134.736842-152.791579-144.437895a94.315789 94.315789 0 0 0-61.44-31.528421 85.692632 85.692632 0 0 0-65.751579 26.947368l-75.722105 72.218948a248.724211 248.724211 0 0 1-118.837895 26.947368 250.071579 250.071579 0 0 1-118.837895-26.947368l-75.722105-71.949474a85.423158 85.423158 0 0 0-65.751579-26.947368A94.315789 94.315789 0 0 0 190.248421 107.789474c-11.587368 11.048421-119.915789 114.256842-152.791579 144.437894a71.410526 71.410526 0 0 0-24.791579 50.661053 84.345263 84.345263 0 0 0 22.63579 57.397895L134.736842 455.410526a69.254737 69.254737 0 0 0 77.069474 14.282106V835.368421A103.747368 103.747368 0 0 0 242.526316 912.168421a146.863158 146.863158 0 0 0 97.28 35.301053h344.117895A147.671579 147.671579 0 0 0 781.473684 912.168421 103.747368 103.747368 0 0 0 812.463158 835.368421V469.692632A69.254737 69.254737 0 0 0 889.263158 455.410526l100.513684-95.663158a85.692632 85.692632 0 0 0 21.288421-56.32 71.410526 71.410526 0 0 0-24.522105-50.661052z m-35.031579 68.985263l-99.43579 94.854737a16.976842 16.976842 0 0 1-21.557894 2.155789l-26.947369-26.947368a26.947368 26.947368 0 0 0-29.372631-5.928421 26.947368 26.947368 0 0 0-16.707369 24.791579V835.368421a50.122105 50.122105 0 0 1-14.012631 37.99579 94.046316 94.046316 0 0 1-63.056842 20.210526H341.423158a94.585263 94.585263 0 0 1-61.978947-20.210526A50.122105 50.122105 0 0 1 265.431579 835.368421V411.755789a26.947368 26.947368 0 0 0-46.08-18.863157l-26.947368 26.947368a16.976842 16.976842 0 0 1-21.827369-2.155789L73.835789 323.368421a19.671579 19.671579 0 0 1 0-30.72C107.789474 260.311579 223.393684 151.174737 228.244211 146.593684l2.425263-2.425263a41.229474 41.229474 0 0 1 24.252631-13.473684 33.684211 33.684211 0 0 1 25.061053 12.126316c48.505263 45.810526 78.416842 74.374737 78.416842 74.374736l3.772632 2.964211a291.301053 291.301053 0 0 0 147.941052 36.648421h3.772632a291.301053 291.301053 0 0 0 147.941052-36.648421l3.772632-2.964211s29.911579-26.947368 78.147368-74.374736a33.953684 33.953684 0 0 1 25.061053-12.126316 39.612632 39.612632 0 0 1 24.522105 13.473684l2.425263 2.425263c4.850526 4.581053 119.376842 113.717895 154.408422 146.054737a18.863158 18.863158 0 0 1 1.347368 29.103158z" ></path>',yanse:'<path d="M511.774217 90.313097c118.009114 0 216.149346 36.125239 300.090353 110.382674 81.984223 72.501347 121.872507 157.395659 121.872507 259.549807a197.986379 197.986379 0 0 1-62.014994 147.61174 204.207947 204.207947 0 0 1-149.518349 61.412906H627.174286a133.713558 133.713558 0 0 0-132.007644 132.960949c0 46.611593 19.266794 75.612132 35.422804 91.768141a18.162967 18.162967 0 0 1 6.673134 14.299574c0 11.088441-3.211132 15.854966-6.522612 19.166446a24.284188 24.284188 0 0 1-19.316968 6.723308c-118.410505 0-216.249694-40.139154-298.986526-123.026508s-122.976334-180.626194-122.976334-298.936351 40.139154-216.249694 122.976334-298.986526S393.21319 90.313097 511.774217 90.313097m0-79.776569c-139.031996 0-258.044588 49.019942-355.382037 146.307217S10.034789 373.344309 10.034789 512.376305s48.819246 258.044588 146.206869 355.632907 216.350042 146.106522 355.532559 146.106521a102.605713 102.605713 0 0 0 105.36528-105.666323 97.638493 97.638493 0 0 0-30.104365-70.544564c-7.927483-7.927483-12.09192-19.367142-12.091921-35.824195A54.037336 54.037336 0 0 1 627.174286 749.197315h94.67823a283.532951 283.532951 0 0 0 205.412122-84.292224A277.361556 277.361556 0 0 0 1013.513646 460.3961c0-124.933118-50.173943-231.954138-148.815915-319.306973s-216.149346-130.452251-352.923514-130.452251z" fill="currentColor" ></path><path d="M241.687883 512.376305m-77.61909 0a77.61909 77.61909 0 1 0 155.238179 0 77.61909 77.61909 0 1 0-155.238179 0Z" fill="currentColor" ></path><path d="M376.956833 287.647214m-77.61909 0a77.61909 77.61909 0 1 0 155.238179 0 77.61909 77.61909 0 1 0-155.238179 0Z" fill="currentColor" ></path><path d="M629.13107 261.907982m-77.61909 0a77.61909 77.61909 0 1 0 155.238179 0 77.61909 77.61909 0 1 0-155.238179 0Z" fill="currentColor" ></path><path d="M771.424372 478.157676m-77.61909 0a77.61909 77.61909 0 1 0 155.238179 0 77.61909 77.61909 0 1 0-155.238179 0Z" fill="currentColor" ></path>',shujuyanzheng:'<path d="M60.235294 120.470588h542.117647v60.235294H60.235294V120.470588z m0 0h60.235294v361.411765H60.235294V120.470588z m0 301.176471h542.117647v60.235294H60.235294V421.647059z m0 180.705882h542.117647v60.235294H60.235294v-60.235294z m0 0h60.235294v361.411765H60.235294v-361.411765z m0 301.176471h542.117647v60.235294H60.235294v-60.235294z m648.252235-301.176471l314.548706 316.29553-44.935529 45.116235-314.548706-316.29553z m269.613177 0l44.935529 45.176471L708.487529 963.764706l-44.935529-45.176471z m-254.373647-163.659294l246.061176-257.204706 53.669647 42.88753-246.121411 257.14447zM662.588235 346.714353l45.176471-44.935529 134.806588 134.806588-44.935529 44.935529z" fill="currentColor" ></path>',dongjiechuangge:'<path d="M360.658649 0H82.762951a36.603394 36.603394 0 0 0 0 73.121466h277.895698a8.020324 8.020324 0 0 1 7.337744 7.337743v862.952745a8.020324 8.020324 0 0 1-7.337744 7.337743H82.762951a36.603394 36.603394 0 1 0 0 73.121466h277.895698a80.459209 80.459209 0 0 0 80.459209-80.459209V80.459209A80.459209 80.459209 0 0 0 360.658649 0z m555.791397 950.749697h-278.151666a8.020324 8.020324 0 0 1-7.337744-7.337743V80.459209a8.020324 8.020324 0 0 1 7.337744-7.337743h277.895698a36.603394 36.603394 0 0 0 0-73.121466H638.29838a80.459209 80.459209 0 0 0-80.459209 80.459209v862.952745a80.459209 80.459209 0 0 0 80.459209 80.459209h277.895698a36.603394 36.603394 0 1 0 0-73.121466z" fill="currentColor" ></path><path d="M683.263388 511.935581a202.897135 202.897135 0 1 0 202.897136-202.897135A202.982458 202.982458 0 0 0 683.263388 511.935581z m38.053878 0a164.843257 164.843257 0 1 1 164.843258 164.92858A165.099225 165.099225 0 0 1 721.317266 511.935581z m86.602436-21.927907h157.676159a22.951779 22.951779 0 0 1 0 45.818235H807.919702a22.951779 22.951779 0 1 1 0-45.818235z" fill="#36c" ></path><path d="M104.264246 641.967219a27.303231 27.303231 0 0 0 19.453552 46.500815 27.047263 27.047263 0 0 0 18.344358-10.238711l145.048415-145.048415a27.559199 27.559199 0 0 0 0-37.79791l-145.048415-141.038253a27.047263 27.047263 0 0 0-37.79791 0 27.559199 27.559199 0 0 0 0 38.395169l99.486148 96.755824H27.303263a27.047263 27.047263 0 0 0 0 54.009204h176.447131z" fill="#36c" ></path>',shengchengshujutoushibiao:'<path d="M93.86666667 298.66666667V165.54666667a68.26666667 68.26666667 0 0 1 68.26666667-68.26666666h136.53333333v204.8h68.26666667v-204.8h204.8v204.8h68.26666667v-204.8h133.12a68.26666667 68.26666667 0 0 1 71.68 68.26666666v136.53333334h68.26666666V167.59466667a141.99466667 141.99466667 0 0 0-141.99466666-141.99466666H167.59466667a148.13866667 148.13866667 0 0 0-55.296 10.92266666A143.36 143.36 0 0 0 25.60000001 167.59466667V298.66666667zM878.93333334 435.20000001l-136.53333333 136.53333333h102.4v245.07733333l-27.98933334 27.98933334H571.73333334V742.40000001l-136.53333333 136.53333333 136.53333333 136.53333333v-102.4h273.74933333l67.584-67.584V571.73333334H1015.46666667l-136.53333333-136.53333333z" fill="#36c" ></path><path d="M913.06666667 298.66666667V167.59466667a141.99466667 141.99466667 0 0 0-141.99466666-141.99466666H298.66666667v273.06666666h-273.06666666v477.184a161.10933333 161.10933333 0 0 0 7.50933333 40.96 136.53333333 136.53333333 0 0 0 16.384 32.768 129.024 129.024 0 0 0 37.54666667 36.864 147.456 147.456 0 0 0 24.576 15.01866667 148.13866667 148.13866667 0 0 0 55.296 10.92266667H366.93333334V640.00000001h210.944L605.86666667 605.86666667l31.40266667-30.72V366.93333334h273.06666667v-68.26666667z m-614.4 546.13333334H165.54666667a68.26666667 68.26666667 0 0 1-68.26666666-71.68V640.00000001h204.8z m0-273.06666667h-204.8v-204.8h204.8z m68.26666667-477.86666667h204.8v204.8h-204.8z m204.8 477.86666667h-204.8v-204.8h204.8z m68.26666667-273.06666667v-204.8h133.12a68.26666667 68.26666667 0 0 1 71.68 68.26666667v136.53333333z" fill="currentColor" ></path>',mianjitu:'<path d="M917.6 880.7H106c-22.1 0-40 17.9-40 40s17.9 40 40 40h811.6c22.1 0 40-17.9 40-40s-17.9-40-40-40zM171.2 824.7h683.5c22.1 0 40-17.9 40-40V105.8c0-16.3-9.9-30.9-25-37.1-15.1-6.1-32.4-2.5-43.7 9.2L580.6 330.7 452.8 217.4c-16-14.2-40.4-13.3-55.3 2.2l-255 264.3c-7.2 7.5-11.2 17.4-11.2 27.8v273c-0.1 22.1 17.8 40 39.9 40z m40-296.9l217.2-225.1L556.1 416c16 14.2 40.3 13.3 55.2-2.1l203.4-209.5v540.3H211.2V527.8z" ></path>',icon_fn_fx:'<path d="M98.56 960C44.16 960 0 915.52 0 860.8V99.2C0 44.48 44.16 0 98.56 0h698.88C851.84 0 896 44.48 896 99.2v449.728c0 18.24-14.72 33.088-32.832 33.088a32.96 32.96 0 0 1-32.832-33.088V99.2a32.96 32.96 0 0 0-32.896-33.088H98.56a32.96 32.96 0 0 0-32.896 33.088v761.6c0 18.24 14.72 33.088 32.896 33.088h491.52c18.112 0 32.832 14.784 32.832 33.024 0 18.304-14.72 33.088-32.832 33.088H98.56z" fill="currentColor" ></path><path d="M355.968 128c40.384 0 62.08 33.28 71.488 53.12 9.984 21.056 13.568 41.472 13.952 43.776a31.616 31.616 0 0 1-25.216 36.48 30.848 30.848 0 0 1-35.456-25.792c-3.136-18.048-14.336-44.224-24.768-44.224-5.696 0-11.776 1.408-17.92 11.648a62.528 62.528 0 0 0-7.04 18.432l-4.864 42.368h52.544c17.024 0 30.784 14.208 30.784 31.68a31.232 31.232 0 0 1-30.72 31.68h-59.904l-19.008 165.376a31.488 31.488 0 0 1-0.448 2.88c-0.384 1.92-4.288 19.776-15.168 37.76-16.576 27.648-41.536 42.816-70.208 42.816C163.008 576 135.936 528 128 499.584l59.072-17.6 0.384 0.96c1.92 5.568 11.392 29.696 26.56 29.696 3.2 0 9.856 0 17.28-11.712 4.544-7.232 6.912-14.976 7.68-17.856l17.92-155.904h-46.272a31.232 31.232 0 0 1-30.72-31.68c0-17.472 13.696-31.68 30.72-31.68h53.568l5.888-50.88 0.128-1.216C274.688 182.784 298.368 128 355.968 128z m92.16 214.912l37.632 38.784 37.76-38.784a30.144 30.144 0 0 1 43.52 0 32.32 32.32 0 0 1 0 44.8l-37.76 38.784 37.696 38.784a32.32 32.32 0 0 1 0 44.8 30.208 30.208 0 0 1-43.52 0l-37.696-38.784-37.632 38.784a30.272 30.272 0 0 1-43.52 0 32.32 32.32 0 0 1 0-44.8l37.632-38.784-37.632-38.784a32.32 32.32 0 0 1 0-44.8 30.144 30.144 0 0 1 43.52 0z" fill="currentColor" ></path><path d="M672 640h256a32 32 0 1 1 0 64h-256a32 32 0 1 1 0-64z m-192 128h448a32 32 0 1 1 0 64h-448a32 32 0 1 1 0-64z" fill="#36c" ></path>',dianzhanliebiaoquanxianpeizhimoren:'<path d="M136.533333 477.866667a335.189333 335.189333 0 0 0 167.253334 284.672L512 905.216l208.213333-144.384A334.848 334.848 0 0 0 887.466667 477.866667V215.04A727.04 727.04 0 0 1 512 102.4a728.064 728.064 0 0 1-375.466667 112.64V477.866667z m-68.266666-336.554667C265.557333 141.312 413.4912 94.208 512 0c98.304 94.208 246.237867 141.312 443.733333 141.312v338.602667a418.816 418.816 0 0 1-197.632 352.938666L512 989.866667l-246.101333-157.013334A418.816 418.816 0 0 1 68.266667 479.914667V141.312z m608.938666 252.586667a165.205333 165.205333 0 1 0-330.410666 0 170.666667 170.666667 0 0 0 123.904 165.205333v215.722667h82.602666v-42.325334h41.301334V648.533333h-41.301334V559.786667A167.936 167.936 0 0 0 677.205333 394.581333v-0.682666zM512 477.866667c-34.133333 0.4096-65.058133-20.002133-78.165333-51.541334A84.992 84.992 0 0 1 451.242667 333.824a83.285333 83.285333 0 0 1 91.477333-19.114667c31.5392 13.312 51.950933 44.305067 51.882667 78.506667A83.626667 83.626667 0 0 1 512 477.866667z" fill="currentColor" ></path>',biaogeyangshi:'<path d="M626.4 785.6c24 18.4 36.8 44.8 36.8 70.4-2.4 21.6-2.4 25.6-4 28.8-8 28-28 58.4-70.4 76.8-32 13.6-78.4 20.8-142.4 15.2-35.2-3.2-70.4-17.6-104.8-44-5.6-4-11.2-8.8-16-13.6 5.6 4 12 6.4 19.2 7.2 12.8 1.6 25.6-2.4 37.6-12s24-24 35.2-43.2l1.6-3.2 4-7.2 12-22.4 3.2-6.4 2.4-4 3.2-5.6 2.4-3.2 2.4-3.2 3.2-4.8c19.2-28 40-42.4 90.4-46.4 35.2-3.2 64 5.6 84 20.8z m-32 37.6c-12-7.2-28.8-11.2-50.4-9.6l-6.4 0.8-5.6 0.8-7.2 0.8h-1.6c-14.4 3.2-22.4 8.8-36 28.8l-3.2 4.8-2.4 4.8-4 7.2-10.4 19.2-5.6 9.6-3.2 4.8c-5.6 9.6-12 20-18.4 28.8 3.2 0.8 6.4 0.8 10.4 1.6 4 0 7.2 0.8 11.2 0.8l7.2 0.8h4c59.2 2.4 97.6-7.2 119.2-25.6 15.2-12.8 21.6-28.8 21.6-46.4 0-12.8-6.4-24.8-19.2-32z" ></path><path d="M781.6 49.6c27.2 0 49.6 22.4 49.6 49.6v273.6H524.8V49.6h256.8zM760 120H596v182.4H760V120zM298.4 569.6c27.2 0 49.6 22.4 49.6 49.6V872H99.2c-27.2 0-49.6-22.4-49.6-49.6V569.6h248.8zM276.8 640H120.8v161.6h156V640z" ></path><path d="M596.8 49.6v540.8c0 27.2-22.4 49.6-49.6 49.6h-448c-27.2 0-49.6-22.4-49.6-49.6V99.2C49.6 72 72 49.6 99.2 49.6h497.6zM525.6 120H120.8v449.6h404.8V120z" ></path><path d="M554.4 309.6v70.4H89.6v-70.4h464.8z" ></path><path d="M359.2 78.4v532.8H288V78.4h71.2zM925.6 419.2c14.4 12 23.2 28.8 25.6 44.8 2.4 16.8-2.4 33.6-12 46.4l-1.6 1.6-296.8 345.6-104-85.6 296-344c11.2-12.8 27.2-21.6 44.8-23.2 17.6-1.6 34.4 4 48 14.4z m-30.4 39.2c-3.2-3.2-8-4-12-4s-8.8 2.4-12.8 6.4L607.2 766.4l27.2 22.4 264-307.2 0.8-0.8c2.4-3.2 3.2-6.4 3.2-10.4s-2.4-8-7.2-12z" ></path><path d="M658.4 652.8L740.8 720l-36 44L622.4 696l36-43.2z" ></path>',dingweiquyu:'<path d="M181.333333 363.306667C181.333333 189.994667 331.562667 53.333333 512 53.333333s330.666667 136.661333 330.666667 309.973334c0 162.56-100.821333 353.493333-263.466667 422.997333-42.709333 18.261333-91.690667 18.261333-134.4 0C282.154667 716.8 181.333333 525.909333 181.333333 363.306667zM512 117.333333c-149.461333 0-266.666667 112.213333-266.666667 245.973334 0 141.994667 89.813333 306.56 224.64 364.16a107.776 107.776 0 0 0 84.053334 0c134.826667-57.6 224.64-222.165333 224.64-364.16 0-133.717333-117.205333-245.973333-266.666667-245.973334z m0 213.333334a53.333333 53.333333 0 1 0 0 106.666666 53.333333 53.333333 0 0 0 0-106.666666zM394.666667 384a117.333333 117.333333 0 1 1 234.666666 0 117.333333 117.333333 0 0 1-234.666666 0z m-241.28 255.872a32 32 0 0 1-2.218667 45.184c-24.234667 21.930667-33.834667 42.922667-33.834667 61.610667 0 32.597333 30.890667 72.746667 106.112 106.581333C295.637333 885.76 397.653333 906.666667 512 906.666667c114.346667 0 216.362667-20.906667 288.554667-53.418667 75.221333-33.834667 106.112-73.984 106.112-106.581333 0-18.688-9.6-39.68-33.834667-61.610667a32 32 0 0 1 42.965333-47.445333c32.554667 29.482667 54.869333 66.432 54.869334 109.056 0 73.472-64.64 129.28-143.829334 164.949333-82.218667 36.992-193.578667 59.050667-314.837333 59.050667-121.258667 0-232.618667-22.058667-314.837333-59.050667C117.973333 875.946667 53.333333 820.138667 53.333333 746.666667c0-42.624 22.314667-79.573333 54.869334-109.056a32 32 0 0 1 45.226666 2.261333z" ></path>',vipZidingyimingcheng:'<path d="M640.256 68.266667a136.533333 136.533333 0 0 1 92.8256 36.4032l3.720533 3.584 110.677334 110.677333a136.533333 136.533333 0 0 1 39.8848 91.392l0.1024 5.154133V375.466667a34.133333 34.133333 0 0 1-68.181334 2.56L819.2 375.466667v-59.989334a68.266667 68.266667 0 0 0-17.339733-45.448533l-2.6624-2.816-110.677334-110.677333a68.266667 68.266667 0 0 0-44.407466-19.899734L640.256 136.533333H273.066667a68.266667 68.266667 0 0 0-68.181334 64.853334L204.8 204.8v614.4a68.266667 68.266667 0 0 0 64.853333 68.181333L273.066667 887.466667h477.866666a68.266667 68.266667 0 0 0 68.181334-64.853334L819.2 819.2v-153.6a34.133333 34.133333 0 0 1 68.181333-2.56L887.466667 665.6v153.6a136.533333 136.533333 0 0 1-132.266667 136.465067L750.933333 955.733333H273.066667a136.533333 136.533333 0 0 1-136.465067-132.266666L136.533333 819.2V204.8a136.533333 136.533333 0 0 1 132.266667-136.465067L273.066667 68.266667h367.189333z m274.807467 406.596266a34.133333 34.133333 0 0 1-7.509334 47.6672l-375.466666 273.066667a34.133333 34.133333 0 0 1-40.157867-55.1936l375.466667-273.066667a34.133333 34.133333 0 0 1 47.6672 7.509334zM580.266667 426.666667a34.133333 34.133333 0 0 1 2.56 68.181333L580.266667 494.933333H324.266667a34.133333 34.133333 0 0 1-2.56-68.181333L324.266667 426.666667h256z m0-170.666667a34.133333 34.133333 0 0 1 2.56 68.181333L580.266667 324.266667H324.266667a34.133333 34.133333 0 0 1-2.56-68.181334L324.266667 256h256z" ></path>',dayinquyuxianxing:'<path d="M757.76 0H0v1024h446.464v-46.08H48.128v-931.84h685.056v233.472h241.664v192.512h48.128V259.072L757.76 0z m24.576 234.496V93.184l145.408 141.312H782.336z" ></path><path d="M991.232 603.136h-98.304V472.064H577.536v131.072H446.464v288.768h131.072V1024H892.928V892.928H1024V603.136h-32.768z m-365.568-83.968H844.8V604.16H625.664v-84.992z m227.328 467.968H616.448V815.104h236.544v172.032z m124.928-139.264h-84.992v-32.768h39.936v-43.008H538.624v43.008h38.912v32.768h-84.992V648.192h485.376v199.68z" ></path>',leidatu:'<path d="M492.0413088 64.86574507a29.7890912 29.7890912 0 0 1 39.86773333 0.04964906l424.19665494 383.83243627a29.7890912 29.7890912 0 0 1 7.44727253 33.7609696l-194.2745216 458.15621867a29.7890912 29.7890912 0 0 1-27.45561173 18.17134506H285.851152a29.7890912 29.7890912 0 0 1-27.30666667-17.87345493l-200.43093333-458.25551467a29.7890912 29.7890912 0 0 1 7.39762347-34.1085088l426.48048533-383.73314026z m19.80974613 82.31718826l-372.61187946 335.1769216L315.0941088 884.36363627h397.18787947l170.24465386-401.65624214-370.6755872-335.4748128z" fill="currentColor" ></path><path d="M494.9209216 238.78438827a29.7890912 29.7890912 0 0 1 42.05226667-2.48242454l257.32809706 229.12775787a29.7890912 29.7890912 0 0 1 7.8941088 33.26448427l-113.3474912 284.88300586a29.7890912 29.7890912 0 0 1-37.23636373 17.22802454l-241.78812053-82.11859414a29.7890912 29.7890912 0 0 1-18.0224-16.93013333L316.18637547 516.46836373a29.7890912 29.7890912 0 0 1 3.227152-28.39893333l173.3725088-246.65367253a29.7890912 29.7890912 0 0 1 2.13488533-2.68101867z m29.93803627 86.48765973l-130.52586667 185.68533333 58.6348608 143.73236374 182.30923627 61.9116608 86.09047253-216.36809707-196.50870293-174.9612608z" fill="#36c" ></path>',minitu:'<path d="M859.136 435.712l-19.456 22.016-4.096-4.096-3.584 4.096-3.584 3.072-223.232 250.88a29.184 29.184 0 0 1-38.4 3.584L307.2 514.56l-256 256a28.16 28.16 0 0 1-39.424 0 28.672 28.672 0 0 1 0-40.448l272.896-273.408a28.672 28.672 0 0 1 37.888 0l256 196.608 4.096 3.072 208.384-232.96 3.584-4.096 3.584-4.096-6.144-5.632 16.384-17.92a32.768 32.768 0 0 1 35.84-9.728l21.504 22.016a33.792 33.792 0 0 1-6.656 31.744z" ></path><path d="M865.792 403.456l-21.504-22.016-6.656-7.168a40.96 40.96 0 0 0-33.28 12.8l-16.384 17.92 4.096 4.096 4.096 4.096 16.384-18.944a28.672 28.672 0 0 1 51.2 17.408 27.648 27.648 0 0 1-7.68 20.992l-18.944 20.992 8.192 7.68 19.456-22.016a38.912 38.912 0 0 0 8.192-29.696z" ></path><path d="M1009.664 241.664a54.784 54.784 0 0 0-40.448-16.896h-12.8l-182.272 41.472a56.832 56.832 0 0 0-41.472 39.424 57.344 57.344 0 0 0 13.312 55.808l41.984 42.496 4.096 4.096 4.096 4.096 39.424 40.448 8.192 7.68 39.424 40.96a58.368 58.368 0 0 0 55.296 14.848 55.296 55.296 0 0 0 39.936-40.448L1024 294.912a55.808 55.808 0 0 0-14.336-53.248zM921.6 460.8l-51.2-51.2-7.168-7.168-21.504-22.016-6.656-7.168-51.2-51.2 182.272-41.472z" ></path>',chuangjianzu:'<path d="M414.72 0a97.92 97.92 0 0 1 96.896 89.728l0.384 8.96v826.624c0 51.456-38.848 93.76-88.448 98.304L414.656 1024H97.344a97.92 97.92 0 0 1-96.96-89.728L0 925.312V98.688C0 47.232 38.848 4.928 88.448 0.384L97.344 0h317.312z m0 64H97.28a33.792 33.792 0 0 0-32.832 29.056L64 98.688v826.624c0 17.408 12.224 31.552 27.968 34.24l5.376 0.448h317.312a33.792 33.792 0 0 0 32.896-29.056L448 925.312V98.688a34.304 34.304 0 0 0-27.968-34.24L414.656 64zM960 736.192v157.12a130.368 130.368 0 0 1-120.064 130.304l-9.728 0.384H640v-64h190.208c33.728 0 61.632-25.92 65.152-59.392l0.448-7.296v-157.12H960zM830.208 0c68.48 0 124.48 53.44 129.408 120.96l0.384 9.728-0.384 157.12h-64.192l0.384-157.12c0-34.432-25.664-62.72-58.496-66.304L830.272 64H640V0h190.208z" ></path><path d="M64 320h384v64H64z" ></path><path d="M844.8 339.2c19.84 0 35.84 16 35.84 35.84v107.52h107.52a35.84 35.84 0 1 1 0 71.68h-107.52v107.52a35.84 35.84 0 1 1-71.68 0V554.24h-107.52a35.84 35.84 0 1 1 0-71.68h107.52V375.04c0-19.84 16-35.84 35.84-35.84z" ></path><path d="M64 640h384v64H64z" ></path>',Ui:'<path d="M192 448a64 64 0 1 0 0-128 64 64 0 0 0 0 128z m320 384a64 64 0 1 1 0 128 64 64 0 0 1 0-128z m-246.976-182.656a32 32 0 0 1 45.312 0l125.888 125.888a31.936 31.936 0 0 1 0 49.664l-125.888 125.888a32 32 0 0 1-45.312 0l-3.648-4.48a32 32 0 0 1 3.648-40.768L338.56 832H160a32 32 0 1 1 0-64h178.56l-73.536-73.408a32 32 0 0 1 0-45.312zM768 960c77.44 0 128-64.448 128-193.28C896 638.912 845.44 576 768 576c-77.952 0-128 62.4-128 190.72 0 128.832 50.048 193.28 128 193.28z m0-45.824c-40.32 0-68.864-40.256-68.864-147.456 0-106.176 28.544-144.896 68.864-144.896 40.32 0 68.864 38.72 68.864 144.896 0 107.2-28.544 147.456-68.864 147.456zM448 448c77.44 0 128-64.448 128-193.28C576 126.912 525.44 64 448 64c-77.952 0-128 62.4-128 190.72C320 383.552 370.048 448 448 448z m0-45.824c-40.32 0-68.864-40.256-68.864-147.456 0-106.176 28.544-144.896 68.864-144.896 40.32 0 68.864 38.72 68.864 144.896 0 107.2-28.544 147.456-68.864 147.456zM768 448c77.44 0 128-64.448 128-193.28C896 126.912 845.44 64 768 64c-77.952 0-128 62.4-128 190.72C640 383.552 690.048 448 768 448z m0-45.824c-40.32 0-68.864-40.256-68.864-147.456 0-106.176 28.544-144.896 68.864-144.896 40.32 0 68.864 38.72 68.864 144.896 0 107.2-28.544 147.456-68.864 147.456z" ></path>',Ki:'<path d="M192 960a64 64 0 1 0 0-128 64 64 0 0 0 0 128zM512 320a64 64 0 1 1 0 128 64 64 0 0 1 0-128zM310.976 73.28a32 32 0 0 1 0 45.248L237.44 192H416a32 32 0 0 1 0 64H237.504l73.472 73.472a32 32 0 0 1 3.648 40.768l-3.648 4.48a32 32 0 0 1-45.312 0L139.776 248.832a31.936 31.936 0 0 1 0-49.664l125.888-125.888a32 32 0 0 1 45.312 0zM448 960c77.44 0 128-64.448 128-193.28C576 638.912 525.44 576 448 576c-77.952 0-128 62.4-128 190.72C320 895.552 370.048 960 448 960z m0-45.824c-40.32 0-68.864-40.256-68.864-147.456 0-106.176 28.544-144.896 68.864-144.896 40.32 0 68.864 38.72 68.864 144.896 0 107.2-28.544 147.456-68.864 147.456zM768 960c77.44 0 128-64.448 128-193.28C896 638.912 845.44 576 768 576c-77.952 0-128 62.4-128 190.72 0 128.832 50.048 193.28 128 193.28z m0-45.824c-40.32 0-68.864-40.256-68.864-147.456 0-106.176 28.544-144.896 68.864-144.896 40.32 0 68.864 38.72 68.864 144.896 0 107.2-28.544 147.456-68.864 147.456zM768 448c77.44 0 128-64.448 128-193.28C896 126.912 845.44 64 768 64c-77.952 0-128 62.4-128 190.72C640 383.552 690.048 448 768 448z m0-45.824c-40.32 0-68.864-40.256-68.864-147.456 0-106.176 28.544-144.896 68.864-144.896 40.32 0 68.864 38.72 68.864 144.896 0 107.2-28.544 147.456-68.864 147.456z" ></path>',danyuangeyangshi:'<path d="M892.8 144V19.2h-64V144l-641.6 1.6V19.2h-64v126.4H0v64h123.2V720H0v64h123.2v128h64v-128h104v-64h-104V209.6l641.6-1.6v67.2h64V208H1024V144z" fill="currentColor" ></path><path d="M867.2 339.2L552 652.8h-16c-59.2 6.4-203.2 48-230.4 299.2-1.6 12.8 3.2 25.6 11.2 35.2 8 9.6 19.2 16 32 16h20.8c43.2 0 118.4-3.2 160-4.8 36.8-3.2 70.4-16 97.6-40 27.2-22.4 62.4-60.8 75.2-108.8 1.6-8 3.2-14.4 1.6-20.8l320-323.2-156.8-166.4z m67.2 164.8l-252.8 256c-6.4-9.6-14.4-19.2-24-30.4-16-17.6-33.6-35.2-44.8-46.4l252.8-252.8 68.8 73.6zM588.8 908.8c-17.6 14.4-38.4 22.4-60.8 24-70.4 3.2-124.8 6.4-156.8 6.4 27.2-187.2 128-217.6 171.2-222.4h12.8l1.6 3.2c1.6 0 30.4 25.6 54.4 52.8 16 19.2 25.6 36.8 28.8 43.2 0 1.6 1.6 3.2 1.6 4.8 1.6 8 1.6 9.6 1.6 11.2-8 32-33.6 60.8-54.4 76.8z" fill="currentColor" ></path>',charugongshi:'<path d="M854.804 142.86c14.524 0 26.337 11.812 26.337 26.397v316.406a26.337 26.337 0 1 1-52.735 0v-290.07H195.594v632.813h290.069a26.337 26.337 0 1 1 0 52.735H169.257a26.337 26.337 0 0 1-26.398-26.398V169.257c0-14.585 11.813-26.398 26.398-26.398h685.486z m-77.445 474.609v103.66H881.08a56.23 56.23 0 0 1-56.23 56.29h-47.49v47.492c0 30.736-24.71 55.747-55.327 56.23h-0.904V777.48H617.47c0-31.098 25.192-56.29 56.23-56.29h47.49v-47.491c0-30.737 24.71-55.748 55.327-56.23h0.904zM520.437 259.297c22.24 0 40.802 10.065 53.518 29.17a102.455 102.455 0 0 1 16.092 46.948c0.361 5.002 1.205 14.947 2.531 29.833v0.602h-57.194a998.759 998.759 0 0 1-2.41-25.915c-0.603-5.785-4.099-22.54-12.537-22.54-3.495 0-9.823 5.304-16.875 20.25a266.263 266.263 0 0 0-13.68 38.993l-0.181 0.483-1.567 5.424c-0.723 2.41-2.41 8.738-6.57 25.312l-0.06 0.301h73.226c0 30.797-24.951 55.748-55.748 55.748h-31.098l-0.603 2.592c-14.946 61.172-29.832 123.006-44.417 184.118l-3.074 13.078-0.12 0.362v0.18c-6.328 21.576-27.784 57.918-68.525 58.702h-1.266c-47.43 0-72.381-43.393-79.734-69.007a174.295 174.295 0 0 1-3.676-20.01l-0.181-1.084a778.058 778.058 0 0 1-1.868-14.585l-0.12-0.663h57.193c1.025 8.619 2.23 15.308 3.616 20.07 0.06 0.3 8.92 27.18 24.77 27.18 6.931 0 12.596-10.667 14.706-16.634l0.06-0.24 2.29-9.342c4.942-20.853 17.84-74.913 30.918-129.335l0.964-4.098 1.025-4.159 7.654-31.76 0.662-2.773 0.603-2.592H336.2c0-30.736 24.95-55.748 55.747-55.748h30.616c5.545-22.48 9.161-36.642 10.728-42.066l0.06-0.181 1.507-5.123c4.58-15.91 11.572-40.078 24.047-60.991 16.092-26.88 36.763-40.5 61.534-40.5zM676.11 494.944l0.784 0.603-48.757 69.549 48.757 69.61-0.784 0.542a55.748 55.748 0 0 1-76.841-14.223l-5.123-7.353-5.123 7.353a55.748 55.748 0 0 1-76.841 14.223l-0.784-0.543 48.757-69.609-48.757-69.61 0.784-0.482a55.748 55.748 0 0 1 76.841 14.163l5.123 7.353 5.123-7.353a55.748 55.748 0 0 1 76.841-14.163z" fill="currentColor" ></path>',dangqianhangliegaoliang:'<path d="M368 768v128h288l0.064-128h63.936v128a64 64 0 0 1-64 64h-288a64 64 0 0 1-64-64v-128h64zM256 304v64H128v288h128v64H128a64 64 0 0 1-64-64v-288a64 64 0 0 1 64-64h128z m640 0a64 64 0 0 1 64 64v288a64 64 0 0 1-64 64h-128v-64h128v-288l-128-0.064V304h128z m-240 0a64 64 0 0 1 64 64v288a64 64 0 0 1-64 64h-288a64 64 0 0 1-64-64v-288a64 64 0 0 1 64-64h288z m0 64h-288v288h288v-288z m0-304a64 64 0 0 1 64 64v128h-64V128h-288v128h-64V128a64 64 0 0 1 64-64h288z" ></path>',rongqi_2024_10_15T145712642:'<path d="M853.333333 284.444444a56.888889 56.888889 0 0 1 56.888889 56.888889v512a56.888889 56.888889 0 0 1-56.888889 56.888889H341.333333a56.888889 56.888889 0 0 1-56.888889-56.888889V341.333333a56.888889 56.888889 0 0 1 56.888889-56.888889h512z m0 56.888889H341.333333v512h512V341.333333zM496.753778 456.533333L597.333333 557.112889l100.579556-100.579556a28.444444 28.444444 0 1 1 40.220444 40.220445L637.553778 597.333333l100.579555 100.579556a28.444444 28.444444 0 1 1-40.220444 40.220444L597.333333 637.553778l-100.579555 100.579555a28.444444 28.444444 0 1 1-40.220445-40.220444L557.112889 597.333333 456.533333 496.753778a28.444444 28.444444 0 1 1 40.220445-40.220445zM682.666667 113.777778a56.888889 56.888889 0 0 1 56.888889 56.888889v56.888889h-56.888889V170.666667H170.666667v512h56.888889v56.888889H170.666667a56.888889 56.888889 0 0 1-56.888889-56.888889V170.666667a56.888889 56.888889 0 0 1 56.888889-56.888889h512z"></path>',ziti:'<path d="M276.208 160L16.32 848h85.536l66.48-176h285.344l66.48 176h85.536L345.76 160h-69.568zM198.56 592l112.448-297.68L423.44 592H198.56z m472.768-236l27.84 74.992c55.232-20.288 164.4-52.256 206.88-11.92C921.328 433.632 928 444.224 928 496v276.512c-51.52 12.56-138.8 23.216-187.456-14.752C686.144 715.36 688 564.24 864 596.56V515.36c-112-14.416-184.544 17.552-219.44 93.12C586.208 734.768 672 945.376 1008 831.2V481.856c0-124.4-96.864-215.072-336.688-125.856z" fill="currentColor" ></path>',Edit_dongjiehang_freezeLine_linear:'<path d="M869.16650836 61.79375176H141.40816097A79.61440791 79.61440791 0 0 0 61.79375176 141.40816097v727.75834739c0 43.97896811 35.63543981 79.61440791 79.61440921 79.61440791h727.75834739a79.61440791 79.61440791 0 0 0 79.61440791-79.61440791V141.40816097A79.61440791 79.61440791 0 0 0 869.16650836 61.79375176zM141.40816097 130.02353445h727.75834739c6.27713969 0 11.38462653 5.06849793 11.38462652 11.38462652v727.75834739c0 6.27713969-5.06849793 11.38462653-11.38462652 11.38462652H141.40816097a11.38462653 11.38462653 0 0 1-11.38462652-11.38462652V141.40816097c0-6.27713969 5.06849793-11.38462653 11.38462652-11.38462652z" ></path><path d="M914.66602558 358.80774015a34.1148907 34.1148907 0 0 1 4.28872892 67.95686167l-4.28872892 0.27291973h-818.75738183a34.1148907 34.1148907 0 0 1-4.28873021-67.99585056l4.28873021-0.23393084h818.75738183zM303.48313312 70.4101985a34.1148907 34.1148907 0 0 1 48.57960567 47.68287123l-3.23604145 3.31401799-230.26576724 204.68934545a34.1148907 34.1148907 0 0 1-48.57960437-47.68287125l3.27503038-3.31401797 230.22677701-204.68934545z" ></path><path d="M891.85778362 161.68215269a34.1148907 34.1148907 0 0 1 48.8525241 47.40995149l-3.23604147 3.31401798-227.41960962 204.53339114a34.1148907 34.1148907 0 0 1-48.8525241-47.4099502l3.23604147-3.31401798 227.41960962-204.53339243zM530.90274404 70.4101985a34.1148907 34.1148907 0 0 1 48.57960437 47.68287123l-3.23604146 3.31401799-322.94130382 287.11092206a34.1148907 34.1148907 0 0 1-48.61859327-47.68287123l3.27502907-3.31401797 322.94130511-287.11092208zM758.32235366 70.4101985a34.1148907 34.1148907 0 0 1 48.61859327 47.68287123l-3.27502908 3.31401799-322.9413051 287.11092206a34.1148907 34.1148907 0 0 1-48.57960437-47.68287123l3.23604016-3.31401797 322.94130512-287.11092208z" ></path>',Edit_dongjielie_freezeColumn_linear:'<path d="M869.16650836 61.79375176H141.40816097A79.61440791 79.61440791 0 0 0 61.79375176 141.40816097v727.75834739c0 43.97896811 35.63543981 79.61440791 79.61440921 79.61440791h727.75834739a79.61440791 79.61440791 0 0 0 79.61440791-79.61440791V141.40816097A79.61440791 79.61440791 0 0 0 869.16650836 61.79375176zM141.40816097 130.02353445h727.75834739c6.27713969 0 11.38462653 5.06849793 11.38462652 11.38462652v727.75834739c0 6.27713969-5.06849793 11.38462653-11.38462652 11.38462652H141.40816097a11.38462653 11.38462653 0 0 1-11.38462652-11.38462652V141.40816097c0-6.27713969 5.06849793-11.38462653 11.38462652-11.38462652z" ></path><path d="M303.48313312 70.4101985a34.1148907 34.1148907 0 0 1 48.57960567 47.68287123l-3.23604145 3.31401799-230.26576724 204.68934545a34.1148907 34.1148907 0 0 1-48.57960437-47.68287125l3.27503038-3.31401797 230.22677701-204.68934545zM368.43788544 207.29863533a34.1148907 34.1148907 0 0 1 49.47634009 46.78613681l-3.19705256 3.35300558-295.64939229 272.91912814a34.1148907 34.1148907 0 0 1-49.51532771-46.78613681l3.23604148-3.35300558 295.64939099-272.91912814zM368.43788544 411.98798078a34.1148907 34.1148907 0 0 1 49.47634009 46.78613681l-3.19705256 3.35300558-295.64939229 272.91912815a34.1148907 34.1148907 0 0 1-49.51532771-46.78613681l3.23604148-3.35300559 295.64939099-272.91912814zM368.43788544 616.67732624a34.1148907 34.1148907 0 0 1 49.47634009 46.78613681l-3.19705256 3.35300559-295.64939229 272.91912813a34.1148907 34.1148907 0 0 1-49.51532771-46.7861368l3.23604148-3.35300559 295.64939099-272.91912814z" ></path><path d="M391.55803476 61.79375176c17.3888478 0 31.77558365 13.02214107 33.88095986 29.82616178l0.23393083 4.28873021v818.75738183a34.1148907 34.1148907 0 0 1-67.95686166 4.28872892l-0.27291973-4.28872892v-818.75738183c0-18.83142041 15.28347158-34.1148907 34.1148907-34.11489199z" ></path>',Edit_dongjiehanglie_freezingLineColumn_linear:'<path d="M869.16650836 61.79375176H141.40816097A79.61440791 79.61440791 0 0 0 61.79375176 141.40816097v727.75834739c0 43.97896811 35.63543981 79.61440791 79.61440921 79.61440791h727.75834739a79.61440791 79.61440791 0 0 0 79.61440791-79.61440791V141.40816097A79.61440791 79.61440791 0 0 0 869.16650836 61.79375176zM141.40816097 130.02353445h727.75834739c6.27713969 0 11.38462653 5.06849793 11.38462652 11.38462652v727.75834739c0 6.27713969-5.06849793 11.38462653-11.38462652 11.38462652H141.40816097a11.38462653 11.38462653 0 0 1-11.38462652-11.38462652V141.40816097c0-6.27713969 5.06849793-11.38462653 11.38462652-11.38462652z" ></path><path d="M303.48313312 70.4101985a34.1148907 34.1148907 0 0 1 48.57960567 47.68287123l-3.23604145 3.31401799-230.26576724 204.68934545a34.1148907 34.1148907 0 0 1-48.57960437-47.68287125l3.27503038-3.31401797 230.22677701-204.68934545zM528.01759882 70.56615282a34.1148907 34.1148907 0 0 1 48.85252412 47.3709626l-3.19705256 3.31401797-454.95618595 409.37869091a34.1148907 34.1148907 0 0 1-48.85252412-47.37096259l3.23604147-3.31401797 454.91719704-409.37869092zM732.20009501 70.95603668a34.1148907 34.1148907 0 0 1 49.67128073 46.55220597l-3.15806495 3.35300688L119.10676957 734.92928591a34.1148907 34.1148907 0 0 1-49.67128201-46.55220598l3.19705256-3.35300558 659.52856598-614.06803767zM368.43788544 616.67732624a34.1148907 34.1148907 0 0 1 49.47634009 46.78613681l-3.19705256 3.35300559-295.64939229 272.91912813a34.1148907 34.1148907 0 0 1-49.51532771-46.7861368l3.23604148-3.35300559 295.64939099-272.91912814zM868.7766232 161.7991181a34.1148907 34.1148907 0 0 1 49.4763388 46.7861368l-3.19705257 3.35300559-267.38276725 246.79686821a34.1148907 34.1148907 0 0 1-49.47633878-46.74714792l3.19705255-3.35300558 267.38276725-246.7968682z" ></path><path d="M391.55803476 402.94266128c17.3888478 0 31.77558365 13.02214107 33.88095986 29.82616178l0.23393083 4.28872893v477.60847359a34.1148907 34.1148907 0 0 1-67.95686166 4.28872892l-0.27291973-4.28872892v-477.60847359c0-18.83142041 15.28347158-34.1148907 34.1148907-34.11489071z" ></path><path d="M914.66602558 402.94266128a34.1148907 34.1148907 0 0 1 4.28872892 67.95686296l-4.28872892 0.27291843H391.55803476a34.1148907 34.1148907 0 0 1-4.28872892-67.95686164l4.28872892-0.27291975h523.10799082z" ></path>',Wi:'<path d="M256 502.186667a170.666667 170.666667 0 0 1-160-181.76A170.666667 170.666667 0 0 1 256 138.666667a170.666667 170.666667 0 0 1 160.426667 181.76A170.666667 170.666667 0 0 1 256 502.186667z m0-298.666667a108.8 108.8 0 0 0-96 116.906667A108.8 108.8 0 0 0 256 438.186667a108.8 108.8 0 0 0 96.426667-117.76A108.8 108.8 0 0 0 256 202.666667zM768 885.333333a170.666667 170.666667 0 0 1-160.426667-181.76A170.666667 170.666667 0 0 1 768 521.813333a170.666667 170.666667 0 0 1 160 181.76A170.666667 170.666667 0 0 1 768 885.333333z m0-298.666666a108.8 108.8 0 0 0-96.426667 117.76A108.8 108.8 0 0 0 768 821.333333a108.8 108.8 0 0 0 96-117.76A108.8 108.8 0 0 0 768 585.813333zM170.666667 885.333333a31.573333 31.573333 0 0 1-22.613334-9.386666 32 32 0 0 1 0-45.226667l682.666667-682.666667a32 32 0 1 1 45.226667 45.226667l-682.666667 682.666667a31.573333 31.573333 0 0 1-22.613333 9.386666z" ></path>',zhihangzhongsuan:'<path d="M444.348 1010.048a36.648 36.648 0 0 1-5.384-0.328C188.724 976.072 0.004 760.016 0.004 507.12 0.004 227.504 227.492 0 507.124 0 759.948 0 976.004 188.656 1009.716 438.896a39.92 39.92 0 1 1-79.128 10.632C902.252 238.736 720.18 79.808 507.124 79.808c-235.888 0.296-427.032 191.432-427.32 427.312 0 213.064 159 395.064 369.792 423.464a39.904 39.904 0 0 1-5.248 79.464z" fill="currentColor" ></path><path d="M446.276 749.312c-3.864 0-7.728-0.568-11.432-1.672A252.592 252.592 0 0 1 256.1 507.12c0.104-138.64 112.448-251.008 251.096-251.16 110.544-0.48 208.256 71.784 240.184 177.608a39.896 39.896 0 0 1-76.28 23.344 170.36 170.36 0 0 0-163.84-121.096c-94.576 0.152-171.192 76.792-171.304 171.368A172.232 172.232 0 0 0 457.844 671.24a39.904 39.904 0 0 1-11.568 78.072z" fill="currentColor" ></path><path d="M718.324 1016.968L568.964 568.96l448.072 149.36-298.712 298.648z m-23.152-321.856l58.056 174.168 116.104-116.12-174.16-58.048z" fill="currentColor" ></path>',yunfengdie_tongjishuzhiqianfenwei:'<path d="M947.424 854.464c21.824 0 30.176 8.256 30.176 29.568s-8.352 29.568-30.176 29.568H76.576c-21.824 0-30.176-8.256-30.176-29.568s8.352-29.568 30.176-29.568h870.848zM110.144 617.696v50.304l-19.456 44.544-1.376 2.528a20 20 0 0 1-16.96 9.12h-22.528v-106.496h60.32z m189.28-317.888c27.712 0 50.912 8.704 70.368 26.304 19.104 17.28 28.384 37.568 28.384 61.76v248.32c0 24.16-9.28 44.448-28.384 61.76-19.424 17.568-42.656 26.24-70.368 26.24-27.712 0-50.912-8.672-70.368-26.24-19.104-17.312-28.384-37.632-28.384-61.824v-248.32c0-24.128 9.28-44.416 28.384-61.696 19.456-17.6 42.688-26.304 70.4-26.304z m288 0c27.712 0 50.912 8.704 70.368 26.304 19.104 17.28 28.384 37.568 28.384 61.76v248.32c0 24.16-9.28 44.448-28.384 61.76-19.424 17.568-42.656 26.24-70.368 26.24-27.712 0-50.912-8.672-70.368-26.24-19.104-17.312-28.384-37.632-28.384-61.824v-248.32c0-24.128 9.28-44.416 28.384-61.696 19.456-17.6 42.688-26.304 70.4-26.304z m288 0c27.712 0 50.912 8.704 70.368 26.304 19.104 17.28 28.384 37.568 28.384 61.76v248.32c0 24.16-9.28 44.448-28.384 61.76-19.424 17.568-42.656 26.24-70.368 26.24-27.712 0-50.912-8.672-70.368-26.24-19.104-17.312-28.384-37.632-28.384-61.824v-248.32c0-24.128 9.28-44.416 28.384-61.696 19.456-17.6 42.688-26.304 70.4-26.304z m-576 51.872c-10.144 0-19.264 3.424-26.624 10.112-7.68 6.976-11.776 15.968-11.776 26.08v248.32c0 10.144 4.16 19.136 11.84 26.048 7.296 6.656 16.416 10.08 26.56 10.08 10.176 0 19.264-3.424 26.624-10.112 7.68-6.88 11.776-15.904 11.776-26.08V387.84c0-10.112-4.096-19.104-11.776-26.08a38.656 38.656 0 0 0-26.624-10.112z m288 0c-10.144 0-19.264 3.424-26.624 10.112-7.68 6.976-11.776 15.968-11.776 26.08v248.32c0 10.144 4.16 19.136 11.84 26.048 7.296 6.656 16.416 10.08 26.56 10.08 10.176 0 19.264-3.424 26.624-10.112 7.68-6.88 11.776-15.904 11.776-26.08V387.84c0-10.112-4.096-19.104-11.776-26.08a38.656 38.656 0 0 0-26.624-10.112z m288 0c-10.144 0-19.264 3.424-26.624 10.112-7.68 6.976-11.776 15.968-11.776 26.08v248.32c0 10.144 4.16 19.136 11.84 26.048 7.296 6.656 16.416 10.08 26.56 10.08 10.176 0 19.264-3.424 26.624-10.112 7.68-6.88 11.776-15.904 11.776-26.08V387.84c0-10.112-4.096-19.104-11.776-26.08a38.656 38.656 0 0 0-26.624-10.112z m72-241.28c21.824 0 30.176 8.256 30.176 29.568s-8.352 29.568-30.176 29.568H76.576c-21.824 0-30.176-8.256-30.176-29.568s8.352-29.568 30.176-29.568h870.848z" ></path>',hanglie:'<path d="M46.74294518 185.46566637A155.34459259 155.34459259 0 0 1 201.31081482 45.96622222h621.37837036l15.84514845 0.77672296a155.34459259 155.34459259 0 0 1 138.64504889 138.72272119L978.03377778 201.31081482v621.37837036a155.34459259 155.34459259 0 0 1-139.49944415 154.56786964L822.68918518 978.03377778H201.31081482a155.34459259 155.34459259 0 0 1-155.3445926-155.3445926V201.31081482l0.77672296-15.84514845zM900.36148148 317.81925925V201.31081482a77.6722963 77.6722963 0 0 0-77.6722963-77.6722963h-116.50844443v194.18074073H900.36148148zM822.68918518 900.36148148a77.6722963 77.6722963 0 0 0 77.6722963-77.6722963V395.49155555H395.49155555V900.36148148H822.68918518zM628.50844445 317.81925925V123.63851852h-233.0168889v194.18074073h233.0168889zM123.63851852 822.68918518a77.6722963 77.6722963 0 0 0 69.67204978 77.28393482L201.31081482 900.36148148h116.50844443v-194.18074073H123.63851852V822.68918518z m194.18074073-504.86992593V123.63851852H201.31081482a77.6722963 77.6722963 0 0 0-77.28393482 69.67204978L123.63851852 201.31081482v116.50844443h194.18074073z m0 310.6891852v-233.0168889H123.63851852v233.0168889h194.18074073z" fill="currentColor" ></path>',yebianju:'<path d="M888.0128 235.42897813v45.5111104H136.07822187v-45.5111104h751.9800896zM888.0128 733.54808853v45.51111147H136.07822187v-45.51111147h751.9800896z" fill="#36c" ></path><path d="M692.08746667 80.5091552h45.51111146v863.0272h-45.51111146V80.4636448zM279.62026667 80.5091552h45.51111146v863.0272h-45.51111146V80.4636448z" fill="#36c" ></path><path d="M881.09511147 125.9747552a22.7555552 22.7555552 0 0 0-22.75555627-22.7555552H165.6604448a22.7555552 22.7555552 0 0 0-22.75555627 22.7555552v772.00497813a22.7555552 22.7555552 0 0 0 22.75555627 22.7555552h692.6791104a22.7555552 22.7555552 0 0 0 22.75555627-22.7555552V125.9747552z m45.5111104 772.00497813a68.26666667 68.26666667 0 0 1-68.26666667 68.26666667H165.6604448a68.26666667 68.26666667 0 0 1-68.26666667-68.26666667V125.9747552a68.26666667 68.26666667 0 0 1 68.26666667-68.26666667h692.6791104a68.26666667 68.26666667 0 0 1 68.26666667 68.26666667v772.00497813z" fill="currentColor" ></path>',jianqie:'<path d="M1005.635852 832.573853l-119.766078-207.394925c-17.066666-29.542299-44.612864-50.700973-77.548536-59.483819-32.935671-8.882651-67.368419-4.291618-96.910718 12.775048-19.761403 11.377777-35.730213 27.446393-46.808576 46.70877l-99.805065-172.962178 231.747361-401.415972c8.782846-15.270175 3.592982-34.831968-11.677193-43.614813-15.270175-8.782846-34.831968-3.592982-43.614813 11.677193L527.869005 388.241703 313.587531 17.066666c-8.782846-15.270175-28.344638-20.460038-43.614813-11.677193-15.270175 8.782846-20.460038 28.344638-11.677193 43.614813L490.941131 452.116945 299.614821 783.569566c-27.446393-48.305652-79.444832-81.041713-138.928651-81.041713-88.028067 0-159.688104 71.660037-159.688104 159.688104s71.660037 159.688104 159.688104 159.688104c83.237424 0 151.903309-64.074852 159.089274-145.515785l208.093561-360.495895 136.732939 236.83742c0 0 0 0 0 0l119.766078 207.394925c17.066666 29.542299 44.612864 50.700973 77.548536 59.483819 10.978557 2.994152 22.156724 4.391423 33.235087 4.391423 22.156724 0 44.014034-5.788694 63.675632-17.166471 29.542299-17.066666 50.700973-44.612864 59.483819-77.548536C1027.293551 896.5489 1022.702518 862.116153 1005.635852 832.573853zM160.686171 958.128625c-52.796879 0-95.812863-43.015983-95.812863-95.812863s43.015983-95.812863 95.812863-95.812863 95.812863 43.015983 95.812863 95.812863S213.48305 958.128625 160.686171 958.128625zM926.989461 951.741101c-14.77115 8.483431-32.037426 10.778947-48.505262 6.387524-16.467836-4.391423-30.240935-14.97076-38.82417-29.741909l-119.766078-207.49473c-17.565691-30.54035-7.08616-69.663935 23.354385-87.229627 9.880701-5.688889 20.759454-8.583236 31.837816-8.583236 5.589084 0 11.178167 0.698635 16.667446 2.195711 16.467836 4.391423 30.240935 14.97076 38.82417 29.741909l119.766078 207.394925C967.909537 894.952019 957.430006 934.075604 926.989461 951.741101z" ></path>',fuzhi:'<path d="M720 192h-544A80.096 80.096 0 0 0 96 272v608C96 924.128 131.904 960 176 960h544c44.128 0 80-35.872 80-80v-608C800 227.904 764.128 192 720 192z m16 688c0 8.8-7.2 16-16 16h-544a16 16 0 0 1-16-16v-608a16 16 0 0 1 16-16h544a16 16 0 0 1 16 16v608z" ></path><path d="M848 64h-544a32 32 0 0 0 0 64h544a16 16 0 0 1 16 16v608a32 32 0 1 0 64 0v-608C928 99.904 892.128 64 848 64z" ></path><path d="M608 360H288a32 32 0 0 0 0 64h320a32 32 0 1 0 0-64zM608 520H288a32 32 0 1 0 0 64h320a32 32 0 1 0 0-64zM480 678.656H288a32 32 0 1 0 0 64h192a32 32 0 1 0 0-64z" ></path>',geshihua:'<path d="M846.506667 940.373333h-682.666667c-13.653333 0-25.6-11.946667-25.6-25.6V530.773333c0-13.653333 11.946667-25.6 25.6-25.6h682.666667c13.653333 0 25.6 11.946667 25.6 25.6v384c0 13.653333-10.24 25.6-25.6 25.6z m-657.066667-51.2h631.466667V556.373333h-631.466667v332.8z"></path><path d="M931.84 556.373333h-853.333333c-13.653333 0-25.6-11.946667-25.6-25.6V295.253333c0-13.653333 11.946667-25.6 25.6-25.6h273.066666V146.773333c0-13.653333 11.946667-25.6 25.6-25.6h256c13.653333 0 25.6 11.946667 25.6 25.6v124.586667h273.066667c13.653333 0 25.6 11.946667 25.6 25.6v235.52c0 11.946667-10.24 23.893333-25.6 23.893333z m-827.733333-51.2h802.133333V320.853333h-273.066667c-13.653333 0-25.6-11.946667-25.6-25.6V170.666667h-204.8v124.586666c0 13.653333-11.946667 25.6-25.6 25.6h-273.066666v184.32zM334.506667 940.373333c-13.653333 0-25.6-11.946667-25.6-25.6V701.44c0-13.653333 11.946667-25.6 25.6-25.6s25.6 11.946667 25.6 25.6v213.333333c0 13.653333-10.24 25.6-25.6 25.6z"></path>',jurassic_borderAll:'<path d="M62 62v900h900V62H62z m60 60h360v360H122V122z m0 780V542h360v360H122z m780 0H542V542h360v360z m0-420H542V122h360v360z" fill="currentColor" ></path>',hebing:'<path d="M362.375529 613.556706a29.033412 29.033412 0 0 1-20.720941-8.613647l-0.963764-1.024a33.611294 33.611294 0 0 1-0.90353-45.116235l45.296941-47.706353h-224.677647V445.620706h224.195765l-44.393412-46.742588a33.611294 33.611294 0 0 1-0.903529-45.056l0.903529-1.084236a29.274353 29.274353 0 0 1 42.405647-1.084235l120.591059 126.976-119.145412 125.289412a28.912941 28.912941 0 0 1-21.684706 9.637647m340.931765 0a29.033412 29.033412 0 0 1-20.781176-8.613647L561.995294 478.027294l119.024941-125.289412a29.274353 29.274353 0 0 1 42.405647-1.084235l0.90353 1.084235a33.310118 33.310118 0 0 1 0.963764 44.754824l-45.357176 47.706353h224.256v65.897412h-224.075294l44.333176 46.742588a33.129412 33.129412 0 0 1 0.963765 44.634353l-0.963765 1.084235v0.481882a27.587765 27.587765 0 0 1-21.202823 9.517177m-579.102118 358.821647c-41.441882-3.553882-73.246118-39.152941-73.246117-83.727059V93.364706C50.898824 46.381176 86.136471 9.216 131.011765 9.216h267.986823c44.875294 0 80.112941 36.984471 80.112941 84.208941V177.694118h-62.644705V93.424941a19.456 19.456 0 0 0-4.818824-13.191529 18.672941 18.672941 0 0 0-12.528941-5.662118H130.951529a18.010353 18.010353 0 0 0-12.468705 5.541647 17.106824 17.106824 0 0 0-4.818824 12.769883v794.563764c0 11.685647 6.264471 18.251294 17.287529 18.251294h268.047059a18.010353 18.010353 0 0 0 12.468706-5.541647 17.106824 17.106824 0 0 0 4.818824-12.649411v-84.208942h62.223058v84.148706c0 47.224471-35.237647 84.208941-80.112941 84.208941H124.084706l0.12047 0.722824z m542.479059 0.481882c-44.815059 0-80.052706-36.984471-80.052706-84.208941v-84.208941h62.644706v84.208941c0 11.625412 6.264471 18.251294 17.287529 18.251294h268.649412a19.937882 19.937882 0 0 0 17.28753-18.251294V93.906824c0-11.625412-6.264471-18.251294-17.28753-18.251295h-268.528941a19.937882 19.937882 0 0 0-17.287529 18.251295V180.705882H586.691765V93.967059c0-47.224471 35.237647-84.208941 80.112941-84.208941h267.986823c44.875294 0 80.112941 36.984471 80.112942 84.208941v794.74447c0 47.224471-35.237647 84.208941-80.112942 84.208942h-268.167529z" fill="currentColor" ></path>',ic_zitifangxiang:'<path d="M270.04 660.99h-96.3l0.24-550.84H99.19l-0.25 550.84-0.78 167.25 171.88-167.25zM928.34 913.85L761.01 738.66v98.89l-551.13-0.76v77.06M372.44 194.95H509.9v427.71l-74.76 0.52v83.37h250v-83.89h-74.77V194.95h136.69v86.54h90.73V110.15H281.71v171.34h90.73v-86.54z" ></path>',zengjiazihao:'<path d="M670.272 659.904H353.728L288 822.848a48.704 48.704 0 1 1-90.304-36.48l249.408-618.304A64 64 0 0 1 506.432 128h11.136a64 64 0 0 1 59.328 40.064l249.472 618.368a48.704 48.704 0 0 1-90.368 36.48l-65.728-163.008zM631.232 563.2L512 267.52 392.704 563.2h238.592z" ></path><path d="M815.232 37.312a48 48 0 0 1 48 48v67.2h67.2a48 48 0 0 1 0 96h-67.2v67.2a48 48 0 0 1-96 0v-67.2h-67.2a48 48 0 0 1 0-96h67.2v-67.2a48 48 0 0 1 48-48z" ></path>',styleFill:'<path d="M838.802286 442.294857l-380.050286 352.146286a23.405714 23.405714 0 0 1-31.817143 0L81.444571 474.331429a23.405714 23.405714 0 0 1 0-34.340572l327.533715-303.506286H215.954286a31.670857 31.670857 0 1 1 0-63.341714h261.376l361.472 334.811429a23.405714 23.405714 0 0 1 0 34.377143zM477.366857 162.742857l-299.190857 277.211429a23.405714 23.405714 0 0 0 0 34.377143l264.667429 245.248 317.732571-294.4-283.209143-262.436572z m394.605714 316.342857l16.603429 19.017143 7.606857 8.923429 13.641143 16.713143c25.417143 31.890286 38.985143 54.345143 40.704 67.364571 3.291429 28.013714-17.737143 53.284571-46.994286 56.466286l-0.621714 0.036571c-29.988571 3.401143-57.307429-16.420571-60.964571-44.141714-1.097143-8.118857 0.219429-20.626286 3.949714-37.485714l3.730286-15.506286 4.937142-17.737143 2.889143-9.618286 6.692572-20.955428c2.340571-7.350857 5.010286-15.067429 7.789714-23.076572z m-429.129142 330.130286L80.237714 473.234286a21.942857 21.942857 0 0 1-0.036571-32.146286h759.917714L442.843429 809.179429z m482.194285 84.114286c0 31.817143-25.746286 57.563429-57.563428 57.563428H140.178286a57.563429 57.563429 0 1 1 0-115.126857H867.474286c31.817143 0 57.563429 25.746286 57.563428 57.563429z" ></path>',jszh:'<path d="M768 896h-108.245333l-77.354667-198.528H266.538667L193.578667 896H85.333333L374.272 170.666667h104.789333L768 896z m-215.978667-280.490667l-114.602666-301.568c-3.584-9.685333-7.509333-26.538667-11.733334-50.56H423.253333c-3.626667 21.845333-7.68 38.698667-12.245333 50.56L297.386667 615.509333h254.634666zM896 213.333333a42.666667 42.666667 0 1 1 0 85.333334h-256a42.666667 42.666667 0 1 1 0-85.333334h256z" ></path>',zhuanhuan:'<path d="M123.751 409.147h259.974c15.85 0 25.364-12.682 25.364-25.364 0-15.854-12.682-25.363-25.364-25.363H183.99c60.236-123.646 183.882-209.248 326.551-209.248 180.713 0 332.891 136.328 358.254 310.699h53.898C897.331 256.965 722.958 98.447 510.541 98.447c-155.35 0-288.506 85.602-361.426 212.417V123.809c0-12.681-9.509-25.363-25.364-25.363-12.681 0-25.363 12.682-25.363 25.363v259.974c0.001 25.364 25.363 25.364 25.363 25.364m776.748 206.076h-259.97c-15.854 0-25.363 12.682-25.363 25.364 0 15.848 12.682 25.362 25.363 25.362h196.563C780.025 789.592 653.21 872.026 510.541 872.026c-180.713 0-332.891-136.328-358.254-310.7h-50.725C126.925 767.403 301.293 925.92 510.541 925.92c155.35 0 291.674-85.598 361.427-212.417v187.054c0 15.854 12.682 25.363 25.363 25.363 15.851 0 25.363-12.681 25.363-25.363V640.588c3.169-25.365-22.195-25.365-22.195-25.365m0 0z" fill="currentColor" ></path>',shengcheng:'<path d="M741.888 192c0 20.992-16.896 37.888-37.888 37.888H324.608c-20.992 0-37.888-16.896-37.888-37.888 0-20.992 16.896-37.888 37.888-37.888h379.392c20.48 0 37.888 16.896 37.888 37.888z" ></path><path d="M858.624 642.56h-71.68V91.136c0-10.752-8.704-19.456-19.456-19.456h-506.88c-10.752 0-19.456 8.704-19.456 19.456v553.472h-71.68V70.656C169.472 31.744 201.216 0 240.128 0h547.84c38.912 0 70.656 31.744 70.656 70.656v571.904z m0 0" ></path><path d="M941.056 1022.464H87.04c-38.912 0-70.656-31.744-70.656-70.656v-239.616c0-38.912 31.744-70.656 70.656-70.656h854.016c38.912 0 70.656 31.744 70.656 70.656v239.616c0 38.912-31.744 70.656-70.656 70.656zM105.984 703.488c-10.24 0-18.432 8.192-18.432 18.432v228.864c0 10.24 8.192 18.432 18.432 18.432h817.152c10.24 0 18.432-8.192 18.432-18.432V721.92c0-10.24-8.192-18.432-18.432-18.432H105.984z m-18.944-10.752M739.328 364.544c0 20.992-16.896 37.888-37.888 37.888H322.048c-20.992 0-37.888-16.896-37.888-37.888 0-20.992 16.896-37.888 37.888-37.888H701.44c20.992 0 37.888 16.896 37.888 37.888zM741.888 536.064c0 20.992-16.896 37.888-37.888 37.888H324.608c-20.992 0-37.888-16.896-37.888-37.888 0-20.992 16.896-37.888 37.888-37.888h379.392c20.48 0 37.888 16.896 37.888 37.888z" ></path>',url:'<path d="M578.133 675.627c-3.306-3.307-8.746-3.307-12.053 0L442.133 799.573c-57.386 57.387-154.24 63.467-217.6 0-63.466-63.466-57.386-160.213 0-217.6L348.48 458.027c3.307-3.307 3.307-8.747 0-12.054l-42.453-42.453c-3.307-3.307-8.747-3.307-12.054 0L170.027 527.467c-90.24 90.24-90.24 236.266 0 326.4s236.266 90.24 326.4 0L620.373 729.92c3.307-3.307 3.307-8.747 0-12.053l-42.24-42.24z m275.84-505.6c-90.24-90.24-236.266-90.24-326.4 0L403.52 293.973c-3.307 3.307-3.307 8.747 0 12.054l42.347 42.346c3.306 3.307 8.746 3.307 12.053 0l123.947-123.946c57.386-57.387 154.24-63.467 217.6 0 63.466 63.466 57.386 160.213 0 217.6L675.52 565.973c-3.307 3.307-3.307 8.747 0 12.054l42.453 42.453c3.307 3.307 8.747 3.307 12.054 0l123.946-123.947c90.134-90.24 90.134-236.266 0-326.506z" ></path><path d="M616.64 362.987c-3.307-3.307-8.747-3.307-12.053 0l-241.6 241.493c-3.307 3.307-3.307 8.747 0 12.053l42.24 42.24c3.306 3.307 8.746 3.307 12.053 0L658.773 417.28c3.307-3.307 3.307-8.747 0-12.053l-42.133-42.24z" ></path>',tianjia:'<path d="M883.2 560.8H140.8c-26.9 0-48.8-22-48.8-48.8 0-26.9 22-48.8 48.8-48.8h742.3c26.9 0 48.8 22 48.8 48.8 0.1 26.9-21.9 48.8-48.7 48.8z" fill="currentColor" ></path><path d="M463.2 883.2V140.8c0-26.9 22-48.8 48.8-48.8 26.9 0 48.8 22 48.8 48.8v742.3c0 26.9-22 48.8-48.8 48.8-26.9 0.1-48.8-21.9-48.8-48.7z" fill="currentColor" ></path>',gengduo:'<path d="M200.753 408.251c-57.062 0-103.749 46.687-103.749 103.749s46.687 103.749 103.749 103.749S304.502 569.062 304.502 512s-46.687-103.749-103.749-103.749z m622.494 0c-57.062 0-103.749 46.687-103.749 103.749s46.687 103.749 103.749 103.749S926.996 569.062 926.996 512s-46.687-103.749-103.749-103.749z m-311.247 0c-57.062 0-103.749 46.687-103.749 103.749S454.938 615.749 512 615.749 615.749 569.062 615.749 512 569.062 408.251 512 408.251z" fill="currentColor" ></path>',cuowu:'<path d="M910.336 186.368l-72.704-72.704L512 439.808 186.368 113.664 113.664 186.368 439.808 512l-326.144 325.632 72.704 72.704L512 584.192l325.632 326.144 72.704-72.704L584.192 512l326.144-325.632z" fill="currentColor" ></path>',queding:'<path d="M375.5136 776.2272l518.92266667-518.92266667c18.74453333-18.74453333 49.136-18.74453333 67.8816 0 18.74453333 18.74666667 18.74453333 49.13813333 0 67.88266667l-586.80533334 586.80533333L60.992 597.47093333c-18.74453333-18.7456-18.74453333-49.13706667 0-67.88266666 18.7456-18.74453333 49.13706667-18.74453333 67.88266667 0l246.63893333 246.63893333z" ></path>',gongshi1:'<path d="M902.636511 462.62493c6.825229-6.825229 13.650458-11.94415 18.769379-11.944151h90.434282c6.825229 0 11.94415-6.825229 11.944151-11.94415v-102.378432c0-6.825229-6.825229-11.94415-11.944151-11.944151h-102.378432c-6.825229 0-18.769379 6.825229-18.769379 11.944151l-109.203661 114.322582c-6.825229 6.825229-13.650458 6.825229-13.650458 0l-58.014445-114.322582c-6.825229-6.825229-13.650458-11.94415-18.769379-11.944151h-167.218106c-6.825229 0-11.94415 6.825229-11.944151 11.944151v102.378432c0 6.825229 6.825229 11.94415 11.944151 11.94415h102.378432c6.825229 0 13.650458 6.825229 18.769379 11.944151l39.245066 83.609053v18.769379L568.200299 699.801631c-6.825229 0-11.94415 6.825229-18.769379 6.825229H460.702945c-6.825229 0-13.650458 6.825229-13.650457 11.94415v102.378433c0 6.825229 6.825229 11.94415 13.650457 11.94415h102.378433c6.825229 0 18.769379-6.825229 18.769379-11.94415l146.742419-165.511799c6.825229-6.825229 11.94415-6.825229 11.944151 0l83.609053 165.511799c0 6.825229 13.650458 11.94415 18.769379 11.94415h102.378432c6.825229 0 13.650458-6.825229 13.650458-11.94415v-102.378433c0-6.825229-6.825229-11.94415-13.650458-11.94415h-37.538758c-6.825229 0-11.94415-6.825229-18.769379-11.94415l-64.839674-127.973041v-18.769379l78.490131-85.31536zM377.093892 65.055351c-32.419837 25.594608-64.839674 63.133367-83.609053 127.97304l-32.419837 127.973041H75.077517c-6.825229 0-13.650458 6.825229-13.650458 11.94415v102.378432c0 6.825229 6.825229 11.94415 13.650458 11.944151h153.567648L133.091962 831.187286c-18.769379 76.783824-69.958595 63.133367-69.958595 63.133366H0v127.973041h64.839674c51.189216 0 102.378432-6.825229 127.97304-37.538759 32.419837-32.419837 51.189216-88.727975 64.839674-153.567648l95.553203-383.919121h146.74242c6.825229 0 11.94415-6.825229 11.94415-11.944151v-102.378432c0-6.825229-6.825229-11.94415-11.94415-11.94415h-114.322583l32.419837-121.147812c6.825229-18.769379 37.538759-51.189216 58.014445-63.133366 69.958595-51.189216 167.218106-18.769379 230.351473-6.825229V20.691364C639.865202 8.747213 498.241704-37.323081 377.093892 65.055351z" fill="currentColor" ></path>',chongzuo:'<path d="M894.549333 502.869333l-267.733333 289.962667v-146.346667l-26.837333-31.573333c-77.610667-12.757333-158.72-9.898667-243.2 8.021333-69.333333 14.72-142.208 63.445333-218.709334 141.141334a528.981333 528.981333 0 0 1 134.101334-229.589334l-20.821334-20.565333 20.821334 20.565333c88.874667-90.069333 195.882667-135.253333 322.901333-136.277333l31.744-32V228.053333l267.733333 274.816z m67.029334-22.912l-343.850667-352.938666-54.912 22.314666v186.026667c-130.346667 8.021333-242.858667 59.605333-336.213333 154.154667-100.309333 101.674667-157.866667 228.352-173.098667 378.453333l56.576 23.466667c103.637333-126.506667 190.378667-191.146667 259.968-205.866667 67.584-14.336 131.797333-17.962667 192.768-11.221333V874.666667l55.466667 21.717333 343.893333-372.394667-0.597333-44.032z" ></path>',chexiao:'<path d="M129.4336 502.8864l267.776 289.9456v-146.3808l26.8288-31.5904c77.568-12.6976 158.72-9.8304 243.2 8.0896 69.3248 14.6944 142.1824 63.488 218.7264 141.1072a528.9472 528.9472 0 0 0-134.144-229.5808l20.8384-20.5824-20.8384 20.5824c-88.8832-90.0608-195.8912-135.2192-322.8672-136.2432l-31.744-32v-138.24l-267.776 274.8928z m-67.0208-22.9376l343.8592-352.9216 54.9376 22.3232v185.9584c130.304 8.0896 242.8416 59.648 336.1792 154.2144 100.352 101.6832 157.9008 228.352 173.1072 378.4192l-56.576 23.552c-103.6288-126.5664-190.3616-191.1808-259.9936-205.9264-67.584-14.336-131.7888-17.9712-192.7168-11.2128v200.2944l-55.552 21.7088-343.808-372.3776 0.5632-44.032z" ></path>',csv:'<path d="M128 128q0-35.328 24.96-60.352 25.024-24.96 60.352-24.96H640c11.328 0 22.144 4.48 30.144 12.48l213.376 213.312a42.624 42.624 0 0 1 12.48 30.208V896q0 35.328-24.96 60.352-25.024 24.96-60.352 24.96H213.312q-35.328 0-60.288-24.96Q128 931.392 128 896V128z m85.312 0v768h597.376V316.352L622.336 128h-408.96z"></path><path d="M653.824 720q-58.368 50.176-127.488 50.56-63.616 0.384-115.008-40.448-49.984-39.68-66.88-100.928-18.176-65.984 10.24-131.072 39.424-90.24 119.168-110.336 74.176-18.688 175.808 28.8a42.56 42.56 0 1 1-36.096 77.12q-74.176-34.688-118.912-23.36-39.232 9.856-61.952 61.888-16.32 37.44-6.144 74.368 9.472 34.496 37.696 56.832 27.904 22.208 61.568 22.016 37.888-0.192 72.512-30.08a42.56 42.56 0 1 1 55.488 64.64z"></path>',pdf:'<path d="M73.334 87.627l586.617-83.77A23.334 23.334 0 0 1 686.6 26.959V999.8a23.33 23.33 0 0 1-26.6 23.1L73.287 939.133c-23-3.276-40.088-22.97-40.088-46.202V133.828c0-23.231 17.088-42.925 40.088-46.201h0.046z m53.249 112.033v627.438c0 14.531 10.684 26.851 25.07 28.907l408.279 58.343c15.965 2.281 30.756-8.811 33.037-24.776a29.2 29.2 0 0 0 0.294-4.13V141.317c0-16.127-13.073-29.2-29.2-29.2a29.2 29.2 0 0 0-4.131 0.293l-408.28 58.344c-14.385 2.055-25.07 14.375-25.07 28.906zM873.27 840.055V186.703H762.467c-16.127 0-29.2-13.073-29.2-29.2v-34.936c0-16.127 13.073-29.2 29.2-29.2h157.472c25.774 0 46.668 20.894 46.668 46.668v746.688c0 25.774-20.894 46.668-46.668 46.668H762.467c-16.127 0-29.2-13.073-29.2-29.2v-34.935c0-16.127 13.073-29.2 29.2-29.2h110.804z"></path><path d="M368.327 327.25c91.52 0 166.4 46.222 166.4 138.666 0 92.444-75.804 138.667-163.627 138.667h-48.07v138.666h-99.84v-416z m-5.547 77.653h-39.75v122.026h43.448c48.071 0 71.182-22.186 71.182-64.71 0-42.525-26.809-57.316-74.88-57.316z"></path>',json:'<path d="M212.992 128h86.016v84.992H212.992v214.016q0 35.008-24.992 60T128 512q35.008 0 60 24.992t24.992 60v214.016h86.016V896H212.992q-36.992-8.992-59.008-28.992-26.016-23.008-26.016-56V640q0-35.008-24.992-60t-60-24.992H-0.032v-86.016h43.008q35.008 0 60-24.992T127.968 384V212.992q0-35.008 24.992-60T212.96 128z m598.016 0q35.008 0 60 24.992T896 212.992V384q0 35.008 24.992 60t60 24.992H1024v86.016h-43.008q-35.008 0-60 24.992T896 640v171.008q0 35.008-24.992 60T811.008 896h-86.016v-84.992h86.016v-214.016q0-35.008 24.992-60T896 512q-35.008 0-60-24.992t-24.992-60V212.992h-86.016V128h86.016zM512 640q18.016 0 30.496 12.512t12.512 30.016-12.512 30.016-30.496 12.512-30.496-12.512-12.512-30.016 12.512-30.016T512 640z m-171.008 0q18.016 0 30.496 12.512t12.512 30.016-12.512 30.016-30.016 12.512-30.016-12.512-12.512-30.016 12.512-30.016 29.504-12.512z m342.016 0q16.992 0 29.504 12.512t12.512 30.016-12.512 30.016-30.016 12.512-30.016-12.512-12.512-30.016 12.512-30.016 30.496-12.512z" ></path>',daoru:'<path d="M764.9 64H225.4l1.4 224.2 64-0.4-1-159.8h383.6v224H896v544H289.8l1-159.8-64-0.4-1.4 224.2H960V277.7L764.9 64z m-27.6 64.7L882.8 288H737.3V128.7z" fill="currentColor" ></path><path d="M356.5 224h255.9v64H356.5z" fill="#36c" ></path><path d="M576.4 416h255.9v64H576.4zM512.5 576h319.8v64H512.5zM384.5 736h447.8v64H384.5z" fill="currentColor" ></path><path d="M336.9 349H198.6l98.9 98.9H64v128.2h233.5L198.6 675h138.3l162.9-163z" fill="#36c" ></path>',daochu:'<path d="M764.9 64H225.4l1.4 224.2 64-0.4-1-159.8h383.6v224H896v544H289.8l1-159.8-64-0.4-1.4 224.2H960V277.7L764.9 64z m-27.6 64.7L882.8 288H737.3V128.7z" fill="currentColor" ></path><path d="M356.5 224h255.9v64H356.5z" fill="#36c" ></path><path d="M576.4 416h255.9v64H576.4zM512.5 576h319.8v64H512.5zM384.5 736h447.8v64H384.5z" fill="currentColor" ></path><path d="M226.8 349h138.3l-98.8 98.9h233.5v128.2H266.3l98.8 98.9H226.8L64 512z" fill="#36c" ></path>',zhidu:'<path d="M729.2 61.4H176.1c-60.8 0-110.6 50.2-110.6 111.5v668.9c0 61.3 49.8 111.5 110.6 111.5h221.3c16.6-16.7 16.6-39 0-55.7H176.1c-33.2 0-55.3-22.3-55.3-55.7v-669c0-33.4 22.1-55.7 55.3-55.7h553.1c33.2 0 55.3 22.3 55.3 55.7v189.5c16.6 22.3 38.7 22.3 55.3 0V172.9c0-61.3-49.8-111.5-110.6-111.5z" fill="currentColor" ></path><path d="M259.7 282.9h387.2c16.6 0 27.7 11.1 27.7 27.9 0 16.7-11.1 27.9-27.7 27.9H259.7c-16.6 0-27.7-11.1-27.7-27.9 0-16.8 11.1-27.9 27.7-27.9z m0 195.1h165.9c16.6 0 27.7 11.1 27.7 27.9 0 16.7-11.1 27.9-27.7 27.9H259.7c-16.6 0-27.7-11.1-27.7-27.9 0-16.8 11.1-27.9 27.7-27.9z m0 195.1h110.6c16.6 0 27.7 11.1 27.7 27.9s-11.1 27.9-27.7 27.9H259.7c-16.6 0-27.7-11.1-27.7-27.9s11.1-27.9 27.7-27.9zM708.6 903.4c-111.3-0.1-210.5-71.6-247.7-178.5a50.74 50.74 0 0 1 0-33.1c48.4-139.4 198.5-212.5 335.3-163.2 74.8 27 133.7 86.9 160.1 163.2 3.7 10.7 3.7 22.4 0 33.1-37.2 106.9-136.4 178.4-247.7 178.5z m0-353.7c-96.2 0.1-182 61.9-214.1 154.3-1 2.8-1 5.9 0 8.7C536.3 833.2 666 896.4 784.3 853.8c64.7-23.3 115.6-75.1 138.4-141.1 1-2.8 1-5.9 0-8.8-32.2-92.3-117.9-154.1-214.1-154.2z" fill="currentColor" ></path><path d="M708.6 801.7c-51.1 0-92.6-41.8-92.6-93.3s41.5-93.3 92.6-93.3c51.1 0 92.6 41.8 92.6 93.3-0.1 51.5-41.5 93.2-92.6 93.3z" fill="currentColor" ></path>',baocun:'<path d="M256 128H160a32 32 0 0 0-32 32v704a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V160a32 32 0 0 0-32-32h-96v320a64 64 0 0 1-64 64H320a64 64 0 0 1-64-64V128zM128 64h768a64 64 0 0 1 64 64v768a64 64 0 0 1-64 64H128a64 64 0 0 1-64-64V128a64 64 0 0 1 64-64z m192 64v288a32 32 0 0 0 32 32h320a32 32 0 0 0 32-32V128H320z m288 64a32 32 0 0 1 32 32v128a32 32 0 0 1-64 0V224a32 32 0 0 1 32-32z" ></path>',huifu:'<path d="M880 112H144a32 32 0 0 0-32 32v736a32 32 0 0 0 32 32h736a32 32 0 0 0 32-32V144a32 32 0 0 0-32-32z m-40 728H184V184h656v656zM304.768 523.968h50.752a6.784 6.784 0 0 0 6.784-6.784V438.272c0-19.648 15.872-35.584 35.52-35.584H603.52v53.44c0 5.696 6.464 8.768 10.88 5.248l109.12-85.696a6.784 6.784 0 0 0 0-10.688L614.4 279.296a6.72 6.72 0 0 0-10.88 5.312v53.376H397.696c-55.04 0-99.712 44.8-99.712 100.096v78.912c0 4.032 3.008 7.04 6.848 7.04z m-4.16 134.912l109.12 85.76c4.352 3.456 10.88 0.256 10.88-5.312v-53.44h205.696c55.04 0 99.712-44.8 99.712-100.096V506.88a6.784 6.784 0 0 0-6.784-6.784h-50.752a6.784 6.784 0 0 0-6.784 6.784v78.912a35.52 35.52 0 0 1-35.52 35.584H420.608v-53.376a6.72 6.72 0 0 0-10.88-5.312l-109.12 85.76a6.592 6.592 0 0 0 0 10.432z"></path>',jietu:'<path d="M856.85333333 233.49333333v557.12H167.14666667V233.49333333h689.70666666m53.12-53.12H114.02666667v663.25333334H909.86666667V180.37333333h0.10666666z" ></path><path d="M114.02666667 74.24v106.13333333H34.45333333v53.12H167.14666667V74.24zM909.97333333 949.76v-106.13333333h79.57333334v-53.12H856.85333333v159.25333333zM510.93333333 718.29333333H283.2c-8.32 0-21.76-3.09333333-24.85333333-8.32-3.09333333-5.22666667 2.02666667-17.6 6.18666666-24.85333333 27.94666667-42.45333333 56.96-84.90666667 84.90666667-127.36 9.28-13.44 18.66666667-14.50666667 33.17333333-8.32 47.57333333 22.82666667 96.32 45.54666667 144.96 68.37333333 13.44 6.18666667 29.97333333 2.02666667 38.29333334-10.34666666 25.92-40.42666667 52.8-79.68 80.74666666-119.04 5.22666667-7.25333333 14.50666667-18.66666667 21.76-18.66666667 8.32 0 14.50666667 13.44 17.6 21.76 25.92 64.21333333 50.77333333 129.38666667 75.62666667 193.6 10.34666667 26.88 6.18666667 33.17333333-24.85333333 33.17333333H510.93333333z m-83.84-317.86666666c0 31.04-26.88 55.89333333-58.02666666 54.82666666-31.04-1.06666667-54.82666667-24.85333333-54.82666667-54.82666666 0-31.04 25.92-55.89333333 58.02666667-54.82666667 28.90666667 0.96 54.82666667 25.81333333 54.82666666 54.82666667z" ></path>',shuxing:'<path d="M512 960c-246.784 0-448-201.216-448-448S265.216 64 512 64s448 201.216 448 448-201.216 448-448 448z m0-834.56c-212.992 0-386.56 173.568-386.56 386.56s173.568 386.56 386.56 386.56 386.56-173.568 386.56-386.56-173.568-386.56-386.56-386.56z" ></path><path d="M554.496 246.784c29.696 7.168 44.032 41.984 37.376 71.68-7.168 29.696-34.816 54.784-64.512 47.616-29.696-7.168-40.96-41.472-34.304-71.168 7.168-29.696 31.744-55.296 61.44-48.128zM427.008 466.432s89.6-78.336 124.416-62.976c23.552 6.144 10.752 112.128 7.168 126.464-1.024 12.8-21.504 174.08-16.384 181.248 7.168 26.624 15.36 5.632 40.448-15.36 0 0 58.88-39.936-4.096 43.008-52.224 55.808-102.912 48.64-110.592 6.656-6.144-31.744 18.944-223.744 25.088-266.752 2.048-14.336-15.872 0-15.872 0s-48.64 30.208-60.416 9.728c-3.072-5.632 1.536-14.336 10.24-22.016z" ></path>',quanxianpeizhi:'<path d="M160 512a314.24 314.24 0 0 0 156.8 266.88l195.2 133.76 195.2-135.36A313.92 313.92 0 0 0 864 512V265.6A681.6 681.6 0 0 1 512 160 682.56 682.56 0 0 1 160 265.6zM96 196.48q277.44 0 416-132.48 138.24 132.48 416 132.48v317.44a392.64 392.64 0 0 1-185.28 330.88L512 992l-230.72-147.2A392.64 392.64 0 0 1 96 513.92z" ></path><path d="M666.88 433.28a154.88 154.88 0 1 0-309.76 0 160 160 0 0 0 116.16 154.88v202.24h77.44v-39.68h38.72V672h-38.72v-83.2a157.44 157.44 0 0 0 116.16-154.88zM512 512a78.4 78.4 0 0 1-73.28-48.32 79.68 79.68 0 0 1 16.32-86.72 78.08 78.08 0 0 1 85.76-17.92 79.68 79.68 0 0 1 48.64 73.6A78.4 78.4 0 0 1 512 512z" ></path>',niantie:'<path d="M917.219556 277.105778h-108.714667V200.647111a72.817778 72.817778 0 0 0-72.760889-72.760889h-124.871111v-11.605333a53.361778 53.361778 0 0 0-53.248-53.248h-39.253333V55.751111c0-15.928889-13.084444-29.013333-29.013334-29.013333H404.935111c-15.928889 0-29.013333 13.084444-29.013333 29.013333v7.281778h-39.253334a53.361778 53.361778 0 0 0-53.248 53.248v11.605333H152.462222A72.817778 72.817778 0 0 0 79.758222 200.647111v610.133333A72.817778 72.817778 0 0 0 152.462222 883.484444H261.12v62.008889a72.817778 72.817778 0 0 0 72.760889 72.704h389.802667l266.24-266.126222V349.923556a72.817778 72.817778 0 0 0-72.760889-72.817778zM331.832889 116.280889c0-2.616889 2.275556-4.835556 4.892444-4.835556h220.728889c2.673778 0 4.892444 2.275556 4.892445 4.835556v74.353778c0 2.616889-2.275556 4.892444-4.835556 4.892444H336.725333a4.892444 4.892444 0 0 1-4.835555-4.892444V116.280889zM261.233778 349.923556v485.262222H152.462222a24.405333 24.405333 0 0 1-24.291555-24.291556V200.647111c0-13.368889 10.922667-24.291556 24.291555-24.291555h131.015111v14.279111c0 29.354667 23.893333 53.304889 53.248 53.304889h220.728889c29.411556 0 53.304889-23.893333 53.304889-53.304889V176.355556h124.928c13.368889 0 24.291556 10.922667 24.291556 24.291555V277.048889h-426.097778a72.817778 72.817778 0 0 0-72.704 72.817778z m476.16 586.24v-144.554667c0-13.368889 10.808889-24.234667 24.177778-24.234667h144.554666l-168.732444 168.789334z m204.231111-217.201778h-180.053333c-40.049778 0-72.590222 32.540444-72.590223 72.647111v178.232889H333.937778a24.405333 24.405333 0 0 1-24.348445-24.291556V349.923556c0-13.312 10.979556-24.291556 24.348445-24.291556h583.281778c13.368889 0 24.291556 10.979556 24.291555 24.291556v369.038222z" fill="currentColor" ></path><path d="M835.982222 476.387556h-435.768889a24.234667 24.234667 0 0 0 0 48.412444h435.768889a24.291556 24.291556 0 0 0 24.234667-24.177778 24.291556 24.291556 0 0 0-24.234667-24.234666z m-193.649778 135.566222H400.270222a24.234667 24.234667 0 0 0 0 48.412444h242.062222a24.291556 24.291556 0 0 0 24.177778-24.177778 24.291556 24.291556 0 0 0-24.177778-24.234666z" fill="currentColor" ></path>',jurassic_addForm:'<path d="M496.512 185.088H217.152v653.12h589.696V486.912H896v440.768H128v-832h368.512v89.408z m177.024 41.856V96h89.152v130.944h130.56v89.408h-130.56V447.36h-89.152V316.352h-130.56V226.944h130.56z"></path>',jiami:'<path d="M872.6016 391.2704h-112.64V326.9632a248.4736 248.4736 0 1 0-496.9472 0v64.3072h-112.64a30.72 30.72 0 0 0-30.72 30.72v486.912a30.72 30.72 0 0 0 30.72 30.72h722.2272a30.72 30.72 0 0 0 30.72-30.72v-486.912a30.72 30.72 0 0 0-30.72-30.72zM324.4544 326.9632a187.0336 187.0336 0 1 1 374.0672 0v63.8976H324.4544z m517.4272 551.2192H181.0944v-425.472h660.7872z" fill="currentColor" ></path><path d="M481.9456 715.8784v106.3936h61.44V716.8a102.7072 102.7072 0 1 0-61.44-1.1264z m32.5632-138.752a41.3696 41.3696 0 1 1-41.3184 41.3184 41.3696 41.3696 0 0 1 41.3184-41.3184z" fill="currentColor" ></path>',monifenxi:'<path d="M482.133333 874.666667v-106.666667H170.666667c-47.1296 0-85.333333-38.203733-85.333334-85.333333V170.666667c0-47.1296 38.203733-85.333333 85.333334-85.333334h682.666666c47.1296 0 85.333333 38.203733 85.333334 85.333334v512c0 47.1296-38.203733 85.333333-85.333334 85.333333h-307.2v106.666667h232.533334a32 32 0 1 1 0 64h-533.333334a32 32 0 1 1 0-64H482.133333z m64-170.666667h307.2a21.333333 21.333333 0 0 0 21.333334-21.333333V170.666667a21.333333 21.333333 0 0 0-21.333334-21.333334H170.666667a21.333333 21.333333 0 0 0-21.333334 21.333334v512a21.333333 21.333333 0 0 0 21.333334 21.333333h375.466666z m-172.8-170.666667a32 32 0 0 1-32-32v-149.333333a32 32 0 0 1 64 0v149.333333a32 32 0 0 1-32 32z m140.8 0a32 32 0 0 1-32-32v-106.666666a32 32 0 0 1 64 0v106.666666a32 32 0 0 1-32 32z m136.533334 0a32 32 0 0 1-32-32v-64a32 32 0 1 1 64 0v64a32 32 0 0 1-32 32z"></path>',zanting:'<path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="currentColor"/><path d="M400 320h80v384h-80zM544 320h80v384h-80z" fill="currentColor"/>',sn_brandLogo:'<path d="M0 0h1024v292.571429H0z" fill="#4185F4" p-id="11065"></path><path d="M0 365.714286h292.571429v292.571428H0z" fill="#A0C2F9" p-id="11066"></path><path d="M0 731.428571h292.571429v292.571429H0z" fill="#A0C2F9" p-id="11067"></path><path d="M365.714286 365.714286h292.571428v292.571428H365.714286zM365.714286 731.428571h292.571428v292.571429H365.714286z" fill="#A0C2F9" p-id="11068"></path><path d="M731.428571 365.714286h292.571429v292.571428h-292.571429z" fill="#A0C2F9" p-id="11069"></path><path d="M731.428571 731.428571h292.571429v292.571429h-292.571429z" fill="#4185F4" p-id="11070"></path>',ai_send:'<path fill="currentColor" d="m3.543 8.883 7.042-7.047a2 2 0 0 1 2.828 0l7.043 7.046a1 1 0 0 1 0 1.415l-.701.701a1 1 0 0 1-1.414 0L13.3 5.956v15.792a1 1 0 0 1-1 1h-.99a1 1 0 0 1-1-1V6.342l-4.654 4.656a1 1 0 0 1-1.414 0l-.7-.7a1 1 0 0 1 0-1.415"/>',ai_quickImport:'<path d="M801.391304 284.382609L550.4 0 299.408696 284.382609h161.391304v384.556521h186.434783V284.382609h154.156521z" fill="currentColor"/><path d="M1113.043478 712.347826l-199.791304-310.53913h-166.956522v75.130434h83.478261l151.373913 235.408696h-234.852174v102.4H366.747826V712.347826H131.895652l151.373913-235.408696h82.921739V401.808696H199.791304L0 712.347826v311.652174h1113.043478v-311.652174z" fill="currentColor"/>',sort_add:'<path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>',sort_remove:'<path d="M19 13H5v-2h14v2z" fill="currentColor"/>',sort_copy:'<path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" fill="currentColor"/>',sort_moveUp:'<path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"/>',sort_moveDown:'<path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z" fill="currentColor"/>',filter_sortAsc:'<path d="M4 6h9v2H4zM4 11h7v2H4zM4 16h5v2H4zM16 18V8.83l-2.59 2.58L12 10l5-5 5 5-1.41 1.41L18 8.83V18z" fill="currentColor"/>',filter_sortDesc:'<path d="M4 6h5v2H4zM4 11h7v2H4zM4 16h9v2H4zM18 6v9.17l2.59-2.58L22 14l-5 5-5-5 1.41-1.41L16 15.17V6z" fill="currentColor"/>'},on=1024,an=new Map;let sn=null,ln=null;function cn(t,e=""){const n=rn[t];return n?`<svg class="sn-svg ${e}" data-icon="${t}" viewBox="0 0 1024 1024" width="1em" height="1em">${function(t,e){if(an.has(t))return an.get(t);if(!(sn&&ln&&sn.isConnected||"undefined"!=typeof document&&document.body&&(sn=document.createElementNS("http://www.w3.org/2000/svg","svg"),sn.setAttribute("viewBox","0 0 1024 1024"),sn.setAttribute("width","0"),sn.setAttribute("height","0"),sn.style.position="absolute",sn.style.left="-99999px",sn.style.top="-99999px",sn.style.visibility="hidden",sn.style.pointerEvents="none",sn.style.overflow="hidden",ln=document.createElementNS("http://www.w3.org/2000/svg","g"),sn.appendChild(ln),document.body.appendChild(sn),1)))return e;ln.innerHTML=e;let n=null;try{n=ln.getBBox()}catch(n){return ln.innerHTML="",an.set(t,e),e}if(ln.innerHTML="",!n||n.width<=0||n.height<=0)return an.set(t,e),e;const i=Math.min(on/n.width,on/n.height),r=(on-n.width*i)/2-n.x*i,o=(on-n.height*i)/2-n.y*i,a=Math.abs(i-1)<1e-6&&Math.abs(r)<.001&&Math.abs(o)<.001?e:`<g transform="translate(${r.toFixed(3)} ${o.toFixed(3)}) scale(${i.toFixed(6)})">${e}</g>`;return an.set(t,a),a}(t,n)}</svg>`:""}class hn{constructor(t,e={}){this.sheet=t,this.id=e.id??`Slicer_${Date.now()}`,this.name=e.name??this.id,this.caption=e.caption??e.fieldName??"",this.cacheId=e.cacheId,this.sourceType=e.sourceType??"table",this.sourceSheet=e.sourceSheet??t.name,this.sourceName=e.sourceName??null,this.sourceId=e.sourceId??null,this.fieldIndex=Number.isFinite(e.fieldIndex)?e.fieldIndex:0,this.fieldName=e.fieldName??"",this.columns=Math.max(1,Number(e.columns)||1),this.buttonHeight=Math.max(18,Number(e.buttonHeight)||20),this.showHeader=!1!==e.showHeader,this.multiSelect=!!e.multiSelect,this.styleName=e.styleName??"SlicerStyleLight1",this.selectedKeys=new Set(e.selectedKeys||[]),this.Drawing=e.Drawing||e.drawing||null,this.$=t.SN,this.Drawing&&(this.Drawing.Slicer=this),this.ji=null,this.qi=null,this.Gi=null,this.Xi=null,this.Yi=null,this.Ji=null,this.Zi=null,this.Qi=null,this.tr=null,this.er=-1,this._t=null}get cache(){return this.$.zi?.get(this.cacheId)||null}toggleSelection(t,e=!1){const n=this.cache;if(!n)return;const i=n.getItems().map(t=>t.key);e?this.selectedKeys.has(t)?this.selectedKeys.delete(t):this.selectedKeys.add(t):(this.selectedKeys.clear(),this.selectedKeys.add(t)),this.selectedKeys.size!==i.length&&0!==this.selectedKeys.size||this.selectedKeys.clear(),this.nr(),this.applyFilter()}clearSelection(t=!1){this.selectedKeys.clear(),this.nr(),t&&this.applyFilter()}applyFilter(){"pivot"===this.sourceType?this.ir():this.rr()}toJSON(){return{id:this.id,name:this.name,caption:this.caption,cacheId:this.cacheId,sourceType:this.sourceType,sourceSheet:this.sourceSheet,sourceName:this.sourceName,sourceId:this.sourceId,fieldIndex:this.fieldIndex,fieldName:this.fieldName,columns:this.columns,buttonHeight:this.buttonHeight,showHeader:this.showHeader,multiSelect:this.multiSelect,styleName:this.styleName,selectedKeys:Array.from(this.selectedKeys)}}sr(t){if(this.qi)return;if(this.ji=t,!t?.slicersCon)return;const e=document.createElement("div");e.className="sn-slicer",e.dataset.slicerId=this.id,e.innerHTML=`\n            <div class="sn-slicer-header">\n                <div class="sn-slicer-title"></div>\n                <div class="sn-slicer-actions">\n                    <button class="sn-slicer-btn" data-action="multi" title="Multi-select">\n                        ${cn("plus")}\n                    </button>\n                    <button class="sn-slicer-btn" data-action="clear" title="Clear filter">\n                        ${cn("clear")}\n                    </button>\n                    <button class="sn-slicer-btn" data-action="delete" title="Delete slicer">\n                        ${cn("yichu")}\n                    </button>\n                </div>\n            </div>\n            <div class="sn-slicer-body sn-scrollbar">\n                <div class="sn-slicer-items"></div>\n            </div>\n            <div class="sn-slicer-resize"></div>\n        `;const n=e.querySelector(".sn-slicer-title");n&&(n.textContent=this.caption||this.fieldName||this.name),this.Yi=e.querySelector(".sn-slicer-header"),this.Xi=e.querySelector(".sn-slicer-body"),this.Gi=e.querySelector(".sn-slicer-items"),this.Ji=e.querySelector('[data-action="multi"]'),this.Zi=e.querySelector('[data-action="clear"]'),this.Qi=e.querySelector('[data-action="delete"]'),this.tr=e.querySelector(".sn-slicer-resize"),this.qi=e,this.ar(),t.slicersCon.appendChild(e),this.lr()}render(t,e,n,i,r,o=!0){if(this.sr(t),!this.qi)return;if(!o)return void(this.qi.style.display="none");this.qi.style.display="block",this._t={x:e,y:n,w:i,h:r},this.cr();const a=this.showHeader;this.Yi&&(this.Yi.style.display=a?"flex":"none"),this.Xi&&(this.Xi.style.top=a?`${this.Yi?.offsetHeight||26}px`:"0");const s=this.cache;s&&(s.version!==this.er?(this.hr(s.getItems()),this.er=s.version):this.nr())}ar(){this.qi&&(this.qi.addEventListener("mousedown",t=>t.stopPropagation()),this.Xi?.addEventListener("wheel",t=>t.stopPropagation(),{passive:!0}),this.Gi?.addEventListener("click",t=>{const e=t.target.closest(".sn-slicer-item");if(!e)return;const n=e.dataset.key;if(!n)return;const i=this.multiSelect||t.ctrlKey;this.toggleSelection(n,i)}),this.Ji?.addEventListener("click",t=>{t.stopPropagation(),this.multiSelect=!this.multiSelect,this.lr()}),this.Zi?.addEventListener("click",t=>{t.stopPropagation(),this.clearSelection(!0)}),this.Qi?.addEventListener("click",t=>{t.stopPropagation(),this.sheet?.Slicer?.remove(this.id),this.ji?.r("s")}),this.Yi?.addEventListener("mousedown",t=>{0===t.button&&this.ur(t)}),this.tr?.addEventListener("mousedown",t=>{0===t.button&&this.dr(t)}))}lr(){this.Ji&&this.Ji.classList.toggle("sn-active",this.multiSelect)}ur(t){if(!this.ji||!this._t)return;t.preventDefault();const e=this.ji,n=e.handleLayer.getBoundingClientRect(),i=e.activeSheet?.zoom??1,r=(t.clientX-n.left)/i,o=(t.clientY-n.top)/i,{x:a,y:s,w:l,h:c}=this._t,h=r-a,u=o-s,d=this.sheet,f=t=>{const e=(t.clientX-n.left)/i,r=(t.clientY-n.top)/i,o=Math.max(d.indexWidth,e-h),a=Math.max(d.headHeight,r-u);this._t={x:o,y:a,w:l,h:c},this.Drawing&&(this.Drawing.moving=!0,this.Drawing.position={x:o,y:a,w:l,h:c}),this.cr()},p=()=>{window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",p),this.Drawing&&(this.Drawing.moving=!1),this.pr()};window.addEventListener("mousemove",f),window.addEventListener("mouseup",p,{once:!0})}dr(t){if(!this.ji||!this._t)return;t.preventDefault();const e=this.ji,n=e.handleLayer.getBoundingClientRect(),{x:i,y:r,w:o,h:a}=this._t,s=e.activeSheet?.zoom??1,l=t.clientX,c=t.clientY,h=t=>{const e=(t.clientX-l)/s,n=(t.clientY-c)/s,h=Math.max(140,o+e),u=Math.max(160,a+n);this._t={x:i,y:r,w:h,h:u},this.Drawing&&(this.Drawing.moving=!0,this.Drawing.position={x:i,y:r,w:h,h:u}),this.cr()},u=()=>{window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",u),this.Drawing&&(this.Drawing.moving=!1),this.pr(n)};window.addEventListener("mousemove",h),window.addEventListener("mouseup",u,{once:!0})}pr(){if(!this.ji||!this.Drawing||!this._t)return;const{x:t,y:e,w:n,h:i}=this._t,r=this.ji.getOffset(t,e,n,i);r?.s&&(this.Drawing.startCell={r:r.s.r,c:r.s.c},this.Drawing.offsetX=r.s.offsetX,this.Drawing.offsetY=r.s.offsetY,this.Drawing.width=n,this.Drawing.height=i,this.Drawing.position={x:t,y:e,w:n,h:i},this.ji.r("s"))}cr(){if(!this.qi||!this._t)return;const{x:t,y:e,w:n,h:i}=this._t,r=this.sheet?.indexWidth??0,o=this.sheet?.headHeight??0,a=this.ji?.activeSheet?.zoom??1;this.qi.style.left=(t-r)*a+"px",this.qi.style.top=(e-o)*a+"px",this.qi.style.width=n*a+"px",this.qi.style.height=i*a+"px"}hr(t=[]){if(!this.Gi)return;this.Gi.innerHTML="";const e=document.createDocumentFragment();t.forEach(t=>{const n=document.createElement("button");n.type="button",n.className="sn-slicer-item",n.dataset.key=t.key,n.textContent=t.text,n.style.height=`${this.buttonHeight}px`,e.appendChild(n)}),this.Gi.appendChild(e),this.Gi.style.gridTemplateColumns=`repeat(${this.columns}, minmax(0, 1fr))`,this.nr()}nr(){if(!this.Gi)return;const t=Array.from(this.Gi.querySelectorAll(".sn-slicer-item")),e=this.selectedKeys,n=e.size>0;t.forEach(t=>{const i=t.dataset.key,r=e.has(i);t.classList.toggle("sn-selected",r),t.classList.toggle("sn-unselected",n&&!r)})}rr(){const t=this.cache,e=t?.getSourceTable();if(!e||!e.range)return;e.autoFilterEnabled||(e.autoFilterEnabled=!0);const n=t.getItems(),i=e.range.s.c+t.fieldIndex,r=e.sheet.AutoFilter.getTableScopeId(e.id);if(0===this.selectedKeys.size||this.selectedKeys.size===n.length)return void e.sheet.AutoFilter.clearColumnFilter(i,r);const o=[];this.selectedKeys.forEach(e=>{const n=t.getItemMap().get(e);n&&o.push(n.value)}),e.sheet.AutoFilter.setColumnFilter(i,{type:"values",values:o},r)}ir(){const t=this.cache,e=t?.getSourcePivotTable();if(!e)return;const n=t.fieldIndex,i=e.pivotFields?.[n];if(!i)return;const r=e.cache?.fields?.[n]?.sharedItems?.values??[];if(0===this.selectedKeys.size||this.selectedKeys.size===r.length)return e.clearFieldFilter(n),e.calculate(),void e.render();const o=new Set;this.selectedKeys.forEach(e=>{const n=t.getItemMap().get(e);n&&Number.isFinite(n.sharedIndex)&&o.add(n.sharedIndex)});const a={};i.items.forEach((t,e)=>{if(t.t&&"default"!==t.t&&"blank"!==t.t)return;const n=t.x;a[e]=!o.has(n)}),e.setItemsHidden(n,a),e.calculate(),e.render()}}function un(t){return t?Array.isArray(t)?t:[t]:[]}function dn(t,e=0){const n=Number(t);return Number.isFinite(n)?n:e}function fn(t,e,n,i,r,o){if(!Number.isInteger(e)||!Number.isInteger(n)||n<e)return 0;const a="row"===o?e=>t.getRow(e).height:e=>t.getCol(e).width;let s=0;for(let c=e;c<=n;c++)s+=a(c);const l=s-i-(a(n)-r);return l>0?l:0}class pn{constructor(t){this.sheet=t,this.map=new Map,this.Kn=[]}get size(){return this.map.size}add(t){const e=this.sheet.SN;if(e.Event.hasListeners("beforeSlicerAdd")&&e.Event.emit("beforeSlicerAdd",{sheet:this.sheet,config:t}).canceled)return null;const n=this.vr(t);n.markDirty();const i=this.br(),{width:r,height:o}=this.gr(),a=t.startCell??this.sheet.activeCell,s=this.sheet.Drawing.Wn({type:"slicer",startCell:a,offsetX:t.offsetX||0,offsetY:t.offsetY||0,width:t.width||r,height:t.height||o,anchorType:t.anchorType||"oneCell"}),l=new hn(this.sheet,{id:i,name:t.name||i,caption:t.caption||t.fieldName,cacheId:n.cacheId,sourceType:t.sourceType||"table",sourceSheet:t.sourceSheet||this.sheet.name,sourceName:t.sourceName,sourceId:t.sourceId,fieldIndex:t.fieldIndex,fieldName:t.fieldName,columns:t.columns,buttonHeight:t.buttonHeight,showHeader:t.showHeader,multiSelect:t.multiSelect,styleName:t.styleName,drawing:s});return this.map.set(l.id,l),this.Kn.push(l),e.Event.hasListeners("afterSlicerAdd")&&e.Event.emit("afterSlicerAdd",{sheet:this.sheet,config:t,slicer:l}),l}yr(t){this.map.set(t.id,t),this.Kn.push(t)}remove(t){const e=this.map.get(t);if(!e)return;const n=this.sheet.SN;if(n.Event.hasListeners("beforeSlicerRemove")&&n.Event.emit("beforeSlicerRemove",{sheet:this.sheet,slicer:e,id:t}).canceled)return;e.Drawing&&this.sheet.Drawing.remove(e.Drawing.id),e.qi&&(e.qi.remove(),e.qi=null),this.map.delete(t);const i=this.Kn.indexOf(e);i>-1&&this.Kn.splice(i,1),n.Event.hasListeners("afterSlicerRemove")&&n.Event.emit("afterSlicerRemove",{sheet:this.sheet,slicer:e,id:t})}get(t){return this.map.get(t)||null}getAll(){return this.Kn}forEach(t){this.Kn.forEach(t)}br(){const t=this.sheet.SN;return t.wr||(t.wr=1),"Slicer_"+t.wr++}gr(){const t=this.sheet.defaultColWidth||70,e=this.sheet.defaultRowHeight||20;return{width:Math.round(2.6*t),height:Math.round(11*e)}}vr(t){const e=this.sheet.SN;e.zi||(e.zi=new Map);const n=Array.from(e.zi.values()).find(e=>e.sourceType===t.sourceType&&e.sourceSheet===(t.sourceSheet||this.sheet.name)&&e.sourceName===t.sourceName&&e.fieldIndex===t.fieldIndex);if(n)return n;const i=new nn(e,{sourceType:t.sourceType||"table",sourceSheet:t.sourceSheet||this.sheet.name,sourceName:t.sourceName,sourceId:t.sourceId,fieldIndex:t.fieldIndex,fieldName:t.fieldName});return e.zi.set(i.cacheId,i),i}}function mn(t){const e=t?.defaultColWidth||70,n=t?.defaultRowHeight||20;return{width:Math.round(2.6*e),height:Math.round(11*n)}}function gn(t,e){const n=t.defaultRowHeight||20;return Math.max(1,Math.ceil((e+10)/n))}class vn{constructor(t={}){this.name=t.name??"",this.axis=t.axis??null,this.dataField=t.dataField??!1,this.showAll=t.showAll??!1,this.numFmtId=t.numFmtId??0,this.sortType=t.sortType??"manual",this.subtotalTop=t.subtotalTop??!0,this.showDropDowns=t.showDropDowns??!0,this.defaultSubtotal=t.defaultSubtotal??!0,this.compact=t.compact??!0,this.outline=t.outline??!0,this.repeatItemLabels=t.repeatItemLabels??!1,this.insertBlankRow=t.insertBlankRow??!1,this.items=[],this.sharedItems=t.sharedItems??null}addItem(t){this.items.push({x:t.x??this.items.length,t:t.t??"default",h:t.h??void 0,m:t.m??void 0,s:t.s??void 0,sd:t.sd??void 0})}getVisibleItems(){return this.items.filter(t=>!t.h)}getHiddenItems(){return this.items.filter(t=>t.h)}setItemHidden(t,e){this.items[t]&&(this.items[t].h=e?"1":void 0)}clearFilter(){this.items.forEach(t=>{delete t.h})}static fromXml(t){const e=new vn({axis:t._$axis??null,dataField:"1"===t._$dataField,showAll:"1"===t._$showAll,numFmtId:Number(t._$numFmtId??0),sortType:t._$sortType??"manual",subtotalTop:"0"!==t._$subtotalTop,showDropDowns:"0"!==t._$showDropDowns,defaultSubtotal:"0"!==t._$defaultSubtotal,compact:"0"!==t._$compact,outline:"0"!==t._$outline,repeatItemLabels:"1"===t._$repeatItemLabels,insertBlankRow:"1"===t._$insertBlankRow});if(t.items){const n=Array.isArray(t.items.item)?t.items.item:[t.items.item];e.items=n.filter(Boolean).map(t=>({x:void 0!==t._$x?Number(t._$x):void 0,t:t._$t??"default",h:"1"===t._$h?"1":void 0,m:"1"===t._$m?"1":void 0,s:"1"===t._$s?"1":void 0,sd:"1"===t._$sd?"1":void 0}))}return e}toXml(){const t={"_$showAll":this.showAll?"1":"0"};if(this.axis&&(t._$axis=this.axis),this.dataField&&(t._$dataField="1"),this.numFmtId&&(t._$numFmtId=String(this.numFmtId)),this.defaultSubtotal||(t._$defaultSubtotal="0"),this.compact||(t._$compact="0"),this.outline||(t._$outline="0"),this.subtotalTop||(t._$subtotalTop="0"),this.showDropDowns||(t._$showDropDowns="0"),this.repeatItemLabels&&(t._$repeatItemLabels="1"),this.insertBlankRow&&(t._$insertBlankRow="1"),"manual"!==this.sortType&&(t._$sortType=this.sortType),this.items&&this.items.length>0){const e=this.items.map(t=>{const e={};return void 0!==t.x&&(e._$x=String(t.x)),!t.t||"default"===t.t&&void 0!==t.x||(e._$t=t.t),t.h&&(e._$h="1"),t.m&&(e._$m="1"),t.s&&(e._$s="1"),t.sd&&(e._$sd="1"),e});t.items={"_$count":String(this.items.length),"item":e}}return t}clone(){const t=new vn({name:this.name,axis:this.axis,dataField:this.dataField,showAll:this.showAll,numFmtId:this.numFmtId,sortType:this.sortType,subtotalTop:this.subtotalTop,showDropDowns:this.showDropDowns,defaultSubtotal:this.defaultSubtotal,compact:this.compact,outline:this.outline,repeatItemLabels:this.repeatItemLabels,insertBlankRow:this.insertBlankRow,sharedItems:this.sharedItems?{...this.sharedItems,values:[...this.sharedItems.values]}:null});return t.items=this.items.map(t=>({...t})),t}}function yn(t){return null==t?[]:Array.isArray(t)?t:[t]}function bn(t,e,n="ascending"){const i="descending"===n;if(t===e)return 0;if(null==t)return i?-1:1;if(null==e)return i?1:-1;let r;return r="number"==typeof t&&"number"==typeof e?t-e:t instanceof Date&&e instanceof Date?t.getTime()-e.getTime():String(t).localeCompare(String(e),"zh-CN"),i?-r:r}function xn(t){const e=t.match(/^([A-Z]+)(\d+)$/i);if(!e)return null;const n=e[1].toUpperCase(),i=parseInt(e[2],10)-1;let r=0;for(let o=0;o<n.length;o++)r=26*r+(n.charCodeAt(o)-64);return r--,{r:i,c:r}}function wn(t){let e=t.c+1,n="";for(;e>0;){const t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-1)/26)}return`${n}${t.r+1}`}function Sn(t){const e=t.split(":");if(1===e.length){const t=xn(e[0]);return{s:t,e:t}}return{s:xn(e[0]),e:xn(e[1])}}function Cn(t){return`${wn(t.s)}:${wn(t.e)}`}function Tn(t,e=null){return e?.t?e.t("pivot.naming.defaultPivotTable",{index:t}):`PivotTable${t}`}class $n{constructor(t={}){this.name=t.name??"",this.fld=t.fld??0,this.subtotal=t.subtotal??"sum",this.showDataAs=t.showDataAs??"normal",this.baseField=t.baseField??-1,this.baseItem=t.baseItem??0,this.numFmtId=t.numFmtId??0}static SUBTOTAL_MAP={"sum":{labelKey:"pivot.dataField.subtotal.sum",fn:t=>t.reduce((t,e)=>t+("number"==typeof e?e:0),0)},"count":{labelKey:"pivot.dataField.subtotal.count",fn:t=>t.length},"average":{labelKey:"pivot.dataField.subtotal.average",fn:t=>{const e=t.filter(t=>"number"==typeof t);return e.length?e.reduce((t,e)=>t+e,0)/e.length:0}},"max":{labelKey:"pivot.dataField.subtotal.max",fn:t=>{const e=t.filter(t=>"number"==typeof t);return e.length?Math.max(...e):0}},"min":{labelKey:"pivot.dataField.subtotal.min",fn:t=>{const e=t.filter(t=>"number"==typeof t);return e.length?Math.min(...e):0}},"product":{labelKey:"pivot.dataField.subtotal.product",fn:t=>{const e=t.filter(t=>"number"==typeof t);return e.length?e.reduce((t,e)=>t*e,1):0}},"countNums":{labelKey:"pivot.dataField.subtotal.countNums",fn:t=>t.filter(t=>"number"==typeof t).length},"stdDev":{labelKey:"pivot.dataField.subtotal.stdDev",fn:t=>{const e=t.filter(t=>"number"==typeof t);if(e.length<2)return 0;const n=e.reduce((t,e)=>t+e,0)/e.length,i=e.reduce((t,e)=>t+Math.pow(e-n,2),0)/(e.length-1);return Math.sqrt(i)}},"stdDevp":{labelKey:"pivot.dataField.subtotal.stdDevp",fn:t=>{const e=t.filter(t=>"number"==typeof t);if(e.length<1)return 0;const n=e.reduce((t,e)=>t+e,0)/e.length,i=e.reduce((t,e)=>t+Math.pow(e-n,2),0)/e.length;return Math.sqrt(i)}},"var":{labelKey:"pivot.dataField.subtotal.var",fn:t=>{const e=t.filter(t=>"number"==typeof t);if(e.length<2)return 0;const n=e.reduce((t,e)=>t+e,0)/e.length;return e.reduce((t,e)=>t+Math.pow(e-n,2),0)/(e.length-1)}},"varp":{labelKey:"pivot.dataField.subtotal.varp",fn:t=>{const e=t.filter(t=>"number"==typeof t);if(e.length<1)return 0;const n=e.reduce((t,e)=>t+e,0)/e.length;return e.reduce((t,e)=>t+Math.pow(e-n,2),0)/e.length}}};static SHOW_DATA_AS_MAP={"normal":{labelKey:"pivot.dataField.showAs.normal"},"percentOfTotal":{labelKey:"pivot.dataField.showAs.percentOfTotal"},"percentOfRow":{labelKey:"pivot.dataField.showAs.percentOfRow"},"percentOfCol":{labelKey:"pivot.dataField.showAs.percentOfCol"},"difference":{labelKey:"pivot.dataField.showAs.difference"},"percentDiff":{labelKey:"pivot.dataField.showAs.percentDiff"},"runningTotal":{labelKey:"pivot.dataField.showAs.runningTotal"},"percentOfParentRow":{labelKey:"pivot.dataField.showAs.percentOfParentRow"},"percentOfParentCol":{labelKey:"pivot.dataField.showAs.percentOfParentCol"},"index":{labelKey:"pivot.dataField.showAs.index"}};calculate(t){const e=$n.SUBTOTAL_MAP[this.subtotal]?.fn;return e?e(t):0}getDefaultName(t,e=null){return function(t,e,n=null){const i=n?.t?n.t({"sum":"pivot.naming.subtotalItem.sum","count":"pivot.naming.subtotalItem.count","average":"pivot.naming.subtotalItem.average","max":"pivot.naming.subtotalItem.max","min":"pivot.naming.subtotalItem.min","product":"pivot.naming.subtotalItem.product","countNums":"pivot.naming.subtotalItem.countNums","stdDev":"pivot.naming.subtotalItem.stdDev","stdDevp":"pivot.naming.subtotalItem.stdDevp","var":"pivot.naming.subtotalItem.var","varp":"pivot.naming.subtotalItem.varp"}[t]||"pivot.naming.subtotalItem.sum"):{"sum":"Sum","count":"Count","average":"Average","max":"Max","min":"Min","product":"Product","countNums":"Count Numbers","stdDev":"StdDev","stdDevp":"StdDevp","var":"Var","varp":"Varp"}[t]??"Sum";return n?.t?n.t("pivot.naming.defaultDataFieldPattern",{subtotal:i,fieldName:e}):`${i}:${e}`}(this.subtotal,t,e)}static fromXml(t){return new $n({name:t._$name??"",fld:Number(t._$fld??0),subtotal:t._$subtotal??"sum",showDataAs:t._$showDataAs??"normal",baseField:void 0!==t._$baseField?Number(t._$baseField):-1,baseItem:void 0!==t._$baseItem?Number(t._$baseItem):0,numFmtId:Number(t._$numFmtId??0)})}toXml(){const t={"_$fld":String(this.fld)};return this.name&&(t._$name=this.name),"sum"!==this.subtotal&&(t._$subtotal=this.subtotal),"normal"!==this.showDataAs&&(t._$showDataAs=this.showDataAs,Number.isFinite(this.baseField)&&-1!==this.baseField&&(t._$baseField=String(this.baseField)),Number.isFinite(this.baseItem)&&0!==this.baseItem&&(t._$baseItem=String(this.baseItem))),this.numFmtId&&(t._$numFmtId=String(this.numFmtId)),t}clone(){return new $n({name:this.name,fld:this.fld,subtotal:this.subtotal,showDataAs:this.showDataAs,baseField:this.baseField,baseItem:this.baseItem,numFmtId:this.numFmtId})}}class Mn{constructor(t,e={}){this.cacheId=e.cacheId??this.Fi(t),this.sourceType=e.sourceType??"worksheet",this.sourceRef=e.sourceRef??null,this.sourceSheet=e.sourceSheet??null,this.sourceRange=e.sourceRange??null,this.fields=[],this.records=[],this.recordCount=0,this.refreshedBy=e.refreshedBy??"",this.refreshedDate=e.refreshedDate??null,this.createdVersion=e.createdVersion??7,this.refreshedVersion=e.refreshedVersion??8,this.refreshOnLoad=e.refreshOnLoad??!1,this.$=t,this.$r=e.rId??"rId1"}Fi(t=this.$){const e=t?.Mr?Array.from(t.Mr.keys()):[];let n=0;return e.forEach(t=>{t>n&&(n=t)}),n+1}buildFromRange(t,e){this.sourceType="worksheet",this.sourceSheet=t.name;const n="string"==typeof e?t?.rangeStrToNum?t.rangeStrToNum(e):Sn(e):e;if(!n?.s||!n?.e)throw new Error("Invalid source range");this.sourceRange=n,this.sourceRef=Cn(n);const i=n.s.r,r=n.e.r,o=n.s.c,a=n.e.c,s=i;this.fields=[];for(let l=o;l<=a;l++){const e=t.getCell(s,l),n=e.calcVal??e.editVal??"字段"+(l-o+1),a=new vn({name:String(n),numFmtId:0}),c=new Map;let h=!1,u=!1,d=!1,f=!1,p=1/0,m=-1/0,g=!0;for(let o=i+1;o<=r;o++){const e=t.getCell(o,l),n=e.calcVal??e.editVal;null==n||""===n?(f=!0,c.set("__BLANK__",{type:"m",value:null})):"number"==typeof n?(h=!0,Number.isInteger(n)||(g=!1),n<p&&(p=n),n>m&&(m=n),c.set(n,{type:"n",value:n})):n instanceof Date?(d=!0,c.set(n.toISOString(),{type:"d",value:n})):(u=!0,c.set(String(n),{type:"s",value:String(n)}))}a.sharedItems={containsString:u,containsNumber:h,containsInteger:h&&g,containsBlank:f,containsDate:d,minValue:h?p:void 0,maxValue:h?m:void 0,count:c.size,values:[]};let v=0;for(const[t,i]of c)a.sharedItems.values.push({type:i.type,value:i.value,index:v++});this.fields.push(a)}this.records=[];for(let l=i+1;l<=r;l++){const e=[];for(let n=o;n<=a;n++){const i=t.getCell(l,n),r=i.calcVal??i.editVal;e.push(""===r?null:r)}this.records.push(e)}this.recordCount=this.records.length}refresh(){if("worksheet"!==this.sourceType||!this.sourceSheet)return;const t=this.$.getSheet(this.sourceSheet);if(t){if(t.initialized||"function"!=typeof t.J||t.J(),this.sourceRange)this.buildFromRange(t,this.sourceRange);else if("string"==typeof this.sourceRef&&this.sourceRef.includes(":")){const e=this.sourceRef.includes("!")?this.sourceRef.split("!").pop():this.sourceRef,n=t.rangeStrToNum(e.replace(/\$/g,""));this.buildFromRange(t,n)}this.refreshedDate=Date.now()/864e5+25569}}getFieldUniqueValues(t){const e=this.fields[t];return e&&e.sharedItems?e.sharedItems.values.map(t=>t.value):[]}findValueIndex(t,e){const n=this.fields[t];if(!n||!n.sharedItems)return-1;if(null==e||""===e){const t=n.sharedItems.values.find(t=>"m"===t.type);return t?t.index:-1}const i=n.sharedItems.values.find(t=>t.value===e);return i?i.index:-1}static fromXml(t,e,n){const i=new Mn(t,{refreshOnLoad:"1"===e._$refreshOnLoad,refreshedBy:e._$refreshedBy??"",refreshedDate:e._$refreshedDate?Number(e._$refreshedDate):null,createdVersion:Number(e._$createdVersion??7),refreshedVersion:Number(e._$refreshedVersion??8),rId:e._$r_id??e["_$r:id"]??"rId1"});i.recordCount=Number(e._$recordCount??0);const r=e.cacheSource;if(r&&(i.sourceType=r._$type??"worksheet",r.worksheetSource)){const t=r.worksheetSource;i.sourceRef=t._$name??t._$ref,i.sourceSheet=t._$sheet;const e=t._$ref;if("string"==typeof e&&e.includes(":")){const t=e.includes("!")?e.split("!").pop():e;try{i.sourceRange=Sn(t.replace(/\$/g,""))}catch{i.sourceRange=null}}}const o=yn(e.cacheFields?.cacheField);if(i.fields=o.map((t,e)=>{const n=new vn({name:t._$name??"Field"+(e+1),numFmtId:Number(t._$numFmtId??0)});if(void 0!==t.sharedItems){const e="string"==typeof t.sharedItems?{}:t.sharedItems??{},r=[];["s","n","d","b","m"].forEach(t=>{yn(e[t]).forEach(e=>{r.push({type:t,value:i.Cr(t,e,n)})})}),n.sharedItems={containsString:"0"!==e._$containsString,containsSemiMixedTypes:"1"===e._$containsSemiMixedTypes,containsNumber:"1"===e._$containsNumber,containsInteger:"1"===e._$containsInteger,containsBlank:"1"===e._$containsBlank,containsDate:"1"===e._$containsDate,containsNonDate:"0"!==e._$containsNonDate,minValue:void 0!==e._$minValue?parseFloat(e._$minValue):void 0,maxValue:void 0!==e._$maxValue?parseFloat(e._$maxValue):void 0,count:Number(e._$count??0),values:r.map((t,e)=>({type:t.type,value:t.value,index:e}))}}return n}),n){i.recordCount=Number(n._$count??i.recordCount??0);const t=yn(n.r);i.records=t.map(t=>i.Sr(t,i.fields))}else i.records=[];return i.Rr(),i.recordCount||(i.recordCount=i.records.length),i}Sr(t,e){const n=e.length,i=new Array(n).fill(null),r={x:[...yn(t.x)],n:[...yn(t.n)],s:[...yn(t.s)],d:[...yn(t.d)],b:[...yn(t.b)],m:[...yn(t.m)]};for(let o=0;o<n;o++){const t=e[o];let n=this.Ar(t).find(t=>r[t]?.length>0);if(n||(n=this.kr(r)),!n)break;const a=r[n].shift();i[o]=this.Cr(n,a,t)}return i}Ar(t){const e=[],n=t?.sharedItems;return n?.values?.length>0&&e.push("x"),n?(n.containsNumber&&e.push("n"),n.containsDate&&!n.containsNonDate&&e.push("d"),(n.containsString||!n.containsNumber&&!n.containsDate)&&e.push("s"),n.containsDate&&n.containsNonDate&&e.push("d","s","n"),n.containsBlank&&e.push("m")):e.push("s","n","b","d","m"),["n","s","d","b","m","x"].forEach(t=>{e.includes(t)||e.push(t)}),e}kr(t){return["n","s","x","d","b","m"].find(e=>t[e]?.length>0)??null}Cr(t,e,n){const i=e?._$v??("string"==typeof e?e:void 0);if("x"===t){const t=Number(i);if(!Number.isFinite(t))return null;const e=n?.sharedItems?.values?.[t];return e?.value??null}if("n"===t){const t=Number(i);return Number.isFinite(t)?t:null}if("s"===t)return i??"";if("d"===t){if(null==i||""===i)return null;const t=new Date(i);return Number.isNaN(t.getTime())?i:t}return"b"===t?"1"===i||1===i||!0===i||"0"!==i&&0!==i&&!1!==i&&null:null}Rr(){this.fields.forEach((t,e)=>{t?.sharedItems&&(t.sharedItems.values=yn(t.sharedItems.values).map((t,e)=>this.Tr(t,e)),0===t.sharedItems.values.length&&Number(t.sharedItems.count||0)>0&&(t.sharedItems.values=this.Nr(e)),this.Fr(t.sharedItems))})}Nr(t){const e=[],n=new Set;return this.records.forEach(i=>{const r=i[t],o=this._r(r),a=this.Er(o,r);n.has(a)||(n.add(a),e.push({type:o,value:"m"===o?null:r,index:e.length}))}),e}Tr(t,e){if(t&&"object"==typeof t&&!Array.isArray(t)){const n=Object.prototype.hasOwnProperty.call(t,"value")?t.value:t,i=t.type??this._r(n);return{type:i,value:"m"===i?null:n,index:Number.isFinite(Number(t.index))?Number(t.index):e}}const n=this._r(t);return{type:n,value:"m"===n?null:t,index:e}}_r(t){return null==t||""===t?"m":"number"==typeof t&&Number.isFinite(t)?"n":"boolean"==typeof t?"b":t instanceof Date&&!Number.isNaN(t.getTime())?"d":"s"}Fr(t){const e=yn(t.values).map((t,e)=>this.Tr(t,e));let n=!1,i=!1,r=!1,o=!1,a=!0,s=1/0,l=-1/0;e.forEach(t=>{if("m"!==t.type){if("n"===t.type){i=!0;const e=Number(t.value);return void(Number.isFinite(e)&&(Number.isInteger(e)||(a=!1),e<s&&(s=e),e>l&&(l=e)))}"d"!==t.type?"b"!==t.type&&(n=!0):r=!0}else o=!0}),t.values=e,t.count=Math.max(Number(t.count||0),e.length),t.containsString=Boolean(t.containsString||n),t.containsNumber=Boolean(t.containsNumber||i),t.containsDate=Boolean(t.containsDate||r),t.containsBlank=Boolean(t.containsBlank||o),t.containsSemiMixedTypes=Boolean(t.containsSemiMixedTypes),i&&(t.containsInteger=Boolean(t.containsInteger||a),(void 0===t.minValue||Number(t.minValue)>s)&&(t.minValue=s),(void 0===t.maxValue||Number(t.maxValue)<l)&&(t.maxValue=l)),!t.containsDate||t.containsString||t.containsNumber||(t.containsNonDate=!1)}Er(t,e){if("m"===t)return"m:";if("n"===t)return"n:"+Number(e);if("b"===t)return"b:"+(e?1:0);if("d"===t){const t=e instanceof Date?e.getTime():Date.parse(e);return"d:"+(Number.isFinite(t)?t:String(e))}return"s:"+String(e??"")}Ir(t,e){if(t===e)return!0;if("number"==typeof t&&"number"==typeof e)return Math.abs(t-e)<1e-10;const n=t instanceof Date?t.getTime():Date.parse(t),i=e instanceof Date?e.getTime():Date.parse(e);return Number.isFinite(n)&&Number.isFinite(i)?n===i:String(t??"")===String(e??"")}zr(t){const e=[],n=new Map;return yn(t?.values).forEach((t,i)=>{const r=this.Tr(t,i);if(!n.has(r.type)){const t={tag:r.type,items:[]};n.set(r.type,t),e.push(t)}n.get(r.type).items.push(r)}),e}Dr(t){const e=[];return this.zr(t).forEach(t=>{t.items.forEach(t=>e.push(t))}),e}toXmlDefinition(){const t=this.records.length||this.recordCount||0;this.recordCount=t;const e={"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$r:id":this.$r,"_$createdVersion":String(this.createdVersion),"_$refreshedVersion":String(this.refreshedVersion),"_$recordCount":String(t)};return this.refreshOnLoad&&(e._$refreshOnLoad="1"),this.refreshedBy&&(e._$refreshedBy=this.refreshedBy),this.refreshedDate&&(e._$refreshedDate=String(this.refreshedDate)),e.cacheSource={"_$type":this.sourceType},"worksheet"===this.sourceType&&(e.cacheSource.worksheetSource={},this.sourceRef&&(this.sourceRef.includes("!")||this.sourceRef.includes(":")?e.cacheSource.worksheetSource._$ref=this.sourceRef:e.cacheSource.worksheetSource._$name=this.sourceRef),this.sourceSheet&&(e.cacheSource.worksheetSource._$sheet=this.sourceSheet)),e.cacheFields={"_$count":String(this.fields.length),"cacheField":this.fields.map(t=>this.Lr(t))},{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"pivotCacheDefinition":e}}Lr(t){const e={"_$name":t.name,"_$numFmtId":String(t.numFmtId??0)};if(t.sharedItems){const n=t.sharedItems;this.Fr(n),e.sharedItems={},n.containsString||n.containsSemiMixedTypes||(e.sharedItems._$containsSemiMixedTypes="0"),n.containsString||(e.sharedItems._$containsString="0"),n.containsNumber&&(e.sharedItems._$containsNumber="1"),n.containsInteger&&(e.sharedItems._$containsInteger="1"),n.containsBlank&&(e.sharedItems._$containsBlank="1"),n.containsDate&&(e.sharedItems._$containsDate="1",!1===n.containsNonDate&&(e.sharedItems._$containsNonDate="0")),void 0!==n.minValue&&Number.isFinite(Number(n.minValue))&&(e.sharedItems._$minValue=String(n.minValue)),void 0!==n.maxValue&&Number.isFinite(Number(n.maxValue))&&(e.sharedItems._$maxValue=String(n.maxValue));const i=this.zr(n),r=Math.max(Number(n.count||0),n.values?.length||0);r>0&&(e.sharedItems._$count=String(r)),i.forEach(t=>{e.sharedItems[t.tag]=t.items.map(e=>"m"===t.tag?{}:"b"===t.tag?{"_$v":e.value?"1":"0"}:"d"===t.tag?{"_$v":e.value instanceof Date?e.value.toISOString():String(e.value)}:{"_$v":String(e.value??"")})})}return e}toXmlRecords(){this.recordCount=this.records.length;const t=this.records.map(t=>`<r>${this.Or(t)}</r>`).join("");return{Pr:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?><pivotCacheRecords xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="${this.recordCount}">${t}</pivotCacheRecords>`}}Or(t){let e="";return t.forEach((t,n)=>{const i=this.fields[n],r=i?.sharedItems?this.Dr(i.sharedItems):[];let o;if(null==t)o={tag:"m",value:{}};else if(r.length>0){const e=r.findIndex(e=>this.Ir(e.value,t));o=-1!==e?{tag:"x",value:{"_$v":String(e)}}:this.Vr(t)}else o=this.Vr(t);e+=this.Br(o)}),e}Br(t){if(!t||!t.tag)return"";if("m"===t.tag)return"<m/>";const e=t.value?._$v??"",n=this.Hr(e);return`<${t.tag} v="${n}"/>`}Hr(t){return String(t??"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;")}Ur(t){const e={};return t.forEach((t,n)=>{const i=this.fields[n],r=i?.sharedItems?this.Dr(i.sharedItems):[];let o;if(null==t)o={tag:"m",value:{}};else if(r.length>0){const e=r.findIndex(e=>this.Ir(e.value,t));o=-1!==e?{tag:"x",value:{"_$v":String(e)}}:this.Vr(t)}else o=this.Vr(t);e[o.tag]||(e[o.tag]=[]),e[o.tag].push(o.value)}),e}Vr(t){return null==t?{tag:"m",value:{}}:"number"==typeof t?{tag:"n",value:{"_$v":String(t)}}:"boolean"==typeof t?{tag:"b",value:{"_$v":t?"1":"0"}}:t instanceof Date?{tag:"d",value:{"_$v":t.toISOString()}}:{tag:"s",value:{"_$v":String(t)}}}}function An(t){const e=(t?.values||[]).map((t,e)=>({x:e,t:"m"===t.type?"blank":"default"}));return e.push({t:"default"}),e}function Nn(t,e){if("string"==typeof e)return e;const n=e??{r:2,c:0};return t.Utils.cellNumToStr?t.Utils.cellNumToStr(n):`${t.Utils.numToChar(n.c)}${n.r+1}`}function kn(t,e){return t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():"number"==typeof t&&"number"==typeof e?Math.abs(t-e)<1e-10:String(t??"")===String(e??""))}function Rn(t,e,n){return t?.name??e?.name??`Field${n+1}`}class _n{constructor(t,e={}){this.sheet=t,this.name=e.name??this.Kr(),this.cacheId=e.cacheId,this.$=t.SN,this.Wr=null,this.location={ref:e.ref??"A1",firstHeaderRow:e.firstHeaderRow??1,firstDataRow:e.firstDataRow??2,firstDataCol:e.firstDataCol??1},this.pivotFields=[],this.rowFields=[],this.colFields=[],this.dataFields=[],this.pageFields=[],this.rowGrandTotals=!1!==e.rowGrandTotals,this.colGrandTotals=!1!==e.colGrandTotals,this.showRowHeaders=!1!==e.showRowHeaders,this.showColHeaders=!1!==e.showColHeaders,this.compact=!1!==e.compact,this.compactData=!1!==e.compactData,this.outline=!1!==e.outline,this.outlineData=!1!==e.outlineData,this.showDrill=!1!==e.showDrill,this.gridDropZones=e.gridDropZones??!0,this.multipleFieldFilters=!1!==e.multipleFieldFilters,this.showPageFields=!1!==e.showPageFields,this.reportFilterLayout=e.reportFilterLayout??"vertical",this.reportFilterFieldsPerRow=Math.max(1,Number(e.reportFilterFieldsPerRow)||1),this.compactIndent=Number.isFinite(e.compactIndent)?Math.max(0,e.compactIndent):1,this.mergeLabelCells=e.mergeLabelCells??!1,this.errorValueEnabled=e.errorValueEnabled??!1,this.errorValueText=e.errorValueText??"",this.emptyValueEnabled=e.emptyValueEnabled??!1,this.emptyValueText=e.emptyValueText??"",this.enableValueCellEditing=e.enableValueCellEditing??!1,this.showContextTips=!1!==e.showContextTips,this.printDrillButtons=!1!==e.printDrillButtons,this.printRepeatRowLabels=e.printRepeatRowLabels??!1,this.printTitles=e.printTitles??!1,this.includeCalculatedItemsInTotals=!1!==e.includeCalculatedItemsInTotals,this.dataCaption=e.dataCaption??"值",this.grandTotalCaption=e.grandTotalCaption??"总计",this.pivotTableStyleName=e.pivotTableStyleName??"PivotStyleLight16",this.showRowStripes=e.showRowStripes??!1,this.showColStripes=e.showColStripes??!1,this.formats=[],this.jr=null,this.qr=null,this.Gr=null,this.Xr=null,this.Yr=null,this.Jr=null,this.Zr=null,this.Qr=null,this.ts=null,this.es=null,this.rs=null,this.ss=new Map,this.ls=new Set,this.cs=!0}get cache(){return this.Wr||void 0===this.cacheId||(this.Wr=this.$.Mr?.get(this.cacheId)),this.Wr}set cache(t){this.Wr=t,t&&(this.cacheId=t.cacheId)}Kr(){let t=1;for(;this.sheet.PivotTable?.get(Tn(t,this.$));)t++;return Tn(t,this.$)}addRowField(t,e=-1){const n=this.pivotFields[t];return!!n&&(this.hs(t),n.axis="axisRow",-1===e||e>=this.rowFields.length?this.rowFields.push(t):this.rowFields.splice(e,0,t),this.cs=!0,!0)}removeRowField(t){const e=this.rowFields.indexOf(t);return-1!==e&&(this.rowFields.splice(e,1),this.pivotFields[t].axis=null,this.cs=!0,!0)}addColField(t,e=-1){const n=this.pivotFields[t];return!!n&&(this.hs(t),n.axis="axisCol",-1===e||e>=this.colFields.length?this.colFields.push(t):this.colFields.splice(e,0,t),this.cs=!0,!0)}removeColField(t){const e=this.colFields.indexOf(t);return-1!==e&&(this.colFields.splice(e,1),this.pivotFields[t].axis=null,this.cs=!0,!0)}addDataField(t,e="sum",n=null,i=-1){const r=this.pivotFields[t];if(!r)return!1;r.dataField=!0;const o=new $n({fld:t,subtotal:e});return o.name=n??o.getDefaultName(r.name,this.$),-1===i||i>=this.dataFields.length?this.dataFields.push(o):this.dataFields.splice(i,0,o),this.cs=!0,!0}removeDataField(t){if(t<0||t>=this.dataFields.length)return!1;const e=this.dataFields[t];return this.dataFields.splice(t,1),this.dataFields.some(t=>t.fld===e.fld)||(this.pivotFields[e.fld].dataField=!1),this.cs=!0,!0}moveDataField(t,e=-1){if(t<0||t>=this.dataFields.length)return!1;const[n]=this.dataFields.splice(t,1);if(!n)return!1;let i=e;return i<0||i>=this.dataFields.length?this.dataFields.push(n):this.dataFields.splice(i,0,n),this.cs=!0,!0}addPageField(t){const e=this.pivotFields[t];return!!e&&(this.hs(t),e.axis="axisPage",this.pageFields.push(t),this.cs=!0,!0)}removePageField(t){const e=this.pageFields.indexOf(t);return-1!==e&&(this.pageFields.splice(e,1),this.pivotFields[t].axis=null,this.cs=!0,!0)}hs(t){const e=this.pivotFields[t];if(!e)return;let n=this.rowFields.indexOf(t);-1!==n&&this.rowFields.splice(n,1),n=this.colFields.indexOf(t),-1!==n&&this.colFields.splice(n,1),n=this.pageFields.indexOf(t),-1!==n&&this.pageFields.splice(n,1),e.axis=null}moveField(t,e,n,i=-1){switch(e){case"row":this.removeRowField(t);break;case"col":this.removeColField(t);break;case"page":this.removePageField(t);break;case"data":const e=this.dataFields.findIndex(e=>e.fld===t);-1!==e&&this.removeDataField(e)}switch(n){case"row":this.addRowField(t,i);break;case"col":this.addColField(t,i);break;case"page":this.addPageField(t);break;case"data":this.addDataField(t)}}us(t,e){if(!t?.PivotTable)return e;if(!t.PivotTable.get(e))return e;let n=2,i=`${e}_${n}`;for(;t.PivotTable.get(i);)n++,i=`${e}_${n}`;return i}fs(t){t?.items?.length&&(t.items.filter(t=>"1"!==t.h).length>0||t.items.forEach(t=>{delete t.h}))}ds(t){if(null==t)return 0;let e=0;return this.$.sheets.forEach(n=>{n?.PivotTable&&n.PivotTable.getAll().forEach(n=>{n!==this&&n.cacheId===t&&e++})}),e}cloneToSheet(t,e={}){if(!t?.PivotTable)return null;const n=this.us(t,e.name??this.name),i=new _n(t,{name:n,cacheId:this.cacheId,ref:Nn(this.$,e.cellRef??this.location.ref.split(":")[0]),firstHeaderRow:this.location.firstHeaderRow,firstDataRow:this.location.firstDataRow,firstDataCol:this.location.firstDataCol,rowGrandTotals:this.rowGrandTotals,colGrandTotals:this.colGrandTotals,showRowHeaders:this.showRowHeaders,showColHeaders:this.showColHeaders,compact:this.compact,compactData:this.compactData,outline:this.outline,outlineData:this.outlineData,showDrill:this.showDrill,gridDropZones:this.gridDropZones,multipleFieldFilters:this.multipleFieldFilters,showPageFields:this.showPageFields,reportFilterLayout:this.reportFilterLayout,reportFilterFieldsPerRow:this.reportFilterFieldsPerRow,compactIndent:this.compactIndent,mergeLabelCells:this.mergeLabelCells,errorValueEnabled:this.errorValueEnabled,errorValueText:this.errorValueText,emptyValueEnabled:this.emptyValueEnabled,emptyValueText:this.emptyValueText,enableValueCellEditing:this.enableValueCellEditing,showContextTips:this.showContextTips,printDrillButtons:this.printDrillButtons,printRepeatRowLabels:this.printRepeatRowLabels,printTitles:this.printTitles,includeCalculatedItemsInTotals:this.includeCalculatedItemsInTotals,dataCaption:this.dataCaption,grandTotalCaption:this.grandTotalCaption,pivotTableStyleName:this.pivotTableStyleName,showRowStripes:this.showRowStripes,showColStripes:this.showColStripes});return i.Wr=e.cache??this.cache,i.pivotFields=this.pivotFields.map(t=>t.clone()),i.rowFields=[...this.rowFields],i.colFields=[...this.colFields],i.pageFields=[...this.pageFields],i.dataFields=this.dataFields.map(t=>t.clone()),i.formats=this.formats.map(t=>({...t})),t.PivotTable.yr(i),!1!==e.render&&(i.cs=!0,i.calculate(),i.render()),i}moveTo(t,e={r:2,c:0}){if(!t?.PivotTable)return!1;const n=this.sheet,i=this.location.ref,r=Nn(this.$,e).split(":")[0];return n===t?(this.ps(i),this.location.ref=r,this.cs=!0,this.render(),!0):(this.ps(i),n?.PivotTable?.vs(this.name),this.name=this.us(t,this.name),this.sheet=t,this.$=t.SN,this.location.ref=r,t.PivotTable.yr(this),this.cs=!0,this.render(),!0)}changeDataSource(t,e,n={}){if(!t||!e)return!1;const i="string"==typeof e?t.rangeStrToNum(e):e;if(!i?.s||!i?.e)return!1;if(this.$.Event.hasListeners("beforePivotTableChange")&&this.$.Event.emit("beforePivotTableChange",{sheet:this.sheet,pivotTable:this,action:"changeDataSource",sourceSheet:t,sourceRangeRef:i}).canceled)return!1;const r=this.cache,o=r?.fields||[],a=this.pivotFields.map(t=>t.clone()),s=[...this.rowFields],l=[...this.colFields],c=[...this.pageFields],h=this.dataFields.map(t=>t.clone()),u=this.ds(this.cacheId)>0,d=u?new Mn(this.$).cacheId:this.cacheId,f=new Mn(this.$,{cacheId:d,sourceType:"worksheet",sourceSheet:t.name,sourceRef:t.name});f.buildFromRange(t,i),this.$.Mr||(this.$.Mr=new Map),this.$.Mr.set(d,f),!u&&r&&this.$.Mr.get(this.cacheId)===r&&(this.$.Mr.delete(this.cacheId),this.$.Mr.set(d,f)),this.cacheId=d,this.Wr=f,this.pivotFields=f.fields.map(t=>function(t,e=null){const n=new vn({name:t?.name??e?.name??"",axis:e?.axis??null,dataField:e?.dataField??!1,showAll:e?.showAll??!1,numFmtId:t?.numFmtId??e?.numFmtId??0,sortType:e?.sortType??"manual",subtotalTop:e?.subtotalTop??!0,showDropDowns:e?.showDropDowns??!0,defaultSubtotal:e?.defaultSubtotal??!0,compact:e?.compact??!0,outline:e?.outline??!0,repeatItemLabels:e?.repeatItemLabels??!1,insertBlankRow:e?.insertBlankRow??!1,sharedItems:t?.sharedItems??e?.sharedItems??null});return n.items=An(n.sharedItems),n}(t));const p=a.map((t,e)=>({index:e,name:Rn(t,o[e],e),field:t,cacheField:o[e]})),m=new Map;this.pivotFields.forEach((t,e)=>{const n=Rn(t,f.fields[e],e);m.has(n)||m.set(n,[]),m.get(n).push(e)});const g=(t,e)=>{const n=m.get(t);return n?.length?n.shift():e>=0&&e<this.pivotFields.length?e:void 0},v=new Map;p.forEach(t=>{const e=g(t.name,t.index);void 0!==e&&v.set(t.index,e)}),v.forEach((t,e)=>{const n=p[e],i=this.pivotFields[t];if(!n||!i)return;const r=n.field;i.showAll=r.showAll,i.sortType=r.sortType,i.subtotalTop=r.subtotalTop,i.showDropDowns=r.showDropDowns,i.defaultSubtotal=r.defaultSubtotal,i.compact=r.compact,i.outline=r.outline,i.repeatItemLabels=r.repeatItemLabels,i.insertBlankRow=r.insertBlankRow;const o=n.cacheField?.sharedItems?.values||[],a=f.fields[t]?.sharedItems?.values||[],s=[];r.items.forEach(t=>{if("1"!==t.h||void 0===t.x)return;const e=o[t.x];e&&s.push(e)}),s.length>0&&(i.items.forEach(t=>{if(void 0===t.x)return;const e=a[t.x];e&&s.some(t=>t.type===e.type&&kn(t.value,e.value))&&(t.h="1")}),this.fs(i))});const y=t=>(t=>{const e=[];return t.forEach(t=>{void 0===t||e.includes(t)||e.push(t)}),e})(t.map(t=>v.get(t)).filter(t=>void 0!==t));if(this.rowFields=y(s),this.colFields=y(l),this.pageFields=y(c),this.dataFields=h.map(t=>{const e=v.get(t.fld);if(void 0===e)return null;const n=t.clone();return n.fld=e,n}).filter(Boolean),this.pivotFields.forEach(t=>{t.axis=null,t.dataField=!1}),this.rowFields.forEach(t=>{const e=this.pivotFields[t];e&&(e.axis="axisRow")}),this.colFields.forEach(t=>{const e=this.pivotFields[t];e&&(e.axis="axisCol")}),this.pageFields.forEach(t=>{const e=this.pivotFields[t];e&&(e.axis="axisPage")}),this.dataFields.forEach(t=>{const e=this.pivotFields[t.fld];e&&(e.dataField=!0)}),0===this.dataFields.length&&this.pivotFields.length>0){const t=this.pivotFields.findIndex((t,e)=>{const n=f.fields[e]?.sharedItems;return!0===n?.containsNumber});-1!==t?this.addDataField(t,"sum"):this.addDataField(0,"count")}return this.cs=!0,!1!==n.render&&(this.calculate(),this.render()),this.$.Event.hasListeners("afterPivotTableChange")&&this.$.Event.emit("afterPivotTableChange",{sheet:this.sheet,pivotTable:this,action:"changeDataSource",sourceSheet:t,sourceRangeRef:i}),!0}setDataFieldSubtotal(t,e){const n=this.dataFields[t];if(!n)return;n.subtotal=e;const i=this.pivotFields[n.fld];n.name=n.getDefaultName(i?.name??"",this.$),this.cs=!0}setDataFieldShowAs(t,e,n=-1,i=0){const r=this.dataFields[t];r&&(r.showDataAs=e,r.baseField=n,r.baseItem=i,this.cs=!0)}setItemHidden(t,e,n){const i=this.pivotFields[t];return!(!i||!i.items[e]||(i.items[e].h=n?"1":void 0,this.cs=!0,0))}setItemsHidden(t,e){const n=this.pivotFields[t];if(!n)return!1;for(const[i,r]of Object.entries(e)){const t=Number(i);n.items[t]&&(n.items[t].h=r?"1":void 0)}return this.cs=!0,!0}clearFieldFilter(t){const e=this.pivotFields[t];return!!e&&(e.clearFilter(),this.cs=!0,!0)}setFieldSort(t,e){const n=this.pivotFields[t];return!!n&&(n.sortType=e,this.cs=!0,!0)}calculate(){const t=this.cache;if(!t||!t.records.length)return this.jr={},this.qr=[],this.Gr=[],this.Xr={},this.Yr={},this.Jr=[],this.Zr={},this.Qr={},this.ts={},this.es=[],void(this.rs=null);const e=this.bs(t.records);this.qr=this.gs(e,this.rowFields),this.Gr=this.gs(e,this.colFields),this.jr={},this.Xr={},this.Yr={};for(const n of e){const t=this.ys(n,this.rowFields),e=this.ys(n,this.colFields),i=`${t}|${e}`;this.jr[i]||(this.jr[i]=this.dataFields.map(()=>[])),this.dataFields.forEach((t,e)=>{const r=n[t.fld];"number"==typeof r?this.jr[i][e].push(r):"count"===t.subtotal&&null!=r&&""!==r&&this.jr[i][e].push(1)});const r=`${t}|__TOTAL__`;this.Xr[r]||(this.Xr[r]=this.dataFields.map(()=>[])),this.dataFields.forEach((t,e)=>{const i=n[t.fld];"number"==typeof i?this.Xr[r][e].push(i):"count"===t.subtotal&&null!=i&&""!==i&&this.Xr[r][e].push(1)});const o=`__TOTAL__|${e}`;this.Yr[o]||(this.Yr[o]=this.dataFields.map(()=>[])),this.dataFields.forEach((t,e)=>{const i=n[t.fld];"number"==typeof i?this.Yr[o][e].push(i):"count"===t.subtotal&&null!=i&&""!==i&&this.Yr[o][e].push(1)})}for(const n in this.jr)this.jr[n]=this.jr[n].map((t,e)=>this.dataFields[e].calculate(t));for(const n in this.Xr)this.Xr[n]=this.Xr[n].map((t,e)=>this.dataFields[e].calculate(t));for(const n in this.Yr)this.Yr[n]=this.Yr[n].map((t,e)=>this.dataFields[e].calculate(t));this.Jr=this.dataFields.map((t,n)=>{const i=e.map(e=>e[t.fld]).filter(e=>"count"===t.subtotal?null!=e&&""!==e:"number"==typeof e);return t.calculate(i.map(e=>"count"===t.subtotal?1:e))}),this.ws(),this.rs=this.$s(),this.cs=!1}bs(t){return t.filter(t=>{const e=[...this.pageFields,...this.rowFields,...this.colFields];for(const n of e){const e=this.pivotFields[n];if(!e||!e.items.length)continue;const i=t[n];if(!e.items.some(t=>"1"===t.h))continue;const r=this.Ms(e,i);if(-1!==r&&"1"===e.items[r]?.h)return!1}return!0})}Ms(t,e){if(!t.items.length)return-1;const n=this.cache,i=this.pivotFields.indexOf(t),r=n?.fields[i];if(!r||!r.sharedItems)return t.items.findIndex(t=>void 0!==t.x&&t.x===e);const o=r.sharedItems.values.findIndex(t=>t.value===e||("number"==typeof t.value&&"number"==typeof e?Math.abs(t.value-e)<1e-10:"m"===t.type&&(null==e||""===e)||String(t.value)===String(e)));return-1===o?-1:t.items.findIndex(t=>t.x===o)}gs(t,e){if(0===e.length)return[[]];const n=new Map;for(const s of t){const t=e.map(t=>s[t]),i=JSON.stringify(t);n.has(i)||n.set(i,{key:t,order:n.size})}const i=Array.from(n.values()),r=new Map,o=t=>{if(r.has(t))return r.get(t);const e=this.pivotFields[t],n=this.cache?.fields?.[t],i=[];if(Array.isArray(e?.items))for(const r of e.items){if(!r||"1"===r.h||void 0===r.x)continue;const t=n?.sharedItems?.values?.[r.x]?.value,e=void 0!==t?t:r.x;i.some(t=>kn(t,e))||i.push(e)}return r.set(t,i),i},a=(t,e)=>{const n=o(t);for(let i=0;i<n.length;i++)if(kn(n[i],e))return i;return Number.MAX_SAFE_INTEGER};return i.sort((t,n)=>{const i=t.key,r=n.key;for(let o=0;o<i.length;o++){const t=e[o],n=this.pivotFields[e[o]],s=n?.sortType??"manual";if("manual"===s){const e=a(t,i[o]),n=a(t,r[o]);if(e!==n)return e-n;continue}const l=bn(i[o],r[o],s);if(0!==l)return l}return t.order-n.order}),i.map(t=>t.key)}ys(t,e){return 0===e.length?"":e.map(e=>String(t[e]??"")).join("|")}Cs(t){return t&&0!==t.length?t.map(t=>String(t??"")).join("|"):""}Ss(t,e){return`${t}|${e}`}Rs(t,e){const n=e.slice(0,t+1);return`${t}:${this.Cs(n)}`}As(t,e){const n=this.cache?.fields?.[t],i=n?.sharedItems?.values?.[e];return i?.value}ks(t,e){const n=new Map,i=this.dataFields.length;if(0===i||0===this.rowFields.length)return n;const r=new Array(i).fill(0);return this.qr.forEach((o,a)=>{const s=t[a];e.forEach(t=>{const e=this.Ss(s,t),a=this.jr[e]||r;for(let r=0;r<o.length;r++){const e=`${this.Rs(r,o)}|${t}`,s=n.get(e)||new Array(i).fill(0);for(let t=0;t<i;t++)s[t]+=a[t]??0;n.set(e,s)}})}),n}Ts(t,e){const n=new Map,i=this.dataFields.length;if(0===i||0===this.colFields.length)return n;const r=new Array(i).fill(0);return this.Gr.forEach((o,a)=>{const s=e[a];t.forEach(t=>{const e=this.Ss(t,s),a=this.jr[e]||r;for(let r=0;r<o.length;r++){const e=o.slice(0,r+1),s=`${t}|${r}:${this.Cs(e)}`,l=n.get(s)||new Array(i).fill(0);for(let t=0;t<i;t++)l[t]+=a[t]??0;n.set(s,l)}})}),n}Ns(t,e){const n=new Map,i=this.dataFields.length;if(0===i)return n;new Array(i).fill(0);for(let r=0;r<i;r++){const i=this.dataFields[r];if("runningTotal"!==i.showDataAs)continue;const o=new Map,a=this.rowFields.indexOf(i.baseField),s=this.colFields.indexOf(i.baseField);if(-1!==a){const n=new Map;this.qr.forEach((i,s)=>{const l=t[s],c=this.Cs(i.filter((t,e)=>e!==a));e.forEach(t=>{const e=this.Ss(l,t),i=this.jr[e]?.[r]??0,a=`${c}|${t}`,s=(n.get(a)??0)+i;n.set(a,s),o.set(e,s)})})}else if(-1!==s){const n=new Map;this.Gr.forEach((i,a)=>{const l=e[a],c=this.Cs(i.filter((t,e)=>e!==s));t.forEach(t=>{const e=this.Ss(t,l),i=this.jr[e]?.[r]??0,a=`${t}|${c}`,s=(n.get(a)??0)+i;n.set(a,s),o.set(e,s)})})}else t.forEach(t=>{e.forEach(e=>{const n=this.Ss(t,e);o.set(n,this.jr[n]?.[r]??0)})});n.set(r,o)}return n}ws(){const t=this.dataFields.length;if(this.Zr={},this.Qr={},this.ts={},this.es=new Array(t).fill(0),0===t)return;const e=this.qr.map(t=>this.Cs(t)),n=this.Gr.map(t=>this.Cs(t)),i=new Map,r=new Map;this.qr.forEach((t,n)=>i.set(e[n],t)),this.Gr.forEach((t,e)=>r.set(n[e],t));const o=this.Ns(e,n),a=this.ks(e,n),s=this.Ts(e,n),l=new Array(t).fill(0),c=(t,e,n,i,r)=>{const o=[];t.forEach(t=>{const n=t[e];o.some(t=>kn(t,n))||o.push(n)}),o.sort((t,e)=>bn(t,e,r));const a=o.findIndex(t=>kn(t,n));if(-1===a)return;const s=a+i;return s<0||s>=o.length?void 0:o[s]},h=(t,e,n)=>{const o=this.dataFields[t];if(o.baseField<0)return null;let a=e,s=n;const l=this.rowFields.indexOf(o.baseField),h=this.colFields.indexOf(o.baseField),u=this.pivotFields[o.baseField]?.sortType;let d;if(-1===o.baseItem||-2===o.baseItem){const t=-1===o.baseItem?-1:1;if(-1!==l){const n=i.get(e)||[];d=c(this.qr,l,n[l],t,u)}else if(-1!==h){const e=r.get(n)||[];d=c(this.Gr,h,e[h],t,u)}}if(void 0===d&&(d=this.As(o.baseField,o.baseItem)),void 0===d)return null;if(-1!==l){const t=(i.get(e)||[]).slice();t[l]=d,a=this.Cs(t)}if(-1!==h){const t=(r.get(n)||[]).slice();t[h]=d,s=this.Cs(t)}const f=this.Ss(a,s);return this.jr[f]?.[t]??0};e.forEach(e=>{const c=`${e}|__TOTAL__`,u=this.Xr[c]||l;n.forEach(n=>{const d=`__TOTAL__|${n}`,f=this.Yr[d]||l,p=this.Ss(e,n),m=Object.prototype.hasOwnProperty.call(this.jr,p),g=m?this.jr[p]:l,v=m?g.map((t,l)=>{const c=this.dataFields[l],d=u[l]??0,m=f[l]??0,g=this.Jr[l]??0;switch(c.showDataAs){case"percentOfTotal":return g?t/g:0;case"percentOfRow":return d?t/d:0;case"percentOfCol":return m?t/m:0;case"difference":{const i=h(l,e,n);return null===i?t:t-i}case"percentDiff":{const i=h(l,e,n);return null===i||0===i?0:(t-i)/i}case"runningTotal":{const e=o.get(l);return e?e.get(p)??t:t}case"percentOfParentRow":{const r=i.get(e)||[],o=this.rowFields.indexOf(c.baseField);if(o>0){const e=this.Rs(o-1,r),i=a.get(`${e}|${n}`),s=i?.[l]??0;return s?t/s:0}return d?t/d:0}case"percentOfParentCol":{const i=r.get(n)||[],o=this.colFields.indexOf(c.baseField);if(o>0){const n=`${o-1}:${this.Cs(i.slice(0,o))}`,r=s.get(`${e}|${n}`),a=r?.[l]??0;return a?t/a:0}return m?t/m:0}case"index":return d&&m?t*g/(d*m):0;default:return t}}):null;m&&v&&(this.Zr[p]=v),this.Qr[c]||(this.Qr[c]=new Array(t).fill(0)),this.ts[d]||(this.ts[d]=new Array(t).fill(0));for(let e=0;e<t;e++){const t=m?v?.[e]??0:0;this.Qr[c][e]+=t,this.ts[d][e]+=t,this.es[e]+=t}})})}$s(){const t=this.dataFields.length;if(0===this.rowFields.length)return null;const e={level:-1,value:null,key:"",children:new Map,order:[],agg:new Map},n=this.Gr.map(t=>this.Cs(t)),i=this.qr.map(t=>this.Cs(t)),r=new Array(t).fill(0);return this.qr.forEach((o,a)=>{const s=i[a],l=[e];let c=e;o.forEach((t,e)=>{const n=String(t??"");let i=c.children.get(n);i||(i={level:e,value:t,key:n,children:new Map,order:[],agg:new Map},c.children.set(n,i),c.order.push(n)),c=i,l.push(c)}),n.forEach(e=>{const n=this.Ss(s,e);if(!Object.prototype.hasOwnProperty.call(this.Zr,n))return;const i=this.Zr[n]||r;l.forEach(n=>{const r=n.agg.get(e)||new Array(t).fill(0);for(let e=0;e<t;e++)r[e]+=i[e]??0;n.agg.set(e,r)})})}),e}Fs(){const t=[];if(0===this.rowFields.length)return t.push({type:"data",rowKey:[],level:0,node:null,rowKeyStr:""}),t;if(!this.rs)return t;const e=this.compact,n=(i,r,o)=>{const a=this.rowFields[r],s=this.pivotFields[a],l=!1!==s?.defaultSubtotal,c=!1!==s?.subtotalTop,h=!0===s?.insertBlankRow;i.order.forEach(a=>{const s=i.children.get(a);if(!s)return;const u=[...o,s.value],d=s.order.length>0,f=d&&this.ls.has(this.Rs(r,u));if(d)return(e||f||l&&c)&&(p=f||l&&c,t.push({type:"group",level:r,values:u,node:s,showValues:p,collapsed:f})),f||(n(s,r+1,u),l&&!c&&t.push({type:"subtotal",level:r,values:u,node:s,showValues:!0})),void(h&&t.push({type:"blank"}));var p;const m=this.Cs(u);t.push({type:"data",level:r,values:u,rowKey:u,rowKeyStr:m,node:s,showValues:!0}),h&&t.push({type:"blank"})})};return n(this.rs,0,[]),t}_s(t){if(!this.rs)return null;let e=this.rs;for(const n of t){const t=String(n??"");if(e=e.children.get(t),!e)return null}return e}ki(t,e,n){return!(!t?.s||!t?.e)&&e>=t.s.r&&e<=t.e.r&&n>=t.s.c&&n<=t.e.c}Es(t,e){return!!(t?.s&&t?.e&&e?.s&&e?.e)&&!(t.e.r<e.s.r||t.s.r>e.e.r||t.e.c<e.s.c||t.s.c>e.e.c)}Is(t,e){return!!(t?.s&&t?.e&&e?.s&&e?.e)&&t.s.r>=e.s.r&&t.e.r<=e.e.r&&t.s.c>=e.s.c&&t.e.c<=e.e.c}zs(t){if(!t)return!1;if(t.isMerged)return!0;if(t.F||t._)return!0;const e=t.B;return null!=e&&""!==e}Ds(t,e,n){const{dataFieldCount:i,rowKeyCount:r,colKeyCount:o,rowHeaderColCount:a,showColGrandTotals:s,showRowGrandTotals:l}=n;let c=t.r;if(!1!==this.showPageFields&&this.pageFields.length>0){const t=Math.max(1,Number(this.reportFilterFieldsPerRow)||1);c+="horizontal"===this.reportFilterLayout?Math.ceil(this.pageFields.length/t):this.pageFields.length,c+=1}const h=c;(this.colFields.length>0||i>1)&&(this.colFields.length>0&&1===i&&(c+=1),c+=this.colFields.length,i>1&&(c+=1)),0===this.colFields.length&&this.rowFields.length>0&&1===i&&(c+=1),c+=e.length,l&&r>0&&(c+=1);const u=Math.max(c-1,h),d=t.c+a-1+o*i+(s?i:0);return{s:{r:t.r,c:t.c},e:{r:u,c:d}}}Ls(t,e){if(!t?.s||!t?.e)return!1;for(let i=t.s.r;i<=t.e.r;i++){const n=this.sheet.rows[i];if(n?.cells)for(let r=t.s.c;r<=t.e.c;r++){if(this.ki(e,i,r))continue;const t=n.cells[r];if(this.zs(t))return!0}}const n=Array.isArray(this.sheet.merges)?this.sheet.merges:[];for(const i of n)if(this.Es(i,t)&&!this.Is(i,e))return!0;return!1}Os(t){const e=this.sheet.getCell(t.r,t.c);e&&(e.editVal="#SPILL!透视表溢出",e.Ps&&delete e.Ps,e.Vs&&delete e.Vs,e.Bs&&delete e.Bs,e.Hs&&delete e.Hs,e.Us&&delete e.Us)}ps(t){if(!t)return;const e=Sn(t);if(e?.s&&e?.e)for(let n=e.s.r;n<=e.e.r;n++)for(let t=e.s.c;t<=e.e.c;t++){const e=this.sheet.getCell(n,t);e&&(e.editVal=void 0,e.Ps&&delete e.Ps,e.Vs&&delete e.Vs,e.Bs&&delete e.Bs,e.Hs&&delete e.Hs,e.Us&&delete e.Us,e.Ks&&(e.border={bottom:null},delete e.Ks),e.fill?.fgColor&&(e.fill=null),(e.Ws||e.font?.bold)&&(e.font=null,e.Ws&&delete e.Ws))}}isRowCollapsed(t,e){return this.ls.has(this.Rs(t,e))}toggleRowCollapsed(t,e){const n=this.Rs(t,e);this.ls.has(n)?this.ls.delete(n):this.ls.add(n)}getRowToggleInfo(t,e){return this.ss.get(`${t},${e}`)||null}render(t={}){this.cs&&this.calculate();const n=this.sheet,i=this.location.ref,r=Sn(i),o=i.includes(":")?r:null,a=this.location.ref.split(":")[0],s=this.$.Utils.cellStrToNum?this.$.Utils.cellStrToNum(a):Sn(a).s;let l=s.r,c=s.c;const h=this.dataFields.length>0,u=h?this.dataFields.length:1,d=this.qr?.length||0,f=this.Gr?.length||1,p=this.rowFields.length>0?this.compact?1:this.rowFields.length:1,m=this.colGrandTotals&&this.colFields.length>0,g=this.rowGrandTotals&&this.rowFields.length>0,v=this.Fs(),y=this.Ds(s,v,{dataFieldCount:u,rowKeyCount:d,colKeyCount:f,rowHeaderColCount:p,showColGrandTotals:m,showRowGrandTotals:g});if(this.Ls(y,o))return o&&this.ps(i),this.Os(s),void(!t.silent&&this.$.ue&&this.$.ue());this.ps(i);const b=this.Gr.map(t=>this.Cs(t));if(this.ss=new Map,this.js=null,!1!==this.showPageFields&&this.pageFields.length>0){const t=Math.max(1,Number(this.reportFilterFieldsPerRow)||1);if("horizontal"===this.reportFilterLayout)this.pageFields.forEach((e,i)=>{const r=this.pivotFields[e],o=Math.floor(i/t),a=l+o,s=c+i%t*2;n.getCell(a,s).editVal=r.name;const h=r.getVisibleItems(),u=h.length===r.items.length?"(全部)":1===h.length?this.Oi(e,h[0].x):"(多个项目)";n.getCell(a,s+1).editVal=u}),l+=Math.ceil(this.pageFields.length/t);else for(const e of this.pageFields){const t=this.pivotFields[e];n.getCell(l,c).editVal=t.name;const i=t.getVisibleItems(),r=i.length===t.items.length?"(全部)":1===i.length?this.Oi(e,i[0].x):"(多个项目)";n.getCell(l,c+1).editVal=r,l++}l++}const x=new Set,w=u>1,S=this.showDrill,C=Math.max(1,Number.isFinite(this.compactIndent)?this.compactIndent:1),T=function(t){const e=String(t??"").trim(),n={PivotStyleLight16:{headerFill:"#dbe5f1",subtotalFill:"#e9eff8",grandTotalFill:"#dbe5f1",groupBorder:"#b4c6e7"}};return n[e]?n[e]:/^PivotStyleDark/i.test(e)?{headerFill:"#c6d9f1",subtotalFill:"#dbe5f1",grandTotalFill:"#c6d9f1",groupBorder:"#9fbad9"}:{headerFill:"#dbe5f1",subtotalFill:"#eef3fb",grandTotalFill:"#dbe5f1",groupBorder:"#b4c6e7"}}(this.pivotTableStyleName),$=T.headerFill??null,M=T.subtotalFill??null,A=T.grandTotalFill??M??null,N=T.groupBorder??"#b4c6e7",k=this.dataFields.map(t=>function(t,n){const i=Number(n??0);if(!Number.isFinite(i)||i<=0)return"General";const r=e[i];if(r)return r;const o=yn(t?.Xml?.styleSheet?.numFmts?.numFmt).find(t=>Number(t?._$numFmtId??t?.numFmtId)===i),a=o?._$formatCode??o?.formatCode;return"string"==typeof a&&a?a.replaceAll("\\",""):"General"}(this.$,t?.numFmtId)),R=(t,e,i,{bold:r=!1,fillColor:o=null,pivotToggle:a=null,pivotIndent:s=null,pivotFilter:l=null,numFmt:c=null,bottomBorderColor:h=null,fontColor:u="#000000"}={})=>{const d=n.getCell(t,e);if(d){if(d.editVal=i??"",a?d.Ps=a:d.Ps&&delete d.Ps,null!=s?d.Bs=s:d.Bs&&delete d.Bs,l?d.Hs=l:d.Hs&&delete d.Hs,!l&&d.Us&&delete d.Us,void 0!==c&&(c?d.numFmt!==c&&(d.numFmt=c):d.style?.numFmt&&(d.numFmt=null)),h){const t=d.border?.bottom?.color;t!==h&&(d.border={bottom:{style:"thin",color:h}}),d.Ks=!0}if(r||u){const t={};r&&(t.bold=!0),u&&(t.color=u),d.font=t,d.Ws=!0}else(d.Ws||d.font?.bold)&&(d.font=null,d.Ws&&delete d.Ws);o?d.fill={fgColor:o}:d.fill?.fgColor&&(d.fill=null)}},_=(t,e)=>{for(let n=0;n<e.length;n++){const i=e[n]||{},r=this.showRowHeaders?i.label??"":"",o=this.showRowHeaders&&Array.isArray(i.filterFields)&&i.filterFields.length>0?{fields:i.filterFields,active:!!i.filterActive}:null;R(t,c+n,r,{bold:!0,fillColor:$,pivotFilter:o})}},I=this.$.t("pivot.render.rowLabels"),F=this.$.t("pivot.render.colLabels"),E=(()=>{if(this.compact){if(0===this.rowFields.length)return[{label:"",filterFields:[]}];const t=this.rowFields.filter(t=>!1!==this.pivotFields[t]?.showDropDowns),e=t.some(t=>this.pivotFields[t]?.items?.some(t=>"1"===t.h));return[{label:I,filterFields:t,filterActive:e}]}const t=this.rowFields.map(t=>{const e=this.pivotFields[t],n=!1===e?.showDropDowns?[]:[t],i=e?.items?.some(t=>"1"===t.h);return{label:e?.name??"",filterFields:n,filterActive:i}});return t.length>0?t:[{label:"",filterFields:[]}]})(),D=this.colFields.filter(t=>!1!==this.pivotFields[t]?.showDropDowns),L=D.some(t=>this.pivotFields[t]?.items?.some(t=>"1"===t.h)),P=t=>{const e=new Array(u).fill(0);if(!t?.agg)return e;for(const n of t.agg.values())for(let t=0;t<u;t++)e[t]+=n[t]??0;return e},z=t=>null==t||""===t?this.emptyValueEnabled?this.emptyValueText??"":t:this.errorValueEnabled&&"string"==typeof t&&t.startsWith("#")?this.errorValueText??t:t;if(this.colFields.length>0||u>1){if(this.colFields.length>0&&1===u){const t=h?this.dataFields[0]?.name??this.dataCaption:this.dataCaption;R(l,c,this.showRowHeaders?t:"",{bold:!0,fillColor:$}),R(l,c+p,this.showColHeaders?F:"",{bold:!0,fillColor:$,pivotFilter:D.length>0?{fields:D,active:L}:null});const e=c+p-1+f*u+(m?u:0);for(let n=c+1;n<=e;n++)n!==c+p&&R(l,n,"",{fillColor:$});l++}for(let t=0;t<this.colFields.length;t++){const e=this.colFields[t];this.pivotFields[e],!w&&t===this.colFields.length-1&&E.length>0&&_(l,E);let n=c+p;for(let i=0;i<this.Gr.length;i++){const e=this.Gr[i][t],r=this.showColHeaders?e??"":"";R(l,n,r,{bold:!0,fillColor:$}),u>1&&this.colFields.length,n+=u}m&&0===t&&R(l,n,this.grandTotalCaption,{bold:!0,fillColor:$}),l++}if(u>1){this.showRowHeaders&&(this.rowFields.length>0?_(l,E):R(l,c,this.dataCaption,{bold:!0,fillColor:$}));let t=c+p;for(let e=0;e<f;e++)for(const n of this.dataFields)R(l,t,this.showColHeaders?n.name:"",{bold:!0,fillColor:$}),t++;if(m)for(const e of this.dataFields)R(l,t,this.showColHeaders?e.name:"",{bold:!0,fillColor:$}),t++;l++}}0===this.colFields.length&&this.rowFields.length>0&&1===u&&(_(l,E),this.dataFields.length>0&&R(l,c+p,this.showColHeaders?this.dataFields[0].name:"",{bold:!0,fillColor:$}),l++);let O=0;for(const e of v){if("blank"===e.type){l++;continue}const t=e.values||e.rowKey||[],n=e.rowKeyStr??this.Cs(t),i=t.slice(),r="subtotal"===e.type,o="group"===e.type,a=r||o,s=!1!==e.showValues,d=r||o&&s;if("data"===e.type&&O++,this.compact){const t=e.level??i.length-1;let n=i[t]??"";r&&(n=`${n} ${this.grandTotalCaption}`.trim());const a=this.Rs(t,i),s=this._s(i),h=s?.order?.length>0;let u=!1,f=!1;S&&h&&(f=this.ls.has(a),u=!0,x.add(a)),this.ss.set(`${l},${c}`,{level:t,values:i.slice(0,t+1),hasChildren:h,hasToggle:u});const p=n??"",m=u?{collapsed:f}:null,g=Math.max(0,t??0)*Math.max(0,C);R(l,c,p,{bold:d,pivotToggle:m,pivotIndent:g,bottomBorderColor:o?N:null})}else{for(let t=0;t<this.rowFields.length;t++){const n=this.pivotFields[this.rowFields[t]],a=this.Rs(t,i),s=this._s(i.slice(0,t+1)),h=s?.order?.length>0,u=i[t]??"";let f=u;r&&t===e.level?f=`${u} ${this.grandTotalCaption}`.trim():n?.repeatItemLabels||!this.outline||f!==(this.js?.[t]??null)||(f="");let p=!1,m=!1;S&&h&&!x.has(a)&&(m=this.ls.has(a),x.add(a),p=!0),this.ss.set(`${l},${c+t}`,{level:t,values:i.slice(0,t+1),hasChildren:h,hasToggle:p}),R(l,c+t,f,{bold:d,pivotToggle:p?{collapsed:m}:null,bottomBorderColor:o?N:null})}"data"!==e.type&&"group"!==e.type||(this.js=i.slice())}let g=c+p;for(let m=0;m<f;m++){const t=b[m]??"",i=this.Ss(n,t);let f=Object.prototype.hasOwnProperty.call(this.Zr,i)?this.Zr[i]:null;a&&e.node&&s?f=e.node.agg.get(t)||null:a&&!s&&(f=null);for(let n=0;n<u;n++){const t=z(h&&f?f[n]??0:""),i=h?k[n]??"General":null,u=g-(c+p);let m=null;"data"===e.type?(this.showRowStripes&&(m=O%2==0?"#ffffff":"#f7f7f7"),this.showColStripes&&u%2==1&&(m="#f7f7f7")):a&&s&&(m=r?M:null),R(l,g,t,{bold:d,fillColor:m,numFmt:i,bottomBorderColor:o?N:null}),g++}}if(m){let t=null;if(s)if(a&&e.node)t=P(e.node);else{const e=`${n}|__TOTAL__`;t=this.Qr?.[e]||this.dataFields.map(()=>0)}for(let e=0;e<u;e++){const n=z(h&&t?t[e]??0:""),i=h?k[e]??"General":null;R(l,g,n,{bold:!0,fillColor:r&&s?M:null,numFmt:i,bottomBorderColor:o?N:null}),g++}}l++}if(g&&d>0){R(l,c,this.grandTotalCaption,{bold:!0,fillColor:A});let t=c+p;for(let e=0;e<f;e++){const n=`__TOTAL__|${b[e]??""}`,i=this.ts?.[n]||this.dataFields.map(()=>0);for(let e=0;e<u;e++){const n=z(h?i[e]??0:""),r=h?k[e]??"General":null;R(l,t,n,{bold:!0,fillColor:A,numFmt:r}),t++}}if(m)for(let e=0;e<u;e++){const n=z(h?this.es?.[e]??0:""),i=h?k[e]??"General":null;R(l,t,n,{bold:!0,fillColor:A,numFmt:i}),t++}l++}const B=y.e.r,V=y.e.c,H=this.$.Utils.cellNumToStr?this.$.Utils.cellNumToStr({r:B,c:V}):Cn({s:{r:B,c:V},e:{r:B,c:V}}).split(":")[0];this.location.ref=`${a}:${H}`,!t.silent&&this.$.ue&&this.$.ue()}Oi(t,e){const n=this.cache;if(!n)return"";const i=n.fields[t];if(!i||!i.sharedItems)return"";const r=i.sharedItems.values[e];return r?"m"===r.type?"(空白)":String(r.value??""):""}qs(t,e){const n=this.pivotFields[t];if(!n)return{};const i=this.Ms(n,e);return i>=0&&i>0?{"_$v":String(i)}:{}}Gs(t){const e=this.pivotFields[t];if(!e?.items?.length)return{};const n=e.items.findIndex(t=>t&&void 0===t.x&&"default"===t.t),i=e.items.length-1,r=n>=0?n:i;return r>0?{"_$v":String(r)}:{}}Xs(t,e,n=!1){if(!Array.isArray(t)||0===t.length)return[];const i=[];if((Array.isArray(e)?e:[]).forEach(e=>{const n=Array.isArray(e)?e:[e],r=t.map((t,e)=>this.qs(t,n[e])),o={};o.x=1===r.length?r[0]:r,i.push(o)}),n){const e={"_$t":"grand"};e.x=1===t.length?{}:t.map(()=>({})),i.push(e)}return i}Ys(t){const e=this.cache,n=e?.records;if(!Array.isArray(n)||0===n.length)return[];const i=[],r=new Set;return n.forEach(e=>{const n=Array.isArray(e)?e[t]:void 0,o=(t=>null==t||""===t?"m":"number"==typeof t&&Number.isFinite(t)?"n":"boolean"==typeof t?"b":t instanceof Date&&!Number.isNaN(t.getTime())?"d":"s")(n),a=((t,e)=>{if("m"===t)return"m:";if("n"===t)return`n:${Number(e)}`;if("b"===t)return"b:"+(e?1:0);if("d"===t){const t=e instanceof Date?e.getTime():Date.parse(e);return`d:${Number.isFinite(t)?t:String(e)}`}return`s:${String(e??"")}`})(o,n);r.has(a)||(r.add(a),i.push({type:o,value:"m"===o?null:n,index:i.length}))}),i}Js(t){const e=this.pivotFields[t],n=this.cache,i=n?.fields?.[t];if(e&&i){if(i.sharedItems||(i.sharedItems={values:[]}),!Array.isArray(i.sharedItems.values)||0===i.sharedItems.values.length){const e=this.Ys(t);e.length>0&&(i.sharedItems.values=e,i.sharedItems.count=e.length,"function"==typeof n.Fr&&n.Fr(i.sharedItems))}e.sharedItems=i.sharedItems,Array.isArray(e.items)&&e.items.some(t=>t&&void 0!==t.x)?e.items.some(t=>t&&void 0===t.x&&"default"===t.t)||e.items.push({t:"default"}):e.items=An(e.sharedItems)}}Zs(){new Set([...this.rowFields,...this.colFields,...this.pageFields]).forEach(t=>this.Js(t))}Qs(){if(!Array.isArray(this.rowFields)||0===this.rowFields.length)return[];const t=this.Fs(),e=[];if(this.compact&&this.rowFields.length>1)return t.forEach(t=>{if(!t||"blank"===t.type)return;const n=Array.isArray(t.values)?t.values:Array.isArray(t.rowKey)?t.rowKey:[],i=Number.isFinite(t.level)?t.level:n.length-1,r=Math.max(0,Math.min(this.rowFields.length-1,i)),o=this.rowFields[r],a=n[r],s={x:this.qs(o,a)};r>0&&(s._$r=String(r)),e.push(s)}),this.rowGrandTotals&&e.push({"_$t":"grand",x:{}}),e;if(t.forEach(t=>{if(!t||"blank"===t.type)return;const n=Array.isArray(t.values)?t.values:Array.isArray(t.rowKey)?t.rowKey:[],i=Number.isFinite(t.level)?t.level:n.length-1,r=this.rowFields.map((t,e)=>e<=i&&e<n.length?this.qs(t,n[e]):this.Gs(t));e.push({x:1===r.length?r[0]:r})}),this.rowGrandTotals){const t={"_$t":"grand"};t.x=1===this.rowFields.length?{}:this.rowFields.map(()=>({})),e.push(t)}return e}static fromXml(t,e,n){const i=new _n(t,{name:e._$name,cacheId:Number(e._$cacheId),ref:e.location?._$ref??"A1",firstHeaderRow:Number(e.location?._$firstHeaderRow??1),firstDataRow:Number(e.location?._$firstDataRow??2),firstDataCol:Number(e.location?._$firstDataCol??1),rowGrandTotals:"0"!==e._$rowGrandTotals,colGrandTotals:"0"!==e._$colGrandTotals,compact:"0"!==e._$compact,compactData:"0"!==e._$compactData,outline:"0"!==e._$outline,outlineData:"0"!==e._$outlineData,showDrill:"0"!==e._$showDrill,gridDropZones:"0"!==e._$showDropZones,multipleFieldFilters:"0"!==e._$multipleFieldFilters,showPageFields:"0"!==e._$showPageMultipleItemLabel,reportFilterLayout:"1"===e._$pageOverThenDown?"horizontal":"vertical",reportFilterFieldsPerRow:Number(e._$pageWrap??1),compactIndent:Number(e._$indent??1),mergeLabelCells:"1"===e._$mergeItem,errorValueEnabled:"1"===e._$showError,errorValueText:e._$errorCaption??"",emptyValueEnabled:"1"===e._$showMissing,emptyValueText:e._$missingCaption??"",enableValueCellEditing:"1"===e._$enableDataValueEditing,showContextTips:"0"!==e._$showDataTips,printDrillButtons:"0"!==e._$printDrill,printRepeatRowLabels:"1"===e._$itemPrintTitles,printTitles:"1"===e._$fieldPrintTitles,includeCalculatedItemsInTotals:"0"!==e._$asteriskTotals,dataCaption:e._$dataCaption,grandTotalCaption:e._$grandTotalCaption});i.Wr=n;const r=yn(e.pivotFields?.pivotField);i.pivotFields=r.map((t,e)=>{const i=vn.fromXml(t);return n&&n.fields[e]&&(i.name=n.fields[e].name,i.sharedItems=n.fields[e].sharedItems),i});const o=yn(e.rowFields?.field);i.rowFields=o.map(t=>Number(t._$x));const a=yn(e.colFields?.field);i.colFields=a.map(t=>Number(t._$x));const s=yn(e.pageFields?.pageField);i.pageFields=s.map(t=>Number(t._$fld)),s.some(t=>"1"===t?._$multipleItemSelectionAllowed)&&(i.multipleFieldFilters=!0);const l=yn(e.dataFields?.dataField);return i.dataFields=l.map(t=>$n.fromXml(t)),e.pivotTableStyleInfo&&(i.pivotTableStyleName=e.pivotTableStyleInfo._$name??"PivotStyleLight16",i.showRowHeaders="0"!==e.pivotTableStyleInfo._$showRowHeaders,i.showColHeaders="0"!==e.pivotTableStyleInfo._$showColHeaders,i.showRowStripes="1"===e.pivotTableStyleInfo._$showRowStripes,i.showColStripes="1"===e.pivotTableStyleInfo._$showColStripes),i}prepareForExport(){!this.cs&&Array.isArray(this.qr)&&Array.isArray(this.Gr)||this.calculate(),this.Zs()}toXml(){this.prepareForExport();const t={"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$name":this.name,"_$cacheId":String(this.cacheId),"_$dataCaption":this.dataCaption,"_$updatedVersion":"8","_$minRefreshableVersion":"3","_$useAutoFormatting":"1","_$itemPrintTitles":this.printRepeatRowLabels?"1":"0","_$fieldPrintTitles":this.printTitles?"1":"0","_$printDrill":this.printDrillButtons?"1":"0","_$createdVersion":"7","_$indent":String(Math.max(0,Number(this.compactIndent)||0)),"_$outline":this.outline?"1":"0","_$outlineData":this.outlineData?"1":"0","_$compact":this.compact?"1":"0","_$compactData":this.compactData?"1":"0","_$showDropZones":this.gridDropZones?"1":"0","_$multipleFieldFilters":this.multipleFieldFilters?"1":"0","_$showPageMultipleItemLabel":this.showPageFields?"1":"0","_$pageOverThenDown":"horizontal"===this.reportFilterLayout?"1":"0","_$pageWrap":String(Math.max(1,Number(this.reportFilterFieldsPerRow)||1)),"_$mergeItem":this.mergeLabelCells?"1":"0","_$showError":this.errorValueEnabled?"1":"0","_$enableDataValueEditing":this.enableValueCellEditing?"1":"0","_$showDataTips":this.showContextTips?"1":"0","_$asteriskTotals":this.includeCalculatedItemsInTotals?"1":"0"};if(this.errorValueText&&(t._$errorCaption=this.errorValueText),this.emptyValueEnabled&&(t._$showMissing="1",this.emptyValueText&&(t._$missingCaption=this.emptyValueText)),this.grandTotalCaption&&"Grand Total"!==this.grandTotalCaption&&(t._$grandTotalCaption=this.grandTotalCaption),this.rowGrandTotals||(t._$rowGrandTotals="0"),this.colGrandTotals||(t._$colGrandTotals="0"),t._$showDrill=this.showDrill?"1":"0",t.location={"_$ref":this.location.ref,"_$firstHeaderRow":String(this.location.firstHeaderRow),"_$firstDataRow":String(this.location.firstDataRow),"_$firstDataCol":String(this.location.firstDataCol)},t.pivotFields={"_$count":String(this.pivotFields.length),"pivotField":this.pivotFields.map(t=>t.toXml())},this.rowFields.length>0){t.rowFields={"_$count":String(this.rowFields.length),"field":this.rowFields.map(t=>({"_$x":String(t)}))};const e=this.Qs();e.length>0&&(t.rowItems={"_$count":String(e.length),"i":e})}if(this.colFields.length>0){t.colFields={"_$count":String(this.colFields.length),"field":this.colFields.map(t=>({"_$x":String(t)}))};const e=this.Xs(this.colFields,this.Gr,this.colGrandTotals);e.length>0&&(t.colItems={"_$count":String(e.length),"i":e})}else t.colItems={"_$count":"1","i":[{}]};return this.pageFields.length>0&&(t.pageFields={"_$count":String(this.pageFields.length),"pageField":this.pageFields.map(t=>{const e={"_$fld":String(t),"_$hier":"-1"};return this.multipleFieldFilters&&(e._$multipleItemSelectionAllowed="1"),e})}),this.dataFields.length>0&&(t.dataFields={"_$count":String(this.dataFields.length),"dataField":this.dataFields.map(t=>t.toXml())}),t.pivotTableStyleInfo={"_$name":this.pivotTableStyleName,"_$showRowHeaders":this.showRowHeaders?"1":"0","_$showColHeaders":this.showColHeaders?"1":"0","_$showRowStripes":this.showRowStripes?"1":"0","_$showColStripes":this.showColStripes?"1":"0","_$showLastColumn":"1"},{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"pivotTableDefinition":t}}refresh(){this.$.Event.hasListeners("beforePivotTableChange")&&this.$.Event.emit("beforePivotTableChange",{sheet:this.sheet,pivotTable:this,action:"refresh"}).canceled||(this.cache&&this.cache.refresh(),this.cs=!0,this.calculate(),this.render(),this.$.Event.hasListeners("afterPivotTableChange")&&this.$.Event.emit("afterPivotTableChange",{sheet:this.sheet,pivotTable:this,action:"refresh"}))}remove(){this.$.Event.hasListeners("beforePivotTableChange")&&this.$.Event.emit("beforePivotTableChange",{sheet:this.sheet,pivotTable:this,action:"remove"}).canceled||(this.sheet.PivotTable.vs(this.name),this.ps(this.location.ref),this.$.Event.hasListeners("afterPivotTableChange")&&this.$.Event.emit("afterPivotTableChange",{sheet:this.sheet,pivotTable:this,action:"remove"}),this.$.ue&&this.$.ue())}}class In{constructor(t){this.sheet=t,this.map=new Map,this.Kn=[]}get size(){return this.map.size}add(t){const e=this.sheet.SN,{sourceSheet:n,sourceRangeRef:i,cellRef:r,name:o}=t,a=r??{r:2,c:0};if(!n||!i)throw new Error("必须指定源工作表和源范围");if(e.Event.hasListeners("beforePivotTableAdd")&&e.Event.emit("beforePivotTableAdd",{sheet:this.sheet,config:t}).canceled)return null;e.Mr||(e.Mr=new Map);const s=new Mn(e,{sourceType:"worksheet",sourceRef:n.name});s.buildFromRange(n,i),e.Mr.set(s.cacheId,s);const l="string"==typeof a?a:e.Utils.cellNumToStr?e.Utils.cellNumToStr(a):`${e.Utils.numToChar(a.c)}${a.r+1}`,c=new _n(this.sheet,{name:o??`数据透视表${this.map.size+1}`,cacheId:s.cacheId,ref:l});return s.fields.forEach((t,e)=>{const n=new vn({name:t.name,numFmtId:t.numFmtId,showAll:!1,sharedItems:t.sharedItems});t.sharedItems&&t.sharedItems.values&&(n.items=t.sharedItems.values.map((t,e)=>({x:e,t:"m"===t.type?"blank":"default"})),n.items.push({t:"default"})),c.pivotFields.push(n)}),c.Wr=s,this.map.set(c.name,c),this.Kn.push(c),e.Event.hasListeners("afterPivotTableAdd")&&e.Event.emit("afterPivotTableAdd",{sheet:this.sheet,config:t,pivotTable:c}),c}yr(t){this.map.set(t.name,t),this.Kn.push(t)}remove(t){const e=this.map.get(t);return!!e&&(e.remove(),!0)}vs(t){const e=this.map.get(t);if(!e)return;this.map.delete(t);const n=this.Kn.indexOf(e);n>-1&&this.Kn.splice(n,1)}get(t){return this.map.get(t)||null}getAll(){return this.Kn}forEach(t){this.Kn.forEach(t)}refreshAll(){this.Kn.forEach(t=>{t.cs=!0,t.calculate(),t.render()})}}function Fn(t){return t.PivotTable||(t.PivotTable=new In(t)),t.PivotTable}function En(t,e,n){const i=e.obj["xl/workbook.xml"]?.workbook,r=(t.Mr?.size??0)+1;if(!i||!i.pivotCaches)return r;const o=yn(i.pivotCaches.pivotCache).find(t=>t["_$r:id"]===n);return o?Number(o._$cacheId):r}function Dn(t,e){const n=t.substring(0,t.lastIndexOf("/")),i=e.split("/"),r=n.split("/");for(const o of i)".."===o?r.pop():"."!==o&&r.push(o);return r.join("/")}function Ln(t=[]){const e=t.reduce((t,e)=>{const n=String(e?._$Id??"").match(/[0-9]+/),i=n?Number(n[0]):0;return i>t?i:t},0);return"rId"+(e+1)}function Pn(t,e){const n=`sheet${e+1}.xml`,i=t?.obj?.["xl/workbook.xml"]?.workbook?.sheets?.sheet,r=Array.isArray(i)?i[e]:0===e?i:null,o=r?.["_$r:id"];if(!o)return n;const a=t.relationship.find(t=>t?._$Id===o&&t?._$Type?.includes("/worksheet"));return a?._$Target&&String(a._$Target).replaceAll("\\","/").split("/").pop()||n}function zn(t,e={}){const{sourceSheet:n,sourceRangeRef:i,targetSheet:r,cellRef:o={r:2,c:0},name:a}=e;if(!n||!i)throw new Error("必须指定源工作表和源范围");t.Mr||(t.Mr=new Map);const s=new Mn(t,{sourceType:"worksheet",sourceRef:n.name});s.buildFromRange(n,i);const l=s.cacheId;t.Mr.set(l,s);let c=r;c||(c=t.addSheet(`透视表${t.Mr.size}`));const h=t.Utils.cellNumToStr?t.Utils.cellNumToStr(o):`${String.fromCharCode(65+o.c)}${o.r+1}`,u=new _n(c,{name:a??`数据透视表${c.PivotTable.size+1}`,cacheId:l,ref:h});return s.fields.forEach((t,e)=>{const n=new vn({name:t.name,numFmtId:t.numFmtId,showAll:!1,sharedItems:t.sharedItems});t.sharedItems&&t.sharedItems.values&&(n.items=t.sharedItems.values.map((t,e)=>({x:e,t:"m"===t.type?"blank":"default"})),n.items.push({t:"default"})),u.pivotFields.push(n)}),u.Wr=s,c.PivotTable.map.set(u.name,u),c.PivotTable.Kn.push(u),u}function On(){this.S=this.SN.Xml.eo(this.rId),this.showGridLines="0"!=this.S?.sheetViews?.sheetView?.[0]?._$showGridLines,this.showRowColHeaders="0"!=this.S?.sheetViews?.sheetView?.[0]?._$showRowColHeaders;const t=this.S?.sheetViews?.sheetView?.[0]||{},e=Number(t._$zoomScale??t._$zoomScaleNormal??100);this.no=Math.min(4,Math.max(.1,(Number.isFinite(e)?e:100)/100)),this.defaultColWidth=Math.round(7.5*(Number(this.S?.sheetFormatPr._$defaultColWidth)||9.5)),this.defaultRowHeight=Math.round(1.333*(Number(this.S?.sheetFormatPr._$defaultRowHeight)||15)),this.views=this.S?.sheetViews?.sheetView??[{pane:{}}],"frozen"==this.views[0]?.pane?._$state&&(this.io=Number(this.views[0].pane._$xSplit)||0,this.ro=Number(this.views[0].pane._$ySplit)||0);const n=this.S?.sheetPr?.outlinePr;this.outlinePr={applyStyles:"1"===n?._$applyStyles,summaryBelow:"0"!==n?._$summaryBelow,summaryRight:"0"!==n?._$summaryRight,showOutlineSymbols:"0"!==n?._$showOutlineSymbols},this.SN.Print?.initSheetPrintSettings&&this.SN.Print.initSheetPrintSettings(this)}function Bn(){const t=function(t){if(!t)return null;if(!wt(t._$sheet,!0))return null;const e={sheet:!0};return yt.forEach(n=>{e[n]=wt(t[`_$${n}`],bt[n])}),t._$password&&(e.passwordHash=String(t._$password).toUpperCase()),t._$algorithmName&&(e.algorithmName=t._$algorithmName),t._$hashValue&&(e.hashValue=t._$hashValue),t._$saltValue&&(e.saltValue=t._$saltValue),void 0!==t._$spinCount&&(e.spinCount=Number(t._$spinCount)),e}(this.S?.sheetProtection);t&&this.protection.enable(t)}function Vn(){const t=this.S?.dimension._$ref??"";let e=32,n=200;if(t.includes(":")){const i=this.rangeStrToNum(t);e=i.e.c+1,n=i.e.r+1}(this.S?.cols?.col??[]).forEach(t=>{for(let e=parseInt(t._$min);e<=parseInt(t._$max);e++)this.cols[e-1]=new w(t,this,e-1)}),(this.S?.sheetData?.row??[]).forEach(t=>{const e=parseInt(t._$r)-1;this.rows[e]=new x(t,this,e)}),this.activeCell=this.SN.Utils.cellStrToNum(this.views[0]?.selection?._$activeCell??"A1");const i=this.SN.Utils.cellStrToNum(this.views[0]?._$topLeftCell??"A1");this.vi={colArr:[i.c],rowArr:[i.r]},this.activeCell.r>n-1&&(n=this.activeCell.r+1),this.activeCell.c>e-1&&(e=this.activeCell.c+1),this.cols[e-1]||(this.cols[e-1]=new w(null,this,e-1)),this.rows[n-1]||(this.rows[n-1]=new x(null,this,n-1))}function Hn(){const t=this.S?.hyperlinks?.hyperlink??[],e=this.SN.Xml.resolveHyperlinkById(this.rId);t.forEach(t=>{const n=this.getCell(t._$ref);n.hyperlink={target:e?.[t["_$r:id"]]?._$Target||null,location:t._$location||null,tooltip:t._$tooltip||null},t.display&&(n.editVal=t.display)})}function Un(){(this.S?.dataValidations?.dataValidation??[]).forEach(t=>{t._$sqref.includes(":")||(t._$sqref=`${t._$sqref}:${t._$sqref}`),this.eachCells(t._$sqref,(e,n)=>{const i={type:t._$type,imeMode:t._$imeMode,operator:t._$operator,allowBlank:"1"==t._$allowBlank,formula1:t.formula1,showDropDown:"1"!=t._$showDropDown,formula2:t.formula2,showInputMessage:"1"==t._$showInputMessage,promptTitle:t._$promptTitle,prompt:t._$prompt,showErrorMessage:"1"==t._$showErrorMessage,errorTitle:t._$errorTitle,error:t._$error,errorStyle:t._$errorStyle};"list"==i.type&&(i.formula1=t?.formula1?.slice(1,-1).split(",")),"date"==i.type&&(i.formula1=Qt(i.formula1),i.formula2=Qt(i.formula2)),"time"==i.type&&(i.formula1=te(i.formula1),i.formula2=te(i.formula2)),this.getCell(e,n)._=i})})}function qn(){(this.S?.mergeCells?.mergeCell??[]).forEach(t=>{const e=this.rangeStrToNum(t._$ref);this.merges.push(e),this.eachCells(e,(t,n)=>{const i=this.getCell(t,n);i.isMerged=!0,i.master={r:e.s.r,c:e.s.c}})})}function Kn(){this.Drawing=new Ce(this),this.Drawing.jn(this.S)}function Wn(){var t;this.Slicer=new pn(this),t=this.SN.Xml,function(t){const e=t.SN.so||[];let n=0;return e.forEach(e=>{if(e?._$sheet!==t.name)return;const i=Number(e?._$cacheId),r=t.SN.zi?.get(i)||new nn(t.SN,{cacheId:i,sourceType:e?._$sourceType,sourceSheet:e?._$sheet,sourceName:e?._$sourceName,fieldIndex:Number(e?._$fieldIndex??0),fieldName:e?._$fieldName??""});t.SN.zi.has(r.cacheId)||t.SN.zi.set(r.cacheId,r);const o=un(e?.["sn:selection"]?.["sn:item"]).map(t=>t?._$key).filter(Boolean),a=e?.["sn:anchor"],s=Number(a?._$startRow??0),l=Number(a?._$startCol??0),c=Number(a?._$offsetX??0),h=Number(a?._$offsetY??0),u=Number(a?._$width??180),d=Number(a?._$height??220),f=t.Drawing.Wn({type:"slicer",startCell:{r:s,c:l},offsetX:c,offsetY:h,width:u,height:d,anchorType:"oneCell"}),p=new hn(t,{id:e?._$id??`Slicer_${Date.now()}`,name:e?._$name??e?._$id,caption:e?._$caption??"",cacheId:r.cacheId,sourceType:e?._$sourceType??"table",sourceSheet:e?._$sheet??t.name,sourceName:e?._$sourceName??"",fieldIndex:Number(e?._$fieldIndex??0),fieldName:e?._$fieldName??"",columns:Number(e?._$columns??1),buttonHeight:Number(e?._$buttonHeight??22),showHeader:"0"!==e?._$showHeader,multiSelect:"1"===e?._$multiSelect,styleName:e?._$styleName??"SlicerStyleLight1",selectedKeys:o,drawing:f});t.Slicer.yr(p),o.length>0&&p.applyFilter(),n+=1}),n}(this)>0||function(t,e){const n=t.SN.oo;if(!n||0===n.size)return;const i=un(t.S?.extLst?.ext),r=[];if(i.forEach(t=>{const e=t?.["x14:slicerList"];e&&un(e?.["x14:slicer"]).forEach(t=>{const e=t?.["_$r:id"];e&&r.push(e)})}),0===r.length)return;const o=function(t,e){const n=new Map,i=t.S,r=i?.drawing?.["_$r:id"];if(!r)return n;const o=t.SN.Xml.getWsRelsFileTarget(t.rId,r);if(!o)return n;const a=e.obj[o]?.["xdr:wsDr"];if(!a)return n;const s=un(a["xdr:oneCellAnchor"]),l=un(a["xdr:twoCellAnchor"]);return s.concat(l).forEach(e=>{const i=function(t,e){if(t?.["xdr:graphicFrame"])return t["xdr:graphicFrame"];const n=t?.["mc:AlternateContent"];if(!n)return null;const i=e.objToArr(n["mc:Choice"]);for(const r of i)if(r?.["xdr:graphicFrame"])return r["xdr:graphicFrame"];return null}(e,t.SN.Utils);if(!i)return;const r=i["a:graphic"]?.["a:graphicData"];if(!String(r?._$uri||"").toLowerCase().includes("/slicer"))return;const o=r?.["sle:slicer"]||r?.["sle15:slicer"],a=o?._$name||i?.["xdr:nvGraphicFramePr"]?.["xdr:cNvPr"]?._$name;if(!a)return;const s=e?.["xdr:from"],l=e?.["xdr:to"];if(!s||!l)return;const c=dn(s["xdr:row"],0),h=dn(s["xdr:col"],0),u=dn(l["xdr:row"],c),d=dn(l["xdr:col"],h),f=t.Utils.emuToPx(dn(s["xdr:colOff"],0)),p=t.Utils.emuToPx(dn(s["xdr:rowOff"],0)),m=t.Utils.emuToPx(dn(l["xdr:colOff"],0)),g=t.Utils.emuToPx(dn(l["xdr:rowOff"],0)),v=fn(t,h,d,f,m,"col"),y=fn(t,c,u,p,g,"row");n.set(a,{startRow:c,startCol:h,offsetX:f,offsetY:p,width:v,height:y})}),n}(t,e);r.forEach((i,r)=>{const a=t.SN.Xml.getWsRelsFileTarget(t.rId,i),s=a?e.obj[a]?.slicers:null;un(s?.slicer).forEach((e,i)=>{const a=n.get(e?._$cache),s=function(t,e,n){const i=t.SN;i.zi||(i.zi=new Map);const r=e?.cacheId;if(Number.isFinite(r)&&i.zi.has(r)){const t=i.zi.get(r);return e?.cacheName&&!t.ao&&(t.ao=e.cacheName),t}const o=function(t,e){if(!Number.isFinite(e))return null;const n=`table_${e}`,i=t.Table?.get(n);if(i)return i;for(const r of t.SN.sheets||[]){if(r===t)continue;const e=r.Table?.get(n);if(e)return e}return null}(t,Number(e?.tableId)),a=function(t,e,n){const i=e?.sourceName||n?._$name||"",r=t?.columns||[];if(i&&r.length>0){const t=r.findIndex(t=>t?.name===i);if(t>=0)return t}const o=Number(e?.column);if(!Number.isFinite(o))return 0;if(r.length>0){if(o>=0&&o<r.length)return i&&r[o]?.name!==i&&o>0&&r[o-1]?.name===i?o-1:o;if(o>0&&o-1<r.length)return o-1}return o>0?o-1:0}(o,e,n),s=o?.columns?.[a]?.name||e?.sourceName||n?._$name||"",l=new nn(i,{cacheId:r,sourceType:"table",sourceSheet:o?.sheet?.name||t.name,sourceName:o?.name||o?.displayName||null,sourceId:o?.id||(Number.isFinite(Number(e?.tableId))?`table_${Number(e.tableId)}`:null),fieldIndex:a,fieldName:s});return l.ao=e?.cacheName||null,i.zi.set(l.cacheId,l),l}(t,a,e),l=o.get(e?._$name)||{startRow:0,startCol:0,offsetX:0,offsetY:0,width:180,height:220},c=t.Drawing.Wn({type:"slicer",startCell:{r:l.startRow,c:l.startCol},offsetX:l.offsetX,offsetY:l.offsetY,width:l.width||180,height:l.height||220,anchorType:"oneCell"}),h=Math.max(18,Math.round(t.Utils.emuToPx(dn(e?._$rowHeight,217488)))),u=e?._$name||`Slicer_${r}_${i}`,d=new hn(t,{id:`Slicer_${u}_${r}_${i}`,name:e?._$name||u,caption:e?._$caption||e?._$name||s.fieldName,cacheId:s.cacheId,sourceType:s.sourceType,sourceSheet:s.sourceSheet,sourceName:s.sourceName,sourceId:s.sourceId,fieldIndex:s.fieldIndex,fieldName:s.fieldName,columns:dn(e?._$columnCount,1),buttonHeight:h,showHeader:"0"!==e?._$showCaption,multiSelect:!1,styleName:e?._$style||"SlicerStyleLight1",drawing:c});t.Slicer.yr(d)})})}(this,t)}function jn(){this.PivotTable?0!==this.PivotTable.size&&this.PivotTable.getAll().forEach(t=>{0===t.rowFields.length&&0===t.colFields.length&&0===t.dataFields.length&&0===t.pageFields.length||(t.cs=!0,t.calculate(),t.render({silent:!0}))}):this.PivotTable=new In(this)}function Gn(){this.Sparkline=new Me(this),this.Sparkline.parse(this.S)}function Xn(){this.Comment.parse(this.S)}function Yn(){this.CF=new Ze(this),this.CF.parse(this.S)}function Zn(){this.AutoFilter.parse(this.S)}function Jn(){const t=this.SN.Xml.lo(this.rId);t&&function(t,e,n){const i=`xl/worksheets/_rels/${n}.rels`,r=e[i]?.Relationships?.Relationship;r&&(Array.isArray(r)?r:[r]).forEach(n=>{if(!n._$Type?.includes("/table"))return;let i=n._$Target;i.startsWith("../")?i=`xl/${i.substring(3)}`:i.startsWith("xl/")||(i=`xl/tables/${i}`);const r=e[i];r&&function(t,e){const n=e?.table;if(!n)return null;const i=n._$ref,r=n._$name,o=n._$displayName||r,a=n._$id,s=n.tableColumns?.tableColumn,l=(Array.isArray(s)?s:s?[s]:[]).map(t=>({id:Number.parseInt(t._$id,10)||0,name:t._$name||"",dataDxfId:Je(t._$dataDxfId),totalsRowFunction:t._$totalsRowFunction||null,totalsRowLabel:t._$totalsRowLabel||null})),c=n.tableStyleInfo||{},h=c._$name||"TableStyleMedium2",u="1"===c._$showFirstColumn,d="1"===c._$showLastColumn,f="0"!==c._$showRowStripes,p="1"===c._$showColumnStripes,m=(Number.parseInt(n._$headerRowCount,10)||1)>0,g=(Number.parseInt(n._$totalsRowCount,10)||0)>0;t.Table.add({id:`table_${a}`,name:r,displayName:o,rangeRef:i,columns:l,styleId:h,showHeaderRow:m,showTotalsRow:g,showFirstColumn:u,showLastColumn:d,showRowStripes:f,showColumnStripes:p,autoFilterEnabled:!!n.autoFilter,headerRowDxfId:Je(n._$headerRowDxfId),dataDxfId:Je(n._$dataDxfId),headerRowBorderDxfId:Je(n._$headerRowBorderDxfId),tableBorderDxfId:Je(n._$tableBorderDxfId),totalsRowBorderDxfId:Je(n._$totalsRowBorderDxfId),Ge:n.autoFilter||null,Ce:!0})}(t,r)})}(this,this.SN.Xml.obj,t)}function Qn(){this.SN.DependencyGraph&&this.SN.DependencyGraph.rebuildForSheet(this)}let ti=null;function ei(t,e,n){return t?.hasListeners?.(e)?t.Event.emit(e,n):null}function ni(t,e){return{editVal:t.B,calcVal:t.H,type:t.P,style:t.O?JSON.parse(JSON.stringify(t.O)):null,hyperlink:t.F?JSON.parse(JSON.stringify(t.F)):null,dataValidation:t._?JSON.parse(JSON.stringify(t._)):null,isMerged:t.isMerged,master:t.master?{r:t.master.r,c:t.master.c}:null}}function ii(t,e,n,i,r){let o=e.editVal;if(i!==rt.NONE&&"number"==typeof e.calcVal){const n="number"==typeof t.calcVal?t.calcVal:0,r=e.calcVal;switch(i){case rt.ADD:o=n+r;break;case rt.SUBTRACT:o=n-r;break;case rt.MULTIPLY:o=n*r;break;case rt.DIVIDE:o=0!==r?n/r:"#DIV/0!"}}switch(n){case it.ALL:case it.ALL_MERGE_CONDITIONAL:ri(t,o),e.style&&(t.O=JSON.parse(JSON.stringify(e.style))),e.hyperlink&&(t.F=JSON.parse(JSON.stringify(e.hyperlink))),e.dataValidation&&(t._=JSON.parse(JSON.stringify(e.dataValidation)));break;case it.VALUE:const n=void 0!==e.calcVal?e.calcVal:e.editVal;ri(t,i!==rt.NONE?o:n);break;case it.FORMULA:"string"==typeof e.editVal&&e.editVal.startsWith("="),ri(t,e.editVal);break;case it.FORMAT:e.style&&(t.O=JSON.parse(JSON.stringify(e.style)));break;case it.NO_BORDER:if(ri(t,o),e.style){const n=JSON.parse(JSON.stringify(e.style));delete n.border,t.O=n}e.hyperlink&&(t.F=JSON.parse(JSON.stringify(e.hyperlink))),e.dataValidation&&(t._=JSON.parse(JSON.stringify(e.dataValidation)));break;case it.VALUE_NUMBER_FORMAT:ri(t,void 0!==e.calcVal?e.calcVal:e.editVal),e.style?.numFmt&&(t.O||(t.O={}),t.O.numFmt=e.style.numFmt);break;case it.FORMULA_NUMBER_FORMAT:ri(t,e.editVal),e.style?.numFmt&&(t.O||(t.O={}),t.O.numFmt=e.style.numFmt);break;case it.COLUMN_WIDTH:case it.Comment:break;case it.VALIDATION:e.dataValidation&&(t._=JSON.parse(JSON.stringify(e.dataValidation)));break;case it.TRANSPOSE:ri(t,o),e.style&&(t.O=JSON.parse(JSON.stringify(e.style))),e.hyperlink&&(t.F=JSON.parse(JSON.stringify(e.hyperlink))),e.dataValidation&&(t._=JSON.parse(JSON.stringify(e.dataValidation)))}}function ri(t,e){t.H=void 0,t.U=void 0,null==e||""===e||void 0===e||Number.isNaN(e)?(t.P=void 0,t.B=""):"number"==typeof e?(t.B=e,t.P=void 0):"string"==typeof e&&e.trim().startsWith("=")?(t.B=e.trim(),t.P=void 0):"boolean"==typeof e?(t.B=e,t.P="boolean"):"string"!=typeof e||""===e.trim()||isNaN(Number(e))?(t.B=e,t.P="string"):(t.B=parseFloat(e),t.P=void 0)}function oi(t){return[it.ALL,it.ALL_MERGE_CONDITIONAL,it.FORMAT,it.NO_BORDER,it.TRANSPOSE].includes(t)}function ai(t){return[it.ALL,it.ALL_MERGE_CONDITIONAL,it.Comment].includes(t)}function si(t){return""===t.editVal||null===t.editVal||void 0===t.editVal}function li(t){if(!t||!t.data)return null;const e=t.data.map((e,n)=>e.map((e,i)=>{const r=""!==e&&null!=e&&!isNaN(Number(e));return{editVal:e,calcVal:r?Number(e):e,type:r?"number":"string",style:t.styles?.[n]?.[i]||null,hyperlink:null,dataValidation:null,isMerged:!1,master:null}}));return{sheetName:null,area:{s:{r:0,c:0},e:{r:e.length-1,c:e[0]?.length-1||0}},isCut:!1,cells:e,merges:t.merges||[],colWidths:[],rowHeights:[],comments:[],timestamp:Date.now(),isExternal:!0}}function ci(t){if(!t)return null;const e=t.split(/\r\n|\n/).filter(t=>t).map(t=>t.split("\t").map(t=>{const e=""!==t&&t.length<=15&&!isNaN(Number(t));return{editVal:e?Number(t):t,calcVal:e?Number(t):t,type:e?"number":"string",style:null,hyperlink:null,dataValidation:null,isMerged:!1,master:null}}));return{sheetName:null,area:{s:{r:0,c:0},e:{r:e.length-1,c:e[0]?.length-1||0}},isCut:!1,cells:e,merges:[],colWidths:[],rowHeights:[],comments:[],timestamp:Date.now(),isExternal:!0}}class hi{ye;St;co;ho;uo;constructor(t,e){this.SN=e,this.rId=t["_$r:id"],this.Utils=e.Utils,this.Canvas=e.Canvas,this.merges=[],this.vi=null,this.views=[{pane:{}}],this.rows=[],this.cols=[],this.initialized=!1,this.showGridLines=!0,this.showRowColHeaders=!0,this.showPageBreaks=!1,this.outlinePr={applyStyles:!1,summaryBelow:!0,summaryRight:!0,showOutlineSymbols:!0},this.printSettings=null,this.protection=new St(this),this.Comment=new T(this),this.AutoFilter=new N(this),this.Table=new et(this),this.Drawing=null,this.Sparkline=null,this.CF=null,this.Slicer=null,this.PivotTable=null,this.S=null,this.ye=t._$name,this.St="hidden"==t._$state,this.co={r:0,c:0},this.ho=0,this.uo=0,this.do=this.Canvas.handleLayer,this.mo={keep:!1,area:null},this.po=[],this.vo=50,this.bo=23,this.bt=new Set,this.yt=new Set,this.Rt=0,this.io=0,this.ro=0,this.yo=0,this.wo=0,this.no=1,this.wn=0}get activeCell(){return this.co}set activeCell(t){const e=this.co;this.SN.Event.emit("beforeSelectionChange",{sheet:this,oldCell:e,newCell:t,type:"activeCell"}).canceled||(this.co=t,this.SN.Event.emit("afterSelectionChange",{sheet:this,oldCell:e,newCell:t,type:"activeCell"}))}get activeAreas(){if(this.po.length>0)return this.po;const t=this.getCell(this.activeCell.r,this.activeCell.c);return t.isMerged?this.po=[this.merges.find(e=>e.s.r==t.master.r&&e.s.c==t.master.c)]:this.po.push({s:this.activeCell,e:this.activeCell}),this.po}set activeAreas(t){const e=this.po;this.SN.Event.emit("beforeSelectionChange",{sheet:this,oldAreas:e,newAreas:t,type:"activeAreas"}).canceled||(this.po=t,this.SN.Event.emit("afterSelectionChange",{sheet:this,oldAreas:e,newAreas:t,type:"activeAreas"}))}get zoom(){return this.no??1}set zoom(t){const e=Number(t),n=Number.isFinite(e)?Math.min(4,Math.max(.1,e)):1,i=this.no??1;if(i!==n){if(this.SN.Event.hasListeners("beforeZoomChange")&&this.SN.Event.emit("beforeZoomChange",{sheet:this,oldZoom:i,newZoom:n}).canceled)return;this.no=n,this===this.SN.activeSheet&&(this.SN.Canvas.applyZoom(),this.SN.ue(),this.SN.xo()),this.SN.Event.hasListeners("afterZoomChange")&&this.SN.Event.emit("afterZoomChange",{sheet:this,oldZoom:i,newZoom:n})}}zoomIn(t=.1){return this.zoom=this.zoom+t,this.zoom}zoomOut(t=.1){return this.zoom=this.zoom-t,this.zoom}zoomToSelection(){const t=this.activeAreas??[];let e=1/0,n=1/0,i=-1,r=-1;if(0===t.length){const t=this.activeCell;if(!t)return;e=i=t.r,n=r=t.c}else t.forEach(t=>{t?.s&&t?.e&&(e=Math.min(e,t.s.r,t.e.r),n=Math.min(n,t.s.c,t.e.c),i=Math.max(i,t.s.r,t.e.r),r=Math.max(r,t.s.c,t.e.c))});if(!Number.isFinite(e)||!Number.isFinite(n))return;let o=0;for(let f=n;f<=r;f++){const t=this.getCol(f);t.hidden||(o+=t.width)}let a=0;for(let f=e;f<=i;f++){const t=this.getRow(f);t.hidden||(a+=t.height)}const s=Math.max(0,this.SN.Canvas.viewWidth-this.indexWidth),l=Math.max(0,this.SN.Canvas.viewHeight-this.headHeight);if(o<=0||a<=0||s<=0||l<=0)return;const c=Math.min(s/o,l/a);if(!Number.isFinite(c)||c<=0)return;let h=e,u=n;this.getRow(e)?.hidden&&(h=this.$o(e-1,1)),this.getCol(n)?.hidden&&(u=this.Mo(n-1,1)),h=Number.isFinite(h)?Math.max(0,h):0,u=Number.isFinite(u)?Math.max(0,u):0,this.vi||(this.vi={rowArr:[h],colArr:[u]}),Array.isArray(this.vi.rowArr)||(this.vi.rowArr=[h]),Array.isArray(this.vi.colArr)||(this.vi.colArr=[u]),this.vi.rowArr[0]=h,this.vi.colArr[0]=u,this.activeCell={r:e,c:n};const d=this.zoom;return this.zoom=c,this===this.SN.activeSheet&&d===this.zoom&&this.SN.ue(),this.zoom}get viewStart(){return{r:this.vi?.rowArr?.[0]??0,c:this.vi?.colArr?.[0]??0}}set viewStart(t){this.vi||(this.vi={rowArr:[0],colArr:[0]}),void 0!==t.r&&(this.vi.rowArr=[t.r]),void 0!==t.c&&(this.vi.colArr=[t.c])}get defaultColWidth(){return this.ho}set defaultColWidth(t){const e=Number(t),n=Number.isFinite(e)?Math.max(1,Math.round(e)):this.ho;if(n===this.ho)return;const i=this.ho;this.ho=n,this.Ft=void 0,this.cols.forEach(t=>{t&&t.Nt===i&&(t.Nt=n)})}get defaultRowHeight(){return this.uo}set defaultRowHeight(t){const e=Number(t),n=Number.isFinite(e)?Math.max(1,Math.round(e)):this.uo;if(n===this.uo)return;const i=this.uo;this.uo=n,this.Ct=void 0,this.rows.forEach(t=>{t&&t.Mt===i&&(t.Mt=n)})}get indexWidth(){return this.showRowColHeaders?this.vo:0}set indexWidth(t){this.vo=t}get headHeight(){return this.showRowColHeaders?this.bo:0}set headHeight(t){this.bo=t}get frozenCols(){return this.io}set frozenCols(t){const e=this.io;this.SN.UndoRedo.add({undo:()=>{this.io=e},redo:()=>{this.io=t}}),this.io=t}get frozenRows(){return this.ro}set frozenRows(t){const e=this.ro;this.SN.UndoRedo.add({undo:()=>{this.ro=e},redo:()=>{this.ro=t}}),this.ro=t}get hidden(){return this.St}set hidden(t){const e=!!t;if(this.hidden==e)return;if(e&&1==this.SN.sheets.filter(t=>!t.hidden).length)return this.SN.Utils.toast(this.SN.t("core.sheet.sheet.toast.msg001"));const n=this.St,i=e?"SheetHide":"SheetShow";this.SN.Event.hasListeners(`before${i}`)&&this.SN.Event.emit(`before${i}`,{sheet:this,oldHidden:n,newHidden:e}).canceled||(this.St=e,this.SN.activeSheet.name==this.name&&(this.SN.activeSheet=this.SN.sheets.find(t=>!t.hidden)),this.SN.Event.hasListeners(`after${i}`)&&this.SN.Event.emit(`after${i}`,{sheet:this,oldHidden:n,newHidden:e}))}get name(){return this.ye}set name(t){const e=this.ye;if(e!==t){if(this.SN.Event.hasListeners("beforeSheetRename")&&this.SN.Event.emit("beforeSheetRename",{sheet:this,oldName:e,newName:t}).canceled)return;this.ye=t,this.SN.Co(),this.SN.Event.hasListeners("afterSheetRename")&&this.SN.Event.emit("afterSheetRename",{sheet:this,oldName:e,newName:t})}}get rowCount(){return this.rows.length}get colCount(){return this.cols.length}rangeStrToNum(t){const e=t.replace(/['$]/g,"").split(":");let n,i,r,o,a,s;return/^\d+$/.test(e[0])?(a=parseInt(e[0],10)-1,s=parseInt(e[1],10)-1,r=0,o=this.colCount-1):/^[A-Z]+$/.test(e[0])?(r=this.Utils.charToNum(e[0]),o=this.Utils.charToNum(e[1]),a=0,s=this.rowCount-1):(n=e[0].match(/([A-Z]+)(\d+)/),i=e[1]?e[1].match(/([A-Z]+)(\d+)/):n,r=this.Utils.charToNum(n[1]),a=parseInt(n[2],10)-1,o=this.Utils.charToNum(i[1]),s=parseInt(i[2],10)-1),{s:{c:Math.min(r,o),r:Math.min(a,s)},e:{c:Math.max(r,o),r:Math.max(a,s)}}}getRow(t){return this.rows[t]||(this.rows[t]=new x(null,this,t)),this.rows[t].rIndex=t,this.rows[t]}getCol(t){return this.cols[t]||(this.cols[t]=new w(null,this,t)),this.cols[t]}getCell(t,e){"string"==typeof t&&({r:t,c:e}=this.Utils.cellStrToNum(t));const n=this.getRow(t);return n.cells[e]||(n.cells[e]=new b(null,n,e)),n.cells[e]}eachCells(t,e,n={}){const{reverse:i=!1,sparse:r=!1}=n;Array.isArray(t)||(t=[t]);const o=t.map(t=>"string"==typeof t?this.rangeStrToNum(t):t),a=new Set;r?this.rows.forEach((t,n)=>{t&&t.cells.forEach((t,i)=>{if(!t)return;const r=o.find(({s:t,e})=>n>=t.r&&n<=e.r&&i>=t.c&&i<=e.c);if(!r)return;const s=n<<16|i;a.has(s)||(a.add(s),e(n,i,r))})}):o.forEach(({s:t,e:n})=>{const[r,o,s]=i?[n.r,t.r,-1]:[t.r,n.r,1],[l,c,h]=i?[n.c,t.c,-1]:[t.c,n.c,1];for(let u=r;i?u>=o:u<=o;u+=s)for(let r=l;i?r>=c:r<=c;r+=h){const i=u<<16|r;a.has(i)||(a.add(i),e(u,r,{s:t,e:n}))}})}setBrush(t=!1){if(this.mo.area)return this.mo.area=null,this.mo.keep=!1,void this.SN.Layout?.refreshActiveButtons?.();this.mo.keep=t,this.mo.area={...this.activeAreas[this.activeAreas.length-1]},this.So(),this.SN.Layout?.refreshActiveButtons?.()}cancelBrush(){return!!this.mo.area&&(this.mo.area=null,this.mo.keep=!1,this.mo.formats=null,this.SN.Layout?.refreshActiveButtons?.(),!0)}applyBrush(t){if(!this.mo.area||!this.mo.formats)return!1;const{sourceRows:e,sourceCols:n,formats:i}=this.mo;for(let r=t.s.r;r<=t.e.r;r++)for(let o=t.s.c;o<=t.e.c;o++){const a=(r-t.s.r)%e,s=(o-t.s.c)%n,l=i[a]?.[s];if(!l)continue;const c=this.getCell(r,o);l.style&&(c.style=JSON.parse(JSON.stringify(l.style))),l.numFmt&&(c.numFmt=l.numFmt),l.border&&(c.border=JSON.parse(JSON.stringify(l.border)))}return this.mo.keep||(this.mo.area=null,this.mo.formats=null,this.SN.Layout?.refreshActiveButtons?.()),!0}moveArea(t,e){if("string"==typeof t&&(t=this.rangeStrToNum(t)),"string"==typeof e&&(e=this.rangeStrToNum(e)),this.SN.Event.hasListeners("beforeMoveArea")&&this.SN.Event.emit("beforeMoveArea",{sheet:this,moveArea:t,targetArea:e}).canceled)return!1;const n=e.s.r-t.s.r,i=e.s.c-t.s.c,r=[],o=[];this.eachCells(t,(t,e)=>{const n=this.getCell(t,e);o.push({style:n.style,editVal:n.editVal,hyperlink:n.hyperlink,dataValidation:n.dataValidation}),n.style={},n.editVal="",n.hyperlink=null,n.dataValidation=null,n.master&&n.master.r==t&&n.master.c==e&&(r.push(this.merges.find(t=>t.s.r==n.master.r&&t.s.c==n.master.c)),this.unMergeCells({r:t,c:e}))});let a=0;return this.eachCells(e,(t,e)=>{const n=this.getCell(t,e);n.isMerged&&this.unMergeCells({r:t,c:e}),n.style=o[a]?.style??{},n.editVal=o[a]?.editVal??null,n.hyperlink=o[a]?.hyperlink??null,n.dataValidation=o[a]?.dataValidation??null,a++}),r.forEach(t=>{t.s.r+=n,t.s.c+=i,t.e.r+=n,t.e.c+=i,this.mergeCells(t)}),this.SN.Event.hasListeners("afterMoveArea")&&this.SN.Event.emit("afterMoveArea",{sheet:this,moveArea:t,targetArea:e}),!0}paddingArea(t=this.Canvas.lastPadding.oArea,e=this.Canvas.lastPadding.targetArea,n="order"){"string"==typeof t&&(t=this.rangeStrToNum(t)),"string"==typeof e&&(e=this.rangeStrToNum(e));const i=[];this.eachCells(t,(t,e)=>{const n=this.getCell(t,e);i.push({type:n.type,style:{...n.style},editVal:n.editVal,B:n.B,cellIndex:{r:t,c:e}})});const r="add"==(e.s.r>=t.s.r?"add":"reduce")?1:-1;let o=0,a=null;this.eachCells(e,(t,e)=>{const s=this.getCell(t,e);s.isMerged&&this.unMergeCells({r:t,c:e});const l=i[o];switch(n){case"order":{const t=((t,e)=>{let n;if(["date","dateTime"].includes(t.type)){const i=e?new Date(e):new Date(t.B);i.setDate(i.getDate()+r),n=i.toLocaleString()}else if("time"===t.type){const i=e?new Date(e):new Date(t.B);i.setHours(i.getHours()+r),n=i.toLocaleString()}else if("number"==typeof t.editVal)n=("number"==typeof e?e:t.editVal)+r;else if("string"==typeof t.editVal&&/\d+/.test(t.editVal)){const i="string"==typeof e&&e.match(/(\d+)/),o=(i?parseInt(i[0],10):parseInt(t.editVal.match(/(\d+)/)[0],10))+r;n=t.editVal.replace(/(\d+)/,o)}else n=t.editVal;return n})(l,a);s.editVal=t,s.style={...l.style},a=t;break}case"copy":s.style={...l.style},s.editVal=l.editVal;break;case"format":s.style={...l.style},s.editVal=null;break;case"noFormat":s.editVal=l.editVal,s.style={}}++o>=i.length&&(o=0)})}showAllHidRows(){for(let t=0;t<this.rowCount;t++)this.getRow(t).hidden=!1}showAllHidCols(){for(let t=0;t<this.colCount;t++)this.getCol(t).hidden=!1}areasBorder(t,e,n=this.activeAreas){Array.isArray(n)||(n=[n]);const i=e&&"object"==typeof e&&""!==e.style;this.eachCells(n,(n,r,o)=>{const{s:a,e:s}=o,l={};if("none"===t)l.top=null,l.left=null,l.bottom=null,l.right=null,l.diagonal=null,l.diagonalUp=null,l.diagonalDown=null;else if("out"===t)n===a.r&&(l.top=e),r===a.c&&(l.left=e),n===s.r&&(l.bottom=e),r===s.c&&(l.right=e);else if("inner"===t)n>a.r&&(l.top=e),r>a.c&&(l.left=e);else if("top"===t&&n===a.r)l.top=e;else if("left"===t&&r===a.c)l.left=e;else if("bottom"===t&&n===s.r)l.bottom=e;else if("right"===t&&r===s.c)l.right=e;else if("diagonalDown"===t)l.diagonal=i?e:null,l.diagonalDown=!!i||null;else if("diagonalUp"===t)l.diagonal=i?e:null,l.diagonalUp=!!i||null;else{if("all"!==t)return;l.top=e,l.left=e,l.bottom=e,l.right=e}Object.keys(l).length&&(this.getCell(n,r).border=l,n==a.r&&0!=n&&l.top?this.getCell(n-1,r).border={bottom:null}:n==s.r&&n!=this.rowCount-1&&l.bottom&&(this.getCell(n+1,r).border={top:null}),r==a.c&&0!=r&&l.left?this.getCell(n,r-1).border={right:null}:r==s.c&&r!=this.colCount-1&&l.right&&(this.getCell(n,r+1).border={left:null}))})}hyperlinkJump(){const t=this.getCell(this.activeCell.r,this.activeCell.c);if(!t.hyperlink)return this.SN.Canvas.hyperlinkJumpBtn.style.display="none";const e=t.hyperlink.location;if(e){let t=this,n=null;if(e.includes("!")){let[i,r]=e.split("!");i.includes(" ")&&i.startsWith("'")&&i.endsWith("'")&&(i=i.slice(1,-1)),t=this.SN.getSheet(i),n=r}else n=e;const i=t.getCell(n);t.activeCell={r:i.row.rIndex,c:i.cIndex},t.activeAreas=[],t.viewStart={r:t.activeCell.r,c:t.activeCell.c},this.SN.activeSheet=t}else{const e=t?.hyperlink?.target;window.open(e??"")}this.SN.Canvas.hyperlinkJumpBtn.style.display="none"}So(){if(!this.mo.area)return;const{s:t,e}=this.mo.area,n=[];for(let i=t.r;i<=e.r;i++){const r=[];for(let n=t.c;n<=e.c;n++){const t=this.getCell(i,n);r.push({style:t.style?JSON.parse(JSON.stringify(t.style)):{},numFmt:t.numFmt||null,border:t.border?JSON.parse(JSON.stringify(t.border)):null})}n.push(r)}this.mo.formats=n,this.mo.sourceRows=e.r-t.r+1,this.mo.sourceCols=e.c-t.c+1}}function ui(t,e,n){const i=parseInt(t.substr(1,2),16),r=parseInt(t.substr(3,2),16),o=parseInt(t.substr(5,2),16),a=parseInt(e.substr(1,2),16),s=parseInt(e.substr(3,2),16),l=parseInt(e.substr(5,2),16);return"#"+((1<<24)+(Math.round(i+(a-i)*n)<<16)+(Math.round(r+(s-r)*n)<<8)+Math.round(o+(l-o)*n)).toString(16).slice(1)}function di(t,e){return!!(t?.protection?.enabled&&e?.protection?.hidden&&e?.isFormula)}function fi(t,e){return e?di(t,e)?"":e.editVal?.toString()??"":""}function pi(...t){for(const e of t)if(void 0!==e)return e}function mi(t,e){if(!e)return t;const n={...t};return e.fill?.fgColor&&(n.bgColor=e.fill.fgColor),e.font?.color&&(n.fgColor=e.font.color),"boolean"==typeof e.font?.bold&&(n.isBold=e.font.bold),n}function gi(t,e){const n=t.bgColor??null,i=t.fgColor??e??function(t){if("string"!=typeof t)return null;const e=t.trim().match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);if(!e)return null;let n=e[1];return 3===n.length&&(n=n.split("").map(t=>t+t).join("")),(299*parseInt(n.slice(0,2),16)+587*parseInt(n.slice(2,4),16)+114*parseInt(n.slice(4,6),16))/1e3<150?"#FFFFFF":null}(n);return{bgColor:n,fgColor:i,isBold:!!t.isBold,borderColor:t.borderColor??null,Ce:!0===t.Ce}}function vi(t,e,n,i=1,r=1){const o=Math.max(1,i||1);return t%(o+Math.max(1,r||1))<o?e:n}function yi(t,e,n,i,r,o=!1,a=null,s=null){const l=a?.fill?.fgColor;let c=null;if(l?c=l:!0===s?.Ce&&s?.bgColor?c=s.bgColor:"pattern"===r.fill.type&&"solid"===r.fill.pattern&&r.fill.fgColor?c=r.fill.fgColor:s?.bgColor&&(c=s.bgColor),c)this.bc.fillStyle=c,this.bc.fillRect(t,e,n,i);else if("pattern"!==r.fill.type||"solid"!=r.fill.pattern&&"none"!=r.fill.pattern)if("pattern"===r.fill.type){this.pCtx.clearRect(0,0,8,8);const o=this.eyeProtectionMode?this.eyeProtectionColor:"#ffffff";switch(this.pCtx.fillStyle=r.fill.bgColor||o,this.pCtx.fillRect(0,0,8,8),this.pCtx.fillStyle=r.fill.fgColor||"#000000",this.pCtx.strokeStyle=r.fill.fgColor||"#000000",r.fill.pattern){case"solid":default:this.pCtx.fillRect(0,0,8,8);break;case"darkGray":this.pCtx.fillRect(0,0,4,4),this.pCtx.fillRect(4,4,4,4);break;case"mediumGray":this.pCtx.fillRect(0,0,8,4),this.pCtx.fillRect(0,4,4,4);break;case"lightGray":this.pCtx.fillRect(0,0,2,2),this.pCtx.fillRect(6,0,2,2),this.pCtx.fillRect(0,6,2,2),this.pCtx.fillRect(6,6,2,2);break;case"gray125":this.pCtx.fillRect(0,0,1,1),this.pCtx.fillRect(4,4,1,1);break;case"gray0625":this.pCtx.fillRect(0,0,1,1);break;case"darkHorizontal":for(let t=0;t<8;t+=4)this.pCtx.fillRect(0,t,8,2);break;case"darkVertical":for(let t=0;t<8;t+=4)this.pCtx.fillRect(t,0,2,8);break;case"darkDown":for(let t=-8;t<16;t+=4)this.pCtx.beginPath(),this.pCtx.moveTo(t,0),this.pCtx.lineTo(t+8,8),this.pCtx.stroke();break;case"darkUp":for(let t=0;t<16;t+=4)this.pCtx.beginPath(),this.pCtx.moveTo(t,8),this.pCtx.lineTo(t-8,0),this.pCtx.stroke();break;case"darkGrid":for(let t=0;t<8;t+=4)this.pCtx.fillRect(0,t,8,1);for(let t=0;t<8;t+=4)this.pCtx.fillRect(t,0,1,8);break;case"darkTrellis":for(let t=0;t<8;t+=4)this.pCtx.fillRect(0,t,8,1);for(let t=0;t<8;t+=4)this.pCtx.fillRect(t,0,1,8);this.pCtx.beginPath(),this.pCtx.moveTo(0,0),this.pCtx.lineTo(8,8),this.pCtx.stroke(),this.pCtx.beginPath(),this.pCtx.moveTo(8,0),this.pCtx.lineTo(0,8),this.pCtx.stroke();break;case"lightHorizontal":this.pCtx.fillRect(0,0,8,1);break;case"lightVertical":this.pCtx.fillRect(0,0,1,8);break;case"lightDown":this.pCtx.beginPath(),this.pCtx.moveTo(0,0),this.pCtx.lineTo(8,8),this.pCtx.stroke();break;case"lightUp":this.pCtx.beginPath(),this.pCtx.moveTo(8,0),this.pCtx.lineTo(0,8),this.pCtx.stroke();break;case"lightGrid":this.pCtx.fillRect(0,0,8,1),this.pCtx.fillRect(0,0,1,8);break;case"lightTrellis":this.pCtx.fillRect(0,0,8,1),this.pCtx.beginPath(),this.pCtx.moveTo(0,0),this.pCtx.lineTo(8,8),this.pCtx.stroke()}const a=this.bc.createPattern(this.pCanvas,"repeat");this.bc.fillStyle=a,this.bc.fillRect(t,e,n,i)}else if("gradient"===r.fill.type){const{gradientType:o="linear",degree:a=0,left:s=0,right:l=1,top:c=0,bottom:h=1,stops:u=[]}=r.fill;if("path"===o){const r=t+n*s,o=t+n*l,a=e+i*c,d=e+i*h,f=o-r,p=d-a,m=(r+o)/2,g=(a+d)/2,v=document.createElement("canvas");v.width=n,v.height=i;const y=v.getContext("2d"),b=f>0?Math.max((m-t)/(f/2),(t+n-m)/(f/2)):n,x=p>0?Math.max((g-e)/(p/2),(e+i-g)/(p/2)):i,w=Math.max(b,x),S=100;for(let n=S-1;n>=0;n--){const i=n/(S-1);let r=u[0]?.color||"#FFFFFF";for(let t=0;t<u.length-1;t++){const e=parseFloat(u[t].position),n=parseFloat(u[t+1].position);if(i>=e&&i<=n){const o=(i-e)/(n-e);r=ui(u[t].color,u[t+1].color,o);break}i>n&&(r=u[t+1].color)}const o=1+(w-1)*i,a=Math.max(1,f*o),s=Math.max(1,p*o),l=m-a/2-t,c=g-s/2-e;y.fillStyle=r,y.fillRect(l,c,a,s)}this.bc.drawImage(v,t,e)}else{const r=(parseFloat(a)%360+360)%360;let o,s,l,c;if(0===r)o=t,s=e+i/2,l=t+n,c=e+i/2;else if(90===r)o=t+n/2,s=e,l=t+n/2,c=e+i;else if(180===r)o=t+n,s=e+i/2,l=t,c=e+i/2;else if(270===r)o=t+n/2,s=e+i,l=t+n/2,c=e;else{const a=r*Math.PI/180,h=Math.max(n,i)/2,u=Math.cos(a)*h,d=Math.sin(a)*h,f=t+n/2,p=e+i/2;o=f-u,s=p-d,l=f+u,c=p+d}const h=this.bc.createLinearGradient(o,s,l,c);for(let t of u)h.addColorStop(parseFloat(t.position),t.color);this.bc.fillStyle=h,this.bc.fillRect(t,e,n,i)}}else{const o=this.eyeProtectionMode?this.eyeProtectionColor:"#ffffff";this.bc.fillStyle=r.fill.fgColor??o,this.bc.fillRect(t,e,n,i)}else{const o=this.eyeProtectionMode?this.eyeProtectionColor:"#ffffff";this.bc.fillStyle=r.fill.fgColor??o,this.bc.fillRect(t,e,n,i)}if(!o&&this.activeSheet.showGridLines){const o=this.snapRect(t,e,n,i);this.bc.save(),this.bc.strokeStyle=r.fill.fgColor??"#ddd",this.bc.lineWidth=this.px(1),this.bc.strokeRect(o.x,o.y,o.w,o.h),this.bc.restore()}}function bi(t,e,n,i,r){const o=this.activeSheet,a=di(o,r),s=o?.showFormulas&&!a,l=s?r.editVal.toString():r.showVal.toString();if(!l)return;const c=s?null:r.W;let h=[];h=r.alignment.wrapText?c?Ci.call(this,c,n-4,r):Mi.call(this,l,n-4,this.bc):c?Si(c):l.split("\n"),Ni.call(this,{lines:h,cell:r,x:t,y:e,w:n,h:i,richText:!!c},!1)}function xi(t,e,n,i,r,o,a,s,l,c=null,h=null){const u=di(s,a),d=s?.showFormulas&&!u,f=d?a.editVal.toString():a.showVal.toString();if(!f)return;const p=d?null:a.W;let m=[];if(a.alignment.wrapText)return m=p?Ci.call(this,p,r-4,a):Mi.call(this,f,r-4,this.bc),void Ni.call(this,{lines:m,cell:a,x:n,y:i,w:r,h:o,cfFormat:c,tableStyle:h,richText:!!p},!1);m=p?Si(p):f.split("\n");const g=a.font,v=1.333*(g.size??11);let y;this.bc.font=`${g.bold?"bold":""} ${g.italic?"italic":""} ${v}px ${g.name??"宋体"}`,y=p&&m.length>0&&Array.isArray(m[0])?Ti.call(this,m[0],a):m.length>0?this.bc.measureText(m[0]).width:0;const b=a.horizontalAlign;if(y<=r-4)return void Ni.call(this,{lines:m,cell:a,x:n,y:i,w:r,h:o,cfFormat:c,tableStyle:h,richText:!!p},!1);let x=0,w=0,S=[],C=[];if("left"!==b&&b){if("right"===b){let n=e-1,i=r;for(;i<y+4&&n>=0;){const e=s.getCol(n);if(e.hidden){n--;continue}const r=`${t},${n}`,o=s.getCell(t,n);if(l.has(r)||this.hiddenBorders.has(r)||o.isMerged)break;const a=e.width;x+=a,S.push(n),i+=a,n--}}else if("center"===b){const n=(y+4-r)/2;let i=e+1,o=0;for(;o<n&&i<s.colCount;){const e=s.getCol(i);if(e.hidden){i++;continue}const n=`${t},${i}`,r=s.getCell(t,i);if(l.has(n)||this.hiddenBorders.has(n)||r.isMerged)break;const a=e.width;w+=a,C.push(i),o+=a,i++}for(i=e-1,o=0;o<n&&i>=0;){const e=s.getCol(i);if(e.hidden){i--;continue}const n=`${t},${i}`,r=s.getCell(t,i);if(l.has(n)||this.hiddenBorders.has(n)||r.isMerged)break;const a=e.width;x+=a,S.push(i),o+=a,i--}}}else{let n=e+1,i=r;for(;i<y+4&&n<s.colCount;){const e=s.getCol(n);if(e.hidden){n++;continue}const r=`${t},${n}`,o=s.getCell(t,n);if(l.has(r)||this.hiddenBorders.has(r)||o.isMerged)break;const a=e.width;w+=a,C.push(n),i+=a,n++}}if(x>0||w>0){if(w>0){const n=`${t},${e}`,i=this.hiddenBorders.get(n)||{};this.hiddenBorders.set(n,{...i,right:!0}),C.forEach((e,n)=>{const i=`${t},${e}`,r=this.hiddenBorders.get(i)||{};r.left=!0,n<C.length-1&&(r.right=!0),this.hiddenBorders.set(i,r)})}if(x>0){const n=`${t},${e}`,i=this.hiddenBorders.get(n)||{};this.hiddenBorders.set(n,{...i,left:!0}),S.forEach((e,n)=>{const i=`${t},${e}`,r=this.hiddenBorders.get(i)||{};r.right=!0,n<S.length-1&&(r.left=!0),this.hiddenBorders.set(i,r)})}}const T=n-x,$=r+x+w;Ni.call(this,{lines:m,cell:a,x:T,y:i,w:$,h:o,alignX:n,alignW:r,cfFormat:c,tableStyle:h,richText:!!p})}function wi(t,e,n,i,r){yi.call(this,t,e,n,i,r),bi.call(this,t,e,n,i,r)}function Si(t){const e=[[]];for(const n of t){const t=n.text.split("\n");for(let i=0;i<t.length;i++)i>0&&e.push([]),t[i]&&e[e.length-1].push({text:t[i],font:n.font})}return e}function Ci(t,e,n){const i=n.font,r=[[]];let o=0;for(const a of t){const t=a.font||{},n=t.bold??i.bold,s=t.italic??i.italic,l=1.333*(t.size??i.size??11),c=t.name??i.name??"宋体";this.bc.font=`${n?"bold":""} ${s?"italic":""} ${l}px ${c}`;const h=a.text.split("");let u="";for(const i of h){if("\n"===i){u&&r[r.length-1].push({text:u,font:a.font}),u="",r.push([]),o=0;continue}const t=this.bc.measureText(i).width;o+t>e&&o>0&&(u&&r[r.length-1].push({text:u,font:a.font}),u="",r.push([]),o=0),u+=i,o+=t}u&&r[r.length-1].push({text:u,font:a.font})}return r}function Ti(t,e){const n=e.font;let i=0;for(const r of t){const t=r.font||{},e=t.bold??n.bold,o=t.italic??n.italic,a=1.333*(t.size??n.size??11),s=t.name??n.name??"宋体";this.bc.font=`${e?"bold":""} ${o?"italic":""} ${a}px ${s}`,i+=this.bc.measureText(r.text).width}return i}function $i(t,e,n,i,r,o,a,s){const l=e.font,c=9*(e.alignment?.indent||0),h=e.horizontalAlign,u=e.verticalAlign,d=t.map(t=>{let e=a;for(const n of t){const t=1.333*(n.font?.size??l.size??11);t>e&&(e=t)}return e}),f=t.length>1?1.35:1.15,p=d.map(t=>t*f),m=p.reduce((t,e)=>t+e,0),g=this.bc.textBaseline;this.bc.textBaseline="bottom",t.forEach((t,a)=>{if(!t.length)return;const f=Ti.call(this,t,e);let g;switch(d[a],h){case"center":g=n+r/2-f/2;break;case"right":g=n+(r-f)-2-2-c;break;default:g=n+2+c}const v=p.slice(0,a).reduce((t,e)=>t+e,0)+p[a];let y;switch(u){case"center":y=i+(o-m)/2+v;break;case"top":y=i+2+v;break;default:y=i+o-m+v-1}y=Math.round(y);let b=Math.round(g);for(const e of t){const t=e.font||{},n=t.bold??l.bold,i=t.italic??l.italic,r=1.333*(t.size??l.size??11),o=t.name??l.name??"宋体",a=t.color??s;this.bc.font=`${n?"bold":""} ${i?"italic":""} ${r}px ${o}`,this.bc.fillStyle=a,this.bc.fillText(e.text,b,y);const c=this.bc.measureText(e.text).width;if(t.strike??l.strike){this.bc.beginPath(),this.bc.strokeStyle=a,this.bc.lineWidth=1;const t=y-.35*r;this.bc.moveTo(b,t),this.bc.lineTo(b+c,t),this.bc.stroke()}const h=t.underline??l.underline;if(h){this.bc.beginPath(),this.bc.strokeStyle=a;const t=y+1;"double"===h?(this.bc.lineWidth=1,this.bc.moveTo(b,t-2),this.bc.lineTo(b+c,t-2),this.bc.stroke(),this.bc.beginPath(),this.bc.moveTo(b,t),this.bc.lineTo(b+c,t)):(this.bc.lineWidth=1,this.bc.moveTo(b,t),this.bc.lineTo(b+c,t)),this.bc.stroke()}b+=c}}),this.bc.textBaseline=g}function Mi(t,e,n){const i=[],r=t.split("");let o=r[0]||"";for(let a=1;a<r.length;a++){const t=r[a];n.measureText(o+t).width<=e?o+=t:(i.push(o),o=t)}return i.push(o),i}function Ai(t,e,n,i,r,o,a,s,l,c,h,u=0){const d=9*u;let f=n,p=i;switch(t){case"center":f=n+r/2-a/2;break;case"right":f=n+(r-a)-2-2-d;break;default:f=n+2+d}switch(e){case"center":p=i+(o-l)/2+c*h+h-s;break;case"top":p=i+c*h+2+h-s;break;default:p=i+o-l+c*h+h-s-1}return{textX:Math.round(f),textY:Math.round(p)}}function Ni(t){let{lines:e,cell:n,x:i,y:r,w:o,h:a,alignX:s,alignW:l,cfFormat:c,tableStyle:h,richText:u}=t;const d=void 0!==s?s:i,f=void 0!==l?l:o,p=n.font;let m=1.333*(p.size??11);const g=h?.isBold||!1,v=!0===h?.Ce,y=v?g:p.bold||g,b=c?.font?.color,x=n.O?.font?.color,w=h?.fgColor,S=n.font.color,C="string"==typeof S?4===S.length?`#${S[1]}${S[1]}${S[2]}${S[2]}${S[3]}${S[3]}`.toUpperCase():S.toUpperCase():null,T=b||(!w||!v&&x&&"#000000"!==C?null:w)||(x?S:null)||w||S||"#333",$=n.alignment?.textRotation;if(this.bc.font=`${y?"bold":""} ${p.italic?"italic":""} ${m}px ${p.name??"宋体"}`,u&&(255===$||$&&0!==$)&&(e=e.map(t=>Array.isArray(t)?t.map(t=>t.text).join(""):t),u=!1),n.alignment?.shrinkToFit&&!n.alignment?.wrapText&&e.length>0){const t=4;let i;i=u?Math.max(...e.map(t=>Ti.call(this,t,n))):Math.max(...e.map(t=>this.bc.measureText(t).width));const r=o-t;if(i>r&&i>0){const t=r/i,e=.5;m*=Math.max(t,e),this.bc.font=`${y?"bold":""} ${p.italic?"italic":""} ${m}px ${p.name??"宋体"}`}}this.bc.save(),this.bc.beginPath(),this.bc.rect(i,r,o,a),this.bc.clip(),255===$?_i.call(this,e,n,i,r,o,a,m,T):$&&0!==$?Ii.call(this,e,n,i,r,o,a,m,T,$):u?$i.call(this,e,n,d,r,f,a,m,T):ki.call(this,e,n,d,r,f,a,m,T),this.bc.restore()}function ki(t,e,n,i,r,o,a,s){const l=e.font,c=t.length>1?1.35*a:1.15*a,h=t.length*c,u=e.horizontalAlign,d=e.verticalAlign,f=e.alignment?.indent||0,p=e.Ps,m=!!p,g=Object.prototype.hasOwnProperty.call(e,"_pivotIndent"),v=Math.min(12,Math.max(6,Math.floor(o-4))),y=m?v:0,b=Number.isFinite(e.Bs)?e.Bs:0,x=b>0?Math.max(10,Math.min(16,v+4)):0,w=b>0?b*x:0,S=g||m?v+4:0,C=e.Hs,T=!!C,$=g||m||T?0:f,M=T?Math.min(12,Math.max(6,Math.floor(o-4))):0,A=T?M+6:0;let N=!1,k=!1;!m&&e.Vs&&delete e.Vs,m&&y<=0&&e.Vs&&delete e.Vs,!T&&e.Us&&delete e.Us,T&&M<=0&&e.Us&&delete e.Us;const R=e.accountingData;R&&1===t.length?Ri.call(this,R,e,n,i,r,o,a,s,c,h,d):t.forEach((t,f)=>{const g=w+S,v=!u||"left"===u,b=v?n+g:n,x=v?Math.max(0,r-g-A):Math.max(0,r-A),R=this.bc.measureText(t).width,{textX:_,textY:I}=Ai.call(this,u,d,b,i,x,o,R,a,h,f,c,$);if(this.bc.fillStyle=s,m&&!N&&y>0){let t=i+(o-y)/2;"top"===d?t=i+2:"bottom"===d&&(t=i+o-y-2);const r=n+2+w;!function(t,e,n,i,r){if(i<=0)return;const o=Math.floor(e)+.5,a=Math.floor(n)+.5;t.save(),t.fillStyle="#ffffff",t.fillRect(o,a,i,i),t.strokeStyle="#8a8a8a",t.lineWidth=1,t.strokeRect(o,a,i,i);const s=o+i/2,l=a+i/2,c=Math.max(2,Math.floor(.25*i));t.strokeStyle="#4a4a4a",t.lineWidth=1,t.beginPath(),t.moveTo(s-c,l),t.lineTo(s+c,l),r&&(t.moveTo(s,l-c),t.lineTo(s,l+c)),t.stroke(),t.restore()}(this.bc,r,t,y,!!p?.collapsed),e.Vs={x:r,y:t,w:y,h:y},N=!0}if(T&&!k&&M>0){let t=i+(o-M)/2;"top"===d?t=i+2:"bottom"===d&&(t=i+o-M-2);const a=n+r-M-2;this.drawFilterIcon(this.bc,a,t,M,!!C?.active,null),e.Us={x:a,y:t,w:M,h:M},k=!0}if(this.bc.fillText(t,_,I),l.strike&&t){this.bc.beginPath(),this.bc.strokeStyle=s,this.bc.lineWidth=1;const t=I+.4*a;this.bc.moveTo(_,t),this.bc.lineTo(_+R,t),this.bc.stroke()}if(l.underline&&t){this.bc.beginPath(),this.bc.strokeStyle=s;const t=I+a;"single"===l.underline?(this.bc.lineWidth=1,this.bc.moveTo(_,t),this.bc.lineTo(_+R,t)):"double"===l.underline&&(this.bc.lineWidth=1,this.bc.moveTo(_,t-2),this.bc.lineTo(_+R,t-2),this.bc.stroke(),this.bc.beginPath(),this.bc.moveTo(_,t),this.bc.lineTo(_+R,t)),this.bc.stroke()}})}function Ri(t,e,n,i,r,o,a,s,l,c,h){const{prefix:u,number:d,suffix:f}=t,p=u?this.bc.measureText(u).width:0,m=d+f,g=this.bc.measureText(m).width,v=p+g+4;let y;switch(h){case"center":y=i+(o-c)/2+l-a;break;case"top":y=i+2+l-a;break;default:y=i+o-c+l-a-1}if(this.bc.fillStyle=s,v>r){const t="#".repeat(Math.max(1,Math.floor((r-4)/this.bc.measureText("#").width))),e=n+r-this.bc.measureText(t).width-2;return void this.bc.fillText(t,e,y)}if(u){const t=n+2;this.bc.fillText(u,t,y)}const b=n+r-g-2;this.bc.fillText(m,b,y)}function _i(t,e,n,i,r,o,a,s){const l=[...t.join("")],c=1.1*a,h=l.length*c,u=e.horizontalAlign,d=e.verticalAlign;let f,p;switch(u){case"left":f=n+a/2+2;break;case"right":f=n+r-a/2-2;break;default:f=n+r/2}switch(d){case"top":p=i+2;break;case"center":p=i+(o-h)/2;break;default:p=i+o-h-2}this.bc.fillStyle=s,this.bc.textAlign="center",this.bc.textBaseline="top",l.forEach((t,e)=>{this.bc.fillText(t,f,p+e*c)}),this.bc.textAlign="left",this.bc.textBaseline="alphabetic"}function Ii(t,e,n,i,r,o,a,s,l){const c=t.join(""),h=this.bc.measureText(c).width,u=e.horizontalAlign,d=e.verticalAlign;let f;f=l<=90?-l*Math.PI/180:(l-90)*Math.PI/180;const p=Math.abs(Math.cos(f)),m=Math.abs(Math.sin(f)),g=h*p+a*m,v=h*m+a*p;let y,b;switch(u){case"left":y=n+g/2+2;break;case"right":y=n+r-g/2-2;break;default:y=n+r/2}switch(d){case"top":b=i+v/2+2;break;case"center":b=i+o/2;break;default:b=i+o-v/2-2}this.bc.save(),this.bc.translate(y,b),this.bc.rotate(f),this.bc.fillStyle=s,this.bc.textAlign="center",this.bc.textBaseline="middle",this.bc.fillText(c,0,0),this.bc.restore()}Object.assign(hi.prototype,{rangeSort:function(t,e){const n=this;return e||(e={s:{r:0,c:0},e:{r:n.rowCount-1,c:n.colCount-1}}),!n.SN.Event.emit("beforeSort",{sheet:n,range:e,sortKeys:t}).canceled&&n.SN.st("sort",{sheet:n,range:e,sortKeys:t},()=>{const i=Tt(n,e,t);return i&&n.SN.ht({type:"sort",sheet:n,range:e,sortKeys:t}),n.SN.Event.emit("afterSort",{sheet:n,range:e,sortKeys:t,success:i}),i})},flashFill:function(t,e={}){const n=function(t,e){const n=t.activeAreas?.[0]??{s:t.activeCell,e:t.activeCell},i=e??n,r="string"==typeof i?t.rangeStrToNum(i):i;if(!r?.s||!r?.e)throw new Error("Invalid flash fill target range.");const o={s:{r:Math.min(r.s.r,r.e.r),c:Math.min(r.s.c,r.e.c)},e:{r:Math.max(r.s.r,r.e.r),c:Math.max(r.s.c,r.e.c)}};if(o.s.c!==o.e.c)throw new Error("Flash Fill only supports a single-column target range.");return o}(this,t),i=function(t,e,n={}){if(void 0!==n.sourceCol&&null!==n.sourceCol){if("string"==typeof n.sourceCol){const e=t.Utils.charToNum(n.sourceCol.replace(/\$/g,"").trim().toUpperCase());if(Number.isInteger(e)&&e>=0)return e;throw new Error("Invalid source column.")}if(Number.isInteger(n.sourceCol)&&n.sourceCol>=0)return n.sourceCol;throw new Error("Invalid source column.")}const i=e.s.c,r=[];if(i>0&&r.push(i-1),i+1<t.colCount&&r.push(i+1),0===r.length)throw new Error("No adjacent source column was found for Flash Fill.");if(1===r.length)return r[0];const o=n=>{let i=0;for(let r=e.s.r;r<=e.e.r;r++)""!==Nt(t.getCell(r,n).showVal)&&i++;return i},a=r[0],s=r[1],l=o(a);return o(s)>l?s:a}(this,n,e),r=n.s.c,o=!0===e.overwrite,a=[];for(let d=n.s.r;d<=n.e.r;d++){const t=Nt(this.getCell(d,i).showVal),e=Nt(this.getCell(d,r).editVal);a.push({row:d,source:t,target:e})}const s=a.filter(t=>""!==t.source&&""!==t.target);if(0===s.length)throw new Error("Please provide at least one example value in the target column before running Flash Fill.");const l=function(t){if(!t.length)return null;const e=t[0],n=function(t,e,n){const i=Nt(t),r=Nt(e),o=[],a=new Set,s=(t,e,n)=>{a.has(t)||(a.add(t),o.push({id:t,score:e,apply:n}))};if(r===i&&s("transform:identity",15,t=>Nt(t)),r===i.toUpperCase()&&s("transform:upper",20,t=>Nt(t).toUpperCase()),r===i.toLowerCase()&&s("transform:lower",20,t=>Nt(t).toLowerCase()),r===_t(i)&&s("transform:title",18,t=>_t(t)),r===i.replace(/\D+/g,"")&&s("transform:digits-only",22,t=>Nt(t).replace(/\D+/g,"")),At.forEach(t=>{r===i.split(t).join("")&&s(`remove-char:${JSON.stringify(t)}`,24,e=>Nt(e).split(t).join(""))}),$t.forEach(t=>{const e=i.match(t.regex)||[];e.forEach((n,i)=>{if(n!==r)return;s(`token:${t.key}:start:${i}`,40,e=>Rt(Nt(e).match(t.regex)||[],"start",i));const o=e.length-i;s(`token:${t.key}:end:${o}`,45,e=>Rt(Nt(e).match(t.regex)||[],"end",o))})}),["whitespace",...Mt].forEach(t=>{const e=kt(i,t);e.forEach((n,i)=>{if(n!==r)return;s(`split:${JSON.stringify(t)}:start:${i}`,50,e=>Rt(kt(e,t),"start",i));const o=e.length-i;s(`split:${JSON.stringify(t)}:end:${o}`,55,e=>Rt(kt(e,t),"end",o))})}),""!==r){let t=0;for(;t<i.length;){const e=i.indexOf(r,t);if(-1===e)break;const n=r.length;s(`substr:start:${e}:len:${n}`,30,t=>{const i=Nt(t);return e+n>i.length?"":i.slice(e,e+n)});const o=i.length-e-n;s(`substr:end:${o}:len:${n}`,32,t=>{const e=Nt(t),i=e.length-o-n;return i<0||i+n>e.length?"":e.slice(i,i+n)}),t=e+1}}const l=new Map;let c=!0;return n.forEach(t=>{l.has(t.source)?l.get(t.source)!==t.target&&(c=!1):l.set(t.source,t.target)}),c&&l.size>0&&s("lookup-map",10,t=>l.get(Nt(t))??""),o.slice().forEach(t=>{const e=Nt(t.apply(i));if(!e||e===r)return;const n=r.indexOf(e);if(-1===n)return;const o=r.slice(0,n),a=r.slice(n+e.length);s(`wrap:${t.id}:${JSON.stringify(o)}:${JSON.stringify(a)}`,t.score+2,e=>{const n=Nt(t.apply(e));return""===n?"":o+n+a})}),o}(e.source,e.target,t);let i=null;for(const r of n)t.every(t=>Nt(r.apply(t.source))===t.target)&&(!i||r.score>i.score)&&(i=r);return i}(s);if(!l)throw new Error("Unable to infer a Flash Fill pattern from the provided examples.");const c={s:{r:n.s.r,c:i},e:{r:n.e.r,c:i}},h=a.map(t=>({...t,predicted:Nt(l.apply(t.source))})),u={success:!0,targetRange:n,sourceRange:c,sourceCol:i,exampleCount:s.length,strategy:l.id,filledCount:0};return e.previewOnly?{...u,predictions:h}:this.SN.Event.emit("beforeFlashFill",{sheet:this,targetRange:n,sourceRange:c,strategy:l.id,exampleCount:s.length}).canceled?{...u,success:!1,canceled:!0}:this.SN.st("flashFill",{sheet:this,targetRange:n,sourceRange:c,strategy:l.id},()=>{let t=0;return h.forEach(e=>{(o||""===e.target)&&""!==e.predicted&&e.predicted!==e.target&&(this.getCell(e.row,r).editVal=e.predicted,t++)}),this.SN.ht({type:"flashFill",sheet:this,targetRange:n,sourceRange:c,strategy:l.id,exampleCount:s.length,filledCount:t}),this.SN.Event.emit("afterFlashFill",{sheet:this,targetRange:n,sourceRange:c,strategy:l.id,exampleCount:s.length,filledCount:t}),{...u,filledCount:t}})},textToColumns:function(t,e={}){const n=function(t,e){const n=t.activeAreas?.[0]??{s:t.activeCell,e:t.activeCell},i=e??n,r="string"==typeof i?t.rangeStrToNum(i):i;if(!r?.s||!r?.e)throw new Error("Invalid source range.");return{s:{r:Math.min(r.s.r,r.e.r),c:Math.min(r.s.c,r.e.c)},e:{r:Math.max(r.s.r,r.e.r),c:Math.max(r.s.c,r.e.c)}}}(this,t);if(n.s.c!==n.e.c)throw new Error("Text to Columns only supports a single-column source range.");const i=function(t={}){let e=t.delimiters??[];Array.isArray(e)||(e=[e]),void 0!==t.delimiter&&null!==t.delimiter&&e.push(t.delimiter);const n=new Set;return e.forEach(t=>{if(null==t)return;const e=It[t]??String(t);if(e)for(const i of e)n.add(i)}),Array.from(n)}(e);if(0===i.length)throw new Error("At least one delimiter is required.");const r=function(t,e,n){if(!n)return{r:e.s.r,c:e.s.c};const i="string"==typeof n?t.Utils.cellStrToNum(n.replace(/\$/g,"").trim()):n;if(!i||i.r<0||i.c<0)throw new Error("Invalid destination.");return{r:i.r,c:i.c}}(this,n,e.destination),o=function(t){return null==t?'"':""===t||"none"===t?null:String(t)[0]??null}(e.textQualifier),a={textQualifier:o,treatConsecutiveDelimitersAsOne:!0===e.treatConsecutiveDelimitersAsOne},s=[];for(let f=n.s.r;f<=n.e.r;f++){const t=this.getCell(f,n.s.c);s.push(String(t.showVal??""))}const l=s.map(t=>function(t,e,n={}){const i=null==t?"":String(t),r=n.textQualifier??'"',o=!0===n.treatConsecutiveDelimitersAsOne,a=new Set(e);if(!a.size)return[i];const s=[];let l="",c=!1;for(let h=0;h<i.length;h++){const t=i[h];if(r&&t===r)c&&i[h+1]===r?(l+=r,h++):c=!c;else if(!c&&a.has(t)){if(s.push(l),l="",o)for(;h+1<i.length&&a.has(i[h+1]);)h++}else l+=t}return s.push(l),s}(t,i,a)),c=l.reduce((t,e)=>Math.max(t,e.length),1),h=l.length,u={s:{r:r.r,c:r.c},e:{r:r.r+h-1,c:r.c+c-1}},d={success:!0,sourceRange:n,targetRange:u,rowCount:h,columnCount:c};return e.previewOnly?d:this.SN.Event.emit("beforeTextToColumns",{sheet:this,sourceRange:n,targetRange:u,options:{delimiters:i,textQualifier:o,treatConsecutiveDelimitersAsOne:a.treatConsecutiveDelimitersAsOne}}).canceled?{...d,success:!1,canceled:!0}:this.SN.st("textToColumns",{sheet:this,sourceRange:n,targetRange:u},()=>(l.forEach((t,e)=>{const n=r.r+e;for(let i=0;i<c;i++){const e=r.c+i;this.getCol(e),this.getCell(n,e).editVal=t[i]??""}}),this.SN.ht({type:"textToColumns",sheet:this,sourceRange:n,targetRange:u,options:{delimiters:i,textQualifier:o,treatConsecutiveDelimitersAsOne:a.treatConsecutiveDelimitersAsOne},rowCount:h,columnCount:c}),this.SN.Event.emit("afterTextToColumns",{sheet:this,sourceRange:n,targetRange:u,rowCount:h,columnCount:c}),d))},groupRows:function(t,e={}){return Dt(this,t,e,"row",1)},ungroupRows:function(t,e={}){return Dt(this,t,e,"row",-1)},groupCols:function(t,e={}){return Dt(this,t,e,"col",1)},ungroupCols:function(t,e={}){return Dt(this,t,e,"col",-1)},subtotal:function(t,e={}){const n=function(t,e){const n=t.activeAreas?.[0]??{s:t.activeCell,e:t.activeCell},i=e??n,r=(o="string"==typeof i?t.rangeStrToNum(i):i,o?.s&&o?.e?{s:{r:Math.min(o.s.r,o.e.r),c:Math.min(o.s.c,o.e.c)},e:{r:Math.max(o.s.r,o.e.r),c:Math.max(o.s.c,o.e.c)}}:null);var o;if(!r)throw new Error("无效的分类汇总区域");return r}(this,t),i=function(t,e,n={}){const i=!1!==n.hasHeaders,r=!1!==n.summaryBelowData,o=!1!==n.replaceExisting,a=!1!==n.withGrandTotal,s=zt(n.function??n.useFunction??"sum"),l=Lt[zt(s)]??9,c=Pt(t,n.groupBy??n.atEachChangeIn??e.s.c);if(!Number.isInteger(c))throw new Error("分类字段无效");let h=function(t,e){const n=Array.isArray(e)?e:[e],i=[];return n.forEach(e=>{const n=Pt(t,e);Number.isInteger(n)&&n>=0&&i.push(n)}),Array.from(new Set(i)).sort((t,e)=>t-e)}(t,n.subtotalColumns??n.addSubtotalTo??n.columns);if(0===h.length)for(let u=e.s.c;u<=e.e.c;u++)u!==c&&h.push(u);if(0===h.length)throw new Error("请至少选择一个汇总列");if([c,...h].some(t=>t<e.s.c||t>e.e.c))throw new Error("分类字段或汇总列必须在选区内");return{hasHeaders:i,summaryBelowData:r,replaceExisting:o,withGrandTotal:a,functionName:s,formulaCode:l,groupBy:c,subtotalColumns:h}}(this,n,e);if(this.areaHaveMerge(n))throw new Error("分类汇总不支持包含合并单元格的区域");const r=i.hasHeaders?n.s.r+1:n.s.r;if(r>n.e.r)throw new Error("分类汇总至少需要一行数据");return this.SN.Event.emit("beforeSubtotal",{sheet:this,range:n,options:i}).canceled?{success:!1,canceled:!0}:this.SN.st("subtotal",{sheet:this,range:n,options:i},()=>{const t=this.outlinePr?{...this.outlinePr}:null,e={...this.outlinePr||{},summaryBelow:i.summaryBelowData};this.SN.UndoRedo.add({undo:()=>{this.outlinePr=t?{...t}:t},redo:()=>{this.outlinePr={...e}}}),this.outlinePr={...e};let o=n.e.r,a=0;if(i.replaceExisting){for(let t=o;t>=r;t--)Ht(this,t,i.subtotalColumns)&&(this.delRows(t,1),a++);o-=a}if(r>o)throw new Error("分类汇总后没有可处理的数据");for(let n=r;n<=o;n++){const t=this.getRow(n);t.kt=0,t.Tt=!1}const s=function(t,e,n,i){const r=[];let o=e,a=Ot(t.getCell(e,i)),s=Bt(t.getCell(e,i));for(let l=e+1;l<=n;l++){const e=Ot(t.getCell(l,i));e!==a&&(r.push({start:o,end:l-1,label:s}),o=l,a=e,s=Bt(t.getCell(l,i)))}return r.push({start:o,end:n,label:s}),r}(this,r,o,i.groupBy);let l=0;for(let n=s.length-1;n>=0;n--){const t=s[n],e=i.summaryBelowData?t.end+1:t.start;this.addRows(e,1),l++;const r=`${t.label} 小计`;this.getCell(e,i.groupBy).editVal=r,Ut(this,e,i.groupBy),i.subtotalColumns.forEach(n=>{if(n===i.groupBy)return;const r=`=SUBTOTAL(${i.formulaCode},${Vt(this,t.start,n)}:${Vt(this,t.end,n)})`;this.getCell(e,n).editVal=r,Ut(this,e,n)});const o=i.summaryBelowData?t.start:t.start+1,a=i.summaryBelowData?t.end:t.end+1;for(let n=o;n<=a;n++){const t=this.getRow(n);t.kt=Math.min(7,(t.kt||0)+1),t.Tt=!1}}let c=null;if(i.withGrandTotal){const t=o+l+1;this.addRows(t,1),c=t,this.getCell(t,i.groupBy).editVal="总计",Ut(this,t,i.groupBy),i.subtotalColumns.forEach(e=>{if(e===i.groupBy)return;const n=`=SUBTOTAL(${i.formulaCode},${Vt(this,r,e)}:${Vt(this,t-1,e)})`;this.getCell(t,e).editVal=n,Ut(this,t,e)})}const h={s:{...n.s},e:{r:o+l+(i.withGrandTotal?1:0),c:n.e.c}},u={success:!0,range:n,resultRange:h,groupCount:s.length,removedCount:a,insertedSubtotalRows:l,grandTotalRow:c};return this.SN.ht({type:"subtotal",sheet:this,range:n,resultRange:h,groupCount:s.length,removedCount:a,insertedSubtotalRows:l,grandTotalRow:c,options:i}),this.SN.Event.emit("afterSubtotal",{sheet:this,...u,options:i}),u})},consolidate:function(t,e={}){!t||"object"!=typeof t||Array.isArray(t)||t.s||(t=(e=t).sourceRanges??e.ranges);const n=function(t,e){const n=t.activeAreas?.length?t.activeAreas:[{s:t.activeCell,e:t.activeCell}],i=e??n,r=Array.isArray(i)?i:[i],o=[];return r.forEach(e=>{const n=(i="string"==typeof e?t.rangeStrToNum(e):e,i?.s&&i?.e?{s:{r:Math.min(i.s.r,i.e.r),c:Math.min(i.s.c,i.e.c)},e:{r:Math.max(i.s.r,i.e.r),c:Math.max(i.s.c,i.e.c)}}:null);var i;n&&o.push(n)}),o}(this,t??e.sourceRanges??e.ranges);if(0===n.length)throw new Error("请至少提供一个源区域");if(n.some(t=>this.areaHaveMerge(t)))throw new Error("合并计算不支持包含合并单元格的源区域");const i=function(t){const e=String(t??"sum").trim();if(!e)return"sum";const n=e.toLowerCase();return"avg"===n?"average":"countnum"===n||"countnums"===n?"countNums":"stddev"===n?"stdev":"stddevp"===n?"stdevp":"variance"===n?"var":"variancep"===n?"varp":n}(e.function??e.func??"sum"),r=!1!==e.skipBlanks,o=Math.max(...n.map(t=>t.e.r-t.s.r+1)),a=Math.max(...n.map(t=>t.e.c-t.s.c+1)),s=function(t,e,n){if(!e)return{...n.s};if("string"==typeof e){const n=t.Utils.cellStrToNum(e.replace(/\$/g,"").trim());if(!n||n.r<0||n.c<0)throw new Error("合并计算目标单元格无效");return{r:n.r,c:n.c}}if("object"==typeof e&&e.r>=0&&e.c>=0)return{r:e.r,c:e.c};throw new Error("合并计算目标单元格无效")}(this,e.destination,n[0]),l={s:{...s},e:{r:s.r+o-1,c:s.c+a-1}};return this.SN.Event.emit("beforeConsolidate",{sheet:this,sourceRanges:n,targetRange:l,functionName:i,skipBlanks:r}).canceled?{success:!1,canceled:!0}:this.SN.st("consolidate",{sheet:this,sourceRanges:n,targetRange:l,functionName:i},()=>{let t=0;for(let l=0;l<o;l++)for(let e=0;e<a;e++){const o=[];n.forEach(t=>{const n=t.s.r+l,a=t.s.c+e;if(n>t.e.r||a>t.e.c)return;const s=this.getCell(n,a).calcVal;if(r&&Wt(s))return;const c=Kt(s);qt.has(i)&&"count"!==i&&null===c||o.push({raw:s,num:c})});const a=jt(i,o);this.getCell(s.r+l,s.c+e).editVal=""===a?"":a,""!==a&&t++}const e={success:!0,sourceRanges:n,targetRange:l,functionName:i,rowCount:o,colCount:a,writtenCount:t};return this.SN.ht({type:"consolidate",sheet:this,sourceRanges:n,targetRange:l,functionName:i,rowCount:o,colCount:a,writtenCount:t}),this.SN.Event.emit("afterConsolidate",{sheet:this,...e}),e})},setDataValidation:function(t,e){const n=Zt(this,t);if(!n.length)return{success:!1,canceled:!0,cellCount:0};const i=function(t){if(!t||"object"!=typeof t)return null;const e=String(t.type||"").trim();if(!Gt.has(e))throw new Error("数据验证类型无效");const n={type:e,allowBlank:!1!==t.allowBlank,showInputMessage:!1!==t.showInputMessage,showErrorMessage:!1!==t.showErrorMessage};if(null!=t.promptTitle&&(n.promptTitle=String(t.promptTitle)),null!=t.prompt&&(n.prompt=String(t.prompt)),null!=t.errorTitle&&(n.errorTitle=String(t.errorTitle)),null!=t.error&&(n.error=String(t.error)),null!=t.errorStyle&&(n.errorStyle=String(t.errorStyle)),"list"===e){const e=(i=t.formula1,Array.isArray(i)?i.map(t=>String(t??"").trim()).filter(Boolean):"string"==typeof i?i.split(/[,\n，;；]/).map(t=>t.trim()).filter(Boolean):[]);if(!e.length)throw new Error("列表验证需要至少一个候选值");return n.formula1=e,n.showDropDown=!1!==t.showDropDown,n}var i;if("custom"===e){const e=String(t.formula1??"").trim();if(!e)throw new Error("自定义验证需要输入公式");return n.formula1=e,n}if(Xt.has(e)){if(n.operator=String(t.operator||"between"),null==t.formula1||""===String(t.formula1).trim())throw new Error("数据验证最小值/条件值不能为空");if(n.formula1=t.formula1,Yt.has(n.operator)){if(null==t.formula2||""===String(t.formula2).trim())throw new Error("使用区间比较时，请输入第二个条件值");n.formula2=t.formula2}else null!=t.formula2&&""!==String(t.formula2).trim()&&(n.formula2=t.formula2)}return n}(e);return this.SN.Event.emit("beforeSetDataValidation",{sheet:this,areas:n,rule:Jt(i)}).canceled?{success:!1,canceled:!0,cellCount:0}:this.SN.st("setDataValidation",{sheet:this,areas:n,rule:Jt(i)},()=>{let t=0;this.eachCells(n,(e,n)=>{this.getCell(e,n).dataValidation=Jt(i),t++});const e={success:!0,areas:n,rule:Jt(i),cellCount:t};return this.SN.ht({type:"dataValidation",action:"set",sheet:this,areas:n,rule:Jt(i),cellCount:t}),this.SN.Event.emit("afterSetDataValidation",{sheet:this,...e}),e})},clearDataValidation:function(t){const e=Zt(this,t);return e.length?this.SN.Event.emit("beforeClearDataValidation",{sheet:this,areas:e}).canceled?{success:!1,canceled:!0,cellCount:0}:this.SN.st("clearDataValidation",{sheet:this,areas:e},()=>{let t=0;this.eachCells(e,(e,n)=>{const i=this.getCell(e,n);i.dataValidation&&(i.dataValidation=null,t++)});const n={success:!0,areas:e,cellCount:t};return this.SN.ht({type:"dataValidation",action:"clear",sheet:this,areas:e,cellCount:t}),this.SN.Event.emit("afterClearDataValidation",{sheet:this,...n}),n}):{success:!1,canceled:!0,cellCount:0}},insertTable:function(t,e,n={}){if(!Array.isArray(t)||!e)return;"string"==typeof e&&(e=this.Utils.cellStrToNum(e));const i={l:"left",c:"center",r:"right"};let r=0;t.forEach(t=>{let e=0,n=0;for(let i=0;i<t.length;i++){if(n>0){n--;continue}const r=t[i],o=r?.mr??0;e+=o+1,n=o}r=Math.max(r,e)});const o=[];for(let a=0;a<t.length;a++){let s=t[a]??[];for(let t=0;t<r;t++){const r=e.r+a,l=e.c+t,c=this.getCell(r,l),h={style:"thin",color:"#000000"};n.border&&(c.border={top:h,left:h,bottom:h,right:h}),n.align&&(c.alignment={vertical:"center",horizontal:n.align});const u=s[t]??{};"[object Object]"==Object.prototype.toString.call(u)?(c.editVal=u.v,u.fg&&(c.fill={fgColor:u.fg}),u.c&&(c.font={color:u.c}),u.a&&(c.alignment={horizontal:i[u.a]}),u.b&&(c.font={bold:!0}),u.s&&(c.font={size:Number(u.s)}),(u.mr||u.mb)&&o.push({s:{r,c:l},e:{r:r+(u.mb??0),c:l+(u.mr??0)}})):c.editVal=u}(s?.[0]?.h||n.height)&&(this.getRow(e.r+a).height=s?.[0]?.h??n.height)}for(let a=0;a<r;a++){const i=(t[0][a]??{}).w??n.width;i&&(this.getCol(e.c+a).width=i)}return o.forEach(t=>this.mergeCells(t)),{s:e,e:{r:e.r+t.length-1,c:e.c+r-1}}},Ro:function(t){if(!this.merges)return t;let e={...t},n=!0;for(;n;)n=!1,this.merges.forEach(t=>{const i=ee(t,e);JSON.stringify(i)!=JSON.stringify(e)&&(n=!0),e=i});return e},areaHaveMerge:function(t){return t?this.merges.some(e=>!(e.s.c>t.e.c||e.e.c<t.s.c||e.s.r>t.e.r||e.e.r<t.s.r)):this.merges.length>0},unMergeCells:function(t=null){const e=this;if(!e.SN.Event.emit("beforeUnmerge",{sheet:e,cellAd:t}).canceled)return e.SN.st("unmerge",{sheet:e,cellAd:t},()=>{if(!t){const n=new Set;return e.activeAreas.forEach(t=>{e.eachCells(t,(t,i)=>{const r=e.getCell(t,i);r.master&&r.master.r===t&&r.master.c===i&&n.add(`${t},${i}`)})}),n.forEach(t=>{const[n,i]=t.split(",").map(Number);ne.call(e,{r:n,c:i})}),e.SN.ht({type:"unmerge",sheet:e,areas:e.activeAreas}),void e.SN.Event.emit("afterUnmerge",{sheet:e,cellAd:t})}"string"==typeof t&&(t=e.Utils.cellStrToNum(t)),ne.call(e,t),e.SN.ht({type:"unmerge",sheet:e,cellAd:t}),e.SN.Event.emit("afterUnmerge",{sheet:e,cellAd:t})})},mergeCells:function(t=null,e="default"){const n=this;if(!n.SN.Event.emit("beforeMerge",{sheet:n,areas:t,mode:e}).canceled)return n.SN.st("merge",{sheet:n,areas:t,mode:e},()=>{if(t||(t=n.activeAreas),t&&0!==t.length){if(Array.isArray(t)||(t=[t]),t=t.map(t=>"string"==typeof t?n.rangeStrToNum(t):JSON.parse(JSON.stringify(t))),"same"===e)return t.forEach(t=>{for(let e=t.s.c;e<=t.e.c;e++){let i=t.s.r,r=n.getCell(i,e).showVal;for(let o=t.s.r+1;o<=t.e.r+1;o++){const a=o<=t.e.r?n.getCell(o,e).showVal:null;(a!==r||o>t.e.r)&&(o-1>i&&ie.call(n,{s:{r:i,c:e},e:{r:o-1,c:e}},!1),i=o,r=a)}}}),n.SN.ht({type:"merge",sheet:n,areas:t,mode:e}),void n.SN.Event.emit("afterMerge",{sheet:n,areas:t,mode:e});t.forEach(t=>{if(t.s.r!==t.e.r||t.s.c!==t.e.c)if("content"===e){const e=[];n.eachCells(t,(t,i)=>{const r=n.getCell(t,i).showVal;""!==r&&null!=r&&e.push(r)}),ie.call(n,t,!1),e.length>0&&(n.getCell(t.s.r,t.s.c).editVal=e.join(" "))}else ie.call(n,t,"center"===e)}),n.SN.ht({type:"merge",sheet:n,areas:t,mode:e}),n.SN.Event.emit("afterMerge",{sheet:n,areas:t,mode:e})}})},addRows:function(t,e=1){this.SN.Event.emit("beforeInsertRows",{sheet:this,row:t,count:e}).canceled||this.SN.st("insertRows",{sheet:this,row:t,count:e},()=>{const n=this.merges.filter(e=>e.s.r<t&&e.e.r>=t),i=this.merges.filter(e=>e.s.r>=t),r=[...n,...i].map(t=>({...t})),o=new Set(this.bt),a=[];this.Table&&this.Table.size>0&&this.Table.forEach(e=>{const n=e.range;n&&t>=n.s.r&&t<=n.e.r+1&&a.push({table:e,oldRange:{s:{...n.s},e:{...n.e}}})});const s=()=>{a.forEach(({table:t,oldRange:n})=>{t.re={s:{...n.s},e:{...n.e,r:n.e.r+e}},t.autoFilterEnabled&&t.ze()})};this.rows.splice(t,0,...new Array(e)),this.Ao();const l=new Set;this.bt.forEach(n=>{n>=t?l.add(n+e):l.add(n)}),this.bt=l,n.forEach(n=>{n.e.r+=e;for(let i=t;i<t+e;i++)for(let t=n.s.c;t<=n.e.c;t++){const e=this.getCell(i,t);e.master={r:n.s.r,c:n.s.c},e.isMerged=!0}}),i.forEach(t=>{t.s.r+=e,t.e.r+=e;for(let e=t.s.r;e<=t.e.r;e++)for(let n=t.s.c;n<=t.e.c;n++){const i=this.getCell(e,n);i.master={r:t.s.r,c:t.s.c},i.isMerged=!0}}),s();const c=new Set(this.bt);this.SN.UndoRedo.add({undo:()=>{this.rows.splice(t,e),this.bt=new Set(o),[...n,...i].forEach((t,e)=>{Object.assign(t,r[e]);for(let n=t.s.r;n<=t.e.r;n++)for(let e=t.s.c;e<=t.e.c;e++){const i=this.getCell(n,e);i.master={r:t.s.r,c:t.s.c},i.isMerged=!0}}),a.forEach(({table:t,oldRange:e})=>{t.re={s:{...e.s},e:{...e.e}},t.autoFilterEnabled&&t.ze()})},redo:()=>{this.rows.splice(t,0,...new Array(e)),this.bt=new Set(c),n.forEach(n=>{n.e.r+=e;for(let i=t;i<t+e;i++)for(let t=n.s.c;t<=n.e.c;t++){const e=this.getCell(i,t);e.master={r:n.s.r,c:n.s.c},e.isMerged=!0}}),i.forEach(t=>{t.s.r+=e,t.e.r+=e;for(let e=t.s.r;e<=t.e.r;e++)for(let n=t.s.c;n<=t.e.c;n++){const i=this.getCell(e,n);i.master={r:t.s.r,c:t.s.c},i.isMerged=!0}}),s()}}),this.Drawing.Xn(t,e),this.SN.Event.emit("afterInsertRows",{sheet:this,row:t,count:e}),this.SN.ht({type:"insertRows",sheet:this,row:t,count:e})})},addCols:function(t,e=1){this.SN.Event.emit("beforeInsertColumns",{sheet:this,col:t,count:e}).canceled||this.SN.st("insertColumns",{sheet:this,col:t,count:e},()=>{const n=this.merges.filter(e=>e.s.c<t&&e.e.c>=t),i=this.merges.filter(e=>e.s.c>=t),r=[...n,...i].map(t=>({...t})),o=new Set(this.yt),a=[];this.Table&&this.Table.size>0&&this.Table.forEach(e=>{const n=e.range;n&&t>=n.s.c&&t<=n.e.c+1&&a.push({table:e,oldRange:{s:{...n.s},e:{...n.e}},oldColumns:e.columns.map(t=>({...t}))})});let s=null;const l=this.AutoFilter,c=l?.range,h=c&&t>=c.s.c&&t<=c.e.c+1;h&&(s={s:{...c.s},e:{...c.e}}),this.rows.forEach(n=>{n&&n.cells.splice(t,0,...new Array(e))}),this.cols.splice(t,0,...new Array(e)),this.Ao();const u=new Set;this.yt.forEach(n=>{n>=t?u.add(n+e):u.add(n)}),this.yt=u,n.forEach(n=>{n.e.c+=e;for(let i=n.s.r;i<=n.e.r;i++)for(let r=t;r<t+e;r++){const t=this.getCell(i,r);t.master={r:n.s.r,c:n.s.c},t.isMerged=!0}}),i.forEach(t=>{t.s.c+=e,t.e.c+=e;for(let e=t.s.r;e<=t.e.r;e++)for(let n=t.s.c;n<=t.e.c;n++){const i=this.getCell(e,n);i.master={r:t.s.r,c:t.s.c},i.isMerged=!0}}),a.forEach(({table:n,oldRange:i})=>{const r=n.range,o=t-r.s.c;r.e.c+=e;for(let t=0;t<e;t++)n.columns.splice(o,0,{id:n.columns.length+t+1,name:`列${o+t+1}`});n.autoFilterEnabled&&n.ze()}),h&&c&&(c.e.c+=e,l.re=this.SN.Utils.rangeNumToStr(c));const d=new Set(this.yt);this.SN.UndoRedo.add({undo:()=>{this.rows.forEach(n=>{n&&n.cells.splice(t,e)}),this.cols.splice(t,e),this.yt=new Set(o),[...n,...i].forEach((t,e)=>{Object.assign(t,r[e]);for(let n=t.s.r;n<=t.e.r;n++)for(let e=t.s.c;e<=t.e.c;e++){const i=this.getCell(n,e);i.master={r:t.s.r,c:t.s.c},i.isMerged=!0}}),a.forEach(({table:t,oldRange:e,oldColumns:n})=>{t.re=e,t.columns=n,t.autoFilterEnabled&&t.ze()}),s&&(l.se=s,l.re=this.SN.Utils.rangeNumToStr(s))},redo:()=>{this.rows.forEach(n=>{n&&n.cells.splice(t,0,...new Array(e))}),this.cols.splice(t,0,...new Array(e)),this.yt=new Set(d),n.forEach(n=>{n.e.c+=e;for(let i=n.s.r;i<=n.e.r;i++)for(let r=t;r<t+e;r++){const t=this.getCell(i,r);t.master={r:n.s.r,c:n.s.c},t.isMerged=!0}}),i.forEach(t=>{t.s.c+=e,t.e.c+=e;for(let e=t.s.r;e<=t.e.r;e++)for(let n=t.s.c;n<=t.e.c;n++){const i=this.getCell(e,n);i.master={r:t.s.r,c:t.s.c},i.isMerged=!0}}),a.forEach(({table:n,oldRange:i})=>{const r=n.range,o=t-i.s.c;r.e.c+=e;for(let t=0;t<e;t++)n.columns.splice(o,0,{id:n.columns.length+t+1,name:`列${o+t+1}`});n.autoFilterEnabled&&n.ze()}),s&&(c.e.c+=e,l.re=this.SN.Utils.rangeNumToStr(c))}}),this.Drawing.Jn(t,e),this.SN.Event.emit("afterInsertColumns",{sheet:this,col:t,count:e}),this.SN.ht({type:"insertColumns",sheet:this,col:t,count:e})})},delRows:function(t,e=1){this.SN.Event.emit("beforeDeleteRows",{sheet:this,row:t,count:e}).canceled||this.SN.st("deleteRows",{sheet:this,row:t,count:e},()=>{const n=this.rows.slice(t,t+e),i=this.merges.slice(),r=new Set(this.bt);this.merges=this.merges.filter(n=>n.e.r<t||(n.s.r>=t+e?(this.eachCells(n,(t,i)=>{this.getCell(t,i).master={r:n.s.r-e,c:n.s.c}}),n.s.r-=e,n.e.r-=e,!0):n.s.r==t?!(n.e.r-n.s.r<e||(n.e.r-=e,0)):(n.e.r-=e,!0))),this.rows.splice(t,e),this.Ao();const o=new Set;this.bt.forEach(n=>{n>=t&&n<t+e||(n>=t+e?o.add(n-e):o.add(n))}),this.bt=o,this.merges=this.merges.filter(t=>{if(t.s.r==t.e.r&&t.s.c==t.e.c){const e=this.getCell(t.s.r,t.s.c);return e.isMerged=!1,e.master=null,!1}return!0});const a=this.merges.slice(),s=new Set(this.bt);this.SN.UndoRedo.add({undo:()=>{this.rows.splice(t,0,...n),this.bt=new Set(r),this.merges=i.slice()},redo:()=>{this.rows.splice(t,e),this.bt=new Set(s),this.merges=a.slice()}}),this.Drawing.Yn(t,e),this.SN.Event.emit("afterDeleteRows",{sheet:this,row:t,count:e}),this.SN.ht({type:"deleteRows",sheet:this,row:t,count:e})})},delCols:function(t,e=1){this.SN.Event.emit("beforeDeleteColumns",{sheet:this,col:t,count:e}).canceled||this.SN.st("deleteColumns",{sheet:this,col:t,count:e},()=>{const n=this.cols.slice(t,t+e),i=this.rows.map(n=>n?n.cells.slice(t,t+e):null),r=this.merges.slice(),o=new Set(this.yt);this.merges=this.merges.filter(n=>n.e.c<t||(n.s.c>=t+e?(this.eachCells(n,(t,i)=>{this.getCell(t,i).master={r:n.s.r,c:n.s.c-e}}),n.s.c-=e,n.e.c-=e,!0):n.s.c==t?!(n.e.c-n.s.c<e||(n.e.c=n.e.c-e,0)):(n.e.c=n.e.c-e,!0))),this.rows.forEach(n=>{n&&n.cells.splice(t,e)}),this.cols.splice(t,e),this.Ao();const a=new Set;this.yt.forEach(n=>{n>=t&&n<t+e||(n>=t+e?a.add(n-e):a.add(n))}),this.yt=a,this.merges=this.merges.filter(t=>{if(t.s.r==t.e.r&&t.s.c==t.e.c){const e=this.getCell(t.s.r,t.s.c);return e.isMerged=!1,e.master=null,!1}return!0});const s=this.merges.slice(),l=new Set(this.yt);this.SN.UndoRedo.add({undo:()=>{this.cols.splice(t,0,...n),this.rows.forEach((e,n)=>{e&&i[n]&&e.cells.splice(t,0,...i[n])}),this.yt=new Set(o),this.merges=r.slice()},redo:()=>{this.rows.forEach(n=>{n&&n.cells.splice(t,e)}),this.cols.splice(t,e),this.yt=new Set(l),this.merges=s.slice()}}),this.Drawing.Zn(t,e),this.SN.Event.emit("afterDeleteColumns",{sheet:this,col:t,count:e}),this.SN.ht({type:"deleteColumns",sheet:this,col:t,count:e})})},getCellInViewInfo:function(t,e,n=!0){let i,r=t,o=e;if(n){const n=this.getCell(t,e);n.master&&(r=n.master.r,o=n.master.c,i=this.merges.find(t=>t.s.r===r&&t.s.c===o))}const a=this.vi.colsIndex,s=this.vi.rowsIndex;let l=this.indexWidth;for(let y of a){if(y>=o)break;l+=this.getCol(y).width}let c=this.headHeight;for(let y of s){if(y>=r)break;c+=this.getRow(y).height}const h=this.getCol(e)?.width,u=this.getRow(t)?.height,d=i?[...Array(i.e.c-i.s.c+1).keys()].reduce((t,e)=>{const n=this.getCol(i.s.c+e);return n.hidden||!this.vi.colsIndex.includes(i.s.c+e)?t:t+n.width},0):h,f=i?[...Array(i.e.r-i.s.r+1).keys()].reduce((t,e)=>{const n=this.getRow(i.s.r+e);return n.hidden||!this.vi.rowsIndex.includes(i.s.r+e)?t:t+n.height},0):u,p=this.Canvas,m=p?.viewWidth??p?.width??this.do.offsetWidth,g=p?.viewHeight??p?.height??this.do.offsetHeight;let v=!1;return v=i?l+d>this.indexWidth&&c+f>this.headHeight&&l<m&&c<g:t>=s[0]&&t<=s[s.length-1]&&e>=a[0]&&e<=a[a.length-1],{inView:v,x:l,y:c,w:d,h:f}},getAreaInviewInfo:function(t){let{s:{c:e,r:n},e:{c:i,r}}=t;const o=this.vi.colsIndex,a=this.vi.rowsIndex;if(r<a[0]||n>a[a.length-1]||i<o[0]||e>o[o.length-1])return{inView:!1};let s=this.indexWidth,l=this.headHeight,c=0,h=0;r>a[a.length-1]&&(r=a[a.length-1]),i>o[o.length-1]&&(i=o[o.length-1]);for(let u of a)if(u>=n&&u<=r)h+=this.getRow(u).height;else{if(!(u<n))break;l+=this.getRow(u).height}for(let u of o)if(u>=e&&u<=i)c+=this.getCol(u).width;else{if(!(u<e))break;s+=this.getCol(u).width}return{x:s,y:l,w:c,h,inView:!0}},getTotalHeight:function(){if(void 0!==this.Ct)return this.Ct;let t=0;for(let e=0;e<this.rowCount;e++)this.getRow(e).hidden||(t+=this.getRow(e).height);return this.Ct=t,t},getTotalWidth:function(){if(void 0!==this.Ft)return this.Ft;let t=0;for(let e=0;e<this.colCount;e++)this.getCol(e).hidden||(t+=this.getCol(e).width);return this.Ft=t,t},getScrollTop:function(t){let e=0;for(let n=0;n<t&&n<this.rowCount;n++)this.getRow(n).hidden||(e+=this.getRow(n).height);return e},getScrollLeft:function(t){let e=0;for(let n=0;n<t&&n<this.colCount;n++)this.getCol(n).hidden||(e+=this.getCol(n).width);return e},getRowIndexByScrollTop:function(t){let e=0;for(let n=0;n<this.rowCount;n++)if(!this.getRow(n).hidden&&(e+=this.getRow(n).height,e>t))return n;return Math.max(0,this.rowCount-1)},getColIndexByScrollLeft:function(t){let e=0;for(let n=0;n<this.colCount;n++)if(!this.getCol(n).hidden&&(e+=this.getCol(n).width,e>t))return n;return Math.max(0,this.colCount-1)},ko:function(t){let{s:{c:e,r:n},e:{c:i,r}}=t;const o=this.vi.colsIndex,a=this.vi.rowsIndex;if(r<a[0]||n>a[a.length-1]||i<o[0]||e>o[o.length-1])return{inView:!1};let s=0,l=0;for(let p=n;p<=r;p++){const t=this.getRow(p);t.hidden||(l+=t.height)}for(let p=e;p<=i;p++){const t=this.getCol(p);t.hidden||(s+=t.width)}let c=0;const h=o[0];if(e>=h)for(let p=h;p<e;p++){const t=this.getCol(p);t.hidden||(c+=t.width)}else for(let p=e;p<h;p++){const t=this.getCol(p);t.hidden||(c-=t.width)}let u=this.indexWidth+c,d=0;const f=a[0];if(n>=f)for(let p=f;p<n;p++){const t=this.getRow(p);t.hidden||(d+=t.height)}else for(let p=n;p<f;p++){const t=this.getRow(p);t.hidden||(d-=t.height)}return{x:u,y:this.headHeight+d,w:s,h:l,inView:!0}},To:function(t,e){const n=t??this.Canvas?.viewWidth??this.do.offsetWidth,i=e??this.Canvas?.viewHeight??this.do.offsetHeight;let r={t:null,l:null,r:null,b:null};for(let f=this.colCount-1;f>=0;f--)if(!this.getCol(f).hidden){r.r=f;break}for(let f=this.rowCount-1;f>=0;f--)if(!this.getRow(f).hidden){r.b=f;break}for(let f=0;f<this.colCount;f++)if(!this.getCol(f).hidden){r.l=f;break}for(let f=0;f<this.rowCount;f++)if(!this.getRow(f).hidden){r.t=f;break}let o=this.vi??{rowArr:[r.t],colArr:[r.l]};const a=Math.max(r.t,this.ro||0),s=Math.max(r.l,this.io||0);o.rowArr[0]=Math.min(Math.max(o.rowArr[0],a),r.b),o.colArr[0]=Math.min(Math.max(o.colArr[0],s),r.r);const l={frozenCols:[],frozenRows:[],rowArr:[],colArr:[],rowsIndex:[],colsIndex:[],w:this.indexWidth,h:this.headHeight,fw:0,fh:0,side:r},c=this.frozenCols,h=this.frozenRows,u=this.wo||0,d=this.yo||0;if(c>0&&u<c)for(let f=u;f<c;f++){const t=this.getCol(f);t.hidden||(l.w+=t.width,l.frozenCols.push(f))}if(h>0&&d<h)for(let f=d;f<h;f++){const t=this.getRow(f);t.hidden||(l.h+=t.height,l.frozenRows.push(f))}l.fw=l.w,l.fh=l.h;for(let f=o.colArr[0];f<this.colCount;f++){const t=this.getCol(f);if(!(t.hidden||f<c)&&(l.w+=t.width,l.colArr.push(f),l.w>n))break}for(let f=o.rowArr[0];f<this.rowCount;f++){const t=this.getRow(f);if(!(t.hidden||f<h)&&(l.h+=t.height,l.rowArr.push(f),l.h>i))break}l.rowsIndex=[...l.frozenRows,...l.rowArr],l.colsIndex=[...l.frozenCols,...l.colArr],this.vi=l},No:function(t,e){let n=0,i=t;for(let r=t-1;r>=0;r--)if(this.getRow(r).hidden||(n++,i=r),n>=e)return r;return i},Fo:function(t,e){let n=0,i=t;for(let r=t-1;r>=0;r--)if(this.getCol(r).hidden||(n++,i=r),n>=e)return r;return i},$o:function(t,e){let n=0,i=t;for(let r=t+1;r<this.rowCount;r++)if(this.getRow(r).hidden||(n++,i=r),n>=e)return r;return i},Mo:function(t,e){let n=0,i=t;for(let r=t+1;r<this.colCount;r++)if(this.getCol(r).hidden||(n++,i=r),n>=e)return r;return i},Ao:function(){this.Ct=void 0,this.Ft=void 0},J:function(){return this.initialized||(this.initialized=!0,On.call(this),Bn.call(this),Vn.call(this),Hn.call(this),Un.call(this),qn.call(this),Kn.call(this),Gn.call(this),Xn.call(this),Yn.call(this),Zn.call(this),Jn.call(this),jn.call(this),Wn.call(this),Qn.call(this)),this},copy:function(t=null,e=!1){const n=this;t||(t=n.activeAreas[n.activeAreas.length-1]),"string"==typeof t&&(t=n.rangeStrToNum(t));const i=e?"Cut":"Copy",r={sheet:n,area:JSON.parse(JSON.stringify(t)),isCut:e},o=ei(n.SN,`before${i}`,r);if(o?.canceled)return null;const a={sheetName:n.name,area:JSON.parse(JSON.stringify(t)),isCut:e,cells:[],merges:[],colWidths:[],rowHeights:[],comments:[],timestamp:Date.now()};t.e.r,t.s.r,t.e.c,t.s.c;for(let s=t.s.c;s<=t.e.c;s++)a.colWidths.push(n.getCol(s).width);for(let s=t.s.r;s<=t.e.r;s++)a.rowHeights.push(n.getRow(s).height);for(let s=t.s.r;s<=t.e.r;s++){const e=[];for(let i=t.s.c;i<=t.e.c;i++){const t=n.getCell(s,i);e.push(ni(t))}a.cells.push(e)}return n.merges.forEach(e=>{e.s.r>=t.s.r&&e.e.r<=t.e.r&&e.s.c>=t.s.c&&e.e.c<=t.e.c&&a.merges.push({s:{r:e.s.r-t.s.r,c:e.s.c-t.s.c},e:{r:e.e.r-t.s.r,c:e.e.c-t.s.c}})}),n.Comment?.list&&n.Comment.list.forEach(e=>{const n=e.cellPos;n.r>=t.s.r&&n.r<=t.e.r&&n.c>=t.s.c&&n.c<=t.e.c&&a.comments.push({relR:n.r-t.s.r,relC:n.c-t.s.c,author:e.author,text:e.text,width:e.width,height:e.height})}),ti=a,ei(n.SN,`after${i}`,{...r,data:a}),a},cut:function(t=null){return this.copy(t,!0)},paste:function(t=null,e={}){const n=this,{mode:i=it.ALL,operation:r=rt.NONE,skipBlanks:o=!1,transpose:a=!1,externalData:s=null}=e;t||(t={r:n.activeCell.r,c:n.activeCell.c});const l=t.r??t.s?.r??0,c=t.c??t.s?.c??0,h=s||ti;if(!h||!h.cells||0===h.cells.length)return!1;const u=a||i===it.TRANSPOSE,d=h.cells.length,f=h.cells[0]?.length||0,p=u?f:d,m=u?d:f,g={s:{r:l,c},e:{r:l+p-1,c:c+m-1}},v={sheet:n,targetArea:g,options:{mode:i,operation:r,skipBlanks:o,transpose:u},data:h},y=ei(n.SN,"beforePaste",v);if(y?.canceled)return!1;const b=new Set([it.ALL,it.ALL_MERGE_CONDITIONAL,it.VALUE,it.FORMULA,it.NO_BORDER,it.TRANSPOSE,it.VALUE_NUMBER_FORMAT,it.FORMULA_NUMBER_FORMAT]),x=new Set([it.ALL,it.ALL_MERGE_CONDITIONAL,it.FORMAT,it.NO_BORDER,it.TRANSPOSE,it.VALUE_NUMBER_FORMAT,it.FORMULA_NUMBER_FORMAT,it.VALIDATION]);if(b.has(i)||rt.NONE,x.has(i)||oi(i),i===it.ALL||it.COLUMN_WIDTH,ai(i),[it.ALL,it.ALL_MERGE_CONDITIONAL,it.NO_BORDER,it.TRANSPOSE].includes(i),h.isCut&&h.sheetName===n.name&&(S=g,!((w=h.area).e.r<S.s.r||w.s.r>S.e.r||w.e.c<S.s.c||w.s.c>S.e.c)))return n.SN.Utils.toast(n.SN.t("core.sheet.clipboard.toast.msg001")),!1;var w,S;!function(t,e){const n=[];t.merges.forEach((t,i)=>{t.e.r<e.s.r||t.s.r>e.e.r||t.e.c<e.s.c||t.s.c>e.e.c||n.push(t)}),n.forEach(e=>{t.unMergeCells({r:e.s.r,c:e.s.c})})}(n,g);for(let C=0;C<p;C++)for(let t=0;t<m;t++){const e=u?t:C,a=u?C:t,s=h.cells[e]?.[a];s&&(o&&si(s)||ii(n.getCell(l+C,c+t),s,i,r))}if(oi(i)&&h.merges.length>0&&h.merges.forEach(t=>{let e;e=u?{s:{r:l+t.s.c,c:c+t.s.r},e:{r:l+t.e.c,c:c+t.e.r}}:{s:{r:l+t.s.r,c:c+t.s.c},e:{r:l+t.e.r,c:c+t.e.c}};try{n.mergeCells(e)}catch(t){}}),i!==it.ALL&&i!==it.COLUMN_WIDTH||(u?h.rowHeights.forEach((t,e)=>{t&&(n.getCol(c+e).width=t)}):h.colWidths.forEach((t,e)=>{t&&(n.getCol(c+e).width=t)})),ai(i)&&h.comments.length>0&&h.comments.forEach(t=>{let e,i;u?(e=l+t.relC,i=c+t.relR):(e=l+t.relR,i=c+t.relC);const r=n.SN.Utils.numToCell(e,i);n.Comment.add({cellRef:r,author:t.author,text:t.text,width:t.width,height:t.height})}),h.isCut&&!s){const t=n.SN.getSheet(h.sheetName);t&&function(t,e){t.eachCells(e,(e,n)=>{const i=t.getCell(e,n);i.B="",i.H=void 0,i.U=void 0,i.O=void 0,i.F=null,i._=null});const n=[];if(t.merges.forEach(t=>{t.s.r>=e.s.r&&t.e.r<=e.e.r&&t.s.c>=e.s.c&&t.e.c<=e.e.c&&n.push(t)}),n.forEach(e=>{t.unMergeCells({r:e.s.r,c:e.s.c})}),t.Comment?.list){const n=[];t.Comment.list.forEach(t=>{const i=t.cellPos;i.r>=e.s.r&&i.r<=e.e.r&&i.c>=e.s.c&&i.c<=e.e.c&&n.push(t.cellRef)}),n.forEach(e=>{t.Comment.remove(e)})}}(t,h.area),ti=null}return ei(n.SN,"afterPaste",{...v,success:!0}),!0},clearClipboard:function(){const t=this,e=ei(t.SN,"beforeClearClipboard",{sheet:t});e?.canceled||(ti=null,ei(t.SN,"afterClearClipboard",{sheet:t}))},getClipboardData:function(){return ti},hasClipboardData:function(){return null!==ti}});var Fi=function(t,e){return Fi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Fi(t,e)};function Ei(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Fi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Di=function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1},Li=new function(){this.browser=new Di,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow="undefined"!=typeof window};"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?(Li.wxa=!0,Li.touchEventsSupported=!0):"undefined"==typeof document&&"undefined"!=typeof self?Li.worker=!0:!Li.hasGlobalWindow||"Deno"in window||"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Node.js")>-1?(Li.node=!0,Li.svgSupported=!0):function(t,e){var n=e.browser,i=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge?\/([\d.]+)/),a=/micromessenger/i.test(t);if(i&&(n.firefox=!0,n.version=i[1]),r&&(n.ie=!0,n.version=r[1]),o&&(n.edge=!0,n.version=o[1],n.newEdge=+o[1].split(".")[0]>18),a&&(n.weChat=!0),e.svgSupported="undefined"!=typeof SVGRect,e.touchEventsSupported="ontouchstart"in window&&!n.ie&&!n.edge,e.pointerEventsSupported="onpointerdown"in window&&(n.edge||n.ie&&+n.version>=11),e.domSupported="undefined"!=typeof document){var s=document.documentElement.style;e.transform3dSupported=(n.ie&&"transition"in s||n.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),e.transformSupported=e.transform3dSupported||n.ie&&+n.version>=9}}(navigator.userAgent,Li);var Pi="12px sans-serif",zi=function(){var t={};if("undefined"==typeof JSON)return t;for(var e=0;e<95;e++){var n=String.fromCharCode(e+32),i=("007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N".charCodeAt(e)-20)/100;t[n]=i}return t}(),Oi={createCanvas:function(){return"undefined"!=typeof document&&document.createElement("canvas")},measureText:function(){var t,e;return function(n,i){if(!t){var r=Oi.createCanvas();t=r&&r.getContext("2d")}if(t)return e!==i&&(e=t.font=i||Pi),t.measureText(n);n=n||"";var o=/((?:\d+)?\.?\d*)px/.exec(i=i||Pi),a=o&&+o[1]||12,s=0;if(i.indexOf("mono")>=0)s=a*n.length;else for(var l=0;l<n.length;l++){var c=zi[n[l]];s+=null==c?a:c*a}return{width:s}}}(),loadImage:function(t,e,n){var i=new Image;return i.onload=e,i.onerror=n,i.src=t,i}},Bi=cr(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(t,e){return t["[object "+e+"]"]=!0,t},{}),Vi=cr(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(t,e){return t["[object "+e+"Array]"]=!0,t},{}),Hi=Object.prototype.toString,Ui=Array.prototype,qi=Ui.forEach,Ki=Ui.filter,Wi=Ui.slice,ji=Ui.map,Gi=function(){}.constructor,Xi=Gi?Gi.prototype:null,Yi="__proto__",Zi=2311;function Ji(){return Zi++}function Qi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}function tr(t){if(null==t||"object"!=typeof t)return t;var e=t,n=Hi.call(t);if("[object Array]"===n){if(!Dr(t)){e=[];for(var i=0,r=t.length;i<r;i++)e[i]=tr(t[i])}}else if(Vi[n]){if(!Dr(t)){var o=t.constructor;if(o.from)e=o.from(t);else for(e=new o(t.length),i=0,r=t.length;i<r;i++)e[i]=t[i]}}else if(!Bi[n]&&!Dr(t)&&!Cr(t))for(var a in e={},t)t.hasOwnProperty(a)&&a!==Yi&&(e[a]=tr(t[a]));return e}function er(t,e,n){if(!xr(e)||!xr(t))return n?tr(e):t;for(var i in e)if(e.hasOwnProperty(i)&&i!==Yi){var r=t[i],o=e[i];!xr(o)||!xr(r)||mr(o)||mr(r)||Cr(o)||Cr(r)||wr(o)||wr(r)||Dr(o)||Dr(r)?!n&&i in t||(t[i]=tr(e[i])):er(r,o,n)}return t}function nr(t,e){if(Object.assign)Object.assign(t,e);else for(var n in e)e.hasOwnProperty(n)&&n!==Yi&&(t[n]=e[n]);return t}function ir(t,e,n){for(var i=dr(e),r=0,o=i.length;r<o;r++){var a=i[r];(n?null!=e[a]:null==t[a])&&(t[a]=e[a])}return t}function rr(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1}function or(t,e,n){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var i=Object.getOwnPropertyNames(e),r=0;r<i.length;r++){var o=i[r];"constructor"!==o&&(n?null!=e[o]:null==t[o])&&(t[o]=e[o])}else ir(t,e,n)}function ar(t){return!!t&&"string"!=typeof t&&"number"==typeof t.length}function sr(t,e,n){if(t&&e)if(t.forEach&&t.forEach===qi)t.forEach(e,n);else if(t.length===+t.length)for(var i=0,r=t.length;i<r;i++)e.call(n,t[i],i,t);else for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)}function lr(t,e,n){if(!t)return[];if(!e)return kr(t);if(t.map&&t.map===ji)return t.map(e,n);for(var i=[],r=0,o=t.length;r<o;r++)i.push(e.call(n,t[r],r,t));return i}function cr(t,e,n,i){if(t&&e){for(var r=0,o=t.length;r<o;r++)n=e.call(i,n,t[r],r,t);return n}}function hr(t,e,n){if(!t)return[];if(!e)return kr(t);if(t.filter&&t.filter===Ki)return t.filter(e,n);for(var i=[],r=0,o=t.length;r<o;r++)e.call(n,t[r],r,t)&&i.push(t[r]);return i}function ur(t,e,n){if(t&&e)for(var i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t))return t[i]}function dr(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}var fr=Xi&&gr(Xi.bind)?Xi.call.bind(Xi.bind):function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return function(){return t.apply(e,n.concat(Wi.call(arguments)))}};function pr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){return t.apply(this,e.concat(Wi.call(arguments)))}}function mr(t){return Array.isArray?Array.isArray(t):"[object Array]"===Hi.call(t)}function gr(t){return"function"==typeof t}function vr(t){return"string"==typeof t}function yr(t){return"[object String]"===Hi.call(t)}function br(t){return"number"==typeof t}function xr(t){var e=typeof t;return"function"===e||!!t&&"object"===e}function wr(t){return!!Bi[Hi.call(t)]}function Sr(t){return!!Vi[Hi.call(t)]}function Cr(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}function Tr(t){return null!=t.colorStops}function $r(t){return t!=t}function Mr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,i=t.length;n<i;n++)if(null!=t[n])return t[n]}function Ar(t,e){return null!=t?t:e}function Nr(t,e,n){return null!=t?t:null!=e?e:n}function kr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Wi.apply(t,e)}function Rr(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function _r(t,e){if(!t)throw new Error(e)}function Ir(t){return null==t?null:"function"==typeof t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var Fr="__ec_primitive__";function Er(t){t[Fr]=!0}function Dr(t){return t[Fr]}var Lr=function(){function t(){this.data={}}return t.prototype.delete=function(t){var e=this.has(t);return e&&delete this.data[t],e},t.prototype.has=function(t){return this.data.hasOwnProperty(t)},t.prototype.get=function(t){return this.data[t]},t.prototype.set=function(t,e){return this.data[t]=e,this},t.prototype.keys=function(){return dr(this.data)},t.prototype.forEach=function(t){var e=this.data;for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},t}(),Pr="function"==typeof Map,zr=function(){function t(e){var n=mr(e);this.data=Pr?new Map:new Lr;var i=this;function r(t,e){n?i.set(t,e):i.set(e,t)}e instanceof t?e.each(r):e&&sr(e,r)}return t.prototype.hasKey=function(t){return this.data.has(t)},t.prototype.get=function(t){return this.data.get(t)},t.prototype.set=function(t,e){return this.data.set(t,e),e},t.prototype.each=function(t,e){this.data.forEach(function(n,i){t.call(e,n,i)})},t.prototype.keys=function(){var t=this.data.keys();return Pr?Array.from(t):t},t.prototype.removeKey=function(t){this.data.delete(t)},t}();function Or(t){return new zr(t)}function Br(t,e){for(var n=new t.constructor(t.length+e.length),i=0;i<t.length;i++)n[i]=t[i];var r=t.length;for(i=0;i<e.length;i++)n[i+r]=e[i];return n}function Vr(t,e){var n;if(Object.create)n=Object.create(t);else{var i=function(){};i.prototype=t,n=new i}return e&&nr(n,e),n}function Hr(t){var e=t.style;e.webkitUserSelect="none",e.userSelect="none",e.webkitTapHighlightColor="rgba(0,0,0,0)",e["-webkit-touch-callout"]="none"}function Ur(t,e){return t.hasOwnProperty(e)}function qr(){}var Kr=180/Math.PI;function Wr(t,e){return null==t&&(t=0),null==e&&(e=0),[t,e]}function jr(t){return[t[0],t[1]]}function Gr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Xr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Yr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Zr(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var Jr=Zr,Qr=function(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])};function to(t,e,n,i){return t[0]=e[0]+i*(n[0]-e[0]),t[1]=e[1]+i*(n[1]-e[1]),t}function eo(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function no(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function io(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}var ro=function(t,e){this.target=t,this.topTarget=e&&e.topTarget},oo=function(){function t(t){this.handler=t,t.on("mousedown",this._o,this),t.on("mousemove",this.Eo,this),t.on("mouseup",this.Io,this)}return t.prototype._o=function(t){for(var e=t.target;e&&!e.draggable;)e=e.parent||e.__hostTarget;e&&(this.zo=e,e.dragging=!0,this.Do=t.offsetX,this.Lo=t.offsetY,this.handler.dispatchToElement(new ro(e,t),"dragstart",t.event))},t.prototype.Eo=function(t){var e=this.zo;if(e){var n=t.offsetX,i=t.offsetY,r=n-this.Do,o=i-this.Lo;this.Do=n,this.Lo=i,e.drift(r,o,t),this.handler.dispatchToElement(new ro(e,t),"drag",t.event);var a=this.handler.findHover(n,i,e).target,s=this.Oo;this.Oo=a,e!==a&&(s&&a!==s&&this.handler.dispatchToElement(new ro(s,t),"dragleave",t.event),a&&a!==s&&this.handler.dispatchToElement(new ro(a,t),"dragenter",t.event))}},t.prototype.Io=function(t){var e=this.zo;e&&(e.dragging=!1),this.handler.dispatchToElement(new ro(e,t),"dragend",t.event),this.Oo&&this.handler.dispatchToElement(new ro(this.Oo,t),"drop",t.event),this.zo=null,this.Oo=null},t}(),ao=function(){function t(t){t&&(this._$eventProcessor=t)}return t.prototype.on=function(t,e,n,i){this._$handlers||(this._$handlers={});var r=this._$handlers;if("function"==typeof e&&(i=n,n=e,e=null),!n||!t)return this;var o=this._$eventProcessor;null!=e&&o&&o.normalizeQuery&&(e=o.normalizeQuery(e)),r[t]||(r[t]=[]);for(var a=0;a<r[t].length;a++)if(r[t][a].h===n)return this;var s={h:n,query:e,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},l=r[t].length-1,c=r[t][l];return c&&c.callAtLast?r[t].splice(l,0,s):r[t].push(s),this},t.prototype.isSilent=function(t){var e=this._$handlers;return!e||!e[t]||!e[t].length},t.prototype.off=function(t,e){var n=this._$handlers;if(!n)return this;if(!t)return this._$handlers={},this;if(e){if(n[t]){for(var i=[],r=0,o=n[t].length;r<o;r++)n[t][r].h!==e&&i.push(n[t][r]);n[t]=i}n[t]&&0===n[t].length&&delete n[t]}else delete n[t];return this},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],r=this._$eventProcessor;if(i)for(var o=e.length,a=i.length,s=0;s<a;s++){var l=i[s];if(!r||!r.filter||null==l.query||r.filter(t,l.query))switch(o){case 0:l.h.call(l.ctx);break;case 1:l.h.call(l.ctx,e[0]);break;case 2:l.h.call(l.ctx,e[0],e[1]);break;default:l.h.apply(l.ctx,e)}}return r&&r.afterTrigger&&r.afterTrigger(t),this},t.prototype.triggerWithContext=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],r=this._$eventProcessor;if(i)for(var o=e.length,a=e[o-1],s=i.length,l=0;l<s;l++){var c=i[l];if(!r||!r.filter||null==c.query||r.filter(t,c.query))switch(o){case 0:c.h.call(a);break;case 1:c.h.call(a,e[0]);break;case 2:c.h.call(a,e[0],e[1]);break;default:c.h.apply(a,e.slice(1,o-1))}}return r&&r.afterTrigger&&r.afterTrigger(t),this},t}(),so=Math.log(2);function lo(t,e,n,i,r,o){var a=i+"-"+r,s=t.length;if(o.hasOwnProperty(a))return o[a];if(1===e){var l=Math.round(Math.log((1<<s)-1&~r)/so);return t[n][l]}for(var c=i|1<<n,h=n+1;i&1<<h;)h++;for(var u=0,d=0,f=0;d<s;d++){var p=1<<d;p&r||(u+=(f%2?-1:1)*t[n][d]*lo(t,e-1,h,c,r|p,o),f++)}return o[a]=u,u}function co(t,e){var n=[[t[0],t[1],1,0,0,0,-e[0]*t[0],-e[0]*t[1]],[0,0,0,t[0],t[1],1,-e[1]*t[0],-e[1]*t[1]],[t[2],t[3],1,0,0,0,-e[2]*t[2],-e[2]*t[3]],[0,0,0,t[2],t[3],1,-e[3]*t[2],-e[3]*t[3]],[t[4],t[5],1,0,0,0,-e[4]*t[4],-e[4]*t[5]],[0,0,0,t[4],t[5],1,-e[5]*t[4],-e[5]*t[5]],[t[6],t[7],1,0,0,0,-e[6]*t[6],-e[6]*t[7]],[0,0,0,t[6],t[7],1,-e[7]*t[6],-e[7]*t[7]]],i={},r=lo(n,8,0,0,0,i);if(0!==r){for(var o=[],a=0;a<8;a++)for(var s=0;s<8;s++)null==o[s]&&(o[s]=0),o[s]+=((a+s)%2?-1:1)*lo(n,7,0===a?1:0,1<<a,1<<s,i)/r*e[a];return function(t,e,n){var i=e*o[6]+n*o[7]+1;t[0]=(e*o[0]+n*o[1]+o[2])/i,t[1]=(e*o[3]+n*o[4]+o[5])/i}}}var ho="___zrEVENTSAVED",uo=[];function fo(t,e,n,i,r){if(e.getBoundingClientRect&&Li.domSupported&&!po(e)){var o=e[ho]||(e[ho]={}),a=function(t,e){var n=e.markers;if(n)return n;n=e.markers=[];for(var i=["left","right"],r=["top","bottom"],o=0;o<4;o++){var a=document.createElement("div"),s=o%2,l=(o>>1)%2;a.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",i[s]+":0",r[l]+":0",i[1-s]+":auto",r[1-l]+":auto",""].join("!important;"),t.appendChild(a),n.push(a)}return e.clearMarkers=function(){sr(n,function(t){t.parentNode&&t.parentNode.removeChild(t)})},n}(e,o),s=function(t,e,n){for(var i=n?"invTrans":"trans",r=e[i],o=e.srcCoords,a=[],s=[],l=!0,c=0;c<4;c++){var h=t[c].getBoundingClientRect(),u=2*c,d=h.left,f=h.top;a.push(d,f),l=l&&o&&d===o[u]&&f===o[u+1],s.push(t[c].offsetLeft,t[c].offsetTop)}return l&&r?r:(e.srcCoords=a,e[i]=n?co(s,a):co(a,s))}(a,o,r);if(s)return s(t,n,i),!0}return!1}function po(t){return"CANVAS"===t.nodeName.toUpperCase()}var mo=/([&<>"'])/g,go={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function vo(t){return null==t?"":(t+"").replace(mo,function(t,e){return go[e]})}var yo=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,bo=[],xo=Li.browser.firefox&&+Li.browser.version.split(".")[0]<39;function wo(t,e,n,i){return n=n||{},i?So(t,e,n):xo&&null!=e.layerX&&e.layerX!==e.offsetX?(n.zrX=e.layerX,n.zrY=e.layerY):null!=e.offsetX?(n.zrX=e.offsetX,n.zrY=e.offsetY):So(t,e,n),n}function So(t,e,n){if(Li.domSupported&&t.getBoundingClientRect){var i=e.clientX,r=e.clientY;if(po(t)){var o=t.getBoundingClientRect();return n.zrX=i-o.left,void(n.zrY=r-o.top)}if(fo(bo,t,i,r))return n.zrX=bo[0],void(n.zrY=bo[1])}n.zrX=n.zrY=0}function Co(t){return t||window.event}function To(t,e,n){if(null!=(e=Co(e)).zrX)return e;var i=e.type;if(i&&i.indexOf("touch")>=0){var r="touchend"!==i?e.targetTouches[0]:e.changedTouches[0];r&&wo(t,r,e,n)}else{wo(t,e,e,n);var o=function(t){var e=t.wheelDelta;if(e)return e;var n=t.deltaX,i=t.deltaY;return null==n||null==i?e:3*(0!==i?Math.abs(i):Math.abs(n))*(i>0?-1:i<0?1:n>0?-1:1)}(e);e.zrDelta=o?o/120:-(e.detail||0)/3}var a=e.button;return null==e.which&&void 0!==a&&yo.test(e.type)&&(e.which=1&a?1:2&a?3:4&a?2:0),e}function $o(t,e,n,i){t.removeEventListener(e,n,i)}var Mo=function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0};function Ao(t){return 2===t.which||3===t.which}var No=function(){function t(){this.Po=[]}return t.prototype.recognize=function(t,e,n){return this.Vo(t,e,n),this.Bo(t)},t.prototype.clear=function(){return this.Po.length=0,this},t.prototype.Vo=function(t,e,n){var i=t.touches;if(i){for(var r={points:[],touches:[],target:e,event:t},o=0,a=i.length;o<a;o++){var s=i[o],l=wo(n,s,{});r.points.push([l.zrX,l.zrY]),r.touches.push(s)}this.Po.push(r)}},t.prototype.Bo=function(t){for(var e in Ro)if(Ro.hasOwnProperty(e)){var n=Ro[e](this.Po,t);if(n)return n}},t}();function ko(t){var e=t[1][0]-t[0][0],n=t[1][1]-t[0][1];return Math.sqrt(e*e+n*n)}var Ro={pinch:function(t,e){var n=t.length;if(n){var i,r=(t[n-1]||{}).points,o=(t[n-2]||{}).points||r;if(o&&o.length>1&&r&&r.length>1){var a=ko(r)/ko(o);!isFinite(a)&&(a=1),e.pinchScale=a;var s=[((i=r)[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2];return e.pinchX=s[0],e.pinchY=s[1],{type:"pinch",target:t[0].target,event:e}}}}};function _o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Io(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Fo(t,e,n){var i=e[0]*n[0]+e[2]*n[1],r=e[1]*n[0]+e[3]*n[1],o=e[0]*n[2]+e[2]*n[3],a=e[1]*n[2]+e[3]*n[3],s=e[0]*n[4]+e[2]*n[5]+e[4],l=e[1]*n[4]+e[3]*n[5]+e[5];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t}function Eo(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t}function Do(t,e,n,i){void 0===i&&(i=[0,0]);var r=e[0],o=e[2],a=e[4],s=e[1],l=e[3],c=e[5],h=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*h,t[1]=-r*h+s*u,t[2]=o*u+l*h,t[3]=-o*h+u*l,t[4]=u*(a-i[0])+h*(c-i[1])+i[0],t[5]=u*(c-i[1])-h*(a-i[0])+i[1],t}function Lo(t,e,n){var i=n[0],r=n[1];return t[0]=e[0]*i,t[1]=e[1]*r,t[2]=e[2]*i,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*r,t}function Po(t,e){var n=e[0],i=e[2],r=e[4],o=e[1],a=e[3],s=e[5],l=n*a-o*i;return l?(l=1/l,t[0]=a*l,t[1]=-o*l,t[2]=-i*l,t[3]=n*l,t[4]=(i*s-a*r)*l,t[5]=(o*r-n*s)*l,t):null}var zo=function(){function t(t,e){this.x=t||0,this.y=e||0}return t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.scale=function(t){this.x*=t,this.y*=t},t.prototype.scaleAndAdd=function(t,e){this.x+=t.x*e,this.y+=t.y*e},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},t.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},t.prototype.distanceSquare=function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.transform=function(t){if(t){var e=this.x,n=this.y;return this.x=t[0]*e+t[2]*n+t[4],this.y=t[1]*e+t[3]*n+t[5],this}},t.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},t.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},t.set=function(t,e,n){t.x=e,t.y=n},t.copy=function(t,e){t.x=e.x,t.y=e.y},t.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},t.lenSquare=function(t){return t.x*t.x+t.y*t.y},t.dot=function(t,e){return t.x*e.x+t.y*e.y},t.add=function(t,e,n){t.x=e.x+n.x,t.y=e.y+n.y},t.sub=function(t,e,n){t.x=e.x-n.x,t.y=e.y-n.y},t.scale=function(t,e,n){t.x=e.x*n,t.y=e.y*n},t.scaleAndAdd=function(t,e,n,i){t.x=e.x+n.x*i,t.y=e.y+n.y*i},t.lerp=function(t,e,n,i){var r=1-i;t.x=r*e.x+i*n.x,t.y=r*e.y+i*n.y},t}(),Oo=Math.min,Bo=Math.max,Vo=Math.abs,Ho=["x","y"],Uo=["width","height"],qo=new zo,Ko=new zo,Wo=new zo,jo=new zo,Go=na(),Xo=Go.minTv,Yo=Go.maxTv,Zo=[0,0],Jo=function(){function t(e,n,i,r){t.set(this,e,n,i,r)}return t.set=function(t,e,n,i,r){return i<0&&(e+=i,i=-i),r<0&&(n+=r,r=-r),t.x=e,t.y=n,t.width=i,t.height=r,t},t.prototype.union=function(t){var e=Oo(t.x,this.x),n=Oo(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=Bo(t.x+t.width,this.x+this.width)-e:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=Bo(t.y+t.height,this.y+this.height)-n:this.height=t.height,this.x=e,this.y=n},t.prototype.applyTransform=function(e){t.applyTransform(this,this,e)},t.prototype.calculateTransform=function(t){var e=this,n=t.width/e.width,i=t.height/e.height,r=[1,0,0,1,0,0];return Eo(r,r,[-e.x,-e.y]),Lo(r,r,[n,i]),Eo(r,r,[t.x,t.y]),r},t.prototype.intersect=function(e,n,i){return t.intersect(this,e,n,i)},t.intersect=function(e,n,i,r){i&&zo.set(i,0,0);var o=r&&r.outIntersectRect||null,a=r&&r.clamp;if(o&&(o.x=o.y=o.width=o.height=NaN),!e||!n)return!1;e instanceof t||(e=t.set(Qo,e.x,e.y,e.width,e.height)),n instanceof t||(n=t.set(ta,n.x,n.y,n.width,n.height));var s=!!i;Go.reset(r,s);var l=Go.touchThreshold,c=e.x+l,h=e.x+e.width-l,u=e.y+l,d=e.y+e.height-l,f=n.x+l,p=n.x+n.width-l,m=n.y+l,g=n.y+n.height-l;if(c>h||u>d||f>p||m>g)return!1;var v=!(h<f||p<c||d<m||g<u);return(s||o)&&(Zo[0]=1/0,Zo[1]=0,ea(c,h,f,p,0,s,o,a),ea(u,d,m,g,1,s,o,a),s&&zo.copy(i,v?Go.useDir?Go.dirMinTv:Xo:Yo)),v},t.contain=function(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height},t.prototype.contain=function(e,n){return t.contain(this,e,n)},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(e){t.copy(this,e)},t.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},t.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},t.prototype.isZero=function(){return 0===this.width||0===this.height},t.create=function(e){return new t(e.x,e.y,e.width,e.height)},t.copy=function(t,e){return t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t},t.applyTransform=function(e,n,i){if(i){if(i[1]<1e-5&&i[1]>-1e-5&&i[2]<1e-5&&i[2]>-1e-5){var r=i[0],o=i[3],a=i[4],s=i[5];return e.x=n.x*r+a,e.y=n.y*o+s,e.width=n.width*r,e.height=n.height*o,e.width<0&&(e.x+=e.width,e.width=-e.width),void(e.height<0&&(e.y+=e.height,e.height=-e.height))}qo.x=Wo.x=n.x,qo.y=jo.y=n.y,Ko.x=jo.x=n.x+n.width,Ko.y=Wo.y=n.y+n.height,qo.transform(i),jo.transform(i),Ko.transform(i),Wo.transform(i),e.x=Oo(qo.x,Ko.x,Wo.x,jo.x),e.y=Oo(qo.y,Ko.y,Wo.y,jo.y);var l=Bo(qo.x,Ko.x,Wo.x,jo.x),c=Bo(qo.y,Ko.y,Wo.y,jo.y);e.width=l-e.x,e.height=c-e.y}else e!==n&&t.copy(e,n)},t}(),Qo=new Jo(0,0,0,0),ta=new Jo(0,0,0,0);function ea(t,e,n,i,r,o,a,s){var l=Vo(e-n),c=Vo(i-t),h=Oo(l,c),u=Ho[r],d=Ho[1-r],f=Uo[r];e<n||i<t?l<c?(o&&(Yo[u]=-l),s&&(a[u]=e,a[f]=0)):(o&&(Yo[u]=c),s&&(a[u]=t,a[f]=0)):(a&&(a[u]=Bo(t,n),a[f]=Oo(e,i)-a[u]),o&&(h<Zo[0]||Go.useDir)&&(Zo[0]=Oo(h,Zo[0]),(l<c||!Go.bidirectional)&&(Xo[u]=l,Xo[d]=0,Go.useDir&&Go.calcDirMTV()),(l>=c||!Go.bidirectional)&&(Xo[u]=-c,Xo[d]=0,Go.useDir&&Go.calcDirMTV())))}function na(){var t=0,e=new zo,n=new zo,i={minTv:new zo,maxTv:new zo,useDir:!1,dirMinTv:new zo,touchThreshold:0,bidirectional:!0,negativeSize:!1,reset:function(r,o){i.touchThreshold=0,r&&null!=r.touchThreshold&&(i.touchThreshold=Bo(0,r.touchThreshold)),i.negativeSize=!1,o&&(i.minTv.set(1/0,1/0),i.maxTv.set(0,0),i.useDir=!1,r&&null!=r.direction&&(i.useDir=!0,i.dirMinTv.copy(i.minTv),n.copy(i.minTv),t=r.direction,i.bidirectional=null==r.bidirectional||!!r.bidirectional,i.bidirectional||e.set(Math.cos(t),Math.sin(t))))},calcDirMTV:function(){var o=i.minTv,a=i.dirMinTv,s=o.y*o.y+o.x*o.x,l=Math.sin(t),c=Math.cos(t),h=l*o.y+c*o.x;r(h)?r(o.x)&&r(o.y)&&a.set(0,0):(n.x=s*c/h,n.y=s*l/h,r(n.x)&&r(n.y)?a.set(0,0):(i.bidirectional||e.dot(n)>0)&&n.len()<a.len()&&a.copy(n))}};function r(t){return Vo(t)<1e-10}return i}var ia="silent";function ra(){Mo(this.event)}var oa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handler=null,e}return Ei(e,t),e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(ao),aa=function(t,e){this.x=t,this.y=e},sa=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],la=new Jo(0,0,0,0),ca=function(t){function e(e,n,i,r,o){var a=t.call(this)||this;return a.Ho=new aa(0,0),a.storage=e,a.painter=n,a.painterRoot=r,a.Uo=o,i=i||new oa,a.proxy=null,a.setHandlerProxy(i),a.Ko=new oo(a),a}return Ei(e,t),e.prototype.setHandlerProxy=function(t){this.proxy&&this.proxy.dispose(),t&&(sr(sa,function(e){t.on&&t.on(e,this[e],this)},this),t.handler=this),this.proxy=t},e.prototype.mousemove=function(t){var e=t.zrX,n=t.zrY,i=da(this,e,n),r=this.Ho,o=r.target;o&&!o.__zr&&(o=(r=this.findHover(r.x,r.y)).target);var a=this.Ho=i?new aa(e,n):this.findHover(e,n),s=a.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),o&&s!==o&&this.dispatchToElement(r,"mouseout",t),this.dispatchToElement(a,"mousemove",t),s&&s!==o&&this.dispatchToElement(a,"mouseover",t)},e.prototype.mouseout=function(t){var e=t.zrEventControl;"only_globalout"!==e&&this.dispatchToElement(this.Ho,"mouseout",t),"no_globalout"!==e&&this.trigger("globalout",{type:"globalout",event:t})},e.prototype.resize=function(){this.Ho=new aa(0,0)},e.prototype.dispatch=function(t,e){var n=this[t];n&&n.call(this,e)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},e.prototype.dispatchToElement=function(t,e,n){var i=(t=t||{}).target;if(!i||!i.silent){for(var r="on"+e,o=function(t,e,n){return{type:t,event:n,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which,stop:ra}}(e,t,n);i&&(i[r]&&(o.cancelBubble=!!i[r].call(i,o)),i.trigger(e,o),i=i.__hostTarget?i.__hostTarget:i.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,o),t.trigger&&t.trigger(e,o)}))}},e.prototype.findHover=function(t,e,n){var i=this.storage.getDisplayList(),r=new aa(t,e);if(ua(i,r,t,e,n),this.Uo&&!r.target){for(var o=[],a=this.Uo,s=a/2,l=new Jo(t-s,e-s,a,a),c=i.length-1;c>=0;c--){var h=i[c];h===n||h.ignore||h.ignoreCoarsePointer||h.parent&&h.parent.ignoreCoarsePointer||(la.copy(h.getBoundingRect()),h.transform&&la.applyTransform(h.transform),la.intersect(l)&&o.push(h))}if(o.length)for(var u=Math.PI/12,d=2*Math.PI,f=0;f<s;f+=4)for(var p=0;p<d;p+=u)if(ua(o,r,t+f*Math.cos(p),e+f*Math.sin(p),n),r.target)return r}return r},e.prototype.processGesture=function(t,e){this.Wo||(this.Wo=new No);var n=this.Wo;"start"===e&&n.clear();var i=n.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if("end"===e&&n.clear(),i){var r=i.type;t.gestureEvent=r;var o=new aa;o.target=i.target,this.dispatchToElement(o,r,i.event)}},e}(ao);function ha(t,e,n){if(t[t.rectHover?"rectContain":"contain"](e,n)){for(var i=t,r=void 0,o=!1;i;){if(i.ignoreClip&&(o=!0),!o){var a=i.getClipPath();if(a&&!a.contain(e,n))return!1}i.silent&&(r=!0);var s=i.__hostTarget;i=s?i.ignoreHostSilent?null:s:i.parent}return!r||ia}return!1}function ua(t,e,n,i,r){for(var o=t.length-1;o>=0;o--){var a=t[o],s=void 0;if(a!==r&&!a.ignore&&(s=ha(a,n,i))&&(!e.topTarget&&(e.topTarget=a),s!==ia)){e.target=a;break}}}function da(t,e,n){var i=t.painter;return e<0||e>i.getWidth()||n<0||n>i.getHeight()}function fa(t,e,n,i){var r=e+1;if(r===n)return 1;if(i(t[r++],t[e])<0){for(;r<n&&i(t[r],t[r-1])<0;)r++;!function(t,e,n){for(n--;e<n;){var i=t[e];t[e++]=t[n],t[n--]=i}}(t,e,r)}else for(;r<n&&i(t[r],t[r-1])>=0;)r++;return r-e}function pa(t,e,n,i,r){for(i===e&&i++;i<n;i++){for(var o,a=t[i],s=e,l=i;s<l;)r(a,t[o=s+l>>>1])<0?l=o:s=o+1;var c=i-s;switch(c){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;c>0;)t[s+c]=t[s+c-1],c--}t[s]=a}}function ma(t,e,n,i,r,o){var a=0,s=0,l=1;if(o(t,e[n+r])>0){for(s=i-r;l<s&&o(t,e[n+r+l])>0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=r,l+=r}else{for(s=r+1;l<s&&o(t,e[n+r-l])<=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=a;a=r-l,l=r-c}for(a++;a<l;){var h=a+(l-a>>>1);o(t,e[n+h])>0?a=h+1:l=h}return l}function ga(t,e,n,i,r,o){var a=0,s=0,l=1;if(o(t,e[n+r])<0){for(s=r+1;l<s&&o(t,e[n+r-l])<0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=a;a=r-l,l=r-c}else{for(s=i-r;l<s&&o(t,e[n+r+l])>=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=r,l+=r}for(a++;a<l;){var h=a+(l-a>>>1);o(t,e[n+h])<0?l=h:a=h+1}return l}function va(t,e,n,i){n||(n=0),i||(i=t.length);var r=i-n;if(!(r<2)){var o=0;if(r<32)pa(t,n,i,n+(o=fa(t,n,i,e)),e);else{var a=function(t,e){var n,i,r=7,o=0,a=[];function s(s){var l=n[s],c=i[s],h=n[s+1],u=i[s+1];i[s]=c+u,s===o-3&&(n[s+1]=n[s+2],i[s+1]=i[s+2]),o--;var d=ga(t[h],t,l,c,0,e);l+=d,0!==(c-=d)&&0!==(u=ma(t[l+c-1],t,h,u,u-1,e))&&(c<=u?function(n,i,o,s){var l=0;for(l=0;l<i;l++)a[l]=t[n+l];var c=0,h=o,u=n;if(t[u++]=t[h++],0!==--s)if(1!==i){for(var d,f,p,m=r;;){d=0,f=0,p=!1;do{if(e(t[h],a[c])<0){if(t[u++]=t[h++],f++,d=0,0===--s){p=!0;break}}else if(t[u++]=a[c++],d++,f=0,1===--i){p=!0;break}}while((d|f)<m);if(p)break;do{if(0!==(d=ga(t[h],a,c,i,0,e))){for(l=0;l<d;l++)t[u+l]=a[c+l];if(u+=d,c+=d,(i-=d)<=1){p=!0;break}}if(t[u++]=t[h++],0===--s){p=!0;break}if(0!==(f=ma(a[c],t,h,s,0,e))){for(l=0;l<f;l++)t[u+l]=t[h+l];if(u+=f,h+=f,0===(s-=f)){p=!0;break}}if(t[u++]=a[c++],1===--i){p=!0;break}m--}while(d>=7||f>=7);if(p)break;m<0&&(m=0),m+=2}if((r=m)<1&&(r=1),1===i){for(l=0;l<s;l++)t[u+l]=t[h+l];t[u+s]=a[c]}else{if(0===i)throw new Error;for(l=0;l<i;l++)t[u+l]=a[c+l]}}else{for(l=0;l<s;l++)t[u+l]=t[h+l];t[u+s]=a[c]}else for(l=0;l<i;l++)t[u+l]=a[c+l]}(l,c,h,u):function(n,i,o,s){var l=0;for(l=0;l<s;l++)a[l]=t[o+l];var c=n+i-1,h=s-1,u=o+s-1,d=0,f=0;if(t[u--]=t[c--],0!==--i)if(1!==s){for(var p=r;;){var m=0,g=0,v=!1;do{if(e(a[h],t[c])<0){if(t[u--]=t[c--],m++,g=0,0===--i){v=!0;break}}else if(t[u--]=a[h--],g++,m=0,1===--s){v=!0;break}}while((m|g)<p);if(v)break;do{if(0!==(m=i-ga(a[h],t,n,i,i-1,e))){for(i-=m,f=1+(u-=m),d=1+(c-=m),l=m-1;l>=0;l--)t[f+l]=t[d+l];if(0===i){v=!0;break}}if(t[u--]=a[h--],1===--s){v=!0;break}if(0!==(g=s-ma(t[c],a,0,s,s-1,e))){for(s-=g,f=1+(u-=g),d=1+(h-=g),l=0;l<g;l++)t[f+l]=a[d+l];if(s<=1){v=!0;break}}if(t[u--]=t[c--],0===--i){v=!0;break}p--}while(m>=7||g>=7);if(v)break;p<0&&(p=0),p+=2}if((r=p)<1&&(r=1),1===s){for(f=1+(u-=i),d=1+(c-=i),l=i-1;l>=0;l--)t[f+l]=t[d+l];t[u]=a[h]}else{if(0===s)throw new Error;for(d=u-(s-1),l=0;l<s;l++)t[d+l]=a[l]}}else{for(f=1+(u-=i),d=1+(c-=i),l=i-1;l>=0;l--)t[f+l]=t[d+l];t[u]=a[h]}else for(d=u-(s-1),l=0;l<s;l++)t[d+l]=a[l]}(l,c,h,u))}return n=[],i=[],{mergeRuns:function(){for(;o>1;){var t=o-2;if(t>=1&&i[t-1]<=i[t]+i[t+1]||t>=2&&i[t-2]<=i[t]+i[t-1])i[t-1]<i[t+1]&&t--;else if(i[t]>i[t+1])break;s(t)}},forceMergeRuns:function(){for(;o>1;){var t=o-2;t>0&&i[t-1]<i[t+1]&&t--,s(t)}},pushRun:function(t,e){n[o]=t,i[o]=e,o+=1}}}(t,e),s=function(t){for(var e=0;t>=32;)e|=1&t,t>>=1;return t+e}(r);do{if((o=fa(t,n,i,e))<s){var l=r;l>s&&(l=s),pa(t,n,n+l,n+o,e),o=l}a.pushRun(n,o),a.mergeRuns(),r-=o,n+=o}while(0!==r);a.forceMergeRuns()}}}sr(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){ca.prototype[t]=function(e){var n,i,r=e.zrX,o=e.zrY,a=da(this,r,o);if("mouseup"===t&&a||(i=(n=this.findHover(r,o)).target),"mousedown"===t)this.jo=i,this.qo=[e.zrX,e.zrY],this.Go=i;else if("mouseup"===t)this.Go=i;else if("click"===t){if(this.jo!==this.Go||!this.qo||Jr(this.qo,[e.zrX,e.zrY])>4)return;this.qo=null}this.dispatchToElement(n,t,e)}});var ya=!1;function ba(){ya||(ya=!0)}function xa(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}var wa,Sa=function(){function t(){this.Xo=[],this.Yo=[],this.Jo=0,this.displayableSortFunc=xa}return t.prototype.traverse=function(t,e){for(var n=0;n<this.Xo.length;n++)this.Xo[n].traverse(t,e)},t.prototype.getDisplayList=function(t,e){e=e||!1;var n=this.Yo;return!t&&n.length||this.updateDisplayList(e),n},t.prototype.updateDisplayList=function(t){this.Jo=0;for(var e=this.Xo,n=this.Yo,i=0,r=e.length;i<r;i++)this.Zo(e[i],null,t);n.length=this.Jo,va(n,xa)},t.prototype.Zo=function(t,e,n){if(!t.ignore||n){t.beforeUpdate(),t.update(),t.afterUpdate();var i=t.getClipPath(),r=e&&e.length,o=0,a=t.__clipPaths;if(!t.ignoreClip&&(r||i)){if(a||(a=t.__clipPaths=[]),r)for(var s=0;s<e.length;s++)a[o++]=e[s];for(var l=i,c=t;l;)l.parent=c,l.updateTransform(),a[o++]=l,c=l,l=l.getClipPath()}if(a&&(a.length=o),t.childrenRef){for(var h=t.childrenRef(),u=0;u<h.length;u++){var d=h[u];t.__dirty&&(d.__dirty|=1),this.Zo(d,a,n)}t.__dirty=0}else{var f=t;isNaN(f.z)&&(ba(),f.z=0),isNaN(f.z2)&&(ba(),f.z2=0),isNaN(f.zlevel)&&(ba(),f.zlevel=0),this.Yo[this.Jo++]=f}var p=t.getDecalElement&&t.getDecalElement();p&&this.Zo(p,a,n);var m=t.getTextGuideLine();m&&this.Zo(m,a,n);var g=t.getTextContent();g&&this.Zo(g,a,n)}},t.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this.Xo.push(t)},t.prototype.delRoot=function(t){if(t instanceof Array)for(var e=0,n=t.length;e<n;e++)this.delRoot(t[e]);else{var i=rr(this.Xo,t);i>=0&&this.Xo.splice(i,1)}},t.prototype.delAllRoots=function(){this.Xo=[],this.Yo=[],this.Jo=0},t.prototype.getRoots=function(){return this.Xo},t.prototype.dispose=function(){this.Yo=null,this.Xo=null},t}();wa=Li.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){return setTimeout(t,16)};var Ca={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,n=.1;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=.1):e=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=.1):e=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=.1):e=.4*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-Ca.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*Ca.bounceIn(2*t):.5*Ca.bounceOut(2*t-1)+.5}},Ta=Math.pow,$a=Math.sqrt,Ma=1e-4,Aa=$a(3),Na=1/3,ka=Wr(),Ra=Wr(),_a=Wr();function Ia(t){return t>-1e-8&&t<1e-8}function Fa(t){return t>1e-8||t<-1e-8}function Ea(t,e,n,i,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*i+3*o*n)}function Da(t,e,n,i,r){var o=1-r;return 3*(((e-t)*o+2*(n-e)*r)*o+(i-n)*r*r)}function La(t,e,n,i,r,o){var a=i+3*(e-n)-t,s=3*(n-2*e+t),l=3*(e-t),c=t-r,h=s*s-3*a*l,u=s*l-9*a*c,d=l*l-3*s*c,f=0;if(Ia(h)&&Ia(u))Ia(s)?o[0]=0:(T=-l/s)>=0&&T<=1&&(o[f++]=T);else{var p=u*u-4*h*d;if(Ia(p)){var m=u/h,g=-m/2;(T=-s/a+m)>=0&&T<=1&&(o[f++]=T),g>=0&&g<=1&&(o[f++]=g)}else if(p>0){var v=$a(p),y=h*s+1.5*a*(-u+v),b=h*s+1.5*a*(-u-v);(T=(-s-((y=y<0?-Ta(-y,Na):Ta(y,Na))+(b=b<0?-Ta(-b,Na):Ta(b,Na))))/(3*a))>=0&&T<=1&&(o[f++]=T)}else{var x=(2*h*s-3*a*u)/(2*$a(h*h*h)),w=Math.acos(x)/3,S=$a(h),C=Math.cos(w),T=(-s-2*S*C)/(3*a),$=(g=(-s+S*(C+Aa*Math.sin(w)))/(3*a),(-s+S*(C-Aa*Math.sin(w)))/(3*a));T>=0&&T<=1&&(o[f++]=T),g>=0&&g<=1&&(o[f++]=g),$>=0&&$<=1&&(o[f++]=$)}}return f}function Pa(t,e,n,i,r){var o=6*n-12*e+6*t,a=9*e+3*i-3*t-9*n,s=3*e-3*t,l=0;if(Ia(a))Fa(o)&&(h=-s/o)>=0&&h<=1&&(r[l++]=h);else{var c=o*o-4*a*s;if(Ia(c))r[0]=-o/(2*a);else if(c>0){var h,u=$a(c),d=(-o-u)/(2*a);(h=(-o+u)/(2*a))>=0&&h<=1&&(r[l++]=h),d>=0&&d<=1&&(r[l++]=d)}}return l}function za(t,e,n,i,r,o){var a=(e-t)*r+t,s=(n-e)*r+e,l=(i-n)*r+n,c=(s-a)*r+a,h=(l-s)*r+s,u=(h-c)*r+c;o[0]=t,o[1]=a,o[2]=c,o[3]=u,o[4]=u,o[5]=h,o[6]=l,o[7]=i}function Oa(t,e,n,i,r,o,a,s,l){for(var c=t,h=e,u=0,d=1/l,f=1;f<=l;f++){var p=f*d,m=Ea(t,n,r,a,p),g=Ea(e,i,o,s,p),v=m-c,y=g-h;u+=Math.sqrt(v*v+y*y),c=m,h=g}return u}function Ba(t,e,n,i){var r=1-i;return r*(r*t+2*i*e)+i*i*n}function Va(t,e,n,i){return 2*((1-i)*(e-t)+i*(n-e))}function Ha(t,e,n){var i=t+n-2*e;return 0===i?.5:(t-e)/i}function Ua(t,e,n,i,r){var o=(e-t)*i+t,a=(n-e)*i+e,s=(a-o)*i+o;r[0]=t,r[1]=o,r[2]=s,r[3]=s,r[4]=a,r[5]=n}function qa(t,e,n,i,r,o,a){for(var s=t,l=e,c=0,h=1/a,u=1;u<=a;u++){var d=u*h,f=Ba(t,n,r,d),p=Ba(e,i,o,d),m=f-s,g=p-l;c+=Math.sqrt(m*m+g*g),s=f,l=p}return c}var Ka=/cubic-bezier\(([0-9,\.e ]+)\)/;function Wa(t){var e=t&&Ka.exec(t);if(e){var n=e[1].split(","),i=+Ir(n[0]),r=+Ir(n[1]),o=+Ir(n[2]),a=+Ir(n[3]);if(isNaN(i+r+o+a))return;var s=[];return function(t){return t<=0?0:t>=1?1:La(0,i,o,1,t,s)&&Ea(0,r,a,1,s[0])}}}var ja=function(){function t(t){this.Qo=!1,this.ta=0,this.ea=0,this.na=!1,this.ia=t.life||1e3,this.ra=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||qr,this.ondestroy=t.ondestroy||qr,this.onrestart=t.onrestart||qr,t.easing&&this.setEasing(t.easing)}return t.prototype.step=function(t,e){if(this.Qo||(this.ta=t+this.ra,this.Qo=!0),!this.na){var n=this.ia,i=t-this.ta-this.ea,r=i/n;r<0&&(r=0),r=Math.min(r,1);var o=this.easingFunc,a=o?o(r):r;if(this.onframe(a),1===r){if(!this.loop)return!0;var s=i%n;this.ta=t-s,this.ea=0,this.onrestart()}return!1}this.ea+=e},t.prototype.pause=function(){this.na=!0},t.prototype.resume=function(){this.na=!1},t.prototype.setEasing=function(t){this.easing=t,this.easingFunc=gr(t)?t:Ca[t]||Wa(t)},t}(),Ga=function(t){this.value=t},Xa=function(){function t(){this.sa=0}return t.prototype.insert=function(t){var e=new Ga(t);return this.insertEntry(e),e},t.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this.sa++},t.prototype.remove=function(t){var e=t.prev,n=t.next;e?e.next=n:this.head=n,n?n.prev=e:this.tail=e,t.next=t.prev=null,this.sa--},t.prototype.len=function(){return this.sa},t.prototype.clear=function(){this.head=this.tail=null,this.sa=0},t}(),Ya=function(){function t(t){this.Kn=new Xa,this.oa=10,this.aa={},this.oa=t}return t.prototype.put=function(t,e){var n=this.Kn,i=this.aa,r=null;if(null==i[t]){var o=n.len(),a=this.la;if(o>=this.oa&&o>0){var s=n.head;n.remove(s),delete i[s.key],r=s.value,this.la=s}a?a.value=e:a=new Ga(e),a.key=t,n.insertEntry(a),i[t]=a}return r},t.prototype.get=function(t){var e=this.aa[t],n=this.Kn;if(null!=e)return e!==n.tail&&(n.remove(e),n.insertEntry(e)),e.value},t.prototype.clear=function(){this.Kn.clear(),this.aa={}},t.prototype.len=function(){return this.Kn.len()},t}(),Za={"transparent":[0,0,0,0],"aliceblue":[240,248,255,1],"antiquewhite":[250,235,215,1],"aqua":[0,255,255,1],"aquamarine":[127,255,212,1],"azure":[240,255,255,1],"beige":[245,245,220,1],"bisque":[255,228,196,1],"black":[0,0,0,1],"blanchedalmond":[255,235,205,1],"blue":[0,0,255,1],"blueviolet":[138,43,226,1],"brown":[165,42,42,1],"burlywood":[222,184,135,1],"cadetblue":[95,158,160,1],"chartreuse":[127,255,0,1],"chocolate":[210,105,30,1],"coral":[255,127,80,1],"cornflowerblue":[100,149,237,1],"cornsilk":[255,248,220,1],"crimson":[220,20,60,1],"cyan":[0,255,255,1],"darkblue":[0,0,139,1],"darkcyan":[0,139,139,1],"darkgoldenrod":[184,134,11,1],"darkgray":[169,169,169,1],"darkgreen":[0,100,0,1],"darkgrey":[169,169,169,1],"darkkhaki":[189,183,107,1],"darkmagenta":[139,0,139,1],"darkolivegreen":[85,107,47,1],"darkorange":[255,140,0,1],"darkorchid":[153,50,204,1],"darkred":[139,0,0,1],"darksalmon":[233,150,122,1],"darkseagreen":[143,188,143,1],"darkslateblue":[72,61,139,1],"darkslategray":[47,79,79,1],"darkslategrey":[47,79,79,1],"darkturquoise":[0,206,209,1],"darkviolet":[148,0,211,1],"deeppink":[255,20,147,1],"deepskyblue":[0,191,255,1],"dimgray":[105,105,105,1],"dimgrey":[105,105,105,1],"dodgerblue":[30,144,255,1],"firebrick":[178,34,34,1],"floralwhite":[255,250,240,1],"forestgreen":[34,139,34,1],"fuchsia":[255,0,255,1],"gainsboro":[220,220,220,1],"ghostwhite":[248,248,255,1],"gold":[255,215,0,1],"goldenrod":[218,165,32,1],"gray":[128,128,128,1],"green":[0,128,0,1],"greenyellow":[173,255,47,1],"grey":[128,128,128,1],"honeydew":[240,255,240,1],"hotpink":[255,105,180,1],"indianred":[205,92,92,1],"indigo":[75,0,130,1],"ivory":[255,255,240,1],"khaki":[240,230,140,1],"lavender":[230,230,250,1],"lavenderblush":[255,240,245,1],"lawngreen":[124,252,0,1],"lemonchiffon":[255,250,205,1],"lightblue":[173,216,230,1],"lightcoral":[240,128,128,1],"lightcyan":[224,255,255,1],"lightgoldenrodyellow":[250,250,210,1],"lightgray":[211,211,211,1],"lightgreen":[144,238,144,1],"lightgrey":[211,211,211,1],"lightpink":[255,182,193,1],"lightsalmon":[255,160,122,1],"lightseagreen":[32,178,170,1],"lightskyblue":[135,206,250,1],"lightslategray":[119,136,153,1],"lightslategrey":[119,136,153,1],"lightsteelblue":[176,196,222,1],"lightyellow":[255,255,224,1],"lime":[0,255,0,1],"limegreen":[50,205,50,1],"linen":[250,240,230,1],"magenta":[255,0,255,1],"maroon":[128,0,0,1],"mediumaquamarine":[102,205,170,1],"mediumblue":[0,0,205,1],"mediumorchid":[186,85,211,1],"mediumpurple":[147,112,219,1],"mediumseagreen":[60,179,113,1],"mediumslateblue":[123,104,238,1],"mediumspringgreen":[0,250,154,1],"mediumturquoise":[72,209,204,1],"mediumvioletred":[199,21,133,1],"midnightblue":[25,25,112,1],"mintcream":[245,255,250,1],"mistyrose":[255,228,225,1],"moccasin":[255,228,181,1],"navajowhite":[255,222,173,1],"navy":[0,0,128,1],"oldlace":[253,245,230,1],"olive":[128,128,0,1],"olivedrab":[107,142,35,1],"orange":[255,165,0,1],"orangered":[255,69,0,1],"orchid":[218,112,214,1],"palegoldenrod":[238,232,170,1],"palegreen":[152,251,152,1],"paleturquoise":[175,238,238,1],"palevioletred":[219,112,147,1],"papayawhip":[255,239,213,1],"peachpuff":[255,218,185,1],"peru":[205,133,63,1],"pink":[255,192,203,1],"plum":[221,160,221,1],"powderblue":[176,224,230,1],"purple":[128,0,128,1],"red":[255,0,0,1],"rosybrown":[188,143,143,1],"royalblue":[65,105,225,1],"saddlebrown":[139,69,19,1],"salmon":[250,128,114,1],"sandybrown":[244,164,96,1],"seagreen":[46,139,87,1],"seashell":[255,245,238,1],"sienna":[160,82,45,1],"silver":[192,192,192,1],"skyblue":[135,206,235,1],"slateblue":[106,90,205,1],"slategray":[112,128,144,1],"slategrey":[112,128,144,1],"snow":[255,250,250,1],"springgreen":[0,255,127,1],"steelblue":[70,130,180,1],"tan":[210,180,140,1],"teal":[0,128,128,1],"thistle":[216,191,216,1],"tomato":[255,99,71,1],"turquoise":[64,224,208,1],"violet":[238,130,238,1],"wheat":[245,222,179,1],"white":[255,255,255,1],"whitesmoke":[245,245,245,1],"yellow":[255,255,0,1],"yellowgreen":[154,205,50,1]};function Ja(t){return(t=Math.round(t))<0?0:t>255?255:t}function Qa(t){return t<0?0:t>1?1:t}function ts(t){var e=t;return e.length&&"%"===e.charAt(e.length-1)?Ja(parseFloat(e)/100*255):Ja(parseInt(e,10))}function es(t){var e=t;return e.length&&"%"===e.charAt(e.length-1)?Qa(parseFloat(e)/100):Qa(parseFloat(e))}function ns(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function is(t,e,n){return t+(e-t)*n}function rs(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function os(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var as=new Ya(20),ss=null;function ls(t,e){ss&&os(ss,e),ss=as.put(t,ss||e.slice())}function cs(t,e){if(t){e=e||[];var n=as.get(t);if(n)return os(e,n);var i=(t+="").replace(/ /g,"").toLowerCase();if(i in Za)return os(e,Za[i]),ls(t,e),e;var r,o=i.length;if("#"===i.charAt(0))return 4===o||5===o?(r=parseInt(i.slice(1,4),16))>=0&&r<=4095?(rs(e,(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,5===o?parseInt(i.slice(4),16)/15:1),ls(t,e),e):void rs(e,0,0,0,1):7===o||9===o?(r=parseInt(i.slice(1,7),16))>=0&&r<=16777215?(rs(e,(16711680&r)>>16,(65280&r)>>8,255&r,9===o?parseInt(i.slice(7),16)/255:1),ls(t,e),e):void rs(e,0,0,0,1):void 0;var a=i.indexOf("("),s=i.indexOf(")");if(-1!==a&&s+1===o){var l=i.substr(0,a),c=i.substr(a+1,s-(a+1)).split(","),h=1;switch(l){case"rgba":if(4!==c.length)return 3===c.length?rs(e,+c[0],+c[1],+c[2],1):rs(e,0,0,0,1);h=es(c.pop());case"rgb":return c.length>=3?(rs(e,ts(c[0]),ts(c[1]),ts(c[2]),3===c.length?h:es(c[3])),ls(t,e),e):void rs(e,0,0,0,1);case"hsla":return 4!==c.length?void rs(e,0,0,0,1):(c[3]=es(c[3]),hs(c,e),ls(t,e),e);case"hsl":return 3!==c.length?void rs(e,0,0,0,1):(hs(c,e),ls(t,e),e);default:return}}rs(e,0,0,0,1)}}function hs(t,e){var n=(parseFloat(t[0])%360+360)%360/360,i=es(t[1]),r=es(t[2]),o=r<=.5?r*(i+1):r+i-r*i,a=2*r-o;return rs(e=e||[],Ja(255*ns(a,o,n+1/3)),Ja(255*ns(a,o,n)),Ja(255*ns(a,o,n-1/3)),1),4===t.length&&(e[3]=t[3]),e}function us(t,e){var n=cs(t);if(n){for(var i=0;i<3;i++)n[i]=e<0?n[i]*(1-e)|0:(255-n[i])*e+n[i]|0,n[i]>255?n[i]=255:n[i]<0&&(n[i]=0);return ms(n,4===n.length?"rgba":"rgb")}}function ds(t,e,n){if(e&&e.length&&t>=0&&t<=1){n=n||[];var i=t*(e.length-1),r=Math.floor(i),o=Math.ceil(i),a=e[r],s=e[o],l=i-r;return n[0]=Ja(is(a[0],s[0],l)),n[1]=Ja(is(a[1],s[1],l)),n[2]=Ja(is(a[2],s[2],l)),n[3]=Qa(is(a[3],s[3],l)),n}}function fs(t,e,n,i){var r,o=cs(t);if(t)return o=function(t){if(t){var e,n,i=t[0]/255,r=t[1]/255,o=t[2]/255,a=Math.min(i,r,o),s=Math.max(i,r,o),l=s-a,c=(s+a)/2;if(0===l)e=0,n=0;else{n=c<.5?l/(s+a):l/(2-s-a);var h=((s-i)/6+l/2)/l,u=((s-r)/6+l/2)/l,d=((s-o)/6+l/2)/l;i===s?e=d-u:r===s?e=1/3+h-d:o===s&&(e=2/3+u-h),e<0&&(e+=1),e>1&&(e-=1)}var f=[360*e,n,c];return null!=t[3]&&f.push(t[3]),f}}(o),null!=e&&(o[0]=(r=gr(e)?e(o[0]):e,(r=Math.round(r))<0?0:r>360?360:r)),null!=n&&(o[1]=es(gr(n)?n(o[1]):n)),null!=i&&(o[2]=es(gr(i)?i(o[2]):i)),ms(hs(o),"rgba")}function ps(t,e){var n=cs(t);if(n&&null!=e)return n[3]=Qa(e),ms(n,"rgba")}function ms(t,e){if(t&&t.length){var n=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(n+=","+t[3]),e+"("+n+")"}}function gs(t,e){var n=cs(t);return n?(.299*n[0]+.587*n[1]+.114*n[2])*n[3]/255+(1-n[3])*e:0}var vs=new Ya(100);function ys(t){if(vr(t)){var e=vs.get(t);return e||(e=us(t,-.1),vs.put(t,e)),e}if(Tr(t)){var n=nr({},t);return n.colorStops=lr(t.colorStops,function(t){return{offset:t.offset,color:us(t.color,-.1)}}),n}return t}Li.hasGlobalWindow&&gr(window.btoa);var bs=Array.prototype.slice;function xs(t,e,n){return(e-t)*n+t}function ws(t,e,n,i){for(var r=e.length,o=0;o<r;o++)t[o]=xs(e[o],n[o],i);return t}function Ss(t,e,n,i){for(var r=e.length,o=0;o<r;o++)t[o]=e[o]+n[o]*i;return t}function Cs(t,e,n,i){for(var r=e.length,o=r&&e[0].length,a=0;a<r;a++){t[a]||(t[a]=[]);for(var s=0;s<o;s++)t[a][s]=e[a][s]+n[a][s]*i}return t}function Ts(t,e){for(var n=t.length,i=e.length,r=n>i?e:t,o=Math.min(n,i),a=r[o-1]||{color:[0,0,0,0],offset:0},s=o;s<Math.max(n,i);s++)r.push({offset:a.offset,color:a.color.slice()})}function $s(t,e,n){var i=t,r=e;if(i.push&&r.push){var o=i.length,a=r.length;if(o!==a)if(o>a)i.length=a;else for(var s=o;s<a;s++)i.push(1===n?r[s]:bs.call(r[s]));var l=i[0]&&i[0].length;for(s=0;s<i.length;s++)if(1===n)isNaN(i[s])&&(i[s]=r[s]);else for(var c=0;c<l;c++)isNaN(i[s][c])&&(i[s][c]=r[s][c])}}function Ms(t){if(ar(t)){var e=t.length;if(ar(t[0])){for(var n=[],i=0;i<e;i++)n.push(bs.call(t[i]));return n}return bs.call(t)}return t}function As(t){return t[0]=Math.floor(t[0])||0,t[1]=Math.floor(t[1])||0,t[2]=Math.floor(t[2])||0,t[3]=null==t[3]?1:t[3],"rgba("+t.join(",")+")"}function Ns(t){return 4===t||5===t}function ks(t){return 1===t||2===t}var Rs=[0,0,0,0],_s=function(){function t(t){this.keyframes=[],this.discrete=!1,this.ca=!1,this.ha=!1,this.ua=0,this.fa=0,this.propName=t}return t.prototype.isFinished=function(){return this.da},t.prototype.setFinished=function(){this.da=!0,this.ma&&this.ma.setFinished()},t.prototype.needsAnimate=function(){return this.keyframes.length>=1},t.prototype.getAdditiveTrack=function(){return this.ma},t.prototype.addKeyframe=function(t,e,n){this.ha=!0;var i=this.keyframes,r=i.length,o=!1,a=6,s=e;if(ar(e)){var l=function(t){return ar(t&&t[0])?2:1}(e);a=l,(1===l&&!br(e[0])||2===l&&!br(e[0][0]))&&(o=!0)}else if(br(e)&&!$r(e))a=0;else if(vr(e))if(isNaN(+e)){var c=cs(e);c&&(s=c,a=3)}else a=0;else if(Tr(e)){var h=nr({},s);h.colorStops=lr(e.colorStops,function(t){return{offset:t.offset,color:cs(t.color)}}),"linear"===e.type?a=4:"radial"===e.type&&(a=5),s=h}0===r?this.valType=a:a===this.valType&&6!==a||(o=!0),this.discrete=this.discrete||o;var u={time:t,value:s,rawValue:e,percent:0};return n&&(u.easing=n,u.easingFunc=gr(n)?n:Ca[n]||Wa(n)),i.push(u),u},t.prototype.prepare=function(t,e){var n=this.keyframes;this.ha&&n.sort(function(t,e){return t.time-e.time});for(var i=this.valType,r=n.length,o=n[r-1],a=this.discrete,s=ks(i),l=Ns(i),c=0;c<r;c++){var h=n[c],u=h.value,d=o.value;h.percent=h.time/t,a||(s&&c!==r-1?$s(u,d,i):l&&Ts(u.colorStops,d.colorStops))}if(!a&&5!==i&&e&&this.needsAnimate()&&e.needsAnimate()&&i===e.valType&&!e.da){this.ma=e;var f=n[0].value;for(c=0;c<r;c++)0===i?n[c].additiveValue=n[c].value-f:3===i?n[c].additiveValue=Ss([],n[c].value,f,-1):ks(i)&&(n[c].additiveValue=1===i?Ss([],n[c].value,f,-1):Cs([],n[c].value,f,-1))}},t.prototype.step=function(t,e){if(!this.da){this.ma&&this.ma.da&&(this.ma=null);var n,i,r,o=null!=this.ma,a=o?"additiveValue":"value",s=this.valType,l=this.keyframes,c=l.length,h=this.propName,u=3===s,d=this.ua,f=Math.min;if(1===c)i=r=l[0];else{if(e<0)n=0;else if(e<this.fa){for(n=f(d+1,c-1);n>=0&&!(l[n].percent<=e);n--);n=f(n,c-2)}else{for(n=d;n<c&&!(l[n].percent>e);n++);n=f(n-1,c-2)}r=l[n+1],i=l[n]}if(i&&r){this.ua=n,this.fa=e;var p=r.percent-i.percent,m=0===p?1:f((e-i.percent)/p,1);r.easingFunc&&(m=r.easingFunc(m));var g=o?this.pa:u?Rs:t[h];if(!ks(s)&&!u||g||(g=this.pa=[]),this.discrete)t[h]=m<1?i.rawValue:r.rawValue;else if(ks(s))1===s?ws(g,i[a],r[a],m):function(t,e,n,i){for(var r=e.length,o=r&&e[0].length,a=0;a<r;a++){t[a]||(t[a]=[]);for(var s=0;s<o;s++)t[a][s]=xs(e[a][s],n[a][s],i)}}(g,i[a],r[a],m);else if(Ns(s)){var v=i[a],y=r[a],b=4===s;t[h]={type:b?"linear":"radial",x:xs(v.x,y.x,m),y:xs(v.y,y.y,m),colorStops:lr(v.colorStops,function(t,e){var n=y.colorStops[e];return{offset:xs(t.offset,n.offset,m),color:As(ws([],t.color,n.color,m))}}),global:y.global},b?(t[h].x2=xs(v.x2,y.x2,m),t[h].y2=xs(v.y2,y.y2,m)):t[h].r=xs(v.r,y.r,m)}else if(u)ws(g,i[a],r[a],m),o||(t[h]=As(g));else{var x=xs(i[a],r[a],m);o?this.pa=x:t[h]=x}o&&this.va(t)}}},t.prototype.va=function(t){var e=this.valType,n=this.propName,i=this.pa;0===e?t[n]=t[n]+i:3===e?(cs(t[n],Rs),Ss(Rs,Rs,i,1),t[n]=As(Rs)):1===e?Ss(t[n],t[n],i,1):2===e&&Cs(t[n],t[n],i,1)},t}(),Is=function(){function t(t,e,n,i){this.ba={},this.ga=[],this.ya=0,this.wa=0,this.xa=null,this.$a=t,this.Ma=e,e&&i?Qi("Can' use additive animation on looped animation."):(this.Ca=i,this.Sa=n)}return t.prototype.getMaxTime=function(){return this.ya},t.prototype.getDelay=function(){return this.ra},t.prototype.getLoop=function(){return this.Ma},t.prototype.getTarget=function(){return this.$a},t.prototype.changeTarget=function(t){this.$a=t},t.prototype.when=function(t,e,n){return this.whenWithKeys(t,e,dr(e),n)},t.prototype.whenWithKeys=function(t,e,n,i){for(var r=this.ba,o=0;o<n.length;o++){var a=n[o],s=r[a];if(!s){s=r[a]=new _s(a);var l=void 0,c=this.Ra(a);if(c){var h=c.keyframes,u=h[h.length-1];l=u&&u.value,3===c.valType&&l&&(l=As(l))}else l=this.$a[a];if(null==l)continue;t>0&&s.addKeyframe(0,Ms(l),i),this.ga.push(a)}s.addKeyframe(t,Ms(e[a]),i)}return this.ya=Math.max(this.ya,t),this},t.prototype.pause=function(){this.xa.pause(),this.na=!0},t.prototype.resume=function(){this.xa.resume(),this.na=!1},t.prototype.isPaused=function(){return!!this.na},t.prototype.duration=function(t){return this.ya=t,this.Aa=!0,this},t.prototype.ka=function(){this.Ta(),this.xa=null;var t=this.Na;if(t)for(var e=t.length,n=0;n<e;n++)t[n].call(this)},t.prototype.Fa=function(){this.Ta();var t=this.animation,e=this._a;if(t&&t.removeClip(this.xa),this.xa=null,e)for(var n=0;n<e.length;n++)e[n].call(this)},t.prototype.Ta=function(){for(var t=this.ba,e=this.ga,n=0;n<e.length;n++)t[e[n]].setFinished()},t.prototype.Ra=function(t){var e,n=this.Ca;if(n)for(var i=0;i<n.length;i++){var r=n[i].getTrack(t);r&&(e=r)}return e},t.prototype.start=function(t){if(!(this.wa>0)){this.wa=1;for(var e=this,n=[],i=this.ya||0,r=0;r<this.ga.length;r++){var o=this.ga[r],a=this.ba[o],s=this.Ra(o),l=a.keyframes,c=l.length;if(a.prepare(i,s),a.needsAnimate())if(!this.Sa&&a.discrete){var h=l[c-1];h&&(e.$a[a.propName]=h.rawValue),a.setFinished()}else n.push(a)}if(n.length||this.Aa){var u=new ja({life:i,loop:this.Ma,delay:this.ra||0,onframe:function(t){e.wa=2;var i=e.Ca;if(i){for(var r=!1,o=0;o<i.length;o++)if(i[o].xa){r=!0;break}r||(e.Ca=null)}for(o=0;o<n.length;o++)n[o].step(e.$a,t);var a=e.Ea;if(a)for(o=0;o<a.length;o++)a[o](e.$a,t)},ondestroy:function(){e.ka()}});this.xa=u,this.animation&&this.animation.addClip(u),t&&u.setEasing(t)}else this.ka();return this}},t.prototype.stop=function(t){if(this.xa){var e=this.xa;t&&e.onframe(1),this.Fa()}},t.prototype.delay=function(t){return this.ra=t,this},t.prototype.during=function(t){return t&&(this.Ea||(this.Ea=[]),this.Ea.push(t)),this},t.prototype.done=function(t){return t&&(this.Na||(this.Na=[]),this.Na.push(t)),this},t.prototype.aborted=function(t){return t&&(this._a||(this._a=[]),this._a.push(t)),this},t.prototype.getClip=function(){return this.xa},t.prototype.getTrack=function(t){return this.ba[t]},t.prototype.getTracks=function(){var t=this;return lr(this.ga,function(e){return t.ba[e]})},t.prototype.stopTracks=function(t,e){if(!t.length||!this.xa)return!0;for(var n=this.ba,i=this.ga,r=0;r<t.length;r++){var o=n[t[r]];o&&!o.isFinished()&&(e?o.step(this.$a,1):1===this.wa&&o.step(this.$a,0),o.setFinished())}var a=!0;for(r=0;r<i.length;r++)if(!n[i[r]].isFinished()){a=!1;break}return a&&this.Fa(),a},t.prototype.saveTo=function(t,e,n){if(t){e=e||this.ga;for(var i=0;i<e.length;i++){var r=e[i],o=this.ba[r];if(o&&!o.isFinished()){var a=o.keyframes,s=a[n?0:a.length-1];s&&(t[r]=Ms(s.rawValue))}}}},t.prototype.__changeFinalValue=function(t,e){e=e||dr(t);for(var n=0;n<e.length;n++){var i=e[n],r=this.ba[i];if(r){var o=r.keyframes;if(o.length>1){var a=o.pop();r.addKeyframe(a.time,t[i]),r.prepare(this.ya,r.getAdditiveTrack())}}}},t}();function Fs(){return(new Date).getTime()}var Es=function(t){function e(e){var n=t.call(this)||this;return n.Ia=!1,n.za=0,n.ea=0,n.Da=0,n.na=!1,e=e||{},n.stage=e.stage||{},n}return Ei(e,t),e.prototype.addClip=function(t){t.animation&&this.removeClip(t),this.La?(this.Oa.next=t,t.prev=this.Oa,t.next=null,this.Oa=t):this.La=this.Oa=t,t.animation=this},e.prototype.addAnimator=function(t){t.animation=this;var e=t.getClip();e&&this.addClip(e)},e.prototype.removeClip=function(t){if(t.animation){var e=t.prev,n=t.next;e?e.next=n:this.La=n,n?n.prev=e:this.Oa=e,t.next=t.prev=t.animation=null}},e.prototype.removeAnimator=function(t){var e=t.getClip();e&&this.removeClip(e),t.animation=null},e.prototype.update=function(t){for(var e=Fs()-this.ea,n=e-this.za,i=this.La;i;){var r=i.next;i.step(e,n)?(i.ondestroy(),this.removeClip(i),i=r):i=r}this.za=e,t||(this.trigger("frame",n),this.stage.update&&this.stage.update())},e.prototype.Pa=function(){var t=this;this.Ia=!0,wa(function e(){t.Ia&&(wa(e),!t.na&&t.update())})},e.prototype.start=function(){this.Ia||(this.za=Fs(),this.ea=0,this.Pa())},e.prototype.stop=function(){this.Ia=!1},e.prototype.pause=function(){this.na||(this.Da=Fs(),this.na=!0)},e.prototype.resume=function(){this.na&&(this.ea+=Fs()-this.Da,this.na=!1)},e.prototype.clear=function(){for(var t=this.La;t;){var e=t.next;t.prev=t.next=t.animation=null,t=e}this.La=this.Oa=null},e.prototype.isFinished=function(){return null==this.La},e.prototype.animate=function(t,e){e=e||{},this.start();var n=new Is(t,e.loop);return this.addAnimator(n),n},e}(ao),Ds=Li.domSupported,Ls=function(){var t=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],e={pointerdown:1,pointerup:1,pointermove:1,pointerout:1};return{mouse:t,touch:["touchstart","touchend","touchmove"],pointer:lr(t,function(t){var n=t.replace("mouse","pointer");return e.hasOwnProperty(n)?n:t})}}(),Ps=["mousemove","mouseup"],zs=["pointermove","pointerup"],Os=!1;function Bs(t){var e=t.pointerType;return"pen"===e||"touch"===e}function Vs(t){t&&(t.zrByTouch=!0)}function Hs(t,e){for(var n=e,i=!1;n&&9!==n.nodeType&&!(i=n.domBelongToZr||n!==e&&n===t.painterRoot);)n=n.parentNode;return i}var Us=function(t,e){this.stopPropagation=qr,this.stopImmediatePropagation=qr,this.preventDefault=qr,this.type=e.type,this.target=this.currentTarget=t.dom,this.pointerType=e.pointerType,this.clientX=e.clientX,this.clientY=e.clientY},qs={mousedown:function(t){t=To(this.dom,t),this.__mayPointerCapture=[t.zrX,t.zrY],this.trigger("mousedown",t)},mousemove:function(t){t=To(this.dom,t);var e=this.__mayPointerCapture;!e||t.zrX===e[0]&&t.zrY===e[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",t)},mouseup:function(t){t=To(this.dom,t),this.__togglePointerCapture(!1),this.trigger("mouseup",t)},mouseout:function(t){Hs(this,(t=To(this.dom,t)).toElement||t.relatedTarget)||(this.__pointerCapturing&&(t.zrEventControl="no_globalout"),this.trigger("mouseout",t))},wheel:function(t){Os=!0,t=To(this.dom,t),this.trigger("mousewheel",t)},mousewheel:function(t){Os||(t=To(this.dom,t),this.trigger("mousewheel",t))},touchstart:function(t){Vs(t=To(this.dom,t)),this.__lastTouchMoment=new Date,this.handler.processGesture(t,"start"),qs.mousemove.call(this,t),qs.mousedown.call(this,t)},touchmove:function(t){Vs(t=To(this.dom,t)),this.handler.processGesture(t,"change"),qs.mousemove.call(this,t)},touchend:function(t){Vs(t=To(this.dom,t)),this.handler.processGesture(t,"end"),qs.mouseup.call(this,t),+new Date-+this.__lastTouchMoment<300&&qs.click.call(this,t)},pointerdown:function(t){qs.mousedown.call(this,t)},pointermove:function(t){Bs(t)||qs.mousemove.call(this,t)},pointerup:function(t){qs.mouseup.call(this,t)},pointerout:function(t){Bs(t)||qs.mouseout.call(this,t)}};sr(["click","dblclick","contextmenu"],function(t){qs[t]=function(e){e=To(this.dom,e),this.trigger(t,e)}});var Ks={pointermove:function(t){Bs(t)||Ks.mousemove.call(this,t)},pointerup:function(t){Ks.mouseup.call(this,t)},mousemove:function(t){this.trigger("mousemove",t)},mouseup:function(t){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",t),e&&(t.zrEventControl="only_globalout",this.trigger("mouseout",t))}};function Ws(t,e,n,i){t.mounted[e]=n,t.listenerOpts[e]=i,function(t,e,n,i){t.addEventListener(e,n,i)}(t.domTarget,e,n,i)}function js(t){var e=t.mounted;for(var n in e)e.hasOwnProperty(n)&&$o(t.domTarget,n,e[n],t.listenerOpts[n]);t.mounted={}}var Gs=function(t,e){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=e},Xs=function(t){function e(e,n){var i=t.call(this)||this;return i.__pointerCapturing=!1,i.dom=e,i.painterRoot=n,i.Va=new Gs(e,qs),Ds&&(i.Ba=new Gs(document,Ks)),function(t,e){var n=e.domHandlers;Li.pointerEventsSupported?sr(Ls.pointer,function(i){Ws(e,i,function(e){n[i].call(t,e)})}):(Li.touchEventsSupported&&sr(Ls.touch,function(i){Ws(e,i,function(r){n[i].call(t,r),function(t){t.touching=!0,null!=t.touchTimer&&(clearTimeout(t.touchTimer),t.touchTimer=null),t.touchTimer=setTimeout(function(){t.touching=!1,t.touchTimer=null},700)}(e)})}),sr(Ls.mouse,function(i){Ws(e,i,function(r){r=Co(r),e.touching||n[i].call(t,r)})}))}(i,i.Va),i}return Ei(e,t),e.prototype.dispose=function(){js(this.Va),Ds&&js(this.Ba)},e.prototype.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},e.prototype.__togglePointerCapture=function(t){if(this.__mayPointerCapture=null,Ds&&+this.__pointerCapturing^+t){this.__pointerCapturing=t;var e=this.Ba;t?function(t,e){function n(n){Ws(e,n,function(i){i=Co(i),Hs(t,i.target)||(i=function(t,e){return To(t.dom,new Us(t,e),!0)}(t,i),e.domHandlers[n].call(t,i))},{capture:!0})}Li.pointerEventsSupported?sr(zs,n):Li.touchEventsSupported||sr(Ps,n)}(this,e):js(e)}},e}(ao),Ys=1;Li.hasGlobalWindow&&(Ys=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var Zs=Ys,Js="#333",Qs="#ccc",tl=_o;function el(t){return t>5e-5||t<-5e-5}var nl,il=[],rl=[],ol=[1,0,0,1,0,0],al=Math.abs,sl=function(){function t(){}return t.prototype.getLocalTransform=function(e){return t.getLocalTransform(this,e)},t.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},t.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},t.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},t.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},t.prototype.needLocalTransform=function(){return el(this.rotation)||el(this.x)||el(this.y)||el(this.scaleX-1)||el(this.scaleY-1)||el(this.skewX)||el(this.skewY)},t.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,e=this.needLocalTransform(),n=this.transform;e||t?(n=n||[1,0,0,1,0,0],e?this.getLocalTransform(n):tl(n),t&&(e?Fo(n,t,n):Io(n,t)),this.transform=n,this.Ha(n)):n&&(tl(n),this.invTransform=null)},t.prototype.Ha=function(t){var e=this.globalScaleRatio;if(null!=e&&1!==e){this.getGlobalScale(il);var n=il[0]<0?-1:1,i=il[1]<0?-1:1,r=((il[0]-n)*e+n)/il[0]||0,o=((il[1]-i)*e+i)/il[1]||0;t[0]*=r,t[1]*=r,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||[1,0,0,1,0,0],Po(this.invTransform,t)},t.prototype.getComputedTransform=function(){for(var t=this,e=[];t;)e.push(t),t=t.parent;for(;t=e.pop();)t.updateTransform();return this.transform},t.prototype.setLocalTransform=function(t){if(t){var e=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=Math.atan2(t[1],t[0]),r=Math.PI/2+i-Math.atan2(t[3],t[2]);n=Math.sqrt(n)*Math.cos(r),e=Math.sqrt(e),this.skewX=r,this.skewY=0,this.rotation=-i,this.x=+t[4],this.y=+t[5],this.scaleX=e,this.scaleY=n,this.originX=0,this.originY=0}},t.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(t.invTransform=t.invTransform||[1,0,0,1,0,0],Fo(rl,t.invTransform,e),e=rl);var n=this.originX,i=this.originY;(n||i)&&(ol[4]=n,ol[5]=i,Fo(rl,e,ol),rl[4]-=n,rl[5]-=i,e=rl),this.setLocalTransform(e)}},t.prototype.getGlobalScale=function(t){var e=this.transform;return t=t||[],e?(t[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),t[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),e[0]<0&&(t[0]=-t[0]),e[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},t.prototype.transformCoordToLocal=function(t,e){var n=[t,e],i=this.invTransform;return i&&eo(n,n,i),n},t.prototype.transformCoordToGlobal=function(t,e){var n=[t,e],i=this.transform;return i&&eo(n,n,i),n},t.prototype.getLineScale=function(){var t=this.transform;return t&&al(t[0]-1)>1e-10&&al(t[3]-1)>1e-10?Math.sqrt(al(t[0]*t[3]-t[2]*t[1])):1},t.prototype.copyTransform=function(t){cl(this,t)},t.getLocalTransform=function(t,e){e=e||[];var n=t.originX||0,i=t.originY||0,r=t.scaleX,o=t.scaleY,a=t.anchorX,s=t.anchorY,l=t.rotation||0,c=t.x,h=t.y,u=t.skewX?Math.tan(t.skewX):0,d=t.skewY?Math.tan(-t.skewY):0;if(n||i||a||s){var f=n+a,p=i+s;e[4]=-f*r-u*p*o,e[5]=-p*o-d*f*r}else e[4]=e[5]=0;return e[0]=r,e[3]=o,e[1]=d*r,e[2]=u*o,l&&Do(e,e,l),e[4]+=n+c,e[5]+=i+h,e},t.initDefaultProps=function(){var e=t.prototype;e.scaleX=e.scaleY=e.globalScaleRatio=1,e.x=e.y=e.originX=e.originY=e.skewX=e.skewY=e.rotation=e.anchorX=e.anchorY=0}(),t}(),ll=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function cl(t,e){for(var n=0;n<ll.length;n++){var i=ll[n];t[i]=e[i]}}function hl(t){nl||(nl=new Ya(100)),t=t||Pi;var e=nl.get(t);return e||(e={font:t,strWidthCache:new Ya(500),asciiWidthMap:null,asciiWidthMapTried:!1,stWideCharWidth:Oi.measureText("国",t).width,asciiCharWidth:Oi.measureText("a",t).width},nl.put(t,e)),e}var ul=0;function dl(t,e){return t.asciiWidthMapTried||(t.asciiWidthMap=function(t){if(!(ul>=5)){t=t||Pi;for(var e=[],n=+new Date,i=0;i<=127;i++)e[i]=Oi.measureText(String.fromCharCode(i),t).width;var r=+new Date-n;return r>16?ul=5:r>2&&ul++,e}}(t.font),t.asciiWidthMapTried=!0),0<=e&&e<=127?null!=t.asciiWidthMap?t.asciiWidthMap[e]:t.asciiCharWidth:t.stWideCharWidth}function fl(t,e){var n=t.strWidthCache,i=n.get(e);return null==i&&(i=Oi.measureText(e,t.font).width,n.put(e,i)),i}function pl(t,e,n,i){var r=fl(hl(e),t),o=yl(e),a=gl(0,r,n),s=vl(0,o,i);return new Jo(a,s,r,o)}function ml(t,e,n,i){var r=((t||"")+"").split("\n");if(1===r.length)return pl(r[0],e,n,i);for(var o=new Jo(0,0,0,0),a=0;a<r.length;a++){var s=pl(r[a],e,n,i);0===a?o.copy(s):o.union(s)}return o}function gl(t,e,n,i){return"right"===n?i?t+=e:t-=e:"center"===n&&(i?t+=e/2:t-=e/2),t}function vl(t,e,n,i){return"middle"===n?i?t+=e/2:t-=e/2:"bottom"===n&&(i?t+=e:t-=e),t}function yl(t){return hl(t).stWideCharWidth}function bl(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t}function xl(t,e,n){var i=e.position||"inside",r=null!=e.distance?e.distance:5,o=n.height,a=n.width,s=o/2,l=n.x,c=n.y,h="left",u="top";if(i instanceof Array)l+=bl(i[0],n.width),c+=bl(i[1],n.height),h=null,u=null;else switch(i){case"left":l-=r,c+=s,h="right",u="middle";break;case"right":l+=r+a,c+=s,u="middle";break;case"top":l+=a/2,c-=r,h="center",u="bottom";break;case"bottom":l+=a/2,c+=o+r,h="center";break;case"inside":l+=a/2,c+=s,h="center",u="middle";break;case"insideLeft":l+=r,c+=s,u="middle";break;case"insideRight":l+=a-r,c+=s,h="right",u="middle";break;case"insideTop":l+=a/2,c+=r,h="center";break;case"insideBottom":l+=a/2,c+=o-r,h="center",u="bottom";break;case"insideTopLeft":l+=r,c+=r;break;case"insideTopRight":l+=a-r,c+=r,h="right";break;case"insideBottomLeft":l+=r,c+=o-r,u="bottom";break;case"insideBottomRight":l+=a-r,c+=o-r,h="right",u="bottom"}return(t=t||{}).x=l,t.y=c,t.align=h,t.verticalAlign=u,t}var wl="__zr_normal__",Sl=ll.concat(["ignore"]),Cl=cr(ll,function(t,e){return t[e]=!0,t},{ignore:!1}),Tl={},$l=new Jo(0,0,0,0),Ml=[],Al=function(){function t(t){this.id=Ji(),this.animators=[],this.currentStates=[],this.states={},this.J(t)}return t.prototype.J=function(t){this.attr(t)},t.prototype.drift=function(t,e,n){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=e,this.decomposeTransform(),this.markRedraw()},t.prototype.beforeUpdate=function(){},t.prototype.afterUpdate=function(){},t.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},t.prototype.updateInnerText=function(t){var e=this.Ua;if(e&&(!e.ignore||t)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,r=e.innerTransformable,o=void 0,a=void 0,s=!1;r.parent=i?this:null;var l=!1;r.copyTransform(e);var c=null!=n.position,h=n.autoOverflowArea,u=void 0;if((h||c)&&(u=$l,n.layoutRect?u.copy(n.layoutRect):u.copy(this.getBoundingRect()),i||u.applyTransform(this.transform)),c){this.calculateTextPosition?this.calculateTextPosition(Tl,n,u):xl(Tl,n,u),r.x=Tl.x,r.y=Tl.y,o=Tl.align,a=Tl.verticalAlign;var d=n.origin;if(d&&null!=n.rotation){var f=void 0,p=void 0;"center"===d?(f=.5*u.width,p=.5*u.height):(f=bl(d[0],u.width),p=bl(d[1],u.height)),l=!0,r.originX=-r.x+f+(i?0:u.x),r.originY=-r.y+p+(i?0:u.y)}}null!=n.rotation&&(r.rotation=n.rotation);var m=n.offset;m&&(r.x+=m[0],r.y+=m[1],l||(r.originX=-m[0],r.originY=-m[1]));var g=this.Ka||(this.Ka={});if(h){var v=g.overflowRect=g.overflowRect||new Jo(0,0,0,0);r.getLocalTransform(Ml),Po(Ml,Ml),Jo.copy(v,u),v.applyTransform(Ml)}else g.overflowRect=null;var y=void 0,b=void 0,x=void 0;(null==n.inside?"string"==typeof n.position&&n.position.indexOf("inside")>=0:n.inside)&&this.canBeInsideText()?(y=n.insideFill,b=n.insideStroke,null!=y&&"auto"!==y||(y=this.getInsideTextFill()),null!=b&&"auto"!==b||(b=this.getInsideTextStroke(y),x=!0)):(y=n.outsideFill,b=n.outsideStroke,null!=y&&"auto"!==y||(y=this.getOutsideFill()),null!=b&&"auto"!==b||(b=this.getOutsideStroke(y),x=!0)),(y=y||"#000")===g.fill&&b===g.stroke&&x===g.autoStroke&&o===g.align&&a===g.verticalAlign||(s=!0,g.fill=y,g.stroke=b,g.autoStroke=x,g.align=o,g.verticalAlign=a,e.setDefaultTextStyle(g)),e.__dirty|=1,s&&e.dirtyStyle(!0)}},t.prototype.canBeInsideText=function(){return!0},t.prototype.getInsideTextFill=function(){return"#fff"},t.prototype.getInsideTextStroke=function(t){return"#000"},t.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?Qs:Js},t.prototype.getOutsideStroke=function(t){var e=this.__zr&&this.__zr.getBackgroundColor(),n="string"==typeof e&&cs(e);n||(n=[255,255,255,1]);for(var i=n[3],r=this.__zr.isDarkMode(),o=0;o<3;o++)n[o]=n[o]*i+(r?0:255)*(1-i);return n[3]=1,ms(n,"rgba")},t.prototype.traverse=function(t,e){},t.prototype.attrKV=function(t,e){"textConfig"===t?this.setTextConfig(e):"textContent"===t?this.setTextContent(e):"clipPath"===t?this.setClipPath(e):"extra"===t?(this.extra=this.extra||{},nr(this.extra,e)):this[t]=e},t.prototype.hide=function(){this.ignore=!0,this.markRedraw()},t.prototype.show=function(){this.ignore=!1,this.markRedraw()},t.prototype.attr=function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(xr(t))for(var n=dr(t),i=0;i<n.length;i++){var r=n[i];this.attrKV(r,t[r])}return this.markRedraw(),this},t.prototype.saveCurrentToNormalState=function(t){this.Wa(t);for(var e=this.ja,n=0;n<this.animators.length;n++){var i=this.animators[n],r=i.__fromStateTransition;if(!(i.getLoop()||r&&r!==wl)){var o=i.targetName,a=o?e[o]:e;i.saveTo(a)}}},t.prototype.Wa=function(t){var e=this.ja;e||(e=this.ja={}),t.textConfig&&!e.textConfig&&(e.textConfig=this.textConfig),this.qa(t,e,Sl)},t.prototype.qa=function(t,e,n){for(var i=0;i<n.length;i++){var r=n[i];null==t[r]||r in e||(e[r]=this[r])}},t.prototype.hasState=function(){return this.currentStates.length>0},t.prototype.getState=function(t){return this.states[t]},t.prototype.ensureState=function(t){var e=this.states;return e[t]||(e[t]={}),e[t]},t.prototype.clearStates=function(t){this.useState(wl,!1,t)},t.prototype.useState=function(t,e,n,i){var r=t===wl;if(this.hasState()||!r){var o=this.currentStates,a=this.stateTransition;if(!(rr(o,t)>=0)||!e&&1!==o.length){var s;if(this.stateProxy&&!r&&(s=this.stateProxy(t)),s||(s=this.states&&this.states[t]),s||r){r||this.saveCurrentToNormalState(s);var l=!!(s&&s.hoverLayer||i);l&&this.Ga(!0),this.Xa(t,s,this.ja,e,!n&&!this.__inHover&&a&&a.duration>0,a);var c=this.Ua,h=this.Ya;return c&&c.useState(t,e,n,l),h&&h.useState(t,e,n,l),r?(this.currentStates=[],this.ja={}):e?this.currentStates.push(t):this.currentStates=[t],this.Ja(),this.markRedraw(),!l&&this.__inHover&&(this.Ga(!1),this.__dirty&=-2),s}Qi("State "+t+" not exists.")}}},t.prototype.useStates=function(t,e,n){if(t.length){var i=[],r=this.currentStates,o=t.length,a=o===r.length;if(a)for(var s=0;s<o;s++)if(t[s]!==r[s]){a=!1;break}if(a)return;for(s=0;s<o;s++){var l=t[s],c=void 0;this.stateProxy&&(c=this.stateProxy(l,t)),c||(c=this.states[l]),c&&i.push(c)}var h=i[o-1],u=!!(h&&h.hoverLayer||n);u&&this.Ga(!0);var d=this.Za(i),f=this.stateTransition;this.saveCurrentToNormalState(d),this.Xa(t.join(","),d,this.ja,!1,!e&&!this.__inHover&&f&&f.duration>0,f);var p=this.Ua,m=this.Ya;p&&p.useStates(t,e,u),m&&m.useStates(t,e,u),this.Ja(),this.currentStates=t.slice(),this.markRedraw(),!u&&this.__inHover&&(this.Ga(!1),this.__dirty&=-2)}else this.clearStates()},t.prototype.isSilent=function(){for(var t=this;t;){if(t.silent)return!0;var e=t.__hostTarget;t=e?t.ignoreHostSilent?null:e:t.parent}return!1},t.prototype.Ja=function(){for(var t=0;t<this.animators.length;t++){var e=this.animators[t];e.targetName&&e.changeTarget(this[e.targetName])}},t.prototype.removeState=function(t){var e=rr(this.currentStates,t);if(e>=0){var n=this.currentStates.slice();n.splice(e,1),this.useStates(n)}},t.prototype.replaceState=function(t,e,n){var i=this.currentStates.slice(),r=rr(i,t),o=rr(i,e)>=0;r>=0?o?i.splice(r,1):i[r]=e:n&&!o&&i.push(e),this.useStates(i)},t.prototype.toggleState=function(t,e){e?this.useState(t,!0):this.removeState(t)},t.prototype.Za=function(t){for(var e,n={},i=0;i<t.length;i++){var r=t[i];nr(n,r),r.textConfig&&nr(e=e||{},r.textConfig)}return e&&(n.textConfig=e),n},t.prototype.Xa=function(t,e,n,i,r,o){var a=!(e&&i);e&&e.textConfig?(this.textConfig=nr({},i?this.textConfig:n.textConfig),nr(this.textConfig,e.textConfig)):a&&n.textConfig&&(this.textConfig=n.textConfig);for(var s={},l=!1,c=0;c<Sl.length;c++){var h=Sl[c],u=r&&Cl[h];e&&null!=e[h]?u?(l=!0,s[h]=e[h]):this[h]=e[h]:a&&null!=n[h]&&(u?(l=!0,s[h]=n[h]):this[h]=n[h])}if(!r)for(c=0;c<this.animators.length;c++){var d=this.animators[c],f=d.targetName;d.getLoop()||d.__changeFinalValue(f?(e||n)[f]:e||n)}l&&this.Qa(t,s,o)},t.prototype.tl=function(t){if((!t.__zr||t.__hostTarget)&&t!==this){var e=this.__zr;e&&t.addSelfToZr(e),t.__zr=e,t.__hostTarget=this}},t.prototype.nl=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},t.prototype.getClipPath=function(){return this.il},t.prototype.setClipPath=function(t){this.il&&this.il!==t&&this.removeClipPath(),this.tl(t),this.il=t,this.markRedraw()},t.prototype.removeClipPath=function(){var t=this.il;t&&(this.nl(t),this.il=null,this.markRedraw())},t.prototype.getTextContent=function(){return this.Ua},t.prototype.setTextContent=function(t){var e=this.Ua;e!==t&&(e&&e!==t&&this.removeTextContent(),t.innerTransformable=new sl,this.tl(t),this.Ua=t,this.markRedraw())},t.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),nr(this.textConfig,t),this.markRedraw()},t.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},t.prototype.removeTextContent=function(){var t=this.Ua;t&&(t.innerTransformable=null,this.nl(t),this.Ua=null,this.Ka=null,this.markRedraw())},t.prototype.getTextGuideLine=function(){return this.Ya},t.prototype.setTextGuideLine=function(t){this.Ya&&this.Ya!==t&&this.removeTextGuideLine(),this.tl(t),this.Ya=t,this.markRedraw()},t.prototype.removeTextGuideLine=function(){var t=this.Ya;t&&(this.nl(t),this.Ya=null,this.markRedraw())},t.prototype.markRedraw=function(){this.__dirty|=1;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},t.prototype.dirty=function(){this.markRedraw()},t.prototype.Ga=function(t){this.__inHover=t;var e=this.Ua,n=this.Ya;e&&(e.__inHover=t),n&&(n.__inHover=t)},t.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.addAnimator(e[n]);this.il&&this.il.addSelfToZr(t),this.Ua&&this.Ua.addSelfToZr(t),this.Ya&&this.Ya.addSelfToZr(t)}},t.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.removeAnimator(e[n]);this.il&&this.il.removeSelfFromZr(t),this.Ua&&this.Ua.removeSelfFromZr(t),this.Ya&&this.Ya.removeSelfFromZr(t)}},t.prototype.animate=function(t,e,n){var i=t?this[t]:this,r=new Is(i,e,n);return t&&(r.targetName=t),this.addAnimator(r,t),r},t.prototype.addAnimator=function(t,e){var n=this.__zr,i=this;t.during(function(){i.updateDuringAnimation(e)}).done(function(){var e=i.animators,n=rr(e,t);n>=0&&e.splice(n,1)}),this.animators.push(t),n&&n.animation.addAnimator(t),n&&n.wakeUp()},t.prototype.updateDuringAnimation=function(t){this.markRedraw()},t.prototype.stopAnimation=function(t,e){for(var n=this.animators,i=n.length,r=[],o=0;o<i;o++){var a=n[o];t&&t!==a.scope?r.push(a):a.stop(e)}return this.animators=r,this},t.prototype.animateTo=function(t,e,n){Nl(this,t,e,n)},t.prototype.animateFrom=function(t,e,n){Nl(this,t,e,n,!0)},t.prototype.Qa=function(t,e,n,i){for(var r=Nl(this,e,n,i),o=0;o<r.length;o++)r[o].__fromStateTransition=t},t.prototype.getBoundingRect=function(){return null},t.prototype.getPaintRect=function(){return null},t.initDefaultProps=function(){var e=t.prototype;function n(t,n,i,r){function o(t,e){Object.defineProperty(e,0,{get:function(){return t[i]},set:function(e){t[i]=e}}),Object.defineProperty(e,1,{get:function(){return t[r]},set:function(e){t[r]=e}})}Object.defineProperty(e,t,{get:function(){return this[n]||o(this,this[n]=[]),this[n]},set:function(t){this[i]=t[0],this[r]=t[1],this[n]=t,o(this,t)}})}e.type="element",e.name="",e.ignore=e.silent=e.ignoreHostSilent=e.isGroup=e.draggable=e.dragging=e.ignoreClip=e.__inHover=!1,e.__dirty=1,Object.defineProperty&&(n("position","_legacyPos","x","y"),n("scale","_legacyScale","scaleX","scaleY"),n("origin","_legacyOrigin","originX","originY"))}(),t}();function Nl(t,e,n,i,r){var o=[];_l(t,"",t,e,n=n||{},i,o,r);var a=o.length,s=!1,l=n.done,c=n.aborted,h=function(){s=!0,--a<=0&&(s?l&&l():c&&c())},u=function(){--a<=0&&(s?l&&l():c&&c())};a||l&&l(),o.length>0&&n.during&&o[0].during(function(t,e){n.during(e)});for(var d=0;d<o.length;d++){var f=o[d];h&&f.done(h),u&&f.aborted(u),n.force&&f.duration(n.duration),f.start(n.easing)}return o}function kl(t,e,n){for(var i=0;i<n;i++)t[i]=e[i]}function Rl(t,e,n){if(ar(e[n]))if(ar(t[n])||(t[n]=[]),Sr(e[n])){var i=e[n].length;t[n].length!==i&&(t[n]=new e[n].constructor(i),kl(t[n],e[n],i))}else{var r=e[n],o=t[n],a=r.length;if(ar(r[0]))for(var s=r[0].length,l=0;l<a;l++)o[l]?kl(o[l],r[l],s):o[l]=Array.prototype.slice.call(r[l]);else kl(o,r,a);o.length=r.length}else t[n]=e[n]}function _l(t,e,n,i,r,o,a,s){for(var l=dr(i),c=r.duration,h=r.delay,u=r.additive,d=r.setToFinal,f=!xr(o),p=t.animators,m=[],g=0;g<l.length;g++){var v=l[g],y=i[v];if(null!=y&&null!=n[v]&&(f||o[v]))if(!xr(y)||ar(y)||Tr(y))m.push(v);else{if(e){s||(n[v]=y,t.updateDuringAnimation(e));continue}_l(t,v,n[v],y,r,o&&o[v],a,s)}else s||(n[v]=y,t.updateDuringAnimation(e),m.push(v))}var b=m.length;if(!u&&b)for(var x=0;x<p.length;x++)if((S=p[x]).targetName===e&&S.stopTracks(m)){var w=rr(p,S);p.splice(w,1)}if(r.force||(m=hr(m,function(t){return!((e=i[t])===(r=n[t])||ar(e)&&ar(r)&&function(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}(e,r));var e,r}),b=m.length),b>0||r.force&&!a.length){var S,C=void 0,T=void 0,$=void 0;if(s)for(T={},d&&(C={}),x=0;x<b;x++)T[v=m[x]]=n[v],d?C[v]=i[v]:n[v]=i[v];else if(d)for($={},x=0;x<b;x++)$[v=m[x]]=Ms(n[v]),Rl(n,i,v);(S=new Is(n,!1,!1,u?hr(p,function(t){return t.targetName===e}):null)).targetName=e,r.scope&&(S.scope=r.scope),d&&C&&S.whenWithKeys(0,C,m),$&&S.whenWithKeys(0,$,m),S.whenWithKeys(c??500,s?T:i,m).delay(h||0),t.addAnimator(S,e),a.push(S)}}or(Al,ao),or(Al,sl);var Il=function(t){function e(e){var n=t.call(this)||this;return n.isGroup=!0,n.rl=[],n.attr(e),n}return Ei(e,t),e.prototype.childrenRef=function(){return this.rl},e.prototype.children=function(){return this.rl.slice()},e.prototype.childAt=function(t){return this.rl[t]},e.prototype.childOfName=function(t){for(var e=this.rl,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},e.prototype.childCount=function(){return this.rl.length},e.prototype.add=function(t){return t&&t!==this&&t.parent!==this&&(this.rl.push(t),this.sl(t)),this},e.prototype.addBefore=function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var n=this.rl,i=n.indexOf(e);i>=0&&(n.splice(i,0,t),this.sl(t))}return this},e.prototype.replace=function(t,e){var n=rr(this.rl,t);return n>=0&&this.replaceAt(e,n),this},e.prototype.replaceAt=function(t,e){var n=this.rl,i=n[e];if(t&&t!==this&&t.parent!==this&&t!==i){n[e]=t,i.parent=null;var r=this.__zr;r&&i.removeSelfFromZr(r),this.sl(t)}return this},e.prototype.sl=function(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__zr;e&&e!==t.__zr&&t.addSelfToZr(e),e&&e.refresh()},e.prototype.remove=function(t){var e=this.__zr,n=this.rl,i=rr(n,t);return i<0||(n.splice(i,1),t.parent=null,e&&t.removeSelfFromZr(e),e&&e.refresh()),this},e.prototype.removeAll=function(){for(var t=this.rl,e=this.__zr,n=0;n<t.length;n++){var i=t[n];e&&i.removeSelfFromZr(e),i.parent=null}return t.length=0,this},e.prototype.eachChild=function(t,e){for(var n=this.rl,i=0;i<n.length;i++){var r=n[i];t.call(e,r,i)}return this},e.prototype.traverse=function(t,e){for(var n=0;n<this.rl.length;n++){var i=this.rl[n],r=t.call(e,i);i.isGroup&&!r&&i.traverse(t,e)}return this},e.prototype.addSelfToZr=function(e){t.prototype.addSelfToZr.call(this,e);for(var n=0;n<this.rl.length;n++)this.rl[n].addSelfToZr(e)},e.prototype.removeSelfFromZr=function(e){t.prototype.removeSelfFromZr.call(this,e);for(var n=0;n<this.rl.length;n++)this.rl[n].removeSelfFromZr(e)},e.prototype.getBoundingRect=function(t){for(var e=new Jo(0,0,0,0),n=t||this.rl,i=[],r=null,o=0;o<n.length;o++){var a=n[o];if(!a.ignore&&!a.invisible){var s=a.getBoundingRect(),l=a.getLocalTransform(i);l?(Jo.applyTransform(e,s,l),(r=r||e.clone()).union(e)):(r=r||s.clone()).union(s)}}return r||e},e}(Al);Il.prototype.type="group";var Fl={},El={},Dl=function(){function t(t,e,n){var i=this;this.al=10,this.ll=0,this.hl=!0,this.ul=!0,this.fl=!1,n=n||{},this.dom=e,this.id=t;var r=new Sa,o=n.renderer||"canvas";Fl[o]||(o=dr(Fl)[0]),n.useDirtyRect=null!=n.useDirtyRect&&n.useDirtyRect;var a=new Fl[o](e,r,n,t),s=n.ssr||a.ssrOnly;this.storage=r,this.painter=a;var l,c=Li.node||Li.worker||s?null:new Xs(a.getViewportRoot(),a.root),h=n.useCoarsePointer;(null==h||"auto"===h?Li.touchEventsSupported:!!h)&&(l=Ar(n.pointerSize,44)),this.handler=new ca(r,a,c,a.root,l),this.animation=new Es({stage:{update:s?null:function(){return i.dl(!0)}}}),s||this.animation.start()}return t.prototype.add=function(t){!this.ml&&t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},t.prototype.remove=function(t){!this.ml&&t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},t.prototype.configLayer=function(t,e){this.ml||(this.painter.configLayer&&this.painter.configLayer(t,e),this.refresh())},t.prototype.setBackgroundColor=function(t){this.ml||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this.pl=t,this.fl=function(t){if(!t)return!1;if("string"==typeof t)return gs(t,1)<.4;if(t.colorStops){for(var e=t.colorStops,n=0,i=e.length,r=0;r<i;r++)n+=gs(e[r].color,1);return(n/=i)<.4}return!1}(t))},t.prototype.getBackgroundColor=function(){return this.pl},t.prototype.setDarkMode=function(t){this.fl=t},t.prototype.isDarkMode=function(){return this.fl},t.prototype.refreshImmediately=function(t){this.ml||(t||this.animation.update(!0),this.hl=!1,this.painter.refresh(),this.hl=!1)},t.prototype.refresh=function(){this.ml||(this.hl=!0,this.animation.start())},t.prototype.flush=function(){this.ml||this.dl(!1)},t.prototype.dl=function(t){var e,n=Fs();this.hl&&(e=!0,this.refreshImmediately(t)),this.ul&&(e=!0,this.refreshHoverImmediately());var i=Fs();e?(this.ll=0,this.trigger("rendered",{elapsedTime:i-n})):this.al>0&&(this.ll++,this.ll>this.al&&this.animation.stop())},t.prototype.setSleepAfterStill=function(t){this.al=t},t.prototype.wakeUp=function(){this.ml||(this.animation.start(),this.ll=0)},t.prototype.refreshHover=function(){this.ul=!0},t.prototype.refreshHoverImmediately=function(){this.ml||(this.ul=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover())},t.prototype.resize=function(t){this.ml||(t=t||{},this.painter.resize(t.width,t.height),this.handler.resize())},t.prototype.clearAnimation=function(){this.ml||this.animation.clear()},t.prototype.getWidth=function(){if(!this.ml)return this.painter.getWidth()},t.prototype.getHeight=function(){if(!this.ml)return this.painter.getHeight()},t.prototype.setCursorStyle=function(t){this.ml||this.handler.setCursorStyle(t)},t.prototype.findHover=function(t,e){if(!this.ml)return this.handler.findHover(t,e)},t.prototype.on=function(t,e,n){return this.ml||this.handler.on(t,e,n),this},t.prototype.off=function(t,e){this.ml||this.handler.off(t,e)},t.prototype.trigger=function(t,e){this.ml||this.handler.trigger(t,e)},t.prototype.clear=function(){if(!this.ml){for(var t=this.storage.getRoots(),e=0;e<t.length;e++)t[e]instanceof Il&&t[e].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},t.prototype.dispose=function(){var t;this.ml||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this.ml=!0,t=this.id,delete El[t])},t}();function Ll(t,e){var n=new Dl(Ji(),t,e);return El[n.id]=n,n}var Pl=Math.min,zl=Math.max,Ol=Math.abs;function Bl(t,e,n,i){var r=e[0],o=e[1],a=n[0],s=n[1],l=o-r,c=s-a;if(0===l)return 0===c?a:(a+s)/2;if(i)if(l>0){if(t<=r)return a;if(t>=o)return s}else{if(t>=r)return a;if(t<=o)return s}else{if(t===r)return a;if(t===o)return s}return(t-r)/l*c+a}var Vl=function(t,e,n){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return Hl(t,e,n)};function Hl(t,e,n){return vr(t)?(i=t,i.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(t)/100*e+(n||0):parseFloat(t):null==t?NaN:+t;var i}function Ul(t,e,n){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),t=(+t).toFixed(e),n?t:+t}function ql(t){if(t=+t,isNaN(t))return 0;if(t>1e-14)for(var e=1,n=0;n<15;n++,e*=10)if(Math.round(t*e)/e===t)return n;return function(t){var e=t.toString().toLowerCase(),n=e.indexOf("e"),i=n>0?+e.slice(n+1):0,r=n>0?n:e.length,o=e.indexOf("."),a=o<0?0:r-1-o;return Math.max(0,a-i)}(t)}function Kl(t,e){var n=Math.max(ql(t),ql(e)),i=t+e;return n>20?i:Ul(i,n)}var Wl=9007199254740991;function jl(t){var e=2*Math.PI;return(t%e+e)%e}function Gl(t){return t>-1e-4&&t<1e-4}var Xl=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Yl(t){if(t instanceof Date)return t;if(vr(t)){var e=Xl.exec(t);if(!e)return new Date(NaN);if(e[8]){var n=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(n-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,n,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}return null==t?new Date(NaN):new Date(Math.round(t))}function Zl(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return t/Math.pow(10,e)>=10&&e++,e}function Jl(t,e){var n=Zl(t),i=Math.pow(10,n),r=t/i;return t=(r<1.5?1:r<2.5?2:r<4?3:r<7?5:10)*i,n>=-20?+t.toFixed(n<0?-n:0):t}function Ql(t){var e=parseFloat(t);return e==t&&(0!==e||!vr(t)||t.indexOf("x")<=0)?e:NaN}function tc(){return Math.round(9*Math.random())}function ec(t,e){return 0===e?t:ec(e,t%e)}function nc(t,e){return null==t?e:null==e?t:t*e/ec(t,e)}function ic(t,e){}function rc(t){throw new Error(t)}function oc(t,e,n){return(e-t)*n+t}"undefined"!=typeof console&&console.warn&&console.log;var ac="series\0";function sc(t){return t instanceof Array?t:null==t?[]:[t]}function lc(t,e,n){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var i=0,r=n.length;i<r;i++){var o=n[i];!t.emphasis[e].hasOwnProperty(o)&&t[e].hasOwnProperty(o)&&(t.emphasis[e][o]=t[e][o])}}}var cc=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function hc(t){return!xr(t)||mr(t)||t instanceof Date?t:t.value}function uc(t){return xr(t)&&!(t instanceof Array)}function dc(t,e,n){var i=pc(e[t],null),r=pc(n[t],null);return null!=i&&null!=r&&i===r}function fc(t){return pc(t,"")}function pc(t,e){return null==t?e:vr(t)?t:br(t)||yr(t)?t+"":e}function mc(t){var e=t.name;return!(!e||!e.indexOf(ac))}function gc(t){return t&&null!=t.id&&0===fc(t.id).indexOf("\0_ec_\0")}function vc(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?mr(e.dataIndex)?lr(e.dataIndex,function(e){return t.indexOfRawIndex(e)}):t.indexOfRawIndex(e.dataIndex):null!=e.name?mr(e.name)?lr(e.name,function(e){return t.indexOfName(e)}):t.indexOfName(e.name):void 0}function yc(){var t="__ec_inner_"+bc++;return function(e){return e[t]||(e[t]={})}}var bc=tc();function xc(t,e,n){var i=wc(e,n),r=i.mainTypeSpecified,o=i.queryOptionMap,a=i.others,s=n?n.defaultMainType:null;return!r&&s&&o.set(s,{}),o.each(function(e,i){var r=Cc(t,i,e,{useDefault:s===i,enableAll:!n||null==n.enableAll||n.enableAll,enableNone:!n||null==n.enableNone||n.enableNone});a[i+"Models"]=r.models,a[i+"Model"]=r.models[0]}),a}function wc(t,e){var n;if(vr(t)){var i={};i[t+"Index"]=0,n=i}else n=t;var r=Or(),o={},a=!1;return sr(n,function(t,n){if("dataIndex"!==n&&"dataIndexInside"!==n){var i=n.match(/^(\w+)(Index|Id|Name)$/)||[],s=i[1],l=(i[2]||"").toLowerCase();!s||!l||e&&e.includeMainTypes&&rr(e.includeMainTypes,s)<0||(a=a||!!s,(r.get(s)||r.set(s,{}))[l]=t)}else o[n]=t}),{mainTypeSpecified:a,queryOptionMap:r,others:o}}var Sc={useDefault:!0,enableAll:!1,enableNone:!1};function Cc(t,e,n,i){i=i||Sc;var r=n.index,o=n.id,a=n.name,s={models:null,specified:null!=r||null!=o||null!=a};if(!s.specified){var l=void 0;return s.models=i.useDefault&&(l=t.getComponent(e))?[l]:[],s}if("none"===r||!1===r){if(i.enableNone)return s.models=[],s;r=-1}return"all"===r&&(r=i.enableAll?o=a=null:-1),s.models=t.queryComponents({mainType:e,index:r,id:o,name:a}),s}function Tc(t,e,n){t.setAttribute?t.setAttribute(e,n):t[e]=n}var $c="___EC__COMPONENT__CONTAINER___",Mc="___EC__EXTENDED_CLASS___";function Ac(t){var e={main:"",sub:""};if(t){var n=t.split(".");e.main=n[0]||"",e.sub=n[1]||""}return e}function Nc(t,e){t.$constructor=t,t.extend=function(t){var e,n,i=this;return gr(n=i)&&/^class\s/.test(Function.prototype.toString.call(n))?e=function(t){function e(){return t.apply(this,arguments)||this}return Ei(e,t),e}(i):(e=function(){(t.$constructor||i).apply(this,arguments)},function(t,e){var n=t.prototype;function i(){}for(var r in i.prototype=e.prototype,t.prototype=new i,n)n.hasOwnProperty(r)&&(t.prototype[r]=n[r]);t.prototype.constructor=t,t.superClass=e}(e,this)),nr(e.prototype,t),e[Mc]=!0,e.extend=this.extend,e.superCall=_c,e.superApply=Ic,e.superClass=i,e}}function kc(t,e){t.extend=e.extend}var Rc=Math.round(10*Math.random());function _c(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this.superClass.prototype[e].apply(t,n)}function Ic(t,e,n){return this.superClass.prototype[e].apply(t,n)}function Fc(t){var e={};t.registerClass=function(t){var n,i=t.type||t.prototype.type;if(i){_r(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n=i),'componentType "'+n+'" illegal'),t.prototype.type=i;var r=Ac(i);if(r.sub){if(r.sub!==$c){var o=function(t){var n=e[t.main];return n&&n[$c]||((n=e[t.main]={})[$c]=!0),n}(r);o[r.sub]=t}}else e[r.main]=t}return t},t.getClass=function(t,n,i){var r=e[t];if(r&&r[$c]&&(r=n?r[n]:null),i&&!r)throw new Error(n?"Component "+t+"."+(n||"")+" is used but not imported.":t+".type should be specified.");return r},t.getClassesByMainType=function(t){var n=Ac(t),i=[],r=e[n.main];return r&&r[$c]?sr(r,function(t,e){e!==$c&&i.push(t)}):i.push(r),i},t.hasClass=function(t){var n=Ac(t);return!!e[n.main]},t.getAllClassMainTypes=function(){var t=[];return sr(e,function(e,n){t.push(n)}),t},t.hasSubTypes=function(t){var n=Ac(t),i=e[n.main];return i&&i[$c]}}function Ec(t,e){for(var n=0;n<t.length;n++)t[n][1]||(t[n][1]=t[n][0]);return e=e||!1,function(n,i,r){for(var o={},a=0;a<t.length;a++){var s=t[a][1];if(!(i&&rr(i,s)>=0||r&&rr(r,s)<0)){var l=n.getShallow(s,e);null!=l&&(o[t[a][0]]=l)}}return o}}var Dc=Ec([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),Lc=function(){function t(){}return t.prototype.getAreaStyle=function(t,e){return Dc(this,t,e)},t}(),Pc=new Ya(50);function zc(t){if("string"==typeof t){var e=Pc.get(t);return e&&e.image}return t}function Oc(t,e,n,i,r){if(t){if("string"==typeof t){if(e&&e.__zrImageSrc===t||!n)return e;var o=Pc.get(t),a={hostEl:n,cb:i,cbPayload:r};return o?!Vc(e=o.image)&&o.pending.push(a):((e=Oi.loadImage(t,Bc,Bc)).__zrImageSrc=t,Pc.put(t,e.__cachedImgObj={image:e,pending:[a]})),e}return t}return e}function Bc(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function Vc(t){return t&&t.width&&t.height}var Hc=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function Uc(t,e,n,i,r,o){if(!n)return t.text="",void(t.isTruncated=!1);var a=(e+"").split("\n");o=qc(n,i,r,o);for(var s=!1,l={},c=0,h=a.length;c<h;c++)Kc(l,a[c],o),a[c]=l.textLine,s=s||l.isTruncated;t.text=a.join("\n"),t.isTruncated=s}function qc(t,e,n,i){var r=nr({},i=i||{});n=Ar(n,"..."),r.maxIterations=Ar(i.maxIterations,2);var o=r.minChar=Ar(i.minChar,0),a=r.fontMeasureInfo=hl(e),s=a.asciiCharWidth;r.placeholder=Ar(i.placeholder,"");for(var l=t=Math.max(0,t-1),c=0;c<o&&l>=s;c++)l-=s;var h=fl(a,n);return h>l&&(n="",h=0),l=t-h,r.ellipsis=n,r.ellipsisWidth=h,r.contentWidth=l,r.containerWidth=t,r}function Kc(t,e,n){var i=n.containerWidth,r=n.contentWidth,o=n.fontMeasureInfo;if(!i)return t.textLine="",void(t.isTruncated=!1);var a=fl(o,e);if(a<=i)return t.textLine=e,void(t.isTruncated=!1);for(var s=0;;s++){if(a<=r||s>=n.maxIterations){e+=n.ellipsis;break}var l=0===s?Wc(e,r,o):a>0?Math.floor(e.length*r/a):0;a=fl(o,e=e.substr(0,l))}""===e&&(e=n.placeholder),t.textLine=e,t.isTruncated=!0}function Wc(t,e,n){for(var i=0,r=0,o=t.length;r<o&&i<e;r++)i+=dl(n,t.charCodeAt(r));return r}var jc=function(){},Gc=function(t){this.tokens=[],t&&(this.tokens=t)},Xc=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1};function Yc(t,e,n,i,r){var o,a,s=""===e,l=r&&n.rich[r]||{},c=t.lines,h=l.font||n.font,u=!1;if(i){var d=l.padding,f=d?d[1]+d[3]:0;if(null!=l.width&&"auto"!==l.width){var p=bl(l.width,i.width)+f;c.length>0&&p+i.accumWidth>i.width&&(o=e.split("\n"),u=!0),i.accumWidth=p}else{var m=Qc(e,h,i.width,i.breakAll,i.accumWidth);i.accumWidth=m.accumWidth+f,a=m.linesWidths,o=m.lines}}o||(o=e.split("\n"));for(var g=hl(h),v=0;v<o.length;v++){var y=o[v],b=new jc;if(b.styleName=r,b.text=y,b.isLineHolder=!y&&!s,"number"==typeof l.width?b.width=l.width:b.width=a?a[v]:fl(g,y),v||u)c.push(new Gc([b]));else{var x=(c[c.length-1]||(c[0]=new Gc)).tokens,w=x.length;1===w&&x[0].isLineHolder?x[0]=b:(y||!w||s)&&x.push(b)}}}var Zc=cr(",&?/;] ".split(""),function(t,e){return t[e]=!0,t},{});function Jc(t){return!function(t){var e=t.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}(t)||!!Zc[t]}function Qc(t,e,n,i,r){for(var o=[],a=[],s="",l="",c=0,h=0,u=hl(e),d=0;d<t.length;d++){var f=t.charAt(d);if("\n"!==f){var p=dl(u,f.charCodeAt(0)),m=!i&&!Jc(f);(o.length?h+p>n:r+h+p>n)?h?(s||l)&&(m?(s||(s=l,l="",h=c=0),o.push(s),a.push(h-c),l+=f,s="",h=c+=p):(l&&(s+=l,l="",c=0),o.push(s),a.push(h),s=f,h=p)):m?(o.push(l),a.push(c),l=f,c=p):(o.push(f),a.push(p)):(h+=p,m?(l+=f,c+=p):(l&&(s+=l,l="",c=0),s+=f))}else l&&(s+=l,h+=c),o.push(s),a.push(h),s="",l="",c=0,h=0}return l&&(s+=l),s&&(o.push(s),a.push(h)),1===o.length&&(h+=r),{accumWidth:h,lines:o,linesWidths:a}}function th(t,e,n,i,r,o){if(t.baseX=n,t.baseY=i,t.outerWidth=t.outerHeight=null,e){var a=2*e.width,s=2*e.height;Jo.set(eh,gl(n,a,r),vl(i,s,o),a,s),Jo.intersect(e,eh,null,nh);var l=nh.outIntersectRect;t.outerWidth=l.width,t.outerHeight=l.height,t.baseX=gl(l.x,l.width,r,!0),t.baseY=vl(l.y,l.height,o,!0)}}var eh=new Jo(0,0,0,0),nh={outIntersectRect:{},clamp:!0};function ih(t){return null!=t?t+="":t=""}function rh(t,e,n,i){var r=new Jo(gl(t.x||0,e,t.textAlign),vl(t.y||0,n,t.textBaseline),e,n),o=null!=i?i:oh(t)?t.lineWidth:0;return o>0&&(r.x-=o/2,r.y-=o/2,r.width+=o,r.height+=o),r}function oh(t){var e=t.stroke;return null!=e&&"none"!==e&&t.lineWidth>0}var ah="__zr_style_"+Math.round(10*Math.random()),sh={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},lh={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};sh[ah]=!0;var ch=["z","z2","invisible"],hh=["invisible"],uh=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.J=function(e){for(var n=dr(e),i=0;i<n.length;i++){var r=n[i];"style"===r?this.useStyle(e[r]):t.prototype.attrKV.call(this,r,e[r])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,e,n,i){var r,o,a,s=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&(r=this,o=t,a=e,dh.copy(r.getBoundingRect()),r.transform&&dh.applyTransform(r.transform),fh.width=o,fh.height=a,!dh.intersect(fh))||s&&!s[0]&&!s[3])return!1;if(n&&this.__clipPaths&&this.__clipPaths.length)for(var l=0;l<this.__clipPaths.length;++l)if(this.__clipPaths[l].isZeroArea())return!1;if(i&&this.parent)for(var c=this.parent;c;){if(c.ignore)return!1;c=c.parent}return!0},e.prototype.contain=function(t,e){return this.rectContain(t,e)},e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.rectContain=function(t,e){var n=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(n[0],n[1])},e.prototype.getPaintRect=function(){var t=this.vl;if(!this.vl||this.__dirty){var e=this.transform,n=this.getBoundingRect(),i=this.style,r=i.shadowBlur||0,o=i.shadowOffsetX||0,a=i.shadowOffsetY||0;t=this.vl||(this.vl=new Jo(0,0,0,0)),e?Jo.applyTransform(t,n,e):t.copy(n),(r||o||a)&&(t.width+=2*r+Math.abs(o),t.height+=2*r+Math.abs(a),t.x=Math.min(t.x,t.x+o-r),t.y=Math.min(t.y,t.y+a-r));var s=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-s),t.y=Math.floor(t.y-s),t.width=Math.ceil(t.width+1+2*s),t.height=Math.ceil(t.height+1+2*s))}return t},e.prototype.setPrevPaintRect=function(t){t?(this.bl=this.bl||new Jo(0,0,0,0),this.bl.copy(t)):this.bl=null},e.prototype.getPrevPaintRect=function(){return this.bl},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(e,n){"style"!==e?t.prototype.attrKV.call(this,e,n):this.style?this.setStyle(n):this.useStyle(n)},e.prototype.setStyle=function(t,e){return"string"==typeof t?this.style[t]=e:nr(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=2,this.gl&&(this.gl=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(2&this.__dirty)},e.prototype.styleUpdated=function(){this.__dirty&=-3},e.prototype.createStyle=function(t){return Vr(sh,t)},e.prototype.useStyle=function(t){t[ah]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[ah]},e.prototype.Wa=function(e){t.prototype.Wa.call(this,e);var n=this.ja;e.style&&!n.style&&(n.style=this.yl(this.createStyle(),this.style)),this.qa(e,n,ch)},e.prototype.Xa=function(e,n,i,r,o,a){t.prototype.Xa.call(this,e,n,i,r,o,a);var s,l=!(n&&r);if(n&&n.style?o?r?s=n.style:(s=this.yl(this.createStyle(),i.style),this.yl(s,n.style)):(s=this.yl(this.createStyle(),r?this.style:i.style),this.yl(s,n.style)):l&&(s=i.style),s)if(o){var c=this.style;if(this.style=this.createStyle(l?{}:c),l)for(var h=dr(c),u=0;u<h.length;u++)(f=h[u])in s&&(s[f]=s[f],this.style[f]=c[f]);var d=dr(s);for(u=0;u<d.length;u++){var f=d[u];this.style[f]=this.style[f]}this.Qa(e,{style:s},a,this.getAnimationStyleProps())}else this.useStyle(s);var p=this.__inHover?hh:ch;for(u=0;u<p.length;u++)f=p[u],n&&null!=n[f]?this[f]=n[f]:l&&null!=i[f]&&(this[f]=i[f])},e.prototype.Za=function(e){for(var n,i=t.prototype.Za.call(this,e),r=0;r<e.length;r++){var o=e[r];o.style&&(n=n||{},this.yl(n,o.style))}return n&&(i.style=n),i},e.prototype.yl=function(t,e){return nr(t,e),t},e.prototype.getAnimationStyleProps=function(){return lh},e.initDefaultProps=function(){var t=e.prototype;t.type="displayable",t.invisible=!1,t.z=0,t.z2=0,t.zlevel=0,t.culling=!1,t.cursor="pointer",t.rectHover=!1,t.incremental=!1,t.gl=null,t.dirtyRectTolerance=0,t.__dirty=3}(),e}(Al),dh=new Jo(0,0,0,0),fh=new Jo(0,0,0,0),ph=Math.min,mh=Math.max,gh=Math.sin,vh=Math.cos,yh=2*Math.PI,bh=Wr(),xh=Wr(),wh=Wr();function Sh(t,e,n,i,r,o){r[0]=ph(t,n),r[1]=ph(e,i),o[0]=mh(t,n),o[1]=mh(e,i)}var Ch=[],Th=[];function $h(t,e,n,i,r,o,a,s,l,c){var h=Pa,u=Ea,d=h(t,n,r,a,Ch);l[0]=1/0,l[1]=1/0,c[0]=-1/0,c[1]=-1/0;for(var f=0;f<d;f++){var p=u(t,n,r,a,Ch[f]);l[0]=ph(p,l[0]),c[0]=mh(p,c[0])}for(d=h(e,i,o,s,Th),f=0;f<d;f++){var m=u(e,i,o,s,Th[f]);l[1]=ph(m,l[1]),c[1]=mh(m,c[1])}l[0]=ph(t,l[0]),c[0]=mh(t,c[0]),l[0]=ph(a,l[0]),c[0]=mh(a,c[0]),l[1]=ph(e,l[1]),c[1]=mh(e,c[1]),l[1]=ph(s,l[1]),c[1]=mh(s,c[1])}function Mh(t,e,n,i,r,o,a,s){var l=Ha,c=Ba,h=mh(ph(l(t,n,r),1),0),u=mh(ph(l(e,i,o),1),0),d=c(t,n,r,h),f=c(e,i,o,u);a[0]=ph(t,r,d),a[1]=ph(e,o,f),s[0]=mh(t,r,d),s[1]=mh(e,o,f)}function Ah(t,e,n,i,r,o,a,s,l){var c=no,h=io,u=Math.abs(r-o);if(u%yh<1e-4&&u>1e-4)return s[0]=t-n,s[1]=e-i,l[0]=t+n,void(l[1]=e+i);if(bh[0]=vh(r)*n+t,bh[1]=gh(r)*i+e,xh[0]=vh(o)*n+t,xh[1]=gh(o)*i+e,c(s,bh,xh),h(l,bh,xh),(r%=yh)<0&&(r+=yh),(o%=yh)<0&&(o+=yh),r>o&&!a?o+=yh:r<o&&a&&(r+=yh),a){var d=o;o=r,r=d}for(var f=0;f<o;f+=Math.PI/2)f>r&&(wh[0]=vh(f)*n+t,wh[1]=gh(f)*i+e,c(s,wh,s),h(l,wh,l))}var Nh={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},kh=[],Rh=[],_h=[],Ih=[],Fh=[],Eh=[],Dh=Math.min,Lh=Math.max,Ph=Math.cos,zh=Math.sin,Oh=Math.abs,Bh=Math.PI,Vh=2*Bh,Hh="undefined"!=typeof Float32Array,Uh=[];function qh(t){return Math.round(t/Bh*1e8)/1e8%2*Bh}function Kh(t,e){var n=qh(t[0]);n<0&&(n+=Vh);var i=n-t[0],r=t[1];r+=i,!e&&r-n>=Vh?r=n+Vh:e&&n-r>=Vh?r=n-Vh:!e&&n>r?r=n+(Vh-qh(n-r)):e&&n<r&&(r=n-(Vh-qh(r-n))),t[0]=n,t[1]=r}var Wh=function(){function t(t){this.dpr=1,this.wl=0,this.$l=0,this.Ml=0,this.Cl=0,this.sa=0,t&&(this.Sl=!1),this.Sl&&(this.data=[])}return t.prototype.increaseVersion=function(){this.Ei++},t.prototype.getVersion=function(){return this.Ei},t.prototype.setScale=function(t,e,n){(n=n||0)>0&&(this.Rl=Oh(n/Zs/t)||0,this.Al=Oh(n/Zs/e)||0)},t.prototype.setDPR=function(t){this.dpr=t},t.prototype.setContext=function(t){this.kl=t},t.prototype.getContext=function(){return this.kl},t.prototype.beginPath=function(){return this.kl&&this.kl.beginPath(),this.reset(),this},t.prototype.reset=function(){this.Sl&&(this.sa=0),this.Tl&&(this.Tl=null,this.Nl=0),this.Ei++},t.prototype.moveTo=function(t,e){return this.Fl(),this.addData(Nh.M,t,e),this.kl&&this.kl.moveTo(t,e),this.Ml=t,this.Cl=e,this.wl=t,this.$l=e,this},t.prototype.lineTo=function(t,e){var n=Oh(t-this.wl),i=Oh(e-this.$l),r=n>this.Rl||i>this.Al;if(this.addData(Nh.L,t,e),this.kl&&r&&this.kl.lineTo(t,e),r)this.wl=t,this.$l=e,this._l=0;else{var o=n*n+i*i;o>this._l&&(this.El=t,this.Il=e,this._l=o)}return this},t.prototype.bezierCurveTo=function(t,e,n,i,r,o){return this.Fl(),this.addData(Nh.C,t,e,n,i,r,o),this.kl&&this.kl.bezierCurveTo(t,e,n,i,r,o),this.wl=r,this.$l=o,this},t.prototype.quadraticCurveTo=function(t,e,n,i){return this.Fl(),this.addData(Nh.Q,t,e,n,i),this.kl&&this.kl.quadraticCurveTo(t,e,n,i),this.wl=n,this.$l=i,this},t.prototype.arc=function(t,e,n,i,r,o){this.Fl(),Uh[0]=i,Uh[1]=r,Kh(Uh,o),i=Uh[0];var a=(r=Uh[1])-i;return this.addData(Nh.A,t,e,n,n,i,a,0,o?0:1),this.kl&&this.kl.arc(t,e,n,i,r,o),this.wl=Ph(r)*n+t,this.$l=zh(r)*n+e,this},t.prototype.arcTo=function(t,e,n,i,r){return this.Fl(),this.kl&&this.kl.arcTo(t,e,n,i,r),this},t.prototype.rect=function(t,e,n,i){return this.Fl(),this.kl&&this.kl.rect(t,e,n,i),this.addData(Nh.R,t,e,n,i),this},t.prototype.closePath=function(){this.Fl(),this.addData(Nh.Z);var t=this.kl,e=this.Ml,n=this.Cl;return t&&t.closePath(),this.wl=e,this.$l=n,this},t.prototype.fill=function(t){t&&t.fill(),this.toStatic()},t.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},t.prototype.len=function(){return this.sa},t.prototype.setData=function(t){if(this.Sl){var e=t.length;this.data&&this.data.length===e||!Hh||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this.sa=e}},t.prototype.appendPath=function(t){if(this.Sl){t instanceof Array||(t=[t]);for(var e=t.length,n=0,i=this.sa,r=0;r<e;r++)n+=t[r].len();var o=this.data;if(Hh&&(o instanceof Float32Array||!o)&&(this.data=new Float32Array(i+n),i>0&&o))for(var a=0;a<i;a++)this.data[a]=o[a];for(r=0;r<e;r++){var s=t[r].data;for(a=0;a<s.length;a++)this.data[i++]=s[a]}this.sa=i}},t.prototype.addData=function(t,e,n,i,r,o,a,s,l){if(this.Sl){var c=this.data;this.sa+arguments.length>c.length&&(this.zl(),c=this.data);for(var h=0;h<arguments.length;h++)c[this.sa++]=arguments[h]}},t.prototype.Fl=function(){this._l>0&&(this.kl&&this.kl.lineTo(this.El,this.Il),this._l=0)},t.prototype.zl=function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this.sa;e++)t[e]=this.data[e];this.data=t}},t.prototype.toStatic=function(){if(this.Sl){this.Fl();var t=this.data;t instanceof Array&&(t.length=this.sa,Hh&&this.sa>11&&(this.data=new Float32Array(t)))}},t.prototype.getBoundingRect=function(){_h[0]=_h[1]=Fh[0]=Fh[1]=Number.MAX_VALUE,Ih[0]=Ih[1]=Eh[0]=Eh[1]=-Number.MAX_VALUE;var t,e=this.data,n=0,i=0,r=0,o=0;for(t=0;t<this.sa;){var a=e[t++],s=1===t;switch(s&&(r=n=e[t],o=i=e[t+1]),a){case Nh.M:n=r=e[t++],i=o=e[t++],Fh[0]=r,Fh[1]=o,Eh[0]=r,Eh[1]=o;break;case Nh.L:Sh(n,i,e[t],e[t+1],Fh,Eh),n=e[t++],i=e[t++];break;case Nh.C:$h(n,i,e[t++],e[t++],e[t++],e[t++],e[t],e[t+1],Fh,Eh),n=e[t++],i=e[t++];break;case Nh.Q:Mh(n,i,e[t++],e[t++],e[t],e[t+1],Fh,Eh),n=e[t++],i=e[t++];break;case Nh.A:var l=e[t++],c=e[t++],h=e[t++],u=e[t++],d=e[t++],f=e[t++]+d;t+=1;var p=!e[t++];s&&(r=Ph(d)*h+l,o=zh(d)*u+c),Ah(l,c,h,u,d,f,p,Fh,Eh),n=Ph(f)*h+l,i=zh(f)*u+c;break;case Nh.R:Sh(r=n=e[t++],o=i=e[t++],r+e[t++],o+e[t++],Fh,Eh);break;case Nh.Z:n=r,i=o}no(_h,_h,Fh),io(Ih,Ih,Eh)}return 0===t&&(_h[0]=_h[1]=Ih[0]=Ih[1]=0),new Jo(_h[0],_h[1],Ih[0]-_h[0],Ih[1]-_h[1])},t.prototype.Dl=function(){var t=this.data,e=this.sa,n=this.Rl,i=this.Al,r=0,o=0,a=0,s=0;this.Tl||(this.Tl=[]);for(var l=this.Tl,c=0,h=0,u=0;u<e;){var d=t[u++],f=1===u;f&&(a=r=t[u],s=o=t[u+1]);var p=-1;switch(d){case Nh.M:r=a=t[u++],o=s=t[u++];break;case Nh.L:var m=t[u++],g=(b=t[u++])-o;(Oh(k=m-r)>n||Oh(g)>i||u===e-1)&&(p=Math.sqrt(k*k+g*g),r=m,o=b);break;case Nh.C:var v=t[u++],y=t[u++],b=(m=t[u++],t[u++]),x=t[u++],w=t[u++];p=Oa(r,o,v,y,m,b,x,w,10),r=x,o=w;break;case Nh.Q:p=qa(r,o,v=t[u++],y=t[u++],m=t[u++],b=t[u++],10),r=m,o=b;break;case Nh.A:var S=t[u++],C=t[u++],T=t[u++],$=t[u++],M=t[u++],A=t[u++],N=A+M;u+=1,f&&(a=Ph(M)*T+S,s=zh(M)*$+C),p=Lh(T,$)*Dh(Vh,Math.abs(A)),r=Ph(N)*T+S,o=zh(N)*$+C;break;case Nh.R:a=r=t[u++],s=o=t[u++],p=2*t[u++]+2*t[u++];break;case Nh.Z:var k=a-r;g=s-o,p=Math.sqrt(k*k+g*g),r=a,o=s}p>=0&&(l[h++]=p,c+=p)}return this.Nl=c,c},t.prototype.rebuildPath=function(t,e){var n,i,r,o,a,s,l,c,h,u,d=this.data,f=this.Rl,p=this.Al,m=this.sa,g=e<1,v=0,y=0,b=0;if(!g||(this.Tl||this.Dl(),l=this.Tl,c=e*this.Nl))t:for(var x=0;x<m;){var w=d[x++],S=1===x;switch(S&&(n=r=d[x],i=o=d[x+1]),w!==Nh.L&&b>0&&(t.lineTo(h,u),b=0),w){case Nh.M:n=r=d[x++],i=o=d[x++],t.moveTo(r,o);break;case Nh.L:a=d[x++],s=d[x++];var C=Oh(a-r),T=Oh(s-o);if(C>f||T>p){if(g){if(v+(G=l[y++])>c){var $=(c-v)/G;t.lineTo(r*(1-$)+a*$,o*(1-$)+s*$);break t}v+=G}t.lineTo(a,s),r=a,o=s,b=0}else{var M=C*C+T*T;M>b&&(h=a,u=s,b=M)}break;case Nh.C:var A=d[x++],N=d[x++],k=d[x++],R=d[x++],_=d[x++],I=d[x++];if(g){if(v+(G=l[y++])>c){za(r,A,k,_,$=(c-v)/G,kh),za(o,N,R,I,$,Rh),t.bezierCurveTo(kh[1],Rh[1],kh[2],Rh[2],kh[3],Rh[3]);break t}v+=G}t.bezierCurveTo(A,N,k,R,_,I),r=_,o=I;break;case Nh.Q:if(A=d[x++],N=d[x++],k=d[x++],R=d[x++],g){if(v+(G=l[y++])>c){Ua(r,A,k,$=(c-v)/G,kh),Ua(o,N,R,$,Rh),t.quadraticCurveTo(kh[1],Rh[1],kh[2],Rh[2]);break t}v+=G}t.quadraticCurveTo(A,N,k,R),r=k,o=R;break;case Nh.A:var F=d[x++],E=d[x++],D=d[x++],L=d[x++],P=d[x++],z=d[x++],O=d[x++],B=!d[x++],V=D>L?D:L,H=Oh(D-L)>.001,U=P+z,q=!1;if(g&&(v+(G=l[y++])>c&&(U=P+z*(c-v)/G,q=!0),v+=G),H&&t.ellipse?t.ellipse(F,E,D,L,O,P,U,B):t.arc(F,E,V,P,U,B),q)break t;S&&(n=Ph(P)*D+F,i=zh(P)*L+E),r=Ph(U)*D+F,o=zh(U)*L+E;break;case Nh.R:n=r=d[x],i=o=d[x+1],a=d[x++],s=d[x++];var K=d[x++],W=d[x++];if(g){if(v+(G=l[y++])>c){var j=c-v;t.moveTo(a,s),t.lineTo(a+Dh(j,K),s),(j-=K)>0&&t.lineTo(a+K,s+Dh(j,W)),(j-=W)>0&&t.lineTo(a+Lh(K-j,0),s+W),(j-=K)>0&&t.lineTo(a,s+Lh(W-j,0));break t}v+=G}t.rect(a,s,K,W);break;case Nh.Z:if(g){var G;if(v+(G=l[y++])>c){$=(c-v)/G,t.lineTo(r*(1-$)+n*$,o*(1-$)+i*$);break t}v+=G}t.closePath(),r=n,o=i}}},t.prototype.clone=function(){var e=new t,n=this.data;return e.data=n.slice?n.slice():Array.prototype.slice.call(n),e.sa=this.sa,e},t.prototype.canSave=function(){return!!this.Sl},t.CMD=Nh,t.initDefaultProps=function(){var e=t.prototype;e.Sl=!0,e.Rl=0,e.Al=0,e._l=0,e.Ei=0}(),t}();function jh(t,e,n,i,r,o,a){if(0===r)return!1;var s,l=r;if(a>e+l&&a>i+l||a<e-l&&a<i-l||o>t+l&&o>n+l||o<t-l&&o<n-l)return!1;if(t===n)return Math.abs(o-t)<=l/2;var c=(s=(e-i)/(t-n))*o-a+(t*i-n*e)/(t-n);return c*c/(s*s+1)<=l/2*l/2}function Gh(t,e,n,i,r,o,a,s,l,c,h){if(0===l)return!1;var u=l;if(h>e+u&&h>i+u&&h>o+u&&h>s+u||h<e-u&&h<i-u&&h<o-u&&h<s-u||c>t+u&&c>n+u&&c>r+u&&c>a+u||c<t-u&&c<n-u&&c<r-u&&c<a-u)return!1;var d=function(t,e,n,i,r,o,a,s,l,c){var h,u,d,f,p,m=.005,g=1/0;ka[0]=l,ka[1]=c;for(var v=0;v<1;v+=.05)Ra[0]=Ea(t,n,r,a,v),Ra[1]=Ea(e,i,o,s,v),(f=Qr(ka,Ra))<g&&(h=v,g=f);g=1/0;for(var y=0;y<32&&!(m<Ma);y++)u=h-m,d=h+m,Ra[0]=Ea(t,n,r,a,u),Ra[1]=Ea(e,i,o,s,u),f=Qr(Ra,ka),u>=0&&f<g?(h=u,g=f):(_a[0]=Ea(t,n,r,a,d),_a[1]=Ea(e,i,o,s,d),p=Qr(_a,ka),d<=1&&p<g?(h=d,g=p):m*=.5);return $a(g)}(t,e,n,i,r,o,a,s,c,h);return d<=u/2}function Xh(t,e,n,i,r,o,a,s,l){if(0===a)return!1;var c=a;if(l>e+c&&l>i+c&&l>o+c||l<e-c&&l<i-c&&l<o-c||s>t+c&&s>n+c&&s>r+c||s<t-c&&s<n-c&&s<r-c)return!1;var h=function(t,e,n,i,r,o,a,s){var l,c=.005,h=1/0;ka[0]=a,ka[1]=s;for(var u=0;u<1;u+=.05)Ra[0]=Ba(t,n,r,u),Ra[1]=Ba(e,i,o,u),(m=Qr(ka,Ra))<h&&(l=u,h=m);h=1/0;for(var d=0;d<32&&!(c<Ma);d++){var f=l-c,p=l+c;Ra[0]=Ba(t,n,r,f),Ra[1]=Ba(e,i,o,f);var m=Qr(Ra,ka);if(f>=0&&m<h)l=f,h=m;else{_a[0]=Ba(t,n,r,p),_a[1]=Ba(e,i,o,p);var g=Qr(_a,ka);p<=1&&g<h?(l=p,h=g):c*=.5}}return $a(h)}(t,e,n,i,r,o,s,l);return h<=c/2}var Yh=2*Math.PI;function Zh(t){return(t%=Yh)<0&&(t+=Yh),t}var Jh=2*Math.PI;function Qh(t,e,n,i,r,o,a,s,l){if(0===a)return!1;var c=a;s-=t,l-=e;var h=Math.sqrt(s*s+l*l);if(h-c>n||h+c<n)return!1;if(Math.abs(i-r)%Jh<1e-4)return!0;if(o){var u=i;i=Zh(r),r=Zh(u)}else i=Zh(i),r=Zh(r);i>r&&(r+=Jh);var d=Math.atan2(l,s);return d<0&&(d+=Jh),d>=i&&d<=r||d+Jh>=i&&d+Jh<=r}function tu(t,e,n,i,r,o){if(o>e&&o>i||o<e&&o<i)return 0;if(i===e)return 0;var a=(o-e)/(i-e),s=i<e?1:-1;1!==a&&0!==a||(s=i<e?.5:-.5);var l=a*(n-t)+t;return l===r?1/0:l>r?s:0}var eu=Wh.CMD,nu=2*Math.PI,iu=[-1,-1,-1],ru=[-1,-1];function ou(){var t=ru[0];ru[0]=ru[1],ru[1]=t}function au(t,e,n,i,r,o,a,s,l,c){if(c>e&&c>i&&c>o&&c>s||c<e&&c<i&&c<o&&c<s)return 0;var h=La(e,i,o,s,c,iu);if(0===h)return 0;for(var u=0,d=-1,f=void 0,p=void 0,m=0;m<h;m++){var g=iu[m],v=0===g||1===g?.5:1;Ea(t,n,r,a,g)<l||(d<0&&(d=Pa(e,i,o,s,ru),ru[1]<ru[0]&&d>1&&ou(),f=Ea(e,i,o,s,ru[0]),d>1&&(p=Ea(e,i,o,s,ru[1]))),2===d?g<ru[0]?u+=f<e?v:-v:g<ru[1]?u+=p<f?v:-v:u+=s<p?v:-v:g<ru[0]?u+=f<e?v:-v:u+=s<f?v:-v)}return u}function su(t,e,n,i,r,o,a,s){if(s>e&&s>i&&s>o||s<e&&s<i&&s<o)return 0;var l=function(t,e,n,i,r){var o=t-2*e+n,a=2*(e-t),s=t-i,l=0;if(Ia(o))Fa(a)&&(h=-s/a)>=0&&h<=1&&(r[l++]=h);else{var c=a*a-4*o*s;if(Ia(c))(h=-a/(2*o))>=0&&h<=1&&(r[l++]=h);else if(c>0){var h,u=$a(c),d=(-a-u)/(2*o);(h=(-a+u)/(2*o))>=0&&h<=1&&(r[l++]=h),d>=0&&d<=1&&(r[l++]=d)}}return l}(e,i,o,s,iu);if(0===l)return 0;var c=Ha(e,i,o);if(c>=0&&c<=1){for(var h=0,u=Ba(e,i,o,c),d=0;d<l;d++){var f=0===iu[d]||1===iu[d]?.5:1;Ba(t,n,r,iu[d])<a||(iu[d]<c?h+=u<e?f:-f:h+=o<u?f:-f)}return h}return f=0===iu[0]||1===iu[0]?.5:1,Ba(t,n,r,iu[0])<a?0:o<e?f:-f}function lu(t,e,n,i,r,o,a,s){if((s-=e)>n||s<-n)return 0;var l=Math.sqrt(n*n-s*s);iu[0]=-l,iu[1]=l;var c=Math.abs(i-r);if(c<1e-4)return 0;if(c>=nu-1e-4){i=0,r=nu;var h=o?1:-1;return a>=iu[0]+t&&a<=iu[1]+t?h:0}if(i>r){var u=i;i=r,r=u}i<0&&(i+=nu,r+=nu);for(var d=0,f=0;f<2;f++){var p=iu[f];if(p+t>a){var m=Math.atan2(s,p);h=o?1:-1,m<0&&(m=nu+m),(m>=i&&m<=r||m+nu>=i&&m+nu<=r)&&(m>Math.PI/2&&m<1.5*Math.PI&&(h=-h),d+=h)}}return d}function cu(t,e,n,i,r){for(var o,a,s,l,c=t.data,h=t.len(),u=0,d=0,f=0,p=0,m=0,g=0;g<h;){var v=c[g++],y=1===g;switch(v===eu.M&&g>1&&(n||(u+=tu(d,f,p,m,i,r))),y&&(p=d=c[g],m=f=c[g+1]),v){case eu.M:d=p=c[g++],f=m=c[g++];break;case eu.L:if(n){if(jh(d,f,c[g],c[g+1],e,i,r))return!0}else u+=tu(d,f,c[g],c[g+1],i,r)||0;d=c[g++],f=c[g++];break;case eu.C:if(n){if(Gh(d,f,c[g++],c[g++],c[g++],c[g++],c[g],c[g+1],e,i,r))return!0}else u+=au(d,f,c[g++],c[g++],c[g++],c[g++],c[g],c[g+1],i,r)||0;d=c[g++],f=c[g++];break;case eu.Q:if(n){if(Xh(d,f,c[g++],c[g++],c[g],c[g+1],e,i,r))return!0}else u+=su(d,f,c[g++],c[g++],c[g],c[g+1],i,r)||0;d=c[g++],f=c[g++];break;case eu.A:var b=c[g++],x=c[g++],w=c[g++],S=c[g++],C=c[g++],T=c[g++];g+=1;var $=!!(1-c[g++]);o=Math.cos(C)*w+b,a=Math.sin(C)*S+x,y?(p=o,m=a):u+=tu(d,f,o,a,i,r);var M=(i-b)*S/w+b;if(n){if(Qh(b,x,S,C,C+T,$,e,M,r))return!0}else u+=lu(b,x,S,C,C+T,$,M,r);d=Math.cos(C+T)*w+b,f=Math.sin(C+T)*S+x;break;case eu.R:if(p=d=c[g++],m=f=c[g++],o=p+c[g++],a=m+c[g++],n){if(jh(p,m,o,m,e,i,r)||jh(o,m,o,a,e,i,r)||jh(o,a,p,a,e,i,r)||jh(p,a,p,m,e,i,r))return!0}else u+=tu(o,m,o,a,i,r),u+=tu(p,a,p,m,i,r);break;case eu.Z:if(n){if(jh(d,f,p,m,e,i,r))return!0}else u+=tu(d,f,p,m,i,r);d=p,f=m}}return n||(s=f,l=m,Math.abs(s-l)<1e-4)||(u+=tu(d,f,p,m,i,r)||0),0!==u}var hu=ir({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},sh),uu={style:ir({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},lh.style)},du=ll.concat(["invisible","culling","z","z2","zlevel","parent"]),fu=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.update=function(){var n=this;t.prototype.update.call(this);var i=this.style;if(i.decal){var r=this.Ll=this.Ll||new e;r.buildPath===e.prototype.buildPath&&(r.buildPath=function(t){n.buildPath(t,n.shape)}),r.silent=!0;var o=r.style;for(var a in i)o[a]!==i[a]&&(o[a]=i[a]);o.fill=i.fill?i.decal:null,o.decal=null,o.shadowColor=null,i.strokeFirst&&(o.stroke=null);for(var s=0;s<du.length;++s)r[du[s]]=this[du[s]];r.__dirty|=1}else this.Ll&&(this.Ll=null)},e.prototype.getDecalElement=function(){return this.Ll},e.prototype.J=function(e){var n=dr(e);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var r=0;r<n.length;r++){var o=n[r],a=e[o];"style"===o?this.style?nr(this.style,a):this.useStyle(a):"shape"===o?nr(this.shape,a):t.prototype.attrKV.call(this,o,a)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if("none"!==t){if(vr(t)){var e=gs(t,0);return e>.5?Js:e>.2?"#eee":Qs}if(t)return Qs}return Js},e.prototype.getInsideTextStroke=function(t){var e=this.style.fill;if(vr(e)){var n=this.__zr;if(!(!n||!n.isDarkMode())==gs(t,0)<.4)return e}},e.prototype.buildPath=function(t,e,n){},e.prototype.pathUpdated=function(){this.__dirty&=-5},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new Wh(!1)},e.prototype.hasStroke=function(){var t=this.style,e=t.stroke;return!(null==e||"none"===e||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.getBoundingRect=function(){var t=this.gl,e=this.style,n=!t;if(n){var i=!1;this.path||(i=!0,this.createPathProxy());var r=this.path;(i||4&this.__dirty)&&(r.beginPath(),this.buildPath(r,this.shape,!1),this.pathUpdated()),t=r.getBoundingRect()}if(this.gl=t,this.hasStroke()&&this.path&&this.path.len()>0){var o=this.Ol||(this.Ol=t.clone());if(this.__dirty||n){o.copy(t);var a=e.strokeNoScale?this.getLineScale():1,s=e.lineWidth;if(!this.hasFill()){var l=this.strokeContainThreshold;s=Math.max(s,l??4)}a>1e-10&&(o.width+=s/a,o.height+=s/a,o.x-=s/a/2,o.y-=s/a/2)}return o}return t},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect(),r=this.style;if(t=n[0],e=n[1],i.contain(t,e)){var o=this.path;if(this.hasStroke()){var a=r.lineWidth,s=r.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),function(t,e,n,i){return cu(t,e,!0,n,i)}(o,a/s,t,e)))return!0}if(this.hasFill())return function(t,e,n){return cu(t,0,!1,e,n)}(o,t,e)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=4,this.gl&&(this.gl=null),this.Ll&&this.Ll.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():"shape"===t?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(e,n){"shape"===e?this.setShape(n):t.prototype.attrKV.call(this,e,n)},e.prototype.setShape=function(t,e){var n=this.shape;return n||(n=this.shape={}),"string"==typeof t?n[t]=e:nr(n,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(4&this.__dirty)},e.prototype.createStyle=function(t){return Vr(hu,t)},e.prototype.Wa=function(e){t.prototype.Wa.call(this,e);var n=this.ja;e.shape&&!n.shape&&(n.shape=nr({},this.shape))},e.prototype.Xa=function(e,n,i,r,o,a){t.prototype.Xa.call(this,e,n,i,r,o,a);var s,l=!(n&&r);if(n&&n.shape?o?r?s=n.shape:(s=nr({},i.shape),nr(s,n.shape)):(s=nr({},r?this.shape:i.shape),nr(s,n.shape)):l&&(s=i.shape),s)if(o){this.shape=nr({},this.shape);for(var c={},h=dr(s),u=0;u<h.length;u++){var d=h[u];"object"==typeof s[d]?this.shape[d]=s[d]:c[d]=s[d]}this.Qa(e,{shape:c},a)}else this.shape=s,this.dirtyShape()},e.prototype.Za=function(e){for(var n,i=t.prototype.Za.call(this,e),r=0;r<e.length;r++){var o=e[r];o.shape&&(n=n||{},this.yl(n,o.shape))}return n&&(i.shape=n),i},e.prototype.getAnimationStyleProps=function(){return uu},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var n=function(e){function n(n){var i=e.call(this,n)||this;return t.init&&t.init.call(i,n),i}return Ei(n,e),n.prototype.getDefaultStyle=function(){return tr(t.style)},n.prototype.getDefaultShape=function(){return tr(t.shape)},n}(e);for(var i in t)"function"==typeof t[i]&&(n.prototype[i]=t[i]);return n},e.initDefaultProps=function(){var t=e.prototype;t.type="path",t.strokeContainThreshold=5,t.segmentIgnoreThreshold=0,t.subPixelOptimize=!1,t.autoBatch=!1,t.__dirty=7}(),e}(uh),pu=ir({strokeFirst:!0,font:Pi,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},hu),mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.hasStroke=function(){return oh(this.style)},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.createStyle=function(t){return Vr(pu,t)},e.prototype.setBoundingRect=function(t){this.gl=t},e.prototype.getBoundingRect=function(){return this.gl||(this.gl=function(t){var e=ih(t.text),n=t.font;return rh(t,fl(hl(n),e),yl(n),null)}(this.style)),this.gl},e.initDefaultProps=void(e.prototype.dirtyRectTolerance=10),e}(uh);mu.prototype.type="tspan";var gu=ir({x:0,y:0},sh),vu={style:ir({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},lh.style)},yu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.createStyle=function(t){return Vr(gu,t)},e.prototype.Pl=function(t){var e=this.style,n=e[t];if(null!=n)return n;var i,r=(i=e.image)&&"string"!=typeof i&&i.width&&i.height?e.image:this.__image;if(!r)return 0;var o="width"===t?"height":"width",a=e[o];return null==a?r[t]:r[t]/r[o]*a},e.prototype.getWidth=function(){return this.Pl("width")},e.prototype.getHeight=function(){return this.Pl("height")},e.prototype.getAnimationStyleProps=function(){return vu},e.prototype.getBoundingRect=function(){var t=this.style;return this.gl||(this.gl=new Jo(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this.gl},e}(uh);yu.prototype.type="image";var bu=Math.round;function xu(t,e,n){if(e){var i=e.x1,r=e.x2,o=e.y1,a=e.y2;t.x1=i,t.x2=r,t.y1=o,t.y2=a;var s=n&&n.lineWidth;return s?(bu(2*i)===bu(2*r)&&(t.x1=t.x2=Su(i,s,!0)),bu(2*o)===bu(2*a)&&(t.y1=t.y2=Su(o,s,!0)),t):t}}function wu(t,e,n){if(e){var i=e.x,r=e.y,o=e.width,a=e.height;t.x=i,t.y=r,t.width=o,t.height=a;var s=n&&n.lineWidth;return s?(t.x=Su(i,s,!0),t.y=Su(r,s,!0),t.width=Math.max(Su(i+o,s,!1)-t.x,0===o?0:1),t.height=Math.max(Su(r+a,s,!1)-t.y,0===a?0:1),t):t}}function Su(t,e,n){if(!e)return t;var i=bu(2*t);return(i+bu(e))%2==0?i/2:(i+(n?1:-1))/2}var Cu=function(){this.x=0,this.y=0,this.width=0,this.height=0},Tu={},$u=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultShape=function(){return new Cu},e.prototype.buildPath=function(t,e){var n,i,r,o;if(this.subPixelOptimize){var a=wu(Tu,e,this.style);n=a.x,i=a.y,r=a.width,o=a.height,a.r=e.r,e=a}else n=e.x,i=e.y,r=e.width,o=e.height;e.r?function(t,e){var n,i,r,o,a,s=e.x,l=e.y,c=e.width,h=e.height,u=e.r;c<0&&(s+=c,c=-c),h<0&&(l+=h,h=-h),"number"==typeof u?n=i=r=o=u:u instanceof Array?1===u.length?n=i=r=o=u[0]:2===u.length?(n=r=u[0],i=o=u[1]):3===u.length?(n=u[0],i=o=u[1],r=u[2]):(n=u[0],i=u[1],r=u[2],o=u[3]):n=i=r=o=0,n+i>c&&(n*=c/(a=n+i),i*=c/a),r+o>c&&(r*=c/(a=r+o),o*=c/a),i+r>h&&(i*=h/(a=i+r),r*=h/a),n+o>h&&(n*=h/(a=n+o),o*=h/a),t.moveTo(s+n,l),t.lineTo(s+c-i,l),0!==i&&t.arc(s+c-i,l+i,i,-Math.PI/2,0),t.lineTo(s+c,l+h-r),0!==r&&t.arc(s+c-r,l+h-r,r,0,Math.PI/2),t.lineTo(s+o,l+h),0!==o&&t.arc(s+o,l+h-o,o,Math.PI/2,Math.PI),t.lineTo(s,l+n),0!==n&&t.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}(t,e):t.rect(n,i,r,o)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(fu);$u.prototype.type="rect";var Mu={fill:"#000"},Au={},Nu={style:ir({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},lh.style)},ku=function(t){function e(e){var n=t.call(this)||this;return n.type="text",n.rl=[],n.Vl=Mu,n.attr(e),n}return Ei(e,t),e.prototype.childrenRef=function(){return this.rl},e.prototype.update=function(){t.prototype.update.call(this),this.styleChanged()&&this.Bl();for(var e=0;e<this.rl.length;e++){var n=this.rl[e];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},e.prototype.updateTransform=function(){var e=this.innerTransformable;e?(e.updateTransform(),e.transform&&(this.transform=e.transform)):t.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(e){var n=this.innerTransformable;return n?n.getLocalTransform(e):t.prototype.getLocalTransform.call(this,e)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),t.prototype.getComputedTransform.call(this)},e.prototype.Bl=function(){var t;this.Hl=0,Eu(t=this.style),sr(t.rich,Eu),this.style.rich?this.Ul():this.Kl(),this.rl.length=this.Hl,this.styleUpdated()},e.prototype.addSelfToZr=function(e){t.prototype.addSelfToZr.call(this,e);for(var n=0;n<this.rl.length;n++)this.rl[n].__zr=e},e.prototype.removeSelfFromZr=function(e){t.prototype.removeSelfFromZr.call(this,e);for(var n=0;n<this.rl.length;n++)this.rl[n].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this.Bl(),!this.gl){for(var t=new Jo(0,0,0,0),e=this.rl,n=[],i=null,r=0;r<e.length;r++){var o=e[r],a=o.getBoundingRect(),s=o.getLocalTransform(n);s?(t.copy(a),t.applyTransform(s),(i=i||t.clone()).union(t)):(i=i||a.clone()).union(a)}this.gl=i||t}return this.gl},e.prototype.setDefaultTextStyle=function(t){this.Vl=t||Mu},e.prototype.setTextContent=function(t){},e.prototype.yl=function(t,e){if(!e)return t;var n=e.rich,i=t.rich||n&&{};return nr(t,e),n&&i?(this.Wl(i,n),t.rich=i):i&&(t.rich=i),t},e.prototype.Wl=function(t,e){for(var n=dr(e),i=0;i<n.length;i++){var r=n[i];t[r]=t[r]||{},nr(t[r],e[r])}},e.prototype.getAnimationStyleProps=function(){return Nu},e.prototype.jl=function(t){var e=this.rl[this.Hl];return e&&e instanceof t||(e=new t),this.rl[this.Hl++]=e,e.__zr=this.__zr,e.parent=this,e},e.prototype.Kl=function(){var t=this.style,e=t.font||Pi,n=t.padding,i=this.Vl,r=t.x||0,o=t.y||0,a=t.align||i.align||"left",s=t.verticalAlign||i.verticalAlign||"top";th(Au,i.overflowRect,r,o,a,s),r=Au.baseX,o=Au.baseY;var l=function(t,e,n,i){var r=ih(t),o=e.overflow,a=e.padding,s=a?a[1]+a[3]:0,l=a?a[0]+a[2]:0,c=e.font,h="truncate"===o,u=yl(c),d=Ar(e.lineHeight,u),f="truncate"===e.lineOverflow,p=!1,m=e.width;null==m&&null!=n&&(m=n-s);var g,v=e.height;null==v&&null!=i&&(v=i-l);var y=(g=null==m||"break"!==o&&"breakAll"!==o?r?r.split("\n"):[]:r?Qc(r,e.font,m,"breakAll"===o,0).lines:[]).length*d;if(null==v&&(v=y),y>v&&f){var b=Math.floor(v/d);p=p||g.length>b,y=(g=g.slice(0,b)).length*d}if(r&&h&&null!=m)for(var x=qc(m,c,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),w={},S=0;S<g.length;S++)Kc(w,g[S],x),g[S]=w.textLine,p=p||w.isTruncated;var C=v,T=0,$=hl(c);for(S=0;S<g.length;S++)T=Math.max(fl($,g[S]),T);null==m&&(m=T);var M=m;return{lines:g,height:v,outerWidth:M+=s,outerHeight:C+=l,lineHeight:d,calculatedLineHeight:u,contentWidth:T,contentHeight:y,width:m,isTruncated:p}}(zu(t),t,Au.outerWidth,Au.outerHeight),c=Ou(t),h=!!t.backgroundColor,u=l.outerHeight,d=l.outerWidth,f=l.lines,p=l.lineHeight;this.isTruncated=!!l.isTruncated;var m=r,g=vl(o,l.contentHeight,s);if(c||n){var v=gl(r,d,a),y=vl(o,u,s);c&&this.ql(t,t,v,y,d,u)}g+=p/2,n&&(m=Pu(r,a,n),"top"===s?g+=n[0]:"bottom"===s&&(g-=n[2]));for(var b=0,x=!1,w=!1,S=(Lu("fill"in t?t.fill:(w=!0,i.fill))),C=(Du("stroke"in t?t.stroke:h||i.autoStroke&&!w?null:(b=2,x=!0,i.stroke))),T=t.textShadowBlur>0,$=0;$<f.length;$++){var M=this.jl(mu),A=M.createStyle();M.useStyle(A),A.text=f[$],A.x=m,A.y=g,A.textAlign=a,A.textBaseline="middle",A.opacity=t.opacity,A.strokeFirst=!0,T&&(A.shadowBlur=t.textShadowBlur||0,A.shadowColor=t.textShadowColor||"transparent",A.shadowOffsetX=t.textShadowOffsetX||0,A.shadowOffsetY=t.textShadowOffsetY||0),A.stroke=C,A.fill=S,C&&(A.lineWidth=t.lineWidth||b,A.lineDash=t.lineDash,A.lineDashOffset=t.lineDashOffset||0),A.font=e,Fu(A,t),g+=p,M.setBoundingRect(rh(A,l.contentWidth,l.calculatedLineHeight,x?0:null))}},e.prototype.Ul=function(){var t=this.style,e=this.Vl,n=t.align||e.align,i=t.verticalAlign||e.verticalAlign,r=t.x||0,o=t.y||0;th(Au,e.overflowRect,r,o,n,i),r=Au.baseX,o=Au.baseY;var a=function(t,e,n,i,r){var o=new Xc,a=ih(t);if(!a)return o;var s=e.padding,l=s?s[1]+s[3]:0,c=s?s[0]+s[2]:0,h=e.width;null==h&&null!=n&&(h=n-l);var u=e.height;null==u&&null!=i&&(u=i-c);for(var d,f=e.overflow,p="break"!==f&&"breakAll"!==f||null==h?null:{width:h,accumWidth:0,breakAll:"breakAll"===f},m=Hc.lastIndex=0;null!=(d=Hc.exec(a));){var g=d.index;g>m&&Yc(o,a.substring(m,g),e,p),Yc(o,d[2],e,p,d[1]),m=Hc.lastIndex}m<a.length&&Yc(o,a.substring(m,a.length),e,p);var v=[],y=0,b=0,x="truncate"===f,w="truncate"===e.lineOverflow,S={};function C(t,e,n){t.width=e,t.lineHeight=n,y+=n,b=Math.max(b,e)}t:for(var T=0;T<o.lines.length;T++){for(var $=o.lines[T],M=0,A=0,N=0;N<$.tokens.length;N++){var k=(B=$.tokens[N]).styleName&&e.rich[B.styleName]||{},R=B.textPadding=k.padding,_=R?R[1]+R[3]:0,I=B.font=k.font||e.font;B.contentHeight=yl(I);var F=Ar(k.height,B.contentHeight);if(B.innerHeight=F,R&&(F+=R[0]+R[2]),B.height=F,B.lineHeight=Nr(k.lineHeight,e.lineHeight,F),B.align=k&&k.align||r,B.verticalAlign=k&&k.verticalAlign||"middle",w&&null!=u&&y+B.lineHeight>u){var E=o.lines.length;N>0?($.tokens=$.tokens.slice(0,N),C($,A,M),o.lines=o.lines.slice(0,T+1)):o.lines=o.lines.slice(0,T),o.isTruncated=o.isTruncated||o.lines.length<E;break t}var D=k.width,L=null==D||"auto"===D;if("string"==typeof D&&"%"===D.charAt(D.length-1))B.percentWidth=D,v.push(B),B.contentWidth=fl(hl(I),B.text);else{if(L){var P=k.backgroundColor,z=P&&P.image;z&&Vc(z=zc(z))&&(B.width=Math.max(B.width,z.width*F/z.height))}var O=x&&null!=h?h-A:null;null!=O&&O<B.width?!L||O<_?(B.text="",B.width=B.contentWidth=0):(Uc(S,B.text,O-_,I,e.ellipsis,{minChar:e.truncateMinChar}),B.text=S.text,o.isTruncated=o.isTruncated||S.isTruncated,B.width=B.contentWidth=fl(hl(I),B.text)):B.contentWidth=fl(hl(I),B.text)}B.width+=_,A+=B.width,k&&(M=Math.max(M,B.lineHeight))}C($,A,M)}for(o.outerWidth=o.width=Ar(h,b),o.outerHeight=o.height=Ar(u,y),o.contentHeight=y,o.contentWidth=b,o.outerWidth+=l,o.outerHeight+=c,T=0;T<v.length;T++){var B,V=(B=v[T]).percentWidth;B.width=parseInt(V,10)/100*o.width}return o}(zu(t),t,Au.outerWidth,Au.outerHeight,n),s=a.width,l=a.outerWidth,c=a.outerHeight,h=t.padding;this.isTruncated=!!a.isTruncated;var u=gl(r,l,n),d=vl(o,c,i),f=u,p=d;h&&(f+=h[3],p+=h[0]);var m=f+s;Ou(t)&&this.ql(t,t,u,d,l,c);for(var g=!!t.backgroundColor,v=0;v<a.lines.length;v++){for(var y=a.lines[v],b=y.tokens,x=b.length,w=y.lineHeight,S=y.width,C=0,T=f,$=m,M=x-1,A=void 0;C<x&&(!(A=b[C]).align||"left"===A.align);)this.Gl(A,t,w,p,T,"left",g),S-=A.width,T+=A.width,C++;for(;M>=0&&"right"===(A=b[M]).align;)this.Gl(A,t,w,p,$,"right",g),S-=A.width,$-=A.width,M--;for(T+=(s-(T-f)-(m-$)-S)/2;C<=M;)A=b[C],this.Gl(A,t,w,p,T+A.width/2,"center",g),T+=A.width,C++;p+=w}},e.prototype.Gl=function(t,e,n,i,r,o,a){var s=e.rich[t.styleName]||{};s.text=t.text;var l=t.verticalAlign,c=i+n/2;"top"===l?c=i+t.height/2:"bottom"===l&&(c=i+n-t.height/2),!t.isLineHolder&&Ou(s)&&this.ql(s,e,"right"===o?r-t.width:"center"===o?r-t.width/2:r,c-t.height/2,t.width,t.height);var h=!!s.backgroundColor,u=t.textPadding;u&&(r=Pu(r,o,u),c-=t.height/2-u[0]-t.innerHeight/2);var d=this.jl(mu),f=d.createStyle();d.useStyle(f);var p=this.Vl,m=!1,g=0,v=!1,y=Lu("fill"in s?s.fill:"fill"in e?e.fill:(m=!0,p.fill)),b=Du("stroke"in s?s.stroke:"stroke"in e?e.stroke:h||a||p.autoStroke&&!m?null:(g=2,v=!0,p.stroke)),x=s.textShadowBlur>0||e.textShadowBlur>0;f.text=t.text,f.x=r,f.y=c,x&&(f.shadowBlur=s.textShadowBlur||e.textShadowBlur||0,f.shadowColor=s.textShadowColor||e.textShadowColor||"transparent",f.shadowOffsetX=s.textShadowOffsetX||e.textShadowOffsetX||0,f.shadowOffsetY=s.textShadowOffsetY||e.textShadowOffsetY||0),f.textAlign=o,f.textBaseline="middle",f.font=t.font||Pi,f.opacity=Nr(s.opacity,e.opacity,1),Fu(f,s),b&&(f.lineWidth=Nr(s.lineWidth,e.lineWidth,g),f.lineDash=Ar(s.lineDash,e.lineDash),f.lineDashOffset=e.lineDashOffset||0,f.stroke=b),y&&(f.fill=y),d.setBoundingRect(rh(f,t.contentWidth,t.contentHeight,v?0:null))},e.prototype.ql=function(t,e,n,i,r,o){var a,s,l,c=t.backgroundColor,h=t.borderWidth,u=t.borderColor,d=c&&c.image,f=c&&!d,p=t.borderRadius,m=this;if(f||t.lineHeight||h&&u){(a=this.jl($u)).useStyle(a.createStyle()),a.style.fill=null;var g=a.shape;g.x=n,g.y=i,g.width=r,g.height=o,g.r=p,a.dirtyShape()}if(f)(l=a.style).fill=c||null,l.fillOpacity=Ar(t.fillOpacity,1);else if(d){(s=this.jl(yu)).onload=function(){m.dirtyStyle()};var v=s.style;v.image=c.image,v.x=n,v.y=i,v.width=r,v.height=o}h&&u&&((l=a.style).lineWidth=h,l.stroke=u,l.strokeOpacity=Ar(t.strokeOpacity,1),l.lineDash=t.borderDash,l.lineDashOffset=t.borderDashOffset||0,a.strokeContainThreshold=0,a.hasFill()&&a.hasStroke()&&(l.strokeFirst=!0,l.lineWidth*=2));var y=(a||s).style;y.shadowBlur=t.shadowBlur||0,y.shadowColor=t.shadowColor||"transparent",y.shadowOffsetX=t.shadowOffsetX||0,y.shadowOffsetY=t.shadowOffsetY||0,y.opacity=Nr(t.opacity,e.opacity,1)},e.makeFont=function(t){var e,n="";return function(t){return null!=t.fontSize||t.fontFamily||t.fontWeight}(t)&&(n=[t.fontStyle,t.fontWeight,(e=t.fontSize,"string"!=typeof e||-1===e.indexOf("px")&&-1===e.indexOf("rem")&&-1===e.indexOf("em")?isNaN(+e)?"12px":e+"px":e),t.fontFamily||"sans-serif"].join(" ")),n&&Ir(n)||t.textFont||t.font},e}(uh),Ru={left:!0,right:1,center:1},_u={top:1,bottom:1,middle:1},Iu=["fontStyle","fontWeight","fontSize","fontFamily"];function Fu(t,e){for(var n=0;n<Iu.length;n++){var i=Iu[n],r=e[i];null!=r&&(t[i]=r)}}function Eu(t){if(t){t.font=ku.makeFont(t);var e=t.align;"middle"===e&&(e="center"),t.align=null==e||Ru[e]?e:"left";var n=t.verticalAlign;"center"===n&&(n="middle"),t.verticalAlign=null==n||_u[n]?n:"top",t.padding&&(t.padding=Rr(t.padding))}}function Du(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function Lu(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function Pu(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}function zu(t){var e=t.text;return null!=e&&(e+=""),e}function Ou(t){return!!(t.backgroundColor||t.lineHeight||t.borderWidth&&t.borderColor)}var Bu=yc(),Vu=1,Hu={},Uu=yc(),qu=yc(),Ku=["emphasis","blur","select"],Wu=["normal","emphasis","blur","select"],ju="highlight",Gu="downplay",Xu="select",Yu="unselect",Zu="toggleSelect",Ju="selectchanged";function Qu(t){return null!=t&&"none"!==t}function td(t,e,n){t.onHoverStateChange&&(t.hoverState||0)!==n&&t.onHoverStateChange(e),t.hoverState=n}function ed(t){td(t,"emphasis",2)}function nd(t){2===t.hoverState&&td(t,"normal",0)}function id(t){td(t,"blur",1)}function rd(t){1===t.hoverState&&td(t,"normal",0)}function od(t){t.selected=!0}function ad(t){t.selected=!1}function sd(t,e,n){e(t,n)}function ld(t,e,n){sd(t,e,n),t.isGroup&&t.traverse(function(t){sd(t,e,n)})}function cd(t,e){switch(e){case"emphasis":t.hoverState=2;break;case"normal":t.hoverState=0;break;case"blur":t.hoverState=1;break;case"select":t.selected=!0}}function hd(t,e){var n=this.states[t];if(this.style){if("emphasis"===t)return function(t,e,n,i){var r=n&&rr(n,"select")>=0,o=!1;if(t instanceof fu){var a=Uu(t),s=r&&a.selectFill||a.normalFill,l=r&&a.selectStroke||a.normalStroke;if(Qu(s)||Qu(l)){var c=(i=i||{}).style||{};"inherit"===c.fill?(o=!0,i=nr({},i),(c=nr({},c)).fill=s):!Qu(c.fill)&&Qu(s)?(o=!0,i=nr({},i),(c=nr({},c)).fill=ys(s)):!Qu(c.stroke)&&Qu(l)&&(o||(i=nr({},i),c=nr({},c)),c.stroke=ys(l)),i.style=c}}if(i&&null==i.z2){o||(i=nr({},i));var h=t.z2EmphasisLift;i.z2=t.z2+(null!=h?h:10)}return i}(this,0,e,n);if("blur"===t)return function(t,e,n){var i=rr(t.currentStates,e)>=0,r=t.style.opacity,o=i?null:function(t,e,n,i){for(var r=t.style,o={},a=0;a<e.length;a++){var s=e[a],l=r[s];o[s]=l??(i&&i[s])}for(a=0;a<t.animators.length;a++){var c=t.animators[a];c.__fromStateTransition&&c.__fromStateTransition.indexOf(n)<0&&"style"===c.targetName&&c.saveTo(o,e)}return o}(t,["opacity"],e,{opacity:1}),a=(n=n||{}).style||{};return null==a.opacity&&(n=nr({},n),a=nr({opacity:i?r:.1*o.opacity},a),n.style=a),n}(this,t,n);if("select"===t)return function(t,e,n){if(n&&null==n.z2){n=nr({},n);var i=t.z2SelectLift;n.z2=t.z2+(null!=i?i:9)}return n}(this,0,n)}return n}function ud(t){t.stateProxy=hd;var e=t.getTextContent(),n=t.getTextGuideLine();e&&(e.stateProxy=hd),n&&(n.stateProxy=hd)}function dd(t,e){!bd(t,e)&&!t.__highByOuter&&ld(t,ed)}function fd(t,e){!bd(t,e)&&!t.__highByOuter&&ld(t,nd)}function pd(t,e){t.__highByOuter|=1<<(e||0),ld(t,ed)}function md(t,e){!(t.__highByOuter&=~(1<<(e||0)))&&ld(t,nd)}function gd(t){ld(t,rd)}function vd(t){ld(t,od)}function yd(t){ld(t,ad)}function bd(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function xd(t){var e=t.getModel(),n=[],i=[];e.eachComponent(function(e,r){var o=qu(r),a="series"===e,s=a?t.getViewOfSeriesModel(r):t.getViewOfComponentModel(r);!a&&i.push(s),o.isBlured&&(s.group.traverse(function(t){rd(t)}),a&&n.push(r)),o.isBlured=!1}),sr(i,function(t){t&&t.toggleBlurSeries&&t.toggleBlurSeries(n,!1,e)})}function wd(t,e,n,i){var r=i.getModel();function o(t,e){for(var n=0;n<e.length;n++){var i=t.getItemGraphicEl(e[n]);i&&gd(i)}}if(n=n||"coordinateSystem",null!=t&&e&&"none"!==e){var a=r.getSeriesByIndex(t),s=a.coordinateSystem;s&&s.master&&(s=s.master);var l=[];r.eachSeries(function(t){var r=a===t,c=t.coordinateSystem;if(c&&c.master&&(c=c.master),!("series"===n&&!r||"coordinateSystem"===n&&!(c&&s?c===s:r)||"series"===e&&r)){if(i.getViewOfSeriesModel(t).group.traverse(function(t){t.__highByOuter&&r&&"self"===e||id(t)}),ar(e))o(t.getData(),e);else if(xr(e))for(var h=dr(e),u=0;u<h.length;u++)o(t.getData(h[u]),e[h[u]]);l.push(t),qu(t).isBlured=!0}}),r.eachComponent(function(t,e){if("series"!==t){var n=i.getViewOfComponentModel(e);n&&n.toggleBlurSeries&&n.toggleBlurSeries(l,!0,r)}})}}function Sd(t,e,n){if(null!=t&&null!=e){var i=n.getModel().getComponent(t,e);if(i){qu(i).isBlured=!0;var r=n.getViewOfComponentModel(i);r&&r.focusBlurEnabled&&r.group.traverse(function(t){id(t)})}}}function Cd(t,e,n,i){var r={focusSelf:!1,dispatchers:null};if(null==t||"series"===t||null==e||null==n)return r;var o=i.getModel().getComponent(t,e);if(!o)return r;var a=i.getViewOfComponentModel(o);if(!a||!a.findHighDownDispatchers)return r;for(var s,l=a.findHighDownDispatchers(n),c=0;c<l.length;c++)if("self"===Bu(l[c]).focus){s=!0;break}return{focusSelf:s,dispatchers:l}}function Td(t){sr(t.getAllData(),function(e){var n=e.data,i=e.type;n.eachItemGraphicEl(function(e,n){t.isSelected(n,i)?vd(e):yd(e)})})}function $d(t){var e=[];return t.eachSeries(function(t){sr(t.getAllData(),function(n){n.data;var i=n.type,r=t.getSelectedDataIndices();if(r.length>0){var o={dataIndex:r,seriesIndex:t.seriesIndex};null!=i&&(o.dataType=i),e.push(o)}})}),e}function Md(t,e,n){Id(t,!0),ld(t,ud),Nd(t,e,n)}function Ad(t,e,n,i){i?function(t){Id(t,!1)}(t):Md(t,e,n)}function Nd(t,e,n){var i=Bu(t);null!=e?(i.focus=e,i.blurScope=n):i.focus&&(i.focus=null)}var kd=["emphasis","blur","select"],Rd={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function _d(t,e,n,i){n=n||"itemStyle";for(var r=0;r<kd.length;r++){var o=kd[r],a=e.getModel([o,n]);t.ensureState(o).style=a[Rd[n]]()}}function Id(t,e){var n=!1===e,i=t;t.highDownSilentOnTouch&&(i.__highDownSilentOnTouch=t.highDownSilentOnTouch),n&&!i.__highDownDispatcher||(i.__highByOuter=i.__highByOuter||0,i.__highDownDispatcher=!n)}function Fd(t){return!(!t||!t.__highDownDispatcher)}function Ed(t){var e=t.type;return e===Xu||e===Yu||e===Zu}function Dd(t){var e=t.type;return e===ju||e===Gu}var Ld=Wh.CMD,Pd=[[],[],[]],zd=Math.sqrt,Od=Math.atan2,Bd=Math.sqrt,Vd=Math.sin,Hd=Math.cos,Ud=Math.PI;function qd(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Kd(t,e){return(t[0]*e[0]+t[1]*e[1])/(qd(t)*qd(e))}function Wd(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Kd(t,e))}function jd(t,e,n,i,r,o,a,s,l,c,h){var u=l*(Ud/180),d=Hd(u)*(t-n)/2+Vd(u)*(e-i)/2,f=-1*Vd(u)*(t-n)/2+Hd(u)*(e-i)/2,p=d*d/(a*a)+f*f/(s*s);p>1&&(a*=Bd(p),s*=Bd(p));var m=(r===o?-1:1)*Bd((a*a*(s*s)-a*a*(f*f)-s*s*(d*d))/(a*a*(f*f)+s*s*(d*d)))||0,g=m*a*f/s,v=m*-s*d/a,y=(t+n)/2+Hd(u)*g-Vd(u)*v,b=(e+i)/2+Vd(u)*g+Hd(u)*v,x=Wd([1,0],[(d-g)/a,(f-v)/s]),w=[(d-g)/a,(f-v)/s],S=[(-1*d-g)/a,(-1*f-v)/s],C=Wd(w,S);if(Kd(w,S)<=-1&&(C=Ud),Kd(w,S)>=1&&(C=0),C<0){var T=Math.round(C/Ud*1e6)/1e6;C=2*Ud+T%2*Ud}h.addData(c,y,b,a,s,x,C,u,o)}var Gd=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Xd=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g,Yd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.applyTransform=function(t){},e}(fu);function Zd(t){return null!=t.setData}function Jd(t,e){var n=function(t){var e=new Wh;if(!t)return e;var n,i=0,r=0,o=i,a=r,s=Wh.CMD,l=t.match(Gd);if(!l)return e;for(var c=0;c<l.length;c++){for(var h=l[c],u=h.charAt(0),d=void 0,f=h.match(Xd)||[],p=f.length,m=0;m<p;m++)f[m]=parseFloat(f[m]);for(var g=0;g<p;){var v=void 0,y=void 0,b=void 0,x=void 0,w=void 0,S=void 0,C=void 0,T=i,$=r,M=void 0,A=void 0;switch(u){case"l":i+=f[g++],r+=f[g++],d=s.L,e.addData(d,i,r);break;case"L":i=f[g++],r=f[g++],d=s.L,e.addData(d,i,r);break;case"m":i+=f[g++],r+=f[g++],d=s.M,e.addData(d,i,r),o=i,a=r,u="l";break;case"M":i=f[g++],r=f[g++],d=s.M,e.addData(d,i,r),o=i,a=r,u="L";break;case"h":i+=f[g++],d=s.L,e.addData(d,i,r);break;case"H":i=f[g++],d=s.L,e.addData(d,i,r);break;case"v":r+=f[g++],d=s.L,e.addData(d,i,r);break;case"V":r=f[g++],d=s.L,e.addData(d,i,r);break;case"C":d=s.C,e.addData(d,f[g++],f[g++],f[g++],f[g++],f[g++],f[g++]),i=f[g-2],r=f[g-1];break;case"c":d=s.C,e.addData(d,f[g++]+i,f[g++]+r,f[g++]+i,f[g++]+r,f[g++]+i,f[g++]+r),i+=f[g-2],r+=f[g-1];break;case"S":v=i,y=r,M=e.len(),A=e.data,n===s.C&&(v+=i-A[M-4],y+=r-A[M-3]),d=s.C,T=f[g++],$=f[g++],i=f[g++],r=f[g++],e.addData(d,v,y,T,$,i,r);break;case"s":v=i,y=r,M=e.len(),A=e.data,n===s.C&&(v+=i-A[M-4],y+=r-A[M-3]),d=s.C,T=i+f[g++],$=r+f[g++],i+=f[g++],r+=f[g++],e.addData(d,v,y,T,$,i,r);break;case"Q":T=f[g++],$=f[g++],i=f[g++],r=f[g++],d=s.Q,e.addData(d,T,$,i,r);break;case"q":T=f[g++]+i,$=f[g++]+r,i+=f[g++],r+=f[g++],d=s.Q,e.addData(d,T,$,i,r);break;case"T":v=i,y=r,M=e.len(),A=e.data,n===s.Q&&(v+=i-A[M-4],y+=r-A[M-3]),i=f[g++],r=f[g++],d=s.Q,e.addData(d,v,y,i,r);break;case"t":v=i,y=r,M=e.len(),A=e.data,n===s.Q&&(v+=i-A[M-4],y+=r-A[M-3]),i+=f[g++],r+=f[g++],d=s.Q,e.addData(d,v,y,i,r);break;case"A":b=f[g++],x=f[g++],w=f[g++],S=f[g++],C=f[g++],jd(T=i,$=r,i=f[g++],r=f[g++],S,C,b,x,w,d=s.A,e);break;case"a":b=f[g++],x=f[g++],w=f[g++],S=f[g++],C=f[g++],jd(T=i,$=r,i+=f[g++],r+=f[g++],S,C,b,x,w,d=s.A,e)}}"z"!==u&&"Z"!==u||(d=s.Z,e.addData(d),i=o,r=a),n=d}return e.toStatic(),e}(t),i=nr({},e);return i.buildPath=function(t){var e,i=Zd(t);i&&t.canSave()?(t.appendPath(n),(e=t.getContext())&&t.rebuildPath(e,1)):(e=i?t.getContext():t)&&n.rebuildPath(e,1)},i.applyTransform=function(t){!function(t,e){if(e){var n,i,r,o,a,s,l=t.data,c=t.len(),h=Ld.M,u=Ld.C,d=Ld.L,f=Ld.R,p=Ld.A,m=Ld.Q;for(r=0,o=0;r<c;){switch(n=l[r++],o=r,i=0,n){case h:case d:i=1;break;case u:i=3;break;case m:i=2;break;case p:var g=e[4],v=e[5],y=zd(e[0]*e[0]+e[1]*e[1]),b=zd(e[2]*e[2]+e[3]*e[3]),x=Od(-e[1]/b,e[0]/y);l[r]*=y,l[r++]+=g,l[r]*=b,l[r++]+=v,l[r++]*=y,l[r++]*=b,l[r++]+=x,l[r++]+=x,o=r+=2;break;case f:s[0]=l[r++],s[1]=l[r++],eo(s,s,e),l[o++]=s[0],l[o++]=s[1],s[0]+=l[r++],s[1]+=l[r++],eo(s,s,e),l[o++]=s[0],l[o++]=s[1]}for(a=0;a<i;a++){var w=Pd[a];w[0]=l[r++],w[1]=l[r++],eo(w,w,e),l[o++]=w[0],l[o++]=w[1]}}t.increaseVersion()}}(n,t),this.dirtyShape()},i}var Qd=function(){this.cx=0,this.cy=0,this.r=0},tf=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultShape=function(){return new Qd},e.prototype.buildPath=function(t,e){t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI)},e}(fu);tf.prototype.type="circle";var ef=function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0},nf=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultShape=function(){return new ef},e.prototype.buildPath=function(t,e){var n=.5522848,i=e.cx,r=e.cy,o=e.rx,a=e.ry,s=o*n,l=a*n;t.moveTo(i-o,r),t.bezierCurveTo(i-o,r-l,i-s,r-a,i,r-a),t.bezierCurveTo(i+s,r-a,i+o,r-l,i+o,r),t.bezierCurveTo(i+o,r+l,i+s,r+a,i,r+a),t.bezierCurveTo(i-s,r+a,i-o,r+l,i-o,r),t.closePath()},e}(fu);nf.prototype.type="ellipse";var rf=Math.PI,of=2*rf,af=Math.sin,sf=Math.cos,lf=Math.acos,cf=Math.atan2,hf=Math.abs,uf=Math.sqrt,df=Math.max,ff=Math.min,pf=1e-4;function mf(t,e,n,i,r,o,a){var s=t-n,l=e-i,c=(a?o:-o)/uf(s*s+l*l),h=c*l,u=-c*s,d=t+h,f=e+u,p=n+h,m=i+u,g=(d+p)/2,v=(f+m)/2,y=p-d,b=m-f,x=y*y+b*b,w=r-o,S=d*m-p*f,C=(b<0?-1:1)*uf(df(0,w*w*x-S*S)),T=(S*b-y*C)/x,$=(-S*y-b*C)/x,M=(S*b+y*C)/x,A=(-S*y+b*C)/x,N=T-g,k=$-v,R=M-g,_=A-v;return N*N+k*k>R*R+_*_&&(T=M,$=A),{cx:T,cy:$,x0:-h,y0:-u,x1:T*(r/w-1),y1:$*(r/w-1)}}var gf=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0},vf=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultShape=function(){return new gf},e.prototype.buildPath=function(t,e){!function(t,e){var n,i=df(e.r,0),r=df(e.r0||0,0),o=i>0;if(o||r>0){if(o||(i=r,r=0),r>i){var a=i;i=r,r=a}var s=e.startAngle,l=e.endAngle;if(!isNaN(s)&&!isNaN(l)){var c=e.cx,h=e.cy,u=!!e.clockwise,d=hf(l-s),f=d>of&&d%of;if(f>pf&&(d=f),i>pf)if(d>of-pf)t.moveTo(c+i*sf(s),h+i*af(s)),t.arc(c,h,i,s,l,!u),r>pf&&(t.moveTo(c+r*sf(l),h+r*af(l)),t.arc(c,h,r,l,s,u));else{var p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,b=void 0,x=void 0,w=void 0,S=void 0,C=void 0,T=void 0,$=void 0,M=void 0,A=void 0,N=void 0,k=void 0,R=i*sf(s),_=i*af(s),I=r*sf(l),F=r*af(l),E=d>pf;if(E){var D=e.cornerRadius;D&&(p=(n=function(t){var e;if(mr(t)){var n=t.length;if(!n)return t;e=1===n?[t[0],t[0],0,0]:2===n?[t[0],t[0],t[1],t[1]]:3===n?t.concat(t[2]):t}else e=[t,t,t,t];return e}(D))[0],m=n[1],g=n[2],v=n[3]);var L=hf(i-r)/2;if(y=ff(L,g),b=ff(L,v),x=ff(L,p),w=ff(L,m),T=S=df(y,b),$=C=df(x,w),(S>pf||C>pf)&&(M=i*sf(l),A=i*af(l),N=r*sf(s),k=r*af(s),d<rf)){var P=function(t,e,n,i,r,o,a,s){var l=n-t,c=i-e,h=a-r,u=s-o,d=u*l-h*c;if(!(d*d<pf))return[t+(d=(h*(e-o)-u*(t-r))/d)*l,e+d*c]}(R,_,N,k,M,A,I,F);if(P){var z=R-P[0],O=_-P[1],B=M-P[0],V=A-P[1],H=1/af(lf((z*B+O*V)/(uf(z*z+O*O)*uf(B*B+V*V)))/2),U=uf(P[0]*P[0]+P[1]*P[1]);T=ff(S,(i-U)/(H+1)),$=ff(C,(r-U)/(H-1))}}}if(E)if(T>pf){var q=ff(g,T),K=ff(v,T),W=mf(N,k,R,_,i,q,u),j=mf(M,A,I,F,i,K,u);t.moveTo(c+W.cx+W.x0,h+W.cy+W.y0),T<S&&q===K?t.arc(c+W.cx,h+W.cy,T,cf(W.y0,W.x0),cf(j.y0,j.x0),!u):(q>0&&t.arc(c+W.cx,h+W.cy,q,cf(W.y0,W.x0),cf(W.y1,W.x1),!u),t.arc(c,h,i,cf(W.cy+W.y1,W.cx+W.x1),cf(j.cy+j.y1,j.cx+j.x1),!u),K>0&&t.arc(c+j.cx,h+j.cy,K,cf(j.y1,j.x1),cf(j.y0,j.x0),!u))}else t.moveTo(c+R,h+_),t.arc(c,h,i,s,l,!u);else t.moveTo(c+R,h+_);r>pf&&E?$>pf?(q=ff(p,$),W=mf(I,F,M,A,r,-(K=ff(m,$)),u),j=mf(R,_,N,k,r,-q,u),t.lineTo(c+W.cx+W.x0,h+W.cy+W.y0),$<C&&q===K?t.arc(c+W.cx,h+W.cy,$,cf(W.y0,W.x0),cf(j.y0,j.x0),!u):(K>0&&t.arc(c+W.cx,h+W.cy,K,cf(W.y0,W.x0),cf(W.y1,W.x1),!u),t.arc(c,h,r,cf(W.cy+W.y1,W.cx+W.x1),cf(j.cy+j.y1,j.cx+j.x1),u),q>0&&t.arc(c+j.cx,h+j.cy,q,cf(j.y1,j.x1),cf(j.y0,j.x0),!u))):(t.lineTo(c+I,h+F),t.arc(c,h,r,l,s,u)):t.lineTo(c+I,h+F)}else t.moveTo(c,h);t.closePath()}}}(t,e)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(fu);vf.prototype.type="sector";var yf=function(){this.cx=0,this.cy=0,this.r=0,this.r0=0},bf=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultShape=function(){return new yf},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=2*Math.PI;t.moveTo(n+e.r,i),t.arc(n,i,e.r,0,r,!1),t.moveTo(n+e.r0,i),t.arc(n,i,e.r0,0,r,!0)},e}(fu);function xf(t,e,n){var i=e.smooth,r=e.points;if(r&&r.length>=2){if(i){var o=function(t,e,n,i){var r,o,a,s,l=[],c=[],h=[],u=[];if(i){a=[1/0,1/0],s=[-1/0,-1/0];for(var d=0,f=t.length;d<f;d++)no(a,a,t[d]),io(s,s,t[d]);no(a,a,i[0]),io(s,s,i[1])}for(d=0,f=t.length;d<f;d++){var p=t[d];if(n)r=t[d?d-1:f-1],o=t[(d+1)%f];else{if(0===d||d===f-1){l.push(jr(t[d]));continue}r=t[d-1],o=t[d+1]}Xr(c,o,r),Yr(c,c,e);var m=Zr(p,r),g=Zr(p,o),v=m+g;0!==v&&(m/=v,g/=v),Yr(h,c,-m),Yr(u,c,g);var y=Gr([],p,h),b=Gr([],p,u);i&&(io(y,y,a),no(y,y,s),io(b,b,a),no(b,b,s)),l.push(y),l.push(b)}return n&&l.push(l.shift()),l}(r,i,n,e.smoothConstraint);t.moveTo(r[0][0],r[0][1]);for(var a=r.length,s=0;s<(n?a:a-1);s++){var l=o[2*s],c=o[2*s+1],h=r[(s+1)%a];t.bezierCurveTo(l[0],l[1],c[0],c[1],h[0],h[1])}}else{t.moveTo(r[0][0],r[0][1]),s=1;for(var u=r.length;s<u;s++)t.lineTo(r[s][0],r[s][1])}n&&t.closePath()}}bf.prototype.type="ring";var wf=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},Sf=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultShape=function(){return new wf},e.prototype.buildPath=function(t,e){xf(t,e,!0)},e}(fu);Sf.prototype.type="polygon";var Cf=function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null},Tf=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Cf},e.prototype.buildPath=function(t,e){xf(t,e,!1)},e}(fu);Tf.prototype.type="polyline";var $f={},Mf=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},Af=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Mf},e.prototype.buildPath=function(t,e){var n,i,r,o;if(this.subPixelOptimize){var a=xu($f,e,this.style);n=a.x1,i=a.y1,r=a.x2,o=a.y2}else n=e.x1,i=e.y1,r=e.x2,o=e.y2;var s=e.percent;0!==s&&(t.moveTo(n,i),s<1&&(r=n*(1-s)+r*s,o=i*(1-s)+o*s),t.lineTo(r,o))},e.prototype.pointAt=function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]},e}(fu);Af.prototype.type="line";var Nf=[],kf=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function Rf(t,e,n){var i=t.cpx2,r=t.cpy2;return null!=i||null!=r?[(n?Da:Ea)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?Da:Ea)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?Va:Ba)(t.x1,t.cpx1,t.x2,e),(n?Va:Ba)(t.y1,t.cpy1,t.y2,e)]}var _f=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new kf},e.prototype.buildPath=function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,a=e.cpx1,s=e.cpy1,l=e.cpx2,c=e.cpy2,h=e.percent;0!==h&&(t.moveTo(n,i),null==l||null==c?(h<1&&(Ua(n,a,r,h,Nf),a=Nf[1],r=Nf[2],Ua(i,s,o,h,Nf),s=Nf[1],o=Nf[2]),t.quadraticCurveTo(a,s,r,o)):(h<1&&(za(n,a,l,r,h,Nf),a=Nf[1],l=Nf[2],r=Nf[3],za(i,s,c,o,h,Nf),s=Nf[1],c=Nf[2],o=Nf[3]),t.bezierCurveTo(a,s,l,c,r,o)))},e.prototype.pointAt=function(t){return Rf(this.shape,t,!1)},e.prototype.tangentAt=function(t){var e=Rf(this.shape,t,!0);return function(t,e){var n=function(t){return Math.sqrt(function(t){return t[0]*t[0]+t[1]*t[1]}(t))}(e);return 0===n?(t[0]=0,t[1]=0):(t[0]=e[0]/n,t[1]=e[1]/n),t}(e,e)},e}(fu);_f.prototype.type="bezier-curve";var If=function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},Ff=function(t){function e(e){return t.call(this,e)||this}return Ei(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new If},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),c=Math.sin(o);t.moveTo(l*r+n,c*r+i),t.arc(n,i,r,o,a,!s)},e}(fu);Ff.prototype.type="arc";var Ef=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="compound",e}return Ei(e,t),e.prototype.Xl=function(){for(var t=this.shape.paths,e=this.shapeChanged(),n=0;n<t.length;n++)e=e||t[n].shapeChanged();e&&this.dirtyShape()},e.prototype.beforeBrush=function(){this.Xl();for(var t=this.shape.paths||[],e=this.getGlobalScale(),n=0;n<t.length;n++)t[n].path||t[n].createPathProxy(),t[n].path.setScale(e[0],e[1],t[n].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,e){for(var n=e.paths||[],i=0;i<n.length;i++)n[i].buildPath(t,n[i].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],e=0;e<t.length;e++)t[e].pathUpdated()},e.prototype.getBoundingRect=function(){return this.Xl.call(this),fu.prototype.getBoundingRect.call(this)},e}(fu),Df=function(){function t(t){this.colorStops=t||[]}return t.prototype.addColorStop=function(t,e){this.colorStops.push({offset:t,color:e})},t}(),Lf=function(t){function e(e,n,i,r,o,a){var s=t.call(this,o)||this;return s.x=e??0,s.y=n??0,s.x2=i??1,s.y2=r??0,s.type="linear",s.global=a||!1,s}return Ei(e,t),e}(Df),Pf=function(t){function e(e,n,i,r,o){var a=t.call(this,r)||this;return a.x=e??.5,a.y=n??.5,a.r=i??.5,a.type="radial",a.global=o||!1,a}return Ei(e,t),e}(Df),zf=Math.min,Of=Math.max,Bf=Math.abs,Vf=[0,0],Hf=[0,0],Uf=na(),qf=Uf.minTv,Kf=Uf.maxTv,Wf=function(){function t(t,e){this.Yl=[],this.Jl=[],this.Zl=[0,0];for(var n=0;n<4;n++)this.Yl[n]=new zo;for(n=0;n<2;n++)this.Jl[n]=new zo;t&&this.fromBoundingRect(t,e)}return t.prototype.fromBoundingRect=function(t,e){var n=this.Yl,i=this.Jl,r=t.x,o=t.y,a=r+t.width,s=o+t.height;if(n[0].set(r,o),n[1].set(a,o),n[2].set(a,s),n[3].set(r,s),e)for(var l=0;l<4;l++)n[l].transform(e);for(zo.sub(i[0],n[1],n[0]),zo.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize(),l=0;l<2;l++)this.Zl[l]=i[l].dot(n[0])},t.prototype.intersect=function(t,e,n){var i=!0,r=!e;return e&&zo.set(e,0,0),Uf.reset(n,!r),!this.Ql(this,t,r,1)&&(i=!1,r)||!this.Ql(t,this,r,-1)&&(i=!1,r)||r||Uf.negativeSize||zo.copy(e,i?Uf.useDir?Uf.dirMinTv:qf:Kf),i},t.prototype.Ql=function(t,e,n,i){for(var r=!0,o=0;o<2;o++){var a=t.Jl[o];if(t.tc(o,t.Yl,Vf),t.tc(o,e.Yl,Hf),Uf.negativeSize||Vf[1]<Hf[0]||Vf[0]>Hf[1]){if(r=!1,Uf.negativeSize||n)return r;var s=Bf(Hf[0]-Vf[1]),l=Bf(Vf[0]-Hf[1]);zf(s,l)>Kf.len()&&(s<l?zo.scale(Kf,a,-s*i):zo.scale(Kf,a,l*i))}else n||(s=Bf(Hf[0]-Vf[1]),l=Bf(Vf[0]-Hf[1]),(Uf.useDir||zf(s,l)<qf.len())&&((s<l||!Uf.bidirectional)&&(zo.scale(qf,a,s*i),Uf.useDir&&Uf.calcDirMTV()),(s>=l||!Uf.bidirectional)&&(zo.scale(qf,a,-l*i),Uf.useDir&&Uf.calcDirMTV())))}return r},t.prototype.tc=function(t,e,n){for(var i=this.Jl[t],r=this.Zl,o=e[0].dot(i)+r[t],a=o,s=o,l=1;l<e.length;l++){var c=e[l].dot(i)+r[t];a=zf(c,a),s=Of(c,s)}n[0]=a+Uf.touchThreshold,n[1]=s-Uf.touchThreshold,Uf.negativeSize=n[1]<n[0]},t}(),jf=[],Gf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notClear=!0,e.incremental=!0,e.ec=[],e.nc=[],e.rc=0,e}return Ei(e,t),e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this.rc},e.prototype.innerAfterBrush=function(){this.rc=this.ec.length},e.prototype.clearDisplaybles=function(){this.ec=[],this.nc=[],this.rc=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this.nc=[]},e.prototype.addDisplayable=function(t,e){e?this.nc.push(t):this.ec.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,e){e=e||!1;for(var n=0;n<t.length;n++)this.addDisplayable(t[n],e)},e.prototype.getDisplayables=function(){return this.ec},e.prototype.getTemporalDisplayables=function(){return this.nc},e.prototype.eachPendingDisplayable=function(t){for(var e=this.rc;e<this.ec.length;e++)t&&t(this.ec[e]);for(e=0;e<this.nc.length;e++)t&&t(this.nc[e])},e.prototype.update=function(){this.updateTransform();for(var t=this.rc;t<this.ec.length;t++)(e=this.ec[t]).parent=this,e.update(),e.parent=null;for(t=0;t<this.nc.length;t++){var e;(e=this.nc[t]).parent=this,e.update(),e.parent=null}},e.prototype.getBoundingRect=function(){if(!this.gl){for(var t=new Jo(1/0,1/0,-1/0,-1/0),e=0;e<this.ec.length;e++){var n=this.ec[e],i=n.getBoundingRect().clone();n.needLocalTransform()&&i.applyTransform(n.getLocalTransform(jf)),t.union(i)}this.gl=t}return this.gl},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(n[0],n[1]))for(var i=0;i<this.ec.length;i++)if(this.ec[i].contain(t,e))return!0;return!1},e}(uh),Xf=yc();function Yf(t,e,n,i,r,o,a){var s,l=!1;gr(r)?(a=o,o=r,r=null):xr(r)&&(o=r.cb,a=r.during,l=r.isFrom,s=r.removeOpt,r=r.dataIndex);var c="leave"===t;c||e.stopAnimation("leave");var h=function(t,e,n,i,r){var o;if(e&&e.ecModel){var a=e.ecModel.getUpdatePayload();o=a&&a.animation}var s="update"===t;if(e&&e.isAnimationEnabled()){var l=void 0,c=void 0,h=void 0;return i?(l=Ar(i.duration,200),c=Ar(i.easing,"cubicOut"),h=0):(l=e.getShallow(s?"animationDurationUpdate":"animationDuration"),c=e.getShallow(s?"animationEasingUpdate":"animationEasing"),h=e.getShallow(s?"animationDelayUpdate":"animationDelay")),o&&(null!=o.duration&&(l=o.duration),null!=o.easing&&(c=o.easing),null!=o.delay&&(h=o.delay)),gr(h)&&(h=h(n,r)),gr(l)&&(l=l(n)),{duration:l||0,delay:h,easing:c}}return null}(t,i,r,c?s||{}:null,i&&i.getAnimationDelayParams?i.getAnimationDelayParams(e,r):null);if(h&&h.duration>0){var u={duration:h.duration,delay:h.delay||0,easing:h.easing,done:o,force:!!o||!!a,setToFinal:!c,scope:t,during:a};l?e.animateFrom(n,u):e.animateTo(n,u)}else e.stopAnimation(),!l&&e.attr(n),a&&a(1),o&&o()}function Zf(t,e,n,i,r,o){Yf("update",t,e,n,i,r,o)}function Jf(t,e,n,i,r,o){Yf("enter",t,e,n,i,r,o)}function Qf(t){if(!t.__zr)return!0;for(var e=0;e<t.animators.length;e++)if("leave"===t.animators[e].scope)return!0;return!1}function tp(t,e,n,i,r,o){Qf(t)||Yf("leave",t,e,n,i,r,o)}function ep(t,e,n,i){t.removeTextContent(),t.removeTextGuideLine(),tp(t,{style:{opacity:0}},e,n,i)}function np(t,e,n){function i(){t.parent&&t.parent.remove(t)}t.isGroup?t.traverse(function(t){t.isGroup||ep(t,e,n,i)}):ep(t,e,n,i)}function ip(t){Xf(t).oldStyle=t.style}var rp={},op=["x","y"],ap=["width","height"];function sp(t,e){rp[t]=e}function lp(t,e,n,i){var r=function(t,e){return new Yd(Jd(t,e))}(t,e);return n&&("center"===i&&(n=hp(n,r.getBoundingRect())),dp(r,n)),r}function cp(t,e,n){var i=new yu({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(t){if("center"===n){var r={width:t.width,height:t.height};i.setStyle(hp(e,r))}}});return i}function hp(t,e){var n,i=e.width/e.height,r=t.height*i;return n=r<=t.width?t.height:(r=t.width)/i,{x:t.x+t.width/2-r/2,y:t.y+t.height/2-n/2,width:r,height:n}}var up=function(t,e){for(var n=[],i=t.length,r=0;r<i;r++){var o=t[r];n.push(o.getUpdatedPathProxy(!0))}var a=new fu(e);return a.createPathProxy(),a.buildPath=function(t){if(Zd(t)){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e,1)}},a};function dp(t,e){if(t.applyTransform){var n=t.getBoundingRect().calculateTransform(e);t.applyTransform(n)}}function fp(t,e){return xu(t,t,{lineWidth:e}),t}var pp=Su;function mp(t,e,n){return e&&!ar(e)&&(e=sl.getLocalTransform(e)),n&&(e=Po([],e)),eo([],t,e)}function gp(t){return!t.isGroup}function vp(t,e,n){if(t&&e){var i=function(t){var e={};return t.traverse(function(t){gp(t)&&t.anid&&(e[t.anid]=t)}),e}(t);e.traverse(function(t){if(gp(t)&&t.anid){var e=i[t.anid];if(e){var o=r(t);t.attr(r(e)),Zf(t,o,n,Bu(t).dataIndex)}}})}function r(t){var e={x:t.x,y:t.y,rotation:t.rotation};return function(t){return null!=t.shape}(t)&&(e.shape=tr(t.shape)),e}}function yp(t,e,n){var i=nr({rectHover:!0},e),r=i.style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(r.image=t.slice(8),ir(r,n),new yu(i)):lp(t.replace("path://",""),i,n,"center")}function bp(t,e,n,i,r,o,a,s){var l,c=n-t,h=i-e,u=a-r,d=s-o,f=xp(u,d,c,h);if((l=f)<=1e-6&&l>=-1e-6)return!1;var p=t-r,m=e-o,g=xp(p,m,c,h)/f;if(g<0||g>1)return!1;var v=xp(p,m,u,d)/f;return!(v<0||v>1)}function xp(t,e,n,i){return t*i-n*e}function wp(t,e,n,i,r){return null==e||(br(e)?Sp[0]=Sp[1]=Sp[2]=Sp[3]=e:(Sp[0]=e[0],Sp[1]=e[1],Sp[2]=e[2],Sp[3]=e[3]),i&&(Sp[0]=zl(0,Sp[0]),Sp[1]=zl(0,Sp[1]),Sp[2]=zl(0,Sp[2]),Sp[3]=zl(0,Sp[3])),n&&(Sp[0]=-Sp[0],Sp[1]=-Sp[1],Sp[2]=-Sp[2],Sp[3]=-Sp[3]),Cp(t,Sp,"x","width",3,1,r&&r[0]||0),Cp(t,Sp,"y","height",0,2,r&&r[1]||0)),t}var Sp=[0,0,0,0];function Cp(t,e,n,i,r,o,a){var s=e[o]+e[r],l=t[i];t[i]+=s,a=zl(0,Pl(a,l)),t[i]<a?(t[i]=a,t[n]+=e[r]>=0?-e[r]:e[o]>=0?l+e[o]:Ol(s)>1e-8?(l-a)*e[r]/s:0):t[n]-=e[r]}function Tp(t){var e=t.itemTooltipOption,n=t.componentModel,i=t.itemName,r=vr(e)?{formatter:e}:e,o=n.mainType,a=n.componentIndex,s={componentType:o,name:i,$vars:["name"]};s[o+"Index"]=a;var l=t.formatterParamsExtra;l&&sr(dr(l),function(t){Ur(s,t)||(s[t]=l[t],s.$vars.push(t))});var c=Bu(t.el);c.componentMainType=o,c.componentIndex=a,c.tooltipConfig={name:i,option:ir({content:i,encodeHTMLContent:!0,formatterParams:s},r)}}function $p(t,e){var n;t.isGroup&&(n=e(t)),n||t.traverse(e)}function Mp(t,e){if(t)if(mr(t))for(var n=0;n<t.length;n++)$p(t[n],e);else $p(t,e)}function Ap(t){return!t||Ol(t[1])<Np&&Ol(t[2])<Np||Ol(t[0])<Np&&Ol(t[3])<Np}var Np=1e-5;function kp(t,e){return t?Jo.copy(t,e):e.clone()}function Rp(t,e){return e?Io(t||[1,0,0,1,0,0],e):void 0}function _p(t){return{z:t.get("z")||0,zlevel:t.get("zlevel")||0}}function Ip(t,e,n){Fp(t,e,n,-1/0)}function Fp(t,e,n,i){if(t.ignoreModelZ)return i;var r=t.getTextContent(),o=t.getTextGuideLine();if(t.isGroup)for(var a=t.childrenRef(),s=0;s<a.length;s++)i=zl(Fp(a[s],e,n,i),i);else t.z=e,t.zlevel=n,i=zl(t.z2||0,i);if(r&&(r.z=e,r.zlevel=n,isFinite(i)&&(r.z2=i+2)),o){var l=t.textGuideLineConfig;o.z=e,o.zlevel=n,isFinite(i)&&(o.z2=i+(l&&l.showAbove?1:-1))}return i}sp("circle",tf),sp("ellipse",nf),sp("sector",vf),sp("ring",bf),sp("polygon",Sf),sp("polyline",Tf),sp("rect",$u),sp("line",Af),sp("bezierCurve",_f),sp("arc",Ff);const Ep=Object.freeze(Object.defineProperty({__proto__:null,Arc:Ff,BezierCurve:_f,BoundingRect:Jo,Circle:tf,CompoundPath:Ef,Ellipse:nf,Group:Il,Image:yu,IncrementalDisplayable:Gf,Line:Af,LinearGradient:Lf,OrientedBoundingRect:Wf,Path:fu,Point:zo,Polygon:Sf,Polyline:Tf,RadialGradient:Pf,Rect:$u,Ring:bf,Sector:vf,Text:ku,WH:ap,XY:op,applyTransform:mp,calcZ2Range:function(t){var e=-1/0,n=1/0;function i(t){if(t&&!t.isGroup){var e=t.currentStates;if(e.length)for(var n=0;n<e.length;n++)r(t.states[e[n]]);r(t)}}function r(t){if(t){var i=t.z2;i>e&&(e=i),i<n&&(n=i)}}return $p(t,function(t){i(t),i(t.getTextContent()),i(t.getTextGuideLine())}),n>e&&(n=e=0),{min:n,max:e}},clipPointsByRect:function(t,e){return lr(t,function(t){var n=t[0];n=zl(n,e.x),n=Pl(n,e.x+e.width);var i=t[1];return i=zl(i,e.y),[n,i=Pl(i,e.y+e.height)]})},clipRectByRect:function(t,e){var n=zl(t.x,e.x),i=Pl(t.x+t.width,e.x+e.width),r=zl(t.y,e.y),o=Pl(t.y+t.height,e.y+e.height);if(i>=n&&o>=r)return{x:n,y:r,width:i-n,height:o-r}},createIcon:yp,ensureCopyRect:kp,ensureCopyTransform:Rp,expandOrShrinkRect:wp,extendPath:function(t,e){return function(t,e){var n=Jd(t,e);return function(t){function e(e){var i=t.call(this,e)||this;return i.applyTransform=n.applyTransform,i.buildPath=n.buildPath,i}return Ei(e,t),e}(Yd)}(t,e)},extendShape:function(t){return fu.extend(t)},getShapeClass:function(t){if(rp.hasOwnProperty(t))return rp[t]},getTransform:function(t,e){for(var n=_o([]);t&&t!==e;)Fo(n,t.getLocalTransform(),n),t=t.parent;return n},groupTransition:vp,initProps:Jf,isBoundingRectAxisAligned:Ap,isElementRemoved:Qf,lineLineIntersect:bp,linePolygonIntersect:function(t,e,n,i,r){for(var o=0,a=r[r.length-1];o<r.length;o++){var s=r[o];if(bp(t,e,n,i,s[0],s[1],a[0],a[1]))return!0;a=s}},makeImage:cp,makePath:lp,mergePath:up,registerShape:sp,removeElement:tp,removeElementWithFadeOut:np,resizePath:dp,retrieveZInfo:_p,setTooltipConfig:Tp,subPixelOptimize:pp,subPixelOptimizeLine:fp,subPixelOptimizeRect:function(t,e){return wu(t,t,e),t},transformDirection:function(t,e,n){var i=0===e[4]||0===e[5]||0===e[0]?1:Ol(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:Ol(2*e[4]/e[2]),o=["left"===t?-i:"right"===t?i:0,"top"===t?-r:"bottom"===t?r:0];return o=mp(o,e,n),Ol(o[0])>Ol(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"},traverseElements:Mp,traverseUpdateZ:Ip,updateProps:Zf},Symbol.toStringTag,{value:"Module"}));var Dp={};function Lp(t,e,n){var i,r=t.labelFetcher,o=t.labelDataIndex,a=t.labelDimIndex,s=e.normal;r&&(i=r.getFormattedLabel(o,"normal",null,a,s&&s.get("formatter"),null!=n?{interpolatedValue:n}:null)),null==i&&(i=gr(t.defaultText)?t.defaultText(o,t,n):t.defaultText);for(var l={normal:i},c=0;c<Ku.length;c++){var h=Ku[c],u=e[h];l[h]=Ar(r?r.getFormattedLabel(o,h,null,a,u&&u.get("formatter")):null,i)}return l}function Pp(t,e,n,i){n=n||Dp;for(var r=t instanceof ku,o=!1,a=0;a<Wu.length;a++)if((d=e[Wu[a]])&&d.getShallow("show")){o=!0;break}var s=r?t:t.getTextContent();if(o){r||(s||(s=new ku,t.setTextContent(s)),t.stateProxy&&(s.stateProxy=t.stateProxy));var l=Lp(n,e),c=e.normal,h=!!c.getShallow("show"),u=Op(c,i&&i.normal,n,!1,!r);for(u.text=l.normal,r||t.setTextConfig(Bp(c,n,!1)),a=0;a<Ku.length;a++){var d,f=Ku[a];if(d=e[f]){var p=s.ensureState(f),m=!!Ar(d.getShallow("show"),h);m!==h&&(p.ignore=!m),p.style=Op(d,i&&i[f],n,!0,!r),p.style.text=l[f],r||(t.ensureState(f).textConfig=Bp(d,n,!0))}}s.silent=!!c.getShallow("silent"),null!=s.style.x&&(u.x=s.style.x),null!=s.style.y&&(u.y=s.style.y),s.ignore=!h,s.useStyle(u),s.dirty(),n.enableTextSetter&&(Kp(s).setLabelText=function(t){var i=Lp(n,e,t);!function(t,e){for(var n=0;n<Ku.length;n++){var i=Ku[n],r=e[i],o=t.ensureState(i);o.style=o.style||{},o.style.text=r}var a=t.currentStates.slice();t.clearStates(!0),t.setStyle({text:e.normal}),t.useStates(a,!0)}(s,i)})}else s&&(s.ignore=!0);t.dirty()}function zp(t,e){e=e||"label";for(var n={normal:t.getModel(e)},i=0;i<Ku.length;i++){var r=Ku[i];n[r]=t.getModel([r,e])}return n}function Op(t,e,n,i,r){var o={};return function(t,e,n,i,r){n=n||Dp;var o,a=e.ecModel,s=a&&a.option.textStyle,l=function(t){for(var e;t&&t!==t.ecModel;){var n=(t.option||Dp).rich;if(n){e=e||{};for(var i=dr(n),r=0;r<i.length;r++)e[i[r]]=1}t=t.parentModel}return e}(e);if(l){o={};var c="richInheritPlainLabel",h=Ar(e.get(c),a?a.get(c):void 0);for(var u in l)if(l.hasOwnProperty(u)){var d=e.getModel(["rich",u]);qp(o[u]={},d,s,e,h,n,i,r,!1,!0)}}o&&(t.rich=o);var f=e.get("overflow");f&&(t.overflow=f);var p=e.get("lineOverflow");p&&(t.lineOverflow=p);var m=t,g=e.get("minMargin");if(null!=g)g=br(g)?g/2:0,m.margin=[g,g,g,g],m.__marginType=Wp.minMargin;else{var v=e.get("textMargin");null!=v&&(m.margin=Rr(v),m.__marginType=Wp.textMargin)}qp(t,e,s,null,null,n,i,r,!0,!1)}(o,t,n,i,r),e&&nr(o,e),o}function Bp(t,e,n){e=e||{};var i,r={},o=t.getShallow("rotate"),a=Ar(t.getShallow("distance"),n?null:5),s=t.getShallow("offset");return"outside"===(i=t.getShallow("position")||(n?null:"inside"))&&(i=e.defaultOutsidePosition||"top"),null!=i&&(r.position=i),null!=s&&(r.offset=s),null!=o&&(o*=Math.PI/180,r.rotation=o),null!=a&&(r.distance=a),r.outsideFill="inherit"===t.get("color")?e.inheritColor||null:"auto",null!=e.autoOverflowArea&&(r.autoOverflowArea=e.autoOverflowArea),null!=e.layoutRect&&(r.layoutRect=e.layoutRect),r}var Vp=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],Hp=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],Up=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function qp(t,e,n,i,r,o,a,s,l,c){n=!a&&n||Dp;var h=o&&o.inheritColor,u=e.getShallow("color"),d=e.getShallow("textBorderColor"),f=Ar(e.getShallow("opacity"),n.opacity);"inherit"!==u&&"auto"!==u||(u=h||null),"inherit"!==d&&"auto"!==d||(d=h||null),s||(u=u||n.color,d=d||n.textBorderColor),null!=u&&(t.fill=u),null!=d&&(t.stroke=d);var p=Ar(e.getShallow("textBorderWidth"),n.textBorderWidth);null!=p&&(t.lineWidth=p);var m=Ar(e.getShallow("textBorderType"),n.textBorderType);null!=m&&(t.lineDash=m);var g=Ar(e.getShallow("textBorderDashOffset"),n.textBorderDashOffset);null!=g&&(t.lineDashOffset=g),a||null!=f||c||(f=o&&o.defaultOpacity),null!=f&&(t.opacity=f),a||s||null==t.fill&&o.inheritColor&&(t.fill=o.inheritColor);for(var v=0;v<Vp.length;v++){var y=Vp[v];null!=(x=!1!==r&&i?Nr(e.getShallow(y),i.getShallow(y),n[y]):Ar(e.getShallow(y),n[y]))&&(t[y]=x)}for(v=0;v<Hp.length;v++)y=Hp[v],null!=(x=e.getShallow(y))&&(t[y]=x);if(null==t.verticalAlign){var b=e.getShallow("baseline");null!=b&&(t.verticalAlign=b)}if(!l||!o.disableBox){for(v=0;v<Up.length;v++){var x;y=Up[v],null!=(x=e.getShallow(y))&&(t[y]=x)}var w=e.getShallow("borderType");null!=w&&(t.borderDash=w),"auto"!==t.backgroundColor&&"inherit"!==t.backgroundColor||!h||(t.backgroundColor=h),"auto"!==t.borderColor&&"inherit"!==t.borderColor||!h||(t.borderColor=h)}}var Kp=yc(),Wp={minMargin:1,textMargin:2},jp=["textStyle","color"],Gp=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],Xp=new ku,Yp=function(){function t(){}return t.prototype.getTextColor=function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(jp):null)},t.prototype.getFont=function(){return function(t,e){var n=e&&e.getModel("textStyle");return Ir([t.fontStyle||n&&n.getShallow("fontStyle")||"",t.fontWeight||n&&n.getShallow("fontWeight")||"",(t.fontSize||n&&n.getShallow("fontSize")||12)+"px",t.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},t.prototype.getTextRect=function(t){for(var e={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<Gp.length;n++)e[Gp[n]]=this.getShallow(Gp[n]);return Xp.useStyle(e),Xp.update(),Xp.getBoundingRect()},t}(),Zp=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],Jp=Ec(Zp),Qp=function(){function t(){}return t.prototype.getLineStyle=function(t){return Jp(this,t)},t}(),tm=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],em=Ec(tm),nm=function(){function t(){}return t.prototype.getItemStyle=function(t,e){return em(this,t,e)},t}(),im=function(){function t(t,e,n){this.parentModel=e,this.ecModel=n,this.option=t}return t.prototype.init=function(t,e,n){},t.prototype.mergeOption=function(t,e){er(this.option,t,!0)},t.prototype.get=function(t,e){return null==t?this.option:this.sc(this.parsePath(t),!e&&this.parentModel)},t.prototype.getShallow=function(t,e){var n=this.option,i=null==n?n:n[t];if(null==i&&!e){var r=this.parentModel;r&&(i=r.getShallow(t))}return i},t.prototype.getModel=function(e,n){var i=null!=e,r=i?this.parsePath(e):null;return new t(i?this.sc(r):this.option,n=n||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(r)),this.ecModel)},t.prototype.isEmpty=function(){return null==this.option},t.prototype.restoreData=function(){},t.prototype.clone=function(){return new(0,this.constructor)(tr(this.option))},t.prototype.parsePath=function(t){return"string"==typeof t?t.split("."):t},t.prototype.resolveParentPath=function(t){return t},t.prototype.isAnimationEnabled=function(){if(!Li.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},t.prototype.sc=function(t,e){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&(!t[i]||null!=(n=n&&"object"==typeof n?n[t[i]]:null));i++);return null==n&&e&&(n=e.sc(this.resolveParentPath(t),e.parentModel)),n},t}();Nc(im),function(t){var e=["__\0is_clz",Rc++].join("_");t.prototype[e]=!0,t.isInstance=function(t){return!(!t||!t[e])}}(im),or(im,Qp),or(im,nm),or(im,Lc),or(im,Yp);var rm=Math.round(10*Math.random());function om(t){return[t||"",rm++].join("_")}function am(t,e){return er(er({},t,!0),e,!0)}var sm="ZH",lm="EN",cm=lm,hm={},um={},dm=Li.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage||cm).toUpperCase().indexOf(sm)>-1?sm:cm;function fm(t,e){t=t.toUpperCase(),um[t]=new im(e),hm[t]=e}function pm(){return null}fm(lm,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),fm(sm,{time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图",custom:"自定义图表",chart:"图表"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}});var mm=36e5,gm=864e5,vm=31536e6,ym={year:/({yyyy}|{yy})/,month:/({MMMM}|{MMM}|{MM}|{M})/,day:/({dd}|{d})/,hour:/({HH}|{H}|{hh}|{h})/,minute:/({mm}|{m})/,second:/({ss}|{s})/,millisecond:/({SSS}|{S})/},bm={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}"},xm="{yyyy}-{MM}-{dd}",wm={year:"{yyyy}",month:"{yyyy}-{MM}",day:xm,hour:xm+" "+bm.hour,minute:xm+" "+bm.minute,second:xm+" "+bm.second,millisecond:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},Sm=["year","month","day","hour","minute","second","millisecond"],Cm=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function Tm(t,e){return"0000".substr(0,e-(t+="").length)+t}function $m(t){switch(t){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return t}}function Mm(t){return t===$m(t)}function Am(t,e,n,i){var r=Yl(t),o=r[Rm(n)](),a=r[_m(n)]()+1,s=Math.floor((a-1)/3)+1,l=r[Im(n)](),c=r["get"+(n?"UTC":"")+"Day"](),h=r[Fm(n)](),u=(h-1)%12+1,d=r[Em(n)](),f=r[Dm(n)](),p=r[Lm(n)](),m=h>=12?"pm":"am",g=m.toUpperCase(),v=i instanceof im?i:function(t){return um[t]}(i||dm)||um[cm],y=v.getModel("time"),b=y.get("month"),x=y.get("monthAbbr"),w=y.get("dayOfWeek"),S=y.get("dayOfWeekAbbr");return(e||"").replace(/{a}/g,m+"").replace(/{A}/g,g+"").replace(/{yyyy}/g,o+"").replace(/{yy}/g,Tm(o%100+"",2)).replace(/{Q}/g,s+"").replace(/{MMMM}/g,b[a-1]).replace(/{MMM}/g,x[a-1]).replace(/{MM}/g,Tm(a,2)).replace(/{M}/g,a+"").replace(/{dd}/g,Tm(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,w[c]).replace(/{ee}/g,S[c]).replace(/{e}/g,c+"").replace(/{HH}/g,Tm(h,2)).replace(/{H}/g,h+"").replace(/{hh}/g,Tm(u+"",2)).replace(/{h}/g,u+"").replace(/{mm}/g,Tm(d,2)).replace(/{m}/g,d+"").replace(/{ss}/g,Tm(f,2)).replace(/{s}/g,f+"").replace(/{SSS}/g,Tm(p,3)).replace(/{S}/g,p+"")}function Nm(t,e){var n=Yl(t),i=n[_m(e)]()+1,r=n[Im(e)](),o=n[Fm(e)](),a=n[Em(e)](),s=n[Dm(e)](),l=0===n[Lm(e)](),c=l&&0===s,h=c&&0===a,u=h&&0===o,d=u&&1===r;return d&&1===i?"year":d?"month":u?"day":h?"hour":c?"minute":l?"second":"millisecond"}function km(t,e,n){switch(e){case"year":t[zm(n)](0);case"month":t[Om(n)](1);case"day":t[Bm(n)](0);case"hour":t[Vm(n)](0);case"minute":t[Hm(n)](0);case"second":t[Um(n)](0)}return t}function Rm(t){return t?"getUTCFullYear":"getFullYear"}function _m(t){return t?"getUTCMonth":"getMonth"}function Im(t){return t?"getUTCDate":"getDate"}function Fm(t){return t?"getUTCHours":"getHours"}function Em(t){return t?"getUTCMinutes":"getMinutes"}function Dm(t){return t?"getUTCSeconds":"getSeconds"}function Lm(t){return t?"getUTCMilliseconds":"getMilliseconds"}function Pm(t){return t?"setUTCFullYear":"setFullYear"}function zm(t){return t?"setUTCMonth":"setMonth"}function Om(t){return t?"setUTCDate":"setDate"}function Bm(t){return t?"setUTCHours":"setHours"}function Vm(t){return t?"setUTCMinutes":"setMinutes"}function Hm(t){return t?"setUTCSeconds":"setSeconds"}function Um(t){return t?"setUTCMilliseconds":"setMilliseconds"}function qm(t){if(isNaN(Ql(t)))return vr(t)?t:"-";var e=(t+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function Km(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}var Wm=Rr;function jm(t,e,n){function i(t){return t&&Ir(t)?t:"-"}function r(t){return!(null==t||isNaN(t)||!isFinite(t))}var o="time"===e,a=t instanceof Date;if(o||a){var s=o?Yl(t):t;if(!isNaN(+s))return Am(s,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}",n);if(a)return"-"}if("ordinal"===e)return yr(t)?i(t):br(t)&&r(t)?t+"":"-";var l=Ql(t);return r(l)?qm(l):yr(t)?i(t):"boolean"==typeof t?t+"":"-"}var Gm=["a","b","c","d","e","f","g"],Xm=function(t,e){return"{"+t+(e??"")+"}"};function Ym(t,e,n){mr(e)||(e=[e]);var i=e.length;if(!i)return"";for(var r=e[0].$vars||[],o=0;o<r.length;o++){var a=Gm[o];t=t.replace(Xm(a),Xm(a,0))}for(var s=0;s<i;s++)for(var l=0;l<r.length;l++){var c=e[s][r[l]];t=t.replace(Xm(Gm[l],s),n?vo(c):c)}return t}function Zm(t,e){return e=e||"transparent",vr(t)?t:xr(t)&&t.colorStops&&(t.colorStops[0]||{}).color||e}function Jm(t,e){if("_blank"===e||"blank"===e){var n=window.open();n.opener=null,n.location.href=t}else window.open(t,e)}var Qm={},tg={},eg=function(){function t(){this.oc=[],this.ac=[]}return t.prototype.create=function(t,e){function n(n,i){var r=[];return sr(n,function(n,i){var o=n.create(t,e);r=r.concat(o||[])}),r}this.ac=n(Qm),this.oc=n(tg)},t.prototype.update=function(t,e){sr(this.oc,function(n){n.update&&n.update(t,e)})},t.prototype.getCoordinateSystems=function(){return this.oc.concat(this.ac)},t.register=function(t,e){"matrix"!==t&&"calendar"!==t?tg[t]=e:Qm[t]=e},t.get=function(t){return tg[t]||Qm[t]},t}(),ng=Or(),ig=sr,rg=["left","right","top","bottom","width","height"],og=[["width","left","right"],["height","top","bottom"]];function ag(t,e,n,i,r){var o=0,a=0;null==i&&(i=1/0),null==r&&(r=1/0);var s=0;e.eachChild(function(l,c){var h,u,d=l.getBoundingRect(),f=e.childAt(c+1),p=f&&f.getBoundingRect();if("horizontal"===t){var m=d.width+(p?-p.x+d.x:0);(h=o+m)>i||l.newline?(o=0,h=m,a+=s+n,s=d.height):s=Math.max(s,d.height)}else{var g=d.height+(p?-p.y+d.y:0);(u=a+g)>r||l.newline?(o+=s+n,a=0,u=g,s=d.width):s=Math.max(s,d.width)}l.newline||(l.x=o,l.y=a,l.markRedraw(),"horizontal"===t?o=h+n:a=u+n)})}var sg=ag;function lg(t,e,n){n=Wm(n||0);var i=e.width,r=e.height,o=Vl(t.left,i),a=Vl(t.top,r),s=Vl(t.right,i),l=Vl(t.bottom,r),c=Vl(t.width,i),h=Vl(t.height,r),u=n[2]+n[0],d=n[1]+n[3],f=t.aspect;switch(isNaN(c)&&(c=i-s-d-o),isNaN(h)&&(h=r-l-u-a),null!=f&&(isNaN(c)&&isNaN(h)&&(f>i/r?c=.8*i:h=.8*r),isNaN(c)&&(c=f*h),isNaN(h)&&(h=c/f)),isNaN(o)&&(o=i-s-c-d),isNaN(a)&&(a=r-l-h-u),t.left||t.right){case"center":o=i/2-c/2-n[3];break;case"right":o=i-c-d}switch(t.top||t.bottom){case"middle":case"center":a=r/2-h/2-n[0];break;case"bottom":a=r-h-u}o=o||0,a=a||0,isNaN(c)&&(c=i-d-o-(s||0)),isNaN(h)&&(h=r-u-a-(l||0));var p=new Jo((e.x||0)+o+n[3],(e.y||0)+a+n[0],c,h);return p.margin=n,p}function cg(t,e,n){var i,r,o,a,s=t.boxCoordinateSystem;if(s){var l=function(t){var e=t.getShallow("coord",!0),n=1;if(null==e){var i=ng.get(t.type);i&&i.getCoord2&&(n=2,e=i.getCoord2(t))}return{coord:e,from:n}}(t),c=l.coord,h=l.from;if(s.dataToLayout){o=1,a=h;var u=s.dataToLayout(c);i=u.contentRect||u.rect}else n&&n.enableLayoutOnlyByCenter&&s.dataToPoint&&(o=2,a=h,r=s.dataToPoint(c))}return null==o&&(o=1),1===o&&(i||(i={x:0,y:0,width:e.getWidth(),height:e.getHeight()}),r=[i.x+i.width/2,i.y+i.height/2]),{type:o,refContainer:i,refPoint:r,boxCoordFrom:a}}function hg(t){var e=t.layoutMode||t.constructor.layoutMode;return xr(e)?e:e?{type:e}:null}function ug(t,e,n){var i=n&&n.ignoreSize;!mr(i)&&(i=[i,i]);var r=a(og[0],0),o=a(og[1],1);function a(n,r){var o={},a=0,l={},c=0;if(ig(n,function(e){l[e]=t[e]}),ig(n,function(t){Ur(e,t)&&(o[t]=l[t]=e[t]),s(o,t)&&a++,s(l,t)&&c++}),i[r])return s(e,n[1])?l[n[2]]=null:s(e,n[2])&&(l[n[1]]=null),l;if(2!==c&&a){if(a>=2)return o;for(var h=0;h<n.length;h++){var u=n[h];if(!Ur(o,u)&&Ur(t,u)){o[u]=t[u];break}}return o}return l}function s(t,e){return null!=t[e]&&"auto"!==t[e]}function l(t,e,n){ig(t,function(t){e[t]=n[t]})}l(og[0],t,r),l(og[1],t,o)}function dg(t){return function(t,e){return e&&t&&ig(rg,function(n){Ur(e,n)&&(t[n]=e[n])}),t}({},t)}pr(ag,"vertical"),pr(ag,"horizontal");var fg=yc(),pg=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.uid=om("ec_cpt_model"),r}return Ei(e,t),e.prototype.init=function(t,e,n){this.mergeDefaultAndTheme(t,n)},e.prototype.mergeDefaultAndTheme=function(t,e){var n=hg(this),i=n?dg(t):{};er(t,e.getTheme().get(this.mainType)),er(t,this.getDefaultOption()),n&&ug(t,i,n)},e.prototype.mergeOption=function(t,e){er(this.option,t,!0);var n=hg(this);n&&ug(this.option,t,n)},e.prototype.optionUpdated=function(t,e){},e.prototype.getDefaultOption=function(){var t=this.constructor;if(!function(t){return!(!t||!t[Mc])}(t))return t.defaultOption;var e=fg(this);if(!e.defaultOption){for(var n=[],i=t;i;){var r=i.prototype.defaultOption;r&&n.push(r),i=i.superClass}for(var o={},a=n.length-1;a>=0;a--)o=er(o,n[a],!0);e.defaultOption=o}return e.defaultOption},e.prototype.getReferringComponents=function(t,e){var n=t+"Index",i=t+"Id";return Cc(this.ecModel,t,{index:this.get(n,!0),id:this.get(i,!0)},e)},e.prototype.getBoxLayoutParams=function(){return e=!1,{left:(t=this).getShallow("left",e),top:t.getShallow("top",e),right:t.getShallow("right",e),bottom:t.getShallow("bottom",e),width:t.getShallow("width",e),height:t.getShallow("height",e)};var t,e},e.prototype.getZLevelKey=function(){return""},e.prototype.setZLevel=function(t){this.option.zlevel=t},e.protoInitialize=function(){var t=e.prototype;t.type="component",t.id="",t.name="",t.mainType="",t.subType="",t.componentIndex=0}(),e}(im);kc(pg,im),Fc(pg),function(t){var e={};t.registerSubTypeDefaulter=function(t,n){var i=Ac(t);e[i.main]=n},t.determineSubType=function(n,i){var r=i.type;if(!r){var o=Ac(n).main;t.hasSubTypes(n)&&e[o]&&(r=e[o](i))}return r}}(pg),function(t){function e(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e]}t.topologicalTravel=function(t,n,i,r){if(t.length){var o=function(t){var n={},i=[];return sr(t,function(r){var o=e(n,r),a=function(t,e){var n=[];return sr(t,function(t){rr(e,t)>=0&&n.push(t)}),n}(o.originalDeps=function(t){var e=[];return sr(pg.getClassesByMainType(t),function(t){e=e.concat(t.dependencies||t.prototype.dependencies||[])}),e=lr(e,function(t){return Ac(t).main}),"dataset"!==t&&rr(e,"dataset")<=0&&e.unshift("dataset"),e}(r),t);o.entryCount=a.length,0===o.entryCount&&i.push(r),sr(a,function(t){rr(o.predecessor,t)<0&&o.predecessor.push(t);var i=e(n,t);rr(i.successor,t)<0&&i.successor.push(r)})}),{graph:n,noEntryList:i}}(n),a=o.graph,s=o.noEntryList,l={};for(sr(t,function(t){l[t]=!0});s.length;){var c=s.pop(),h=a[c],u=!!l[c];u&&(i.call(r,c,h.originalDeps.slice()),delete l[c]),sr(h.successor,u?f:d)}sr(l,function(){throw new Error("")})}function d(t){a[t].entryCount--,0===a[t].entryCount&&s.push(t)}function f(t){l[t]=!0,d(t)}}}(pg);var mg={color:{},darkColor:{},size:{}},gg=mg.color={theme:["#5070dd","#b6d634","#505372","#ff994d","#0ca8df","#ffd10a","#fb628b","#785db0","#3fbe95"],neutral00:"#fff",neutral05:"#f4f7fd",neutral10:"#e8ebf0",neutral15:"#dbdee4",neutral20:"#cfd2d7",neutral25:"#c3c5cb",neutral30:"#b7b9be",neutral35:"#aaacb2",neutral40:"#9ea0a5",neutral45:"#929399",neutral50:"#86878c",neutral55:"#797b7f",neutral60:"#6d6e73",neutral65:"#616266",neutral70:"#54555a",neutral75:"#48494d",neutral80:"#3c3c41",neutral85:"#303034",neutral90:"#232328",neutral95:"#17171b",neutral99:"#000",accent05:"#eff1f9",accent10:"#e0e4f2",accent15:"#d0d6ec",accent20:"#c0c9e6",accent25:"#b1bbdf",accent30:"#a1aed9",accent35:"#91a0d3",accent40:"#8292cc",accent45:"#7285c6",accent50:"#6578ba",accent55:"#5c6da9",accent60:"#536298",accent65:"#4a5787",accent70:"#404c76",accent75:"#374165",accent80:"#2e3654",accent85:"#252b43",accent90:"#1b2032",accent95:"#121521",transparent:"rgba(0,0,0,0)",highlight:"rgba(255,231,130,0.8)"};for(var vg in nr(gg,{primary:gg.neutral80,secondary:gg.neutral70,tertiary:gg.neutral60,quaternary:gg.neutral50,disabled:gg.neutral20,border:gg.neutral30,borderTint:gg.neutral20,borderShade:gg.neutral40,background:gg.neutral05,backgroundTint:"rgba(234,237,245,0.5)",backgroundTransparent:"rgba(255,255,255,0)",backgroundShade:gg.neutral10,shadow:"rgba(0,0,0,0.2)",shadowTint:"rgba(129,130,136,0.2)",axisLine:gg.neutral70,axisLineTint:gg.neutral40,axisTick:gg.neutral70,axisTickMinor:gg.neutral60,axisLabel:gg.neutral70,axisSplitLine:gg.neutral15,axisMinorSplitLine:gg.neutral05}),gg)if(gg.hasOwnProperty(vg)){var yg=gg[vg];"theme"===vg?mg.darkColor.theme=gg.theme.slice():"highlight"===vg?mg.darkColor.highlight="rgba(255,231,130,0.4)":0===vg.indexOf("accent")?mg.darkColor[vg]=fs(yg,null,function(t){return.5*t},function(t){return Math.min(1,1.3-t)}):mg.darkColor[vg]=fs(yg,null,function(t){return.9*t},function(t){return 1-Math.pow(t,1.5)})}mg.size={xxs:2,xs:5,s:10,m:15,l:20,xl:30,xxl:40,xxxl:50};var bg="";"undefined"!=typeof navigator&&(bg=navigator.platform||"");var xg="rgba(0, 0, 0, 0.2)",wg=mg.color.theme[0],Sg=fs(wg,null,null,.9);const Cg={darkMode:"auto",colorBy:"series",color:mg.color.theme,gradientColor:[Sg,wg],aria:{decal:{decals:[{color:xg,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:xg,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:xg,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:xg,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:xg,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:xg,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:bg.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var Tg=Or(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),$g="original",Mg="arrayRows",Ag="objectRows",Ng="keyedColumns",kg="typedArray",Rg="unknown",_g="column",Ig="row",Fg=yc();function Eg(t,e,n){var i={},r=Lg(e);if(!r||!t)return i;var o,a,s=[],l=[],c=e.ecModel,h=Fg(c).datasetMap,u=r.uid+"_"+n.seriesLayoutBy;sr(t=t.slice(),function(e,n){var r=xr(e)?e:t[n]={name:e};"ordinal"===r.type&&null==o&&(o=n,a=p(r)),i[r.name]=[]});var d=h.get(u)||h.set(u,{categoryWayDim:a,valueWayDim:0});function f(t,e,n){for(var i=0;i<n;i++)t.push(e+i)}function p(t){var e=t.dimsDef;return e?e.length:1}return sr(t,function(t,e){var n=t.name,r=p(t);if(null==o){var a=d.valueWayDim;f(i[n],a,r),f(l,a,r),d.valueWayDim+=r}else o===e?(f(i[n],0,r),f(s,0,r)):(a=d.categoryWayDim,f(i[n],a,r),f(l,a,r),d.categoryWayDim+=r)}),s.length&&(i.itemName=s),l.length&&(i.seriesName=l),i}function Dg(t,e,n){var i={};if(!Lg(t))return i;var r,o=e.sourceFormat,a=e.dimensionsDefine;o!==Ag&&o!==Ng||sr(a,function(t,e){"name"===(xr(t)?t.name:t)&&(r=e)});var s=function(){for(var t={},i={},s=[],l=0,c=Math.min(5,n);l<c;l++){var h=zg(e.data,o,e.seriesLayoutBy,a,e.startIndex,l);s.push(h);var u=3===h;if(u&&null==t.v&&l!==r&&(t.v=l),(null==t.n||t.n===t.v||!u&&3===s[t.n])&&(t.n=l),d(t)&&3!==s[t.n])return t;u||(2===h&&null==i.v&&l!==r&&(i.v=l),null!=i.n&&i.n!==i.v||(i.n=l))}function d(t){return null!=t.v&&null!=t.n}return d(t)?t:d(i)?i:null}();if(s){i.value=[s.v];var l=null!=r?r:s.n;i.itemName=[l],i.seriesName=[l]}return i}function Lg(t){if(!t.get("data",!0))return Cc(t.ecModel,"dataset",{index:t.get("datasetIndex",!0),id:t.get("datasetId",!0)},Sc).models[0]}function Pg(t,e){return zg(t.data,t.sourceFormat,t.seriesLayoutBy,t.dimensionsDefine,t.startIndex,e)}function zg(t,e,n,i,r,o){var a,s,l;if(Sr(t))return 3;if(i){var c=i[o];xr(c)?(s=c.name,l=c.type):vr(c)&&(s=c)}if(null!=l)return"ordinal"===l?1:3;if(e===Mg){var h=t;if(n===Ig){for(var u=h[o],d=0;d<(u||[]).length&&d<5;d++)if(null!=(a=y(u[r+d])))return a}else for(d=0;d<h.length&&d<5;d++){var f=h[r+d];if(f&&null!=(a=y(f[o])))return a}}else if(e===Ag){var p=t;if(!s)return 3;for(d=0;d<p.length&&d<5;d++)if((g=p[d])&&null!=(a=y(g[s])))return a}else if(e===Ng){if(!s)return 3;if(!(u=t[s])||Sr(u))return 3;for(d=0;d<u.length&&d<5;d++)if(null!=(a=y(u[d])))return a}else if(e===$g){var m=t;for(d=0;d<m.length&&d<5;d++){var g,v=hc(g=m[d]);if(!mr(v))return 3;if(null!=(a=y(v[o])))return a}}function y(t){var e=vr(t);return null!=t&&Number.isFinite(Number(t))&&""!==t?e?2:3:e&&"-"!==t?1:void 0}return 3}var Og,Bg,Vg,Hg=Or(),Ug=yc(),qg=yc(),Kg=function(){function t(){}return t.prototype.getColorFromPalette=function(t,e,n){var i=sc(this.get("color",!0)),r=this.get("colorLayer",!0);return Wg(this,Ug,i,r,t,e,n)},t.prototype.clearColorPalette=function(){!function(t,e){e(t).paletteIdx=0,e(t).paletteNameMap={}}(this,Ug)},t}();function Wg(t,e,n,i,r,o,a){var s=e(o=o||t),l=s.paletteIdx||0,c=s.paletteNameMap=s.paletteNameMap||{};if(c.hasOwnProperty(r))return c[r];var h=null!=a&&i?function(t,e){for(var n=t.length,i=0;i<n;i++)if(t[i].length>e)return t[i];return t[n-1]}(i,a):n;if((h=h||n)&&h.length){var u=h[l];return r&&(c[r]=u),s.paletteIdx=(l+1)%h.length,u}}var jg="\0_ec_inner",Gg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.init=function(t,e,n,i,r,o){i=i||{},this.option=null,this.lc=new im(i),this.cc=new im(r),this.hc=o},e.prototype.setOption=function(t,e,n){var i=Zg(e);this.hc.setOption(t,n,i),this.uc(null,i)},e.prototype.resetOption=function(t,e){return this.uc(t,Zg(e))},e.prototype.uc=function(t,e){var n=!1,i=this.hc;if(!t||"recreate"===t){var r=i.mountOption("recreate"===t);this.option&&"recreate"!==t?(this.restoreData(),this.fc(r,e)):Vg(this,r),n=!0}if("timeline"!==t&&"media"!==t||this.restoreData(),!t||"recreate"===t||"timeline"===t){var o=i.getTimelineOption(this);o&&(n=!0,this.fc(o,e))}if(!t||"recreate"===t||"media"===t){var a=i.getMediaOption(this);a.length&&sr(a,function(t){n=!0,this.fc(t,e)},this)}return n},e.prototype.mergeOption=function(t){this.fc(t,null)},e.prototype.fc=function(t,e){var n=this.option,i=this.dc,r=this.mc,o=[],a=Or(),s=e&&e.replaceMergeMainTypeMap;Fg(this).datasetMap=Or(),sr(t,function(t,e){null!=t&&(pg.hasClass(e)?e&&(o.push(e),a.set(e,!0)):n[e]=null==n[e]?tr(t):er(n[e],t,!0))}),s&&s.each(function(t,e){pg.hasClass(e)&&!a.get(e)&&(o.push(e),a.set(e,!0))}),pg.topologicalTravel(o,pg.getAllClassMainTypes(),function(e){var o=function(t,e,n){var i=Hg.get(e);if(!i)return n;var r=i(t);return r?n.concat(r):n}(this,e,sc(t[e])),a=i.get(e),l=function(t,e,n){var i="normalMerge"===n,r="replaceMerge"===n,o="replaceAll"===n;t=t||[],e=(e||[]).slice();var a=Or();sr(e,function(t,n){xr(t)||(e[n]=null)});var s=function(t,e,n){var i=[];if("replaceAll"===n)return i;for(var r=0;r<t.length;r++){var o=t[r];o&&null!=o.id&&e.set(o.id,r),i.push({existing:"replaceMerge"===n||gc(o)?null:o,newOption:null,keyInfo:null,brandNew:null})}return i}(t,a,n);return(i||r)&&function(t,e,n,i){sr(i,function(r,o){if(r&&null!=r.id){var a=fc(r.id),s=n.get(a);if(null!=s){var l=t[s];_r(!l.newOption,'Duplicated option on id "'+a+'".'),l.newOption=r,l.existing=e[s],i[o]=null}}})}(s,t,a,e),i&&function(t,e){sr(e,function(n,i){if(n&&null!=n.name)for(var r=0;r<t.length;r++){var o=t[r].existing;if(!t[r].newOption&&o&&(null==o.id||null==n.id)&&!gc(n)&&!gc(o)&&dc("name",o,n))return t[r].newOption=n,void(e[i]=null)}})}(s,e),i||r?function(t,e,n){sr(e,function(e){if(e){for(var i,r=0;(i=t[r])&&(i.newOption||gc(i.existing)||i.existing&&null!=e.id&&!dc("id",e,i.existing));)r++;i?(i.newOption=e,i.brandNew=n):t.push({newOption:e,brandNew:n,existing:null,keyInfo:null}),r++}})}(s,e,r):o&&function(t,e){sr(e,function(e){t.push({newOption:e,brandNew:!0,existing:null,keyInfo:null})})}(s,e),function(t){var e=Or();sr(t,function(t){var n=t.existing;n&&e.set(n.id,t)}),sr(t,function(t){var n=t.newOption;_r(!n||null==n.id||!e.get(n.id)||e.get(n.id)===t,"id duplicates: "+(n&&n.id)),n&&null!=n.id&&e.set(n.id,t),!t.keyInfo&&(t.keyInfo={})}),sr(t,function(t,n){var i=t.existing,r=t.newOption,o=t.keyInfo;if(xr(r)){if(o.name=null!=r.name?fc(r.name):i?i.name:ac+n,i)o.id=fc(i.id);else if(null!=r.id)o.id=fc(r.id);else{var a=0;do{o.id="\0"+o.name+"\0"+a++}while(e.get(o.id))}e.set(o.id,t)}})}(s),s}(a,o,a?s&&s.get(e)?"replaceMerge":"normalMerge":"replaceAll");(function(t,e,n){sr(t,function(t){var i=t.newOption;xr(i)&&(t.keyInfo.mainType=e,t.keyInfo.subType=function(t,e,n,i){return e.type?e.type:n?n.subType:i.determineSubType(t,e)}(e,i,t.existing,n))})})(l,e,pg),n[e]=null,i.set(e,null),r.set(e,0);var c,h=[],u=[],d=0;sr(l,function(t,n){var i=t.existing,r=t.newOption;if(r){var o="series"===e,a=pg.getClass(e,t.keyInfo.subType,!o);if(!a)return;if("tooltip"===e){if(c)return;c=!0}if(i&&i.constructor===a)i.name=t.keyInfo.name,i.mergeOption(r,this),i.optionUpdated(r,!1);else{var s=nr({componentIndex:n},t.keyInfo);nr(i=new a(r,this,this,s),s),t.brandNew&&(i.__requireNewView=!0),i.init(r,this,this),i.optionUpdated(null,!0)}}else i&&(i.mergeOption({},this),i.optionUpdated({},!1));i?(h.push(i.option),u.push(i),d++):(h.push(void 0),u.push(void 0))},this),n[e]=h,i.set(e,u),r.set(e,d),"series"===e&&Og(this)},this),this.vc||Og(this)},e.prototype.getOption=function(){var t=tr(this.option);return sr(t,function(e,n){if(pg.hasClass(n)){for(var i=sc(e),r=i.length,o=!1,a=r-1;a>=0;a--)i[a]&&!gc(i[a])?o=!0:(i[a]=null,!o&&r--);i.length=r,t[n]=i}}),delete t[jg],t},e.prototype.setTheme=function(t){this.lc=new im(t),this.uc("recreate",null)},e.prototype.getTheme=function(){return this.lc},e.prototype.getLocaleModel=function(){return this.cc},e.prototype.setUpdatePayload=function(t){this.gc=t},e.prototype.getUpdatePayload=function(){return this.gc},e.prototype.getComponent=function(t,e){var n=this.dc.get(t);if(n){var i=n[e||0];if(i)return i;if(null==e)for(var r=0;r<n.length;r++)if(n[r])return n[r]}},e.prototype.queryComponents=function(t){var e=t.mainType;if(!e)return[];var n,i=t.index,r=t.id,o=t.name,a=this.dc.get(e);return a&&a.length?(null!=i?(n=[],sr(sc(i),function(t){a[t]&&n.push(a[t])})):n=null!=r?Xg("id",r,a):null!=o?Xg("name",o,a):hr(a,function(t){return!!t}),Yg(n,t)):[]},e.prototype.findComponents=function(t){var e,n=t.query,i=t.mainType,r=function(t){var e=i+"Index",n=i+"Id",r=i+"Name";return!t||null==t[e]&&null==t[n]&&null==t[r]?null:{mainType:i,index:t[e],id:t[n],name:t[r]}}(n);return e=Yg(r?this.queryComponents(r):hr(this.dc.get(i),function(t){return!!t}),t),t.filter?hr(e,t.filter):e},e.prototype.eachComponent=function(t,e,n){var i=this.dc;if(gr(t)){var r=e,o=t;i.each(function(t,e){for(var n=0;t&&n<t.length;n++){var i=t[n];i&&o.call(r,e,i,i.componentIndex)}})}else for(var a=vr(t)?i.get(t):xr(t)?this.findComponents(t):null,s=0;a&&s<a.length;s++){var l=a[s];l&&e.call(n,l,l.componentIndex)}},e.prototype.getSeriesByName=function(t){var e=pc(t,null);return hr(this.dc.get("series"),function(t){return!!t&&null!=e&&t.name===e})},e.prototype.getSeriesByIndex=function(t){return this.dc.get("series")[t]},e.prototype.getSeriesByType=function(t){return hr(this.dc.get("series"),function(e){return!!e&&e.subType===t})},e.prototype.getSeries=function(){return hr(this.dc.get("series"),function(t){return!!t})},e.prototype.getSeriesCount=function(){return this.mc.get("series")},e.prototype.eachSeries=function(t,e){Bg(this),sr(this.vc,function(n){var i=this.dc.get("series")[n];t.call(e,i,n)},this)},e.prototype.eachRawSeries=function(t,e){sr(this.dc.get("series"),function(n){n&&t.call(e,n,n.componentIndex)})},e.prototype.eachSeriesByType=function(t,e,n){Bg(this),sr(this.vc,function(i){var r=this.dc.get("series")[i];r.subType===t&&e.call(n,r,i)},this)},e.prototype.eachRawSeriesByType=function(t,e,n){return sr(this.getSeriesByType(t),e,n)},e.prototype.isSeriesFiltered=function(t){return Bg(this),null==this.yc.get(t.componentIndex)},e.prototype.getCurrentSeriesIndices=function(){return(this.vc||[]).slice()},e.prototype.filterSeries=function(t,e){Bg(this);var n=[];sr(this.vc,function(i){var r=this.dc.get("series")[i];t.call(e,r,i)&&n.push(i)},this),this.vc=n,this.yc=Or(n)},e.prototype.restoreData=function(t){Og(this);var e=this.dc,n=[];e.each(function(t,e){pg.hasClass(e)&&n.push(e)}),pg.topologicalTravel(n,pg.getAllClassMainTypes(),function(n){sr(e.get(n),function(e){!e||"series"===n&&function(t,e){if(e){var n=e.seriesIndex,i=e.seriesId,r=e.seriesName;return null!=n&&t.componentIndex!==n||null!=i&&t.id!==i||null!=r&&t.name!==r}}(e,t)||e.restoreData()})})},e.internalField=(Og=function(t){var e=t.vc=[];sr(t.dc.get("series"),function(t){t&&e.push(t.componentIndex)}),t.yc=Or(e)},Bg=function(t){},void(Vg=function(t,e){t.option={},t.option[jg]=1,t.dc=Or({series:[]}),t.mc=Or();var n=e.aria;xr(n)&&null==n.enabled&&(n.enabled=!0),function(t,e){var n=t.color&&!t.colorLayer;sr(e,function(e,i){"colorLayer"===i&&n||"color"===i&&t.color||pg.hasClass(i)||("object"==typeof e?t[i]=t[i]?er(t[i],e,!1):tr(e):null==t[i]&&(t[i]=e))})}(e,t.lc.option),er(e,Cg,!1),t.fc(e,null)})),e}(im);function Xg(t,e,n){if(mr(e)){var i=Or();return sr(e,function(t){null!=t&&null!=pc(t,null)&&i.set(t,!0)}),hr(n,function(e){return e&&i.get(e[t])})}var r=pc(e,null);return hr(n,function(e){return e&&null!=r&&e[t]===r})}function Yg(t,e){return e.hasOwnProperty("subType")?hr(t,function(t){return t&&t.subType===e.subType}):t}function Zg(t){var e=Or();return t&&sr(sc(t.replaceMerge),function(t){e.set(t,!0)}),{replaceMergeMainTypeMap:e}}or(Gg,Kg);var Jg=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],Qg=function(t){sr(Jg,function(e){this[e]=fr(t[e],t)},this)},tv=/^(min|max)?(.+)$/,ev=function(){function t(t){this.wc=[],this.xc=[],this.$c=[],this.Mc=t}return t.prototype.setOption=function(t,e,n){t&&(sr(sc(t.series),function(t){t&&t.data&&Sr(t.data)&&Er(t.data)}),sr(sc(t.dataset),function(t){t&&t.source&&Sr(t.source)&&Er(t.source)})),t=tr(t);var i=this.Cc,r=function(t,e,n){var i,r,o=[],a=t.baseOption,s=t.timeline,l=t.options,c=t.media,h=!!t.media,u=!!(l||s||a&&a.timeline);function d(t){sr(e,function(e){e(t,n)})}return a?(r=a).timeline||(r.timeline=s):((u||h)&&(t.options=t.media=null),r=t),h&&mr(c)&&sr(c,function(t){t&&t.option&&(t.query?o.push(t):i||(i=t))}),d(r),sr(l,function(t){return d(t)}),sr(o,function(t){return d(t.option)}),{baseOption:r,timelineOptions:l||[],mediaDefault:i,mediaList:o}}(t,e,!i);this.Sc=r.baseOption,i?(r.timelineOptions.length&&(i.timelineOptions=r.timelineOptions),r.mediaList.length&&(i.mediaList=r.mediaList),r.mediaDefault&&(i.mediaDefault=r.mediaDefault)):this.Cc=r},t.prototype.mountOption=function(t){var e=this.Cc;return this.wc=e.timelineOptions,this.xc=e.mediaList,this.Rc=e.mediaDefault,this.$c=[],tr(t?e.baseOption:this.Sc)},t.prototype.getTimelineOption=function(t){var e,n=this.wc;if(n.length){var i=t.getComponent("timeline");i&&(e=tr(n[i.getCurrentIndex()]))}return e},t.prototype.getMediaOption=function(t){var e,n,i=this.Mc.getWidth(),r=this.Mc.getHeight(),o=this.xc,a=this.Rc,s=[],l=[];if(!o.length&&!a)return l;for(var c=0,h=o.length;c<h;c++)nv(o[c].query,i,r)&&s.push(c);return!s.length&&a&&(s=[-1]),s.length&&(e=s,n=this.$c,e.join(",")!==n.join(","))&&(l=lr(s,function(t){return tr(-1===t?a.option:o[t].option)})),this.$c=s,l},t}();function nv(t,e,n){var i={width:e,height:n,aspectratio:e/n},r=!0;return sr(t,function(t,e){var n=e.match(tv);if(n&&n[1]&&n[2]){var o=n[1],a=n[2].toLowerCase();(function(t,e,n){return"min"===n?t>=e:"max"===n?t<=e:t===e})(i[a],t,o)||(r=!1)}}),r}var iv=sr,rv=xr,ov=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function av(t){var e=t&&t.itemStyle;if(e)for(var n=0,i=ov.length;n<i;n++){var r=ov[n],o=e.normal,a=e.emphasis;o&&o[r]&&(t[r]=t[r]||{},t[r].normal?er(t[r].normal,o[r]):t[r].normal=o[r],o[r]=null),a&&a[r]&&(t[r]=t[r]||{},t[r].emphasis?er(t[r].emphasis,a[r]):t[r].emphasis=a[r],a[r]=null)}}function sv(t,e,n){if(t&&t[e]&&(t[e].normal||t[e].emphasis)){var i=t[e].normal,r=t[e].emphasis;i&&(n?(t[e].normal=t[e].emphasis=null,ir(t[e],i)):t[e]=i),r&&(t.emphasis=t.emphasis||{},t.emphasis[e]=r,r.focus&&(t.emphasis.focus=r.focus),r.blurScope&&(t.emphasis.blurScope=r.blurScope))}}function lv(t){sv(t,"itemStyle"),sv(t,"lineStyle"),sv(t,"areaStyle"),sv(t,"label"),sv(t,"labelLine"),sv(t,"upperLabel"),sv(t,"edgeLabel")}function cv(t,e){var n=rv(t)&&t[e],i=rv(n)&&n.textStyle;if(i)for(var r=0,o=cc.length;r<o;r++){var a=cc[r];i.hasOwnProperty(a)&&(n[a]=i[a])}}function hv(t){t&&(lv(t),cv(t,"label"),t.emphasis&&cv(t.emphasis,"label"))}function uv(t){return mr(t)?t:t?[t]:[]}function dv(t){return(mr(t)?t[0]:t)||{}}function fv(t){t&&sr(pv,function(e){e[0]in t&&!(e[1]in t)&&(t[e[1]]=t[e[0]])})}var pv=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],mv=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],gv=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function vv(t){var e=t&&t.itemStyle;if(e)for(var n=0;n<gv.length;n++){var i=gv[n][1],r=gv[n][0];null!=e[i]&&(e[r]=e[i])}}function yv(t){t&&"edge"===t.alignTo&&null!=t.margin&&null==t.edgeDistance&&(t.edgeDistance=t.margin)}function bv(t){t&&t.downplay&&!t.blur&&(t.blur=t.downplay)}function xv(t,e){if(t)for(var n=0;n<t.length;n++)e(t[n]),t[n]&&xv(t[n].children,e)}function wv(t,e){(function(t,e){iv(uv(t.series),function(t){rv(t)&&function(t){if(rv(t)){av(t),lv(t),cv(t,"label"),cv(t,"upperLabel"),cv(t,"edgeLabel"),t.emphasis&&(cv(t.emphasis,"label"),cv(t.emphasis,"upperLabel"),cv(t.emphasis,"edgeLabel"));var e=t.markPoint;e&&(av(e),hv(e));var n=t.markLine;n&&(av(n),hv(n));var i=t.markArea;i&&hv(i);var r=t.data;if("graph"===t.type){r=r||t.nodes;var o=t.links||t.edges;if(o&&!Sr(o))for(var a=0;a<o.length;a++)hv(o[a]);sr(t.categories,function(t){lv(t)})}if(r&&!Sr(r))for(a=0;a<r.length;a++)hv(r[a]);if((e=t.markPoint)&&e.data){var s=e.data;for(a=0;a<s.length;a++)hv(s[a])}if((n=t.markLine)&&n.data){var l=n.data;for(a=0;a<l.length;a++)mr(l[a])?(hv(l[a][0]),hv(l[a][1])):hv(l[a])}"gauge"===t.type?(cv(t,"axisLabel"),cv(t,"title"),cv(t,"detail")):"treemap"===t.type?(sv(t.breadcrumb,"itemStyle"),sr(t.levels,function(t){lv(t)})):"tree"===t.type&&lv(t.leaves)}}(t)});var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),iv(n,function(e){iv(uv(t[e]),function(t){t&&(cv(t,"axisLabel"),cv(t.axisPointer,"label"))})}),iv(uv(t.parallel),function(t){var e=t&&t.parallelAxisDefault;cv(e,"axisLabel"),cv(e&&e.axisPointer,"label")}),iv(uv(t.calendar),function(t){sv(t,"itemStyle"),cv(t,"dayLabel"),cv(t,"monthLabel"),cv(t,"yearLabel")}),iv(uv(t.radar),function(t){cv(t,"name"),t.name&&null==t.axisName&&(t.axisName=t.name,delete t.name),null!=t.nameGap&&null==t.axisNameGap&&(t.axisNameGap=t.nameGap,delete t.nameGap)}),iv(uv(t.geo),function(t){rv(t)&&(hv(t),iv(uv(t.regions),function(t){hv(t)}))}),iv(uv(t.timeline),function(t){hv(t),sv(t,"label"),sv(t,"itemStyle"),sv(t,"controlStyle",!0);var e=t.data;mr(e)&&sr(e,function(t){xr(t)&&(sv(t,"label"),sv(t,"itemStyle"))})}),iv(uv(t.toolbox),function(t){sv(t,"iconStyle"),iv(t.feature,function(t){sv(t,"iconStyle")})}),cv(dv(t.axisPointer),"label"),cv(dv(t.tooltip).axisPointer,"label")})(t,e),t.series=sc(t.series),sr(t.series,function(t){if(xr(t)){var e=t.type;if("line"===e)null!=t.clipOverflow&&(t.clip=t.clipOverflow);else if("pie"===e||"gauge"===e){if(null!=t.clockWise&&(t.clockwise=t.clockWise),yv(t.label),(r=t.data)&&!Sr(r))for(var n=0;n<r.length;n++)yv(r[n]);null!=t.hoverOffset&&(t.emphasis=t.emphasis||{},(t.emphasis.scaleSize=null)&&(t.emphasis.scaleSize=t.hoverOffset))}else if("gauge"===e){var i=function(t){for(var e="pointer.color".split(","),n=t,i=0;i<e.length&&null!=(n=n&&n[e[i]]);i++);return n}(t);null!=i&&function(t,e,n){for(var i,r="itemStyle.color".split(","),o=t,a=0;a<r.length-1;a++)null==o[i=r[a]]&&(o[i]={}),o=o[i];null==o[r[a]]&&(o[r[a]]=n)}(t,0,i)}else if("bar"===e){var r;if(vv(t),vv(t.backgroundStyle),vv(t.emphasis),(r=t.data)&&!Sr(r))for(n=0;n<r.length;n++)"object"==typeof r[n]&&(vv(r[n]),vv(r[n]&&r[n].emphasis))}else if("sunburst"===e){var o=t.highlightPolicy;o&&(t.emphasis=t.emphasis||{},t.emphasis.focus||(t.emphasis.focus=o)),bv(t),xv(t.data,bv)}else"graph"===e||"sankey"===e?function(t){t&&null!=t.focusNodeAdjacency&&(t.emphasis=t.emphasis||{},null==t.emphasis.focus&&(t.emphasis.focus="adjacency"))}(t):"map"===e&&(t.mapType&&!t.map&&(t.map=t.mapType),t.mapLocation&&ir(t,t.mapLocation));null!=t.hoverAnimation&&(t.emphasis=t.emphasis||{},t.emphasis&&null==t.emphasis.scale&&(t.emphasis.scale=t.hoverAnimation)),fv(t)}}),t.dataRange&&(t.visualMap=t.dataRange),sr(mv,function(e){var n=t[e];n&&(mr(n)||(n=[n]),sr(n,function(t){fv(t)}))})}var Sv,Cv,Tv,$v,Mv,Av,Nv=function(t){this.data=t.data||(t.sourceFormat===Ng?{}:[]),this.sourceFormat=t.sourceFormat||Rg,this.seriesLayoutBy=t.seriesLayoutBy||_g,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var e=this.dimensionsDefine=t.dimensionsDefine;if(e)for(var n=0;n<e.length;n++){var i=e[n];null==i.type&&1===Pg(this,n)&&(i.type="ordinal")}};function kv(t){return t instanceof Nv}function Rv(t,e,n){n=n||Iv(t);var i=e.seriesLayoutBy,r=function(t,e,n,i,r){var o,a;if(!t)return{dimensionsDefine:Fv(r),startIndex:a,dimensionsDetectedCount:o};if(e===Mg){var s=t;"auto"===i||null==i?Ev(function(t){null!=t&&"-"!==t&&(vr(t)?null==a&&(a=1):a=0)},n,s,10):a=br(i)?i:i?1:0,r||1!==a||(r=[],Ev(function(t,e){r[e]=null!=t?t+"":""},n,s,1/0)),o=r?r.length:n===Ig?s.length:s[0]?s[0].length:null}else if(e===Ag)r||(r=function(t){for(var e,n=0;n<t.length&&!(e=t[n++]););if(e)return dr(e)}(t));else if(e===Ng)r||(r=[],sr(t,function(t,e){r.push(e)}));else if(e===$g){var l=hc(t[0]);o=mr(l)&&l.length||1}return{startIndex:a,dimensionsDefine:Fv(r),dimensionsDetectedCount:o}}(t,n,i,e.sourceHeader,e.dimensions);return new Nv({data:t,sourceFormat:n,seriesLayoutBy:i,dimensionsDefine:r.dimensionsDefine,startIndex:r.startIndex,dimensionsDetectedCount:r.dimensionsDetectedCount,metaRawOption:tr(e)})}function _v(t){return new Nv({data:t,sourceFormat:Sr(t)?kg:$g})}function Iv(t){var e=Rg;if(Sr(t))e=kg;else if(mr(t)){0===t.length&&(e=Mg);for(var n=0,i=t.length;n<i;n++){var r=t[n];if(null!=r){if(mr(r)||Sr(r)){e=Mg;break}if(xr(r)){e=Ag;break}}}}else if(xr(t))for(var o in t)if(Ur(t,o)&&ar(t[o])){e=Ng;break}return e}function Fv(t){if(t){var e=Or();return lr(t,function(t,n){var i={name:(t=xr(t)?t:{name:t}).name,displayName:t.displayName,type:t.type};if(null==i.name)return i;i.name+="",null==i.displayName&&(i.displayName=i.name);var r=e.get(i.name);return r?i.name+="-"+r.count++:e.set(i.name,{count:1}),i})}}function Ev(t,e,n,i){if(e===Ig)for(var r=0;r<n.length&&r<i;r++)t(n[r]?n[r][0]:null,r);else{var o=n[0]||[];for(r=0;r<o.length&&r<i;r++)t(o[r],r)}}function Dv(t){var e=t.sourceFormat;return e===Ag||e===Ng}var Lv=function(){function t(t,e){var n=kv(t)?t:_v(t);this.Ac=n;var i=this.Ln=n.data,r=n.sourceFormat;n.seriesLayoutBy,r===kg&&(this.kc=0,this.Tc=e,this.Ln=i),Av(this,i,n)}return t.prototype.getSource=function(){return this.Ac},t.prototype.count=function(){return 0},t.prototype.getItem=function(t,e){},t.prototype.appendData=function(t){},t.prototype.clean=function(){},t.protoInitialize=function(){var e=t.prototype;e.pure=!1,e.persistent=!0}(),t.internalField=function(){var t;Av=function(t,r,o){var a=o.sourceFormat,s=o.seriesLayoutBy,l=o.startIndex,c=o.dimensionsDefine;if(nr(t,Mv[jv(a,s)]),a===kg)t.getItem=e,t.count=i,t.fillStorage=n;else{var h=Bv(a,s);t.getItem=fr(h,null,r,l,c);var u=Uv(a,s);t.count=fr(u,null,r,l,c)}};var e=function(t,e){t-=this.kc,e=e||[];for(var n=this.Ln,i=this.Tc,r=i*t,o=0;o<i;o++)e[o]=n[r+o];return e},n=function(t,e,n,i){for(var r=this.Ln,o=this.Tc,a=0;a<o;a++){for(var s=i[a],l=null==s[0]?1/0:s[0],c=null==s[1]?-1/0:s[1],h=e-t,u=n[a],d=0;d<h;d++){var f=r[d*o+a];u[t+d]=f,f<l&&(l=f),f>c&&(c=f)}s[0]=l,s[1]=c}},i=function(){return this.Ln?this.Ln.length/this.Tc:0};function r(t){for(var e=0;e<t.length;e++)this.Ln.push(t[e])}(t={})[Mg+"_"+_g]={pure:!0,appendData:r},t[Mg+"_"+Ig]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[Ag]={pure:!0,appendData:r},t[Ng]={pure:!0,appendData:function(t){var e=this.Ln;sr(t,function(t,n){for(var i=e[n]||(e[n]=[]),r=0;r<(t||[]).length;r++)i.push(t[r])})}},t[$g]={appendData:r},t[kg]={persistent:!1,pure:!0,appendData:function(t){this.Ln=t},clean:function(){this.kc+=this.count(),this.Ln=null}},Mv=t}(),t}(),Pv=function(t){mr(t)};(Sv={})[Mg+"_"+_g]=Pv,Sv[Mg+"_"+Ig]=Pv,Sv[Ag]=Pv,Sv[Ng]=function(t,e){for(var n=0;n<e.length;n++)null==e[n].name&&ic()},Sv[$g]=Pv;var zv=function(t,e,n,i){return t[i]},Ov=((Cv={})[Mg+"_"+_g]=function(t,e,n,i){return t[i+e]},Cv[Mg+"_"+Ig]=function(t,e,n,i,r){i+=e;for(var o=r||[],a=t,s=0;s<a.length;s++){var l=a[s];o[s]=l?l[i]:null}return o},Cv[Ag]=zv,Cv[Ng]=function(t,e,n,i,r){for(var o=r||[],a=0;a<n.length;a++){var s=n[a].name,l=null!=s?t[s]:null;o[a]=l?l[i]:null}return o},Cv[$g]=zv,Cv);function Bv(t,e){return Ov[jv(t,e)]}var Vv=function(t,e,n){return t.length},Hv=((Tv={})[Mg+"_"+_g]=function(t,e,n){return Math.max(0,t.length-e)},Tv[Mg+"_"+Ig]=function(t,e,n){var i=t[0];return i?Math.max(0,i.length-e):0},Tv[Ag]=Vv,Tv[Ng]=function(t,e,n){var i=n[0].name,r=null!=i?t[i]:null;return r?r.length:0},Tv[$g]=Vv,Tv);function Uv(t,e){return Hv[jv(t,e)]}var qv=function(t,e,n){return t[e]},Kv=(($v={})[Mg]=qv,$v[Ag]=function(t,e,n){return t[n]},$v[Ng]=qv,$v[$g]=function(t,e,n){var i=hc(t);return i instanceof Array?i[e]:i},$v[kg]=qv,$v);function Wv(t){return Kv[t]}function jv(t,e){return t===Mg?t+"_"+e:t}function Gv(t,e,n){if(t){var i=t.getRawDataItem(e);if(null!=i){var r=t.getStore(),o=r.getSource().sourceFormat;if(null!=n){var a=t.getDimensionIndex(n),s=r.getDimensionProperty(a);return Wv(o)(i,a,s)}var l=i;return o===$g&&(l=hc(i)),l}}}var Xv=/\{@(.+?)\}/g,Yv=function(){function t(){}return t.prototype.getDataParams=function(t,e){var n=this.getData(e),i=this.getRawValue(t,e),r=n.getRawIndex(t),o=n.getName(t),a=n.getRawDataItem(t),s=n.getItemVisual(t,"style"),l=s&&s[n.getItemVisual(t,"drawType")||"fill"],c=s&&s.stroke,h=this.mainType,u="series"===h,d=n.userOutput&&n.userOutput.get();return{componentType:h,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:u?this.subType:null,seriesIndex:this.seriesIndex,seriesId:u?this.id:null,seriesName:u?this.name:null,name:o,dataIndex:r,data:a,dataType:e,value:i,color:l,borderColor:c,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},t.prototype.getFormattedLabel=function(t,e,n,i,r,o){e=e||"normal";var a=this.getData(n),s=this.getDataParams(t,n);return o&&(s.value=o.interpolatedValue),null!=i&&mr(s.value)&&(s.value=s.value[i]),r||(r=a.getItemModel(t).get("normal"===e?["label","formatter"]:[e,"label","formatter"])),gr(r)?(s.status=e,s.dimensionIndex=i,r(s)):vr(r)?Ym(r,s).replace(Xv,function(e,n){var i=n.length,r=n;"["===r.charAt(0)&&"]"===r.charAt(i-1)&&(r=+r.slice(1,i-1));var s=Gv(a,t,r);if(o&&mr(o.interpolatedValue)){var l=a.getDimensionIndex(r);l>=0&&(s=o.interpolatedValue[l])}return null!=s?s+"":""}):void 0},t.prototype.getRawValue=function(t,e){return Gv(this.getData(e),t)},t.prototype.formatTooltip=function(t,e,n){},t}();function Zv(t){var e,n;return xr(t)?t.type&&(n=t):e=t,{text:e,frag:n}}function Jv(t){return new Qv(t)}var Qv=function(){function t(t){t=t||{},this.Nc=t.reset,this.Fc=t.plan,this._c=t.count,this.Ec=t.onDirty,this.Ii=!0}return t.prototype.perform=function(t){var e,n=this.Ic,i=t&&t.skip;if(this.Ii&&n){var r=this.context;r.data=r.outputData=n.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this.Fc&&!i&&(e=this.Fc(this.context));var o,a=h(this.zc),s=this.Dc||0,l=h(t&&t.modBy),c=t&&t.modDataCount||0;function h(t){return!(t>=1)&&(t=1),t}a===l&&s===c||(e="reset"),(this.Ii||"reset"===e)&&(this.Ii=!1,o=this.Lc(i)),this.zc=l,this.Dc=c;var u=t&&t.step;if(this.Oc=n?n.Pc:this._c?this._c(this.context):1/0,this.Vc){var d=this.Bc,f=Math.min(null!=u?this.Bc+u:1/0,this.Oc);if(!i&&(o||d<f)){var p=this.Vc;if(mr(p))for(var m=0;m<p.length;m++)this.Hc(p[m],d,f,l,c);else this.Hc(p,d,f,l,c)}this.Bc=f;var g=null!=this.Uc?this.Uc:f;this.Pc=g}else this.Bc=this.Pc=null!=this.Uc?this.Uc:this.Oc;return this.unfinished()},t.prototype.dirty=function(){this.Ii=!0,this.Ec&&this.Ec(this.context)},t.prototype.Hc=function(t,e,n,i,r){ty.reset(e,n,i,r),this.Kc=t,this.Kc({start:e,end:n,count:n-e,next:ty.next},this.context)},t.prototype.Lc=function(t){var e,n;this.Bc=this.Pc=this.Oc=0,this.Uc=null,!t&&this.Nc&&((e=this.Nc(this.context))&&e.progress&&(n=e.forceFirstProgress,e=e.progress),mr(e)&&!e.length&&(e=null)),this.Vc=e,this.zc=this.Dc=null;var i=this.Wc;return i&&i.dirty(),n},t.prototype.unfinished=function(){return this.Vc&&this.Bc<this.Oc},t.prototype.pipe=function(t){(this.Wc!==t||this.Ii)&&(this.Wc=t,t.Ic=this,t.dirty())},t.prototype.dispose=function(){this.ml||(this.Ic&&(this.Ic.Wc=null),this.Wc&&(this.Wc.Ic=null),this.Ii=!1,this.ml=!0)},t.prototype.getUpstream=function(){return this.Ic},t.prototype.getDownstream=function(){return this.Wc},t.prototype.setOutputEnd=function(t){this.Pc=this.Uc=t},t}(),ty=function(){var t,e,n,i,r,o={reset:function(l,c,h,u){e=l,t=c,n=h,i=u,r=Math.ceil(i/n),o.next=n>1&&i>0?s:a}};return o;function a(){return e<t?e++:null}function s(){var o=e%r*n+Math.ceil(e/r),a=e>=t?null:o<i?o:e;return e++,a}}();function ey(t,e){var n=e&&e.type;return"ordinal"===n?t:("time"!==n||br(t)||null==t||"-"===t||(t=+Yl(t)),null==t||""===t?NaN:Number(t))}Or({"number":function(t){return parseFloat(t)},"time":function(t){return+Yl(t)},"trim":function(t){return vr(t)?Ir(t):t}});var ny=function(){function t(t,e){var n="desc"===t;this.jc=n?1:-1,null==e&&(e=n?"min":"max"),this.qc="min"===e?-1/0:1/0}return t.prototype.evaluate=function(t,e){var n=br(t)?t:Ql(t),i=br(e)?e:Ql(e),r=isNaN(n),o=isNaN(i);if(r&&(n=this.qc),o&&(i=this.qc),r&&o){var a=vr(t),s=vr(e);a&&(n=s?t:0),s&&(i=a?e:0)}return n<i?this.jc:n>i?-this.jc:0},t}(),iy=function(){function t(){}return t.prototype.getRawData=function(){throw new Error("not supported")},t.prototype.getRawDataItem=function(t){throw new Error("not supported")},t.prototype.cloneRawData=function(){},t.prototype.getDimensionInfo=function(t){},t.prototype.cloneAllDimensionInfo=function(){},t.prototype.count=function(){},t.prototype.retrieveValue=function(t,e){},t.prototype.retrieveValueFromItem=function(t,e){},t.prototype.convertValue=function(t,e){return ey(t,e)},t}();function ry(t){return hy(t.sourceFormat)||rc(""),t.data}function oy(t){var e=t.sourceFormat,n=t.data;if(hy(e)||rc(""),e===Mg){for(var i=[],r=0,o=n.length;r<o;r++)i.push(n[r].slice());return i}if(e===Ag){for(i=[],r=0,o=n.length;r<o;r++)i.push(nr({},n[r]));return i}}function ay(t,e,n){if(null!=n)return br(n)||!isNaN(n)&&!Ur(e,n)?t[n]:Ur(e,n)?e[n]:void 0}function sy(t){return tr(t)}var ly=Or();function cy(t,e,n,i){e.length||rc(""),xr(t)||rc("");var r=t.type,o=ly.get(r);o||rc("");var a=lr(e,function(t){return function(t,e){var n=new iy,i=t.data,r=n.sourceFormat=t.sourceFormat,o=t.startIndex;t.seriesLayoutBy!==_g&&rc("");var a=[],s={},l=t.dimensionsDefine;if(l)sr(l,function(t,e){var n=t.name,i={index:e,name:n,displayName:t.displayName};a.push(i),null!=n&&(Ur(s,n)&&rc(""),s[n]=i)});else for(var c=0;c<t.dimensionsDetectedCount;c++)a.push({index:c});var h=Bv(r,_g);e.__isBuiltIn&&(n.getRawDataItem=function(t){return h(i,o,a,t)},n.getRawData=fr(ry,null,t)),n.cloneRawData=fr(oy,null,t);var u=Uv(r,_g);n.count=fr(u,null,i,o,a);var d=Wv(r);n.retrieveValue=function(t,e){var n=h(i,o,a,t);return f(n,e)};var f=n.retrieveValueFromItem=function(t,e){if(null!=t){var n=a[e];return n?d(t,e,n.name):void 0}};return n.getDimensionInfo=fr(ay,null,a,s),n.cloneAllDimensionInfo=fr(sy,null,a),n}(t,o)});return lr(sc(o.transform({upstream:a[0],upstreamList:a,config:tr(t.config)})),function(t,n){var i;xr(t)||rc(""),t.data||rc(""),hy(Iv(t.data))||rc("");var r=e[0];if(r&&0===n&&!t.dimensions){var o=r.startIndex;o&&(t.data=r.data.slice(0,o).concat(t.data)),i={seriesLayoutBy:_g,sourceHeader:o,dimensions:r.metaRawOption.dimensions}}else i={seriesLayoutBy:_g,sourceHeader:0,dimensions:t.dimensions};return Rv(t.data,i,null)})}function hy(t){return t===Mg||t===Ag}var uy,dy="undefined",fy=typeof Uint32Array===dy?Array:Uint32Array,py=typeof Uint16Array===dy?Array:Uint16Array,my=typeof Int32Array===dy?Array:Int32Array,gy=typeof Float64Array===dy?Array:Float64Array,vy={"float":gy,"int":my,"ordinal":Array,"number":Array,"time":gy};function yy(t){return t>65535?fy:py}function by(){return[1/0,-1/0]}function xy(t){var e=t.constructor;return e===Array?t.slice():new e(t)}function wy(t,e,n,i,r){var o=vy[n||"float"];if(r){var a=t[e],s=a&&a.length;if(s!==i){for(var l=new o(i),c=0;c<s;c++)l[c]=a[c];t[e]=l}}else t[e]=new o(i)}var Sy=function(){function t(){this.Gc=[],this.Xc=[],this.Yc=[],this._c=0,this.Jc=0,this.Zc=Or()}return t.prototype.initData=function(t,e,n){this.Qc=t,this.Gc=[],this.th=null,this.getRawIndex=this.eh;var i=t.getSource(),r=this.defaultDimValueGetter=uy[i.sourceFormat];this.nh=n||r,this.Xc=[],Dv(i),this.ih=lr(e,function(t){return{type:t.type,property:t.property}}),this.rh(0,t.count())},t.prototype.getProvider=function(){return this.Qc},t.prototype.getSource=function(){return this.Qc.getSource()},t.prototype.ensureCalculationDimension=function(t,e){var n=this.Zc,i=this.ih,r=n.get(t);if(null!=r){if(i[r].type===e)return r}else r=i.length;return i[r]={type:e},n.set(t,r),this.Gc[r]=new vy[e||"float"](this.Jc),this.Xc[r]=[1/0,-1/0],r},t.prototype.collectOrdinalMeta=function(t,e){var n=this.Gc[t],i=this.ih[t],r=this.Xc,o=i.ordinalOffset||0,a=n.length;0===o&&(r[t]=[1/0,-1/0]);for(var s=r[t],l=o;l<a;l++){var c=n[l]=e.parseAndCollect(n[l]);isNaN(c)||(s[0]=Math.min(c,s[0]),s[1]=Math.max(c,s[1]))}i.ordinalMeta=e,i.ordinalOffset=a,i.type="ordinal"},t.prototype.getOrdinalMeta=function(t){return this.ih[t].ordinalMeta},t.prototype.getDimensionProperty=function(t){var e=this.ih[t];return e&&e.property},t.prototype.appendData=function(t){var e=this.Qc,n=this.count();e.appendData(t);var i=e.count();return e.persistent||(i+=n),n<i&&this.rh(n,i,!0),[n,i]},t.prototype.appendValues=function(t,e){for(var n=this.Gc,i=this.ih,r=i.length,o=this.Xc,a=this.count(),s=a+Math.max(t.length,e||0),l=0;l<r;l++)wy(n,l,(f=i[l]).type,s,!0);for(var c=[],h=a;h<s;h++)for(var u=h-a,d=0;d<r;d++){var f=i[d],p=uy.arrayRows.call(this,t[u]||c,f.property,u,d);n[d][h]=p;var m=o[d];p<m[0]&&(m[0]=p),p>m[1]&&(m[1]=p)}return this.Jc=this._c=s,{start:a,end:s}},t.prototype.rh=function(t,e,n){for(var i=this.Qc,r=this.Gc,o=this.ih,a=o.length,s=this.Xc,l=lr(o,function(t){return t.property}),c=0;c<a;c++){var h=o[c];s[c]||(s[c]=by()),wy(r,c,h.type,e,n)}if(i.fillStorage)i.fillStorage(t,e,r,s);else for(var u=[],d=t;d<e;d++){u=i.getItem(d,u);for(var f=0;f<a;f++){var p=r[f],m=this.nh(u,l[f],d,f);p[d]=m;var g=s[f];m<g[0]&&(g[0]=m),m>g[1]&&(g[1]=m)}}!i.persistent&&i.clean&&i.clean(),this.Jc=this._c=e,this.Yc=[]},t.prototype.count=function(){return this._c},t.prototype.get=function(t,e){if(!(e>=0&&e<this._c))return NaN;var n=this.Gc[t];return n?n[this.getRawIndex(e)]:NaN},t.prototype.getValues=function(t,e){var n=[],i=[];if(null==e){e=t,t=[];for(var r=0;r<this.ih.length;r++)i.push(r)}else i=t;r=0;for(var o=i.length;r<o;r++)n.push(this.get(i[r],e));return n},t.prototype.getByRawIndex=function(t,e){if(!(e>=0&&e<this.Jc))return NaN;var n=this.Gc[t];return n?n[e]:NaN},t.prototype.getSum=function(t){var e=0;if(this.Gc[t])for(var n=0,i=this.count();n<i;n++){var r=this.get(t,n);isNaN(r)||(e+=r)}return e},t.prototype.getMedian=function(t){var e=[];this.each([t],function(t){isNaN(t)||e.push(t)});var n=e.sort(function(t,e){return t-e}),i=this.count();return 0===i?0:i%2==1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},t.prototype.indexOfRawIndex=function(t){if(t>=this.Jc||t<0)return-1;if(!this.th)return t;var e=this.th,n=e[t];if(null!=n&&n<this._c&&n===t)return t;for(var i=0,r=this._c-1;i<=r;){var o=(i+r)/2|0;if(e[o]<t)i=o+1;else{if(!(e[o]>t))return o;r=o-1}}return-1},t.prototype.getIndices=function(){var t,e=this.th;if(e){var n=e.constructor,i=this._c;if(n===Array){t=new n(i);for(var r=0;r<i;r++)t[r]=e[r]}else t=new n(e.buffer,0,i)}else for(t=new(n=yy(this.Jc))(this.count()),r=0;r<t.length;r++)t[r]=r;return t},t.prototype.filter=function(t,e){if(!this._c)return this;for(var n=this.clone(),i=n.count(),r=new(yy(n.Jc))(i),o=[],a=t.length,s=0,l=t[0],c=n.Gc,h=0;h<i;h++){var u=void 0,d=n.getRawIndex(h);if(0===a)u=e(h);else if(1===a)u=e(c[l][d],h);else{for(var f=0;f<a;f++)o[f]=c[t[f]][d];o[f]=h,u=e.apply(null,o)}u&&(r[s++]=d)}return s<i&&(n.th=r),n._c=s,n.Yc=[],n.sh(),n},t.prototype.selectRange=function(t){var e=this.clone(),n=e._c;if(!n)return this;var i=dr(t),r=i.length;if(!r)return this;var o=e.count(),a=new(yy(e.Jc))(o),s=0,l=i[0],c=t[l][0],h=t[l][1],u=e.Gc,d=!1;if(!e.th){var f=0;if(1===r){for(var p=u[i[0]],m=0;m<n;m++)((b=p[m])>=c&&b<=h||isNaN(b))&&(a[s++]=f),f++;d=!0}else if(2===r){p=u[i[0]];var g=u[i[1]],v=t[i[1]][0],y=t[i[1]][1];for(m=0;m<n;m++){var b=p[m],x=g[m];(b>=c&&b<=h||isNaN(b))&&(x>=v&&x<=y||isNaN(x))&&(a[s++]=f),f++}d=!0}}if(!d)if(1===r)for(m=0;m<o;m++){var w=e.getRawIndex(m);((b=u[i[0]][w])>=c&&b<=h||isNaN(b))&&(a[s++]=w)}else for(m=0;m<o;m++){for(var S=!0,C=(w=e.getRawIndex(m),0);C<r;C++){var T=i[C];((b=u[T][w])<t[T][0]||b>t[T][1])&&(S=!1)}S&&(a[s++]=e.getRawIndex(m))}return s<o&&(e.th=a),e._c=s,e.Yc=[],e.sh(),e},t.prototype.map=function(t,e){var n=this.clone(t);return this.oh(n,t,e),n},t.prototype.modify=function(t,e){this.oh(this,t,e)},t.prototype.oh=function(t,e,n){for(var i=t.Gc,r=[],o=e.length,a=t.count(),s=[],l=t.Xc,c=0;c<e.length;c++)l[e[c]]=by();for(var h=0;h<a;h++){for(var u=t.getRawIndex(h),d=0;d<o;d++)s[d]=i[e[d]][u];s[o]=h;var f=n&&n.apply(null,s);if(null!=f)for("object"!=typeof f&&(r[0]=f,f=r),c=0;c<f.length;c++){var p=e[c],m=f[c],g=l[p],v=i[p];v&&(v[u]=m),m<g[0]&&(g[0]=m),m>g[1]&&(g[1]=m)}}},t.prototype.lttbDownSample=function(t,e){var n,i,r,o=this.clone([t],!0),a=o.Gc[t],s=this.count(),l=0,c=Math.floor(1/e),h=this.getRawIndex(0),u=new(yy(this.Jc))(Math.min(2*(Math.ceil(s/c)+2),s));u[l++]=h;for(var d=1;d<s-1;d+=c){for(var f=Math.min(d+c,s-1),p=Math.min(d+2*c,s),m=(p+f)/2,g=0,v=f;v<p;v++){var y=a[$=this.getRawIndex(v)];isNaN(y)||(g+=y)}g/=p-f;var b=d,x=Math.min(d+c,s),w=d-1,S=a[h];n=-1,r=b;var C=-1,T=0;for(v=b;v<x;v++){var $;y=a[$=this.getRawIndex(v)],isNaN(y)?(T++,C<0&&(C=$)):(i=Math.abs((w-m)*(y-S)-(w-v)*(g-S)))>n&&(n=i,r=$)}T>0&&T<x-b&&(u[l++]=Math.min(C,r),r=Math.max(C,r)),u[l++]=r,h=r}return u[l++]=this.getRawIndex(s-1),o._c=l,o.th=u,o.getRawIndex=this.ah,o},t.prototype.minmaxDownSample=function(t,e){for(var n=this.clone([t],!0),i=n.Gc,r=Math.floor(1/e),o=i[t],a=this.count(),s=new(yy(this.Jc))(2*Math.ceil(a/r)),l=0,c=0;c<a;c+=r){var h=c,u=o[this.getRawIndex(h)],d=c,f=o[this.getRawIndex(d)],p=r;c+r>a&&(p=a-c);for(var m=0;m<p;m++){var g=o[this.getRawIndex(c+m)];g<u&&(u=g,h=c+m),g>f&&(f=g,d=c+m)}var v=this.getRawIndex(h),y=this.getRawIndex(d);h<d?(s[l++]=v,s[l++]=y):(s[l++]=y,s[l++]=v)}return n._c=l,n.th=s,n.sh(),n},t.prototype.downSample=function(t,e,n,i){for(var r=this.clone([t],!0),o=r.Gc,a=[],s=Math.floor(1/e),l=o[t],c=this.count(),h=r.Xc[t]=[1/0,-1/0],u=new(yy(this.Jc))(Math.ceil(c/s)),d=0,f=0;f<c;f+=s){s>c-f&&(s=c-f,a.length=s);for(var p=0;p<s;p++){var m=this.getRawIndex(f+p);a[p]=l[m]}var g=n(a),v=this.getRawIndex(Math.min(f+i(a,g)||0,c-1));l[v]=g,g<h[0]&&(h[0]=g),g>h[1]&&(h[1]=g),u[d++]=v}return r._c=d,r.th=u,r.sh(),r},t.prototype.each=function(t,e){if(this._c)for(var n=t.length,i=this.Gc,r=0,o=this.count();r<o;r++){var a=this.getRawIndex(r);switch(n){case 0:e(r);break;case 1:e(i[t[0]][a],r);break;case 2:e(i[t[0]][a],i[t[1]][a],r);break;default:for(var s=0,l=[];s<n;s++)l[s]=i[t[s]][a];l[s]=r,e.apply(null,l)}}},t.prototype.getDataExtent=function(t){var e=this.Gc[t],n=[1/0,-1/0];if(!e)return n;var i,r=this.count();if(!this.th)return this.Xc[t].slice();if(i=this.Yc[t])return i.slice();for(var o=(i=n)[0],a=i[1],s=0;s<r;s++){var l=e[this.getRawIndex(s)];l<o&&(o=l),l>a&&(a=l)}return i=[o,a],this.Yc[t]=i,i},t.prototype.getRawDataItem=function(t){var e=this.getRawIndex(t);if(this.Qc.persistent)return this.Qc.getItem(e);for(var n=[],i=this.Gc,r=0;r<i.length;r++)n.push(i[r][e]);return n},t.prototype.clone=function(e,n){var i=new t,r=this.Gc,o=e&&cr(e,function(t,e){return t[e]=!0,t},{});if(o)for(var a=0;a<r.length;a++)i.Gc[a]=o[a]?xy(r[a]):r[a];else i.Gc=r;return this.hh(i),n||(i.th=this.uh()),i.sh(),i},t.prototype.hh=function(t){t._c=this._c,t.Jc=this.Jc,t.Qc=this.Qc,t.ih=this.ih,t.Yc=tr(this.Yc),t.Xc=tr(this.Xc)},t.prototype.uh=function(){if(this.th){var t=this.th.constructor,e=void 0;if(t===Array){var n=this.th.length;e=new t(n);for(var i=0;i<n;i++)e[i]=this.th[i]}else e=new t(this.th);return e}return null},t.prototype.eh=function(t){return t},t.prototype.ah=function(t){return t<this._c&&t>=0?this.th[t]:-1},t.prototype.sh=function(){this.getRawIndex=this.th?this.ah:this.eh},t.internalField=function(){function t(t,e,n,i){return ey(t[i],this.ih[i])}uy={arrayRows:t,objectRows:function(t,e,n,i){return ey(t[e],this.ih[i])},keyedColumns:t,original:function(t,e,n,i){var r=t&&(null==t.value?t:t.value);return ey(r instanceof Array?r[i]:r,this.ih[i])},typedArray:function(t,e,n,i){return t[i]}}}(),t}(),Cy=function(){function t(t){this.dh=[],this.mh=[],this.ph=[],this.bh=0,this.Ii=!0,this.gh=t}return t.prototype.dirty=function(){this.yh([],[]),this.mh=[],this.Ii=!0},t.prototype.yh=function(t,e){this.dh=t,this.ph=e,this.bh++,this.bh>9e10&&(this.bh=0)},t.prototype.wh=function(){return this.gh.uid+"_"+this.bh},t.prototype.prepareSource=function(){this.xh()&&(this.$h(),this.Ii=!1)},t.prototype.$h=function(){this.yh([],[]);var t,e,n=this.gh,i=this.Mh(),r=!!i.length;if(Ty(n)){var o=n,a=void 0,s=void 0,l=void 0;if(r){var c=i[0];c.prepareSource(),a=(l=c.getSource()).data,s=l.sourceFormat,e=[c.wh()]}else s=Sr(a=o.get("data",!0))?kg:$g,e=[];var h=this.Ch()||{},u=l&&l.metaRawOption||{},d=Ar(h.seriesLayoutBy,u.seriesLayoutBy)||null,f=Ar(h.sourceHeader,u.sourceHeader),p=Ar(h.dimensions,u.dimensions);t=d!==u.seriesLayoutBy||!!f!=!!u.sourceHeader||p?[Rv(a,{seriesLayoutBy:d,sourceHeader:f,dimensions:p},s)]:[]}else{var m=n;if(r){var g=this.Sh(i);t=g.sourceList,e=g.upstreamSignList}else t=[Rv(m.get("source",!0),this.Ch(),null)],e=[]}this.yh(t,e)},t.prototype.Sh=function(t){var e,n=this.gh,i=n.get("transform",!0),r=n.get("fromTransformResult",!0);null!=r&&1!==t.length&&$y("");var o,a=[],s=[];return sr(t,function(t){t.prepareSource();var e=t.getSource(r||0);null==r||e||$y(""),a.push(e),s.push(t.wh())}),i?e=function(t,e){var n=sc(t),i=n.length;i||rc("");for(var r=0,o=i;r<o;r++)e=cy(n[r],e),r!==o-1&&(e.length=Math.max(e.length,1));return e}(i,a,n.componentIndex):null!=r&&(e=[(o=a[0],new Nv({data:o.data,sourceFormat:o.sourceFormat,seriesLayoutBy:o.seriesLayoutBy,dimensionsDefine:tr(o.dimensionsDefine),startIndex:o.startIndex,dimensionsDetectedCount:o.dimensionsDetectedCount}))]),{sourceList:e,upstreamSignList:s}},t.prototype.xh=function(){if(this.Ii)return!0;for(var t=this.Mh(),e=0;e<t.length;e++){var n=t[e];if(n.xh()||this.ph[e]!==n.wh())return!0}},t.prototype.getSource=function(t){t=t||0;var e=this.dh[t];if(!e){var n=this.Mh();return n[0]&&n[0].getSource(t)}return e},t.prototype.getSharedDataStore=function(t){var e=t.makeStoreSchema();return this.Rh(e.dimensions,t.source,e.hash)},t.prototype.Rh=function(t,e,n){var i=this.mh,r=i[0];r||(r=i[0]={});var o=r[n];if(!o){var a=this.Mh()[0];Ty(this.gh)&&a?o=a.Rh(t,e,n):(o=new Sy).initData(new Lv(e,t.length),t),r[n]=o}return o},t.prototype.Mh=function(){var t=this.gh;if(Ty(t)){var e=Lg(t);return e?[e.getSourceManager()]:[]}return lr(function(t){return t.get("transform",!0)||t.get("fromTransformResult",!0)?Cc(t.ecModel,"dataset",{index:t.get("fromDatasetIndex",!0),id:t.get("fromDatasetId",!0)},Sc).models:[]}(t),function(t){return t.getSourceManager()})},t.prototype.Ch=function(){var t,e,n,i=this.gh;if(Ty(i))t=i.get("seriesLayoutBy",!0),e=i.get("sourceHeader",!0),n=i.get("dimensions",!0);else if(!this.Mh().length){var r=i;t=r.get("seriesLayoutBy",!0),e=r.get("sourceHeader",!0),n=r.get("dimensions",!0)}return{seriesLayoutBy:t,sourceHeader:e,dimensions:n}},t}();function Ty(t){return"series"===t.mainType}function $y(t){throw new Error(t)}function My(t){var e=t.lineHeight;return null==e?"line-height:1":"line-height:"+vo(e+"")+"px"}function Ay(t,e){var n=t.color||mg.color.tertiary,i=t.fontSize||12,r=t.fontWeight||"400",o=t.color||mg.color.secondary,a=t.fontSize||14,s=t.fontWeight||"900";return"html"===e?{nameStyle:"font-size:"+vo(i+"")+"px;color:"+vo(n)+";font-weight:"+vo(r+""),valueStyle:"font-size:"+vo(a+"")+"px;color:"+vo(o)+";font-weight:"+vo(s+"")}:{nameStyle:{fontSize:i,fill:n,fontWeight:r},valueStyle:{fontSize:a,fill:o,fontWeight:s}}}var Ny=[0,10,20,30],ky=["","\n","\n\n","\n\n\n"];function Ry(t,e){return e.type=t,e}function _y(t){return"section"===t.type}function Iy(t){return _y(t)?Ey:Dy}function Fy(t){if(_y(t)){var e=0,n=t.blocks.length,i=n>1||n>0&&!t.noHeader;return sr(t.blocks,function(t){var n=Fy(t);n>=e&&(e=n+ +(i&&(!n||_y(t)&&!t.noHeader)))}),e}return 0}function Ey(t,e,n,i){var r,o=e.noHeader,a=(r=Fy(e),{html:Ny[r],richText:ky[r]}),s=[],l=e.blocks||[];_r(!l||mr(l)),l=l||[];var c=t.orderMode;if(e.sortBlocks&&c){l=l.slice();var h={valueAsc:"asc",valueDesc:"desc"};if(Ur(h,c)){var u=new ny(h[c],null);l.sort(function(t,e){return u.evaluate(t.sortParam,e.sortParam)})}else"seriesDesc"===c&&l.reverse()}sr(l,function(n,r){var o=e.valueFormatter,l=Iy(n)(o?nr(nr({},t),{valueFormatter:o}):t,n,r>0?a.html:0,i);null!=l&&s.push(l)});var d="richText"===t.renderMode?s.join(a.richText):Py(i,s.join(""),o?n:a.html);if(o)return d;var f=jm(e.header,"ordinal",t.useUTC),p=Ay(i,t.renderMode).nameStyle,m=My(i);return"richText"===t.renderMode?zy(t,f,p)+a.richText+d:Py(i,'<div style="'+p+";"+m+';">'+vo(f)+"</div>"+d,n)}function Dy(t,e,n,i){var r=t.renderMode,o=e.noName,a=e.noValue,s=!e.markerType,l=e.name,c=t.useUTC,h=e.valueFormatter||t.valueFormatter||function(t){return lr(t=mr(t)?t:[t],function(t,e){return jm(t,mr(f)?f[e]:f,c)})};if(!o||!a){var u=s?"":t.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||mg.color.secondary,r),d=o?"":jm(l,"ordinal",c),f=e.valueType,p=a?[]:h(e.value,e.dataIndex),m=!s||!o,g=!s&&o,v=Ay(i,r),y=v.nameStyle,b=v.valueStyle;return"richText"===r?(s?"":u)+(o?"":zy(t,d,y))+(a?"":function(t,e,n,i,r){var o=[r],a=i?10:20;return n&&o.push({padding:[0,0,0,a],align:"right"}),t.markupStyleCreator.wrapRichTextStyle(mr(e)?e.join("  "):e,o)}(t,p,m,g,b)):Py(i,(s?"":u)+(o?"":function(t,e,n){return'<span style="'+n+";"+(e?"margin-left:2px":"")+'">'+vo(t)+"</span>"}(d,!s,y))+(a?"":function(t,e,n,i){return'<span style="'+(e?"float:right;margin-left:"+(n?"10px":"20px"):"")+";"+i+'">'+lr(t=mr(t)?t:[t],function(t){return vo(t)}).join("&nbsp;&nbsp;")+"</span>"}(p,m,g,b)),n)}}function Ly(t,e,n,i,r,o){if(t)return Iy(t)({useUTC:r,renderMode:n,orderMode:i,markupStyleCreator:e,valueFormatter:t.valueFormatter},t,0,o)}function Py(t,e,n){return'<div style="margin: '+n+"px 0 0;"+My(t)+';">'+e+'<div style="clear:both"></div></div>'}function zy(t,e,n){return t.markupStyleCreator.wrapRichTextStyle(e,n)}function Oy(t,e){return Zm(t.getData().getItemVisual(e,"style")[t.visualDrawType])}function By(t,e){var n=t.get("padding");return null!=n?n:"richText"===e?[8,10]:10}var Vy=function(){function t(){this.richTextStyles={},this.Ah=tc()}return t.prototype.kh=function(){return"__EC_aUTo_"+this.Ah++},t.prototype.makeTooltipMarker=function(t,e,n){var i="richText"===n?this.kh():null,r=function(t,e){var n=vr(t)?{color:t,extraCssText:e}:t||{},i=n.color,r=n.type;e=n.extraCssText;var o=n.renderMode||"html";return i?"html"===o?"subItem"===r?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+vo(i)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+vo(i)+";"+(e||"")+'"></span>':{renderMode:o,content:"{"+(n.markerId||"markerX")+"|}  ",style:"subItem"===r?{width:4,height:4,borderRadius:2,backgroundColor:i}:{width:10,height:10,borderRadius:5,backgroundColor:i}}:""}({color:e,type:t,renderMode:n,markerId:i});return vr(r)?r:(this.richTextStyles[i]=r.style,r.content)},t.prototype.wrapRichTextStyle=function(t,e){var n={};mr(e)?sr(e,function(t){return nr(n,t)}):nr(n,e);var i=this.kh();return this.richTextStyles[i]=n,"{"+i+"|"+t+"}"},t}(),Hy=yc();function Uy(t,e){return t.getName(e)||t.getId(e)}var qy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Th={},e}return Ei(e,t),e.prototype.init=function(t,e,n){this.seriesIndex=this.componentIndex,this.dataTask=Jv({count:Wy,reset:jy}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,n),(Hy(this).sourceManager=new Cy(this)).prepareSource();var i=this.getInitialData(t,n);Xy(i,this),this.dataTask.context.data=i,Hy(this).dataBeforeProcessed=i,Ky(this),this.Nh(i)},e.prototype.mergeDefaultAndTheme=function(t,e){var n=hg(this),i=n?dg(t):{},r=this.subType;pg.hasClass(r)&&(r+="Series"),er(t,e.getTheme().get(this.subType)),er(t,this.getDefaultOption()),lc(t,"label",["show"]),this.fillDataTextStyle(t.data),n&&ug(t,i,n)},e.prototype.mergeOption=function(t,e){t=er(this.option,t,!0),this.fillDataTextStyle(t.data);var n=hg(this);n&&ug(this.option,t,n);var i=Hy(this).sourceManager;i.dirty(),i.prepareSource();var r=this.getInitialData(t,e);Xy(r,this),this.dataTask.dirty(),this.dataTask.context.data=r,Hy(this).dataBeforeProcessed=r,Ky(this),this.Nh(r)},e.prototype.fillDataTextStyle=function(t){if(t&&!Sr(t))for(var e=["show"],n=0;n<t.length;n++)t[n]&&t[n].label&&lc(t[n],"label",e)},e.prototype.getInitialData=function(t,e){},e.prototype.appendData=function(t){this.getRawData().appendData(t.data)},e.prototype.getData=function(t){var e=Zy(this);if(e){var n=e.context.data;return null!=t&&n.getLinkedData?n.getLinkedData(t):n}return Hy(this).data},e.prototype.getAllData=function(){var t=this.getData();return t&&t.getLinkedDataAll?t.getLinkedDataAll():[{data:t}]},e.prototype.setData=function(t){var e=Zy(this);if(e){var n=e.context;n.outputData=t,e!==this.dataTask&&(n.data=t)}Hy(this).data=t},e.prototype.getEncode=function(){var t=this.get("encode",!0);if(t)return Or(t)},e.prototype.getSourceManager=function(){return Hy(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return Hy(this).dataBeforeProcessed},e.prototype.getColorBy=function(){return this.get("colorBy")||"series"},e.prototype.isColorBySeries=function(){return"series"===this.getColorBy()},e.prototype.getBaseAxis=function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},e.prototype.indicesOfNearest=function(t,e,n,i){var r=this.getData(),o=this.coordinateSystem,a=o&&o.getAxis(t);if(!o||!a)return[];var s=a.dataToCoord(n);null==i&&(i=1/0);var l=[],c=1/0,h=-1,u=0;return r.each(e,function(t,e){var n=a.dataToCoord(t),r=s-n,o=Math.abs(r);o<=i&&((o<c||o===c&&r>=0&&h<0)&&(c=o,h=r,u=0),r===h&&(l[u++]=e))}),l.length=u,l},e.prototype.formatTooltip=function(t,e,n){return function(t){var e,n,i,r,o=t.series,a=t.dataIndex,s=t.multipleSeries,l=o.getData(),c=l.mapDimensionsAll("defaultedTooltip"),h=c.length,u=o.getRawValue(a),d=mr(u),f=Oy(o,a);if(h>1||d&&!h){var p=function(t,e,n,i,r){var o=e.getData(),a=cr(t,function(t,e,n){var i=o.getDimensionInfo(n);return t||i&&!1!==i.tooltip&&null!=i.displayName},!1),s=[],l=[],c=[];function h(t,e){var n=o.getDimensionInfo(e);n&&!1!==n.otherDims.tooltip&&(a?c.push(Ry("nameValue",{markerType:"subItem",markerColor:r,name:n.displayName,value:t,valueType:n.type})):(s.push(t),l.push(n.type)))}return i.length?sr(i,function(t){h(Gv(o,n,t),t)}):sr(t,h),{inlineValues:s,inlineValueTypes:l,blocks:c}}(u,o,a,c,f);e=p.inlineValues,n=p.inlineValueTypes,i=p.blocks,r=p.inlineValues[0]}else if(h){var m=l.getDimensionInfo(c[0]);r=e=Gv(l,a,c[0]),n=m.type}else r=e=d?u[0]:u;var g=mc(o),v=g&&o.name||"",y=l.getName(a),b=s?v:y;return Ry("section",{header:v,noHeader:s||!g,sortParam:r,blocks:[Ry("nameValue",{markerType:"item",markerColor:f,name:b,noName:!Ir(b),value:e,valueType:n,dataIndex:a})].concat(i||[])})}({series:this,dataIndex:t,multipleSeries:e})},e.prototype.isAnimationEnabled=function(){var t=this.ecModel;if(Li.node&&(!t||!t.ssr))return!1;var e=this.getShallow("animation");return e&&this.getData().count()>this.getShallow("animationThreshold")&&(e=!1),!!e},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(t,e,n){var i=this.ecModel,r=Kg.prototype.getColorFromPalette.call(this,t,e,n);return r||(r=i.getColorFromPalette(t,e,n)),r},e.prototype.coordDimToDataDim=function(t){return this.getRawData().mapDimensionsAll(t)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(t,e){this.Fh(this.getData(e),t)},e.prototype.unselect=function(t,e){var n=this.option.selectedMap;if(n){var i=this.option.selectedMode,r=this.getData(e);if("series"===i||"all"===n)return this.option.selectedMap={},void(this.Th={});for(var o=0;o<t.length;o++){var a=Uy(r,t[o]);n[a]=!1,this.Th[a]=-1}}},e.prototype.toggleSelect=function(t,e){for(var n=[],i=0;i<t.length;i++)n[0]=t[i],this.isSelected(t[i],e)?this.unselect(n,e):this.select(n,e)},e.prototype.getSelectedDataIndices=function(){if("all"===this.option.selectedMap)return[].slice.call(this.getData().getIndices());for(var t=this.Th,e=dr(t),n=[],i=0;i<e.length;i++){var r=t[e[i]];r>=0&&n.push(r)}return n},e.prototype.isSelected=function(t,e){var n=this.option.selectedMap;if(!n)return!1;var i=this.getData(e);return("all"===n||n[Uy(i,t)])&&!i.getItemModel(t).get(["select","disabled"])},e.prototype.isUniversalTransitionEnabled=function(){if(this.__universalTransitionEnabled)return!0;var t=this.option.universalTransition;return!!t&&(!0===t||t&&t.enabled)},e.prototype.Fh=function(t,e){var n,i,r=this.option,o=r.selectedMode,a=e.length;if(o&&a)if("series"===o)r.selectedMap="all";else if("multiple"===o){xr(r.selectedMap)||(r.selectedMap={});for(var s=r.selectedMap,l=0;l<a;l++){var c=e[l];s[u=Uy(t,c)]=!0,this.Th[u]=t.getRawIndex(c)}}else if("single"===o||!0===o){var h=e[a-1],u=Uy(t,h);r.selectedMap=((n={})[u]=!0,n),this.Th=((i={})[u]=t.getRawIndex(h),i)}},e.prototype.Nh=function(t){if(!this.option.selectedMap){var e=[];t.hasItemOption&&t.each(function(n){var i=t.getRawDataItem(n);i&&i.selected&&e.push(n)}),e.length>0&&this.Fh(t,e)}},e.registerClass=function(t){return pg.registerClass(t)},e.protoInitialize=function(){var t=e.prototype;t.type="series.__base__",t.seriesIndex=0,t.ignoreStyleOnData=!1,t.hasSymbolVisual=!1,t.defaultSymbol="circle",t.visualStyleAccessPath="itemStyle",t.visualDrawType="fill"}(),e}(pg);function Ky(t){var e=t.name;mc(t)||(t.name=function(t){var e=t.getRawData(),n=e.mapDimensionsAll("seriesName"),i=[];return sr(n,function(t){var n=e.getDimensionInfo(t);n.displayName&&i.push(n.displayName)}),i.join(" ")}(t)||e)}function Wy(t){return t.model.getRawData().count()}function jy(t){var e=t.model;return e.setData(e.getRawData().cloneShallow()),Gy}function Gy(t,e){e.outputData&&t.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function Xy(t,e){sr(Br(t.CHANGABLE_METHODS,t.DOWNSAMPLE_METHODS),function(n){t.wrapMethod(n,pr(Yy,e))})}function Yy(t,e){var n=Zy(t);return n&&n.setOutputEnd((e||this).count()),e}function Zy(t){var e=(t.ecModel||{}).scheduler,n=e&&e.getPipeline(t.uid);if(n){var i=n.currentTask;if(i){var r=i.agentStubMap;r&&(i=r.get(t.uid))}return i}}or(qy,Yv),or(qy,Kg),kc(qy,pg);var Jy=function(){function t(){this.group=new Il,this.uid=om("viewComponent")}return t.prototype.init=function(t,e){},t.prototype.render=function(t,e,n,i){},t.prototype.dispose=function(t,e){},t.prototype.updateView=function(t,e,n,i){},t.prototype.updateLayout=function(t,e,n,i){},t.prototype.updateVisual=function(t,e,n,i){},t.prototype.toggleBlurSeries=function(t,e,n){},t.prototype.eachRendered=function(t){var e=this.group;e&&e.traverse(t)},t}();function Qy(){var t=yc();return function(e){var n=t(e),i=e.pipelineContext,r=!!n.large,o=!!n.progressiveRender,a=n.large=!(!i||!i.large),s=n.progressiveRender=!(!i||!i.progressiveRender);return!(r===a&&o===s)&&"reset"}}Nc(Jy),Fc(Jy);var tb=yc(),eb=Qy(),nb=function(){function t(){this.group=new Il,this.uid=om("viewChart"),this.renderTask=Jv({plan:ob,reset:ab}),this.renderTask.context={view:this}}return t.prototype.init=function(t,e){},t.prototype.render=function(t,e,n,i){},t.prototype.highlight=function(t,e,n,i){var r=t.getData(i&&i.dataType);r&&rb(r,i,"emphasis")},t.prototype.downplay=function(t,e,n,i){var r=t.getData(i&&i.dataType);r&&rb(r,i,"normal")},t.prototype.remove=function(t,e){this.group.removeAll()},t.prototype.dispose=function(t,e){},t.prototype.updateView=function(t,e,n,i){this.render(t,e,n,i)},t.prototype.updateLayout=function(t,e,n,i){this.render(t,e,n,i)},t.prototype.updateVisual=function(t,e,n,i){this.render(t,e,n,i)},t.prototype.eachRendered=function(t){Mp(this.group,t)},t.markUpdateMethod=function(t,e){tb(t).updateMethod=e},t.protoInitialize=void(t.prototype.type="chart"),t}();function ib(t,e,n){t&&Fd(t)&&("emphasis"===e?pd:md)(t,n)}function rb(t,e,n){var i=vc(t,e),r=e&&null!=e.highlightKey?function(t){var e=Hu[t];return null==e&&Vu<=32&&(e=Hu[t]=Vu++),e}(e.highlightKey):null;null!=i?sr(sc(i),function(e){ib(t.getItemGraphicEl(e),n,r)}):t.eachItemGraphicEl(function(t){ib(t,n,r)})}function ob(t){return eb(t.model)}function ab(t){var e=t.model,n=t.ecModel,i=t.api,r=t.payload,o=e.pipelineContext.progressiveRender,a=t.view,s=r&&tb(r).updateMethod,l=o?"incrementalPrepareRender":s&&a[s]?s:"render";return"render"!==l&&a[l](e,n,i,r),sb[l]}Nc(nb),Fc(nb);var sb={incrementalPrepareRender:{progress:function(t,e){e.view.incrementalRender(t,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(t,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},lb="\0__throttleOriginMethod",cb="\0__throttleRate",hb="\0__throttleType";function ub(t,e,n){var i,r,o,a,s,l=0,c=0,h=null;function u(){c=(new Date).getTime(),h=null,t.apply(o,a||[])}e=e||0;var d=function(){for(var t=[],d=0;d<arguments.length;d++)t[d]=arguments[d];i=(new Date).getTime(),o=this,a=t;var f=s||e,p=s||n;s=null,r=i-(p?l:c)-f,clearTimeout(h),p?h=setTimeout(u,f):r>=0?u():h=setTimeout(u,-r),l=i};return d.clear=function(){h&&(clearTimeout(h),h=null)},d.debounceNextCall=function(t){s=t},d}function db(t,e,n,i){var r=t[e];if(r){var o=r[lb]||r,a=r[hb];if(r[cb]!==n||a!==i){if(null==n||!i)return t[e]=o;(r=t[e]=ub(o,n,"debounce"===i))[lb]=o,r[hb]=i,r[cb]=n}return r}}function fb(t,e){var n=t[e];n&&n[lb]&&(n.clear&&n.clear(),t[e]=n[lb])}var pb=yc(),mb={itemStyle:Ec(tm,!0),lineStyle:Ec(Zp,!0)},gb={lineStyle:"stroke",itemStyle:"fill"};function vb(t,e){return t.visualStyleMapper||mb[e]||mb.itemStyle}function yb(t,e){return t.visualDrawType||gb[e]||"fill"}var bb={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var n=t.getData(),i=t.visualStyleAccessPath||"itemStyle",r=t.getModel(i),o=vb(t,i)(r),a=r.getShallow("decal");a&&(n.setVisual("decal",a),a.dirty=!0);var s=yb(t,i),l=o[s],c=gr(l)?l:null,h="auto"===o.fill||"auto"===o.stroke;if(!o[s]||c||h){var u=t.getColorFromPalette(t.name,null,e.getSeriesCount());o[s]||(o[s]=u,n.setVisual("colorFromPalette",!0)),o.fill="auto"===o.fill||gr(o.fill)?u:o.fill,o.stroke="auto"===o.stroke||gr(o.stroke)?u:o.stroke}if(n.setVisual("style",o),n.setVisual("drawType",s),!e.isSeriesFiltered(t)&&c)return n.setVisual("colorFromPalette",!1),{dataEach:function(e,n){var i=t.getDataParams(n),r=nr({},o);r[s]=c(i),e.setItemVisual(n,"style",r)}}}},xb=new im,wb={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){if(!t.ignoreStyleOnData&&!e.isSeriesFiltered(t)){var n=t.getData(),i=t.visualStyleAccessPath||"itemStyle",r=vb(t,i),o=n.getVisual("drawType");return{dataEach:n.hasItemOption?function(t,e){var n=t.getRawDataItem(e);if(n&&n[i]){xb.option=n[i];var a=r(xb);nr(t.ensureUniqueItemVisual(e,"style"),a),xb.option.decal&&(t.setItemVisual(e,"decal",xb.option.decal),xb.option.decal.dirty=!0),o in a&&t.setItemVisual(e,"colorFromPalette",!1)}}:null}}}},Sb={performRawSeries:!0,overallReset:function(t){var e=Or();t.eachSeries(function(t){var n=t.getColorBy();if(!t.isColorBySeries()){var i=t.type+"-"+n,r=e.get(i);r||(r={},e.set(i,r)),pb(t).scope=r}}),t.eachSeries(function(e){if(!e.isColorBySeries()&&!t.isSeriesFiltered(e)){var n=e.getRawData(),i={},r=e.getData(),o=pb(e).scope,a=e.visualStyleAccessPath||"itemStyle",s=yb(e,a);r.each(function(t){var e=r.getRawIndex(t);i[e]=t}),n.each(function(t){var a=i[t];if(r.getItemVisual(a,"colorFromPalette")){var l=r.ensureUniqueItemVisual(a,"style"),c=n.getName(t)||t+"",h=n.count();l[s]=e.getColorFromPalette(c,o,h)}})}})}},Cb=Math.PI,Tb=function(){function t(t,e,n,i){this._h=Or(),this.ecInstance=t,this.api=e,n=this.Eh=n.slice(),i=this.Ih=i.slice(),this.zh=n.concat(i)}return t.prototype.restoreData=function(t,e){t.restoreData(e),this._h.each(function(t){var e=t.overallTask;e&&e.dirty()})},t.prototype.getPerformArgs=function(t,e){if(t.__pipeline){var n=this.Dh.get(t.__pipeline.id),i=n.context,r=!e&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex?n.step:null,o=i&&i.modDataCount;return{step:r,modBy:null!=o?Math.ceil(o/r):null,modDataCount:o}}},t.prototype.getPipeline=function(t){return this.Dh.get(t)},t.prototype.updateStreamModes=function(t,e){var n=this.Dh.get(t.uid),i=t.getData().count(),r=n.progressiveEnabled&&e.incrementalPrepareRender&&i>=n.threshold,o=t.get("large")&&i>=t.get("largeThreshold"),a="mod"===t.get("progressiveChunkMode")?i:null;t.pipelineContext=n.context={progressiveRender:r,modDataCount:a,large:o}},t.prototype.restorePipelines=function(t){var e=this,n=e.Dh=Or();t.eachSeries(function(t){var i=t.getProgressive(),r=t.uid;n.set(r,{id:r,head:null,tail:null,threshold:t.getProgressiveThreshold(),progressiveEnabled:i&&!(t.preventIncremental&&t.preventIncremental()),blockIndex:-1,step:Math.round(i||700),count:0}),e.Lh(t,t.dataTask)})},t.prototype.prepareStageTasks=function(){var t=this._h,e=this.api.getModel(),n=this.api;sr(this.zh,function(i){var r=t.get(i.uid)||t.set(i.uid,{});_r(!(i.reset&&i.overallReset),""),i.reset&&this.Oh(i,r,e,n),i.overallReset&&this.Ph(i,r,e,n)},this)},t.prototype.prepareView=function(t,e,n,i){var r=t.renderTask,o=r.context;o.model=e,o.ecModel=n,o.api=i,r.__block=!t.incrementalPrepareRender,this.Lh(e,r)},t.prototype.performDataProcessorTasks=function(t,e){this.Vh(this.Eh,t,e,{block:!0})},t.prototype.performVisualTasks=function(t,e,n){this.Vh(this.Ih,t,e,n)},t.prototype.Vh=function(t,e,n,i){i=i||{};var r=!1,o=this;function a(t,e){return t.setDirty&&(!t.dirtyMap||t.dirtyMap.get(e.__pipeline.id))}sr(t,function(t,s){if(!i.visualType||i.visualType===t.visualType){var l=o._h.get(t.uid),c=l.seriesTaskMap,h=l.overallTask;if(h){var u,d=h.agentStubMap;d.each(function(t){a(i,t)&&(t.dirty(),u=!0)}),u&&h.dirty(),o.updatePayload(h,n);var f=o.getPerformArgs(h,i.block);d.each(function(t){t.perform(f)}),h.perform(f)&&(r=!0)}else c&&c.each(function(s,l){a(i,s)&&s.dirty();var c=o.getPerformArgs(s,i.block);c.skip=!t.performRawSeries&&e.isSeriesFiltered(s.context.model),o.updatePayload(s,n),s.perform(c)&&(r=!0)})}}),this.unfinished=r||this.unfinished},t.prototype.performSeriesTasks=function(t){var e;t.eachSeries(function(t){e=t.dataTask.perform()||e}),this.unfinished=e||this.unfinished},t.prototype.plan=function(){this.Dh.each(function(t){var e=t.tail;do{if(e.__block){t.blockIndex=e.__idxInPipeline;break}e=e.getUpstream()}while(e)})},t.prototype.updatePayload=function(t,e){"remain"!==e&&(t.context.payload=e)},t.prototype.Oh=function(t,e,n,i){var r=this,o=e.seriesTaskMap,a=e.seriesTaskMap=Or(),s=t.seriesType,l=t.getTargetSeries;function c(e){var s=e.uid,l=a.set(s,o&&o.get(s)||Jv({plan:kb,reset:Rb,count:Fb}));l.context={model:e,ecModel:n,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:r},r.Lh(e,l)}t.createOnAllSeries?n.eachRawSeries(c):s?n.eachRawSeriesByType(s,c):l&&l(n,i).each(c)},t.prototype.Ph=function(t,e,n,i){var r=this,o=e.overallTask=e.overallTask||Jv({reset:$b});o.context={ecModel:n,api:i,overallReset:t.overallReset,scheduler:r};var a=o.agentStubMap,s=o.agentStubMap=Or(),l=t.seriesType,c=t.getTargetSeries,h=!0,u=!1;function d(t){var e=t.uid,n=s.set(e,a&&a.get(e)||(u=!0,Jv({reset:Mb,onDirty:Nb})));n.context={model:t,overallProgress:h},n.agent=o,n.__block=h,r.Lh(t,n)}_r(!t.createOnAllSeries,""),l?n.eachRawSeriesByType(l,d):c?c(n,i).each(d):(h=!1,sr(n.getSeries(),d)),u&&o.dirty()},t.prototype.Lh=function(t,e){var n=t.uid,i=this.Dh.get(n);!i.head&&(i.head=e),i.tail&&i.tail.pipe(e),i.tail=e,e.__idxInPipeline=i.count++,e.__pipeline=i},t.wrapStageHandler=function(t,e){return gr(t)&&(t={overallReset:t,seriesType:Eb(t)}),t.uid=om("stageHandler"),e&&(t.visualType=e),t},t}();function $b(t){t.overallReset(t.ecModel,t.api,t.payload)}function Mb(t){return t.overallProgress&&Ab}function Ab(){this.agent.dirty(),this.getDownstream().dirty()}function Nb(){this.agent&&this.agent.dirty()}function kb(t){return t.plan?t.plan(t.model,t.ecModel,t.api,t.payload):null}function Rb(t){t.useClearVisual&&t.data.clearAllVisual();var e=t.resetDefines=sc(t.reset(t.model,t.ecModel,t.api,t.payload));return e.length>1?lr(e,function(t,e){return Ib(e)}):_b}var _b=Ib(0);function Ib(t){return function(e,n){var i=n.data,r=n.resetDefines[t];if(r&&r.dataEach)for(var o=e.start;o<e.end;o++)r.dataEach(i,o);else r&&r.progress&&r.progress(e,i)}}function Fb(t){return t.data.count()}function Eb(t){Db=null;try{t(Lb,Pb)}catch(t){}return Db}var Db,Lb={},Pb={};function zb(t,e){for(var n in e.prototype)t[n]=qr}zb(Lb,Gg),zb(Pb,Qg),Lb.eachSeriesByType=Lb.eachRawSeriesByType=function(t){Db=t},Lb.eachComponent=function(t){"series"===t.mainType&&t.subType&&(Db=t.subType)};var Ob=mg.darkColor,Bb=Ob.background,Vb=function(){return{axisLine:{lineStyle:{color:Ob.axisLine}},splitLine:{lineStyle:{color:Ob.axisSplitLine}},splitArea:{areaStyle:{color:[Ob.backgroundTint,Ob.backgroundTransparent]}},minorSplitLine:{lineStyle:{color:Ob.axisMinorSplitLine}},axisLabel:{color:Ob.axisLabel},axisName:{}}},Hb={label:{color:Ob.secondary},itemStyle:{borderColor:Ob.borderTint},dividerLineStyle:{color:Ob.border}},Ub={darkMode:!0,color:Ob.theme,backgroundColor:Bb,axisPointer:{lineStyle:{color:Ob.border},crossStyle:{color:Ob.borderShade},label:{color:Ob.tertiary}},legend:{textStyle:{color:Ob.secondary},pageTextStyle:{color:Ob.tertiary}},textStyle:{color:Ob.secondary},title:{textStyle:{color:Ob.primary},subtextStyle:{color:Ob.quaternary}},toolbox:{iconStyle:{borderColor:Ob.accent50}},tooltip:{backgroundColor:Ob.neutral20,defaultBorderColor:Ob.border,textStyle:{color:Ob.tertiary}},dataZoom:{borderColor:Ob.accent10,textStyle:{color:Ob.tertiary},brushStyle:{color:Ob.backgroundTint},handleStyle:{color:Ob.neutral00,borderColor:Ob.accent20},moveHandleStyle:{color:Ob.accent40},emphasis:{handleStyle:{borderColor:Ob.accent50}},dataBackground:{lineStyle:{color:Ob.accent30},areaStyle:{color:Ob.accent20}},selectedDataBackground:{lineStyle:{color:Ob.accent50},areaStyle:{color:Ob.accent30}}},visualMap:{textStyle:{color:Ob.secondary},handleStyle:{borderColor:Ob.neutral30}},timeline:{lineStyle:{color:Ob.accent10},label:{color:Ob.tertiary},controlStyle:{color:Ob.accent30,borderColor:Ob.accent30}},calendar:{itemStyle:{color:Ob.neutral00,borderColor:Ob.neutral20},dayLabel:{color:Ob.tertiary},monthLabel:{color:Ob.secondary},yearLabel:{color:Ob.secondary}},matrix:{x:Hb,y:Hb,backgroundColor:{borderColor:Ob.axisLine},body:{itemStyle:{borderColor:Ob.borderTint}}},timeAxis:Vb(),logAxis:Vb(),valueAxis:Vb(),categoryAxis:Vb(),line:{symbol:"circle"},graph:{color:Ob.theme},gauge:{title:{color:Ob.secondary},axisLine:{lineStyle:{color:[[1,Ob.neutral05]]}},axisLabel:{color:Ob.axisLabel},detail:{color:Ob.primary}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}},funnel:{itemStyle:{borderColor:Ob.background}},radar:function(){var t=Vb();return t.axisName={color:Ob.axisLabel},t.axisLine.lineStyle.color=Ob.neutral20,t}(),treemap:{breadcrumb:{itemStyle:{color:Ob.neutral20,textStyle:{color:Ob.secondary}},emphasis:{itemStyle:{color:Ob.neutral30}}}},sunburst:{itemStyle:{borderColor:Ob.background}},map:{itemStyle:{borderColor:Ob.border,areaColor:Ob.neutral10},label:{color:Ob.tertiary},emphasis:{label:{color:Ob.primary},itemStyle:{areaColor:Ob.highlight}},select:{label:{color:Ob.primary},itemStyle:{areaColor:Ob.highlight}}},geo:{itemStyle:{borderColor:Ob.border,areaColor:Ob.neutral10},emphasis:{label:{color:Ob.primary},itemStyle:{areaColor:Ob.highlight}},select:{label:{color:Ob.primary},itemStyle:{color:Ob.highlight}}}};Ub.categoryAxis.splitLine.show=!1;var qb=function(){function t(){}return t.prototype.normalizeQuery=function(t){var e={},n={},i={};if(vr(t)){var r=Ac(t);e.mainType=r.main||null,e.subType=r.sub||null}else{var o=["Index","Name","Id"],a={name:1,dataIndex:1,dataType:1};sr(t,function(t,r){for(var s=!1,l=0;l<o.length;l++){var c=o[l],h=r.lastIndexOf(c);if(h>0&&h===r.length-c.length){var u=r.slice(0,h);"data"!==u&&(e.mainType=u,e[c.toLowerCase()]=t,s=!0)}}a.hasOwnProperty(r)&&(n[r]=t,s=!0),s||(i[r]=t)})}return{cptQuery:e,dataQuery:n,otherQuery:i}},t.prototype.filter=function(t,e){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,r=n.packedEvent,o=n.model,a=n.view;if(!o||!a)return!0;var s=e.cptQuery,l=e.dataQuery;return c(s,o,"mainType")&&c(s,o,"subType")&&c(s,o,"index","componentIndex")&&c(s,o,"name")&&c(s,o,"id")&&c(l,r,"name")&&c(l,r,"dataIndex")&&c(l,r,"dataType")&&(!a.filterForExposedEvent||a.filterForExposedEvent(t,e.otherQuery,i,r));function c(t,e,n,i){return null==t[n]||e[i||n]===t[n]}},t.prototype.afterTrigger=function(){this.eventInfo=null},t}(),Kb=["symbol","symbolSize","symbolRotate","symbolOffset"],Wb=Kb.concat(["symbolKeepAspect"]),jb={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var n=t.getData();if(t.legendIcon&&n.setVisual("legendIcon",t.legendIcon),t.hasSymbolVisual){for(var i={},r={},o=!1,a=0;a<Kb.length;a++){var s=Kb[a],l=t.get(s);gr(l)?(o=!0,r[s]=l):i[s]=l}if(i.symbol=i.symbol||t.defaultSymbol,n.setVisual(nr({legendIcon:t.legendIcon||i.symbol,symbolKeepAspect:t.get("symbolKeepAspect")},i)),!e.isSeriesFiltered(t)){var c=dr(r);return{dataEach:o?function(e,n){for(var i=t.getRawValue(n),o=t.getDataParams(n),a=0;a<c.length;a++){var s=c[a];e.setItemVisual(n,s,r[s](i,o))}}:null}}}}},Gb={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){if(t.hasSymbolVisual&&!e.isSeriesFiltered(t))return{dataEach:t.getData().hasItemOption?function(t,e){for(var n=t.getItemModel(e),i=0;i<Wb.length;i++){var r=Wb[i],o=n.getShallow(r,!0);null!=o&&t.setItemVisual(e,r,o)}}:null}}};function Xb(t,e,n,i,r){var o=t+e;n.isSilent(o)||i.eachComponent({mainType:"series",subType:"pie"},function(t){for(var e=t.seriesIndex,i=t.option.selectedMap,a=r.selected,s=0;s<a.length;s++)if(a[s].seriesIndex===e){var l=t.getData(),c=vc(l,r.fromActionPayload);n.trigger(o,{type:o,seriesId:t.id,name:mr(c)?l.getName(c[0]):l.getName(c),selected:vr(i)?i:nr({},i)})}})}function Yb(t,e,n){for(var i;t&&(!e(t)||(i=t,!n));)t=t.__hostTarget||t.parent;return i}var Zb=Math.round(9*Math.random()),Jb="function"==typeof Object.defineProperty,Qb=function(){function t(){this.Bh="__ec_inner_"+Zb++}return t.prototype.get=function(t){return this.Hh(t)[this.Bh]},t.prototype.set=function(t,e){var n=this.Hh(t);return Jb?Object.defineProperty(n,this.Bh,{value:e,enumerable:!1,configurable:!0}):n[this.Bh]=e,this},t.prototype.delete=function(t){return!!this.has(t)&&(delete this.Hh(t)[this.Bh],!0)},t.prototype.has=function(t){return!!this.Hh(t)[this.Bh]},t.prototype.Hh=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},t}(),tx=fu.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=e.width/2,o=e.height/2;t.moveTo(n,i-o),t.lineTo(n+r,i+o),t.lineTo(n-r,i+o),t.closePath()}}),ex=fu.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=e.width/2,o=e.height/2;t.moveTo(n,i-o),t.lineTo(n+r,i),t.lineTo(n,i+o),t.lineTo(n-r,i),t.closePath()}}),nx=fu.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,i=e.y,r=e.width/5*3,o=Math.max(r,e.height),a=r/2,s=a*a/(o-a),l=i-o+a+s,c=Math.asin(s/a),h=Math.cos(c)*a,u=Math.sin(c),d=Math.cos(c),f=.6*a,p=.7*a;t.moveTo(n-h,l+s),t.arc(n,l,a,Math.PI-c,2*Math.PI+c),t.bezierCurveTo(n+h-u*f,l+s+d*f,n,i-p,n,i),t.bezierCurveTo(n,i-p,n-h+u*f,l+s+d*f,n-h,l+s),t.closePath()}}),ix=fu.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.height,i=e.width,r=e.x,o=e.y,a=i/3*2;t.moveTo(r,o),t.lineTo(r+a,o+n),t.lineTo(r,o+n/4*3),t.lineTo(r-a,o+n),t.lineTo(r,o),t.closePath()}}),rx={line:function(t,e,n,i,r){r.x1=t,r.y1=e+i/2,r.x2=t+n,r.y2=e+i/2},rect:function(t,e,n,i,r){r.x=t,r.y=e,r.width=n,r.height=i},roundRect:function(t,e,n,i,r){r.x=t,r.y=e,r.width=n,r.height=i,r.r=Math.min(n,i)/4},square:function(t,e,n,i,r){var o=Math.min(n,i);r.x=t,r.y=e,r.width=o,r.height=o},circle:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.r=Math.min(n,i)/2},diamond:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.width=n,r.height=i},pin:function(t,e,n,i,r){r.x=t+n/2,r.y=e+i/2,r.width=n,r.height=i},arrow:function(t,e,n,i,r){r.x=t+n/2,r.y=e+i/2,r.width=n,r.height=i},triangle:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.width=n,r.height=i}},ox={};sr({line:Af,rect:$u,roundRect:$u,square:$u,circle:tf,diamond:ex,pin:nx,arrow:ix,triangle:tx},function(t,e){ox[e]=new t});var ax=fu.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(t,e,n){var i=xl(t,e,n),r=this.shape;return r&&"pin"===r.symbolType&&"inside"===e.position&&(i.y=n.y+.4*n.height),i},buildPath:function(t,e,n){var i=e.symbolType;if("none"!==i){var r=ox[i];r||(r=ox[i="rect"]),rx[i](e.x,e.y,e.width,e.height,r.shape),r.buildPath(t,r.shape,n)}}});function sx(t,e){if("image"!==this.type){var n=this.style;this.__isEmptyBrush?(n.stroke=t,n.fill=e||mg.color.neutral00,n.lineWidth=2):"line"===this.shape.symbolType?n.stroke=t:n.fill=t,this.markRedraw()}}function lx(t,e,n,i,r,o,a){var s,l=0===t.indexOf("empty");return l&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(s=0===t.indexOf("image://")?cp(t.slice(8),new Jo(e,n,i,r),a?"center":"cover"):0===t.indexOf("path://")?lp(t.slice(7),{},new Jo(e,n,i,r),a?"center":"cover"):new ax({shape:{symbolType:t,x:e,y:n,width:i,height:r}})).__isEmptyBrush=l,s.setColor=sx,o&&s.setColor(o),s}function cx(t){return mr(t)||(t=[+t,+t]),[t[0]||0,t[1]||0]}function hx(t,e){if(null!=t)return mr(t)||(t=[t,t]),[Vl(t[0],e[0])||0,Vl(Ar(t[1],t[0]),e[1])||0]}function ux(t){return isFinite(t)}function dx(t,e,n){for(var i="radial"===e.type?function(t,e,n){var i=n.width,r=n.height,o=Math.min(i,r),a=null==e.x?.5:e.x,s=null==e.y?.5:e.y,l=null==e.r?.5:e.r;return e.global||(a=a*i+n.x,s=s*r+n.y,l*=o),a=ux(a)?a:.5,s=ux(s)?s:.5,l=l>=0&&ux(l)?l:.5,t.createRadialGradient(a,s,0,a,s,l)}(t,e,n):function(t,e,n){var i=null==e.x?0:e.x,r=null==e.x2?1:e.x2,o=null==e.y?0:e.y,a=null==e.y2?0:e.y2;return e.global||(i=i*n.width+n.x,r=r*n.width+n.x,o=o*n.height+n.y,a=a*n.height+n.y),i=ux(i)?i:0,r=ux(r)?r:1,o=ux(o)?o:0,a=ux(a)?a:0,t.createLinearGradient(i,o,r,a)}(t,e,n),r=e.colorStops,o=0;o<r.length;o++)i.addColorStop(r[o].offset,r[o].color);return i}function fx(t){return parseInt(t,10)}function px(t,e,n){var i=["width","height"][e],r=["clientWidth","clientHeight"][e],o=["paddingLeft","paddingTop"][e],a=["paddingRight","paddingBottom"][e];if(null!=n[i]&&"auto"!==n[i])return parseFloat(n[i]);var s=document.defaultView.getComputedStyle(t);return(t[r]||fx(s[i])||fx(t.style[i]))-(fx(s[o])||0)-(fx(s[a])||0)|0}function mx(t){var e,n,i=t.style,r=i.lineDash&&i.lineWidth>0&&(e=i.lineDash,n=i.lineWidth,e&&"solid"!==e&&n>0?"dashed"===e?[4*n,2*n]:"dotted"===e?[n]:br(e)?[e]:mr(e)?e:null:null),o=i.lineDashOffset;if(r){var a=i.strokeNoScale&&t.getLineScale?t.getLineScale():1;a&&1!==a&&(r=lr(r,function(t){return t/a}),o/=a)}return[r,o]}var gx=new Wh(!0);function vx(t){var e=t.stroke;return!(null==e||"none"===e||!(t.lineWidth>0))}function yx(t){return"string"==typeof t&&"none"!==t}function bx(t){var e=t.fill;return null!=e&&"none"!==e}function xx(t,e){if(null!=e.fillOpacity&&1!==e.fillOpacity){var n=t.globalAlpha;t.globalAlpha=e.fillOpacity*e.opacity,t.fill(),t.globalAlpha=n}else t.fill()}function Sx(t,e){if(null!=e.strokeOpacity&&1!==e.strokeOpacity){var n=t.globalAlpha;t.globalAlpha=e.strokeOpacity*e.opacity,t.stroke(),t.globalAlpha=n}else t.stroke()}function Cx(t,e,n){var i=Oc(e.image,e.__image,n);if(Vc(i)){var r=t.createPattern(i,e.repeat||"repeat");if("function"==typeof DOMMatrix&&r&&r.setTransform){var o=new DOMMatrix;o.translateSelf(e.x||0,e.y||0),o.rotateSelf(0,0,(e.rotation||0)*Kr),o.scaleSelf(e.scaleX||1,e.scaleY||1),r.setTransform(o)}return r}}var Tx=["shadowBlur","shadowOffsetX","shadowOffsetY"],$x=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function Mx(t,e,n,i,r){var o=!1;if(!i&&e===(n=n||{}))return!1;if(i||e.opacity!==n.opacity){kx(t,r),o=!0;var a=Math.max(Math.min(e.opacity,1),0);t.globalAlpha=isNaN(a)?sh.opacity:a}(i||e.blend!==n.blend)&&(o||(kx(t,r),o=!0),t.globalCompositeOperation=e.blend||sh.blend);for(var s=0;s<Tx.length;s++){var l=Tx[s];(i||e[l]!==n[l])&&(o||(kx(t,r),o=!0),t[l]=t.dpr*(e[l]||0))}return(i||e.shadowColor!==n.shadowColor)&&(o||(kx(t,r),o=!0),t.shadowColor=e.shadowColor||sh.shadowColor),o}function Ax(t,e,n,i,r){var o=Rx(e,r.inHover),a=i?null:n&&Rx(n,r.inHover)||{};if(o===a)return!1;var s=Mx(t,o,a,i,r);if((i||o.fill!==a.fill)&&(s||(kx(t,r),s=!0),yx(o.fill)&&(t.fillStyle=o.fill)),(i||o.stroke!==a.stroke)&&(s||(kx(t,r),s=!0),yx(o.stroke)&&(t.strokeStyle=o.stroke)),(i||o.opacity!==a.opacity)&&(s||(kx(t,r),s=!0),t.globalAlpha=null==o.opacity?1:o.opacity),e.hasStroke()){var l=o.lineWidth/(o.strokeNoScale&&e.getLineScale?e.getLineScale():1);t.lineWidth!==l&&(s||(kx(t,r),s=!0),t.lineWidth=l)}for(var c=0;c<$x.length;c++){var h=$x[c],u=h[0];(i||o[u]!==a[u])&&(s||(kx(t,r),s=!0),t[u]=o[u]||h[1])}return s}function Nx(t,e){var n=e.transform,i=t.dpr||1;n?t.setTransform(i*n[0],i*n[1],i*n[2],i*n[3],i*n[4],i*n[5]):t.setTransform(i,0,0,i,0,0)}function kx(t,e){e.batchFill&&t.fill(),e.batchStroke&&t.stroke(),e.batchFill="",e.batchStroke=""}function Rx(t,e){return e&&t.__hoverStyle||t.style}function _x(t,e){Ix(t,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Ix(t,e,n,i){var r=e.transform;if(!e.shouldBePainted(n.viewWidth,n.viewHeight,!1,!1))return e.__dirty&=-2,void(e.__isRendered=!1);var o=e.__clipPaths,a=n.prevElClipPaths,s=!1,l=!1;if(a&&!function(t,e){if(t===e||!t&&!e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1}(o,a)||(a&&a.length&&(kx(t,n),t.restore(),l=s=!0,n.prevElClipPaths=null,n.allClipped=!1,n.prevEl=null),o&&o.length&&(kx(t,n),t.save(),function(t,e,n){for(var i=!1,r=0;r<t.length;r++){var o=t[r];i=i||o.isZeroArea(),Nx(e,o),e.beginPath(),o.buildPath(e,o.shape),e.clip()}n.allClipped=i}(o,t,n),s=!0),n.prevElClipPaths=o),n.allClipped)e.__isRendered=!1;else{e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var c=n.prevEl;c||(l=s=!0);var h,u,d=e instanceof fu&&e.autoBatch&&function(t){var e=bx(t),n=vx(t);return!(t.lineDash||!(+e^+n)||e&&"string"!=typeof t.fill||n&&"string"!=typeof t.stroke||t.strokePercent<1||t.strokeOpacity<1||t.fillOpacity<1)}(e.style);s||(h=r,u=c.transform,h&&u?h[0]!==u[0]||h[1]!==u[1]||h[2]!==u[2]||h[3]!==u[3]||h[4]!==u[4]||h[5]!==u[5]:h||u)?(kx(t,n),Nx(t,e)):d||kx(t,n);var f=Rx(e,n.inHover);e instanceof fu?(1!==n.lastDrawType&&(l=!0,n.lastDrawType=1),Ax(t,e,c,l,n),d&&(n.batchFill||n.batchStroke)||t.beginPath(),function(t,e,n,i){var r,o=vx(n),a=bx(n),s=n.strokePercent,l=s<1,c=!e.path;e.silent&&!l||!c||e.createPathProxy();var h=e.path||gx,u=e.__dirty;if(!i){var d=n.fill,f=n.stroke,p=a&&!!d.colorStops,m=o&&!!f.colorStops,g=a&&!!d.image,v=o&&!!f.image,y=void 0,b=void 0,x=void 0,w=void 0,S=void 0;(p||m)&&(S=e.getBoundingRect()),p&&(y=u?dx(t,d,S):e.__canvasFillGradient,e.__canvasFillGradient=y),m&&(b=u?dx(t,f,S):e.__canvasStrokeGradient,e.__canvasStrokeGradient=b),g&&(x=u||!e.__canvasFillPattern?Cx(t,d,e):e.__canvasFillPattern,e.__canvasFillPattern=x),v&&(w=u||!e.__canvasStrokePattern?Cx(t,f,e):e.__canvasStrokePattern,e.__canvasStrokePattern=w),p?t.fillStyle=y:g&&(x?t.fillStyle=x:a=!1),m?t.strokeStyle=b:v&&(w?t.strokeStyle=w:o=!1)}var C,T,$=e.getGlobalScale();h.setScale($[0],$[1],e.segmentIgnoreThreshold),t.setLineDash&&n.lineDash&&(C=(r=mx(e))[0],T=r[1]);var M=!0;(c||4&u)&&(h.setDPR(t.dpr),l?h.setContext(null):(h.setContext(t),M=!1),h.reset(),e.buildPath(h,e.shape,i),h.toStatic(),e.pathUpdated()),M&&h.rebuildPath(t,l?s:1),C&&(t.setLineDash(C),t.lineDashOffset=T),i||(n.strokeFirst?(o&&Sx(t,n),a&&xx(t,n)):(a&&xx(t,n),o&&Sx(t,n))),C&&t.setLineDash([])}(t,e,f,d),d&&(n.batchFill=f.fill||"",n.batchStroke=f.stroke||"")):e instanceof mu?(3!==n.lastDrawType&&(l=!0,n.lastDrawType=3),Ax(t,e,c,l,n),function(t,e,n){var i,r=n.text;if(null!=r&&(r+=""),r){t.font=n.font||Pi,t.textAlign=n.textAlign,t.textBaseline=n.textBaseline;var o=void 0,a=void 0;t.setLineDash&&n.lineDash&&(o=(i=mx(e))[0],a=i[1]),o&&(t.setLineDash(o),t.lineDashOffset=a),n.strokeFirst?(vx(n)&&t.strokeText(r,n.x,n.y),bx(n)&&t.fillText(r,n.x,n.y)):(bx(n)&&t.fillText(r,n.x,n.y),vx(n)&&t.strokeText(r,n.x,n.y)),o&&t.setLineDash([])}}(t,e,f)):e instanceof yu?(2!==n.lastDrawType&&(l=!0,n.lastDrawType=2),function(t,e,n,i,r){Mx(t,Rx(e,r.inHover),n&&Rx(n,r.inHover),i,r)}(t,e,c,l,n),function(t,e,n){var i=e.__image=Oc(n.image,e.__image,e,e.onload);if(i&&Vc(i)){var r=n.x||0,o=n.y||0,a=e.getWidth(),s=e.getHeight(),l=i.width/i.height;if(null==a&&null!=s?a=s*l:null==s&&null!=a?s=a/l:null==a&&null==s&&(a=i.width,s=i.height),n.sWidth&&n.sHeight){var c=n.sx||0,h=n.sy||0;t.drawImage(i,c,h,n.sWidth,n.sHeight,r,o,a,s)}else if(n.sx&&n.sy){var u=a-(c=n.sx),d=s-(h=n.sy);t.drawImage(i,c,h,u,d,r,o,a,s)}else t.drawImage(i,r,o,a,s)}}(t,e,f)):e.getTemporalDisplayables&&(4!==n.lastDrawType&&(l=!0,n.lastDrawType=4),function(t,e,n){var i=e.getDisplayables(),r=e.getTemporalDisplayables();t.save();var o,a,s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:n.viewWidth,viewHeight:n.viewHeight,inHover:n.inHover};for(o=e.getCursor(),a=i.length;o<a;o++)(h=i[o]).beforeBrush&&h.beforeBrush(),h.innerBeforeBrush(),Ix(t,h,s,o===a-1),h.innerAfterBrush(),h.afterBrush&&h.afterBrush(),s.prevEl=h;for(var l=0,c=r.length;l<c;l++){var h;(h=r[l]).beforeBrush&&h.beforeBrush(),h.innerBeforeBrush(),Ix(t,h,s,l===c-1),h.innerAfterBrush(),h.afterBrush&&h.afterBrush(),s.prevEl=h}e.clearTemporalDisplayables(),e.notClear=!0,t.restore()}(t,e,n)),d&&i&&kx(t,n),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),n.prevEl=e,e.__dirty=0,e.__isRendered=!0}}var Fx=new Qb,Ex=new Ya(100),Dx=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function Lx(t,e){if("none"===t)return null;var n=e.getDevicePixelRatio(),i=e.getZr(),r="svg"===i.painter.type;t.dirty&&Fx.delete(t);var o=Fx.get(t);if(o)return o;var a=ir(t,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});"none"===a.backgroundColor&&(a.backgroundColor=null);var s={repeat:"repeat"};return function(t){for(var e,o=[n],s=!0,l=0;l<Dx.length;++l){var c=a[Dx[l]];if(null!=c&&!mr(c)&&!vr(c)&&!br(c)&&"boolean"!=typeof c){s=!1;break}o.push(c)}if(s){e=o.join(",")+(r?"-svg":"");var h=Ex.get(e);h&&(r?t.svgElement=h:t.image=h)}var u,d=zx(a.dashArrayX),f=function(t){if(!t||"object"==typeof t&&0===t.length)return[0,0];if(br(t)){var e=Math.ceil(t);return[e,e]}var n=lr(t,function(t){return Math.ceil(t)});return t.length%2?n.concat(n):n}(a.dashArrayY),p=Px(a.symbol),m=lr(d,function(t){return Ox(t)}),g=Ox(f),v=!r&&Oi.createCanvas(),y=r&&{tag:"g",attrs:{},key:"dcl",children:[]},b=function(){for(var t=1,e=0,n=m.length;e<n;++e)t=nc(t,m[e]);var i=1;for(e=0,n=p.length;e<n;++e)i=nc(i,p[e].length);t*=i;var r=g*m.length*p.length;return{width:Math.max(1,Math.min(t,a.maxTileWidth)),height:Math.max(1,Math.min(r,a.maxTileHeight))}}();v&&(v.width=b.width*n,v.height=b.height*n,u=v.getContext("2d")),function(){u&&(u.clearRect(0,0,v.width,v.height),a.backgroundColor&&(u.fillStyle=a.backgroundColor,u.fillRect(0,0,v.width,v.height)));for(var t=0,e=0;e<f.length;++e)t+=f[e];if(!(t<=0))for(var o=-g,s=0,l=0,c=0;o<b.height;){if(s%2==0){for(var h=l/2%p.length,m=0,x=0,w=0;m<2*b.width;){var S=0;for(e=0;e<d[c].length;++e)S+=d[c][e];if(S<=0)break;if(x%2==0){var C=.5*(1-a.symbolSize),T=m+d[c][x]*C,$=o+f[s]*C,M=d[c][x]*a.symbolSize,A=f[s]*a.symbolSize,N=w/2%p[h].length;k(T,$,M,A,p[h][N])}m+=d[c][x],++w,++x===d[c].length&&(x=0)}++c===d.length&&(c=0)}o+=f[s],++l,++s===f.length&&(s=0)}function k(t,e,o,s,l){var c=r?1:n,h=lx(l,t*c,e*c,o*c,s*c,a.color,a.symbolKeepAspect);if(r){var d=i.painter.renderOneToVNode(h);d&&y.children.push(d)}else _x(u,h)}}(),s&&Ex.put(e,v||y),t.image=v,t.svgElement=y,t.svgWidth=b.width,t.svgHeight=b.height}(s),s.rotation=a.rotation,s.scaleX=s.scaleY=r?1:1/n,Fx.set(t,s),t.dirty=!1,s}function Px(t){if(!t||0===t.length)return[["rect"]];if(vr(t))return[[t]];for(var e=!0,n=0;n<t.length;++n)if(!vr(t[n])){e=!1;break}if(e)return Px([t]);var i=[];for(n=0;n<t.length;++n)vr(t[n])?i.push([t[n]]):i.push(t[n]);return i}function zx(t){if(!t||0===t.length)return[[0,0]];if(br(t))return[[r=Math.ceil(t),r]];for(var e=!0,n=0;n<t.length;++n)if(!br(t[n])){e=!1;break}if(e)return zx([t]);var i=[];for(n=0;n<t.length;++n)if(br(t[n])){var r=Math.ceil(t[n]);i.push([r,r])}else(r=lr(t[n],function(t){return Math.ceil(t)})).length%2==1?i.push(r.concat(r)):i.push(r);return i}function Ox(t){for(var e=0,n=0;n<t.length;++n)e+=t[n];return t.length%2==1?2*e:e}var Bx=new ao,Vx={},Hx=2e3,Ux=4500,qx={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:Hx,CHART:3e3,POST_CHART_LAYOUT:4600,COMPONENT:4e3,BRUSH:5e3,CHART_ITEM:Ux,ARIA:6e3,DECAL:7e3}},Kx="__flagInMainProcess",Wx="__mainProcessVersion",jx="__pendingUpdate",Gx="__needsUpdateStatus",Xx=/^[a-zA-Z0-9_]+$/,Yx="__connectUpdateStatus";function Zx(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!this.isDisposed())return Qx(this,t,e);this.id}}function Jx(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Qx(this,t,e)}}function Qx(t,e,n){return n[0]=n[0]&&n[0].toLowerCase(),ao.prototype[e].apply(t,n)}var tw,ew,nw,iw,rw,ow,aw,sw,lw,cw,hw,uw,dw,fw,pw,mw,gw,vw,yw,bw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e}(ao),xw=bw.prototype;xw.on=Jx("on"),xw.off=Jx("off");var ww=function(t){function e(e,n,i){var r=t.call(this,new qb)||this;r.Uh=[],r.Kh={},r.Wh=[],r.dc={},r.jh=[],i=i||{},r.qi=e,r[Wx]=1,i.ssr;var o=r.qh=Ll(e,{renderer:i.renderer||"canvas",devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:Ar(i.useDirtyRect,!1),useCoarsePointer:Ar(i.useCoarsePointer,"auto"),pointerSize:i.pointerSize});r.Gh=i.ssr,r.Xh=ub(fr(o.flush,o),17),r.Yh(n),r.cc=function(t){if(vr(t)){var e=hm[t.toUpperCase()]||{};return t===sm||t===lm?tr(e):er(tr(e),tr(hm[cm]),!1)}return er(tr(t),tr(hm[cm]),!1)}(i.locale||dm),r.Jh=new eg;var a=r.Mc=pw(r);function s(t,e){return t.__prio-e.__prio}return va(kw,s),va(Aw,s),r.Zh=new Tb(r,a,Aw,kw),r.Qh=new bw,r.tu(),r.resize=fr(r.resize,r),o.animation.on("frame",r.eu,r),cw(o,r),hw(o,r),Er(r),r}return Ei(e,t),e.prototype.eu=function(){if(!this.ml){vw(this);var t=this.Zh;if(this[jx]){var e=this[jx].silent;this[Kx]=!0,yw(this);try{tw(this),iw.update.call(this,null,this[jx].updateParams)}catch(t){throw this[Kx]=!1,this[jx]=null,t}this.qh.flush(),this[Kx]=!1,this[jx]=null,sw.call(this,e),lw.call(this,e)}else if(t.unfinished){var n=1,i=this.nu,r=this.Mc;t.unfinished=!1;do{var o=+new Date;t.performSeriesTasks(i),t.performDataProcessorTasks(i),ow(this,i),t.performVisualTasks(i),fw(this,this.nu,r,"remain",{}),n-=+new Date-o}while(n>0&&t.unfinished);t.unfinished||this.qh.flush()}}},e.prototype.getDom=function(){return this.qi},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this.qh},e.prototype.isSSR=function(){return this.Gh},e.prototype.setOption=function(t,e,n){if(!this[Kx])if(this.ml)this.id;else{var i,r,o;if(xr(e)&&(n=e.lazyUpdate,i=e.silent,r=e.replaceMerge,o=e.transition,e=e.notMerge),this[Kx]=!0,yw(this),!this.nu||e){var a=new ev(this.Mc),s=this.lc,l=this.nu=new Gg;l.scheduler=this.Zh,l.ssr=this.Gh,l.init(null,null,null,s,this.cc,a)}this.nu.setOption(t,{replaceMerge:r},Nw);var c={seriesTransition:o,optionChanged:!0};if(n)this[jx]={silent:i,updateParams:c},this[Kx]=!1,this.getZr().wakeUp();else{try{tw(this),iw.update.call(this,null,c)}catch(t){throw this[jx]=null,this[Kx]=!1,t}this.Gh||this.qh.flush(),this[jx]=null,this[Kx]=!1,sw.call(this,i),lw.call(this,i)}}},e.prototype.setTheme=function(t,e){if(!this[Kx])if(this.ml)this.id;else{var n=this.nu;if(n){var i=e&&e.silent,r=null;this[jx]&&(null==i&&(i=this[jx].silent),r=this[jx].updateParams,this[jx]=null),this[Kx]=!0,yw(this);try{this.Yh(t),n.setTheme(this.lc),tw(this),iw.update.call(this,{type:"setTheme"},r)}catch(t){throw this[Kx]=!1,t}this[Kx]=!1,sw.call(this,i),lw.call(this,i)}}},e.prototype.Yh=function(t){vr(t)&&(t=Rw[t]),t&&((t=tr(t))&&wv(t,!0),this.lc=t)},e.prototype.getModel=function(){return this.nu},e.prototype.getOption=function(){return this.nu&&this.nu.getOption()},e.prototype.getWidth=function(){return this.qh.getWidth()},e.prototype.getHeight=function(){return this.qh.getHeight()},e.prototype.getDevicePixelRatio=function(){return this.qh.painter.dpr||Li.hasGlobalWindow&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(t){return this.renderToCanvas(t)},e.prototype.renderToCanvas=function(t){return t=t||{},this.qh.painter.getRenderedCanvas({backgroundColor:t.backgroundColor||this.nu.get("backgroundColor"),pixelRatio:t.pixelRatio||this.getDevicePixelRatio()})},e.prototype.renderToSVGString=function(t){return t=t||{},this.qh.painter.renderToString({useViewBox:t.useViewBox})},e.prototype.getSvgDataURL=function(){var t=this.qh;return sr(t.storage.getDisplayList(),function(t){t.stopAnimation(null,!0)}),t.painter.toDataURL()},e.prototype.getDataURL=function(t){if(!this.ml){var e=(t=t||{}).excludeComponents,n=this.nu,i=[],r=this;sr(e,function(t){n.eachComponent({mainType:t},function(t){var e=r.dc[t.__viewId];e.group.ignore||(i.push(e),e.group.ignore=!0)})});var o="svg"===this.qh.painter.getType()?this.getSvgDataURL():this.renderToCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return sr(i,function(t){t.group.ignore=!1}),o}this.id},e.prototype.getConnectedDataURL=function(t){if(!this.ml){var e="svg"===t.type,n=this.group,i=Math.min,r=Math.max,o=1/0;if(Fw[n]){var a=o,s=o,l=-1/0,c=-1/0,h=[],u=t&&t.pixelRatio||this.getDevicePixelRatio();sr(Iw,function(o,u){if(o.group===n){var d=e?o.getZr().painter.getSvgDom().innerHTML:o.renderToCanvas(tr(t)),f=o.getDom().getBoundingClientRect();a=i(f.left,a),s=i(f.top,s),l=r(f.right,l),c=r(f.bottom,c),h.push({dom:d,left:f.left,top:f.top})}});var d=(l*=u)-(a*=u),f=(c*=u)-(s*=u),p=Oi.createCanvas(),m=Ll(p,{renderer:e?"svg":"canvas"});if(m.resize({width:d,height:f}),e){var g="";return sr(h,function(t){var e=t.left-a,n=t.top-s;g+='<g transform="translate('+e+","+n+')">'+t.dom+"</g>"}),m.painter.getSvgRoot().innerHTML=g,t.connectedBackgroundColor&&m.painter.setBackgroundColor(t.connectedBackgroundColor),m.refreshImmediately(),m.painter.toDataURL()}return t.connectedBackgroundColor&&m.add(new $u({shape:{x:0,y:0,width:d,height:f},style:{fill:t.connectedBackgroundColor}})),sr(h,function(t){var e=new yu({style:{x:t.left*u-a,y:t.top*u-s,image:t.dom}});m.add(e)}),m.refreshImmediately(),p.toDataURL("image/"+(t&&t.type||"png"))}return this.getDataURL(t)}this.id},e.prototype.convertToPixel=function(t,e,n){return rw(this,"convertToPixel",t,e,n)},e.prototype.convertToLayout=function(t,e,n){return rw(this,"convertToLayout",t,e,n)},e.prototype.convertFromPixel=function(t,e,n){return rw(this,"convertFromPixel",t,e,n)},e.prototype.containPixel=function(t,e){var n;if(!this.ml)return sr(xc(this.nu,t),function(t,i){i.indexOf("Models")>=0&&sr(t,function(t){var r=t.coordinateSystem;if(r&&r.containPoint)n=n||!!r.containPoint(e);else if("seriesModels"===i){var o=this.Kh[t.__viewId];o&&o.containPoint&&(n=n||o.containPoint(e,t))}},this)},this),!!n;this.id},e.prototype.getVisual=function(t,e){var n=xc(this.nu,t,{defaultMainType:"series"}),i=n.seriesModel.getData(),r=n.hasOwnProperty("dataIndexInside")?n.dataIndexInside:n.hasOwnProperty("dataIndex")?i.indexOfRawIndex(n.dataIndex):null;return null!=r?function(t,e,n){switch(n){case"color":return t.getItemVisual(e,"style")[t.getVisual("drawType")];case"opacity":return t.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return t.getItemVisual(e,n)}}(i,r,e):function(t,e){switch(e){case"color":return t.getVisual("style")[t.getVisual("drawType")];case"opacity":return t.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return t.getVisual(e)}}(i,e)},e.prototype.getViewOfComponentModel=function(t){return this.dc[t.__viewId]},e.prototype.getViewOfSeriesModel=function(t){return this.Kh[t.__viewId]},e.prototype.tu=function(){var t=this;sr(Cw,function(e){var n=function(n){var i,r=t.getModel(),o=n.target;if("globalout"===e?i={}:o&&Yb(o,function(t){var e=Bu(t);if(e&&null!=e.dataIndex){var n=e.dataModel||r.getSeriesByIndex(e.seriesIndex);return i=n&&n.getDataParams(e.dataIndex,e.dataType,o)||{},!0}if(e.eventData)return i=nr({},e.eventData),!0},!0),i){var a=i.componentType,s=i.componentIndex;"markLine"!==a&&"markPoint"!==a&&"markArea"!==a||(a="series",s=i.seriesIndex);var l=a&&null!=s&&r.getComponent(a,s),c=l&&t["series"===l.mainType?"Kh":"dc"][l.__viewId];i.event=n,i.type=e,t._$eventProcessor.eventInfo={targetEl:o,packedEvent:i,model:l,view:c},t.trigger(e,i)}};n.zrEventfulCallAtLast=!0,t.qh.on(e,n,t)});var e=this.Qh;sr(Mw,function(n,i){e.on(i,function(e){t.trigger(i,e)})}),function(t,e,n){t.on("selectchanged",function(t){var i=n.getModel();t.isFromClick?(Xb("map","selectchanged",e,i,t),Xb("pie","selectchanged",e,i,t)):"select"===t.fromAction?(Xb("map","selected",e,i,t),Xb("pie","selected",e,i,t)):"unselect"===t.fromAction&&(Xb("map","unselected",e,i,t),Xb("pie","unselected",e,i,t))})}(e,this,this.Mc)},e.prototype.isDisposed=function(){return this.ml},e.prototype.clear=function(){this.ml?this.id:this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this.ml)this.id;else{this.ml=!0,this.getDom()&&Tc(this.getDom(),Dw,"");var t=this,e=t.Mc,n=t.nu;sr(t.Wh,function(t){t.dispose(n,e)}),sr(t.Uh,function(t){t.dispose(n,e)}),t.qh.dispose(),t.qi=t.nu=t.Kh=t.dc=t.Uh=t.Wh=t.Zh=t.Mc=t.qh=t.Xh=t.lc=t.Jh=t.Qh=null,delete Iw[t.id]}},e.prototype.resize=function(t){if(!this[Kx])if(this.ml)this.id;else{this.qh.resize(t);var e=this.nu;if(this.iu&&this.iu.resize(),e){var n=e.resetOption("media"),i=t&&t.silent;this[jx]&&(null==i&&(i=this[jx].silent),n=!0,this[jx]=null),this[Kx]=!0,yw(this);try{n&&tw(this),iw.update.call(this,{type:"resize",animation:nr({duration:0},t&&t.animation)})}catch(t){throw this[Kx]=!1,t}this[Kx]=!1,sw.call(this,i),lw.call(this,i)}}},e.prototype.showLoading=function(t,e){if(this.ml)this.id;else if(xr(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),_w[t]){var n=_w[t](this.Mc,e),i=this.qh;this.iu=n,i.add(n)}},e.prototype.hideLoading=function(){this.ml?this.id:(this.iu&&this.qh.remove(this.iu),this.iu=null)},e.prototype.makeActionFromEvent=function(t){var e=nr({},t);return e.type=$w[t.type],e},e.prototype.dispatchAction=function(t,e){if(this.ml)this.id;else if(xr(e)||(e={silent:!!e}),Tw[t.type]&&this.nu)if(this[Kx])this.jh.push(t);else{var n=e.silent;aw.call(this,t,n);var i=e.flush;i?this.qh.flush():!1!==i&&Li.browser.weChat&&this.Xh(),sw.call(this,n),lw.call(this,n)}},e.prototype.updateLabelLayout=function(){Bx.trigger("series:layoutlabels",this.nu,this.Mc,{updatedSeries:[]})},e.prototype.appendData=function(t){if(this.ml)this.id;else{var e=t.seriesIndex;this.getModel().getSeriesByIndex(e).appendData(t),this.Zh.unfinished=!0,this.getZr().wakeUp()}},e.internalField=function(){function t(t){t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette()})}function e(t){for(var e=[],n=t.currentStates,i=0;i<n.length;i++){var r=n[i];"emphasis"!==r&&"blur"!==r&&"select"!==r&&e.push(r)}t.selected&&t.states.select&&e.push("select"),2===t.hoverState&&t.states.emphasis?e.push("emphasis"):1===t.hoverState&&t.states.blur&&e.push("blur"),t.useStates(e)}function n(t,e){if(!t.preventAutoZ){var n=_p(t);e.eachRendered(function(t){return Ip(t,n.z,n.zlevel),!0})}}function i(t,e){e.eachRendered(function(t){if(!Qf(t)){var e=t.getTextContent(),n=t.getTextGuideLine();t.stateTransition&&(t.stateTransition=null),e&&e.stateTransition&&(e.stateTransition=null),n&&n.stateTransition&&(n.stateTransition=null),t.hasState()?(t.prevStates=t.currentStates,t.clearStates()):t.prevStates&&(t.prevStates=null)}})}function r(t,n){var i=t.getModel("stateAnimation"),r=t.isAnimationEnabled(),o=i.get("duration"),a=o>0?{duration:o,delay:i.get("delay"),easing:i.get("easing")}:null;n.eachRendered(function(t){if(t.states&&t.states.emphasis){if(Qf(t))return;if(t instanceof fu&&function(t){var e=Uu(t);e.normalFill=t.style.fill,e.normalStroke=t.style.stroke;var n=t.states.select||{};e.selectFill=n.style&&n.style.fill||null,e.selectStroke=n.style&&n.style.stroke||null}(t),t.__dirty){var n=t.prevStates;n&&t.useStates(n)}if(r){t.stateTransition=a;var i=t.getTextContent(),o=t.getTextGuideLine();i&&(i.stateTransition=a),o&&(o.stateTransition=a)}t.__dirty&&e(t)}})}tw=function(t){var e=t.Zh;e.restorePipelines(t.nu),e.prepareStageTasks(),ew(t,!0),ew(t,!1),e.plan()},ew=function(t,e){for(var n=t.nu,i=t.Zh,r=e?t.Wh:t.Uh,o=e?t.dc:t.Kh,a=t.qh,s=t.Mc,l=0;l<r.length;l++)r[l].__alive=!1;function c(t){var l=t.__requireNewView;t.__requireNewView=!1;var c="_ec_"+t.id+"_"+t.type,h=!l&&o[c];if(!h){var u=Ac(t.type);(h=new(e?Jy.getClass(u.main,u.sub):nb.getClass(u.sub))).init(n,s),o[c]=h,r.push(h),a.add(h.group)}t.__viewId=h.__id=c,h.__alive=!0,h.__model=t,h.group.__ecComponentInfo={mainType:t.mainType,index:t.componentIndex},!e&&i.prepareView(h,t,n,s)}for(e?n.eachComponent(function(t,e){"series"!==t&&c(e)}):n.eachSeries(c),l=0;l<r.length;){var h=r[l];h.__alive?l++:(!e&&h.renderTask.dispose(),a.remove(h.group),h.dispose(n,s),r.splice(l,1),o[h.__id]===h&&delete o[h.__id],h.__id=h.group.__ecComponentInfo=null)}},nw=function(t,e,n,i,r){var o=t.nu;if(o.setUpdatePayload(n),i){var a={};a[i+"Id"]=n[i+"Id"],a[i+"Index"]=n[i+"Index"],a[i+"Name"]=n[i+"Name"];var s={mainType:i,query:a};r&&(s.subType=r);var l,c=n.excludeSeriesId;null!=c&&(l=Or(),sr(sc(c),function(t){var e=pc(t,null);null!=e&&l.set(e,!0)})),o&&o.eachComponent(s,function(e){if(!l||null==l.get(e.id))if(Dd(n))if(e instanceof qy)n.type!==ju||n.notBlur||e.get(["emphasis","disabled"])||function(t,e,n){var i=t.seriesIndex,r=t.getData(e.dataType);if(r){var o=vc(r,e);o=(mr(o)?o[0]:o)||0;var a=r.getItemGraphicEl(o);if(!a)for(var s=r.count(),l=0;!a&&l<s;)a=r.getItemGraphicEl(l++);if(a){var c=Bu(a);wd(i,c.focus,c.blurScope,n)}else{var h=t.get(["emphasis","focus"]),u=t.get(["emphasis","blurScope"]);null!=h&&wd(i,h,u,n)}}}(e,n,t.Mc);else{var i=Cd(e.mainType,e.componentIndex,n.name,t.Mc),r=i.focusSelf,o=i.dispatchers;n.type===ju&&r&&!n.notBlur&&Sd(e.mainType,e.componentIndex,t.Mc),o&&sr(o,function(t){n.type===ju?pd(t):md(t)})}else Ed(n)&&e instanceof qy&&(function(t,e){if(Ed(e)){var n=e.dataType,i=vc(t.getData(n),e);mr(i)||(i=[i]),t[e.type===Zu?"toggleSelect":e.type===Xu?"select":"unselect"](i,n)}}(e,n,t.Mc),Td(e),gw(t))},t),o&&o.eachComponent(s,function(e){l&&null!=l.get(e.id)||h(t["series"===i?"Kh":"dc"][e.__viewId])},t)}else sr([].concat(t.Wh).concat(t.Uh),h);function h(i){i&&i.__alive&&i[e]&&i[e](i.__model,o,t.Mc,n)}},iw={prepareAndUpdate:function(t){tw(this),iw.update.call(this,t,t&&{optionChanged:null!=t.newOption})},update:function(e,n){var i=this.nu,r=this.Mc,o=this.qh,a=this.Jh,s=this.Zh;if(i){i.setUpdatePayload(e),s.restoreData(i,e),s.performSeriesTasks(i),a.create(i,r),s.performDataProcessorTasks(i,e),ow(this,i),a.update(i,r),t(i),s.performVisualTasks(i,e);var l=i.get("backgroundColor")||"transparent";o.setBackgroundColor(l);var c=i.get("darkMode");null!=c&&"auto"!==c&&o.setDarkMode(c),uw(this,i,r,e,n),Bx.trigger("afterupdate",i,r)}},updateTransform:function(e){var n=this,i=this.nu,r=this.Mc;if(i){i.setUpdatePayload(e);var o=[];i.eachComponent(function(t,a){if("series"!==t){var s=n.getViewOfComponentModel(a);if(s&&s.__alive)if(s.updateTransform){var l=s.updateTransform(a,i,r,e);l&&l.update&&o.push(s)}else o.push(s)}});var a=Or();i.eachSeries(function(t){var o=n.Kh[t.__viewId];if(o.updateTransform){var s=o.updateTransform(t,i,r,e);s&&s.update&&a.set(t.uid,1)}else a.set(t.uid,1)}),t(i),this.Zh.performVisualTasks(i,e,{setDirty:!0,dirtyMap:a}),fw(this,i,r,e,{},a),Bx.trigger("afterupdate",i,r)}},updateView:function(e){var n=this.nu;n&&(n.setUpdatePayload(e),nb.markUpdateMethod(e,"updateView"),t(n),this.Zh.performVisualTasks(n,e,{setDirty:!0}),uw(this,n,this.Mc,e,{}),Bx.trigger("afterupdate",n,this.Mc))},updateVisual:function(e){var n=this,i=this.nu;i&&(i.setUpdatePayload(e),i.eachSeries(function(t){t.getData().clearAllVisual()}),nb.markUpdateMethod(e,"updateVisual"),t(i),this.Zh.performVisualTasks(i,e,{visualType:"visual",setDirty:!0}),i.eachComponent(function(t,r){if("series"!==t){var o=n.getViewOfComponentModel(r);o&&o.__alive&&o.updateVisual(r,i,n.Mc,e)}}),i.eachSeries(function(t){n.Kh[t.__viewId].updateVisual(t,i,n.Mc,e)}),Bx.trigger("afterupdate",i,this.Mc))},updateLayout:function(t){iw.update.call(this,t)}},rw=function(t,e,n,i,r){if(t.ml)t.id;else for(var o,a=t.nu,s=t.Jh.getCoordinateSystems(),l=xc(a,n),c=0;c<s.length;c++){var h=s[c];if(h[e]&&null!=(o=h[e](a,l,i,r)))return o}},ow=function(t,e){var n=t.Kh,i=t.Zh;e.eachSeries(function(t){i.updateStreamModes(t,n[t.__viewId])})},aw=function(t,e){var n=this,i=this.getModel(),r=t.type,o=t.escapeConnect,a=Tw[r],s=(a.update||"update").split(":"),l=s.pop(),c=null!=s[0]&&Ac(s[0]);this[Kx]=!0,yw(this);var h=[t],u=!1;t.batch&&(u=!0,h=lr(t.batch,function(e){return(e=ir(nr({},e),t)).batch=null,e}));var d,f=[],p=[],m=a.nonRefinedEventType,g=Ed(t),v=Dd(t);if(v&&xd(this.Mc),sr(h,function(e){var r=a.action(e,i,n.Mc);if(a.refineEvent?p.push(r):d=r,(d=d||nr({},e)).type=m,f.push(d),v){var o=wc(t),s=o.queryOptionMap,h=o.mainTypeSpecified?s.keys()[0]:"series";nw(n,l,e,h),gw(n)}else g?(nw(n,l,e,"series"),gw(n)):c&&nw(n,l,e,c.main,c.sub)}),"none"!==l&&!v&&!g&&!c)try{this[jx]?(tw(this),iw.update.call(this,t),this[jx]=null):iw[l].call(this,t)}catch(t){throw this[Kx]=!1,t}if(d=u?{type:m,escapeConnect:o,batch:f}:f[0],this[Kx]=!1,!e){var y=void 0;if(a.refineEvent){var b=a.refineEvent(p,t,i,this.Mc).eventContent;_r(xr(b)),(y=ir({type:a.refinedEventType},b)).fromAction=t.type,y.fromActionPayload=t,y.escapeConnect=!0}var x=this.Qh;x.trigger(d.type,d),y&&x.trigger(y.type,y)}},sw=function(t){for(var e=this.jh;e.length;){var n=e.shift();aw.call(this,n,t)}},lw=function(t){!t&&this.trigger("updated")},cw=function(t,e){t.on("rendered",function(n){e.trigger("rendered",n),!t.animation.isFinished()||e[jx]||e.Zh.unfinished||e.jh.length||e.trigger("finished")})},hw=function(t,e){t.on("mouseover",function(t){var n=Yb(t.target,Fd);n&&(function(t,e,n){var i=Bu(t),r=Cd(i.componentMainType,i.componentIndex,i.componentHighDownName,n),o=r.dispatchers,a=r.focusSelf;o?(a&&Sd(i.componentMainType,i.componentIndex,n),sr(o,function(t){return dd(t,e)})):(wd(i.seriesIndex,i.focus,i.blurScope,n),"self"===i.focus&&Sd(i.componentMainType,i.componentIndex,n),dd(t,e))}(n,t,e.Mc),gw(e))}).on("mouseout",function(t){var n=Yb(t.target,Fd);n&&(function(t,e,n){xd(n);var i=Bu(t),r=Cd(i.componentMainType,i.componentIndex,i.componentHighDownName,n).dispatchers;r?sr(r,function(t){return fd(t,e)}):fd(t,e)}(n,t,e.Mc),gw(e))}).on("click",function(t){var n=Yb(t.target,function(t){return null!=Bu(t).dataIndex},!0);if(n){var i=n.selected?"unselect":"select",r=Bu(n);e.Mc.dispatchAction({type:i,dataType:r.dataType,dataIndexInside:r.dataIndex,seriesIndex:r.seriesIndex,isFromClick:!0})}})},uw=function(t,e,n,i,r){!function(t){var e=[],n=[],i=!1;if(t.eachComponent(function(t,r){var o=r.get("zlevel")||0,a=r.get("z")||0,s=r.getZLevelKey();i=i||!!s,("series"===t?n:e).push({zlevel:o,z:a,idx:r.componentIndex,type:t,key:s})}),i){var r,o,a=e.concat(n);va(a,function(t,e){return t.zlevel===e.zlevel?t.z-e.z:t.zlevel-e.zlevel}),sr(a,function(e){var n=t.getComponent(e.type,e.idx),i=e.zlevel,a=e.key;null!=r&&(i=Math.max(r,i)),a?(i===r&&a!==o&&i++,o=a):o&&(i===r&&i++,o=""),r=i,n.setZLevel(i)})}}(e),dw(t,e,n,i,r),sr(t.Uh,function(t){t.__alive=!1}),fw(t,e,n,i,r),sr(t.Uh,function(t){t.__alive||t.remove(e,n)})},dw=function(t,e,o,a,s,l){sr(l||t.Wh,function(t){var s=t.__model;i(0,t),t.render(s,e,o,a),n(s,t),r(s,t)})},fw=function(t,e,o,a,s,l){var c=t.Zh;s=nr(s||{},{updatedSeries:e.getSeries()}),Bx.trigger("series:beforeupdate",e,o,s);var h=!1;e.eachSeries(function(e){var n=t.Kh[e.__viewId];n.__alive=!0;var r=n.renderTask;c.updatePayload(r,a),i(0,n),l&&l.get(e.uid)&&r.dirty(),r.perform(c.getPerformArgs(r))&&(h=!0),n.group.silent=!!e.get("silent"),function(t,e){var n=t.get("blendMode")||null;e.eachRendered(function(t){t.isGroup||(t.style.blend=n)})}(e,n),Td(e)}),c.unfinished=h||c.unfinished,Bx.trigger("series:layoutlabels",e,o,s),Bx.trigger("series:transition",e,o,s),e.eachSeries(function(e){var i=t.Kh[e.__viewId];n(e,i),r(e,i)}),function(t,e){var n=t.qh.storage,i=0;n.traverse(function(t){t.isGroup||i++}),i>e.get("hoverLayerThreshold")&&!Li.node&&!Li.worker&&e.eachSeries(function(e){if(!e.preventUsingHoverLayer){var n=t.Kh[e.__viewId];n.__alive&&n.eachRendered(function(t){t.states.emphasis&&(t.states.emphasis.hoverLayer=!0)})}})}(t,e),Bx.trigger("series:afterupdate",e,o,s)},gw=function(t){t[Gx]=!0,t.getZr().wakeUp()},yw=function(t){t[Wx]=(t[Wx]+1)%1e3},vw=function(t){t[Gx]&&(t.getZr().storage.traverse(function(t){Qf(t)||e(t)}),t[Gx]=!1)},pw=function(t){return new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Ei(n,e),n.prototype.getCoordinateSystems=function(){return t.Jh.getCoordinateSystems()},n.prototype.getComponentByElement=function(e){for(;e;){var n=e.__ecComponentInfo;if(null!=n)return t.nu.getComponent(n.mainType,n.index);e=e.parent}},n.prototype.enterEmphasis=function(e,n){pd(e,n),gw(t)},n.prototype.leaveEmphasis=function(e,n){md(e,n),gw(t)},n.prototype.enterBlur=function(e){!function(t){ld(t,id)}(e),gw(t)},n.prototype.leaveBlur=function(e){gd(e),gw(t)},n.prototype.enterSelect=function(e){vd(e),gw(t)},n.prototype.leaveSelect=function(e){yd(e),gw(t)},n.prototype.getModel=function(){return t.getModel()},n.prototype.getViewOfComponentModel=function(e){return t.getViewOfComponentModel(e)},n.prototype.getViewOfSeriesModel=function(e){return t.getViewOfSeriesModel(e)},n.prototype.getMainProcessVersion=function(){return t[Wx]},n}(Qg))(t)},mw=function(t){function e(t,e){for(var n=0;n<t.length;n++)t[n][Yx]=e}sr($w,function(n,i){t.Qh.on(i,function(n){if(Fw[t.group]&&0!==t[Yx]){if(n&&n.escapeConnect)return;var i=t.makeActionFromEvent(n),r=[];sr(Iw,function(e){e!==t&&e.group===t.group&&r.push(e)}),e(r,0),sr(r,function(t){1!==t[Yx]&&t.dispatchAction(i)}),e(r,2)}})})}}(),e}(ao),Sw=ww.prototype;Sw.on=Zx("on"),Sw.off=Zx("off"),Sw.one=function(t,e,n){var i=this;this.on.call(this,t,function n(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e&&e.apply&&e.apply(this,r),i.off(t,n)},n)};var Cw=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"],Tw={},$w={},Mw={},Aw=[],Nw=[],kw=[],Rw={},_w={},Iw={},Fw={},Ew=+new Date-0,Dw="_echarts_instance_";function Lw(t,e,n){var i=!(n&&n.ssr);if(i){var r=function(t){return Iw[function(t,e){return t.getAttribute?t.getAttribute(e):t[e]}(t,Dw)]}(t);if(r)return r}var o=new ww(t,e,n);return o.id="ec_"+Ew++,Iw[o.id]=o,i&&Tc(t,Dw,o.id),mw(o),Bx.trigger("afterinit",o),o}function Pw(t,e){Rw[t]=e}function zw(t){rr(Nw,t)<0&&Nw.push(t)}function Ow(t,e){qw(Aw,t,e,2e3)}function Bw(t,e){Bx.on(t,e)}function Vw(t,e,n){var i,r,o,a,s;function l(t){return t.toLowerCase()}gr(e)&&(n=e,e=""),xr(t)?(i=t.type,r=t.event,a=t.update,s=t.publishNonRefinedEvent,n||(n=t.action),o=t.refineEvent):(i=t,r=e),r=l(r||i);var c=o?l(i):r;Tw[i]||(_r(Xx.test(i)&&Xx.test(r)),o&&_r(r!==i),Tw[i]={actionType:i,refinedEventType:r,nonRefinedEventType:c,update:a,action:n,refineEvent:o},Mw[r]=1,o&&s&&(Mw[c]=1),$w[c]=i)}function Hw(t,e){qw(kw,t,e,3e3,"visual")}var Uw=[];function qw(t,e,n,i,r){if((gr(e)||xr(e))&&(n=e,e=i),!(rr(Uw,n)>=0)){Uw.push(n);var o=Tb.wrapStageHandler(n,r);o.__prio=e,o.__raw=n,t.push(o)}}function Kw(t,e){_w[t]=e}function Ww(t,e,n,i){return{eventContent:{selected:$d(n),isFromClick:e.isFromClick||!1}}}function jw(t){return null==t?0:t.length||1}function Gw(t){return t}Hw(Hx,bb),Hw(Ux,wb),Hw(Ux,Sb),Hw(Hx,jb),Hw(Ux,Gb),Hw(7e3,function(t,e){t.eachRawSeries(function(n){if(!t.isSeriesFiltered(n)){var i=n.getData();i.hasItemVisual()&&i.each(function(t){var n=i.getItemVisual(t,"decal");n&&(i.ensureUniqueItemVisual(t,"style").decal=Lx(n,e))});var r=i.getVisual("decal");r&&(i.getVisual("style").decal=Lx(r,e))}})}),zw(wv),Ow(900,function(t){var e=Or();t.eachSeries(function(t){var n=t.get("stack");if(n){var i=e.get(n)||e.set(n,[]),r=t.getData(),o={stackResultDimension:r.getCalculationInfo("stackResultDimension"),stackedOverDimension:r.getCalculationInfo("stackedOverDimension"),stackedDimension:r.getCalculationInfo("stackedDimension"),stackedByDimension:r.getCalculationInfo("stackedByDimension"),isStackedByIndex:r.getCalculationInfo("isStackedByIndex"),data:r,seriesModel:t};if(!o.stackedDimension||!o.isStackedByIndex&&!o.stackedByDimension)return;i.push(o)}}),e.each(function(t){0!==t.length&&("seriesDesc"===(t[0].seriesModel.get("stackOrder")||"seriesAsc")&&t.reverse(),sr(t,function(e,n){e.data.setCalculationInfo("stackedOnSeries",n>0?t[n-1].seriesModel:null)}),function(t){sr(t,function(e,n){var i=[],r=[NaN,NaN],o=[e.stackResultDimension,e.stackedOverDimension],a=e.data,s=e.isStackedByIndex,l=e.seriesModel.get("stackStrategy")||"samesign";a.modify(o,function(o,c,h){var u,d,f=a.get(e.stackedDimension,h);if(isNaN(f))return r;s?d=a.getRawIndex(h):u=a.get(e.stackedByDimension,h);for(var p=NaN,m=n-1;m>=0;m--){var g=t[m];if(s||(d=g.data.rawIndexOf(g.stackedByDimension,u)),d>=0){var v=g.data.getByRawIndex(g.stackResultDimension,d);if("all"===l||"positive"===l&&v>0||"negative"===l&&v<0||"samesign"===l&&f>=0&&v>0||"samesign"===l&&f<=0&&v<0){f=Kl(f,v),p=v;break}}}return i[0]=f,i[1]=p,i})})}(t))})}),Kw("default",function(t,e){ir(e=e||{},{text:"loading",textColor:mg.color.primary,fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255,255,255,0.8)",showSpinner:!0,color:mg.color.theme[0],spinnerRadius:10,lineWidth:5,zlevel:0});var n=new Il,i=new $u({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});n.add(i);var r,o=new ku({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),a=new $u({style:{fill:"none"},textContent:o,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});return n.add(a),e.showSpinner&&((r=new Ff({shape:{startAngle:-Cb/2,endAngle:-Cb/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001})).animateShape(!0).when(1e3,{endAngle:3*Cb/2}).start("circularInOut"),r.animateShape(!0).when(1e3,{startAngle:3*Cb/2}).delay(300).start("circularInOut"),n.add(r)),n.resize=function(){var n=o.getBoundingRect().width,s=e.showSpinner?e.spinnerRadius:0,l=(t.getWidth()-2*s-(e.showSpinner&&n?10:0)-n)/2-(e.showSpinner&&n?0:5+n/2)+(e.showSpinner?0:n/2)+(n?0:s),c=t.getHeight()/2;e.showSpinner&&r.setShape({cx:l,cy:c}),a.setShape({x:l-s,y:c-s,width:2*s,height:2*s}),i.setShape({x:0,y:0,width:t.getWidth(),height:t.getHeight()})},n.resize(),n}),Vw({type:ju,event:ju,update:ju},qr),Vw({type:Gu,event:Gu,update:Gu},qr),Vw({type:Xu,event:Ju,update:Xu,action:qr,refineEvent:Ww,publishNonRefinedEvent:!0}),Vw({type:Yu,event:Ju,update:Yu,action:qr,refineEvent:Ww,publishNonRefinedEvent:!0}),Vw({type:Zu,event:Ju,update:Zu,action:qr,refineEvent:Ww,publishNonRefinedEvent:!0}),Pw("default",{}),Pw("dark",Ub);var Xw=function(){function t(t,e,n,i,r,o){this.ru=t,this.su=e,this.ou=n||Gw,this.au=i||Gw,this.context=r,this.lu="multiple"===o}return t.prototype.add=function(t){return this.Wn=t,this},t.prototype.update=function(t){return this.cu=t,this},t.prototype.updateManyToOne=function(t){return this.hu=t,this},t.prototype.updateOneToMany=function(t){return this.uu=t,this},t.prototype.updateManyToMany=function(t){return this.fu=t,this},t.prototype.remove=function(t){return this.vs=t,this},t.prototype.execute=function(){this[this.lu?"du":"mu"]()},t.prototype.mu=function(){var t=this.ru,e=this.su,n={},i=new Array(t.length),r=new Array(e.length);this.pu(t,null,i,"_oldKeyGetter"),this.pu(e,n,r,"_newKeyGetter");for(var o=0;o<t.length;o++){var a=i[o],s=n[a],l=jw(s);if(l>1){var c=s.shift();1===s.length&&(n[a]=s[0]),this.cu&&this.cu(c,o)}else 1===l?(n[a]=null,this.cu&&this.cu(s,o)):this.vs&&this.vs(o)}this.vu(r,n)},t.prototype.du=function(){var t=this.ru,e=this.su,n={},i={},r=[],o=[];this.pu(t,n,r,"_oldKeyGetter"),this.pu(e,i,o,"_newKeyGetter");for(var a=0;a<r.length;a++){var s=r[a],l=n[s],c=i[s],h=jw(l),u=jw(c);if(h>1&&1===u)this.hu&&this.hu(c,l),i[s]=null;else if(1===h&&u>1)this.uu&&this.uu(c,l),i[s]=null;else if(1===h&&1===u)this.cu&&this.cu(c,l),i[s]=null;else if(h>1&&u>1)this.fu&&this.fu(c,l),i[s]=null;else if(h>1)for(var d=0;d<h;d++)this.vs&&this.vs(l[d]);else this.vs&&this.vs(l)}this.vu(o,i)},t.prototype.vu=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[i],o=jw(r);if(o>1)for(var a=0;a<o;a++)this.Wn&&this.Wn(r[a]);else 1===o&&this.Wn&&this.Wn(r);e[i]=null}},t.prototype.pu=function(t,e,n,i){for(var r=this.lu,o=0;o<t.length;o++){var a="_ec_"+this[i](t[o],o);if(r||(n[o]=a),e){var s=e[a],l=jw(s);0===l?(e[a]=o,r&&n.push(a)):1===l?e[a]=[s,o]:s.push(o)}}},t}(),Yw=function(){function t(t,e){this.bu=t,this.gu=e}return t.prototype.get=function(){return{fullDimensions:this.yu(),encode:this.bu}},t.prototype.yu=function(){return this.wu||(this.wu=this.gu?this.gu.makeOutputDimensionNames():[]),this.wu},t}();function Zw(t,e){return t.hasOwnProperty(e)||(t[e]=[]),t[e]}function Jw(t){return"category"===t?"ordinal":"time"===t?"time":"float"}var Qw=function(t){this.otherDims={},null!=t&&nr(this,t)},tS=yc(),eS={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},nS=function(){function t(t){this.dimensions=t.dimensions,this.xu=t.dimensionOmitted,this.source=t.source,this.$u=t.fullDimensionCount,this.Mu(t.dimensionOmitted)}return t.prototype.isDimensionOmitted=function(){return this.xu},t.prototype.Mu=function(t){this.xu=t,t&&(this.Cu||(this.Cu=oS(this.source)))},t.prototype.getSourceDimensionIndex=function(t){return Ar(this.Cu.get(t),-1)},t.prototype.getSourceDimension=function(t){var e=this.source.dimensionsDefine;if(e)return e[t]},t.prototype.makeStoreSchema=function(){for(var t=this.$u,e=Dv(this.source),n=!aS(t),i="",r=[],o=0,a=0;o<t;o++){var s=void 0,l=void 0,c=void 0,h=this.dimensions[a];if(h&&h.storeDimIndex===o)s=e?h.name:null,l=h.type,c=h.ordinalMeta,a++;else{var u=this.getSourceDimension(o);u&&(s=e?u.name:null,l=u.type)}r.push({property:s,type:l,ordinalMeta:c}),!e||null==s||h&&h.isCalculationCoord||(i+=n?s.replace(/\`/g,"`1").replace(/\$/g,"`2"):s),i+="$",i+=eS[l]||"f",c&&(i+=c.uid),i+="$"}var d=this.source;return{dimensions:r,hash:[d.seriesLayoutBy,d.startIndex,i].join("$$")}},t.prototype.makeOutputDimensionNames=function(){for(var t=[],e=0,n=0;e<this.$u;e++){var i=void 0,r=this.dimensions[n];if(r&&r.storeDimIndex===e)r.isCalculationCoord||(i=r.name),n++;else{var o=this.getSourceDimension(e);o&&(i=o.name)}t.push(i)}return t},t.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this.$u++,this.Mu(!0)},t}();function iS(t){return t instanceof nS}function rS(t){for(var e=Or(),n=0;n<(t||[]).length;n++){var i=t[n],r=xr(i)?i.name:i;null!=r&&null==e.get(r)&&e.set(r,n)}return e}function oS(t){var e=tS(t);return e.dimNameMap||(e.dimNameMap=rS(t.dimensionsDefine))}function aS(t){return t>30}var sS,lS,cS,hS,uS,dS,fS,pS=xr,mS=lr,gS="undefined"==typeof Int32Array?Array:Int32Array,vS=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],yS=["_approximateExtent"],bS=function(){function t(t,e){var n;this.type="list",this.xu=!1,this.Su=[],this.Ru=[],this.Au={},this.ku={},this.Tu=[],this.Nu=[],this.Fu=[],this._u={},this.Eu={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var i=!1;iS(t)?(n=t.dimensions,this.xu=t.isDimensionOmitted(),this.gu=t):(i=!0,n=t),n=n||["x","y"];for(var r={},o=[],a={},s=!1,l={},c=0;c<n.length;c++){var h=n[c],u=vr(h)?new Qw({name:h}):h instanceof Qw?h:new Qw(h),d=u.name;u.type=u.type||"float",u.coordDim||(u.coordDim=d,u.coordDimIndex=0);var f=u.otherDims=u.otherDims||{};o.push(d),r[d]=u,null!=l[d]&&(s=!0),u.createInvertedIndices&&(a[d]=[]);var p=c;br(u.storeDimIndex)&&(p=u.storeDimIndex),0===f.itemName&&(this.Iu=p),0===f.itemId&&(this.zu=p),i&&(u.storeDimIndex=c)}if(this.dimensions=o,this.Du=r,this.Lu(s),this.hostModel=e,this.Ou=a,this.xu){var m=this.Pu=Or();sr(o,function(t){m.set(r[t].storeDimIndex,t)})}}return t.prototype.getDimension=function(t){var e=this.Vu(t);if(null==e)return t;if(e=t,!this.xu)return this.dimensions[e];var n=this.Pu.get(e);if(null!=n)return n;var i=this.gu.getSourceDimension(e);return i?i.name:void 0},t.prototype.getDimensionIndex=function(t){var e=this.Vu(t);if(null!=e)return e;if(null==t)return-1;var n=this.Bu(t);return n?n.storeDimIndex:this.xu?this.gu.getSourceDimensionIndex(t):-1},t.prototype.Vu=function(t){if(br(t)||null!=t&&!isNaN(t)&&!this.Bu(t)&&(!this.xu||this.gu.getSourceDimensionIndex(t)<0))return+t},t.prototype.Hu=function(t){return this.getDimensionIndex(t)},t.prototype.getDimensionInfo=function(t){return this.Bu(this.getDimension(t))},t.prototype.Lu=function(t){var e=this.Du;this.Bu=t?function(t){return e.hasOwnProperty(t)?e[t]:void 0}:function(t){return e[t]}},t.prototype.getDimensionsOnCoord=function(){return this.Uu.dataDimsOnCoord.slice()},t.prototype.mapDimension=function(t,e){var n=this.Uu;if(null==e)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return i?i[e]:null},t.prototype.mapDimensionsAll=function(t){return(this.Uu.encode[t]||[]).slice()},t.prototype.getStore=function(){return this.Ku},t.prototype.initData=function(t,e,n){var i,r=this;if(t instanceof Sy&&(i=t),!i){var o=this.dimensions,a=kv(t)||ar(t)?new Lv(t,o.length):t;i=new Sy;var s=mS(o,function(t){return{type:r.Du[t].type,property:t}});i.initData(a,s,n)}this.Ku=i,this.Su=(e||[]).slice(),this.Ru=[],this.Wu={},this.ju(0,i.count()),this.Uu=function(t,e){var n={},i=n.encode={},r=Or(),o=[],a=[],s={};sr(t.dimensions,function(e){var n,l=t.getDimensionInfo(e),c=l.coordDim;if(c){var h=l.coordDimIndex;Zw(i,c)[h]=e,l.isExtraCoord||(r.set(c,1),"ordinal"!==(n=l.type)&&"time"!==n&&(o[0]=e),Zw(s,c)[h]=t.getDimensionIndex(l.name)),l.defaultTooltip&&a.push(e)}Tg.each(function(t,e){var n=Zw(i,e),r=l.otherDims[e];null!=r&&!1!==r&&(n[r]=l.name)})});var l=[],c={};r.each(function(t,e){var n=i[e];c[e]=n[0],l=l.concat(n)}),n.dataDimsOnCoord=l,n.dataDimIndicesOnCoord=lr(l,function(e){return t.getDimensionInfo(e).storeDimIndex}),n.encodeFirstDimNotExtra=c;var h=i.label;h&&h.length&&(o=h.slice());var u=i.tooltip;return u&&u.length?a=u.slice():a.length||(a=o.slice()),i.defaultedLabel=o,i.defaultedTooltip=a,n.userOutput=new Yw(s,e),n}(this,this.gu),this.userOutput=this.Uu.userOutput},t.prototype.appendData=function(t){var e=this.Ku.appendData(t);this.ju(e[0],e[1])},t.prototype.appendValues=function(t,e){var n=this.Ku.appendValues(t,e&&e.length),i=n.start,r=n.end,o=this.qu();if(this.Gu(),e)for(var a=i;a<r;a++){var s=a-i;this.Su[a]=e[s],o&&fS(this,a)}},t.prototype.Gu=function(){for(var t=this.Ku,e=this.dimensions,n=0;n<e.length;n++){var i=this.Du[e[n]];i.ordinalMeta&&t.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},t.prototype.qu=function(){var t=this.Ku.getProvider();return null==this.zu&&t.getSource().sourceFormat!==kg&&!t.fillStorage},t.prototype.ju=function(t,e){if(!(t>=e)){var n=this.Ku.getProvider();this.Gu();var i=this.Su,r=this.Ru;if(n.getSource().sourceFormat===$g&&!n.pure)for(var o=[],a=t;a<e;a++){var s=n.getItem(a,o);if(!this.hasItemOption&&uc(s)&&(this.hasItemOption=!0),s){var l=s.name;null==i[a]&&null!=l&&(i[a]=pc(l,null));var c=s.id;null==r[a]&&null!=c&&(r[a]=pc(c,null))}}if(this.qu())for(a=t;a<e;a++)fS(this,a);sS(this)}},t.prototype.getApproximateExtent=function(t){return this._u[t]||this.Ku.getDataExtent(this.Hu(t))},t.prototype.setApproximateExtent=function(t,e){e=this.getDimension(e),this._u[e]=t.slice()},t.prototype.getCalculationInfo=function(t){return this.Eu[t]},t.prototype.setCalculationInfo=function(t,e){pS(t)?nr(this.Eu,t):this.Eu[t]=e},t.prototype.getName=function(t){var e=this.getRawIndex(t),n=this.Su[e];return null==n&&null!=this.Iu&&(n=cS(this,this.Iu,e)),null==n&&(n=""),n},t.prototype.Xu=function(t,e){var n=this.Ku.get(t,e),i=this.Ku.getOrdinalMeta(t);return i?i.categories[n]:n},t.prototype.getId=function(t){return lS(this,this.getRawIndex(t))},t.prototype.count=function(){return this.Ku.count()},t.prototype.get=function(t,e){var n=this.Ku,i=this.Du[t];if(i)return n.get(i.storeDimIndex,e)},t.prototype.getByRawIndex=function(t,e){var n=this.Ku,i=this.Du[t];if(i)return n.getByRawIndex(i.storeDimIndex,e)},t.prototype.getIndices=function(){return this.Ku.getIndices()},t.prototype.getDataExtent=function(t){return this.Ku.getDataExtent(this.Hu(t))},t.prototype.getSum=function(t){return this.Ku.getSum(this.Hu(t))},t.prototype.getMedian=function(t){return this.Ku.getMedian(this.Hu(t))},t.prototype.getValues=function(t,e){var n=this,i=this.Ku;return mr(t)?i.getValues(mS(t,function(t){return n.Hu(t)}),e):i.getValues(t)},t.prototype.hasValue=function(t){for(var e=this.Uu.dataDimIndicesOnCoord,n=0,i=e.length;n<i;n++)if(isNaN(this.Ku.get(e[n],t)))return!1;return!0},t.prototype.indexOfName=function(t){for(var e=0,n=this.Ku.count();e<n;e++)if(this.getName(e)===t)return e;return-1},t.prototype.getRawIndex=function(t){return this.Ku.getRawIndex(t)},t.prototype.indexOfRawIndex=function(t){return this.Ku.indexOfRawIndex(t)},t.prototype.rawIndexOf=function(t,e){var n=t&&this.Ou[t],i=n&&n[e];return null==i||isNaN(i)?-1:i},t.prototype.each=function(t,e,n){gr(t)&&(n=e,e=t,t=[]);var i=n||this,r=mS(hS(t),this.Hu,this);this.Ku.each(r,i?fr(e,i):e)},t.prototype.filterSelf=function(t,e,n){gr(t)&&(n=e,e=t,t=[]);var i=n||this,r=mS(hS(t),this.Hu,this);return this.Ku=this.Ku.filter(r,i?fr(e,i):e),this},t.prototype.selectRange=function(t){var e=this,n={};return sr(dr(t),function(i){var r=e.Hu(i);n[r]=t[i]}),this.Ku=this.Ku.selectRange(n),this},t.prototype.mapArray=function(t,e,n){gr(t)&&(n=e,e=t,t=[]),n=n||this;var i=[];return this.each(t,function(){i.push(e&&e.apply(this,arguments))},n),i},t.prototype.map=function(t,e,n,i){var r=n||i||this,o=mS(hS(t),this.Hu,this),a=dS(this);return a.Ku=this.Ku.map(o,r?fr(e,r):e),a},t.prototype.modify=function(t,e,n,i){var r=n||i||this,o=mS(hS(t),this.Hu,this);this.Ku.modify(o,r?fr(e,r):e)},t.prototype.downSample=function(t,e,n,i){var r=dS(this);return r.Ku=this.Ku.downSample(this.Hu(t),e,n,i),r},t.prototype.minmaxDownSample=function(t,e){var n=dS(this);return n.Ku=this.Ku.minmaxDownSample(this.Hu(t),e),n},t.prototype.lttbDownSample=function(t,e){var n=dS(this);return n.Ku=this.Ku.lttbDownSample(this.Hu(t),e),n},t.prototype.getRawDataItem=function(t){return this.Ku.getRawDataItem(t)},t.prototype.getItemModel=function(t){var e=this.hostModel,n=this.getRawDataItem(t);return new im(n,e,e&&e.ecModel)},t.prototype.diff=function(t){var e=this;return new Xw(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(e){return lS(t,e)},function(t){return lS(e,t)})},t.prototype.getVisual=function(t){var e=this.Au;return e&&e[t]},t.prototype.setVisual=function(t,e){this.Au=this.Au||{},pS(t)?nr(this.Au,t):this.Au[t]=e},t.prototype.getItemVisual=function(t,e){var n=this.Tu[t];return(n&&n[e])??this.getVisual(e)},t.prototype.hasItemVisual=function(){return this.Tu.length>0},t.prototype.ensureUniqueItemVisual=function(t,e){var n=this.Tu,i=n[t];i||(i=n[t]={});var r=i[e];return null==r&&(mr(r=this.getVisual(e))?r=r.slice():pS(r)&&(r=nr({},r)),i[e]=r),r},t.prototype.setItemVisual=function(t,e,n){var i=this.Tu[t]||{};this.Tu[t]=i,pS(e)?nr(i,e):i[e]=n},t.prototype.clearAllVisual=function(){this.Au={},this.Tu=[]},t.prototype.setLayout=function(t,e){pS(t)?nr(this.ku,t):this.ku[t]=e},t.prototype.getLayout=function(t){return this.ku[t]},t.prototype.getItemLayout=function(t){return this.Nu[t]},t.prototype.setItemLayout=function(t,e,n){this.Nu[t]=n?nr(this.Nu[t]||{},e):e},t.prototype.clearItemLayouts=function(){this.Nu.length=0},t.prototype.setItemGraphicEl=function(t,e){!function(t,e,n,i){if(i){var r=Bu(i);r.dataIndex=n,r.dataType=e,r.seriesIndex=t,r.ssrType="chart","group"===i.type&&i.traverse(function(i){var r=Bu(i);r.seriesIndex=t,r.dataIndex=n,r.dataType=e,r.ssrType="chart"})}}(this.hostModel&&this.hostModel.seriesIndex,this.dataType,t,e),this.Fu[t]=e},t.prototype.getItemGraphicEl=function(t){return this.Fu[t]},t.prototype.eachItemGraphicEl=function(t,e){sr(this.Fu,function(n,i){n&&t&&t.call(e,n,i)})},t.prototype.cloneShallow=function(e){return e||(e=new t(this.gu?this.gu:mS(this.dimensions,this.Bu,this),this.hostModel)),uS(e,this),e.Ku=this.Ku,e},t.prototype.wrapMethod=function(t,e){var n=this[t];gr(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=n.apply(this,arguments);return e.apply(this,[t].concat(kr(arguments)))})},t.internalField=(sS=function(t){var e=t.Ou;sr(e,function(n,i){var r=t.Du[i],o=r.ordinalMeta,a=t.Ku;if(o){n=e[i]=new gS(o.categories.length);for(var s=0;s<n.length;s++)n[s]=-1;for(s=0;s<a.count();s++)n[a.get(r.storeDimIndex,s)]=s}})},cS=function(t,e,n){return pc(t.Xu(e,n),null)},lS=function(t,e){var n=t.Ru[e];return null==n&&null!=t.zu&&(n=cS(t,t.zu,e)),null==n&&(n="e\0\0"+e),n},hS=function(t){return mr(t)||(t=null!=t?[t]:[]),t},dS=function(e){var n=new t(e.gu?e.gu:mS(e.dimensions,e.Bu,e),e.hostModel);return uS(n,e),n},uS=function(t,e){sr(vS.concat(e.__wrappedMethods||[]),function(n){e.hasOwnProperty(n)&&(t[n]=e[n])}),t.__wrappedMethods=e.__wrappedMethods,sr(yS,function(n){t[n]=tr(e[n])}),t.Eu=nr({},e.Eu)},void(fS=function(t,e){var n=t.Su,i=t.Ru,r=t.Iu,o=t.zu,a=n[e],s=i[e];if(null==a&&null!=r&&(n[e]=a=cS(t,r,e)),null==s&&null!=o&&(i[e]=s=cS(t,o,e)),null==s&&null!=a){var l=t.Wu,c=l[a]=(l[a]||0)+1;s=a,c>1&&(s+="__ec__"+c),i[e]=s}})),t}();function xS(t,e){kv(t)||(t=_v(t));var n=(e=e||{}).coordDimensions||[],i=e.dimensionsDefine||t.dimensionsDefine||[],r=Or(),o=[],a=function(t,e,n,i){var r=Math.max(t.dimensionsDetectedCount||1,e.length,n.length,i||0);return sr(e,function(t){var e;xr(t)&&(e=t.dimsDef)&&(r=Math.max(r,e.length))}),r}(t,n,i,e.dimensionsCount),s=e.canOmitUnusedDimensions&&aS(a),l=i===t.dimensionsDefine,c=l?oS(t):rS(i),h=e.encodeDefine;!h&&e.encodeDefaulter&&(h=e.encodeDefaulter(t,a));for(var u=Or(h),d=new my(a),f=0;f<d.length;f++)d[f]=-1;function p(t){var e=d[t];if(e<0){var n=i[t],r=xr(n)?n:{name:n},a=new Qw,s=r.name;null!=s&&null!=c.get(s)&&(a.name=a.displayName=s),null!=r.type&&(a.type=r.type),null!=r.displayName&&(a.displayName=r.displayName);var l=o.length;return d[t]=l,a.storeDimIndex=t,o.push(a),a}return o[e]}if(!s)for(f=0;f<a;f++)p(f);u.each(function(t,e){var n=sc(t).slice();if(1===n.length&&!vr(n[0])&&n[0]<0)u.set(e,!1);else{var i=u.set(e,[]);sr(n,function(t,n){var r=vr(t)?c.get(t):t;null!=r&&r<a&&(i[n]=r,g(p(r),e,n))})}});var m=0;function g(t,e,n){null!=Tg.get(e)?t.otherDims[e]=n:(t.coordDim=e,t.coordDimIndex=n,r.set(e,!0))}sr(n,function(t){var e,n,i,r;if(vr(t))e=t,r={};else{e=(r=t).name;var o=r.ordinalMeta;r.ordinalMeta=null,(r=nr({},r)).ordinalMeta=o,n=r.dimsDef,i=r.otherDims,r.name=r.coordDim=r.coordDimIndex=r.dimsDef=r.otherDims=null}var s=u.get(e);if(!1!==s){if(!(s=sc(s)).length)for(var c=0;c<(n&&n.length||1);c++){for(;m<a&&null!=p(m).coordDim;)m++;m<a&&s.push(m++)}sr(s,function(t,o){var a=p(t);if(l&&null!=r.type&&(a.type=r.type),g(ir(a,r),e,o),null==a.name&&n){var s=n[o];!xr(s)&&(s={name:s}),a.name=a.displayName=s.name,a.defaultTooltip=s.defaultTooltip}i&&ir(a.otherDims,i)})}});var v=e.generateCoord,y=e.generateCoordCount,b=null!=y;y=v?y||1:0;var x=v||"value";function w(t){null==t.name&&(t.name=t.coordDim)}if(s)sr(o,function(t){w(t)}),o.sort(function(t,e){return t.storeDimIndex-e.storeDimIndex});else for(var S=0;S<a;S++){var C=p(S);null==C.coordDim&&(C.coordDim=wS(x,r,b),C.coordDimIndex=0,(!v||y<=0)&&(C.isExtraCoord=!0),y--),w(C),null!=C.type||1!==Pg(t,S)&&(!C.isExtraCoord||null==C.otherDims.itemName&&null==C.otherDims.seriesName)||(C.type="ordinal")}return function(t){for(var e=Or(),n=0;n<t.length;n++){var i=t[n],r=i.name,o=e.get(r)||0;o>0&&(i.name=r+(o-1)),o++,e.set(r,o)}}(o),new nS({source:t,dimensions:o,fullDimensionCount:a,dimensionOmitted:s})}function wS(t,e,n){if(n||e.hasKey(t)){for(var i=0;e.hasKey(t+i);)i++;t+=i}return e.set(t,!0),t}var SS=function(t){this.coordSysDims=[],this.axisMap=Or(),this.categoryAxisMap=Or(),this.coordSysName=t},CS={cartesian2d:function(t,e,n,i){var r=t.getReferringComponents("xAxis",Sc).models[0],o=t.getReferringComponents("yAxis",Sc).models[0];e.coordSysDims=["x","y"],n.set("x",r),n.set("y",o),TS(r)&&(i.set("x",r),e.firstCategoryDimIndex=0),TS(o)&&(i.set("y",o),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=1))},singleAxis:function(t,e,n,i){var r=t.getReferringComponents("singleAxis",Sc).models[0];e.coordSysDims=["single"],n.set("single",r),TS(r)&&(i.set("single",r),e.firstCategoryDimIndex=0)},polar:function(t,e,n,i){var r=t.getReferringComponents("polar",Sc).models[0],o=r.findAxisModel("radiusAxis"),a=r.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],n.set("radius",o),n.set("angle",a),TS(o)&&(i.set("radius",o),e.firstCategoryDimIndex=0),TS(a)&&(i.set("angle",a),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=1))},geo:function(t,e,n,i){e.coordSysDims=["lng","lat"]},parallel:function(t,e,n,i){var r=t.ecModel,o=r.getComponent("parallel",t.get("parallelIndex")),a=e.coordSysDims=o.dimensions.slice();sr(o.parallelAxisIndex,function(t,o){var s=r.getComponent("parallelAxis",t),l=a[o];n.set(l,s),TS(s)&&(i.set(l,s),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=o))})},matrix:function(t,e,n,i){var r=t.getReferringComponents("matrix",Sc).models[0];e.coordSysDims=["x","y"];var o=r.getDimensionModel("x"),a=r.getDimensionModel("y");n.set("x",o),n.set("y",a),i.set("x",o),i.set("y",a)}};function TS(t){return"category"===t.get("type")}function $S(t,e){return!!e&&e===t.getCalculationInfo("stackedDimension")}function MS(t,e,n){n=n||{};var i,r,o=e.getSourceManager();r=(i=o.getSource()).sourceFormat===$g;var a=function(t){var e=t.get("coordinateSystem"),n=new SS(e),i=CS[e];if(i)return i(t,n,n.axisMap,n.categoryAxisMap),n}(e),s=function(t,e){var n,i=t.get("coordinateSystem"),r=eg.get(i);return e&&e.coordSysDims&&(n=lr(e.coordSysDims,function(t){var n={name:t},i=e.axisMap.get(t);if(i){var r=i.get("type");n.type=Jw(r)}return n})),n||(n=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),n}(e,a),l=n.useEncodeDefaulter,c=gr(l)?l:l?pr(Eg,s,e):null,h=xS(i,{coordDimensions:s,generateCoord:n.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:c,canOmitUnusedDimensions:!r}),u=function(t,e,n){var i,r;return n&&sr(t,function(t,o){var a=t.coordDim,s=n.categoryAxisMap.get(a);s&&(null==i&&(i=o),t.ordinalMeta=s.getOrdinalMeta(),e&&(t.createInvertedIndices=!0)),null!=t.otherDims.itemName&&(r=!0)}),r||null==i||(t[i].otherDims.itemName=0),i}(h.dimensions,n.createInvertedIndices,a),d=r?null:o.getSharedDataStore(h),f=function(t,e,n){var i,r,o,a=(n=n||{}).byIndex,s=n.stackedCoordDimension;!function(t){return!iS(t.schema)}(e)?(i=(r=e.schema).dimensions,o=e.store):i=e;var l,c,h,u,d=!(!t||!t.get("stack"));if(sr(i,function(t,e){vr(t)&&(i[e]=t={name:t}),d&&!t.isExtraCoord&&(a||l||!t.ordinalMeta||(l=t),c||"ordinal"===t.type||"time"===t.type||s&&s!==t.coordDim||(c=t))}),!c||a||l||(a=!0),c){h="__\0ecstackresult_"+t.id,u="__\0ecstackedover_"+t.id,l&&(l.createInvertedIndices=!0);var f=c.coordDim,p=c.type,m=0;sr(i,function(t){t.coordDim===f&&m++});var g={name:h,coordDim:f,coordDimIndex:m,type:p,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:i.length},v={name:u,coordDim:u,coordDimIndex:m+1,type:p,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:i.length+1};r?(o&&(g.storeDimIndex=o.ensureCalculationDimension(u,p),v.storeDimIndex=o.ensureCalculationDimension(h,p)),r.appendCalculationDimension(g),r.appendCalculationDimension(v)):(i.push(g),i.push(v))}return{stackedDimension:c&&c.name,stackedByDimension:l&&l.name,isStackedByIndex:a,stackedOverDimension:u,stackResultDimension:h}}(e,{schema:h,store:d}),p=new bS(h,e);p.setCalculationInfo(f);var m=null!=u&&function(t){if(t.sourceFormat===$g)return!mr(hc(function(t){for(var e=0;e<t.length&&null==t[e];)e++;return t[e]}(t.data||[])))}(i)?function(t,e,n,i){return i===u?n:this.defaultDimValueGetter(t,e,n,i)}:null;return p.hasItemOption=!1,p.initData(r?i:d,null,m),p}function AS(t){return"interval"===t.type||"log"===t.type}function NS(t){var e=Math.pow(10,Zl(t)),n=t/e;return n?2===n?n=3:3===n?n=5:n*=2:n=1,Ul(n*e)}function kS(t){return ql(t)+2}function RS(t,e,n){t[e]=Math.max(Math.min(t[e],n[1]),n[0])}function _S(t,e){return t>=e[0]&&t<=e[1]}var IS=function(){function t(){this.normalize=FS,this.scale=ES}return t.prototype.updateMethods=function(t){t.hasBreaks()?(this.normalize=fr(t.normalize,t),this.scale=fr(t.scale,t)):(this.normalize=FS,this.scale=ES)},t}();function FS(t,e){return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0])}function ES(t,e){return t*(e[1]-e[0])+e[0]}function DS(t,e,n){var i=Math.log(t);return[Math.log(n?e[0]:Math.max(0,e[0]))/i,Math.log(n?e[1]:Math.max(0,e[1]))/i]}var LS=function(){function t(t){this.Yu=new IS,this.Ju=t||{},this.Yc=[1/0,-1/0]}return t.prototype.getSetting=function(t){return this.Ju[t]},t.prototype.Zu=function(t){var e=this.Yc;this.Qu(t[0]<e[0]?t[0]:e[0],t[1]>e[1]?t[1]:e[1])},t.prototype.unionExtentFromData=function(t,e){this.Zu(t.getApproximateExtent(e))},t.prototype.getExtent=function(){return this.Yc.slice()},t.prototype.setExtent=function(t,e){this.Qu(t,e)},t.prototype.Qu=function(t,e){var n=this.Yc;isNaN(t)||(n[0]=t),isNaN(e)||(n[1]=e),this.tf&&this.tf.update(n)},t.prototype.setBreaksFromOption=function(t){},t.prototype.ef=function(t){this.tf&&(this.tf.setBreaks(t),this.Yu.updateMethods(this.tf),this.tf.update(this.Yc))},t.prototype.nf=function(){return this.tf?this.tf.breaks:[]},t.prototype.hasBreaks=function(){return!!this.tf&&this.tf.hasBreaks()},t.prototype.if=function(){return this.tf&&this.tf.hasBreaks()?this.tf.getExtentSpan():this.Yc[1]-this.Yc[0]},t.prototype.isInExtentRange=function(t){return this.Yc[0]<=t&&this.Yc[1]>=t},t.prototype.isBlank=function(){return this.rf},t.prototype.setBlank=function(t){this.rf=t},t}();Fc(LS);var PS=0,zS=function(){function t(t){this.categories=t.categories||[],this.sf=t.needCollect,this.af=t.deduplication,this.uid=++PS,this.lf=t.onCollect}return t.createByAxisModel=function(e){var n=e.option,i=n.data,r=i&&lr(i,OS);return new t({categories:r,needCollect:!r,deduplication:!1!==n.dedplication})},t.prototype.getOrdinal=function(t){return this.cf().get(t)},t.prototype.parseAndCollect=function(t){var e,n=this.sf;if(!vr(t)&&!n)return t;if(n&&!this.af)return e=this.categories.length,this.categories[e]=t,this.lf&&this.lf(t,e),e;var i=this.cf();return null==(e=i.get(t))&&(n?(e=this.categories.length,this.categories[e]=t,i.set(t,e),this.lf&&this.lf(t,e)):e=NaN),e},t.prototype.cf=function(){return this.aa||(this.aa=Or(this.categories))},t}();function OS(t){return xr(t)&&null!=t.value?t.value:t+""}var BS=function(t){function e(e){var n=t.call(this,e)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new zS({})),mr(i)&&(i=new zS({categories:lr(i,function(t){return xr(t)?t.value:t})})),n.hf=i,n.Yc=n.getSetting("extent")||[0,i.categories.length-1],n}return Ei(e,t),e.prototype.parse=function(t){return null==t?NaN:vr(t)?this.hf.getOrdinal(t):Math.round(t)},e.prototype.contain=function(t){return _S(t,this.Yc)&&t>=0&&t<this.hf.categories.length},e.prototype.normalize=function(t){return t=this.uf(t),this.Yu.normalize(t,this.Yc)},e.prototype.scale=function(t){return t=Math.round(this.Yu.scale(t,this.Yc)),this.getRawOrdinalNumber(t)},e.prototype.getTicks=function(){for(var t=[],e=this.Yc,n=e[0];n<=e[1];)t.push({value:n}),n++;return t},e.prototype.getMinorTicks=function(t){},e.prototype.setSortInfo=function(t){if(null!=t){for(var e=t.ordinalNumbers,n=this.df=[],i=this.mf=[],r=0,o=this.hf.categories.length,a=Math.min(o,e.length);r<a;++r){var s=e[r];n[r]=s,i[s]=r}for(var l=0;r<o;++r){for(;null!=i[l];)l++;n.push(l),i[l]=r}}else this.df=this.mf=null},e.prototype.uf=function(t){var e=this.mf;return e&&t>=0&&t<e.length?e[t]:t},e.prototype.getRawOrdinalNumber=function(t){var e=this.df;return e&&t>=0&&t<e.length?e[t]:t},e.prototype.getLabel=function(t){if(!this.isBlank()){var e=this.getRawOrdinalNumber(t.value),n=this.hf.categories[e];return null==n?"":n+""}},e.prototype.count=function(){return this.Yc[1]-this.Yc[0]+1},e.prototype.isInExtentRange=function(t){return t=this.uf(t),this.Yc[0]<=t&&this.Yc[1]>=t},e.prototype.getOrdinalMeta=function(){return this.hf},e.prototype.calcNiceTicks=function(){},e.prototype.calcNiceExtent=function(){},e.type="ordinal",e}(LS);LS.registerClass(BS);var VS=Ul,HS=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="interval",e.pf=0,e.vf=2,e}return Ei(e,t),e.prototype.parse=function(t){return null==t||""===t?NaN:Number(t)},e.prototype.contain=function(t){return _S(t,this.Yc)},e.prototype.normalize=function(t){return this.Yu.normalize(t,this.Yc)},e.prototype.scale=function(t){return this.Yu.scale(t,this.Yc)},e.prototype.getInterval=function(){return this.pf},e.prototype.setInterval=function(t){this.pf=t,this.bf=this.Yc.slice(),this.vf=kS(t)},e.prototype.getTicks=function(t){t=t||{};var e=this.pf,n=this.Yc,i=this.bf,r=this.vf,o=[];if(!e)return o;t.breakTicks,n[0]<i[0]&&(t.expandToNicedExtent?o.push({value:VS(i[0]-e,r)}):o.push({value:n[0]}));for(var a=function(t,n){return Math.round((n-t)/e)},s=i[0];s<=i[1];){if(o.push({value:s}),s=VS(s+e,r),this.tf){var l=this.tf.calcNiceTickMultiple(s,a);l>=0&&(s=VS(s+l*e,r))}if(o.length>0&&s===o[o.length-1].value)break;if(o.length>1e4)return[]}var c=o.length?o[o.length-1].value:i[1];return n[1]>c&&(t.expandToNicedExtent?o.push({value:VS(c+e,r)}):o.push({value:n[1]})),t.breakTicks,o},e.prototype.getMinorTicks=function(t){for(var e=this.getTicks({expandToNicedExtent:!0}),n=[],i=this.getExtent(),r=1;r<e.length;r++){var o=e[r],a=e[r-1];if(!a.break&&!o.break){for(var s=0,l=[],c=(o.value-a.value)/t,h=kS(c);s<t-1;){var u=VS(a.value+(s+1)*c,h);u>i[0]&&u<i[1]&&l.push(u),s++}var d=pm();d&&d.pruneTicksByBreak("auto",l,this.gf(),function(t){return t},this.pf,i),n.push(l)}}return n},e.prototype.gf=function(){return this.tf?this.tf.breaks:[]},e.prototype.getLabel=function(t,e){if(null==t)return"";var n=e&&e.precision;return null==n?n=ql(t.value)||0:"auto"===n&&(n=this.vf),qm(VS(t.value,n,!0))},e.prototype.calcNiceTicks=function(t,e,n){t=t||5;var i=this.Yc.slice(),r=this.if();if(isFinite(r)){r<0&&(r=-r,i.reverse(),this.Qu(i[0],i[1]),i=this.Yc.slice());var o=function(t,e,n,i,r){var o={},a=o.interval=Jl(e/n);null!=i&&a<i&&(a=o.interval=i),null!=r&&a>r&&(a=o.interval=r);var s=o.intervalPrecision=kS(a);return function(t,e){!isFinite(t[0])&&(t[0]=e[0]),!isFinite(t[1])&&(t[1]=e[1]),RS(t,0,e),RS(t,1,e),t[0]>t[1]&&(t[0]=t[1])}(o.niceTickExtent=[Ul(Math.ceil(t[0]/a)*a,s),Ul(Math.floor(t[1]/a)*a,s)],t),o}(i,r,t,e,n);this.vf=o.intervalPrecision,this.pf=o.interval,this.bf=o.niceTickExtent}},e.prototype.calcNiceExtent=function(t){var e=this.Yc.slice();if(e[0]===e[1])if(0!==e[0]){var n=Math.abs(e[0]);t.fixMax||(e[1]+=n/2),e[0]-=n/2}else e[1]=1;var i=e[1]-e[0];isFinite(i)||(e[0]=0,e[1]=1),this.Qu(e[0],e[1]),e=this.Yc.slice(),this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval);var r=this.pf,o=this.vf;t.fixMin||(e[0]=VS(Math.floor(e[0]/r)*r,o)),t.fixMax||(e[1]=VS(Math.ceil(e[1]/r)*r,o)),this.Qu(e[0],e[1])},e.prototype.setNiceExtent=function(t,e){this.bf=[t,e]},e.type="interval",e}(LS);LS.registerClass(HS);var US="undefined"!=typeof Float32Array,qS=US?Float32Array:Array;function KS(t){return mr(t)?US?new Float32Array(t):t:new qS(t)}function WS(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex}function jS(t){return t.dim+t.index}function GS(t,e){var n=[];return e.eachSeriesByType(t,function(t){ZS(t)&&n.push(t)}),n}function XS(t){var e=function(t){var e={};sr(t,function(t){var n=t.coordinateSystem.getBaseAxis();if("time"===n.type||"value"===n.type)for(var i=t.getData(),r=n.dim+"_"+n.index,o=i.getDimensionIndex(i.mapDimension(n.dim)),a=i.getStore(),s=0,l=a.count();s<l;++s){var c=a.get(o,s);e[r]?e[r].push(c):e[r]=[c]}});var n={};for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];if(r){r.sort(function(t,e){return t-e});for(var o=null,a=1;a<r.length;++a){var s=r[a]-r[a-1];s>0&&(o=null===o?s:Math.min(o,s))}n[i]=o}}return n}(t),n=[];return sr(t,function(t){var i,r=t.coordinateSystem.getBaseAxis(),o=r.getExtent();if("category"===r.type)i=r.getBandWidth();else if("value"===r.type||"time"===r.type){var a=r.dim+"_"+r.index,s=e[a],l=Math.abs(o[1]-o[0]),c=r.scale.getExtent(),h=Math.abs(c[1]-c[0]);i=s?l/h*s:l}else{var u=t.getData();i=Math.abs(o[1]-o[0])/u.count()}var d=Vl(t.get("barWidth"),i),f=Vl(t.get("barMaxWidth"),i),p=Vl(t.get("barMinWidth")||(JS(t)?.5:1),i),m=t.get("barGap"),g=t.get("barCategoryGap"),v=t.get("defaultBarGap");n.push({bandWidth:i,barWidth:d,barMaxWidth:f,barMinWidth:p,barGap:m,barCategoryGap:g,defaultBarGap:v,axisKey:jS(r),stackId:WS(t)})}),function(t){var e={};sr(t,function(t,n){var i=t.axisKey,r=t.bandWidth,o=e[i]||{bandWidth:r,remainedWidth:r,autoWidthCount:0,categoryGap:null,gap:t.defaultBarGap||0,stacks:{}},a=o.stacks;e[i]=o;var s=t.stackId;a[s]||o.autoWidthCount++,a[s]=a[s]||{width:0,maxWidth:0};var l=t.barWidth;l&&!a[s].width&&(a[s].width=l,l=Math.min(o.remainedWidth,l),o.remainedWidth-=l);var c=t.barMaxWidth;c&&(a[s].maxWidth=c);var h=t.barMinWidth;h&&(a[s].minWidth=h);var u=t.barGap;null!=u&&(o.gap=u);var d=t.barCategoryGap;null!=d&&(o.categoryGap=d)});var n={};return sr(e,function(t,e){n[e]={};var i=t.stacks,r=t.bandWidth,o=t.categoryGap;if(null==o){var a=dr(i).length;o=Math.max(35-4*a,15)+"%"}var s=Vl(o,r),l=Vl(t.gap,1),c=t.remainedWidth,h=t.autoWidthCount,u=(c-s)/(h+(h-1)*l);u=Math.max(u,0),sr(i,function(t){var e=t.maxWidth,n=t.minWidth;if(t.width)i=t.width,e&&(i=Math.min(i,e)),n&&(i=Math.max(i,n)),t.width=i,c-=i+l*i,h--;else{var i=u;e&&e<i&&(i=Math.min(e,c)),n&&n>i&&(i=n),i!==u&&(t.width=i,c-=i+l*i,h--)}}),u=(c-s)/(h+(h-1)*l),u=Math.max(u,0);var d,f=0;sr(i,function(t,e){t.width||(t.width=u),d=t,f+=t.width*(1+l)}),d&&(f-=d.width*l);var p=-f/2;sr(i,function(t,i){n[e][i]=n[e][i]||{bandWidth:r,offset:p,width:t.width},p+=t.width*(1+l)})}),n}(n)}function YS(t,e){var n=GS(t,e),i=XS(n);sr(n,function(t){var e=t.getData(),n=t.coordinateSystem.getBaseAxis(),r=WS(t),o=i[jS(n)][r],a=o.offset,s=o.width;e.setLayout({bandWidth:o.bandWidth,offset:a,size:s})})}function ZS(t){return t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type}function JS(t){return t.pipelineContext&&t.pipelineContext.large}var QS=function(t){function e(e){var n=t.call(this,e)||this;return n.type="time",n}return Ei(e,t),e.prototype.getLabel=function(t){var e=this.getSetting("useUTC");return Am(t.value,wm[function(t){switch(t){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}($m(this.yf))]||wm.second,e,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(t,e,n){var i=this.getSetting("useUTC");return function(t,e,n,i,r){var o=null;if(vr(n))o=n;else if(gr(n)){var a={time:t.time,level:t.time.level};o=n(t.value,e,a)}else{var s=t.time;if(s){var l=n[s.lowerTimeUnit][s.upperTimeUnit];o=l[Math.min(s.level,l.length-1)]||""}else{var c=Nm(t.value,r);o=n[c][c][0]}}return Am(new Date(t.value),o,r,i)}(t,e,n,this.getSetting("locale"),i)},e.prototype.getTicks=function(t){var e=this.pf,n=this.Yc,i=[];if(!e)return i;var r=this.getSetting("useUTC"),o=Nm(n[1],r);i.push({value:n[0],time:{level:0,upperTimeUnit:o,lowerTimeUnit:o}});var a=function(t,e,n,i,r,o){var a=Cm,s=0;function l(t,e,n,r,a,l,c){for(var h=function(t,e){var n=new Date(0);n[t](1);var i=n.getTime();n[t](1+e);var r=n.getTime()-i;return function(t,e){return Math.max(0,Math.round((e-t)/r))}}(a,t),u=e,d=new Date(u);u<n&&u<=i[1]&&(c.push({value:u}),!(s++>1e4));)if(d[a](d[r]()+t),u=d.getTime(),o){var f=o.calcNiceTickMultiple(u,h);f>0&&(d[a](d[r]()+f*t),u=d.getTime())}c.push({value:u,notAdd:!0})}function c(t,r,o){var a=[],s=!r.length;if(!function(t,e,n,i){return km(new Date(e),t,i).getTime()===km(new Date(n),t,i).getTime()}($m(t),i[0],i[1],n)){s&&(r=[{value:aC(i[0],t,n)},{value:i[1]}]);for(var c=0;c<r.length-1;c++){var h=r[c].value,u=r[c+1].value;if(h!==u){var d=void 0,f=void 0,p=void 0;switch(t){case"year":d=Math.max(1,Math.round(e/gm/365)),f=Rm(n),p=Pm(n);break;case"half-year":case"quarter":case"month":d=nC(e),f=_m(n),p=zm(n);break;case"week":case"half-week":case"day":d=eC(e),f=Im(n),p=Om(n);break;case"half-day":case"quarter-day":case"hour":d=iC(e),f=Fm(n),p=Bm(n);break;case"minute":d=rC(e,!0),f=Em(n),p=Vm(n);break;case"second":d=rC(e,!1),f=Dm(n),p=Hm(n);break;case"millisecond":d=oC(e),f=Lm(n),p=Um(n)}u>=i[0]&&h<=i[1]&&l(d,h,u,f,p,0,a),"year"===t&&o.length>1&&0===c&&o.unshift({value:o[0].value-d})}}for(c=0;c<a.length;c++)o.push(a[c])}}for(var h=[],u=[],d=0,f=0,p=0;p<a.length;++p){var m=$m(a[p]);if(Mm(a[p])&&(c(a[p],h[h.length-1]||[],u),m!==(a[p+1]?$m(a[p+1]):null))){if(u.length){f=d,u.sort(function(t,e){return t.value-e.value});for(var g=[],v=0;v<u.length;++v){var y=u[v].value;0!==v&&u[v-1].value===y||(g.push(u[v]),y>=i[0]&&y<=i[1]&&d++)}var b=r/e;if(d>1.5*b&&f>b/1.5)break;if(h.push(g),d>b||t===a[p])break}u=[]}}var x=hr(lr(h,function(t){return hr(t,function(t){return t.value>=i[0]&&t.value<=i[1]&&!t.notAdd})}),function(t){return t.length>0}),w=[],S=x.length-1;for(p=0;p<x.length;++p)for(var C=x[p],T=0;T<C.length;++T){var $=Nm(C[T].value,n);w.push({value:C[T].value,time:{level:S-p,upperTimeUnit:$,lowerTimeUnit:$}})}w.sort(function(t,e){return t.value-e.value});var M=[];for(p=0;p<w.length;++p)0!==p&&w[p].value===w[p-1].value||M.push(w[p]);return M}(this.yf,this.wf,r,n,this.if(),this.tf);i=i.concat(a);var s=Nm(n[1],r);i.push({value:n[1],time:{level:0,upperTimeUnit:s,lowerTimeUnit:s}}),this.getSetting("useUTC");var l=Sm.length-1,c=0;return sr(i,function(t){l=Math.min(l,rr(Sm,t.time.upperTimeUnit)),c=Math.max(c,t.time.level)}),i},e.prototype.calcNiceExtent=function(t){var e=this.getExtent();if(e[0]===e[1]&&(e[0]-=gm,e[1]+=gm),e[1]===-1/0&&e[0]===1/0){var n=new Date;e[1]=+new Date(n.getFullYear(),n.getMonth(),n.getDate()),e[0]=e[1]-gm}this.Qu(e[0],e[1]),this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval)},e.prototype.calcNiceTicks=function(t,e,n){t=t||10;var i=this.if();this.wf=i/t,null!=e&&this.wf<e&&(this.wf=e),null!=n&&this.wf>n&&(this.wf=n);var r=tC.length,o=Math.min(function(t,e,n,i){for(;n<i;){var r=n+i>>>1;t[r][1]<e?n=r+1:i=r}return n}(tC,this.wf,0,r),r-1);this.pf=tC[o][1],this.vf=kS(this.pf),this.yf=tC[Math.max(o-1,0)][0]},e.prototype.parse=function(t){return br(t)?t:+Yl(t)},e.prototype.contain=function(t){return _S(t,this.Yc)},e.prototype.normalize=function(t){return this.Yu.normalize(t,this.Yc)},e.prototype.scale=function(t){return this.Yu.scale(t,this.Yc)},e.type="time",e}(HS),tC=[["second",1e3],["minute",6e4],["hour",mm],["quarter-day",216e5],["half-day",432e5],["day",10368e4],["half-week",3024e5],["week",6048e5],["month",26784e5],["quarter",8208e6],["half-year",vm/2],["year",vm]];function eC(t,e){return(t/=gm)>16?16:t>7.5?7:t>3.5?4:t>1.5?2:1}function nC(t){return(t/=2592e6)>6?6:t>3?3:t>2?2:1}function iC(t){return(t/=mm)>12?12:t>6?6:t>3.5?4:t>2?2:1}function rC(t,e){return(t/=e?6e4:1e3)>30?30:t>20?20:t>15?15:t>10?10:t>5?5:t>2?2:1}function oC(t){return Jl(t)}function aC(t,e,n){var i=Math.max(0,rr(Sm,e)-1);return km(new Date(t),Sm[i],n).getTime()}LS.registerClass(QS);var sC=Ul,lC=Math.floor,cC=Math.ceil,hC=Math.pow,uC=Math.log,dC=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="log",e.base=10,e.$f=new HS,e}return Ei(e,t),e.prototype.getTicks=function(e){e=e||{};var n=this.Yc.slice(),i=this.$f.getExtent(),r=t.prototype.getTicks.call(this,e),o=this.base;return this.$f.nf(),lr(r,function(t){var e=t.value,r=null,a=hC(o,e);return e===n[0]&&this.Mf?r=i[0]:e===n[1]&&this.Cf&&(r=i[1]),null!=r&&(a=fC(a,r)),{value:a,"break":void 0}},this)},e.prototype.gf=function(){return this.$f.nf()},e.prototype.setExtent=function(e,n){this.$f.setExtent(e,n);var i=DS(this.base,[e,n]);t.prototype.setExtent.call(this,i[0],i[1])},e.prototype.getExtent=function(){var e=this.base,n=t.prototype.getExtent.call(this);n[0]=hC(e,n[0]),n[1]=hC(e,n[1]);var i=this.$f.getExtent();return this.Mf&&(n[0]=fC(n[0],i[0])),this.Cf&&(n[1]=fC(n[1],i[1])),n},e.prototype.unionExtentFromData=function(t,e){this.$f.unionExtentFromData(t,e);var n=DS(this.base,t.getApproximateExtent(e),!0);this.Zu(n)},e.prototype.calcNiceTicks=function(t){t=t||10;var e=this.Yc.slice(),n=this.if();if(isFinite(n)&&!(n<=0)){var i,r=(i=n,Math.pow(10,Zl(i)));for(t/n*r<=.5&&(r*=10);!isNaN(r)&&Math.abs(r)<1&&Math.abs(r)>0;)r*=10;var o=[sC(cC(e[0]/r)*r),sC(lC(e[1]/r)*r)];this.pf=r,this.vf=kS(r),this.bf=o}},e.prototype.calcNiceExtent=function(e){t.prototype.calcNiceExtent.call(this,e),this.Mf=e.fixMin,this.Cf=e.fixMax},e.prototype.contain=function(e){return e=uC(e)/uC(this.base),t.prototype.contain.call(this,e)},e.prototype.normalize=function(e){return e=uC(e)/uC(this.base),t.prototype.normalize.call(this,e)},e.prototype.scale=function(e){return e=t.prototype.scale.call(this,e),hC(this.base,e)},e.prototype.setBreaksFromOption=function(t){},e.type="log",e}(HS);function fC(t,e){return sC(t,ql(e))}LS.registerClass(dC);var pC=function(){function t(t,e,n){this.Sf(t,e,n)}return t.prototype.Sf=function(t,e,n){n[1]<n[0]&&(n=[NaN,NaN]),this.Rf=n[0],this.Af=n[1];var i=this.kf="ordinal"===t.type;this.Tf="interval"===t.type&&e.getNeedCrossZero&&e.getNeedCrossZero();var r=e.get("min",!0);null==r&&(r=e.get("startValue",!0));var o=this.Nf=r;gr(o)?this.Ff=vC(t,o({min:n[0],max:n[1]})):"dataMin"!==o&&(this.Ff=vC(t,o));var a=this._f=e.get("max",!0);if(gr(a)?this.Ef=vC(t,a({min:n[0],max:n[1]})):"dataMax"!==a&&(this.Ef=vC(t,a)),i)this.If=e.getCategories().length;else{var s=e.get("boundaryGap"),l=mr(s)?s:[s||0,s||0];"boolean"==typeof l[0]||"boolean"==typeof l[1]?this.zf=[0,0]:this.zf=[bl(l[0],1),bl(l[1],1)]}},t.prototype.calculate=function(){var t=this.kf,e=this.Rf,n=this.Af,i=this.If,r=this.zf,o=t?null:n-e||Math.abs(e),a="dataMin"===this.Nf?e:this.Ff,s="dataMax"===this._f?n:this.Ef,l=null!=a,c=null!=s;null==a&&(a=t?i?0:NaN:e-r[0]*o),null==s&&(s=t?i?i-1:NaN:n+r[1]*o),(null==a||!isFinite(a))&&(a=NaN),(null==s||!isFinite(s))&&(s=NaN);var h=$r(a)||$r(s)||t&&!i;this.Tf&&(a>0&&s>0&&!l&&(a=0),a<0&&s<0&&!c&&(s=0));var u=this.Df,d=this.Lf;return null!=u&&(a=u,l=!0),null!=d&&(s=d,c=!0),{min:a,max:s,minFixed:l,maxFixed:c,isBlank:h}},t.prototype.modifyDataMinMax=function(t,e){this[gC[t]]=e},t.prototype.setDeterminedMinMax=function(t,e){this[mC[t]]=e},t.prototype.freeze=function(){this.frozen=!0},t}(),mC={min:"_determinedMin",max:"_determinedMax"},gC={min:"_dataMin",max:"_dataMax"};function vC(t,e){return null==e?null:$r(e)?NaN:t.parse(e)}function yC(t,e){var n=t.type,i=function(t,e,n){var i=t.rawExtentInfo;return i||(i=new pC(t,e,n),t.rawExtentInfo=i,i)}(t,e,t.getExtent()).calculate();t.setBlank(i.isBlank);var r=i.min,o=i.max,a=e.ecModel;if(a&&"time"===n){var s=GS("bar",a),l=!1;if(sr(s,function(t){l=l||t.getBaseAxis()===e.axis}),l){var c=XS(s),h=function(t,e,n,i){var r=n.axis.getExtent(),o=Math.abs(r[1]-r[0]),a=function(t,e){if(t&&e)return t[jS(e)]}(i,n.axis);if(void 0===a)return{min:t,max:e};var s=1/0;sr(a,function(t){s=Math.min(t.offset,s)});var l=-1/0;sr(a,function(t){l=Math.max(t.offset+t.width,l)}),s=Math.abs(s),l=Math.abs(l);var c=s+l,h=e-t,u=h/(1-(s+l)/o)-h;return{min:t-=u*(s/c),max:e+=u*(l/c)}}(r,o,e,c);r=h.min,o=h.max}}return{extent:[r,o],fixMin:i.minFixed,fixMax:i.maxFixed}}function bC(t,e){var n=e,i=yC(t,n),r=i.extent,o=n.get("splitNumber");t instanceof dC&&(t.base=n.get("logBase"));var a=t.type,s=n.get("interval"),l="interval"===a||"time"===a;t.setBreaksFromOption(MC(n)),t.setExtent(r[0],r[1]),t.calcNiceExtent({splitNumber:o,fixMin:i.fixMin,fixMax:i.fixMax,minInterval:l?n.get("minInterval"):null,maxInterval:l?n.get("maxInterval"):null}),null!=s&&t.setInterval&&t.setInterval(s)}function xC(t){var e,n=t.getLabelModel().get("formatter");if("time"===t.type){var i=vr(e=n)||gr(e)?e:function(t){t=t||{};var e={},n=!0;return sr(Sm,function(e){n&&(n=null==t[e])}),sr(Sm,function(i,r){var o=t[i];e[i]={};for(var a=null,s=r;s>=0;s--){var l=Sm[s],c=xr(o)&&!mr(o)?o[l]:o,h=void 0;mr(c)?a=(h=c.slice())[0]||"":vr(c)?h=[a=c]:(null==a?a=bm[i]:ym[l].test(a)||(a=e[l][l][0]+" "+a),h=[a],n&&(h[1]="{primary|"+a+"}")),e[i][l]=h}}),e}(e);return function(e,n){return t.scale.getFormattedLabel(e,n,i)}}return vr(n)?function(e){var i=t.scale.getLabel(e);return n.replace("{value}",null!=i?i:"")}:gr(n)?"category"===t.type?function(e,i){return n(wC(t,e),e.value-t.scale.getExtent()[0],null)}:function(e,i){return n(wC(t,e),i,null)}:function(e){return t.scale.getLabel(e)}}function wC(t,e){return"category"===t.type?t.scale.getLabel(e):e.value}function SC(t){return t.get("interval")??"auto"}function CC(t){return"category"===t.type&&0===SC(t.getLabelModel())}function TC(t){return"middle"===t||"center"===t}function $C(t){return t.getShallow("show")}function MC(t){t.get("breaks",!0)}var AC=function(){function t(){}return t.prototype.getNeedCrossZero=function(){return!this.option.scale},t.prototype.getCoordSysModel=function(){},t}(),NC=[],kC={registerPreprocessor:zw,registerProcessor:Ow,registerPostInit:function(t){Bw("afterinit",t)},registerPostUpdate:function(t){Bw("afterupdate",t)},registerUpdateLifecycle:Bw,registerAction:Vw,registerCoordinateSystem:function(t,e){eg.register(t,e)},registerLayout:function(t,e){qw(kw,t,e,1e3,"layout")},registerVisual:Hw,registerTransform:function(t){var e=(t=tr(t)).type;e||rc("");var n=e.split(":");2!==n.length&&rc("");var i=!1;"echarts"===n[0]&&(e=n[1],i=!0),t.__isBuiltIn=i,ly.set(e,t)},registerLoading:Kw,registerMap:function(t,e,n){var i=Vx.registerMap;i&&i(t,e,n)},registerImpl:function(t,e){Vx[t]=e},PRIORITY:qx,ComponentModel:pg,ComponentView:Jy,SeriesModel:qy,ChartView:nb,registerComponentModel:function(t){pg.registerClass(t)},registerComponentView:function(t){Jy.registerClass(t)},registerSeriesModel:function(t){qy.registerClass(t)},registerChartView:function(t){nb.registerClass(t)},registerCustomSeries:function(t,e){},registerSubTypeDefaulter:function(t,e){pg.registerSubTypeDefaulter(t,e)},registerPainter:function(t,e){var n;n=e,Fl[t]=n}};function RC(t){mr(t)?sr(t,function(t){RC(t)}):rr(NC,t)>=0||(NC.push(t),gr(t)&&(t={install:t}),t.install(kC))}var _C=yc(),IC=yc();function FC(t){return{out:{noPxChangeTryDetermine:[]},kind:t}}function EC(t,e){var n=lr(e,function(e){return t.scale.parse(e)});return"time"===t.type&&n.length>0&&(n.sort(),n.unshift(n[0]),n.push(n[n.length-1])),n}function DC(t,e,n){var i,r,o=PC(t),a=SC(e),s=1===n.kind;if(!s){var l=OC(o,a);if(l)return l}gr(a)?i=qC(t,a):(r="auto"===a?function(t,e){if(1===e.kind){var n=t.calculateCategoryInterval(e);return e.out.noPxChangeTryDetermine.push(function(){return IC(t).autoInterval=n,!0}),n}var i=IC(t).autoInterval;return null!=i?i:IC(t).autoInterval=t.calculateCategoryInterval(e)}(t,n):a,i=UC(t,r));var c={labels:i,labelCategoryInterval:r};return s?n.out.noPxChangeTryDetermine.push(function(){return BC(o,a,c),!0}):BC(o,a,c),c}var LC=zC("axisTick"),PC=zC("axisLabel");function zC(t){return function(e){return IC(e)[t]||(IC(e)[t]={list:[]})}}function OC(t,e){for(var n=0;n<t.list.length;n++)if(t.list[n].key===e)return t.list[n].value}function BC(t,e,n){return t.list.push({key:e,value:n}),n}function VC(t,e,n){return null==HC(t,e,n)}function HC(t,e,n){var i=_C(t.model),r=t.getExtent(),o=i.lastAutoInterval,a=i.lastTickCount;if(null!=o&&null!=a&&Math.abs(o-e)<=1&&Math.abs(a-n)<=1&&o>e&&i.axisExtent0===r[0]&&i.axisExtent1===r[1])return o;i.lastTickCount=n,i.lastAutoInterval=e,i.axisExtent0=r[0],i.axisExtent1=r[1]}function UC(t,e,n){var i=xC(t),r=t.scale,o=r.getExtent(),a=t.getLabelModel(),s=[],l=Math.max((e||0)+1,1),c=o[0],h=r.count();0!==c&&l>1&&h/l>2&&(c=Math.round(Math.ceil(c/l)*l));var u=CC(t),d=a.get("showMinLabel")||u,f=a.get("showMaxLabel")||u;d&&c!==o[0]&&m(o[0]);for(var p=c;p<=o[1];p+=l)m(p);function m(t){var e={value:t};s.push(n?t:{formattedLabel:i(e),rawLabel:r.getLabel(e),tickValue:t,time:void 0,"break":void 0})}return f&&p-l!==o[1]&&m(o[1]),s}function qC(t,e,n){var i=t.scale,r=xC(t),o=[];return sr(i.getTicks(),function(t){var a=i.getLabel(t),s=t.value;e(t.value,a)&&o.push(n?s:{formattedLabel:r(t),rawLabel:a,tickValue:s,time:void 0,"break":void 0})}),o}var KC=[0,1],WC=function(){function t(t,e,n){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=e,this.Yc=n||[0,0]}return t.prototype.contain=function(t){var e=this.Yc,n=Math.min(e[0],e[1]),i=Math.max(e[0],e[1]);return t>=n&&t<=i},t.prototype.containData=function(t){return this.scale.contain(this.scale.parse(t))},t.prototype.getExtent=function(){return this.Yc.slice()},t.prototype.getPixelPrecision=function(t){return function(t,e){var n=Math.log,i=Math.LN10,r=Math.floor(n(t[1]-t[0])/i),o=Math.round(n(Ol(e[1]-e[0]))/i),a=Math.min(Math.max(-r+o,0),20);return isFinite(a)?a:20}(t||this.scale.getExtent(),this.Yc)},t.prototype.setExtent=function(t,e){var n=this.Yc;n[0]=t,n[1]=e},t.prototype.dataToCoord=function(t,e){var n=this.Yc,i=this.scale;return t=i.normalize(i.parse(t)),this.onBand&&"ordinal"===i.type&&jC(n=n.slice(),i.count()),Bl(t,KC,n,e)},t.prototype.coordToData=function(t,e){var n=this.Yc,i=this.scale;this.onBand&&"ordinal"===i.type&&jC(n=n.slice(),i.count());var r=Bl(t,n,KC,e);return this.scale.scale(r)},t.prototype.pointToData=function(t,e){},t.prototype.getTicksCoords=function(t){var e=(t=t||{}).tickModel||this.getTickModel(),n=lr(function(t,e,n){var i=t.getTickModel().get("customValues");if(i){var r=t.scale.getExtent();return{ticks:hr(EC(t,i),function(t){return t>=r[0]&&t<=r[1]})}}return"category"===t.type?function(t,e){var n,i,r=LC(t),o=SC(e),a=OC(r,o);if(a)return a;if(e.get("show")&&!t.scale.isBlank()||(n=[]),gr(o))n=qC(t,o,!0);else if("auto"===o){var s=DC(t,t.getLabelModel(),FC(2));i=s.labelCategoryInterval,n=lr(s.labels,function(t){return t.tickValue})}else n=UC(t,i=o,!0);return BC(r,o,{ticks:n,tickCategoryInterval:i})}(t,e):{ticks:lr(t.scale.getTicks(n),function(t){return t.value})}}(this,e,{breakTicks:t.breakTicks,pruneByBreak:t.pruneByBreak}).ticks,function(t){return{coord:this.dataToCoord("ordinal"===this.scale.type?this.scale.getRawOrdinalNumber(t):t),tickValue:t}},this);return function(t,e,n,i){var r=e.length;if(t.onBand&&!n&&r){var o,a,s=t.getExtent();if(1===r)e[0].coord=s[0],e[0].onBand=!0,o=e[1]={coord:s[1],tickValue:e[0].tickValue,onBand:!0};else{var l=e[r-1].tickValue-e[0].tickValue,c=(e[r-1].coord-e[0].coord)/l;sr(e,function(t){t.coord-=c/2,t.onBand=!0});var h=t.scale.getExtent();a=1+h[1]-e[r-1].tickValue,o={coord:e[r-1].coord+c*a,tickValue:h[1]+1,onBand:!0},e.push(o)}var u=s[0]>s[1];d(e[0].coord,s[0])&&(i?e[0].coord=s[0]:e.shift()),i&&d(s[0],e[0].coord)&&e.unshift({coord:s[0],onBand:!0}),d(s[1],o.coord)&&(i?o.coord=s[1]:e.pop()),i&&d(o.coord,s[1])&&e.push({coord:s[1],onBand:!0})}function d(t,e){return t=Ul(t),e=Ul(e),u?t>e:t<e}}(this,n,e.get("alignWithLabel"),t.clamp),n},t.prototype.getMinorTicksCoords=function(){if("ordinal"===this.scale.type)return[];var t=this.model.getModel("minorTick").get("splitNumber");return t>0&&t<100||(t=5),lr(this.scale.getMinorTicks(t),function(t){return lr(t,function(t){return{coord:this.dataToCoord(t),tickValue:t}},this)},this)},t.prototype.getViewLabels=function(t){return function(t,e){var n=t.getLabelModel().get("customValues");if(n){var i=xC(t),r=t.scale.getExtent();return{labels:lr(hr(EC(t,n),function(t){return t>=r[0]&&t<=r[1]}),function(e){var n={value:e};return{formattedLabel:i(n),rawLabel:t.scale.getLabel(n),tickValue:e,time:void 0,"break":void 0}})}}return"category"===t.type?function(t,e){var n=t.getLabelModel(),i=DC(t,n,e);return!n.get("show")||t.scale.isBlank()?{labels:[]}:i}(t,e):function(t){var e=t.scale.getTicks(),n=xC(t);return{labels:lr(e,function(e,i){return{formattedLabel:n(e,i),rawLabel:t.scale.getLabel(e),tickValue:e.value,time:e.time,"break":e.break}})}}(t)}(this,t=t||FC(2)).labels},t.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},t.prototype.getTickModel=function(){return this.model.getModel("axisTick")},t.prototype.getBandWidth=function(){var t=this.Yc,e=this.scale.getExtent(),n=e[1]-e[0]+(this.onBand?1:0);0===n&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},t.prototype.calculateCategoryInterval=function(t){return function(t,e){var n=e.kind,i=function(t){var e=t.getLabelModel();return{axisRotate:t.getRotate?t.getRotate():t.isHorizontal&&!t.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}(t),r=xC(t),o=(i.axisRotate-i.labelRotate)/180*Math.PI,a=t.scale,s=a.getExtent(),l=a.count();if(s[1]-s[0]<1)return 0;var c=1;l>40&&(c=Math.max(1,Math.floor(l/40)));for(var h=s[0],u=t.dataToCoord(h+1)-t.dataToCoord(h),d=Math.abs(u*Math.cos(o)),f=Math.abs(u*Math.sin(o)),p=0,m=0;h<=s[1];h+=c){var g,v,y=ml(r({value:h}),i.font,"center","top");g=1.3*y.width,v=1.3*y.height,p=Math.max(p,g,7),m=Math.max(m,v,7)}var b=p/d,x=m/f;isNaN(b)&&(b=1/0),isNaN(x)&&(x=1/0);var w=Math.max(0,Math.floor(Math.min(b,x)));if(1===n)return e.out.noPxChangeTryDetermine.push(fr(VC,null,t,w,l)),w;var S=HC(t,w,l);return null!=S?S:w}(this,t=t||FC(2))},t}();function jC(t,e){var n=(t[1]-t[0])/e/2;t[0]+=n,t[1]-=n}function GC(t,e,n,i,r,o,a,s){var l=r-t,c=o-e,h=n-t,u=i-e,d=Math.sqrt(h*h+u*u),f=(l*(h/=d)+c*(u/=d))/d;f*=d;var p=a[0]=t+f*h,m=a[1]=e+f*u;return Math.sqrt((p-r)*(p-r)+(m-o)*(m-o))}var XC=new zo,YC=new zo,ZC=new zo,JC=new zo,QC=new zo,tT=[],eT=new zo;function nT(t,e){if(e<=180&&e>0){e=e/180*Math.PI,XC.fromArray(t[0]),YC.fromArray(t[1]),ZC.fromArray(t[2]),zo.sub(JC,XC,YC),zo.sub(QC,ZC,YC);var n=JC.len(),i=QC.len();if(!(n<.001||i<.001)){JC.scale(1/n),QC.scale(1/i);var r=JC.dot(QC);if(Math.cos(e)<r){var o=GC(YC.x,YC.y,ZC.x,ZC.y,XC.x,XC.y,tT);eT.fromArray(tT),eT.scaleAndAdd(QC,o/Math.tan(Math.PI-e));var a=ZC.x!==YC.x?(eT.x-YC.x)/(ZC.x-YC.x):(eT.y-YC.y)/(ZC.y-YC.y);if(isNaN(a))return;a<0?zo.copy(eT,YC):a>1&&zo.copy(eT,ZC),eT.toArray(t[1])}}}}function iT(t,e,n){if(n<=180&&n>0){n=n/180*Math.PI,XC.fromArray(t[0]),YC.fromArray(t[1]),ZC.fromArray(t[2]),zo.sub(JC,YC,XC),zo.sub(QC,ZC,YC);var i=JC.len(),r=QC.len();if(!(i<.001||r<.001)&&(JC.scale(1/i),QC.scale(1/r),JC.dot(e)<Math.cos(n))){var o=GC(YC.x,YC.y,ZC.x,ZC.y,XC.x,XC.y,tT);eT.fromArray(tT);var a=Math.PI/2,s=a+Math.acos(QC.dot(e))-n;if(s>=a)zo.copy(eT,ZC);else{eT.scaleAndAdd(QC,o/Math.tan(Math.PI/2-s));var l=ZC.x!==YC.x?(eT.x-YC.x)/(ZC.x-YC.x):(eT.y-YC.y)/(ZC.y-YC.y);if(isNaN(l))return;l<0?zo.copy(eT,YC):l>1&&zo.copy(eT,ZC)}eT.toArray(t[1])}}}function rT(t,e,n,i){var r="normal"===n,o=r?t:t.ensureState(n);o.ignore=e;var a=i.get("smooth");a&&!0===a&&(a=.3),o.shape=o.shape||{},a>0&&(o.shape.smooth=a);var s=i.getModel("lineStyle").getLineStyle();r?t.useStyle(s):o.style=s}function oT(t,e){var n=e.smooth,i=e.points;if(i)if(t.moveTo(i[0][0],i[0][1]),n>0&&i.length>=3){var r=Jr(i[0],i[1]),o=Jr(i[1],i[2]);if(!r||!o)return t.lineTo(i[1][0],i[1][1]),void t.lineTo(i[2][0],i[2][1]);var a=Math.min(r,o)*n,s=to([],i[1],i[0],a/r),l=to([],i[1],i[2],a/o),c=to([],s,l,.5);t.bezierCurveTo(s[0],s[1],s[0],s[1],c[0],c[1]),t.bezierCurveTo(l[0],l[1],l[0],l[1],i[2][0],i[2][1])}else for(var h=1;h<i.length;h++)t.lineTo(i[h][0],i[h][1])}function aT(t,e,n){var i=t.getTextGuideLine(),r=t.getTextContent();if(r){for(var o=e.normal,a=o.get("show"),s=r.ignore,l=0;l<Wu.length;l++){var c=Wu[l],h=e[c],u="normal"===c;if(h){var d=h.get("show");if((u?s:Ar(r.states[c]&&r.states[c].ignore,s))||!Ar(d,a)){var f=u?i:i&&i.states[c];f&&(f.ignore=!0),i&&rT(i,!0,c,h);continue}i||(i=new Tf,t.setTextGuideLine(i),u||!s&&a||rT(i,!0,"normal",e.normal),t.stateProxy&&(i.stateProxy=t.stateProxy)),rT(i,!1,c,h)}}if(i){ir(i.style,n),i.style.fill=null;var p=o.get("showAbove");(t.textGuideLineConfig=t.textGuideLineConfig||{}).showAbove=p||!1,i.buildPath=oT}}else i&&t.removeTextGuideLine()}function sT(t,e){e=e||"labelLine";for(var n={normal:t.getModel(e)},i=0;i<Ku.length;i++){var r=Ku[i];n[r]=t.getModel([r,e])}return n}var lT=["label","labelLine","layoutOption","priority","defaultAttr","marginForce","minMarginForce","marginDefault","suggestIgnore"];function cT(t,e,n){n=n||3,e?t.dirty|=n:t.dirty&=~n}function hT(t,e){return e=e||3,null==t.dirty||!!(t.dirty&e)}function uT(t){if(t)return hT(t)&&dT(t,t.label,t),t}function dT(t,e,n){var i=e.getComputedTransform();t.transform=Rp(t.transform,i);var r=t.localRect=kp(t.localRect,e.getBoundingRect()),o=e.style,a=o.margin,s=n&&n.marginForce,l=n&&n.minMarginForce,c=n&&n.marginDefault,h=o.__marginType;null==h&&c&&(a=c,h=Wp.textMargin);for(var u=0;u<4;u++)fT[u]=h===Wp.minMargin&&l&&null!=l[u]?l[u]:s&&null!=s[u]?s[u]:a?a[u]:0;h===Wp.textMargin&&wp(r,fT,!1,!1);var d=t.rect=kp(t.rect,r);return i&&d.applyTransform(i),h===Wp.minMargin&&wp(d,fT,!1,!1),t.axisAligned=Ap(i),(t.label=t.label||{}).ignore=e.ignore,cT(t,!1),cT(t,!0,2),t}var fT=[0,0,0,0];function pT(t,e){for(var n=0;n<lT.length;n++){var i=lT[n];null==t[i]&&(t[i]=e[i])}return uT(t)}function mT(t){var e=t.obb;return e&&!hT(t,2)||(t.obb=e=e||new Wf,e.fromBoundingRect(t.localRect,t.transform),cT(t,!1,2)),e}function gT(t,e,n,i){return!(!t||!e)&&!(t.label&&t.label.ignore||e.label&&e.label.ignore)&&!!t.rect.intersect(e.rect,n,i)&&(!(!t.axisAligned||!e.axisAligned)||mT(t).intersect(mT(e),n,i))}var vT=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.hasSymbolVisual=!0,n}return Ei(e,t),e.prototype.getInitialData=function(t){return MS(0,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(t){var e=new Il,n=lx("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);e.add(n),n.setStyle(t.lineStyle);var i=this.getData().getVisual("symbol"),r=this.getData().getVisual("symbolRotate"),o="none"===i?"circle":i,a=.8*t.itemHeight,s=lx(o,(t.itemWidth-a)/2,(t.itemHeight-a)/2,a,a,t.itemStyle.fill);e.add(s),s.setStyle(t.itemStyle);var l="inherit"===t.iconRotate?r:t.iconRotate||0;return s.rotation=l*Math.PI/180,s.setOrigin([t.itemWidth/2,t.itemHeight/2]),o.indexOf("empty")>-1&&(s.style.stroke=s.style.fill,s.style.fill=mg.color.neutral00,s.style.lineWidth=2),e},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:6,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(qy);function yT(t,e){var n=t.mapDimensionsAll("defaultedLabel"),i=n.length;if(1===i){var r=Gv(t,e,n[0]);return null!=r?r+"":null}if(i){for(var o=[],a=0;a<n.length;a++)o.push(Gv(t,e,n[a]));return o.join(" ")}}function bT(t,e){var n=t.mapDimensionsAll("defaultedLabel");if(!mr(e))return e+"";for(var i=[],r=0;r<n.length;r++){var o=t.getDimensionIndex(n[r]);o>=0&&i.push(e[o])}return i.join(" ")}var xT=function(t){function e(e,n,i,r){var o=t.call(this)||this;return o.updateData(e,n,i,r),o}return Ei(e,t),e.prototype.Of=function(t,e,n,i,r,o){this.removeAll();var a=lx(t,-1,-1,2,2,null,o);a.attr({z2:Ar(r,100),culling:!0,scaleX:i[0]/2,scaleY:i[1]/2}),a.drift=wT,this.Pf=t,this.add(a)},e.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},e.prototype.getSymbolType=function(){return this.Pf},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){pd(this.childAt(0))},e.prototype.downplay=function(){md(this.childAt(0))},e.prototype.setZ=function(t,e){var n=this.childAt(0);n.zlevel=t,n.z=e},e.prototype.setDraggable=function(t,e){var n=this.childAt(0);n.draggable=t,n.cursor=!e&&t?"move":n.cursor},e.prototype.updateData=function(t,n,i,r){this.silent=!1;var o=t.getItemVisual(n,"symbol")||"circle",a=t.hostModel,s=e.getSymbolSize(t,n),l=e.getSymbolZ2(t,n),c=o!==this.Pf,h=r&&r.disableAnimation;if(c){var u=t.getItemVisual(n,"symbolKeepAspect");this.Of(o,t,n,s,l,u)}else{(f=this.childAt(0)).silent=!1;var d={scaleX:s[0]/2,scaleY:s[1]/2};h?f.attr(d):Zf(f,d,a,n),ip(f)}if(this.Vf(t,n,s,i,r),c){var f=this.childAt(0);h||(d={scaleX:this.Bf,scaleY:this.Hf,style:{opacity:f.style.opacity}},f.scaleX=f.scaleY=0,f.style.opacity=0,Jf(f,d,a,n))}h&&this.childAt(0).stopAnimation("leave")},e.prototype.Vf=function(t,e,n,i,r){var o,a,s,l,c,h,u,d,f,p=this.childAt(0),m=t.hostModel;if(i&&(o=i.emphasisItemStyle,a=i.blurItemStyle,s=i.selectItemStyle,l=i.focus,c=i.blurScope,u=i.labelStatesModels,d=i.hoverScale,f=i.cursorStyle,h=i.emphasisDisabled),!i||t.hasItemOption){var g=i&&i.itemModel?i.itemModel:t.getItemModel(e),v=g.getModel("emphasis");o=v.getModel("itemStyle").getItemStyle(),s=g.getModel(["select","itemStyle"]).getItemStyle(),a=g.getModel(["blur","itemStyle"]).getItemStyle(),l=v.get("focus"),c=v.get("blurScope"),h=v.get("disabled"),u=zp(g),d=v.getShallow("scale"),f=g.getShallow("cursor")}var y=t.getItemVisual(e,"symbolRotate");p.attr("rotation",(y||0)*Math.PI/180||0);var b=hx(t.getItemVisual(e,"symbolOffset"),n);b&&(p.x=b[0],p.y=b[1]),f&&p.attr("cursor",f);var x=t.getItemVisual(e,"style"),w=x.fill;if(p instanceof yu){var S=p.style;p.useStyle(nr({image:S.image,x:S.x,y:S.y,width:S.width,height:S.height},x))}else p.__isEmptyBrush?p.useStyle(nr({},x)):p.useStyle(x),p.style.decal=null,p.setColor(w,r&&r.symbolInnerColor),p.style.strokeNoScale=!0;var C=t.getItemVisual(e,"liftZ"),T=this.Uf;null!=C?null==T&&(this.Uf=p.z2,p.z2+=C):null!=T&&(p.z2=T,this.Uf=null);var $=r&&r.useNameLabel;Pp(p,u,{labelFetcher:m,labelDataIndex:e,defaultText:function(e){return $?t.getName(e):yT(t,e)},inheritColor:w,defaultOpacity:x.opacity}),this.Bf=n[0]/2,this.Hf=n[1]/2;var M=p.ensureState("emphasis");M.style=o,p.ensureState("select").style=s,p.ensureState("blur").style=a;var A=null==d||!0===d?Math.max(1.1,3/this.Hf):isFinite(d)&&d>0?+d:1;M.scaleX=this.Bf*A,M.scaleY=this.Hf*A,this.setSymbolScale(1),Ad(this,l,c,h)},e.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},e.prototype.fadeOut=function(t,e,n){var i=this.childAt(0),r=Bu(this).dataIndex,o=n&&n.animation;if(this.silent=i.silent=!0,n&&n.fadeLabel){var a=i.getTextContent();a&&tp(a,{style:{opacity:0}},e,{dataIndex:r,removeOpt:o,cb:function(){i.removeTextContent()}})}else i.removeTextContent();tp(i,{style:{opacity:0},scaleX:0,scaleY:0},e,{dataIndex:r,cb:t,removeOpt:o})},e.getSymbolSize=function(t,e){return cx(t.getItemVisual(e,"symbolSize"))},e.getSymbolZ2=function(t,e){return t.getItemVisual(e,"z2")},e}(Il);function wT(t,e){this.parent.drift(t,e)}function ST(t,e,n,i){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(i.isIgnore&&i.isIgnore(n))&&!(i.clipShape&&!i.clipShape.contain(e[0],e[1]))&&"none"!==t.getItemVisual(n,"symbol")}function CT(t){return null==t||xr(t)||(t={isIgnore:t}),t||{}}function TT(t){var e=t.hostModel,n=e.getModel("emphasis");return{emphasisItemStyle:n.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:n.get("focus"),blurScope:n.get("blurScope"),emphasisDisabled:n.get("disabled"),hoverScale:n.get("scale"),labelStatesModels:zp(e),cursorStyle:e.get("cursor")}}var $T=function(){function t(t){this.group=new Il,this.Kf=t||xT}return t.prototype.updateData=function(t,e){this.Wf=null,e=CT(e);var n=this.group,i=t.hostModel,r=this.Ln,o=this.Kf,a=e.disableAnimation,s=TT(t),l={disableAnimation:a},c=e.getSymbolPoint||function(e){return t.getItemLayout(e)};r||n.removeAll(),t.diff(r).add(function(i){var r=c(i);if(ST(t,r,i,e)){var a=new o(t,i,s,l);a.setPosition(r),t.setItemGraphicEl(i,a),n.add(a)}}).update(function(h,u){var d=r.getItemGraphicEl(u),f=c(h);if(ST(t,f,h,e)){var p=t.getItemVisual(h,"symbol")||"circle",m=d&&d.getSymbolType&&d.getSymbolType();if(!d||m&&m!==p)n.remove(d),(d=new o(t,h,s,l)).setPosition(f);else{d.updateData(t,h,s,l);var g={x:f[0],y:f[1]};a?d.attr(g):Zf(d,g,i)}n.add(d),t.setItemGraphicEl(h,d)}else n.remove(d)}).remove(function(t){var e=r.getItemGraphicEl(t);e&&e.fadeOut(function(){n.remove(e)},i)}).execute(),this.jf=c,this.Ln=t},t.prototype.updateLayout=function(){var t=this,e=this.Ln;e&&e.eachItemGraphicEl(function(e,n){var i=t.jf(n);e.setPosition(i),e.markRedraw()})},t.prototype.incrementalPrepareUpdate=function(t){this.qf=TT(t),this.Ln=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(t,e,n){function i(t){t.isGroup||(t.incremental=!0,t.ensureState("emphasis").hoverLayer=!0)}this.Wf=[],n=CT(n);for(var r=t.start;r<t.end;r++){var o=e.getItemLayout(r);if(ST(e,o,r,n)){var a=new this.Kf(e,r,this.qf);a.traverse(i),a.setPosition(o),this.group.add(a),e.setItemGraphicEl(r,a),this.Wf.push(a)}}},t.prototype.eachRendered=function(t){Mp(this.Wf||this.group,t)},t.prototype.remove=function(t){var e=this.group,n=this.Ln;n&&t?n.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t)},n.hostModel)}):e.removeAll()},t}();function MT(t,e,n){var i=t.getBaseAxis(),r=t.getOtherAxis(i),o=function(t,e){var n=0,i=t.scale.getExtent();return"start"===e?n=i[0]:"end"===e?n=i[1]:br(e)&&!isNaN(e)?n=e:i[0]>0?n=i[0]:i[1]<0&&(n=i[1]),n}(r,n),a=i.dim,s=r.dim,l=e.mapDimension(s),c=e.mapDimension(a),h="x"===s||"radius"===s?1:0,u=lr(t.dimensions,function(t){return e.mapDimension(t)}),d=!1,f=e.getCalculationInfo("stackResultDimension");return $S(e,u[0])&&(d=!0,u[0]=f),$S(e,u[1])&&(d=!0,u[1]=f),{dataDimsForPoint:u,valueStart:o,valueAxisDim:s,baseAxisDim:a,stacked:!!d,valueDim:l,baseDim:c,baseDataOffset:h,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function AT(t,e,n,i){var r=NaN;t.stacked&&(r=n.get(n.getCalculationInfo("stackedOverDimension"),i)),isNaN(r)&&(r=t.valueStart);var o=t.baseDataOffset,a=[];return a[o]=n.get(t.baseDim,i),a[1-o]=r,e.dataToPoint(a)}var NT=Math.min,kT=Math.max;function RT(t,e){return isNaN(t)||isNaN(e)}function _T(t,e,n,i,r,o,a,s,l){for(var c,h,u,d,f,p,m=n,g=0;g<i;g++){var v=e[2*m],y=e[2*m+1];if(m>=r||m<0)break;if(RT(v,y)){if(l){m+=o;continue}break}if(m===n)t[o>0?"moveTo":"lineTo"](v,y),u=v,d=y;else{var b=v-c,x=y-h;if(b*b+x*x<.5){m+=o;continue}if(a>0){for(var w=m+o,S=e[2*w],C=e[2*w+1];S===v&&C===y&&g<i;)g++,m+=o,S=e[2*(w+=o)],C=e[2*w+1],b=(v=e[2*m])-c,x=(y=e[2*m+1])-h;var T=g+1;if(l)for(;RT(S,C)&&T<i;)T++,S=e[2*(w+=o)],C=e[2*w+1];var $=.5,M=0,A=0,N=void 0,k=void 0;if(T>=i||RT(S,C))f=v,p=y;else{M=S-c,A=C-h;var R=v-c,_=S-v,I=y-h,F=C-y,E=void 0,D=void 0;if("x"===s){var L=M>0?1:-1;f=v-L*(E=Math.abs(R))*a,p=y,N=v+L*(D=Math.abs(_))*a,k=y}else if("y"===s){var P=A>0?1:-1;f=v,p=y-P*(E=Math.abs(I))*a,N=v,k=y+P*(D=Math.abs(F))*a}else E=Math.sqrt(R*R+I*I),f=v-M*a*(1-($=(D=Math.sqrt(_*_+F*F))/(D+E))),p=y-A*a*(1-$),k=y+A*a*$,N=NT(N=v+M*a*$,kT(S,v)),k=NT(k,kT(C,y)),N=kT(N,NT(S,v)),p=y-(A=(k=kT(k,NT(C,y)))-y)*E/D,f=NT(f=v-(M=N-v)*E/D,kT(c,v)),p=NT(p,kT(h,y)),N=v+(M=v-(f=kT(f,NT(c,v))))*D/E,k=y+(A=y-(p=kT(p,NT(h,y))))*D/E}t.bezierCurveTo(u,d,f,p,v,y),u=N,d=k}else t.lineTo(v,y)}c=v,h=y,m+=o}return g}var IT=function(){this.smooth=0,this.smoothConstraint=!0},FT=function(t){function e(e){var n=t.call(this,e)||this;return n.type="ec-polyline",n}return Ei(e,t),e.prototype.getDefaultStyle=function(){return{stroke:mg.color.neutral99,fill:null}},e.prototype.getDefaultShape=function(){return new IT},e.prototype.buildPath=function(t,e){var n=e.points,i=0,r=n.length/2;if(e.connectNulls){for(;r>0&&RT(n[2*r-2],n[2*r-1]);r--);for(;i<r&&RT(n[2*i],n[2*i+1]);i++);}for(;i<r;)i+=_T(t,n,i,r,r,1,e.smooth,e.smoothMonotone,e.connectNulls)+1},e.prototype.getPointOn=function(t,e){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var n,i,r=this.path.data,o=Wh.CMD,a="x"===e,s=[],l=0;l<r.length;){var c=void 0,h=void 0,u=void 0,d=void 0,f=void 0,p=void 0,m=void 0;switch(r[l++]){case o.M:n=r[l++],i=r[l++];break;case o.L:if(c=r[l++],h=r[l++],(m=a?(t-n)/(c-n):(t-i)/(h-i))<=1&&m>=0){var g=a?(h-i)*m+i:(c-n)*m+n;return a?[t,g]:[g,t]}n=c,i=h;break;case o.C:c=r[l++],h=r[l++],u=r[l++],d=r[l++],f=r[l++],p=r[l++];var v=a?La(n,c,u,f,t,s):La(i,h,d,p,t,s);if(v>0)for(var y=0;y<v;y++){var b=s[y];if(b<=1&&b>=0)return g=a?Ea(i,h,d,p,b):Ea(n,c,u,f,b),a?[t,g]:[g,t]}n=f,i=p}}},e}(fu),ET=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e}(IT),DT=function(t){function e(e){var n=t.call(this,e)||this;return n.type="ec-polygon",n}return Ei(e,t),e.prototype.getDefaultShape=function(){return new ET},e.prototype.buildPath=function(t,e){var n=e.points,i=e.stackedOnPoints,r=0,o=n.length/2,a=e.smoothMonotone;if(e.connectNulls){for(;o>0&&RT(n[2*o-2],n[2*o-1]);o--);for(;r<o&&RT(n[2*r],n[2*r+1]);r++);}for(;r<o;){var s=_T(t,n,r,o,o,1,e.smooth,a,e.connectNulls);_T(t,i,r+s-1,s,o,-1,e.stackedOnSmooth,a,e.connectNulls),r+=s+1,t.closePath()}},e}(fu);function LT(t,e,n,i,r){var o=t.getArea(),a=o.x,s=o.y,l=o.width,c=o.height,h=n.get(["lineStyle","width"])||0;a-=h/2,s-=h/2,l+=h,c+=h,l=Math.ceil(l),a!==Math.floor(a)&&(a=Math.floor(a),l++);var u=new $u({shape:{x:a,y:s,width:l,height:c}});if(e){var d=t.getBaseAxis(),f=d.isHorizontal(),p=d.inverse;f?(p&&(u.shape.x+=l),u.shape.width=0):(p||(u.shape.y+=c),u.shape.height=0);var m=gr(r)?function(t){r(t,u)}:null;Jf(u,{shape:{width:l,height:c,x:a,y:s}},n,null,i,m)}return u}function PT(t,e,n){var i=t.getArea(),r=Ul(i.r0,1),o=Ul(i.r,1),a=new vf({shape:{cx:Ul(t.cx,1),cy:Ul(t.cy,1),r0:r,r:o,startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}});return e&&("angle"===t.getBaseAxis().dim?a.shape.endAngle=i.startAngle:a.shape.r=r,Jf(a,{shape:{endAngle:i.endAngle,r:o}},n)),a}function zT(t,e,n,i,r){return t?"polar"===t.type?PT(t,e,n):"cartesian2d"===t.type?LT(t,e,n,i,r):null:null}function OT(t,e){return t.type===e}function BT(t,e){if(t.length===e.length){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return;return!0}}function VT(t){for(var e=1/0,n=1/0,i=-1/0,r=-1/0,o=0;o<t.length;){var a=t[o++],s=t[o++];isNaN(a)||(e=Math.min(a,e),i=Math.max(a,i)),isNaN(s)||(n=Math.min(s,n),r=Math.max(s,r))}return[[e,n],[i,r]]}function HT(t,e){var n=VT(t),i=n[0],r=n[1],o=VT(e),a=o[0],s=o[1];return Math.max(Math.abs(i[0]-a[0]),Math.abs(i[1]-a[1]),Math.abs(r[0]-s[0]),Math.abs(r[1]-s[1]))}function UT(t){return br(t)?t:t?.5:0}function qT(t,e,n,i,r){var o=n.getBaseAxis(),a="x"===o.dim||"radius"===o.dim?0:1,s=[],l=0,c=[],h=[],u=[],d=[];if(r){for(l=0;l<t.length;l+=2){var f=e||t;isNaN(f[l])||isNaN(f[l+1])||d.push(t[l],t[l+1])}t=d}for(l=0;l<t.length-2;l+=2)switch(u[0]=t[l+2],u[1]=t[l+3],h[0]=t[l],h[1]=t[l+1],s.push(h[0],h[1]),i){case"end":c[a]=u[a],c[1-a]=h[1-a],s.push(c[0],c[1]);break;case"middle":var p=(h[a]+u[a])/2,m=[];c[a]=m[a]=p,c[1-a]=h[1-a],m[1-a]=u[1-a],s.push(c[0],c[1]),s.push(m[0],m[1]);break;default:c[a]=h[a],c[1-a]=u[1-a],s.push(c[0],c[1])}return s.push(t[l++],t[l++]),s}function KT(t,e){return isNaN(t)||isNaN(e)}function WT(t,e){return[t[2*e],t[2*e+1]]}function jT(t){if(t.get(["endLabel","show"]))return!0;for(var e=0;e<Ku.length;e++)if(t.get([Ku[e],"endLabel","show"]))return!0;return!1}function GT(t,e,n,i){if(OT(e,"cartesian2d")){var r=i.getModel("endLabel"),o=r.get("valueAnimation"),a=i.getData(),s={lastFrameIndex:0},l=jT(i)?function(n,i){t.Gf(n,i,a,s,o,r,e)}:null,c=e.getBaseAxis().isHorizontal(),h=LT(e,n,i,function(){var e=t.Xf;e&&n&&null!=s.originalX&&e.attr({x:s.originalX,y:s.originalY})},l);if(!i.get("clip",!0)){var u=h.shape,d=Math.max(u.width,u.height);c?(u.y-=d,u.height+=2*d):(u.x-=d,u.width+=2*d)}return l&&l(1,h),h}return PT(e,n,i)}var XT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.init=function(){var t=new Il,e=new $T;this.group.add(e.group),this.Yf=e,this.Jf=t,this.Zf=fr(this.Zf,this)},e.prototype.render=function(t,e,n){var i=t.coordinateSystem,r=this.group,o=t.getData(),a=t.getModel("lineStyle"),s=t.getModel("areaStyle"),l=o.getLayout("points")||[],c="polar"===i.type,h=this.Qf,u=this.Yf,d=this.td,f=this.ed,p=this.Jf,m=!e.ssr&&t.get("animation"),g=!s.isEmpty(),v=s.get("origin"),y=MT(i,o,v),b=g&&function(t,e,n){if(!n.valueDim)return[];for(var i=e.count(),r=KS(2*i),o=0;o<i;o++){var a=AT(n,t,e,o);r[2*o]=a[0],r[2*o+1]=a[1]}return r}(i,o,y),x=t.get("showSymbol"),w=t.get("connectNulls"),S=x&&!c&&function(t,e,n){var i=t.get("showAllSymbol"),r="auto"===i;if(!i||r){var o=n.getAxesByScale("ordinal")[0];if(o&&(!r||!function(t,e){var n=t.getExtent(),i=Math.abs(n[1]-n[0])/t.scale.count();isNaN(i)&&(i=0);for(var r=e.count(),o=Math.max(1,Math.round(r/5)),a=0;a<r;a+=o)if(1.5*xT.getSymbolSize(e,a)[t.isHorizontal()?1:0]>i)return!1;return!0}(o,e))){var a=e.mapDimension(o.dim),s={};return sr(o.getViewLabels(),function(t){var e=o.scale.getRawOrdinalNumber(t.tickValue);s[e]=1}),function(t){return!s.hasOwnProperty(e.get(a,t))}}}}(t,o,i),C=this.Ln;C&&C.eachItemGraphicEl(function(t,e){t.__temp&&(r.remove(t),C.setItemGraphicEl(e,null))}),x||u.remove(),r.add(p);var T,$=!c&&t.get("step");i&&i.getArea&&t.get("clip",!0)&&(null!=(T=i.getArea()).width?(T.x-=.1,T.y-=.1,T.width+=.2,T.height+=.2):T.r0&&(T.r0-=.5,T.r+=.5)),this.nd=T;var M=function(t,e,n){var i=t.getVisual("visualMeta");if(i&&i.length&&t.count()&&"cartesian2d"===e.type){for(var r,o,a=i.length-1;a>=0;a--){var s=t.getDimensionInfo(i[a].dimension);if("x"===(r=s&&s.coordDim)||"y"===r){o=i[a];break}}if(o){var l=e.getAxis(r),c=lr(o.stops,function(t){return{coord:l.toGlobalCoord(l.dataToCoord(t.value)),color:t.color}}),h=c.length,u=o.outerColors.slice();h&&c[0].coord>c[h-1].coord&&(c.reverse(),u.reverse());var d=function(t,e){var n,i,r=[],o=t.length;function a(t,e,n){var i=t.coord;return{coord:n,color:function(t,e){if(e&&e.length&&t>=0&&t<=1){var n=t*(e.length-1),i=Math.floor(n),r=Math.ceil(n),o=cs(e[i]),a=cs(e[r]),s=n-i;return ms([Ja(is(o[0],a[0],s)),Ja(is(o[1],a[1],s)),Ja(is(o[2],a[2],s)),Qa(is(o[3],a[3],s))],"rgba")}}((n-i)/(e.coord-i),[t.color,e.color])}}for(var s=0;s<o;s++){var l=t[s],c=l.coord;if(c<0)n=l;else{if(c>e){i?r.push(a(i,l,e)):n&&r.push(a(n,l,0),a(n,l,e));break}n&&(r.push(a(n,l,0)),n=null),r.push(l),i=l}}return r}(c,"x"===r?n.getWidth():n.getHeight()),f=d.length;if(!f&&h)return c[0].coord<0?u[1]?u[1]:c[h-1].color:u[0]?u[0]:c[0].color;var p=d[0].coord-10,m=d[f-1].coord+10,g=m-p;if(g<.001)return"transparent";sr(d,function(t){t.offset=(t.coord-p)/g}),d.push({offset:f?d[f-1].offset:.5,color:u[1]||"transparent"}),d.unshift({offset:f?d[0].offset:.5,color:u[0]||"transparent"});var v=new Lf(0,0,0,0,d,!0);return v[r]=p,v[r+"2"]=m,v}}}(o,i,n)||o.getVisual("style")[o.getVisual("drawType")];if(d&&h.type===i.type&&$===this.rd){g&&!f?f=this.od(l,b):f&&!g&&(p.remove(f),f=this.ed=null),c||this.ad(t,i,Zm(M));var A=p.getClipPath();A?Jf(A,{shape:GT(this,i,!1,t).shape},t):p.setClipPath(GT(this,i,!0,t)),x&&u.updateData(o,{isIgnore:S,clipShape:T,disableAnimation:!0,getSymbolPoint:function(t){return[l[2*t],l[2*t+1]]}}),BT(this.ld,b)&&BT(this.hd,l)||(m?this.ud(o,b,i,n,$,v,w):($&&(b&&(b=qT(b,l,i,$,w)),l=qT(l,null,i,$,w)),d.setShape({points:l}),f&&f.setShape({points:l,stackedOnPoints:b})))}else x&&u.updateData(o,{isIgnore:S,clipShape:T,disableAnimation:!0,getSymbolPoint:function(t){return[l[2*t],l[2*t+1]]}}),m&&this.fd(o,i,T),$&&(b&&(b=qT(b,l,i,$,w)),l=qT(l,null,i,$,w)),d=this.dd(l),g?f=this.od(l,b):f&&(p.remove(f),f=this.ed=null),c||this.ad(t,i,Zm(M)),p.setClipPath(GT(this,i,!0,t));var N=t.getModel("emphasis"),k=N.get("focus"),R=N.get("blurScope"),_=N.get("disabled");d.useStyle(ir(a.getLineStyle(),{fill:"none",stroke:M,lineJoin:"bevel"})),_d(d,t,"lineStyle"),d.style.lineWidth>0&&"bolder"===t.get(["emphasis","lineStyle","width"])&&(d.getState("emphasis").style.lineWidth=+d.style.lineWidth+1),Bu(d).seriesIndex=t.seriesIndex,Ad(d,k,R,_);var I=UT(t.get("smooth")),F=t.get("smoothMonotone");if(d.setShape({smooth:I,smoothMonotone:F,connectNulls:w}),f){var E=o.getCalculationInfo("stackedOnSeries"),D=0;f.useStyle(ir(s.getAreaStyle(),{fill:M,opacity:.7,lineJoin:"bevel",decal:o.getVisual("style").decal})),E&&(D=UT(E.get("smooth"))),f.setShape({smooth:I,stackedOnSmooth:D,smoothMonotone:F,connectNulls:w}),_d(f,t,"areaStyle"),Bu(f).seriesIndex=t.seriesIndex,Ad(f,k,R,_)}var L=this.Zf;o.eachItemGraphicEl(function(t){t&&(t.onHoverStateChange=L)}),this.td.onHoverStateChange=L,this.Ln=o,this.Qf=i,this.ld=b,this.hd=l,this.rd=$,this.md=v,t.get("triggerLineEvent")&&(this.packEventData(t,d),f&&this.packEventData(t,f))},e.prototype.packEventData=function(t,e){Bu(e).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},e.prototype.highlight=function(t,e,n,i){var r=t.getData(),o=vc(r,i);if(this.Zf("emphasis"),!(o instanceof Array)&&null!=o&&o>=0){var a=r.getLayout("points"),s=r.getItemGraphicEl(o);if(!s){var l=a[2*o],c=a[2*o+1];if(isNaN(l)||isNaN(c))return;if(this.nd&&!this.nd.contain(l,c))return;var h=t.get("zlevel")||0,u=t.get("z")||0;(s=new xT(r,o)).x=l,s.y=c,s.setZ(h,u);var d=s.getSymbolPath().getTextContent();d&&(d.zlevel=h,d.z=u,d.z2=this.td.z2+1),s.__temp=!0,r.setItemGraphicEl(o,s),s.stopSymbolAnimation(!0),this.group.add(s)}s.highlight()}else nb.prototype.highlight.call(this,t,e,n,i)},e.prototype.downplay=function(t,e,n,i){var r=t.getData(),o=vc(r,i);if(this.Zf("normal"),null!=o&&o>=0){var a=r.getItemGraphicEl(o);a&&(a.__temp?(r.setItemGraphicEl(o,null),this.group.remove(a)):a.downplay())}else nb.prototype.downplay.call(this,t,e,n,i)},e.prototype.Zf=function(t){var e=this.ed;cd(this.td,t),e&&cd(e,t)},e.prototype.dd=function(t){var e=this.td;return e&&this.Jf.remove(e),e=new FT({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this.Jf.add(e),this.td=e,e},e.prototype.od=function(t,e){var n=this.ed;return n&&this.Jf.remove(n),n=new DT({shape:{points:t,stackedOnPoints:e},segmentIgnoreThreshold:2}),this.Jf.add(n),this.ed=n,n},e.prototype.fd=function(t,e,n){var i,r,o=e.getBaseAxis(),a=o.inverse;"cartesian2d"===e.type?(i=o.isHorizontal(),r=!1):"polar"===e.type&&(i="angle"===o.dim,r=!0);var s=t.hostModel,l=s.get("animationDuration");gr(l)&&(l=l(null));var c=s.get("animationDelay")||0,h=gr(c)?c(null):c;t.eachItemGraphicEl(function(t,o){var s=t;if(s){var u=[t.x,t.y],d=void 0,f=void 0,p=void 0;if(n)if(r){var m=n,g=e.pointToCoord(u);i?(d=m.startAngle,f=m.endAngle,p=-g[1]/180*Math.PI):(d=m.r0,f=m.r,p=g[0])}else{var v=n;i?(d=v.x,f=v.x+v.width,p=t.x):(d=v.y+v.height,f=v.y,p=t.y)}var y=f===d?0:(p-d)/(f-d);a&&(y=1-y);var b=gr(c)?c(o):l*y+h,x=s.getSymbolPath(),w=x.getTextContent();s.attr({scaleX:0,scaleY:0}),s.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:b}),w&&w.animateFrom({style:{opacity:0}},{duration:300,delay:b}),x.disableLabelAnimation=!0}})},e.prototype.ad=function(t,e,n){var i=t.getModel("endLabel");if(jT(t)){var r=t.getData(),o=this.td,a=r.getLayout("points");if(!a)return o.removeTextContent(),void(this.Xf=null);var s=this.Xf;s||((s=this.Xf=new ku({z2:200})).ignoreClip=!0,o.setTextContent(this.Xf),o.disableLabelAnimation=!0);var l=function(t){for(var e=t.length/2;e>0&&KT(t[2*e-2],t[2*e-1]);e--);return e-1}(a);l>=0&&(Pp(o,zp(t,"endLabel"),{inheritColor:n,labelFetcher:t,labelDataIndex:l,defaultText:function(t,e,n){return null!=n?bT(r,n):yT(r,t)},enableTextSetter:!0},function(t,e){var n=e.getBaseAxis(),i=n.isHorizontal(),r=n.inverse,o=i?r?"right":"left":"center",a=i?"middle":r?"top":"bottom";return{normal:{align:t.get("align")||o,verticalAlign:t.get("verticalAlign")||a}}}(i,e)),o.textConfig.position=null)}else this.Xf&&(this.td.removeTextContent(),this.Xf=null)},e.prototype.Gf=function(t,e,n,i,r,o,a){var s=this.Xf,l=this.td;if(s){t<1&&null==i.originalX&&(i.originalX=s.x,i.originalY=s.y);var c=n.getLayout("points"),h=n.hostModel,u=h.get("connectNulls"),d=o.get("precision"),f=o.get("distance")||0,p=a.getBaseAxis(),m=p.isHorizontal(),g=p.inverse,v=e.shape,y=g?m?v.x:v.y+v.height:m?v.x+v.width:v.y,b=(m?f:0)*(g?-1:1),x=(m?0:-f)*(g?-1:1),w=m?"x":"y",S=function(t,e,n){for(var i,r,o=t.length/2,a="x"===n?0:1,s=0,l=-1,c=0;c<o;c++)if(r=t[2*c+a],!isNaN(r)&&!isNaN(t[2*c+1-a]))if(0!==c){if(i<=e&&r>=e||i>=e&&r<=e){l=c;break}s=c,i=r}else i=r;return{range:[s,l],t:(e-i)/(r-i)}}(c,y,w),C=S.range,T=C[1]-C[0],$=void 0;if(T>=1){if(T>1&&!u){var M=WT(c,C[0]);s.attr({x:M[0]+b,y:M[1]+x}),r&&($=h.getRawValue(C[0]))}else{(M=l.getPointOn(y,w))&&s.attr({x:M[0]+b,y:M[1]+x});var A=h.getRawValue(C[0]),N=h.getRawValue(C[1]);r&&($=function(t,e,n,i,r){var o=null==e||"auto"===e;if(null==i)return i;if(br(i))return Ul(p=oc(n||0,i,r),o?Math.max(ql(n||0),ql(i)):e);if(vr(i))return r<1?n:i;for(var a=[],s=n,l=i,c=Math.max(s?s.length:0,l.length),h=0;h<c;++h){var u=t.getDimensionInfo(h);if(u&&"ordinal"===u.type)a[h]=(r<1&&s?s:l)[h];else{var d=s&&s[h]?s[h]:0,f=l[h],p=oc(d,f,r);a[h]=Ul(p,o?Math.max(ql(d),ql(f)):e)}}return a}(n,d,A,N,S.t))}i.lastFrameIndex=C[0]}else{var k=1===t||i.lastFrameIndex>0?C[0]:0;M=WT(c,k),r&&($=h.getRawValue(k)),s.attr({x:M[0]+b,y:M[1]+x})}if(r){var R=Kp(s);"function"==typeof R.setLabelText&&R.setLabelText($)}}},e.prototype.ud=function(t,e,n,i,r,o,a){var s=this.td,l=this.ed,c=t.hostModel,h=function(t,e,n,i,r,o,a){for(var s=function(t,e){var n=[];return e.diff(t).add(function(t){n.push({cmd:"+",idx:t})}).update(function(t,e){n.push({cmd:"=",idx:e,idx1:t})}).remove(function(t){n.push({cmd:"-",idx:t})}).execute(),n}(t,e),l=[],c=[],h=[],u=[],d=[],f=[],p=[],m=MT(r,e,a),g=t.getLayout("points")||[],v=e.getLayout("points")||[],y=0;y<s.length;y++){var b=s[y],x=!0,w=void 0,S=void 0;switch(b.cmd){case"=":w=2*b.idx,S=2*b.idx1;var C=g[w],T=g[w+1],$=v[S],M=v[S+1];(isNaN(C)||isNaN(T))&&(C=$,T=M),l.push(C,T),c.push($,M),h.push(n[w],n[w+1]),u.push(i[S],i[S+1]),p.push(e.getRawIndex(b.idx1));break;case"+":var A=b.idx,N=m.dataDimsForPoint,k=r.dataToPoint([e.get(N[0],A),e.get(N[1],A)]);S=2*A,l.push(k[0],k[1]),c.push(v[S],v[S+1]);var R=AT(m,r,e,A);h.push(R[0],R[1]),u.push(i[S],i[S+1]),p.push(e.getRawIndex(A));break;case"-":x=!1}x&&(d.push(b),f.push(f.length))}f.sort(function(t,e){return p[t]-p[e]});var _=l.length,I=KS(_),F=KS(_),E=KS(_),D=KS(_),L=[];for(y=0;y<f.length;y++){var P=f[y],z=2*y,O=2*P;I[z]=l[O],I[z+1]=l[O+1],F[z]=c[O],F[z+1]=c[O+1],E[z]=h[O],E[z+1]=h[O+1],D[z]=u[O],D[z+1]=u[O+1],L[y]=d[P]}return{current:I,next:F,stackedOnCurrent:E,stackedOnNext:D,status:L}}(this.Ln,t,this.ld,e,this.Qf,0,this.md),u=h.current,d=h.stackedOnCurrent,f=h.next,p=h.stackedOnNext;if(r&&(d=qT(h.stackedOnCurrent,h.current,n,r,a),u=qT(h.current,null,n,r,a),p=qT(h.stackedOnNext,h.next,n,r,a),f=qT(h.next,null,n,r,a)),HT(u,f)>3e3||l&&HT(d,p)>3e3)return s.stopAnimation(),s.setShape({points:f}),void(l&&(l.stopAnimation(),l.setShape({points:f,stackedOnPoints:p})));s.shape.__points=h.current,s.shape.points=u;var m={shape:{points:f}};h.current!==u&&(m.shape.__points=h.next),s.stopAnimation(),Zf(s,m,c),l&&(l.setShape({points:u,stackedOnPoints:d}),l.stopAnimation(),Zf(l,{shape:{stackedOnPoints:p}},c),s.shape.points!==l.shape.points&&(l.shape.points=s.shape.points));for(var g=[],v=h.status,y=0;y<v.length;y++)if("="===v[y].cmd){var b=t.getItemGraphicEl(v[y].idx1);b&&g.push({el:b,ptIdx:y})}s.animators&&s.animators.length&&s.animators[0].during(function(){l&&l.dirtyShape();for(var t=s.shape.__points,e=0;e<g.length;e++){var n=g[e].el,i=2*g[e].ptIdx;n.x=t[i],n.y=t[i+1],n.markRedraw()}})},e.prototype.remove=function(t){var e=this.group,n=this.Ln;this.Jf.removeAll(),this.Yf.remove(!0),n&&n.eachItemGraphicEl(function(t,i){t.__temp&&(e.remove(t),n.setItemGraphicEl(i,null))}),this.td=this.ed=this.Qf=this.hd=this.ld=this.Xf=this.Ln=null},e.type="line",e}(nb);function YT(t,e){return{seriesType:t,plan:Qy(),reset:function(t){var n=t.getData(),i=t.coordinateSystem,r=t.pipelineContext,o=e||r.large;if(i){var a=lr(i.dimensions,function(t){return n.mapDimension(t)}).slice(0,2),s=a.length,l=n.getCalculationInfo("stackResultDimension");$S(n,a[0])&&(a[0]=l),$S(n,a[1])&&(a[1]=l);var c=n.getStore(),h=n.getDimensionIndex(a[0]),u=n.getDimensionIndex(a[1]);return s&&{progress:function(t,e){for(var n=t.end-t.start,r=o&&KS(n*s),a=[],l=[],d=t.start,f=0;d<t.end;d++){var p=void 0;if(1===s){var m=c.get(h,d);p=i.dataToPoint(m,null,l)}else a[0]=c.get(h,d),a[1]=c.get(u,d),p=i.dataToPoint(a,null,l);o?(r[f++]=p[0],r[f++]=p[1]):e.setItemLayout(d,p.slice())}o&&e.setLayout("points",r)}}}}}}var ZT={average:function(t){for(var e=0,n=0,i=0;i<t.length;i++)isNaN(t[i])||(e+=t[i],n++);return 0===n?NaN:e/n},sum:function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n]||0;return e},max:function(t){for(var e=-1/0,n=0;n<t.length;n++)t[n]>e&&(e=t[n]);return isFinite(e)?e:NaN},min:function(t){for(var e=1/0,n=0;n<t.length;n++)t[n]<e&&(e=t[n]);return isFinite(e)?e:NaN},nearest:function(t){return t[0]}},JT=function(t){return Math.round(t.length/2)};function QT(t){return{seriesType:t,reset:function(t,e,n){var i=t.getData(),r=t.get("sampling"),o=t.coordinateSystem,a=i.count();if(a>10&&"cartesian2d"===o.type&&r){var s=o.getBaseAxis(),l=o.getOtherAxis(s),c=s.getExtent(),h=n.getDevicePixelRatio(),u=Math.abs(c[1]-c[0])*(h||1),d=Math.round(a/u);if(isFinite(d)&&d>1){"lttb"===r?t.setData(i.lttbDownSample(i.mapDimension(l.dim),1/d)):"minmax"===r&&t.setData(i.minmaxDownSample(i.mapDimension(l.dim),1/d));var f=void 0;vr(r)?f=ZT[r]:gr(r)&&(f=r),f&&t.setData(i.downSample(i.mapDimension(l.dim),1/d,f,JT))}}}}}var t$=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.getInitialData=function(t,e){return MS(0,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t,e,n){var i=this.coordinateSystem;if(i&&i.clampData){var r=i.clampData(t),o=i.dataToPoint(r);if(n)sr(i.getAxes(),function(t,n){if("category"===t.type&&null!=e){var i=t.getTicksCoords(),a=t.getTickModel().get("alignWithLabel"),s=r[n],l="x1"===e[n]||"y1"===e[n];if(l&&!a&&(s+=1),i.length<2)return;if(2===i.length)return void(o[n]=t.toGlobalCoord(t.getExtent()[l?1:0]));for(var c=void 0,h=void 0,u=1,d=0;d<i.length;d++){var f=i[d].coord,p=d===i.length-1?i[d-1].tickValue+u:i[d].tickValue;if(p===s){h=f;break}if(p<s)c=f;else if(null!=c&&p>s){h=(f+c)/2;break}1===d&&(u=p-i[0].tickValue)}null==h&&(c?c&&(h=i[i.length-1].coord):h=i[0].coord),o[n]=t.toGlobalCoord(h)}});else{var a=this.getData(),s=a.getLayout("offset"),l=a.getLayout("size"),c=i.getBaseAxis().isHorizontal()?0:1;o[c]+=s+l/2}return o}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod",defaultBarGap:"10%"},e}(qy);qy.registerClass(t$);var e$=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.getInitialData=function(){return MS(0,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),e=this.get("largeThreshold");return e>t&&(t=e),t},e.prototype.brushSelector=function(t,e,n){return n.rect(e.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=am(t$.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:mg.color.primary,borderWidth:2}},realtimeSort:!1}),e}(t$),n$=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},i$=function(t){function e(e){var n=t.call(this,e)||this;return n.type="sausage",n}return Ei(e,t),e.prototype.getDefaultShape=function(){return new n$},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r0||0,0),o=Math.max(e.r,0),a=.5*(o-r),s=r+a,l=e.startAngle,c=e.endAngle,h=e.clockwise,u=2*Math.PI,d=h?c-l<u:l-c<u;d||(l=c-(h?u:-u));var f=Math.cos(l),p=Math.sin(l),m=Math.cos(c),g=Math.sin(c);d?(t.moveTo(f*r+n,p*r+i),t.arc(f*s+n,p*s+i,a,-Math.PI+l,l,!h)):t.moveTo(f*o+n,p*o+i),t.arc(n,i,o,l,c,!h),t.arc(m*s+n,g*s+i,a,c-2*Math.PI,c-Math.PI,!h),0!==r&&t.arc(n,i,r,c,l,h)},e}(fu);function r$(t,e,n){return e*Math.sin(t)*(n?-1:1)}function o$(t,e,n){return e*Math.cos(t)*(n?1:-1)}function a$(t,e,n){var i=t.get("borderRadius");if(null==i)return n?{cornerRadius:0}:null;mr(i)||(i=[i,i,i,i]);var r=Math.abs(e.r||0-e.r0||0);return{cornerRadius:lr(i,function(t){return bl(t,r)})}}var s$=Math.max,l$=Math.min,c$=function(t){function e(){var n=t.call(this)||this;return n.type=e.type,n.pd=!0,n}return Ei(e,t),e.prototype.render=function(t,e,n,i){this.nu=t,this.vd(n),this.bd(t);var r=t.get("coordinateSystem");"cartesian2d"!==r&&"polar"!==r||(this.Wf=null,this.gd?this.yd(t,e,n):this.wd(t,e,n,i))},e.prototype.incrementalPrepareRender=function(t){this.xd(),this.bd(t),this.$d(t)},e.prototype.incrementalRender=function(t,e){this.Wf=[],this.Md(t,e)},e.prototype.eachRendered=function(t){Mp(this.Wf||this.group,t)},e.prototype.bd=function(t){var e=t.pipelineContext.large;null!=this.gd&&e===this.gd||(this.gd=e,this.xd())},e.prototype.wd=function(t,e,n,i){var r,o=this.group,a=t.getData(),s=this.Ln,l=t.coordinateSystem,c=l.getBaseAxis();"cartesian2d"===l.type?r=c.isHorizontal():"polar"===l.type&&(r="angle"===c.dim);var h=t.isAnimationEnabled()?t:null,u=function(t,e){var n=t.get("realtimeSort",!0),i=e.getBaseAxis();if(n&&"category"===i.type&&"cartesian2d"===e.type)return{baseAxis:i,otherAxis:e.getOtherAxis(i)}}(t,l);u&&this.Cd(u,a,n);var d=t.get("clip",!0)||u,f=function(t,e){var n=t.getArea&&t.getArea();if(OT(t,"cartesian2d")){var i=t.getBaseAxis();if("category"!==i.type||!i.onBand){var r=e.getLayout("bandWidth");i.isHorizontal()?(n.x-=r,n.width+=2*r):(n.y-=r,n.height+=2*r)}}return n}(l,a);o.removeClipPath();var p=t.get("roundCap",!0),m=t.get("showBackground",!0),g=t.getModel("backgroundStyle"),v=g.get("borderRadius")||0,y=[],b=this.Sd,x=i&&i.isInitSort,w=i&&"changeAxisOrder"===i.type;function S(t){var e=v$[l.type](a,t);if(!e)return null;var n=function(t,e,n){return new("polar"===t.type?vf:$u)({shape:T$(e,n,t),silent:!0,z2:0})}(l,r,e);return n.useStyle(g.getItemStyle()),"cartesian2d"===l.type?n.setShape("r",v):n.setShape("cornerRadius",v),y[t]=n,n}a.diff(s).add(function(e){var n=a.getItemModel(e),i=v$[l.type](a,e,n);if(i&&(m&&S(e),a.hasValue(e)&&g$[l.type](i))){var s=!1;d&&(s=h$[l.type](f,i));var g=u$[l.type](t,a,e,i,r,h,c.model,!1,p);u&&(g.forceLabelAnimation=!0),b$(g,a,e,n,i,t,r,"polar"===l.type),x?g.attr({shape:i}):u?d$(u,h,g,i,e,r,!1,!1):Jf(g,{shape:i},t,e),a.setItemGraphicEl(e,g),o.add(g),g.ignore=s}}).update(function(e,n){var i=a.getItemModel(e),C=v$[l.type](a,e,i);if(C){if(m){var T=void 0;0===b.length?T=S(n):((T=b[n]).useStyle(g.getItemStyle()),"cartesian2d"===l.type?T.setShape("r",v):T.setShape("cornerRadius",v),y[e]=T);var $=v$[l.type](a,e);Zf(T,{shape:T$(r,$,l)},h,e)}var M=s.getItemGraphicEl(n);if(a.hasValue(e)&&g$[l.type](C)){var A=!1;if(d&&(A=h$[l.type](f,C))&&o.remove(M),M&&("sector"===M.type&&p||"sausage"===M.type&&!p)&&(M&&np(M,t,n),M=null),M?ip(M):M=u$[l.type](t,a,e,C,r,h,c.model,!0,p),u&&(M.forceLabelAnimation=!0),w){var N=M.getTextContent();if(N){var k=Kp(N);null!=k.prevValue&&(k.prevValue=k.value)}}else b$(M,a,e,i,C,t,r,"polar"===l.type);x?M.attr({shape:C}):u?d$(u,h,M,C,e,r,!0,w):Zf(M,{shape:C},t,e,null),a.setItemGraphicEl(e,M),M.ignore=A,o.add(M)}else o.remove(M)}}).remove(function(e){var n=s.getItemGraphicEl(e);n&&np(n,t,e)}).execute();var C=this.Rd||(this.Rd=new Il);C.removeAll();for(var T=0;T<y.length;++T)C.add(y[T]);o.add(C),this.Sd=y,this.Ln=a},e.prototype.yd=function(t,e,n){this.xd(),S$(t,this.group),this.$d(t)},e.prototype.Md=function(t,e){this.Ad(),S$(e,this.group,this.Wf,!0)},e.prototype.$d=function(t){var e=t.get("clip",!0)&&zT(t.coordinateSystem,!1,t),n=this.group;e?n.setClipPath(e):n.removeClipPath()},e.prototype.Cd=function(t,e,n){var i=this;if(e.count()){var r=t.baseAxis;if(this.pd)this.kd(e,t,n),this.pd=!1;else{var o=function(t){var n=e.getItemGraphicEl(t),i=n&&n.shape;return i&&Math.abs(r.isHorizontal()?i.height:i.width)||0};this.Td=function(){i.Nd(e,o,r,n)},n.getZr().on("rendered",this.Td)}}},e.prototype.Fd=function(t,e,n){var i=[];return t.each(t.mapDimension(e.dim),function(t,e){var r=n(e);r=r??NaN,i.push({dataIndex:e,mappedValue:r,ordinalNumber:t})}),i.sort(function(t,e){return e.mappedValue-t.mappedValue}),{ordinalNumbers:lr(i,function(t){return t.ordinalNumber})}},e.prototype._d=function(t,e,n){for(var i=n.scale,r=t.mapDimension(n.dim),o=Number.MAX_VALUE,a=0,s=i.getOrdinalMeta().categories.length;a<s;++a){var l=t.rawIndexOf(r,i.getRawOrdinalNumber(a)),c=l<0?Number.MIN_VALUE:e(t.indexOfRawIndex(l));if(c>o)return!0;o=c}return!1},e.prototype.Ed=function(t,e){for(var n=e.scale,i=n.getExtent(),r=Math.max(0,i[0]),o=Math.min(i[1],n.getOrdinalMeta().categories.length-1);r<=o;++r)if(t.ordinalNumbers[r]!==n.getRawOrdinalNumber(r))return!0},e.prototype.Nd=function(t,e,n,i){if(this._d(t,e,n)){var r=this.Fd(t,n,e);this.Ed(r,n)&&(this.vd(i),i.dispatchAction({type:"changeAxisOrder",componentType:n.dim+"Axis",axisId:n.index,sortInfo:r}))}},e.prototype.kd=function(t,e,n){var i=e.baseAxis,r=this.Fd(t,i,function(n){return t.get(t.mapDimension(e.otherAxis.dim),n)});n.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",isInitSort:!0,axisId:i.index,sortInfo:r})},e.prototype.remove=function(t,e){this.xd(this.nu),this.vd(e)},e.prototype.dispose=function(t,e){this.vd(e)},e.prototype.vd=function(t){this.Td&&(t.getZr().off("rendered",this.Td),this.Td=null)},e.prototype.xd=function(t){var e=this.group,n=this.Ln;t&&t.isAnimationEnabled()&&n&&!this.gd?(this.Ad(),this.Sd=[],n.eachItemGraphicEl(function(e){np(e,t,Bu(e).dataIndex)})):e.removeAll(),this.Ln=null,this.pd=!0},e.prototype.Ad=function(){this.group.remove(this.Rd),this.Rd=null},e.type="bar",e}(nb),h$={cartesian2d:function(t,e){var n=e.width<0?-1:1,i=e.height<0?-1:1;n<0&&(e.x+=e.width,e.width=-e.width),i<0&&(e.y+=e.height,e.height=-e.height);var r=t.x+t.width,o=t.y+t.height,a=s$(e.x,t.x),s=l$(e.x+e.width,r),l=s$(e.y,t.y),c=l$(e.y+e.height,o),h=s<a,u=c<l;return e.x=h&&a>r?s:a,e.y=u&&l>o?c:l,e.width=h?0:s-a,e.height=u?0:c-l,n<0&&(e.x+=e.width,e.width=-e.width),i<0&&(e.y+=e.height,e.height=-e.height),h||u},polar:function(t,e){var n=e.r0<=e.r?1:-1;if(n<0){var i=e.r;e.r=e.r0,e.r0=i}var r=l$(e.r,t.r),o=s$(e.r0,t.r0);e.r=r,e.r0=o;var a=r-o<0;return n<0&&(i=e.r,e.r=e.r0,e.r0=i),a}},u$={cartesian2d:function(t,e,n,i,r,o,a,s,l){var c=new $u({shape:nr({},i),z2:1});return c.__dataIndex=n,c.name="item",o&&(c.shape[r?"height":"width"]=0),c},polar:function(t,e,n,i,r,o,a,s,l){var c=!r&&l?i$:vf,h=new c({shape:i,z2:1});h.name="item";var u=y$(r);if(h.calculateTextPosition=function(t,e){var n=(e=e||{}).isRoundCap;return function(e,i,r){var o=i.position;if(!o||o instanceof Array)return xl(e,i,r);var a=t(o),s=null!=i.distance?i.distance:5,l=this.shape,c=l.cx,h=l.cy,u=l.r,d=l.r0,f=(u+d)/2,p=l.startAngle,m=l.endAngle,g=(p+m)/2,v=n?Math.abs(u-d)/2:0,y=Math.cos,b=Math.sin,x=c+u*y(p),w=h+u*b(p),S="left",C="top";switch(a){case"startArc":x=c+(d-s)*y(g),w=h+(d-s)*b(g),S="center",C="top";break;case"insideStartArc":x=c+(d+s)*y(g),w=h+(d+s)*b(g),S="center",C="bottom";break;case"startAngle":x=c+f*y(p)+r$(p,s+v,!1),w=h+f*b(p)+o$(p,s+v,!1),S="right",C="middle";break;case"insideStartAngle":x=c+f*y(p)+r$(p,-s+v,!1),w=h+f*b(p)+o$(p,-s+v,!1),S="left",C="middle";break;case"middle":x=c+f*y(g),w=h+f*b(g),S="center",C="middle";break;case"endArc":x=c+(u+s)*y(g),w=h+(u+s)*b(g),S="center",C="bottom";break;case"insideEndArc":x=c+(u-s)*y(g),w=h+(u-s)*b(g),S="center",C="top";break;case"endAngle":x=c+f*y(m)+r$(m,s+v,!0),w=h+f*b(m)+o$(m,s+v,!0),S="left",C="middle";break;case"insideEndAngle":x=c+f*y(m)+r$(m,-s+v,!0),w=h+f*b(m)+o$(m,-s+v,!0),S="right",C="middle";break;default:return xl(e,i,r)}return(e=e||{}).x=x,e.y=w,e.align=S,e.verticalAlign=C,e}}(u,{isRoundCap:c===i$}),o){var d=r?"r":"endAngle",f={};h.shape[d]=r?i.r0:i.startAngle,f[d]=i[d],(s?Zf:Jf)(h,{shape:f},o)}return h}};function d$(t,e,n,i,r,o,a,s){var l,c;o?(c={x:i.x,width:i.width},l={y:i.y,height:i.height}):(c={y:i.y,height:i.height},l={x:i.x,width:i.width}),s||(a?Zf:Jf)(n,{shape:l},e,r,null),(a?Zf:Jf)(n,{shape:c},e?t.baseAxis.model:null,r)}function f$(t,e){for(var n=0;n<e.length;n++)if(!isFinite(t[e[n]]))return!0;return!1}var p$=["x","y","width","height"],m$=["cx","cy","r","startAngle","endAngle"],g$={cartesian2d:function(t){return!f$(t,p$)},polar:function(t){return!f$(t,m$)}},v$={cartesian2d:function(t,e,n){var i=t.getItemLayout(e);if(!i)return null;var r=n?function(t,e){var n=t.get(["itemStyle","borderColor"]);if(!n||"none"===n)return 0;var i=t.get(["itemStyle","borderWidth"])||0,r=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),o=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(i,r,o)}(n,i):0,o=i.width>0?1:-1,a=i.height>0?1:-1;return{x:i.x+o*r/2,y:i.y+a*r/2,width:i.width-o*r,height:i.height-a*r}},polar:function(t,e,n){var i=t.getItemLayout(e);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}}};function y$(t){return function(t){var e=t?"Arc":"Angle";return function(t){switch(t){case"start":case"insideStart":case"end":case"insideEnd":return t+e;default:return t}}}(t)}function b$(t,e,n,i,r,o,a,s){var l=e.getItemVisual(n,"style");if(s){if(!o.get("roundCap")){var c=t.shape;nr(c,a$(i.getModel("itemStyle"),c,!0)),t.setShape(c)}}else{var h=i.get(["itemStyle","borderRadius"])||0;t.setShape("r",h)}t.useStyle(l);var u=i.getShallow("cursor");u&&t.attr("cursor",u);var d=s?a?r.r>=r.r0?"endArc":"startArc":r.endAngle>=r.startAngle?"endAngle":"startAngle":a?r.height>=0?"bottom":"top":r.width>=0?"right":"left",f=zp(i);Pp(t,f,{labelFetcher:o,labelDataIndex:n,defaultText:yT(o.getData(),n),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var p=t.getTextContent();if(s&&p){var m=i.get(["label","position"]);t.textConfig.inside="middle"===m||null,function(t,e,n,i){if(br(i))t.setTextConfig({rotation:i});else if(mr(e))t.setTextConfig({rotation:0});else{var r,o=t.shape,a=o.clockwise?o.startAngle:o.endAngle,s=o.clockwise?o.endAngle:o.startAngle,l=(a+s)/2,c=n(e);switch(c){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":r=l;break;case"startAngle":case"insideStartAngle":r=a;break;case"endAngle":case"insideEndAngle":r=s;break;default:return void t.setTextConfig({rotation:0})}var h=1.5*Math.PI-r;"middle"===c&&h>Math.PI/2&&h<1.5*Math.PI&&(h-=Math.PI),t.setTextConfig({rotation:h})}}(t,"outside"===m?d:m,y$(a),i.get(["label","rotate"]))}!function(t,n,i){if(t){var r=Kp(t);r.prevValue=r.value,r.value=i;var o=n.normal;r.valueAnimation=o.get("valueAnimation"),r.valueAnimation&&(r.precision=o.get("precision"),r.defaultInterpolatedText=function(t){return bT(e,t)},r.statesModels=n)}}(p,f,o.getRawValue(n));var g=i.getModel(["emphasis"]);Ad(t,g.get("focus"),g.get("blurScope"),g.get("disabled")),_d(t,i),function(t){return null!=t.startAngle&&null!=t.endAngle&&t.startAngle===t.endAngle}(r)&&(t.style.fill="none",t.style.stroke="none",sr(t.states,function(t){t.style&&(t.style.fill=t.style.stroke="none")}))}var x$=function(){},w$=function(t){function e(e){var n=t.call(this,e)||this;return n.type="largeBar",n}return Ei(e,t),e.prototype.getDefaultShape=function(){return new x$},e.prototype.buildPath=function(t,e){for(var n=e.points,i=this.baseDimIdx,r=1-this.baseDimIdx,o=[],a=[],s=this.barWidth,l=0;l<n.length;l+=3)a[i]=s,a[r]=n[l+2],o[i]=n[l+i],o[r]=n[l+r],t.rect(o[0],o[1],a[0],a[1])},e}(fu);function S$(t,e,n,i){var r=t.getData(),o=r.getLayout("valueAxisHorizontal")?1:0,a=r.getLayout("largeDataIndices"),s=r.getLayout("size"),l=t.getModel("backgroundStyle"),c=r.getLayout("largeBackgroundPoints");if(c){var h=new w$({shape:{points:c},incremental:!!i,silent:!0,z2:0});h.baseDimIdx=o,h.largeDataIndices=a,h.barWidth=s,h.useStyle(l.getItemStyle()),e.add(h),n&&n.push(h)}var u=new w$({shape:{points:r.getLayout("largePoints")},incremental:!!i,ignoreCoarsePointer:!0,z2:1});u.baseDimIdx=o,u.largeDataIndices=a,u.barWidth=s,e.add(u),u.useStyle(r.getVisual("style")),u.style.stroke=null,Bu(u).seriesIndex=t.seriesIndex,t.get("silent")||(u.on("mousedown",C$),u.on("mousemove",C$)),n&&n.push(u)}var C$=ub(function(t){var e=function(t,e,n){for(var i=t.baseDimIdx,r=1-i,o=t.shape.points,a=t.largeDataIndices,s=[],l=[],c=t.barWidth,h=0,u=o.length/3;h<u;h++){var d=3*h;if(l[i]=c,l[r]=o[d+2],s[i]=o[d+i],s[r]=o[d+r],l[r]<0&&(s[r]+=l[r],l[r]=-l[r]),e>=s[0]&&e<=s[0]+l[0]&&n>=s[1]&&n<=s[1]+l[1])return a[h]}return-1}(this,t.offsetX,t.offsetY);Bu(this).dataIndex=e>=0?e:null},30,!1);function T$(t,e,n){if(OT(n,"cartesian2d")){var i=e,r=n.getArea();return{x:t?i.x:r.x,y:t?r.y:i.y,width:t?i.width:r.width,height:t?r.height:i.height}}var o=e;return{cx:(r=n.getArea()).cx,cy:r.cy,r0:t?r.r0:o.r0,r:t?r.r:o.r,startAngle:t?o.startAngle:0,endAngle:t?o.endAngle:2*Math.PI}}var $$=2*Math.PI,M$=Math.PI/180;function A$(t,e,n){e.eachSeriesByType(t,function(t){var e=t.getData(),i=e.mapDimension("value"),r=function(t,e){var n=function(t,e){var n,i,r=cg(t,e,{enableLayoutOnlyByCenter:!0}),o=t.getBoxLayoutParams();if(2===r.type)i=r.refPoint,n=lg(o,{width:e.getWidth(),height:e.getHeight()});else{var a=t.get("center"),s=mr(a)?a:[a,a];n=lg(o,r.refContainer),i=2===r.boxCoordFrom?r.refPoint:[Vl(s[0],n.width)+n.x,Vl(s[1],n.height)+n.y]}return{viewRect:n,center:i}}(t,e),i=n.viewRect,r=n.center,o=t.get("radius");mr(o)||(o=[0,o]);var a=Vl(i.width,e.getWidth()),s=Vl(i.height,e.getHeight()),l=Math.min(a,s),c=Vl(o[0],l/2),h=Vl(o[1],l/2);return{cx:r[0],cy:r[1],r0:c,r:h,viewRect:i}}(t,n),o=r.cx,a=r.cy,s=r.r,l=r.r0,c=r.viewRect,h=-t.get("startAngle")*M$,u=t.get("endAngle"),d=t.get("padAngle")*M$;u="auto"===u?h-$$:-u*M$;var f=t.get("minAngle")*M$+d,p=0;e.each(i,function(t){!isNaN(t)&&p++});var m=e.getSum(i),g=Math.PI/(m||p)*2,v=t.get("clockwise"),y=t.get("roseType"),b=t.get("stillShowZeroSum"),x=e.getDataExtent(i);x[0]=0;var w=v?1:-1,S=[h,u],C=w*d/2;Kh(S,!v),h=S[0],u=S[1];var T=N$(t);T.startAngle=h,T.endAngle=u,T.clockwise=v,T.cx=o,T.cy=a,T.r=s,T.r0=l;var $=Math.abs(u-h),M=$,A=0,N=h;if(e.setLayout({viewRect:c,r:s}),e.each(i,function(t,n){var i;if(isNaN(t))e.setItemLayout(n,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:v,cx:o,cy:a,r0:l,r:y?NaN:s});else{(i="area"!==y?0===m&&b?g:t*g:$/p)<f?(i=f,M-=f):A+=t;var r=N+w*i,c=0,h=0;d>i?h=c=N+w*i/2:(c=N+C,h=r-C),e.setItemLayout(n,{angle:i,startAngle:c,endAngle:h,clockwise:v,cx:o,cy:a,r0:l,r:y?Bl(t,x,[l,s]):s}),N=r}}),M<$$&&p)if(M<=.001){var k=$/p;e.each(i,function(t,n){if(!isNaN(t)){var i=e.getItemLayout(n);i.angle=k;var r=0,o=0;k<d?o=r=h+w*(n+.5)*k:(r=h+w*n*k+C,o=h+w*(n+1)*k-C),i.startAngle=r,i.endAngle=o}})}else g=M/A,N=h,e.each(i,function(t,n){if(!isNaN(t)){var i=e.getItemLayout(n),r=i.angle===f?f:t*g,o=0,a=0;r<d?a=o=N+w*r/2:(o=N+C,a=N+w*r-C),i.startAngle=o,i.endAngle=a,N+=w*r}})})}var N$=yc();function k$(t){return{seriesType:t,reset:function(t,e){var n=e.findComponents({mainType:"legend"});if(n&&n.length){var i=t.getData();i.filterSelf(function(t){for(var e=i.getName(t),r=0;r<n.length;r++)if(!n[r].isSelected(e))return!1;return!0})}}}}var R$=Math.PI/180;function _$(t,e,n,i,r,o,a,s,l,c){if(!(t.length<2)){for(var h=t.length,u=0;u<h;u++)if("outer"===t[u].position&&"labelLine"===t[u].labelAlignTo){var d=t[u].label.x-c;t[u].linePoints[1][0]+=d,t[u].label.x=c}(function(t,e,n,i){var r=t.length,o=op[1],a=ap[1];if(r<2)return!1;t.sort(function(t,e){return t.rect[o]-e.rect[o]});for(var s,l=0,c=!1,h=0;h<r;h++){var u=t[h],d=u.rect;(s=d[o]-l)<0&&(d[o]-=s,u.label[o]-=s,c=!0),l=d[o]+d[a]}var f,p,m=t[0],g=t[r-1];function v(){f=m.rect[o]-n,p=i-g.rect[o]-g.rect[a]}function y(t,e,n){if(t<0){var i=Math.min(e,-t);if(i>0){b(i*n,0,r);var o=i+t;o<0&&x(-o*n,1)}else x(-t*n,1)}}function b(e,n,i){0!==e&&(c=!0);for(var r=n;r<i;r++){var a=t[r];a.rect[o]+=e,a.label[o]+=e}}function x(e,n){for(var i=[],s=0,l=1;l<r;l++){var c=t[l-1].rect,h=Math.max(t[l].rect[o]-c[o]-c[a],0);i.push(h),s+=h}if(s){var u=Math.min(Math.abs(e)/s,n);if(e>0)for(l=0;l<r-1;l++)b(i[l]*u,0,l+1);else for(l=r-1;l>0;l--)b(-i[l-1]*u,l,r)}}function w(t){var e=t<0?-1:1;t=Math.abs(t);for(var n=Math.ceil(t/(r-1)),i=0;i<r-1;i++)if(e>0?b(n,0,i+1):b(-n,r-i-1,r),(t-=n)<=0)return}return v(),f<0&&x(-f,.8),p<0&&x(p,.8),v(),y(f,p,1),y(p,f,-1),v(),f<0&&w(-f),p<0&&w(p),c})(t,0,l,l+a)&&function(t){for(var o={list:[],maxY:0},a={list:[],maxY:0},s=0;s<t.length;s++)if("none"===t[s].labelAlignTo){var l=t[s],c=l.label.y>n?a:o,h=Math.abs(l.label.y-n);if(h>=c.maxY){var u=l.label.x-e-l.len2*r,d=i+l.len,p=Math.abs(u)<d?Math.sqrt(h*h/(1-u*u/d/d)):d;c.rB=p,c.maxY=h}c.list.push(l)}f(o),f(a)}(t)}function f(t){for(var o=t.rB,a=o*o,s=0;s<t.list.length;s++){var l=t.list[s],c=Math.abs(l.label.y-n),h=i+l.len,u=h*h,d=Math.sqrt(Math.abs((1-c*c/a)*u)),f=e+(d+l.len2)*r,p=f-l.label.x;I$(l,l.targetTextWidth-p*r,!0),l.label.x=f}}}function I$(t,e,n){if(null==t.labelStyleWidth){var i=t.label,r=i.style,o=t.rect,a=r.backgroundColor,s=r.padding,l=s?s[1]+s[3]:0,c=r.overflow,h=o.width+(a?0:l);if(e<h||n){if(c&&c.match("break")){i.setStyle("backgroundColor",null),i.setStyle("width",e-l);var u=i.getBoundingRect();i.setStyle("width",Math.ceil(u.width)),i.setStyle("backgroundColor",a)}else{var d=e-l,f=e<h?d:n?d>t.unconstrainedWidth?null:d:null;i.setStyle("width",f)}F$(o,i)}}}function F$(t,e){D$.rect=t,dT(D$,e,E$)}var E$={minMarginForce:[null,0,null,0],marginDefault:[1,0,1,0]},D$={};function L$(t){return"center"===t.position}var P$=function(t){function e(e,n,i){var r=t.call(this)||this;r.z2=2;var o=new ku;return r.setTextContent(o),r.updateData(e,n,i,!0),r}return Ei(e,t),e.prototype.updateData=function(t,e,n,i){var r=this,o=t.hostModel,a=t.getItemModel(e),s=a.getModel("emphasis"),l=t.getItemLayout(e),c=nr(a$(a.getModel("itemStyle"),l,!0),l);if(isNaN(c.startAngle))r.setShape(c);else{if(i){r.setShape(c);var h=o.getShallow("animationType");o.ecModel.ssr?(Jf(r,{scaleX:0,scaleY:0},o,{dataIndex:e,isFrom:!0}),r.originX=c.cx,r.originY=c.cy):"scale"===h?(r.shape.r=l.r0,Jf(r,{shape:{r:l.r}},o,e)):null!=n?(r.setShape({startAngle:n,endAngle:n}),Jf(r,{shape:{startAngle:l.startAngle,endAngle:l.endAngle}},o,e)):(r.shape.endAngle=l.startAngle,Zf(r,{shape:{endAngle:l.endAngle}},o,e))}else ip(r),Zf(r,{shape:c},o,e);r.useStyle(t.getItemVisual(e,"style")),_d(r,a);var u=(l.startAngle+l.endAngle)/2,d=o.get("selectedOffset"),f=Math.cos(u)*d,p=Math.sin(u)*d,m=a.getShallow("cursor");m&&r.attr("cursor",m),this.Id(o,t,e),r.ensureState("emphasis").shape=nr({r:l.r+(s.get("scale")&&s.get("scaleSize")||0)},a$(s.getModel("itemStyle"),l)),nr(r.ensureState("select"),{x:f,y:p,shape:a$(a.getModel(["select","itemStyle"]),l)}),nr(r.ensureState("blur"),{shape:a$(a.getModel(["blur","itemStyle"]),l)});var g=r.getTextGuideLine(),v=r.getTextContent();g&&nr(g.ensureState("select"),{x:f,y:p}),nr(v.ensureState("select"),{x:f,y:p}),Ad(this,s.get("focus"),s.get("blurScope"),s.get("disabled"))}},e.prototype.Id=function(t,e,n){var i=this,r=e.getItemModel(n),o=r.getModel("labelLine"),a=e.getItemVisual(n,"style"),s=a&&a.fill,l=a&&a.opacity;Pp(i,zp(r),{labelFetcher:e.hostModel,labelDataIndex:n,inheritColor:s,defaultOpacity:l,defaultText:t.getFormattedLabel(n,"normal")||e.getName(n)});var c=i.getTextContent();i.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var h=r.get(["label","position"]);if("outside"!==h&&"outer"!==h)i.removeTextGuideLine();else{var u=this.getTextGuideLine();u||(u=new Tf,this.setTextGuideLine(u)),aT(this,sT(r),{stroke:s,opacity:Nr(o.get(["lineStyle","opacity"]),l,1)})}},e}(vf),z$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ignoreLabelLineUpdate=!0,e}return Ei(e,t),e.prototype.render=function(t,e,n,i){var r,o=t.getData(),a=this.Ln,s=this.group;if(!a&&o.count()>0){for(var l=o.getItemLayout(0),c=1;isNaN(l&&l.startAngle)&&c<o.count();++c)l=o.getItemLayout(c);l&&(r=l.startAngle)}if(this.zd&&s.remove(this.zd),0===o.count()&&t.get("showEmptyCircle")){var h=N$(t),u=new vf({shape:tr(h)});u.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this.zd=u,s.add(u)}o.diff(a).add(function(t){var e=new P$(o,t,r);o.setItemGraphicEl(t,e),s.add(e)}).update(function(t,e){var n=a.getItemGraphicEl(e);n.updateData(o,t,r),n.off("click"),s.add(n),o.setItemGraphicEl(t,n)}).remove(function(e){np(a.getItemGraphicEl(e),t,e)}).execute(),function(t){var e,n,i=t.getData(),r=[],o=!1,a=(t.get("minShowLabelAngle")||0)*R$,s=i.getLayout("viewRect"),l=i.getLayout("r"),c=s.width,h=s.x,u=s.y,d=s.height;function f(t){t.ignore=!0}i.each(function(t){var s=i.getItemGraphicEl(t),u=s.shape,p=s.getTextContent(),m=s.getTextGuideLine(),g=i.getItemModel(t),v=g.getModel("label"),y=v.get("position")||g.get(["emphasis","label","position"]),b=v.get("distanceToLabelLine"),x=v.get("alignTo"),w=Vl(v.get("edgeDistance"),c),S=v.get("bleedMargin");null==S&&(S=Math.min(c,d)>200?10:2);var C=g.getModel("labelLine"),T=C.get("length");T=Vl(T,c);var $=C.get("length2");if($=Vl($,c),Math.abs(u.endAngle-u.startAngle)<a)return sr(p.states,f),p.ignore=!0,void(m&&(sr(m.states,f),m.ignore=!0));if(function(t){if(!t.ignore)return!0;for(var e in t.states)if(!1===t.states[e].ignore)return!0;return!1}(p)){var M,A,N,k,R=(u.startAngle+u.endAngle)/2,_=Math.cos(R),I=Math.sin(R);e=u.cx,n=u.cy;var F="inside"===y||"inner"===y;if("center"===y)M=u.cx,A=u.cy,k="center";else{var E=(F?(u.r+u.r0)/2*_:u.r*_)+e,D=(F?(u.r+u.r0)/2*I:u.r*I)+n;if(M=E+3*_,A=D+3*I,!F){var L=E+_*(T+l-u.r),P=D+I*(T+l-u.r),z=L+(_<0?-1:1)*$;M="edge"===x?_<0?h+w:h+c-w:z+(_<0?-b:b),A=P,N=[[E,D],[L,P],[z,P]]}k=F?"center":"edge"===x?_>0?"right":"left":_>0?"left":"right"}var O=Math.PI,B=0,V=v.get("rotate");if(br(V))B=V*(O/180);else if("center"===y)B=0;else if("radial"===V||!0===V)B=_<0?-R+O:-R;else if("tangential"===V&&"outside"!==y&&"outer"!==y){var H=Math.atan2(_,I);H<0&&(H=2*O+H),I>0&&(H=O+H),B=H-O}if(o=!!B,p.x=M,p.y=A,p.rotation=B,p.setStyle({verticalAlign:"middle"}),F){p.setStyle({align:k});var U=p.states.select;U&&(U.x+=p.x,U.y+=p.y)}else{var q=new Jo(0,0,0,0);F$(q,p),r.push({label:p,labelLine:m,position:y,len:T,len2:$,minTurnAngle:C.get("minTurnAngle"),maxSurfaceAngle:C.get("maxSurfaceAngle"),surfaceNormal:new zo(_,I),linePoints:N,textAlign:k,labelDistance:b,labelAlignTo:x,edgeDistance:w,bleedMargin:S,rect:q,unconstrainedWidth:q.width,labelStyleWidth:p.style.width})}s.setTextConfig({inside:F})}}),!o&&t.get("avoidLabelOverlap")&&function(t,e,n,i,r,o,a,s){for(var l=[],c=[],h=Number.MAX_VALUE,u=-Number.MAX_VALUE,d=0;d<t.length;d++){var f=t[d].label;L$(t[d])||(f.x<e?(h=Math.min(h,f.x),l.push(t[d])):(u=Math.max(u,f.x),c.push(t[d])))}for(d=0;d<t.length;d++)if(!L$(g=t[d])&&g.linePoints){if(null!=g.labelStyleWidth)continue;f=g.label;var p,m=g.linePoints;p="edge"===g.labelAlignTo?f.x<e?m[2][0]-g.labelDistance-a-g.edgeDistance:a+r-g.edgeDistance-m[2][0]-g.labelDistance:"labelLine"===g.labelAlignTo?f.x<e?h-a-g.bleedMargin:a+r-u-g.bleedMargin:f.x<e?f.x-a-g.bleedMargin:a+r-f.x-g.bleedMargin,g.targetTextWidth=p,I$(g,p,!1)}for(_$(c,e,n,i,1,0,o,0,s,u),_$(l,e,n,i,-1,0,o,0,s,h),d=0;d<t.length;d++){var g;if(!L$(g=t[d])&&g.linePoints){f=g.label,m=g.linePoints;var v="edge"===g.labelAlignTo,y=f.style.padding,b=y?y[1]+y[3]:0,x=f.style.backgroundColor?0:b,w=g.rect.width+x,S=m[1][0]-m[2][0];v?f.x<e?m[2][0]=a+g.edgeDistance+w+g.labelDistance:m[2][0]=a+r-g.edgeDistance-w-g.labelDistance:(f.x<e?m[2][0]=f.x+g.labelDistance:m[2][0]=f.x-g.labelDistance,m[1][0]=m[2][0]+S),m[1][1]=m[2][1]=f.y}}}(r,e,n,l,c,d,h,u);for(var p=0;p<r.length;p++){var m=r[p],g=m.label,v=m.labelLine,y=isNaN(g.x)||isNaN(g.y);if(g){g.setStyle({align:m.textAlign}),y&&(sr(g.states,f),g.ignore=!0);var b=g.states.select;b&&(b.x+=g.x,b.y+=g.y)}if(v){var x=m.linePoints;y||!x?(sr(v.states,f),v.ignore=!0):(nT(x,m.minTurnAngle),iT(x,m.surfaceNormal,m.maxSurfaceAngle),v.setShape({points:x}),g.__hostTarget.textGuideLineConfig={anchor:new zo(x[0][0],x[0][1])})}}}(t),"expansion"!==t.get("animationTypeUpdate")&&(this.Ln=o)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,e){var n=e.getData().getItemLayout(0);if(n){var i=t[0]-n.cx,r=t[1]-n.cy,o=Math.sqrt(i*i+r*r);return o<=n.r&&o>=n.r0}},e.type="pie",e}(nb);function O$(t,e,n){e=mr(e)&&{coordDimensions:e}||nr({encodeDefine:t.getEncode()},e);var i=t.getSource(),r=xS(i,e).dimensions,o=new bS(r,t);return o.initData(i,n),o}var B$,V$=function(){function t(t,e){this.Dd=t,this.Ld=e}return t.prototype.getAllNames=function(){var t=this.Ld();return t.mapArray(t.getName)},t.prototype.containName=function(t){return this.Ld().indexOfName(t)>=0},t.prototype.indexOfName=function(t){return this.Dd().indexOfName(t)},t.prototype.getItemVisual=function(t,e){return this.Dd().getItemVisual(t,e)},t}(),H$=yc(),U$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new V$(fr(this.getData,this),fr(this.getRawData,this)),this.Od(e)},e.prototype.mergeOption=function(){t.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return O$(this,{coordDimensions:["value"],encodeDefaulter:pr(Dg,this)})},e.prototype.getDataParams=function(e){var n=this.getData(),i=H$(n),r=i.seats;if(!r){var o=[];n.each(n.mapDimension("value"),function(t){o.push(t)}),r=i.seats=function(t,e){var n=cr(t,function(t,e){return t+(isNaN(e)?0:e)},0);if(0===n)return[];for(var i=Math.pow(10,e),r=lr(t,function(t){return(isNaN(t)?0:t)/n*i*100}),o=100*i,a=lr(r,function(t){return Math.floor(t)}),s=cr(a,function(t,e){return t+e},0),l=lr(r,function(t,e){return t-a[e]});s<o;){for(var c=Number.NEGATIVE_INFINITY,h=null,u=0,d=l.length;u<d;++u)l[u]>c&&(c=l[u],h=u);++a[h],l[h]=0,++s}return lr(a,function(t){return t/i})}(o,n.hostModel.get("percentPrecision"))}var a=t.prototype.getDataParams.call(this,e);return a.percent=r[e]||0,a.$vars.push("percent"),a},e.prototype.Od=function(t){lc(t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"50%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,coordinateSystemUsage:"box",left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:30,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(qy);B$={fullType:U$.type,getCoord2:function(t){return t.getShallow("center")}},ng.set(B$.fullType,{getCoord2:void 0}).getCoord2=B$.getCoord2;var q$=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.hasSymbolVisual=!0,n}return Ei(e,t),e.prototype.getInitialData=function(t,e){return MS(0,this,{useEncodeDefaulter:!0})},e.prototype.getProgressive=function(){return this.option.progressive??(this.option.large?5e3:this.get("progressive"))},e.prototype.getProgressiveThreshold=function(){return this.option.progressiveThreshold??(this.option.large?1e4:this.get("progressiveThreshold"))},e.prototype.brushSelector=function(t,e,n){return n.point(e.getItemLayout(t))},e.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},e.type="series.scatter",e.dependencies=["grid","polar","geo","singleAxis","calendar","matrix"],e.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:mg.color.primary}},universalTransition:{divideShape:"clone"}},e}(qy),K$=function(){},W$=function(t){function e(e){var n=t.call(this,e)||this;return n.Pd=0,n.hoverDataIdx=-1,n}return Ei(e,t),e.prototype.getDefaultShape=function(){return new K$},e.prototype.reset=function(){this.notClear=!1,this.Pd=0},e.prototype.buildPath=function(t,e){var n,i=e.points,r=e.size,o=this.symbolProxy,a=o.shape,s=t.getContext?t.getContext():t,l=s&&r[0]<4,c=this.softClipShape;if(l)this.kl=s;else{for(this.kl=null,n=this.Pd;n<i.length;){var h=i[n++],u=i[n++];isNaN(h)||isNaN(u)||c&&!c.contain(h,u)||(a.x=h-r[0]/2,a.y=u-r[1]/2,a.width=r[0],a.height=r[1],o.buildPath(t,a,!0))}this.incremental&&(this.Pd=n,this.notClear=!0)}},e.prototype.afterBrush=function(){var t,e=this.shape,n=e.points,i=e.size,r=this.kl,o=this.softClipShape;if(r){for(t=this.Pd;t<n.length;){var a=n[t++],s=n[t++];isNaN(a)||isNaN(s)||o&&!o.contain(a,s)||r.fillRect(a-i[0]/2,s-i[1]/2,i[0],i[1])}this.incremental&&(this.Pd=t,this.notClear=!0)}},e.prototype.findDataIndex=function(t,e){for(var n=this.shape,i=n.points,r=n.size,o=Math.max(r[0],4),a=Math.max(r[1],4),s=i.length/2-1;s>=0;s--){var l=2*s,c=i[l]-o/2,h=i[l+1]-a/2;if(t>=c&&e>=h&&t<=c+o&&e<=h+a)return s}return-1},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect();return t=n[0],e=n[1],i.contain(t,e)?(this.hoverDataIdx=this.findDataIndex(t,e))>=0:(this.hoverDataIdx=-1,!1)},e.prototype.getBoundingRect=function(){var t=this.gl;if(!t){for(var e=this.shape,n=e.points,i=e.size,r=i[0],o=i[1],a=1/0,s=1/0,l=-1/0,c=-1/0,h=0;h<n.length;){var u=n[h++],d=n[h++];a=Math.min(u,a),l=Math.max(u,l),s=Math.min(d,s),c=Math.max(d,c)}t=this.gl=new Jo(a-r/2,s-o/2,l-a+r,c-s+o)}return t},e}(fu),j$=function(){function t(){this.group=new Il}return t.prototype.updateData=function(t,e){this.xd();var n=this.Vd();n.setShape({points:t.getLayout("points")}),this.Bd(n,t,e)},t.prototype.updateLayout=function(t){var e=t.getLayout("points");this.group.eachChild(function(t){if(null!=t.startIndex){var n=2*(t.endIndex-t.startIndex),i=4*t.startIndex*2;e=new Float32Array(e.buffer,i,n)}t.setShape("points",e),t.reset()})},t.prototype.incrementalPrepareUpdate=function(t){this.xd()},t.prototype.incrementalUpdate=function(t,e,n){var i=this.Hd[0],r=e.getLayout("points"),o=i&&i.shape.points;if(o&&o.length<2e4){var a=o.length,s=new Float32Array(a+r.length);s.set(o),s.set(r,a),i.endIndex=t.end,i.setShape({points:s})}else{this.Hd=[];var l=this.Vd();l.startIndex=t.start,l.endIndex=t.end,l.incremental=!0,l.setShape({points:r}),this.Bd(l,e,n)}},t.prototype.eachRendered=function(t){this.Hd[0]&&t(this.Hd[0])},t.prototype.Vd=function(){var t=new W$({cursor:"default"});return t.ignoreCoarsePointer=!0,this.group.add(t),this.Hd.push(t),t},t.prototype.Bd=function(t,e,n){var i=e.hostModel;n=n||{};var r=e.getVisual("symbolSize");t.setShape("size",r instanceof Array?r:[r,r]),t.softClipShape=n.clipShape||null,t.symbolProxy=lx(e.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var o=t.shape.size[0]<4;t.useStyle(i.getModel("itemStyle").getItemStyle(o?["color","shadowBlur","shadowColor"]:["color"]));var a=e.getVisual("style"),s=a&&a.fill;s&&t.setColor(s);var l=Bu(t);l.seriesIndex=i.seriesIndex,t.on("mousemove",function(e){l.dataIndex=null;var n=t.hoverDataIdx;n>=0&&(l.dataIndex=n+(t.startIndex||0))})},t.prototype.remove=function(){this.xd()},t.prototype.xd=function(){this.Hd=[],this.group.removeAll()},t}(),G$=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n){var i=t.getData();this.Ud(i,t).updateData(i,{clipShape:this.Kd(t)}),this.da=!0},e.prototype.incrementalPrepareRender=function(t,e,n){var i=t.getData();this.Ud(i,t).incrementalPrepareUpdate(i),this.da=!1},e.prototype.incrementalRender=function(t,e,n){this.Yf.incrementalUpdate(t,e.getData(),{clipShape:this.Kd(e)}),this.da=t.end===e.getData().count()},e.prototype.updateTransform=function(t,e,n){var i=t.getData();if(this.group.dirty(),!this.da||i.count()>1e4)return{update:!0};var r=YT("").reset(t,e,n);r.progress&&r.progress({start:0,end:i.count(),count:i.count()},i),this.Yf.updateLayout(i)},e.prototype.eachRendered=function(t){this.Yf&&this.Yf.eachRendered(t)},e.prototype.Kd=function(t){if(t.get("clip",!0)){var e=t.coordinateSystem;return e&&e.getArea&&e.getArea(.1)}},e.prototype.Ud=function(t,e){var n=this.Yf,i=e.pipelineContext.large;return n&&i===this.gd||(n&&n.remove(),n=this.Yf=i?new j$:new $T,this.gd=i,this.group.removeAll()),this.group.add(n.group),n},e.prototype.remove=function(t,e){this.Yf&&this.Yf.remove(!0),this.Yf=null},e.prototype.dispose=function(){},e.type="scatter",e}(nb),X$={left:0,right:0,top:0,bottom:0},Y$=["25%","25%"],Z$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.mergeDefaultAndTheme=function(e,n){var i=dg(e.outerBounds);t.prototype.mergeDefaultAndTheme.apply(this,arguments),i&&e.outerBounds&&ug(e.outerBounds,i)},e.prototype.mergeOption=function(e,n){t.prototype.mergeOption.apply(this,arguments),this.option.outerBounds&&e.outerBounds&&ug(this.option.outerBounds,e.outerBounds)},e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"15%",top:65,right:"10%",bottom:80,containLabel:!1,outerBoundsMode:"auto",outerBounds:X$,outerBoundsContain:"all",outerBoundsClampWidth:Y$[0],outerBoundsClampHeight:Y$[1],backgroundColor:mg.color.transparent,borderWidth:1,borderColor:mg.color.neutral30},e}(pg),J$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",Sc).models[0]},e.type="cartesian2dAxis",e}(pg);or(J$,AC);var Q$={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:mg.color.axisLine,width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15],breakLine:!0},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12,color:mg.color.axisLabel,textMargin:[0,3]},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:mg.color.axisSplitLine,width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:[mg.color.backgroundTint,mg.color.backgroundTransparent]}},breakArea:{show:!0,itemStyle:{color:mg.color.neutral00,borderColor:mg.color.border,borderWidth:1,borderType:[3,3],opacity:.6},zigzagAmplitude:4,zigzagMinSpan:4,zigzagMaxSpan:20,zigzagZ:100,expandOnClick:!0},breakLabelLayout:{moveOverlap:"auto"}},tM=er({boundaryGap:!0,deduplication:null,jitter:0,jitterOverlap:!0,jitterMargin:2,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto",show:"auto"},axisLabel:{interval:"auto"}},Q$),eM=er({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:mg.color.axisMinorSplitLine,width:1}}},Q$);const nM={category:tM,value:eM,time:er({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},eM),log:ir({logBase:10},eM)};var iM={value:1,category:1,time:1,log:1};function rM(t,e,n,i){sr(iM,function(r,o){var a=er(er({},nM[o],!0),i,!0),s=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e+"Axis."+o,n}return Ei(n,t),n.prototype.mergeDefaultAndTheme=function(t,e){var n=hg(this),i=n?dg(t):{};er(t,e.getTheme().get(o+"Axis")),er(t,this.getDefaultOption()),t.type=oM(t),n&&ug(t,i,n)},n.prototype.optionUpdated=function(){"category"===this.option.type&&(this.__ordinalMeta=zS.createByAxisModel(this))},n.prototype.getCategories=function(t){var e=this.option;if("category"===e.type)return t?e.data:this.__ordinalMeta.categories},n.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},n.prototype.updateAxisBreaks=function(t){return{breaks:[]}},n.type=e+"Axis."+o,n.defaultOption=a,n}(n);t.registerComponentModel(s)}),t.registerSubTypeDefaulter(e+"Axis",oM)}function oM(t){return t.type||(t.data?"category":"value")}var aM=function(){function t(t){this.type="cartesian",this.Wd=[],this.Jl={},this.name=t||""}return t.prototype.getAxis=function(t){return this.Jl[t]},t.prototype.getAxes=function(){return lr(this.Wd,function(t){return this.Jl[t]},this)},t.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),hr(this.getAxes(),function(e){return e.scale.type===t})},t.prototype.addAxis=function(t){var e=t.dim;this.Jl[e]=t,this.Wd.push(e)},t}(),sM=["x","y"];function lM(t){return("interval"===t.type||"time"===t.type)&&!t.hasBreaks()}var cM=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="cartesian2d",e.dimensions=sM,e}return Ei(e,t),e.prototype.calcAffineTransform=function(){this.jd=this.qd=null;var t=this.getAxis("x").scale,e=this.getAxis("y").scale;if(lM(t)&&lM(e)){var n=t.getExtent(),i=e.getExtent(),r=this.dataToPoint([n[0],i[0]]),o=this.dataToPoint([n[1],i[1]]),a=n[1]-n[0],s=i[1]-i[0];if(a&&s){var l=(o[0]-r[0])/a,c=(o[1]-r[1])/s,h=r[0]-n[0]*l,u=r[1]-i[0]*c,d=this.jd=[l,0,0,c,h,u];this.qd=Po([],d)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var e=this.getAxis("x"),n=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&n.contain(n.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.containZone=function(t,e){var n=this.dataToPoint(t),i=this.dataToPoint(e),r=this.getArea(),o=new Jo(n[0],n[1],i[0]-n[0],i[1]-n[1]);return r.intersect(o)},e.prototype.dataToPoint=function(t,e,n){n=n||[];var i=t[0],r=t[1];if(this.jd&&null!=i&&isFinite(i)&&null!=r&&isFinite(r))return eo(n,t,this.jd);var o=this.getAxis("x"),a=this.getAxis("y");return n[0]=o.toGlobalCoord(o.dataToCoord(i,e)),n[1]=a.toGlobalCoord(a.dataToCoord(r,e)),n},e.prototype.clampData=function(t,e){var n=this.getAxis("x").scale,i=this.getAxis("y").scale,r=n.getExtent(),o=i.getExtent(),a=n.parse(t[0]),s=i.parse(t[1]);return(e=e||[])[0]=Math.min(Math.max(Math.min(r[0],r[1]),a),Math.max(r[0],r[1])),e[1]=Math.min(Math.max(Math.min(o[0],o[1]),s),Math.max(o[0],o[1])),e},e.prototype.pointToData=function(t,e,n){if(n=n||[],this.qd)return eo(n,t,this.qd);var i=this.getAxis("x"),r=this.getAxis("y");return n[0]=i.coordToData(i.toLocalCoord(t[0]),e),n[1]=r.coordToData(r.toLocalCoord(t[1]),e),n},e.prototype.getOtherAxis=function(t){return this.getAxis("x"===t.dim?"y":"x")},e.prototype.getArea=function(t){t=t||0;var e=this.getAxis("x").getGlobalExtent(),n=this.getAxis("y").getGlobalExtent(),i=Math.min(e[0],e[1])-t,r=Math.min(n[0],n[1])-t,o=Math.max(e[0],e[1])-i+t,a=Math.max(n[0],n[1])-r+t;return new Jo(i,r,o,a)},e}(aM),hM=function(t){function e(e,n,i,r,o){var a=t.call(this,e,n,i)||this;return a.index=0,a.type=r||"value",a.position=o||"bottom",a}return Ei(e,t),e.prototype.isHorizontal=function(){var t=this.position;return"top"===t||"bottom"===t},e.prototype.getGlobalExtent=function(t){var e=this.getExtent();return e[0]=this.toGlobalCoord(e[0]),e[1]=this.toGlobalCoord(e[1]),t&&e[0]>e[1]&&e.reverse(),e},e.prototype.pointToData=function(t,e){return this.coordToData(this.toLocalCoord(t["x"===this.dim?0:1]),e)},e.prototype.setCategorySortInfo=function(t){if("category"!==this.type)return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}(WC),uM=Math.PI,dM=[[1,2,1,2],[5,3,5,3],[8,3,8,3]],fM=[[0,1,0,1],[0,3,0,3],[0,3,0,3]],pM=yc(),mM=yc(),gM=function(){function t(t){this.recordMap={},this.resolveAxisNameOverlap=t}return t.prototype.ensureRecord=function(t){var e=t.axis.dim,n=t.componentIndex,i=this.recordMap,r=i[e]||(i[e]=[]);return r[n]||(r[n]={ready:{}})},t}(),vM=[1,0,0,1,0,0],yM=new Jo(0,0,0,0),bM=function(t,e,n,i,r,o){if(TC(t.nameLocation)){var a=o.stOccupiedRect;a&&xM(function(t,e,n){return t.transform=Rp(t.transform,n),t.localRect=kp(t.localRect,e),t.rect=kp(t.rect,e),n&&t.rect.applyTransform(n),t.axisAligned=Ap(n),t.obb=void 0,(t.label=t.label||{}).ignore=!1,t}({},a,o.transGroup.transform),i,r)}else wM(o.labelInfoList,o.dirVec,i,r)};function xM(t,e,n){var i=new zo;gT(t,e,i,{direction:Math.atan2(n.y,n.x),bidirectional:!1,touchThreshold:.05})&&function(t,e){if(t){t.label.x+=e.x,t.label.y+=e.y,t.label.markRedraw();var n=t.transform;n&&(n[4]+=e.x,n[5]+=e.y);var i=t.rect;i&&(i.x+=e.x,i.y+=e.y);var r=t.obb;r&&r.fromBoundingRect(t.localRect,n)}}(e,i)}function wM(t,e,n,i){for(var r=zo.dot(i,e)>=0,o=0,a=t.length;o<a;o++){var s=t[r?o:a-1-o];s.label.ignore||xM(s,n,i)}}var SM=function(){function t(t,e,n,i){this.group=new Il,this.Gd=t,this.Mc=e,this.Xd={},this.Yd=i||new gM(bM),this.Jd(n)}return t.prototype.updateCfg=function(t){var e=this.Zd.raw;e.position=t.position,e.labelOffset=t.labelOffset,this.Jd(e)},t.prototype.__getRawCfg=function(){return this.Zd.raw},t.prototype.Jd=function(t){var e=this.Gd,n=e.getDefaultOption?e.getDefaultOption():{},i=Ar(t.axisName,e.get("name")),r=e.get("nameMoveOverlap");null!=r&&"auto"!==r||(r=Ar(t.defaultNameMoveOverlap,!0));var o={raw:t,position:t.position,rotation:t.rotation,nameDirection:Ar(t.nameDirection,1),tickDirection:Ar(t.tickDirection,1),labelDirection:Ar(t.labelDirection,1),labelOffset:Ar(t.labelOffset,0),silent:Ar(t.silent,!0),axisName:i,nameLocation:Nr(e.get("nameLocation"),n.nameLocation,"end"),shouldNameMoveOverlap:FM(i)&&r,optionHideOverlap:e.get(["axisLabel","hideOverlap"]),showMinorTicks:e.get(["minorTick","show"])};this.Zd=o;var a=new Il({x:o.position[0],y:o.position[1],rotation:o.rotation});a.updateTransform(),this.Qd=a;var s=this.Yd.ensureRecord(e);s.transGroup=this.Qd,s.dirVec=new zo(Math.cos(-o.rotation),Math.sin(-o.rotation))},t.prototype.build=function(t,e){var n=this;return t||(t={axisLine:!0,axisTickLabelEstimate:!1,axisTickLabelDetermine:!0,axisName:!0}),sr(CM,function(i){t[i]&&TM[i](n.Zd,n.Xd,n.Yd,n.Gd,n.group,n.Qd,n.Mc,e||{})}),this},t.innerTextLayout=function(t,e,n){var i,r,o=jl(e-t);return Gl(o)?(r=n>0?"top":"bottom",i="center"):Gl(o-uM)?(r=n>0?"bottom":"top",i="center"):(r="middle",i=o>0&&o<uM?n>0?"right":"left":n>0?"left":"right"),{rotation:o,textAlign:i,textVerticalAlign:r}},t.makeAxisEventDataBase=function(t){var e={componentType:t.mainType,componentIndex:t.componentIndex};return e[t.mainType+"Index"]=t.componentIndex,e},t.isLabelSilent=function(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show)},t}(),CM=["axisLine","axisTickLabelEstimate","axisTickLabelDetermine","axisName"],TM={axisLine:function(t,e,n,i,r,o,a){var s=i.get(["axisLine","show"]);if("auto"===s&&(s=!0,null!=t.raw.axisLineAutoShow&&(s=!!t.raw.axisLineAutoShow)),s){var l=i.axis.getExtent(),c=o.transform,h=[l[0],0],u=[l[1],0],d=h[0]>u[0];c&&(eo(h,h,c),eo(u,u,c));var f=nr({lineCap:"round"},i.getModel(["axisLine","lineStyle"]).getLineStyle()),p={strokeContainThreshold:t.raw.strokeContainThreshold||5,silent:!0,z2:1,style:f};if(i.get(["axisLine","breakLine"])&&i.axis.scale.hasBreaks())null.buildAxisBreakLine(i,r,o,p);else{var m=new Af(nr({shape:{x1:h[0],y1:h[1],x2:u[0],y2:u[1]}},p));fp(m.shape,m.style.lineWidth),m.anid="line",r.add(m)}var g=i.get(["axisLine","symbol"]);if(null!=g){var v=i.get(["axisLine","symbolSize"]);vr(g)&&(g=[g,g]),(vr(v)||br(v))&&(v=[v,v]);var y=hx(i.get(["axisLine","symbolOffset"])||0,v),b=v[0],x=v[1];sr([{rotate:t.rotation+Math.PI/2,offset:y[0],r:0},{rotate:t.rotation-Math.PI/2,offset:y[1],r:Math.sqrt((h[0]-u[0])*(h[0]-u[0])+(h[1]-u[1])*(h[1]-u[1]))}],function(e,n){if("none"!==g[n]&&null!=g[n]){var i=lx(g[n],-b/2,-x/2,b,x,f.stroke,!0),o=e.r+e.offset,a=d?u:h;i.attr({rotation:e.rotate,x:a[0]+o*Math.cos(t.rotation),y:a[1]-o*Math.sin(t.rotation),silent:!0,z2:11}),r.add(i)}})}}},axisTickLabelEstimate:function(t,e,n,i,r,o,a,s){NM(e,r,s)&&$M(t,e,n,i,r,o,a,1)},axisTickLabelDetermine:function(t,e,n,i,r,o,a,s){NM(e,r,s)&&$M(t,e,n,i,r,o,a,2);var l=function(t,e,n,i){var r=i.axis,o=i.getModel("axisTick"),a=o.get("show");if("auto"===a&&(a=!0,null!=t.raw.axisTickAutoShow&&(a=!!t.raw.axisTickAutoShow)),!a||r.scale.isBlank())return[];for(var s=o.getModel("lineStyle"),l=t.tickDirection*o.get("length"),c=AM(r.getTicksCoords(),n.transform,l,ir(s.getLineStyle(),{stroke:i.get(["axisLine","lineStyle","color"])}),"ticks"),h=0;h<c.length;h++)e.add(c[h]);return c}(t,r,o,i);!function(t,e,n){t.showMinorTicks||sr(e,function(t){if(t&&t.label.ignore)for(var e=0;e<n.length;e++){var i=n[e],r=mM(i),o=pM(t.label);if(null!=r.tickValue&&!r.onBand&&r.tickValue===o.tickValue)return void MM(i)}})}(t,e.labelLayoutList,l),function(t,e,n,i,r){var o=i.axis,a=i.getModel("minorTick");if(t.showMinorTicks&&!o.scale.isBlank()){var s=o.getMinorTicksCoords();if(s.length)for(var l=a.getModel("lineStyle"),c=r*a.get("length"),h=ir(l.getLineStyle(),ir(i.getModel("axisTick").getLineStyle(),{stroke:i.get(["axisLine","lineStyle","color"])})),u=0;u<s.length;u++)for(var d=AM(s[u],n.transform,c,h,"minorticks_"+u),f=0;f<d.length;f++)e.add(d[f])}}(t,r,o,i,t.tickDirection)},axisName:function(t,e,n,i,r,o,a,s){var l=n.ensureRecord(i);e.nameEl&&(r.remove(e.nameEl),e.nameEl=l.nameLayout=l.nameLocation=null);var c=t.axisName;if(FM(c)){var h=t.nameLocation,u=t.nameDirection,d=i.getModel("nameTextStyle"),f=i.get("nameGap")||0,p=i.axis.getExtent(),m=i.axis.inverse?-1:1,g=new zo(0,0),v=new zo(0,0);"start"===h?(g.x=p[0]-m*f,v.x=-m):"end"===h?(g.x=p[1]+m*f,v.x=m):(g.x=(p[0]+p[1])/2,g.y=t.labelOffset+u*f,v.y=u);var y=[1,0,0,1,0,0];v.transform(Do(y,y,t.rotation));var b,x,w=i.get("nameRotate");null!=w&&(w=w*uM/180),TC(h)?b=SM.innerTextLayout(t.rotation,null!=w?w:t.rotation,u):(b=function(t,e,n,i){var r,o,a=jl(n-t),s=i[0]>i[1],l="start"===e&&!s||"start"!==e&&s;return Gl(a-uM/2)?(o=l?"bottom":"top",r="center"):Gl(a-1.5*uM)?(o=l?"top":"bottom",r="center"):(o="middle",r=a<1.5*uM&&a>uM/2?l?"left":"right":l?"right":"left"),{rotation:a,textAlign:r,textVerticalAlign:o}}(t.rotation,h,w||0,p),null!=(x=t.raw.axisNameAvailableWidth)&&(x=Math.abs(x/Math.sin(b.rotation)),!isFinite(x)&&(x=null)));var S=d.getFont(),C=i.get("nameTruncate",!0)||{},T=C.ellipsis,$=Mr(t.raw.nameTruncateMaxWidth,C.maxWidth,x),M=s.nameMarginLevel||0,A=new ku({x:g.x,y:g.y,rotation:b.rotation,silent:SM.isLabelSilent(i),style:Op(d,{text:c,font:S,overflow:"truncate",width:$,ellipsis:T,fill:d.getTextColor()||i.get(["axisLine","lineStyle","color"]),align:d.get("align")||b.textAlign,verticalAlign:d.get("verticalAlign")||b.textVerticalAlign}),z2:1});if(Tp({el:A,componentModel:i,itemName:c}),A.__fullText=c,A.anid="name",i.get("triggerEvent")){var N=SM.makeAxisEventDataBase(i);N.targetType="axisName",N.name=c,Bu(A).eventData=N}o.add(A),A.updateTransform(),e.nameEl=A;var k=l.nameLayout=uT({label:A,priority:A.z2,defaultAttr:{ignore:A.ignore},marginDefault:TC(h)?dM[M]:fM[M]});if(l.nameLocation=h,r.add(A),A.decomposeTransform(),t.shouldNameMoveOverlap&&k){var R=n.ensureRecord(i);n.resolveAxisNameOverlap(t,n,i,k,v,R)}}}};function $M(t,e,n,i,r,o,a,s){kM(e)||function(t,e,n,i,r,o){var a=r.axis,s=Mr(t.raw.axisLabelShow,r.get(["axisLabel","show"])),l=new Il;n.add(l);var c=FC(i);if(s&&!a.scale.isBlank()){var h=r.getModel("axisLabel"),u=a.getViewLabels(c),d=(Mr(t.raw.labelRotate,h.get("rotate"))||0)*uM/180,f=SM.innerTextLayout(t.rotation,d,t.labelDirection),p=r.getCategories&&r.getCategories(!0),m=[],g=r.get("triggerEvent"),v=1/0,y=-1/0;sr(u,function(t,e){var n,i="ordinal"===a.scale.type?a.scale.getRawOrdinalNumber(t.tickValue):t.tickValue,s=t.formattedLabel,c=t.rawLabel,d=h;if(p&&p[i]){var b=p[i];xr(b)&&b.textStyle&&(d=new im(b.textStyle,h,r.ecModel))}var x=d.getTextColor()||r.get(["axisLine","lineStyle","color"]),w=d.getShallow("align",!0)||f.textAlign,S=Ar(d.getShallow("alignMinLabel",!0),w),C=Ar(d.getShallow("alignMaxLabel",!0),w),T=d.getShallow("verticalAlign",!0)||d.getShallow("baseline",!0)||f.textVerticalAlign,$=Ar(d.getShallow("verticalAlignMinLabel",!0),T),M=Ar(d.getShallow("verticalAlignMaxLabel",!0),T),A=10+((null===(n=t.time)||void 0===n?void 0:n.level)||0);v=Math.min(v,A),y=Math.max(y,A);var N=new ku({x:0,y:0,rotation:0,silent:SM.isLabelSilent(r),z2:A,style:Op(d,{text:s,align:0===e?S:e===u.length-1?C:w,verticalAlign:0===e?$:e===u.length-1?M:T,fill:gr(x)?x("category"===a.type?c:"value"===a.type?i+"":i,e):x})});N.anid="label_"+i;var k=pM(N);if(k.break=t.break,k.tickValue=i,k.layoutRotation=f.rotation,Tp({el:N,componentModel:r,itemName:s,formatterParamsExtra:{isTruncated:function(){return N.isTruncated},value:c,tickIndex:e}}),g){var R=SM.makeAxisEventDataBase(r);R.targetType="axisLabel",R.value=c,R.tickIndex=e,t.break&&(R.break={start:t.break.parsedBreak.vmin,end:t.break.parsedBreak.vmax}),"category"===a.type&&(R.dataIndex=i),Bu(N).eventData=R,t.break&&function(t,e,n,i){n.on("click",function(n){var r={type:"expandAxisBreak",breaks:[{start:i.parsedBreak.breakOption.start,end:i.parsedBreak.breakOption.end}]};r[t.axis.dim+"AxisIndex"]=t.componentIndex,e.dispatchAction(r)})}(r,o,N,t.break)}m.push(N),l.add(N)}),RM(e,lr(m,function(t){return{label:t,priority:pM(t).break?t.z2+(y-v+1):t.z2,defaultAttr:{ignore:t.ignore}}}),l,c)}else RM(e,[],l,c)}(t,e,r,s,i,a);var l=e.labelLayoutList;!function(t,e,n,i){var r=e.get(["axisLabel","margin"]);sr(n,function(n,o){var a=uT(n);if(a){var s=a.label,l=pM(s);a.suggestIgnore=s.ignore,s.ignore=!1,cl(_M,IM),_M.x=e.axis.dataToCoord(l.tickValue),_M.y=t.labelOffset+t.labelDirection*r,_M.rotation=l.layoutRotation,i.add(_M),_M.updateTransform(),i.remove(_M),_M.decomposeTransform(),cl(s,_M),s.markRedraw(),cT(a,!0),uT(a)}})}(t,i,l,o),t.rotation;var c=t.optionHideOverlap;!function(t,e,n){if(!CC(t.axis)){var i=t.get(["axisLabel","showMinLabel"]),r=t.get(["axisLabel","showMaxLabel"]),o=e.length;a(i,0,1),a(r,o-1,o-2)}function a(t,i,r){var o=uT(e[i]),a=uT(e[r]);if(o&&a)if(!1===t||o.suggestIgnore)MM(o.label);else if(a.suggestIgnore)MM(a.label);else{if(!n){var s=[0,0,0,0];o=pT({marginForce:s},o),a=pT({marginForce:s},a)}gT(o,a,null,{touchThreshold:.1})&&MM(t?a.label:o.label)}}}(i,l,c),c&&function(t){var e=[];function n(t){if(!t.ignore){var e=t.ensureState("emphasis");null==e.ignore&&(e.ignore=!1)}t.ignore=!0}t.sort(function(t,e){return(e.suggestIgnore?1:0)-(t.suggestIgnore?1:0)||e.priority-t.priority});for(var i=0;i<t.length;i++){var r=uT(t[i]);if(!r.label.ignore){for(var o=r.label,a=r.labelLine,s=!1,l=0;l<e.length;l++)if(gT(r,e[l],null,{touchThreshold:.05})){s=!0;break}s?(n(o),a&&n(a)):e.push(r)}}}(hr(l,function(t){return t&&!t.label.ignore})),function(t,e,n,i){var r,o=n.axis,a=e.ensureRecord(n),s=[],l=FM(t.axisName)&&TC(t.nameLocation);sr(i,function(t){var e=uT(t);if(e&&!e.label.ignore){s.push(e);var n=a.transGroup;l&&(n.transform?Po(vM,n.transform):_o(vM),e.transform&&Fo(vM,vM,e.transform),Jo.copy(yM,e.localRect),yM.applyTransform(vM),r?r.union(yM):Jo.copy(r=new Jo(0,0,0,0),yM))}});var c=Math.abs(a.dirVec.x)>.1?"x":"y",h=a.transGroup[c];if(s.sort(function(t,e){return Math.abs(t.label[c]-h)-Math.abs(e.label[c]-h)}),l&&r){var u=o.getExtent(),d=Math.min(u[0],u[1]),f=Math.max(u[0],u[1])-d;r.union(new Jo(d,0,f,1))}a.stOccupiedRect=r,a.labelInfoList=s}(t,n,i,l)}function MM(t){t&&(t.ignore=!0)}function AM(t,e,n,i,r){for(var o=[],a=[],s=[],l=0;l<t.length;l++){var c=t[l].coord;a[0]=c,a[1]=0,s[0]=c,s[1]=n,e&&(eo(a,a,e),eo(s,s,e));var h=new Af({shape:{x1:a[0],y1:a[1],x2:s[0],y2:s[1]},style:i,z2:2,autoBatch:!0,silent:!0});fp(h.shape,h.style.lineWidth),h.anid=r+"_"+t[l].tickValue,o.push(h);var u=mM(h);u.onBand=!!t[l].onBand,u.tickValue=t[l].tickValue}return o}function NM(t,e,n){if(kM(t)){var i=t.axisLabelsCreationContext.out.noPxChangeTryDetermine;if(n.noPxChange){for(var r=!0,o=0;o<i.length;o++)r=r&&i[o]();if(r)return!1}i.length&&(e.remove(t.labelGroup),RM(t,null,null,null))}return!0}function kM(t){return!!t.labelLayoutList}function RM(t,e,n,i){t.labelLayoutList=e,t.labelGroup=n,t.axisLabelsCreationContext=i}var _M=new $u,IM=new $u;function FM(t){return!!t}function EM(t,e,n){n=n||{};var i=e.axis,r={},o=i.getAxesOnZeroOf()[0],a=i.position,s=o?"onZero":a,l=i.dim,c=[t.x,t.x+t.width,t.y,t.y+t.height],h={left:0,right:1,top:0,bottom:1,onZero:2},u=e.get("offset")||0,d="x"===l?[c[2]-u,c[3]+u]:[c[0]-u,c[1]+u];if(o){var f=o.toGlobalCoord(o.dataToCoord(0));d[h.onZero]=Math.max(Math.min(f,d[1]),d[0])}r.position=["y"===l?d[h[s]]:c[0],"x"===l?d[h[s]]:c[3]],r.rotation=Math.PI/2*("x"===l?0:1),r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,left:-1,right:1}[a],r.labelOffset=o?d[h[a]]-d[h.onZero]:0,e.get(["axisTick","inside"])&&(r.tickDirection=-r.tickDirection),Mr(n.labelInside,e.get(["axisLabel","inside"]))&&(r.labelDirection=-r.labelDirection);var p=e.get(["axisLabel","rotate"]);return r.labelRotate="top"===s?-p:p,r.z2=1,r}function DM(t){var e={xAxisModel:null,yAxisModel:null};return sr(e,function(n,i){var r=i.replace(/Model$/,""),o=t.getReferringComponents(r,Sc).models[0];e[i]=o}),e}function LM(t,e,n){var i=HS.prototype,r=i.getTicks.call(n),o=i.getTicks.call(n,{expandToNicedExtent:!0}),a=r.length-1,s=i.getInterval.call(n),l=yC(t,e),c=l.extent,h=l.fixMin,u=l.fixMax;"log"===t.type&&(c=DS(t.base,c,!0)),t.setBreaksFromOption(MC(e)),t.setExtent(c[0],c[1]),t.calcNiceExtent({splitNumber:a,fixMin:h,fixMax:u});var d=i.getExtent.call(t);h&&(c[0]=d[0]),u&&(c[1]=d[1]);var f=i.getInterval.call(t),p=c[0],m=c[1];if(h&&u)f=(m-p)/a;else if(h)for(m=c[0]+f*a;m<c[1]&&isFinite(m)&&isFinite(c[1]);)f=NS(f),m=c[0]+f*a;else if(u)for(p=c[1]-f*a;p>c[0]&&isFinite(p)&&isFinite(c[0]);)f=NS(f),p=c[1]-f*a;else{t.getTicks().length-1>a&&(f=NS(f));var g=f*a;(p=Ul((m=Math.ceil(c[1]/f)*f)-g))<0&&c[0]>=0?(p=0,m=Ul(g)):m>0&&c[1]<=0&&(m=0,p=-Ul(g))}var v=(r[0].value-o[0].value)/s,y=(r[a].value-o[a].value)/s;i.setExtent.call(t,p+f*v,m+f*y),i.setInterval.call(t,f),(v||y)&&i.setNiceExtent.call(t,p+f,m-f)}var PM=[[3,1],[0,2]],zM=function(){function t(t,e,n){this.type="grid",this.tm={},this.nm=[],this.im={},this.rm=[],this.axisPointerEnabled=!0,this.dimensions=sM,this.sm(t,e,n),this.model=t}return t.prototype.getRect=function(){return this.gl},t.prototype.update=function(t,e){var n=this.im;function i(t){var e,n=dr(t),i=n.length;if(i){for(var r=[],o=i-1;o>=0;o--){var a=t[+n[o]],s=a.model,l=a.scale;AS(l)&&s.get("alignTicks")&&null==s.get("interval")?r.push(a):(bC(l,s),AS(l)&&(e=a))}r.length&&(e||bC((e=r.pop()).scale,e.model),sr(r,function(t){LM(t.scale,t.model,e.scale)}))}}this.om(t,this.model),i(n.x),i(n.y);var r={};sr(n.x,function(t){BM(n,"y",t,r)}),sr(n.y,function(t){BM(n,"x",t,r)}),this.resize(this.model,e)},t.prototype.resize=function(t,e,n){var i=cg(t,e),r=this.gl=lg(t.getBoxLayoutParams(),i.refContainer),o=this.im,a=this.nm,s=t.get("containLabel");if(HM(o,r),!n){var l=function(t,e,n,i,r){var o=new gM(WM);return sr(n,function(n){return sr(n,function(n){if($C(n.model)){var a=!i;n.axisBuilder=function(t,e,n,i,r,o){for(var a=EM(t,n),s=!1,l=!1,c=0;c<e.length;c++)AS(e[c].getOtherAxis(n.axis).scale)&&(s=l=!0,"category"===n.axis.type&&n.axis.onBand&&(l=!1));return a.axisLineAutoShow=s,a.axisTickAutoShow=l,a.defaultNameMoveOverlap=o,new SM(n,i,a,r)}(t,e,n.model,r,o,a)}})}),o}(r,a,o,s,e),c=void 0;if(s)c=qM(r.clone(),"axisLabel",null,r,o,l,i);else{var h=function(t,e,n){var i,r=t.get("outerBoundsMode",!0);"same"===r?i=e.clone():null!=r&&"auto"!==r||(i=lg(t.get("outerBounds",!0)||X$,n.refContainer));var o=t.get("outerBoundsContain",!0);return{outerBoundsRect:i,parsedOuterBoundsContain:null==o||"auto"===o||rr(["all","axisLabel"],o)<0?"all":o,outerBoundsClamp:[Hl(Ar(t.get("outerBoundsClampWidth",!0),Y$[0]),e.width),Hl(Ar(t.get("outerBoundsClampHeight",!0),Y$[1]),e.height)]}}(t,r,i),u=h.outerBoundsRect,d=h.parsedOuterBoundsContain,f=h.outerBoundsClamp;u&&(c=qM(u,d,f,r,o,l,i))}KM(r,o,2,null,c,i)}sr(this.nm,function(t){t.calcAffineTransform()})},t.prototype.getAxis=function(t,e){var n=this.im[t];if(null!=n)return n[e||0]},t.prototype.getAxes=function(){return this.rm.slice()},t.prototype.getCartesian=function(t,e){if(null!=t&&null!=e){var n="x"+t+"y"+e;return this.tm[n]}xr(t)&&(e=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,r=this.nm;i<r.length;i++)if(r[i].getAxis("x").index===t||r[i].getAxis("y").index===e)return r[i]},t.prototype.getCartesians=function(){return this.nm.slice()},t.prototype.convertToPixel=function(t,e,n){var i=this.am(e);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},t.prototype.convertFromPixel=function(t,e,n){var i=this.am(e);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},t.prototype.am=function(t){var e,n,i=t.seriesModel,r=t.xAxisModel||i&&i.getReferringComponents("xAxis",Sc).models[0],o=t.yAxisModel||i&&i.getReferringComponents("yAxis",Sc).models[0],a=t.gridModel,s=this.nm;return i?rr(s,e=i.coordinateSystem)<0&&(e=null):r&&o?e=this.getCartesian(r.componentIndex,o.componentIndex):r?n=this.getAxis("x",r.componentIndex):o?n=this.getAxis("y",o.componentIndex):a&&a.coordinateSystem===this&&(e=this.nm[0]),{cartesian:e,axis:n}},t.prototype.containPoint=function(t){var e=this.nm[0];if(e)return e.containPoint(t)},t.prototype.sm=function(t,e,n){var i=this,r=this,o={left:!1,right:!1,top:!1,bottom:!1},a={x:{},y:{}},s={x:0,y:0};if(e.eachComponent("xAxis",l("x"),this),e.eachComponent("yAxis",l("y"),this),!s.x||!s.y)return this.im={},void(this.rm=[]);function l(e){return function(n,i){if(OM(n,t)){var l=n.get("position");"x"===e?"top"!==l&&"bottom"!==l&&(l=o.bottom?"top":"bottom"):"left"!==l&&"right"!==l&&(l=o.left?"right":"left"),o[l]=!0;var c=new hM(e,function(t,e){if(e=e||t.get("type"))switch(e){case"category":return new BS({ordinalMeta:t.getOrdinalMeta?t.getOrdinalMeta():t.getCategories(),extent:[1/0,-1/0]});case"time":return new QS({locale:t.ecModel.getLocaleModel(),useUTC:t.ecModel.get("useUTC")});default:return new(LS.getClass(e)||HS)}}(n),[0,0],n.get("type"),l),h="category"===c.type;c.onBand=h&&n.get("boundaryGap"),c.inverse=n.get("inverse"),n.axis=c,c.model=n,c.grid=r,c.index=i,r.rm.push(c),a[e][i]=c,s[e]++}}}this.im=a,sr(a.x,function(e,n){sr(a.y,function(r,o){var a="x"+n+"y"+o,s=new cM(a);s.master=i,s.model=t,i.tm[a]=s,i.nm.push(s),s.addAxis(e),s.addAxis(r)})})},t.prototype.om=function(t,e){function n(t,e){sr(function(t,e){var n={};return sr(t.mapDimensionsAll(e),function(e){n[function(t,e){return $S(t,e)?t.getCalculationInfo("stackResultDimension"):e}(t,e)]=!0}),dr(n)}(t,e.dim),function(n){e.scale.unionExtentFromData(t,n)})}sr(this.rm,function(t){if(t.scale.setExtent(1/0,-1/0),"category"===t.type){var e=t.model.get("categorySortInfo");t.scale.setSortInfo(e)}}),t.eachSeries(function(t){if(function(t){return t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type}(t)){var i=DM(t),r=i.xAxisModel,o=i.yAxisModel;if(!OM(r,e)||!OM(o,e))return;var a=this.getCartesian(r.componentIndex,o.componentIndex),s=t.getData(),l=a.getAxis("x"),c=a.getAxis("y");n(s,l),n(s,c)}},this)},t.prototype.getTooltipAxes=function(t){var e=[],n=[];return sr(this.getCartesians(),function(i){var r=null!=t&&"auto"!==t?i.getAxis(t):i.getBaseAxis(),o=i.getOtherAxis(r);rr(e,r)<0&&e.push(r),rr(n,o)<0&&n.push(o)}),{baseAxes:e,otherAxes:n}},t.create=function(e,n){var i=[];return e.eachComponent("grid",function(r,o){var a=new t(r,e,n);a.name="grid_"+o,a.resize(r,n,!0),r.coordinateSystem=a,i.push(a)}),e.eachSeries(function(t){!function(t){var e=t.targetModel,n=t.coordSysType,i=t.coordSysProvider,r=t.isDefaultDataCoordSys,o=function(t){var e=t.getShallow("coordinateSystem"),n=t.getShallow("coordinateSystemUsage",!0),i=0;if(e){var r="series"===t.mainType;null==n&&(n=r?"data":"box"),"data"===n?(i=1,r||(i=0)):"box"===n&&(i=2,r||function(t){return!!Qm[t]}(e)||(i=0))}return{coordSysType:e,kind:i}}(e),a=o.kind,s=o.coordSysType;if(r&&1!==a&&(a=1,s=n),0===a||s!==n)return!1;var l=i(n,e);l&&(1===a?e.coordinateSystem=l:e.boxCoordinateSystem=l)}({targetModel:t,coordSysType:"cartesian2d",coordSysProvider:function(){var e=DM(t),n=e.xAxisModel,i=e.yAxisModel;return n.getCoordSysModel().coordinateSystem.getCartesian(n.componentIndex,i.componentIndex)}})}),i},t.dimensions=sM,t}();function OM(t,e){return t.getCoordSysModel()===e}function BM(t,e,n,i){n.getAxesOnZeroOf=function(){return r?[r]:[]};var r,o=t[e],a=n.model,s=a.get(["axisLine","onZero"]),l=a.get(["axisLine","onZeroAxisIndex"]);if(s){if(null!=l)VM(o[l])&&(r=o[l]);else for(var c in o)if(o.hasOwnProperty(c)&&VM(o[c])&&!i[h(o[c])]){r=o[c];break}r&&(i[h(r)]=!0)}function h(t){return t.dim+"_"+t.index}}function VM(t){return t&&"category"!==t.type&&"time"!==t.type&&function(t){var e=t.scale.getExtent(),n=e[0],i=e[1];return!(n>0&&i>0||n<0&&i<0)}(t)}function HM(t,e){sr(t.x,function(t){return UM(t,e.x,e.width)}),sr(t.y,function(t){return UM(t,e.y,e.height)})}function UM(t,e,n){var i=[0,n],r=t.inverse?1:0;t.setExtent(i[r],i[1-r]),function(t,e){var n=t.getExtent(),i=n[0]+n[1];t.toGlobalCoord="x"===t.dim?function(t){return t+e}:function(t){return i-t+e},t.toLocalCoord="x"===t.dim?function(t){return t-e}:function(t){return i-t+e}}(t,e)}function qM(t,e,n,i,r,o,a){KM(i,r,1,e,!1,a);var s=[0,0,0,0];c(0),c(1),h(i,0,NaN),h(i,1,NaN);var l=null==ur(s,function(t){return t>0});return wp(i,s,!0,!0,n),HM(r,i),l;function c(t){sr(r[op[t]],function(e){if($C(e.model)){var n=o.ensureRecord(e.model),i=n.labelInfoList;if(i)for(var r=0;r<i.length;r++){var a=i[r],s=e.scale.normalize(pM(a.label).tickValue);s=1===t?1-s:s,h(a.rect,t,s),h(a.rect,1-t,NaN)}var l=n.nameLayout;l&&(s=TC(n.nameLocation)?.5:NaN,h(l.rect,t,s),h(l.rect,1-t,NaN))}})}function h(e,n,i){var r=t[op[n]]-e[op[n]],o=e[ap[n]]+e[op[n]]-(t[ap[n]]+t[op[n]]);r=u(r,1-i),o=u(o,i);var a=PM[n][0],l=PM[n][1];s[a]=zl(s[a],r),s[l]=zl(s[l],o)}function u(t,e){return t>0&&!$r(e)&&e>1e-4&&(t/=e),t}}function KM(t,e,n,i,r,o){var a=2===n;sr(e,function(e){return sr(e,function(e){$C(e.model)&&(function(t,e,n){var i=EM(e,n);t.updateCfg(i)}(e.axisBuilder,t,e.model),e.axisBuilder.build(a?{axisTickLabelDetermine:!0}:{axisTickLabelEstimate:!0},{noPxChange:r}))})});var s={x:0,y:0};function l(e){s[op[1-e]]=t[ap[e]]<=.5*o.refContainer[ap[e]]?0:1-e==1?2:1}l(0),l(1),sr(e,function(t,e){return sr(t,function(t){$C(t.model)&&(("all"===i||a)&&t.axisBuilder.build({axisName:!0},{nameMarginLevel:s[e]}),a&&t.axisBuilder.build({axisLine:!0}))})})}var WM=function(t,e,n,i,r,o){var a="x"===n.axis.dim?"y":"x";bM(t,0,0,i,r,o),TC(t.nameLocation)||sr(e.recordMap[a],function(t){t&&t.labelInfoList&&t.dirVec&&wM(t.labelInfoList,t.dirVec,i,r)})};function jM(t,e){return"all"===t||mr(t)&&rr(t,e)>=0||t===e}function GM(t){var e=(t.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[YM(t)]}function XM(t){return!!t.get(["handle","show"])}function YM(t){return t.type+"||"+t.id}var ZM={},JM=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(e,n,i,r){this.axisPointerClass&&function(t){var e=GM(t);if(e){var n=e.axisPointerModel,i=e.axis.scale,r=n.option,o=n.get("status"),a=n.get("value");null!=a&&(a=i.parse(a));var s=XM(n);null==o&&(r.status=s?"show":"hide");var l=i.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==a||a>l[1])&&(a=l[1]),a<l[0]&&(a=l[0]),r.value=a,s&&(r.status=e.axis.scale.isBlank()?"hide":"show")}}(e),t.prototype.render.apply(this,arguments),this.lm(e,i,!0)},e.prototype.updateAxisPointer=function(t,e,n,i){this.lm(t,n,!1)},e.prototype.remove=function(t,e){var n=this.hm;n&&n.remove(e)},e.prototype.dispose=function(e,n){this.um(n),t.prototype.dispose.apply(this,arguments)},e.prototype.lm=function(t,n,i){var r=e.getAxisPointerClass(this.axisPointerClass);if(r){var o=function(t){var e=GM(t);return e&&e.axisPointerModel}(t);o?(this.hm||(this.hm=new r)).render(t,o,n,i):this.um(n)}},e.prototype.um=function(t){this.hm&&this.hm.dispose(t),this.hm=null},e.registerAxisPointerClass=function(t,e){ZM[t]=e},e.getAxisPointerClass=function(t){return t&&ZM[t]},e.type="axis",e}(Jy),QM=yc(),tA=["splitArea","splitLine","minorSplitLine","breakArea"],eA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.axisPointerClass="CartesianAxisPointer",n}return Ei(e,t),e.prototype.render=function(e,n,i,r){this.group.removeAll();var o=this.fm;this.fm=new Il,this.group.add(this.fm),$C(e)&&(this.fm.add(e.axis.axisBuilder.group),sr(tA,function(t){e.get([t,"show"])&&nA[t](this,this.fm,e,e.getCoordSysModel(),i)},this),r&&"changeAxisOrder"===r.type&&r.isInitSort||vp(o,this.fm,e),t.prototype.render.call(this,e,n,i,r))},e.prototype.remove=function(){QM(this).splitAreaColors=null},e.type="cartesianAxis",e}(JM),nA={splitLine:function(t,e,n,i,r){var o=n.axis;if(!o.scale.isBlank()){var a=n.getModel("splitLine"),s=a.getModel("lineStyle"),l=s.get("color"),c=!1!==a.get("showMinLine"),h=!1!==a.get("showMaxLine");l=mr(l)?l:[l];for(var u=i.coordinateSystem.getRect(),d=o.isHorizontal(),f=0,p=o.getTicksCoords({tickModel:a,breakTicks:"none",pruneByBreak:"preserve_extent_bound"}),m=[],g=[],v=s.getLineStyle(),y=0;y<p.length;y++){var b=o.toGlobalCoord(p[y].coord);if((0!==y||c)&&(y!==p.length-1||h)){var x=p[y].tickValue;d?(m[0]=b,m[1]=u.y,g[0]=b,g[1]=u.y+u.height):(m[0]=u.x,m[1]=b,g[0]=u.x+u.width,g[1]=b);var w=f++%l.length,S=new Af({anid:null!=x?"line_"+x:null,autoBatch:!0,shape:{x1:m[0],y1:m[1],x2:g[0],y2:g[1]},style:ir({stroke:l[w]},v),silent:!0});fp(S.shape,v.lineWidth),e.add(S)}}}},minorSplitLine:function(t,e,n,i,r){var o=n.axis,a=n.getModel("minorSplitLine").getModel("lineStyle"),s=i.coordinateSystem.getRect(),l=o.isHorizontal(),c=o.getMinorTicksCoords();if(c.length)for(var h=[],u=[],d=a.getLineStyle(),f=0;f<c.length;f++)for(var p=0;p<c[f].length;p++){var m=o.toGlobalCoord(c[f][p].coord);l?(h[0]=m,h[1]=s.y,u[0]=m,u[1]=s.y+s.height):(h[0]=s.x,h[1]=m,u[0]=s.x+s.width,u[1]=m);var g=new Af({anid:"minor_line_"+c[f][p].tickValue,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:u[0],y2:u[1]},style:d,silent:!0});fp(g.shape,d.lineWidth),e.add(g)}},splitArea:function(t,e,n,i,r){!function(t,e,n,i){var r=n.axis;if(!r.scale.isBlank()){var o=n.getModel("splitArea"),a=o.getModel("areaStyle"),s=a.get("color"),l=i.coordinateSystem.getRect(),c=r.getTicksCoords({tickModel:o,clamp:!0,breakTicks:"none",pruneByBreak:"preserve_extent_bound"});if(c.length){var h=s.length,u=QM(t).splitAreaColors,d=Or(),f=0;if(u)for(var p=0;p<c.length;p++){var m=u.get(c[p].tickValue);if(null!=m){f=(m+(h-1)*p)%h;break}}var g=r.toGlobalCoord(c[0].coord),v=a.getAreaStyle();for(s=mr(s)?s:[s],p=1;p<c.length;p++){var y=r.toGlobalCoord(c[p].coord),b=void 0,x=void 0,w=void 0,S=void 0;r.isHorizontal()?(b=g,x=l.y,w=y-b,S=l.height,g=b+w):(b=l.x,x=g,w=l.width,g=x+(S=y-x));var C=c[p-1].tickValue;null!=C&&d.set(C,f),e.add(new $u({anid:null!=C?"area_"+C:null,shape:{x:b,y:x,width:w,height:S},style:ir({fill:s[f]},v),autoBatch:!0,silent:!0})),f=(f+1)%h}QM(t).splitAreaColors=d}}}(t,e,n,i)},breakArea:function(t,e,n,i,r){n.axis.scale}},iA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.type="xAxis",e}(eA),rA=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=iA.type,e}return Ei(e,t),e.type="yAxis",e}(eA),oA=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="grid",e}return Ei(e,t),e.prototype.render=function(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new $u({shape:t.coordinateSystem.getRect(),style:ir({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}(Jy),aA={offset:0};function sA(t){t.registerComponentView(oA),t.registerComponentModel(Z$),t.registerCoordinateSystem("cartesian2d",zM),rM(t,"x",J$,aA),rM(t,"y",J$,aA),t.registerComponentView(iA),t.registerComponentView(rA),t.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}function lA(t){t.eachSeriesByType("radar",function(t){var e=t.getData(),n=[],i=t.coordinateSystem;if(i){var r=i.getIndicatorAxes();sr(r,function(t,o){e.each(e.mapDimension(r[o].dim),function(t,e){n[e]=n[e]||[];var r=i.dataToPoint(t,o);n[e][o]=cA(r)?r:hA(i)})}),e.each(function(t){var r=ur(n[t],function(t){return cA(t)})||hA(i);n[t].push(r.slice()),e.setItemLayout(t,n[t])})}})}function cA(t){return!isNaN(t[0])&&!isNaN(t[1])}function hA(t){return[t.cx,t.cy]}function uA(t){var e=t.polar;if(e){mr(e)||(e=[e]);var n=[];sr(e,function(e,i){e.indicator?(e.type&&!e.shape&&(e.shape=e.type),t.radar=t.radar||[],mr(t.radar)||(t.radar=[t.radar]),t.radar.push(e)):n.push(e)}),t.polar=n}sr(t.series,function(t){t&&"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex)})}var dA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n){var i=t.coordinateSystem,r=this.group,o=t.getData(),a=this.Ln;function s(t,e){var n=t.getItemVisual(e,"symbol")||"circle";if("none"!==n){var i=cx(t.getItemVisual(e,"symbolSize")),r=lx(n,-1,-1,2,2),o=t.getItemVisual(e,"symbolRotate")||0;return r.attr({style:{strokeNoScale:!0},z2:100,scaleX:i[0]/2,scaleY:i[1]/2,rotation:o*Math.PI/180||0}),r}}function l(e,n,i,r,o,a){i.removeAll();for(var l=0;l<n.length-1;l++){var c=s(r,o);c&&(c.__dimIdx=l,e[l]?(c.setPosition(e[l]),Ep[a?"initProps":"updateProps"](c,{x:n[l][0],y:n[l][1]},t,o)):c.setPosition(n[l]),i.add(c))}}function c(t){return lr(t,function(t){return[i.cx,i.cy]})}o.diff(a).add(function(e){var n=o.getItemLayout(e);if(n){var i=new Sf,r=new Tf,a={shape:{points:n}};i.shape.points=c(n),r.shape.points=c(n),Jf(i,a,t,e),Jf(r,a,t,e);var s=new Il,h=new Il;s.add(r),s.add(i),s.add(h),l(r.shape.points,n,h,o,e,!0),o.setItemGraphicEl(e,s)}}).update(function(e,n){var i=a.getItemGraphicEl(n),r=i.childAt(0),s=i.childAt(1),c=i.childAt(2),h={shape:{points:o.getItemLayout(e)}};h.shape.points&&(l(r.shape.points,h.shape.points,c,o,e,!1),ip(s),ip(r),Zf(r,h,t),Zf(s,h,t),o.setItemGraphicEl(e,i))}).remove(function(t){r.remove(a.getItemGraphicEl(t))}).execute(),o.eachItemGraphicEl(function(t,e){var n=o.getItemModel(e),i=t.childAt(0),a=t.childAt(1),s=t.childAt(2),l=o.getItemVisual(e,"style"),c=l.fill;r.add(t),i.useStyle(ir(n.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:c})),_d(i,n,"lineStyle"),_d(a,n,"areaStyle");var h=n.getModel("areaStyle"),u=h.isEmpty()&&h.parentModel.isEmpty();a.ignore=u,sr(["emphasis","select","blur"],function(t){var e=n.getModel([t,"areaStyle"]),r=e.isEmpty()&&e.parentModel.isEmpty();a.ensureState(t).ignore=r&&u;var o=n.getModel([t,"lineStyle"]).getLineStyle();i.ensureState(t).style=o;var l=e.getAreaStyle();a.ensureState(t).style=l;var c=n.getModel([t,"itemStyle"]).getItemStyle();s.eachChild(function(e){e.ensureState(t).style=tr(c)})}),a.useStyle(ir(n.getModel("areaStyle").getAreaStyle(),{fill:c,opacity:.7,decal:l.decal}));var d=n.getModel("emphasis");s.eachChild(function(t){if(t instanceof yu){var i=t.style;t.useStyle(nr({image:i.image,x:i.x,y:i.y,width:i.width,height:i.height},l))}else t.useStyle(l),t.setColor(c),t.style.strokeNoScale=!0;var r=o.getStore().get(o.getDimensionIndex(t.__dimIdx),e);(null==r||isNaN(r))&&(r=""),Pp(t,zp(n),{labelFetcher:o.hostModel,labelDataIndex:e,labelDimIndex:t.__dimIdx,defaultText:r,inheritColor:c,defaultOpacity:l.opacity})}),Ad(t,d.get("focus"),d.get("blurScope"),d.get("disabled"))}),this.Ln=o},e.prototype.remove=function(){this.group.removeAll(),this.Ln=null},e.type="radar",e}(nb),fA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.hasSymbolVisual=!0,n}return Ei(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new V$(fr(this.getData,this),fr(this.getRawData,this))},e.prototype.getInitialData=function(t,e){return O$(this,{generateCoord:"indicator_",generateCoordCount:1/0})},e.prototype.formatTooltip=function(t,e,n){var i=this.getData(),r=this.coordinateSystem.getIndicatorAxes(),o=this.getData().getName(t),a=""===o?this.name:o,s=Oy(this,t);return Ry("section",{header:a,sortBlocks:!0,blocks:lr(r,function(e){var n=i.get(i.mapDimension(e.dim),t);return Ry("nameValue",{markerType:"subItem",markerColor:s,name:e.name,value:n,sortParam:n})})})},e.prototype.getTooltipPosition=function(t){if(null!=t)for(var e=this.getData(),n=this.coordinateSystem,i=e.getValues(lr(n.dimensions,function(t){return e.mapDimension(t)}),t),r=0,o=i.length;r<o;r++)if(!isNaN(i[r])){var a=n.getIndicatorAxes();return n.coordToPoint(a[r].dataToCoord(i[r]),r)}},e.type="series.radar",e.dependencies=["radar"],e.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},e}(qy),pA=nM.value;function mA(t,e){return ir({show:e},t)}var gA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.optionUpdated=function(){var t=this.get("boundaryGap"),e=this.get("splitNumber"),n=this.get("scale"),i=this.get("axisLine"),r=this.get("axisTick"),o=this.get("axisLabel"),a=this.get("axisName"),s=this.get(["axisName","show"]),l=this.get(["axisName","formatter"]),c=this.get("axisNameGap"),h=this.get("triggerEvent"),u=lr(this.get("indicator")||[],function(u){null!=u.max&&u.max>0&&!u.min?u.min=0:null!=u.min&&u.min<0&&!u.max&&(u.max=0);var d=a;null!=u.color&&(d=ir({color:u.color},a));var f=er(tr(u),{boundaryGap:t,splitNumber:e,scale:n,axisLine:i,axisTick:r,axisLabel:o,name:u.text,showName:s,nameLocation:"end",nameGap:c,nameTextStyle:d,triggerEvent:h},!1);if(vr(l)){var p=f.name;f.name=l.replace("{value}",null!=p?p:"")}else gr(l)&&(f.name=l(f.name,f));var m=new im(f,null,this.ecModel);return or(m,AC.prototype),m.mainType="radar",m.componentIndex=this.componentIndex,m},this);this.dm=u},e.prototype.getIndicatorModels=function(){return this.dm},e.type="radar",e.defaultOption={z:0,center:["50%","50%"],radius:"50%",startAngle:90,axisName:{show:!0,color:mg.color.axisLabel},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:er({lineStyle:{color:mg.color.neutral20}},pA.axisLine),axisLabel:mA(pA.axisLabel,!1),axisTick:mA(pA.axisTick,!1),splitLine:mA(pA.splitLine,!0),splitArea:mA(pA.splitArea,!0),indicator:[]},e}(pg),vA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n){this.group.removeAll(),this.pm(t,n),this.vm(t)},e.prototype.pm=function(t,e){var n=t.coordinateSystem;sr(lr(n.getIndicatorAxes(),function(t){var i=t.model.get("showName")?t.name:"";return new SM(t.model,e,{axisName:i,position:[n.cx,n.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}),function(t){t.build(),this.group.add(t.group)},this)},e.prototype.vm=function(t){var e=t.coordinateSystem,n=e.getIndicatorAxes();if(n.length){var i=t.get("shape"),r=t.getModel("splitLine"),o=t.getModel("splitArea"),a=r.getModel("lineStyle"),s=o.getModel("areaStyle"),l=r.get("show"),c=o.get("show"),h=a.get("color"),u=s.get("color"),d=mr(h)?h:[h],f=mr(u)?u:[u],p=[],m=[];if("circle"===i)for(var g=n[0].getTicksCoords(),v=e.cx,y=e.cy,b=0;b<g.length;b++)l&&p[A(p,d,b)].push(new tf({shape:{cx:v,cy:y,r:g[b].coord}})),c&&b<g.length-1&&m[A(m,f,b)].push(new bf({shape:{cx:v,cy:y,r0:g[b].coord,r:g[b+1].coord}}));else{var x,w=lr(n,function(t,n){var i=t.getTicksCoords();return x=null==x?i.length-1:Math.min(i.length-1,x),lr(i,function(t){return e.coordToPoint(t.coord,n)})}),S=[];for(b=0;b<=x;b++){for(var C=[],T=0;T<n.length;T++)C.push(w[T][b]);C[0]&&C.push(C[0].slice()),l&&p[A(p,d,b)].push(new Tf({shape:{points:C}})),c&&S&&m[A(m,f,b-1)].push(new Sf({shape:{points:C.concat(S)}})),S=C.slice().reverse()}}var $=a.getLineStyle(),M=s.getAreaStyle();sr(m,function(t,e){this.group.add(up(t,{style:ir({stroke:"none",fill:f[e%f.length]},M),silent:!0}))},this),sr(p,function(t,e){this.group.add(up(t,{style:ir({fill:"none",stroke:d[e%d.length]},$),silent:!0}))},this)}function A(t,e,n){var i=n%e.length;return t[i]=t[i]||[],i}},e.type="radar",e}(Jy),yA=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.type="value",r.angle=0,r.name="",r}return Ei(e,t),e}(WC),bA=function(){function t(t,e,n){this.dimensions=[],this.nu=t,this.bm=lr(t.getIndicatorModels(),function(t,e){var n="indicator_"+e,i=new yA(n,new HS);return i.name=t.get("name"),i.model=t,t.axis=i,this.dimensions.push(n),i},this),this.resize(t,n)}return t.prototype.getIndicatorAxes=function(){return this.bm},t.prototype.dataToPoint=function(t,e){var n=this.bm[e];return this.coordToPoint(n.dataToCoord(t),e)},t.prototype.coordToPoint=function(t,e){var n=this.bm[e].angle;return[this.cx+t*Math.cos(n),this.cy-t*Math.sin(n)]},t.prototype.pointToData=function(t){var e=t[0]-this.cx,n=t[1]-this.cy,i=Math.sqrt(e*e+n*n);e/=i,n/=i;for(var r,o=Math.atan2(-n,e),a=1/0,s=-1,l=0;l<this.bm.length;l++){var c=this.bm[l],h=Math.abs(o-c.angle);h<a&&(r=c,s=l,a=h)}return[s,+(r&&r.coordToData(i))]},t.prototype.resize=function(t,e){var n=cg(t,e).refContainer,i=t.get("center"),r=Math.min(n.width,n.height)/2;this.cx=Vl(i[0],n.width)+n.x,this.cy=Vl(i[1],n.height)+n.y,this.startAngle=t.get("startAngle")*Math.PI/180;var o=t.get("radius");(vr(o)||br(o))&&(o=[0,o]),this.r0=Vl(o[0],r),this.r=Vl(o[1],r),sr(this.bm,function(t,e){t.setExtent(this.r0,this.r);var n=this.startAngle+e*Math.PI*2/this.bm.length;n=Math.atan2(Math.sin(n),Math.cos(n)),t.angle=n},this)},t.prototype.update=function(t,e){var n=this.bm,i=this.nu;sr(n,function(t){t.scale.setExtent(1/0,-1/0)}),t.eachSeriesByType("radar",function(e,r){if("radar"===e.get("coordinateSystem")&&t.getComponent("radar",e.get("radarIndex"))===i){var o=e.getData();sr(n,function(t){t.scale.unionExtentFromData(o,o.mapDimension(t.dim))})}},this);var r=i.get("splitNumber"),o=new HS;o.setExtent(0,r),o.setInterval(1),sr(n,function(t,e){LM(t.scale,t.model,o)})},t.prototype.convertToPixel=function(t,e,n){return null},t.prototype.convertFromPixel=function(t,e,n){return null},t.prototype.containPoint=function(t){return!1},t.create=function(e,n){var i=[];return e.eachComponent("radar",function(r){var o=new t(r,e,n);i.push(o),r.coordinateSystem=o}),e.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=i[t.get("radarIndex")||0])}),i},t.dimensions=[],t}();function xA(t){t.registerCoordinateSystem("radar",bA),t.registerComponentModel(gA),t.registerComponentView(vA),t.registerVisual({seriesType:"radar",reset:function(t){var e=t.getData();e.each(function(t){e.setItemVisual(t,"legendIcon","roundRect")}),e.setVisual("legendIcon","roundRect")}})}var wA=yc();function SA(t,e){return!!wA(t)[e]}Vw({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},qr);var CA={"axisPointer":1,"tooltip":1,"brush":1},TA=function(t){function e(e){var n=t.call(this)||this;n.qh=e;var i=fr(n.gm,n),r=fr(n.ym,n),o=fr(n.wm,n),a=fr(n.xm,n),s=fr(n.$m,n);return n.enable=function(t,n){var l=n.zInfo,c=_p(l.component),h=c.z,u=c.zlevel,d={component:l.component,z:h,zlevel:u,z2:Ar(l.z2,-1/0)},f=nr({},n.triggerInfo);this.Mm=ir(nr({},n),{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0,zInfoParsed:d,triggerInfo:f}),null==t&&(t=!0),this.nn&&this.Cm===t||(this.nn=!0,this.disable(),!0!==t&&"move"!==t&&"pan"!==t||(NA(e,"mousedown",i,d),NA(e,"mousemove",r,d),NA(e,"mouseup",o,d)),!0!==t&&"scale"!==t&&"zoom"!==t||(NA(e,"mousewheel",a,d),NA(e,"pinch",s,d)))},n.disable=function(){this.nn=!1,kA(e,"mousedown",i),kA(e,"mousemove",r),kA(e,"mouseup",o),kA(e,"mousewheel",a),kA(e,"pinch",s)},n}return Ei(e,t),e.prototype.isDragging=function(){return this.Sm},e.prototype.isPinching=function(){return this.Rm},e.prototype.Am=function(t,e,n){var i=this.Mm,r=i.zInfoParsed;if(function(t,e,n){var i=e.getComponentByElement(t.topTarget);if(!i||i===n||CA.hasOwnProperty(i.mainType))return!1;var r=i.coordinateSystem;if(!r||r.model===n)return!1;var o=_p(i),a=_p(n);return!((o.zlevel-a.zlevel||o.z-a.z)<=0)}(t,i.api,r.component))return!1;var o=i.triggerInfo,a=!1;return"global"===o.roamTrigger&&(a=!0),a||(a=o.isInSelf(t,e,n)),a&&o.isInClip&&!o.isInClip(t,e,n)&&(a=!1),a},e.prototype.km=function(t,e,n,i){var r=t.target;return!r&&this.Am(t,e,n)?"grab":i?r&&r.cursor||"default":void 0},e.prototype.dispose=function(){this.disable()},e.prototype.gm=function(t){if(!Ao(t)&&!$A(t)){for(var e=t.target;e;){if(e.draggable)return;e=e.__hostTarget||e.parent}var n=t.offsetX,i=t.offsetY;this.Am(t,n,i)&&(this.Do=n,this.Lo=i,this.Sm=!0)}},e.prototype.ym=function(t){var e=this.qh;if("pinch"!==t.gestureEvent&&!SA(e,"globalPan")&&!$A(t)){var n=t.offsetX,i=t.offsetY;if(this.Sm&&IA("moveOnMouseMove",t,this.Mm)){e.setCursorStyle("grabbing");var r=this.Do,o=this.Lo,a=n-r,s=i-o;this.Do=n,this.Lo=i,this.Mm.preventDefaultMouseMove&&Mo(t.event),t.__ecRoamConsumed=!0,_A(this,"pan","moveOnMouseMove",t,{dx:a,dy:s,oldX:r,oldY:o,newX:n,newY:i,isAvailableBehavior:null})}else{var l=this.km(t,n,i,!1);l&&e.setCursorStyle(l)}}},e.prototype.wm=function(t){if(!$A(t)){var e=this.qh;if(!Ao(t)){this.Sm=!1;var n=this.km(t,t.offsetX,t.offsetY,!0);n&&e.setCursorStyle(n)}}},e.prototype.xm=function(t){if(!$A(t)){var e=IA("zoomOnMouseWheel",t,this.Mm),n=IA("moveOnMouseWheel",t,this.Mm),i=t.wheelDelta,r=Math.abs(i),o=t.offsetX,a=t.offsetY;if(0!==i&&(e||n)){if(e){var s=r>3?1.4:r>1?1.2:1.1,l=i>0?s:1/s;this.Tm(this,"zoom","zoomOnMouseWheel",t,{scale:l,originX:o,originY:a,isAvailableBehavior:null})}if(n){var c=Math.abs(i),h=(i>0?1:-1)*(c>3?.4:c>1?.15:.05);this.Tm(this,"scrollMove","moveOnMouseWheel",t,{scrollDelta:h,originX:o,originY:a,isAvailableBehavior:null})}}}},e.prototype.$m=function(t){if(!SA(this.qh,"globalPan")&&!$A(t)){var e=t.pinchScale>1?1.1:1/1.1;this.Tm(this,"zoom",null,t,{scale:e,originX:t.pinchX,originY:t.pinchY,isAvailableBehavior:null})}},e.prototype.Tm=function(t,e,n,i,r){t.Am(i,r.originX,r.originY)&&(Mo(i.event),i.__ecRoamConsumed=!0,_A(t,e,n,i,r))},e}(ao);function $A(t){return t.__ecRoamConsumed}var MA=yc();function AA(t){var e=MA(t);return e.roam=e.roam||{},e.uniform=e.uniform||{},e}function NA(t,e,n,i){for(var r=AA(t).roam,o=r[e]=r[e]||[],a=0;a<o.length;a++){var s=o[a].zInfoParsed;if((s.zlevel-i.zlevel||s.z-i.z||s.z2-i.z2)<=0)break}o.splice(a,0,{listener:n,zInfoParsed:i}),function(t,e){var n=AA(t);n.uniform[e]||t.on(e,n.uniform[e]=function(t){var i=n.roam[e];if(i)for(var r=0;r<i.length;r++)i[r].listener(t)})}(t,e)}function kA(t,e,n){for(var i=AA(t).roam[e]||[],r=0;r<i.length;r++)if(i[r].listener===n)return i.splice(r,1),void(i.length||RA(t,e))}function RA(t,e){var n=AA(t).uniform;n[e]&&(t.off(e,n[e]),n[e]=null)}function _A(t,e,n,i,r){r.isAvailableBehavior=fr(IA,null,n,i),t.trigger(e,r)}function IA(t,e,n){var i=n[t];return!t||i&&(!vr(i)||e.event[i+"Key"])}var FA=yc();function EA(t,e){if(FA(this).mainData===this){var n=nr({},FA(this).datas);n[this.dataType]=e,OA(e,n,t)}else BA(e,this.dataType,FA(this).mainData,t);return e}function DA(t,e){return t.struct&&t.struct.update(),e}function LA(t,e){return sr(FA(e).datas,function(n,i){n!==e&&BA(n.cloneShallow(),i,e,t)}),e}function PA(t){var e=FA(this).mainData;return null==t||null==e?e:FA(e).datas[t]}function zA(){var t=FA(this).mainData;return null==t?[{data:t}]:lr(dr(FA(t).datas),function(e){return{type:e,data:FA(t).datas[e]}})}function OA(t,e,n){FA(t).datas={},sr(e,function(e,i){BA(e,i,t,n)})}function BA(t,e,n,i){FA(n).datas[e]=t,FA(t).mainData=n,t.dataType=e,i.struct&&(t[i.structAttr]=i.struct,i.struct[i.datasAttr[e]]=t),t.getLinkedData=PA,t.getLinkedDataAll=zA}var VA=function(){function t(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return t.prototype.isRemoved=function(){return this.dataIndex<0},t.prototype.eachNode=function(t,e,n){gr(t)&&(n=e,e=t,t=null),vr(t=t||{})&&(t={order:t});var i,r=t.order||"preorder",o=this[t.attr||"children"];"preorder"===r&&(i=e.call(n,this));for(var a=0;!i&&a<o.length;a++)o[a].eachNode(t,e,n);"postorder"===r&&e.call(n,this)},t.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var n=0;n<this.children.length;n++){var i=this.children[n];i.updateDepthAndHeight(t+1),i.height>e&&(e=i.height)}this.height=e+1},t.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,n=this.children,i=n.length;e<i;e++){var r=n[e].getNodeById(t);if(r)return r}},t.prototype.contains=function(t){if(t===this)return!0;for(var e=0,n=this.children,i=n.length;e<i;e++){var r=n[e].contains(t);if(r)return r}},t.prototype.getAncestors=function(t){for(var e=[],n=t?this:this.parentNode;n;)e.push(n),n=n.parentNode;return e.reverse(),e},t.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},t.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(e){t.push(e.dataIndex)}),t},t.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},t.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},t.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostTree.data.getItemModel(this.dataIndex).getModel(t)},t.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},t.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},t.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},t.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},t.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},t.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},t.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},t.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},t}(),HA=function(){function t(t){this.type="tree",this.Nm=[],this.hostModel=t}return t.prototype.eachNode=function(t,e,n){this.root.eachNode(t,e,n)},t.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this.Nm[e]},t.prototype.getNodeById=function(t){return this.root.getNodeById(t)},t.prototype.update=function(){for(var t=this.data,e=this.Nm,n=0,i=e.length;n<i;n++)e[n].dataIndex=-1;for(n=0,i=t.count();n<i;n++)e[t.getRawIndex(n)].dataIndex=n},t.prototype.clearLayouts=function(){this.data.clearItemLayouts()},t.createTree=function(e,n,i){var r=new t(n),o=[],a=1;!function t(e,n){var i=e.value;a=Math.max(a,mr(i)?i.length:1),o.push(e);var s=new VA(pc(e.name,""),r);n?function(t,e){var n=e.children;t.parentNode!==e&&(n.push(t),t.parentNode=e)}(s,n):r.root=s,r.Nm.push(s);var l=e.children;if(l)for(var c=0;c<l.length;c++)t(l[c],s)}(e),r.root.updateDepthAndHeight(0);var s=xS(o,{coordDimensions:["value"],dimensionsCount:a}).dimensions,l=new bS(s,n);return l.initData(o),i&&i(l),function(t){var e=t.mainData,n=t.datas;n||(n={main:e},t.datasAttr={main:"data"}),t.datas=t.mainData=null,OA(e,n,t),sr(n,function(n){sr(e.TRANSFERABLE_METHODS,function(e){n.wrapMethod(e,pr(EA,t))})}),e.wrapMethod("cloneShallow",pr(LA,t)),sr(e.CHANGABLE_METHODS,function(n){e.wrapMethod(n,pr(DA,t))}),_r(n[e.dataType]===e)}({mainData:l,struct:r,structAttr:"tree"}),r.update(),r},t}();function UA(t,e,n){if(t&&rr(e,t.type)>=0){var i=n.getData().tree.root,r=t.targetNode;if(vr(r)&&(r=i.getNodeById(r)),r&&i.contains(r))return{node:r};var o=t.targetNodeId;if(null!=o&&(r=i.getNodeById(o)))return{node:r}}}function qA(t){for(var e=[];t;)(t=t.parentNode)&&e.push(t);return e.reverse()}function KA(t,e){return rr(qA(t),e)>=0}function WA(t,e){for(var n=[];t;){var i=t.dataIndex;n.push({name:t.name,dataIndex:i,value:e.getRawValue(i)}),t=t.parentNode}return n.reverse(),n}var jA=["treemapZoomToNode","treemapRender","treemapMove"];function GA(t){var e=t.getData().tree,n={};e.eachNode(function(e){for(var i=e;i&&i.depth>1;)i=i.parentNode;var r=function(t,e,n){var i=sc(t.get(["aria","decal","decals"]));return Wg(t,qg,i,null,e,n,void 0)}(t.ecModel,i.name||i.dataIndex+"",n);e.setVisual("decal",r)})}var XA=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.preventUsingHoverLayer=!0,n}return Ei(e,t),e.prototype.getInitialData=function(t,e){var n={name:t.name,children:t.data};YA(n);var i=t.levels||[],r=this.designatedVisualItemStyle={},o=new im({itemStyle:r},this,e);i=t.levels=function(t,e){var n,i,r=sc(e.get("color")),o=sc(e.get(["aria","decal","decals"]));if(r){sr(t=t||[],function(t){var e=new im(t),r=e.get("color"),o=e.get("decal");(e.get(["itemStyle","color"])||r&&"none"!==r)&&(n=!0),(e.get(["itemStyle","decal"])||o&&"none"!==o)&&(i=!0)});var a=t[0]||(t[0]={});return n||(a.color=r.slice()),!i&&o&&(a.decal=o.slice()),t}}(i,e);var a=lr(i||[],function(t){return new im(t,o,e)},this),s=HA.createTree(n,this,function(t){t.wrapMethod("getItemModel",function(t,e){var n=s.getNodeByDataIndex(e),i=n?a[n.depth]:null;return t.parentModel=i||o,t})});return s.data},e.prototype.optionUpdated=function(){this.resetViewRoot()},e.prototype.formatTooltip=function(t,e,n){var i=this.getData(),r=this.getRawValue(t);return Ry("nameValue",{name:i.getName(t),value:r})},e.prototype.getDataParams=function(e){var n=t.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(e);return n.treeAncestors=WA(i,this),n.treePathInfo=n.treeAncestors,n},e.prototype.setLayoutInfo=function(t){this.layoutInfo=this.layoutInfo||{},nr(this.layoutInfo,t)},e.prototype.mapIdToIndex=function(t){var e=this.Fm;e||(e=this.Fm=Or(),this._m=0);var n=e.get(t);return null==n&&e.set(t,n=this._m++),n},e.prototype.getViewRoot=function(){return this.Em},e.prototype.resetViewRoot=function(t){t?this.Em=t:t=this.Em;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this.Em=e)},e.prototype.enableAriaDecal=function(){GA(this)},e.type="series.treemap",e.layoutMode="box",e.defaultOption={progressive:0,coordinateSystemUsage:"box",left:mg.size.l,top:mg.size.xxxl,right:mg.size.l,bottom:mg.size.xxxl,sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,scaleLimit:{max:5,min:.2},roam:!0,roamTrigger:"global",nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",bottom:mg.size.m,emptyItemWidth:25,itemStyle:{color:mg.color.backgroundShade,textStyle:{color:mg.color.secondary}},emphasis:{itemStyle:{color:mg.color.background}}},label:{show:!0,distance:0,padding:5,position:"inside",color:mg.color.neutral00,overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:mg.color.neutral00,borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},e}(qy);function YA(t){var e=0;sr(t.children,function(t){YA(t);var n=t.value;mr(n)&&(n=n[0]),e+=n});var n=t.value;mr(n)&&(n=n[0]),(null==n||isNaN(n))&&(n=e),n<0&&(n=0),mr(t.value)?t.value[0]=n:t.value=n}var ZA=function(){function t(t){this.group=new Il,t.add(this.group)}return t.prototype.render=function(t,e,n,i){var r=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),r.get("show")&&n){var a=r.getModel("itemStyle"),s=r.getModel("emphasis"),l=a.getModel("textStyle"),c=s.getModel(["itemStyle","textStyle"]),h=cg(t,e).refContainer,u={left:r.get("left"),right:r.get("right"),top:r.get("top"),bottom:r.get("bottom")},d={emptyItemWidth:r.get("emptyItemWidth"),totalWidth:0,renderList:[]},f=lg(u,h);this.Im(n,d,l),this.zm(t,d,f,a,s,l,c,i),function(t,e,n,i,r,o){var a;if((o=o||t).x=t.x,o.y=t.y,a=t.getBoundingRect(),t.needLocalTransform()){var s=t.getLocalTransform();(a=a.clone()).applyTransform(s)}var l=lg(ir({width:a.width,height:a.height},e),n,void 0),c=l.x-a.x,h=l.y-a.y;o.x+=c,o.y+=h,o===t&&t.markRedraw()}(o,u,h)}},t.prototype.Im=function(t,e,n){for(var i=t;i;i=i.parentNode){var r=pc(i.getModel().get("name"),""),o=n.getTextRect(r),a=Math.max(o.width+16,e.emptyItemWidth);e.totalWidth+=a+8,e.renderList.push({node:i,text:r,width:a})}},t.prototype.zm=function(t,e,n,i,r,o,a,s){for(var l=0,c=e.emptyItemWidth,h=t.get(["breadcrumb","height"]),u=e.totalWidth,d=e.renderList,f=r.getModel("itemStyle").getItemStyle(),p=d.length-1;p>=0;p--){var m=d[p],g=m.node,v=m.width,y=m.text;u>n.width&&(u-=v-c,v=c,y=null);var b=new Sf({shape:{points:JA(l,0,v,h,p===d.length-1,0===p)},style:ir(i.getItemStyle(),{lineJoin:"bevel"}),textContent:new ku({style:Op(o,{text:y})}),textConfig:{position:"inside"},z2:1e5,onclick:pr(s,g)});b.disableLabelAnimation=!0,b.getTextContent().ensureState("emphasis").style=Op(a,{text:y}),b.ensureState("emphasis").style=f,Ad(b,r.get("focus"),r.get("blurScope"),r.get("disabled")),this.group.add(b),QA(b,t,g),l+=v+8}},t.prototype.remove=function(){this.group.removeAll()},t}();function JA(t,e,n,i,r,o){var a=[[r?t:t-5,e],[t+n,e],[t+n,e+i],[r?t:t-5,e+i]];return!o&&a.splice(2,0,[t+n+5,e+i/2]),!r&&a.push([t,e+i/2]),a}function QA(t,e,n){Bu(t).eventData={componentType:"series",componentSubType:"treemap",componentIndex:e.componentIndex,seriesIndex:e.seriesIndex,seriesName:e.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:n&&n.dataIndex,name:n&&n.name},treePathInfo:n&&WA(n,e)}}var tN=function(){function t(){this.Dm=[],this.Lm={}}return t.prototype.add=function(t,e,n,i,r){return!this.Lm[t.id]&&(this.Lm[t.id]=!0,this.Dm.push({el:t,target:e,duration:n,delay:i,easing:r}),!0)},t.prototype.finished=function(t){return this.Om=t,this},t.prototype.start=function(){for(var t=this,e=this.Dm.length,n=function(){--e<=0&&(t.Dm.length=0,t.Lm={},t.Om&&t.Om())},i=0,r=this.Dm.length;i<r;i++){var o=this.Dm[i];o.el.animateTo(o.target,{duration:o.duration,delay:o.delay,easing:o.easing,setToFinal:!0,done:n,aborted:n})}return this},t}(),eN=Il,nN=$u,iN="label",rN="upperLabel",oN=Ec([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),aN=function(t){var e=oN(t);return e.stroke=e.fill=e.lineWidth=null,e},sN=yc(),lN=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.Pm="ready",n.Dm={nodeGroup:[],background:[],content:[]},n}return Ei(e,t),e.prototype.render=function(t,e,n,i){if(!(rr(e.findComponents({mainType:"series",subType:"treemap",query:i}),t)<0)){this.seriesModel=t,this.api=n,this.ecModel=e;var r=UA(i,["treemapZoomToNode","treemapRootToNode"],t),o=i&&i.type,a=t.layoutInfo,s=!this.Vm,l=this.Dm,c="treemapRootToNode"===o&&r&&l?{rootNodeGroup:l.nodeGroup[r.node.getRawIndex()],direction:i.direction}:null,h=this.Bm(a),u=t.get("animation"),d=this.Hm(h,t,c);!u||s||o&&"treemapZoomToNode"!==o&&"treemapRootToNode"!==o?d.renderFinally():this.Um(h,d,t,c),this.Km(n),this.Wm(t,n,r)}},e.prototype.Bm=function(t){var e=this.jm;return e||(e=this.jm=new eN,this.tu(e),this.group.add(e)),e.x=t.x,e.y=t.y,e},e.prototype.Hm=function(t,e,n){var i=e.getData().tree,r=this.Vm,o={nodeGroup:[],background:[],content:[]},a={nodeGroup:[],background:[],content:[]},s=this.Dm,l=[];!function t(i,r,c,h,u){function d(t){return t.getId()}function f(d,f){var p=null!=d?i[d]:null,m=null!=f?r[f]:null,g=function(t,i,r,c){return function(t,e,n,i,r,o,a,s,l,c){if(a){var h=a.getLayout(),u=t.getData(),d=a.getModel();if(u.setItemGraphicEl(a.dataIndex,null),h&&h.isInView){var f=h.width,p=h.height,m=h.borderWidth,g=h.invisible,v=a.getRawIndex(),y=s&&s.getRawIndex(),b=a.viewChildren,x=h.upperHeight,w=b&&b.length,S=d.getModel("itemStyle"),C=d.getModel(["emphasis","itemStyle"]),T=d.getModel(["blur","itemStyle"]),$=d.getModel(["select","itemStyle"]),M=S.get("borderRadius")||0,A=O("nodeGroup",eN);if(A){if(l.add(A),A.x=h.x||0,A.y=h.y||0,A.markRedraw(),sN(A).nodeWidth=f,sN(A).nodeHeight=p,h.isAboveViewRoot)return A;var N=O("background",nN,c,20);N&&function(e,n,i){var r=Bu(n);if(r.dataIndex=a.dataIndex,r.seriesIndex=t.seriesIndex,n.setShape({x:0,y:0,width:f,height:p,r:M}),g)L(n);else{n.invisible=!1;var o=a.getVisual("style"),s=o.stroke,l=aN(S);l.fill=s;var c=oN(C);c.fill=C.get("borderColor");var h=oN(T);h.fill=T.get("borderColor");var u=oN($);if(u.fill=$.get("borderColor"),i){var d=f-2*m;P(n,s,o.opacity,{x:m,y:0,width:d,height:x})}else n.removeTextContent();n.setStyle(l),n.ensureState("emphasis").style=c,n.ensureState("blur").style=h,n.ensureState("select").style=u,ud(n)}e.add(n)}(A,N,w&&h.upperLabelHeight);var k=d.getModel("emphasis"),R=k.get("focus"),_=k.get("blurScope"),I=k.get("disabled"),F="ancestor"===R?a.getAncestorsIndices():"descendant"===R?a.getDescendantIndices():R;if(w)Fd(A)&&Id(A,!1),N&&(Id(N,!I),u.setItemGraphicEl(a.dataIndex,N),Nd(N,F,_));else{var E=O("content",nN,c,30);E&&function(e,n){var i=Bu(n);i.dataIndex=a.dataIndex,i.seriesIndex=t.seriesIndex;var r=Math.max(f-2*m,0),o=Math.max(p-2*m,0);if(n.culling=!0,n.setShape({x:m,y:m,width:r,height:o,r:M}),g)L(n);else{n.invisible=!1;var s=a.getVisual("style"),l=s.fill,c=aN(S);c.fill=l,c.decal=s.decal;var h=oN(C),u=oN(T),d=oN($);P(n,l,s.opacity,null),n.setStyle(c),n.ensureState("emphasis").style=h,n.ensureState("blur").style=u,n.ensureState("select").style=d,ud(n)}e.add(n)}(A,E),N.disableMorphing=!0,N&&Fd(N)&&Id(N,!1),Id(A,!I),u.setItemGraphicEl(a.dataIndex,A);var D=d.getShallow("cursor");D&&E.attr("cursor",D),Nd(A,F,_)}return A}}}function L(t){!t.invisible&&o.push(t)}function P(e,n,i,r){var o=d.getModel(r?rN:iN),s=pc(d.get("name"),null),l=o.getShallow("show");Pp(e,zp(d,r?rN:iN),{defaultText:l?s:null,inheritColor:n,defaultOpacity:i,labelFetcher:t,labelDataIndex:a.dataIndex});var c=e.getTextContent();if(c){var u=c.style,f=Rr(u.padding||0);r&&(e.setTextConfig({layoutRect:r}),c.disableLabelLayout=!0),c.beforeUpdate=function(){var t=Math.max((r?r.width:e.shape.width)-f[1]-f[3],0),n=Math.max((r?r.height:e.shape.height)-f[0]-f[2],0);u.width===t&&u.height===n||c.setStyle({width:t,height:n})},u.truncateMinChar=2,u.lineOverflow="truncate",z(u,r,h);var p=c.getState("emphasis");z(p?p.style:null,r,h)}}function z(e,n,i){var r=e?e.text:null;if(!n&&i.isLeafRoot&&null!=r){var o=t.get("drillDownIcon",!0);e.text=o?o+" "+r:r}}function O(t,o,s,l){var c=null!=y&&n[t][y],h=r[t];return c?(n[t][y]=null,function(t,e){var n=t[v]={};e instanceof eN?(n.oldX=e.x,n.oldY=e.y):n.oldShape=nr({},e.shape)}(h,c)):g||((c=new o)instanceof uh&&(c.z2=function(t,e){return 100*t+e}(s,l)),function(t,e){var n=t[v]={},o=a.parentNode,s=e instanceof Il;if(o&&(!i||"drillDown"===i.direction)){var l=0,c=0,h=r.background[o.getRawIndex()];!i&&h&&h.oldShape&&(l=h.oldShape.width,c=h.oldShape.height),s?(n.oldX=0,n.oldY=c):n.oldShape={x:l,y:c,width:0,height:0}}n.fadein=!s}(h,c)),e[t][v]=c}}(e,a,s,n,o,l,t,i,r,c)}(p,m,c,u);g&&t(p&&p.viewChildren||[],m&&m.viewChildren||[],g,h,u+1)}h?(r=i,sr(i,function(t,e){!t.isRemoved()&&f(e,e)})):new Xw(r,i,d,d).add(f).update(f).remove(pr(f,null)).execute()}(i.root?[i.root]:[],r&&r.root?[r.root]:[],t,i===r||!r,0);var c=function(t){var e={nodeGroup:[],background:[],content:[]};return t&&sr(t,function(t,n){var i=e[n];sr(t,function(t){t&&(i.push(t),sN(t).willDelete=!0)})}),e}(s);if(this.Vm=i,this.Dm=a,this.qm){var h=this.seriesModel.layoutInfo,u=i.root.getLayout();u.width===h.width&&u.height===h.height&&(this.qm.zoom=1)}return{lastsForAnimation:o,willDeleteEls:c,renderFinally:function(){sr(c,function(t){sr(t,function(t){t.parent&&t.parent.remove(t)})}),sr(l,function(t){t.invisible=!0,t.dirty()})}}},e.prototype.Um=function(t,e,n,i){var r=n.get("animationDurationUpdate"),o=n.get("animationEasing"),a=(gr(r)?0:r)||0,s=(gr(o)?null:o)||"cubicOut",l=new tN;sr(e.willDeleteEls,function(t,e){sr(t,function(t,n){if(!t.invisible){var r,o=t.parent,c=sN(o);if(i&&"drillDown"===i.direction)r=o===i.rootNodeGroup?{shape:{x:0,y:0,width:c.nodeWidth,height:c.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var h=0,u=0;c.willDelete||(h=c.nodeWidth/2,u=c.nodeHeight/2),r="nodeGroup"===e?{x:h,y:u,style:{opacity:0}}:{shape:{x:h,y:u,width:0,height:0},style:{opacity:0}}}r&&l.add(t,r,a,0,s)}})}),sr(this.Dm,function(t,n){sr(t,function(t,i){var r=e.lastsForAnimation[n][i],o={};r&&(t instanceof Il?null!=r.oldX&&(o.x=t.x,o.y=t.y,t.x=r.oldX,t.y=r.oldY):(r.oldShape&&(o.shape=nr({},t.shape),t.setShape(r.oldShape)),r.fadein?(t.setStyle("opacity",0),o.style={opacity:1}):1!==t.style.opacity&&(o.style={opacity:1})),l.add(t,o,a,0,s))})},this),this.Pm="animating",l.finished(fr(function(){this.Pm="ready",e.renderFinally()},this)).start()},e.prototype.Km=function(t){var e=this,n=this.Gm,i=this.qm;i||(this.qm={target:this.group},i=this.qm);var r=this.seriesModel;n||((n=this.Gm=new TA(t.getZr())).on("pan",fr(this.Xm,this)),n.on("zoom",fr(this.Ym,this))),n.enable(r.get("roam"),{api:t,zInfo:{component:r},triggerInfo:{roamTrigger:r.get("roamTrigger"),isInSelf:function(t,n,i){var r=e.jm;return!!r&&r.getBoundingRect().contain(n-r.x,i-r.y)}}}),i.zoomLimit=r.get("scaleLimit"),i.zoom=r.get("zoom")},e.prototype.Jm=function(){var t=this.Gm;this.qm=null,t&&(t.dispose(),t=null)},e.prototype.Xm=function(t){if("animating"!==this.Pm&&(Math.abs(t.dx)>3||Math.abs(t.dy)>3)){var e=this.seriesModel.getData().tree.root;if(!e)return;var n=e.getLayout();if(!n)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:n.x+t.dx,y:n.y+t.dy,width:n.width,height:n.height}})}},e.prototype.Ym=function(t){var e=t.originX,n=t.originY,i=t.scale;if("animating"!==this.Pm){var r=this.seriesModel.getData().tree.root;if(!r)return;var o=r.getLayout();if(!o)return;var a,s=new Jo(o.x,o.y,o.width,o.height),l=this.qm;a=l.zoomLimit;var c=l.zoom=l.zoom||1;if(c*=i,a){var h=a.min||0,u=a.max||1/0;c=Math.max(Math.min(u,c),h)}var d=c/l.zoom;l.zoom=c;var f=this.seriesModel.layoutInfo,p=[1,0,0,1,0,0];Eo(p,p,[-(e-=f.x),-(n-=f.y)]),Lo(p,p,[d,d]),Eo(p,p,[e,n]),s.applyTransform(p),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:s.x,y:s.y,width:s.width,height:s.height}})}},e.prototype.tu=function(t){var e=this;t.on("click",function(t){if("ready"===e.Pm){var n=e.seriesModel.get("nodeClick",!0);if(n){var i=e.findTarget(t.offsetX,t.offsetY);if(i){var r=i.node;if(r.getLayout().isLeafRoot)e.Zm(i);else if("zoomToNode"===n)e.Qm(i);else if("link"===n){var o=r.hostTree.data.getItemModel(r.dataIndex),a=o.get("link",!0),s=o.get("target",!0)||"blank";a&&Jm(a,s)}}}}},this)},e.prototype.Wm=function(t,e,n){var i=this;n||(n=null!=t.get("leafDepth",!0)?{node:t.getViewRoot()}:this.findTarget(e.getWidth()/2,e.getHeight()/2))||(n={node:t.getData().tree.root}),(this.ep||(this.ep=new ZA(this.group))).render(t,e,n.node,function(e){"animating"!==i.Pm&&(KA(t.getViewRoot(),e)?i.Zm({node:e}):i.Qm({node:e}))})},e.prototype.remove=function(){this.Jm(),this.jm&&this.jm.removeAll(),this.Dm={nodeGroup:[],background:[],content:[]},this.Pm="ready",this.ep&&this.ep.remove()},e.prototype.dispose=function(){this.Jm()},e.prototype.Qm=function(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},e.prototype.Zm=function(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},e.prototype.findTarget=function(t,e){var n;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(i){var r=this.Dm.background[i.getRawIndex()];if(r){var o=r.transformCoordToLocal(t,e),a=r.shape;if(!(a.x<=o[0]&&o[0]<=a.x+a.width&&a.y<=o[1]&&o[1]<=a.y+a.height))return!1;n={node:i,offsetX:o[0],offsetY:o[1]}}},this),n},e.type="treemap",e}(nb),cN=sr,hN=xr,uN=function(){function t(e){var n=e.mappingMethod,i=e.type,r=this.option=tr(e);this.type=i,this.mappingMethod=n,this.np=wN[n];var o=t.visualHandlers[i];this.applyVisual=o.applyVisual,this.getColorMapper=o.getColorMapper,this.ip=o.ip[n],"piecewise"===n?(dN(r),function(t){var e=t.pieceList;t.hasSpecialVisual=!1,sr(e,function(e,n){e.originIndex=n,null!=e.visual&&(t.hasSpecialVisual=!0)})}(r)):"category"===n?r.categories?function(t){var e=t.categories,n=t.categoryMap={},i=t.visual;if(cN(e,function(t,e){n[t]=e}),!mr(i)){var r=[];xr(i)?cN(i,function(t,e){var i=n[e];r[null!=i?i:-1]=t}):r[-1]=i,i=xN(t,r)}for(var o=e.length-1;o>=0;o--)null==i[o]&&(delete n[e[o]],e.pop())}(r):dN(r,!0):(_r("linear"!==n||r.dataExtent),dN(r))}return t.prototype.mapValueToVisual=function(t){var e=this.np(t);return this.ip(e,t)},t.prototype.getNormalizer=function(){return fr(this.np,this)},t.listVisualTypes=function(){return dr(t.visualHandlers)},t.isValidType=function(e){return t.visualHandlers.hasOwnProperty(e)},t.eachVisual=function(t,e,n){xr(t)?sr(t,e,n):e.call(n,t)},t.mapVisual=function(e,n,i){var r,o=mr(e)?[]:xr(e)?{}:(r=!0,null);return t.eachVisual(e,function(t,e){var a=n.call(i,t,e);r?o=a:o[e]=a}),o},t.retrieveVisuals=function(e){var n,i={};return e&&cN(t.visualHandlers,function(t,r){e.hasOwnProperty(r)&&(i[r]=e[r],n=!0)}),n?i:null},t.prepareVisualTypes=function(t){if(mr(t))t=t.slice();else{if(!hN(t))return[];var e=[];cN(t,function(t,n){e.push(n)}),t=e}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1}),t},t.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e},t.findPieceIndex=function(t,e,n){for(var i,r=1/0,o=0,a=e.length;o<a;o++){var s=e[o].value;if(null!=s){if(s===t||vr(s)&&s===t+"")return o;n&&u(s,o)}}for(o=0,a=e.length;o<a;o++){var l=e[o],c=l.interval,h=l.close;if(c){if(c[0]===-1/0){if(SN(h[1],t,c[1]))return o}else if(c[1]===1/0){if(SN(h[0],c[0],t))return o}else if(SN(h[0],c[0],t)&&SN(h[1],t,c[1]))return o;n&&u(c[0],o),n&&u(c[1],o)}}if(n)return t===1/0?e.length-1:t===-1/0?0:i;function u(e,n){var o=Math.abs(e-t);o<r&&(r=o,i=n)}},t.visualHandlers={color:{applyVisual:mN("color"),getColorMapper:function(){var t=this.option;return fr("category"===t.mappingMethod?function(t,e){return!e&&(t=this.np(t)),gN.call(this,t)}:function(e,n,i){var r=!!i;return!n&&(e=this.np(e)),i=ds(e,t.parsedVisual,i),r?i:ms(i,"rgba")},this)},ip:{linear:function(t){return ms(ds(t,this.option.parsedVisual),"rgba")},category:gN,piecewise:function(t,e){var n=bN.call(this,e);return null==n&&(n=ms(ds(t,this.option.parsedVisual),"rgba")),n},fixed:vN}},colorHue:fN(function(t,e){return fs(t,e)}),colorSaturation:fN(function(t,e){return fs(t,null,e)}),colorLightness:fN(function(t,e){return fs(t,null,null,e)}),colorAlpha:fN(function(t,e){return ps(t,e)}),decal:{applyVisual:mN("decal"),ip:{linear:null,category:gN,piecewise:null,fixed:null}},opacity:{applyVisual:mN("opacity"),ip:yN([0,1])},liftZ:{applyVisual:mN("liftZ"),ip:{linear:vN,category:vN,piecewise:vN,fixed:vN}},symbol:{applyVisual:function(t,e,n){n("symbol",this.mapValueToVisual(t))},ip:{linear:pN,category:gN,piecewise:function(t,e){var n=bN.call(this,e);return null==n&&(n=pN.call(this,t)),n},fixed:vN}},symbolSize:{applyVisual:mN("symbolSize"),ip:yN([0,1])}},t}();function dN(t,e){var n=t.visual,i=[];xr(n)?cN(n,function(t){i.push(t)}):null!=n&&i.push(n),e||1!==i.length||{color:1,symbol:1}.hasOwnProperty(t.type)||(i[1]=i[0]),xN(t,i)}function fN(t){return{applyVisual:function(e,n,i){var r=this.mapValueToVisual(e);i("color",t(n("color"),r))},ip:yN([0,1])}}function pN(t){var e=this.option.visual;return e[Math.round(Bl(t,[0,1],[0,e.length-1],!0))]||{}}function mN(t){return function(e,n,i){i(t,this.mapValueToVisual(e))}}function gN(t){var e=this.option.visual;return e[this.option.loop&&-1!==t?t%e.length:t]}function vN(){return this.option.visual[0]}function yN(t){return{linear:function(e){return Bl(e,t,this.option.visual,!0)},category:gN,piecewise:function(e,n){var i=bN.call(this,n);return null==i&&(i=Bl(e,t,this.option.visual,!0)),i},fixed:vN}}function bN(t){var e=this.option,n=e.pieceList;if(e.hasSpecialVisual){var i=n[uN.findPieceIndex(t,n)];if(i&&i.visual)return i.visual[this.type]}}function xN(t,e){return t.visual=e,"color"===t.type&&(t.parsedVisual=lr(e,function(t){return cs(t)||[0,0,0,1]})),e}var wN={linear:function(t){return Bl(t,this.option.dataExtent,[0,1],!0)},piecewise:function(t){var e=this.option.pieceList,n=uN.findPieceIndex(t,e,!0);if(null!=n)return Bl(n,[0,e.length-1],[0,1],!0)},category:function(t){return(this.option.categories?this.option.categoryMap[t]:t)??-1},fixed:qr};function SN(t,e,n){return t?e<=n:e<n}var CN=yc();const TN={seriesType:"treemap",reset:function(t){var e=t.getData().tree.root;e.isRemoved()||$N(e,{},t.getViewRoot().getAncestors(),t)}};function $N(t,e,n,i){var r=t.getModel(),o=t.getLayout(),a=t.hostTree.data;if(o&&!o.invisible&&o.isInView){var s,l=r.getModel("itemStyle"),c=function(t,e,n){var i=nr({},e),r=n.designatedVisualItemStyle;return sr(["color","colorAlpha","colorSaturation"],function(n){r[n]=e[n];var o=t.get(n);r[n]=null,null!=o&&(i[n]=o)}),i}(l,e,i),h=a.ensureUniqueItemVisual(t.dataIndex,"style"),u=l.get("borderColor"),d=l.get("borderColorSaturation");null!=d&&(u=function(t,e){return null!=e?fs(e,null,null,t):null}(d,s=MN(c))),h.stroke=u;var f=t.viewChildren;if(f&&f.length){var p=function(t,e,n,i,r,o){if(o&&o.length){var a=NN(e,"color")||null!=r.color&&"none"!==r.color&&(NN(e,"colorAlpha")||NN(e,"colorSaturation"));if(a){var s=e.get("visualMin"),l=e.get("visualMax"),c=n.dataExtent.slice();null!=s&&s<c[0]&&(c[0]=s),null!=l&&l>c[1]&&(c[1]=l);var h=e.get("colorMappingBy"),u={type:a.name,dataExtent:c,visual:a.range};"color"!==u.type||"index"!==h&&"id"!==h?u.mappingMethod="linear":(u.mappingMethod="category",u.loop=!0);var d=new uN(u);return CN(d).drColorMappingBy=h,d}}}(0,r,o,0,c,f);sr(f,function(t,e){if(t.depth>=n.length||t===n[t.depth]){var o=function(t,e,n,i,r,o){var a=nr({},e);if(r){var s=r.type,l="color"===s&&CN(r).drColorMappingBy,c="index"===l?i:"id"===l?o.mapIdToIndex(n.getId()):n.getValue(t.get("visualDimension"));a[s]=r.mapValueToVisual(c)}return a}(r,c,t,e,p,i);$N(t,o,n,i)}})}else s=MN(c),h.fill=s}}function MN(t){var e=AN(t,"color");if(e){var n=AN(t,"colorAlpha"),i=AN(t,"colorSaturation");return i&&(e=fs(e,null,null,i)),n&&(e=ps(e,n)),e}}function AN(t,e){var n=t[e];if(null!=n&&"none"!==n)return n}function NN(t,e){var n=t.get(e);return mr(n)&&n.length?{name:e,range:n}:null}var kN=Math.max,RN=Math.min,_N=Mr,IN=sr,FN=["itemStyle","borderWidth"],EN=["itemStyle","gapWidth"],DN=["upperLabel","show"],LN=["upperLabel","height"];const PN={seriesType:"treemap",reset:function(t,e,n,i){var r=t.option,o=cg(t,n).refContainer,a=lg(t.getBoxLayoutParams(),o),s=r.size||[],l=Vl(_N(a.width,s[0]),o.width),c=Vl(_N(a.height,s[1]),o.height),h=i&&i.type,u=UA(i,["treemapZoomToNode","treemapRootToNode"],t),d="treemapRender"===h||"treemapMove"===h?i.rootRect:null,f=t.getViewRoot(),p=qA(f);if("treemapMove"!==h){var m="treemapZoomToNode"===h?function(t,e,n,i,r){var o,a=(e||{}).node,s=[i,r];if(!a||a===n)return s;for(var l=i*r,c=l*t.option.zoomToNodeRatio;o=a.parentNode;){for(var h=0,u=o.children,d=0,f=u.length;d<f;d++)h+=u[d].getValue();var p=a.getValue();if(0===p)return s;c*=h/p;var m=o.getModel(),g=m.get(FN);(c+=4*g*g+(3*g+Math.max(g,HN(m)))*Math.pow(c,.5))>Wl&&(c=Wl),a=o}c<l&&(c=l);var v=Math.pow(c/l,.5);return[i*v,r*v]}(t,u,f,l,c):d?[d.width,d.height]:[l,c],g=r.sort;g&&"asc"!==g&&"desc"!==g&&(g="desc");var v={squareRatio:r.squareRatio,sort:g,leafDepth:r.leafDepth};f.hostTree.clearLayouts();var y={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};f.setLayout(y),zN(f,v,!1,0),y=f.getLayout(),IN(p,function(t,e){var n=(p[e+1]||f).getValue();t.setLayout(nr({dataExtent:[n,n],borderWidth:0,upperHeight:0},y))})}var b=t.getData().tree.root;b.setLayout(function(t,e,n){if(e)return{x:e.x,y:e.y};var i={x:0,y:0};if(!n)return i;var r=n.node,o=r.getLayout();if(!o)return i;for(var a=[o.width/2,o.height/2],s=r;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode}return{x:t.width/2-a[0],y:t.height/2-a[1]}}(a,d,u),!0),t.setLayoutInfo(a),VN(b,new Jo(-a.x,-a.y,n.getWidth(),n.getHeight()),p,f,0)}};function zN(t,e,n,i){var r,o;if(!t.isRemoved()){var a=t.getLayout();r=a.width,o=a.height;var s=t.getModel(),l=s.get(FN),c=s.get(EN)/2,h=HN(s),u=Math.max(l,h),d=l-c,f=u-c;t.setLayout({borderWidth:l,upperHeight:u,upperLabelHeight:h},!0);var p=(r=kN(r-2*d,0))*(o=kN(o-d-f,0)),m=function(t,e,n,i,r,o){var a=t.children||[],s=i.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=i.leafDepth&&i.leafDepth<=o;if(r&&!l)return t.viewChildren=[];a=hr(a,function(t){return!t.isRemoved()}),function(t,e){e&&t.sort(function(t,n){var i="asc"===e?t.getValue()-n.getValue():n.getValue()-t.getValue();return 0===i?"asc"===e?t.dataIndex-n.dataIndex:n.dataIndex-t.dataIndex:i})}(a,s);var c=function(t,e,n){for(var i=0,r=0,o=e.length;r<o;r++)i+=e[r].getValue();var a,s=t.get("visualDimension");return e&&e.length?"value"===s&&n?(a=[e[e.length-1].getValue(),e[0].getValue()],"asc"===n&&a.reverse()):(a=[1/0,-1/0],IN(e,function(t){var e=t.getValue(s);e<a[0]&&(a[0]=e),e>a[1]&&(a[1]=e)})):a=[NaN,NaN],{sum:i,dataExtent:a}}(e,a,s);if(0===c.sum)return t.viewChildren=[];if(c.sum=function(t,e,n,i,r){if(!i)return n;for(var o=t.get("visibleMin"),a=r.length,s=a,l=a-1;l>=0;l--){var c=r["asc"===i?a-l-1:l].getValue();c/n*e<o&&(s=l,n-=c)}return"asc"===i?r.splice(0,a-s):r.splice(s,a-s),n}(e,n,c.sum,s,a),0===c.sum)return t.viewChildren=[];for(var h=0,u=a.length;h<u;h++){var d=a[h].getValue()/c.sum*n;a[h].setLayout({area:d})}return l&&(a.length&&t.setLayout({isLeafRoot:!0},!0),a.length=0),t.viewChildren=a,t.setLayout({dataExtent:c.dataExtent},!0),a}(t,s,p,e,n,i);if(m.length){var g={x:d,y:f,width:r,height:o},v=RN(r,o),y=1/0,b=[];b.area=0;for(var x=0,w=m.length;x<w;){var S=m[x];b.push(S),b.area+=S.getLayout().area;var C=ON(b,v,e.squareRatio);C<=y?(x++,y=C):(b.area-=b.pop().getLayout().area,BN(b,v,g,c,!1),v=RN(g.width,g.height),b.length=b.area=0,y=1/0)}if(b.length&&BN(b,v,g,c,!0),!n){var T=s.get("childrenVisibleMin");null!=T&&p<T&&(n=!0)}for(x=0,w=m.length;x<w;x++)zN(m[x],e,n,i+1)}}}function ON(t,e,n){for(var i=0,r=1/0,o=0,a=void 0,s=t.length;o<s;o++)(a=t[o].getLayout().area)&&(a<r&&(r=a),a>i&&(i=a));var l=t.area*t.area,c=e*e*n;return l?kN(c*i/l,l/(c*r)):1/0}function BN(t,e,n,i,r){var o=e===n.width?0:1,a=1-o,s=["x","y"],l=["width","height"],c=n[s[o]],h=e?t.area/e:0;(r||h>n[l[a]])&&(h=n[l[a]]);for(var u=0,d=t.length;u<d;u++){var f=t[u],p={},m=h?f.getLayout().area/h:0,g=p[l[a]]=kN(h-2*i,0),v=n[s[o]]+n[l[o]]-c,y=u===d-1||v<m?v:m,b=p[l[o]]=kN(y-2*i,0);p[s[a]]=n[s[a]]+RN(i,g/2),p[s[o]]=c+RN(i,b/2),c+=y,f.setLayout(p,!0)}n[s[a]]+=h,n[l[a]]-=h}function VN(t,e,n,i,r){var o=t.getLayout(),a=n[r],s=a&&a===t;if(!(a&&!s||r===n.length&&t!==i)){t.setLayout({isInView:!0,invisible:!s&&!e.intersect(o),isAboveViewRoot:s},!0);var l=new Jo(e.x-o.x,e.y-o.y,e.width,e.height);IN(t.viewChildren||[],function(t){VN(t,l,n,i,r+1)})}}function HN(t){return t.get(DN)?t.get(LN):0}var UN=["itemStyle","opacity"],qN=function(t){function e(e,n){var i=t.call(this)||this,r=i,o=new Tf,a=new ku;return r.setTextContent(a),i.setTextGuideLine(o),i.updateData(e,n,!0),i}return Ei(e,t),e.prototype.updateData=function(t,e,n){var i=this,r=t.hostModel,o=t.getItemModel(e),a=t.getItemLayout(e),s=o.getModel("emphasis"),l=o.get(UN);l=l??1,n||ip(i),i.useStyle(t.getItemVisual(e,"style")),i.style.lineJoin="round",n?(i.setShape({points:a.points}),i.style.opacity=0,Jf(i,{style:{opacity:l}},r,e)):Zf(i,{style:{opacity:l},shape:{points:a.points}},r,e),_d(i,o),this.Id(t,e),Ad(this,s.get("focus"),s.get("blurScope"),s.get("disabled"))},e.prototype.Id=function(t,e){var n=this,i=this.getTextGuideLine(),r=n.getTextContent(),o=t.hostModel,a=t.getItemModel(e),s=t.getItemLayout(e).label,l=t.getItemVisual(e,"style"),c=l.fill;Pp(r,zp(a),{labelFetcher:t.hostModel,labelDataIndex:e,defaultOpacity:l.opacity,defaultText:t.getName(e)},{normal:{align:s.textAlign,verticalAlign:s.verticalAlign}});var h="inherit"===a.getModel("label").get("color")?c:null;n.setTextConfig({local:!0,inside:!!s.inside,insideStroke:h,outsideFill:h});var u=s.linePoints;i.setShape({points:u}),n.textGuideLineConfig={anchor:u?new zo(u[0][0],u[0][1]):null},Zf(r,{style:{x:s.x,y:s.y}},o,e),r.attr({rotation:s.rotation,originX:s.x,originY:s.y,z2:10}),aT(n,sT(a),{stroke:c})},e}(Sf),KN=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.ignoreLabelLineUpdate=!0,n}return Ei(e,t),e.prototype.render=function(t,e,n){var i=t.getData(),r=this.Ln,o=this.group;i.diff(r).add(function(t){var e=new qN(i,t);i.setItemGraphicEl(t,e),o.add(e)}).update(function(t,e){var n=r.getItemGraphicEl(e);n.updateData(i,t),o.add(n),i.setItemGraphicEl(t,n)}).remove(function(e){np(r.getItemGraphicEl(e),t,e)}).execute(),this.Ln=i},e.prototype.remove=function(){this.group.removeAll(),this.Ln=null},e.prototype.dispose=function(){},e.type="funnel",e}(nb),WN=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new V$(fr(this.getData,this),fr(this.getRawData,this)),this.Od(e)},e.prototype.getInitialData=function(t,e){return O$(this,{coordDimensions:["value"],encodeDefaulter:pr(Dg,this)})},e.prototype.Od=function(t){lc(t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},e.prototype.getDataParams=function(e){var n=this.getData(),i=t.prototype.getDataParams.call(this,e),r=n.mapDimension("value"),o=n.getSum(r);return i.percent=o?+(n.get(r,e)/o*100).toFixed(2):0,i.$vars.push("percent"),i},e.type="series.funnel",e.defaultOption={coordinateSystemUsage:"box",z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:65,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:mg.color.neutral00,borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:mg.color.primary}}},e}(qy);function jN(t,e){t.eachSeriesByType("funnel",function(t){var n=t.getData(),i=n.mapDimension("value"),r=t.get("sort"),o=cg(t,e),a=lg(t.getBoxLayoutParams(),o.refContainer),s=t.get("orient"),l=a.width,c=a.height,h=function(t,e){for(var n=t.mapDimension("value"),i=t.mapArray(n,function(t){return t}),r=[],o="ascending"===e,a=0,s=t.count();a<s;a++)r[a]=a;return gr(e)?r.sort(e):"none"!==e&&r.sort(function(t,e){return o?i[t]-i[e]:i[e]-i[t]}),r}(n,r),u=a.x,d=a.y,f="horizontal"===s?[Vl(t.get("minSize"),c),Vl(t.get("maxSize"),c)]:[Vl(t.get("minSize"),l),Vl(t.get("maxSize"),l)],p=n.getDataExtent(i),m=t.get("min"),g=t.get("max");null==m&&(m=Math.min(p[0],0)),null==g&&(g=p[1]);var v=t.get("funnelAlign"),y=t.get("gap"),b=(("horizontal"===s?l:c)-y*(n.count()-1))/n.count(),x=function(t,e){if("horizontal"===s){var r=Bl(n.get(i,t)||0,[m,g],f,!0),o=void 0;switch(v){case"top":o=d;break;case"center":o=d+(c-r)/2;break;case"bottom":o=d+(c-r)}return[[e,o],[e,o+r]]}var a,h=Bl(n.get(i,t)||0,[m,g],f,!0);switch(v){case"left":a=u;break;case"center":a=u+(l-h)/2;break;case"right":a=u+l-h}return[[a,e],[a+h,e]]};"ascending"===r&&(b=-b,y=-y,"horizontal"===s?u+=l:d+=c,h=h.reverse());for(var w=0;w<h.length;w++){var S=h[w],C=h[w+1],T=n.getItemModel(S);if("horizontal"===s){var $=T.get(["itemStyle","width"]);null==$?$=b:($=Vl($,l),"ascending"===r&&($=-$));var M=x(S,u),A=x(C,u+$);u+=$+y,n.setItemLayout(S,{points:M.concat(A.slice().reverse())})}else{var N=T.get(["itemStyle","height"]);null==N?N=b:(N=Vl(N,c),"ascending"===r&&(N=-N)),M=x(S,d),A=x(C,d+N),d+=N+y,n.setItemLayout(S,{points:M.concat(A.slice().reverse())})}}!function(t){var e=t.hostModel.get("orient");t.each(function(n){var i,r,o,a,s=t.getItemModel(n),l=s.getModel("label").get("position"),c=s.getModel("labelLine"),h=t.getItemLayout(n),u=h.points,d="inner"===l||"inside"===l||"center"===l||"insideLeft"===l||"insideRight"===l;if(d)"insideLeft"===l?(r=(u[0][0]+u[3][0])/2+5,o=(u[0][1]+u[3][1])/2,i="left"):"insideRight"===l?(r=(u[1][0]+u[2][0])/2-5,o=(u[1][1]+u[2][1])/2,i="right"):(r=(u[0][0]+u[1][0]+u[2][0]+u[3][0])/4,o=(u[0][1]+u[1][1]+u[2][1]+u[3][1])/4,i="center"),a=[[r,o],[r,o]];else{var f=void 0,p=void 0,m=void 0,g=void 0,v=c.get("length");"left"===l?(f=(u[3][0]+u[0][0])/2,p=(u[3][1]+u[0][1])/2,r=(m=f-v)-5,i="right"):"right"===l?(f=(u[1][0]+u[2][0])/2,p=(u[1][1]+u[2][1])/2,r=(m=f+v)+5,i="left"):"top"===l?(f=(u[3][0]+u[0][0])/2,o=(g=(p=(u[3][1]+u[0][1])/2)-v)-5,i="center"):"bottom"===l?(f=(u[1][0]+u[2][0])/2,o=(g=(p=(u[1][1]+u[2][1])/2)+v)+5,i="center"):"rightTop"===l?(f="horizontal"===e?u[3][0]:u[1][0],p="horizontal"===e?u[3][1]:u[1][1],"horizontal"===e?(o=(g=p-v)-5,i="center"):(r=(m=f+v)+5,i="top")):"rightBottom"===l?(f=u[2][0],p=u[2][1],"horizontal"===e?(o=(g=p+v)+5,i="center"):(r=(m=f+v)+5,i="bottom")):"leftTop"===l?(f=u[0][0],p="horizontal"===e?u[0][1]:u[1][1],"horizontal"===e?(o=(g=p-v)-5,i="center"):(r=(m=f-v)-5,i="right")):"leftBottom"===l?(f="horizontal"===e?u[1][0]:u[3][0],p="horizontal"===e?u[1][1]:u[2][1],"horizontal"===e?(o=(g=p+v)+5,i="center"):(r=(m=f-v)-5,i="right")):(f=(u[1][0]+u[2][0])/2,p=(u[1][1]+u[2][1])/2,"horizontal"===e?(o=(g=p+v)+5,i="center"):(r=(m=f+v)+5,i="left")),"horizontal"===e?r=m=f:o=g=p,a=[[f,p],[m,g]]}h.label={linePoints:a,x:r,y:o,verticalAlign:"middle",textAlign:i,inside:d}})}(n)})}var GN=function(){function t(){}return t.prototype.rp=function(t){var e=this.getEncode();return e&&null!=e.get(t)},t.prototype.getInitialData=function(t,e){var n,i,r=e.getComponent("xAxis",this.get("xAxisIndex")),o=e.getComponent("yAxis",this.get("yAxisIndex")),a=r.get("type"),s=o.get("type");"category"===a?(t.layout="horizontal",n=r.getOrdinalMeta(),i=!this.rp("x")):"category"===s?(t.layout="vertical",n=o.getOrdinalMeta(),i=!this.rp("y")):t.layout=t.layout||"horizontal";var l=["x","y"],c="horizontal"===t.layout?0:1,h=this.sp=l[c],u=l[1-c],d=[r,o],f=d[c].get("type"),p=d[1-c].get("type"),m=t.data;if(m&&i){var g=[];sr(m,function(t,e){var n;mr(t)?(n=t.slice(),t.unshift(e)):mr(t.value)?((n=nr({},t)).value=n.value.slice(),t.value.unshift(e)):n=t,g.push(n)}),t.data=g}var v=this.defaultValueDimensions,y=[{name:h,type:Jw(f),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:u,type:Jw(p),dimsDef:v.slice()}];return O$(this,{coordDimensions:y,dimensionsCount:v.length+1,encodeDefaulter:pr(Eg,y,this)})},t.prototype.getBaseAxis=function(){var t=this.sp;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis},t}(),XN=["itemStyle","borderColor"],YN=["itemStyle","borderColor0"],ZN=["itemStyle","borderColorDoji"],JN=["itemStyle","color"],QN=["itemStyle","color0"];function tk(t,e){return e.get(t>0?JN:QN)}function ek(t,e){return e.get(0===t?ZN:t>0?XN:YN)}var nk={seriesType:"candlestick",plan:Qy(),performRawSeries:!0,reset:function(t,e){if(!e.isSeriesFiltered(t))return!t.pipelineContext.large&&{progress:function(t,e){for(var n;null!=(n=t.next());){var i=e.getItemModel(n),r=e.getItemLayout(n).sign,o=i.getItemStyle();o.fill=tk(r,i),o.stroke=ek(r,i)||o.fill,nr(e.ensureUniqueItemVisual(n,"style"),o)}}}}},ik=["color","borderColor"],rk=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n){this.group.removeClipPath(),this.Wf=null,this.bd(t),this.gd?this.yd(t):this.wd(t)},e.prototype.incrementalPrepareRender=function(t,e,n){this.xd(),this.bd(t)},e.prototype.incrementalRender=function(t,e,n,i){this.Wf=[],this.gd?this.Md(t,e):this.ap(t,e)},e.prototype.eachRendered=function(t){Mp(this.Wf||this.group,t)},e.prototype.bd=function(t){var e=t.pipelineContext.large;null!=this.gd&&e===this.gd||(this.gd=e,this.xd())},e.prototype.wd=function(t){var e=t.getData(),n=this.Ln,i=this.group,r=e.getLayout("isSimpleBox"),o=t.get("clip",!0),a=t.coordinateSystem,s=a.getArea&&a.getArea();this.Ln||i.removeAll(),e.diff(n).add(function(n){if(e.hasValue(n)){var a=e.getItemLayout(n);if(o&&lk(s,a))return;var l=sk(a,0,!0);Jf(l,{shape:{points:a.ends}},t,n),ck(l,e,n,r),i.add(l),e.setItemGraphicEl(n,l)}}).update(function(a,l){var c=n.getItemGraphicEl(l);if(e.hasValue(a)){var h=e.getItemLayout(a);o&&lk(s,h)?i.remove(c):(c?(Zf(c,{shape:{points:h.ends}},t,a),ip(c)):c=sk(h),ck(c,e,a,r),i.add(c),e.setItemGraphicEl(a,c))}else i.remove(c)}).remove(function(t){var e=n.getItemGraphicEl(t);e&&i.remove(e)}).execute(),this.Ln=e},e.prototype.yd=function(t){this.xd(),fk(t,this.group);var e=t.get("clip",!0)?zT(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath()},e.prototype.ap=function(t,e){for(var n,i=e.getData(),r=i.getLayout("isSimpleBox");null!=(n=t.next());){var o=sk(i.getItemLayout(n));ck(o,i,n,r),o.incremental=!0,this.group.add(o),this.Wf.push(o)}},e.prototype.Md=function(t,e){fk(e,this.group,this.Wf,!0)},e.prototype.remove=function(t){this.xd()},e.prototype.xd=function(){this.group.removeAll(),this.Ln=null},e.type="candlestick",e}(nb),ok=function(){},ak=function(t){function e(e){var n=t.call(this,e)||this;return n.type="normalCandlestickBox",n}return Ei(e,t),e.prototype.getDefaultShape=function(){return new ok},e.prototype.buildPath=function(t,e){var n=e.points;this.__simpleBox?(t.moveTo(n[4][0],n[4][1]),t.lineTo(n[6][0],n[6][1])):(t.moveTo(n[0][0],n[0][1]),t.lineTo(n[1][0],n[1][1]),t.lineTo(n[2][0],n[2][1]),t.lineTo(n[3][0],n[3][1]),t.closePath(),t.moveTo(n[4][0],n[4][1]),t.lineTo(n[5][0],n[5][1]),t.moveTo(n[6][0],n[6][1]),t.lineTo(n[7][0],n[7][1]))},e}(fu);function sk(t,e,n){var i=t.ends;return new ak({shape:{points:n?hk(i,t):i},z2:100})}function lk(t,e){for(var n=!0,i=0;i<e.ends.length;i++)if(t.contain(e.ends[i][0],e.ends[i][1])){n=!1;break}return n}function ck(t,e,n,i){var r=e.getItemModel(n);t.useStyle(e.getItemVisual(n,"style")),t.style.strokeNoScale=!0,t.__simpleBox=i,_d(t,r);var o=e.getItemLayout(n).sign;sr(t.states,function(t,e){var n=r.getModel(e),i=tk(o,n),a=ek(o,n)||i,s=t.style||(t.style={});i&&(s.fill=i),a&&(s.stroke=a)});var a=r.getModel("emphasis");Ad(t,a.get("focus"),a.get("blurScope"),a.get("disabled"))}function hk(t,e){return lr(t,function(t){return(t=t.slice())[1]=e.initBaseline,t})}var uk=function(){},dk=function(t){function e(e){var n=t.call(this,e)||this;return n.type="largeCandlestickBox",n}return Ei(e,t),e.prototype.getDefaultShape=function(){return new uk},e.prototype.buildPath=function(t,e){for(var n=e.points,i=0;i<n.length;)if(this.__sign===n[i++]){var r=n[i++];t.moveTo(r,n[i++]),t.lineTo(r,n[i++])}else i+=3},e}(fu);function fk(t,e,n,i){var r=t.getData().getLayout("largePoints"),o=new dk({shape:{points:r},__sign:1,ignoreCoarsePointer:!0});e.add(o);var a=new dk({shape:{points:r},__sign:-1,ignoreCoarsePointer:!0});e.add(a);var s=new dk({shape:{points:r},__sign:0,ignoreCoarsePointer:!0});e.add(s),pk(1,o,t),pk(-1,a,t),pk(0,s,t),i&&(o.incremental=!0,a.incremental=!0),n&&n.push(o,a)}function pk(t,e,n,i){var r=ek(t,n)||tk(t,n),o=n.getModel("itemStyle").getItemStyle(ik);e.useStyle(o),e.style.fill=null,e.style.stroke=r}var mk=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],n}return Ei(e,t),e.prototype.getShadowDim=function(){return"open"},e.prototype.brushSelector=function(t,e,n){var i=e.getItemLayout(t);return i&&n.rect(i.brushRect)},e.type="series.candlestick",e.dependencies=["xAxis","yAxis","grid"],e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},e}(qy);function gk(t){t&&mr(t.series)&&sr(t.series,function(t){xr(t)&&"k"===t.type&&(t.type="candlestick")})}or(mk,GN,!0);var vk={seriesType:"candlestick",plan:Qy(),reset:function(t){var e=t.coordinateSystem,n=t.getData(),i=function(t,e){var n,i=t.getBaseAxis(),r="category"===i.type?i.getBandWidth():(n=i.getExtent(),Math.abs(n[1]-n[0])/e.count()),o=Vl(Ar(t.get("barMaxWidth"),r),r),a=Vl(Ar(t.get("barMinWidth"),1),r),s=t.get("barWidth");return null!=s?Vl(s,r):Math.max(Math.min(r/2,o),a)}(t,n),r=["x","y"],o=n.getDimensionIndex(n.mapDimension(r[0])),a=lr(n.mapDimensionsAll(r[1]),n.getDimensionIndex,n),s=a[0],l=a[1],c=a[2],h=a[3];if(n.setLayout({candleWidth:i,isSimpleBox:i<=1.3}),!(o<0||a.length<4))return{progress:t.pipelineContext.large?function(n,i){for(var r,a,u=KS(4*n.count),d=0,f=[],p=[],m=i.getStore(),g=!!t.get(["itemStyle","borderColorDoji"]);null!=(a=n.next());){var v=m.get(o,a),y=m.get(s,a),b=m.get(l,a),x=m.get(c,a),w=m.get(h,a);isNaN(v)||isNaN(x)||isNaN(w)?(u[d++]=NaN,d+=3):(u[d++]=yk(m,a,y,b,l,g),f[0]=v,f[1]=x,r=e.dataToPoint(f,null,p),u[d++]=r?r[0]:NaN,u[d++]=r?r[1]:NaN,f[1]=w,r=e.dataToPoint(f,null,p),u[d++]=r?r[1]:NaN)}i.setLayout("largePoints",u)}:function(t,n){for(var r,a=n.getStore();null!=(r=t.next());){var u=a.get(o,r),d=a.get(s,r),f=a.get(l,r),p=a.get(c,r),m=a.get(h,r),g=Math.min(d,f),v=Math.max(d,f),y=T(g,u),b=T(v,u),x=T(p,u),w=T(m,u),S=[];$(S,b,0),$(S,y,1),S.push(A(w),A(b),A(x),A(y));var C=!!n.getItemModel(r).get(["itemStyle","borderColorDoji"]);n.setItemLayout(r,{sign:yk(a,r,d,f,l,C),initBaseline:d>f?b[1]:y[1],ends:S,brushRect:M(p,m,u)})}function T(t,n){var i=[];return i[0]=n,i[1]=t,isNaN(n)||isNaN(t)?[NaN,NaN]:e.dataToPoint(i)}function $(t,e,n){var r=e.slice(),o=e.slice();r[0]=pp(r[0]+i/2,1,!1),o[0]=pp(o[0]-i/2,1,!0),n?t.push(r,o):t.push(o,r)}function M(t,e,n){var r=T(t,n),o=T(e,n);return r[0]-=i/2,o[0]-=i/2,{x:r[0],y:r[1],width:i,height:o[1]-r[1]}}function A(t){return t[0]=pp(t[0],1),t}}}}};function yk(t,e,n,i,r,o){return n>i?-1:n<i?1:o?0:e>0?t.get(r,e-1)<=i?1:-1:1}var bk=function(t){function e(e,n,i,r){var o=t.call(this)||this;o.z2=2,o.textConfig={inside:!0},Bu(o).seriesIndex=n.seriesIndex;var a=new ku({z2:4,silent:e.getModel().get(["label","silent"])});return o.setTextContent(a),o.updateData(!0,e,n,i,r),o}return Ei(e,t),e.prototype.updateData=function(t,e,n,i,r){this.node=e,e.piece=this,n=n||this.lp,i=i||this.cp;var o=this;Bu(o).dataIndex=e.dataIndex;var a=e.getModel(),s=a.getModel("emphasis"),l=e.getLayout(),c=nr({},l);c.label=null;var h=e.getVisual("style");h.lineJoin="bevel";var u=e.getVisual("decal");u&&(h.decal=Lx(u,r));var d=a$(a.getModel("itemStyle"),c,!0);nr(c,d),sr(Ku,function(t){var e=o.ensureState(t),n=a.getModel([t,"itemStyle"]);e.style=n.getItemStyle();var i=a$(n,c);i&&(e.shape=i)}),t?(o.setShape(c),o.shape.r=l.r0,Jf(o,{shape:{r:l.r}},n,e.dataIndex)):(Zf(o,{shape:c},n),ip(o)),o.useStyle(h),this.Id(n);var f=a.getShallow("cursor");f&&o.attr("cursor",f),this.lp=n||this.lp,this.cp=i||this.cp;var p=s.get("focus");Ad(this,"relative"===p?Br(e.getAncestorsIndices(),e.getDescendantIndices()):"ancestor"===p?e.getAncestorsIndices():"descendant"===p?e.getDescendantIndices():p,s.get("blurScope"),s.get("disabled"))},e.prototype.Id=function(t){var e=this,n=this.node.getModel(),i=n.getModel("label"),r=this.node.getLayout(),o=r.endAngle-r.startAngle,a=(r.startAngle+r.endAngle)/2,s=Math.cos(a),l=Math.sin(a),c=this,h=c.getTextContent(),u=this.node.dataIndex,d=i.get("minAngle")/180*Math.PI,f=i.get("show")&&!(null!=d&&Math.abs(o)<d);function p(t,e){return t.get(e)??i.get(e)}h.ignore=!f,sr(Wu,function(i){var d="normal"===i?n.getModel("label"):n.getModel([i,"label"]),f="normal"===i,m=f?h:h.ensureState(i),g=t.getFormattedLabel(u,i);f&&(g=g||e.node.name),m.style=Op(d,{},null,"normal"!==i,!0),g&&(m.style.text=g);var v=d.get("show");null==v||f||(m.ignore=!v);var y,b=p(d,"position"),x=f?c:c.states[i],w=x.style.fill;x.textConfig={outsideFill:"inherit"===d.get("color")?w:null,inside:"outside"!==b};var S=p(d,"distance")||0,C=p(d,"align"),T=p(d,"rotate"),$=.5*Math.PI,M=1.5*Math.PI,A=Zh("tangential"===T?Math.PI/2-a:a),N=A>$&&!Gl(A-$)&&A<M;"outside"===b?(y=r.r+S,C=N?"right":"left"):C&&"center"!==C?"left"===C?(y=r.r0+S,C=N?"right":"left"):"right"===C&&(y=r.r-S,C=N?"left":"right"):(y=o===2*Math.PI&&0===r.r0?0:(r.r+r.r0)/2,C="center"),m.style.align=C,m.style.verticalAlign=p(d,"verticalAlign")||"middle",m.x=y*s+r.cx,m.y=y*l+r.cy;var k=0;"radial"===T?k=Zh(-a)+(N?Math.PI:0):"tangential"===T?k=Zh(Math.PI/2-a)+(N?Math.PI:0):br(T)&&(k=T*Math.PI/180),m.rotation=Zh(k)}),h.dirtyStyle()},e}(vf),xk="sunburstRootToNode",wk="sunburstHighlight",Sk=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n,i){var r=this;this.seriesModel=t,this.api=n,this.ecModel=e;var o=t.getData(),a=o.tree.root,s=t.getViewRoot(),l=this.group,c=t.get("renderLabelForZeroData"),h=[];s.eachNode(function(t){h.push(t)});var u=this.hp||[];!function(i,r){function s(t){return t.getId()}function h(s,h){!function(i,r){if(c||!i||i.getValue()||(i=null),i!==a&&r!==a)if(r&&r.piece)i?(r.piece.updateData(!1,i,t,e,n),o.setItemGraphicEl(i.dataIndex,r.piece)):(h=r)&&h.piece&&(l.remove(h.piece),h.piece=null);else if(i){var s=new bk(i,t,e,n);l.add(s),o.setItemGraphicEl(i.dataIndex,s)}var h}(null==s?null:i[s],null==h?null:r[h])}0===i.length&&0===r.length||new Xw(r,i,s,s).add(h).update(h).remove(pr(h,null)).execute()}(h,u),function(i,o){o.depth>0?(r.virtualPiece?r.virtualPiece.updateData(!1,i,t,e,n):(r.virtualPiece=new bk(i,t,e,n),l.add(r.virtualPiece)),o.piece.off("click"),r.virtualPiece.on("click",function(t){r.Zm(o.parentNode)})):r.virtualPiece&&(l.remove(r.virtualPiece),r.virtualPiece=null)}(a,s),this.tu(),this.hp=h},e.prototype.tu=function(){var t=this;this.group.off("click"),this.group.on("click",function(e){var n=!1;t.seriesModel.getViewRoot().eachNode(function(i){if(!n&&i.piece&&i.piece===e.target){var r=i.getModel().get("nodeClick");if("rootToNode"===r)t.Zm(i);else if("link"===r){var o=i.getModel(),a=o.get("link");a&&Jm(a,o.get("target",!0)||"_blank")}n=!0}})})},e.prototype.Zm=function(t){t!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:xk,from:this.uid,seriesId:this.seriesModel.id,targetNode:t})},e.prototype.containPoint=function(t,e){var n=e.getData().getItemLayout(0);if(n){var i=t[0]-n.cx,r=t[1]-n.cy,o=Math.sqrt(i*i+r*r);return o<=n.r&&o>=n.r0}},e.type="sunburst",e}(nb),Ck=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.ignoreStyleOnData=!0,n}return Ei(e,t),e.prototype.getInitialData=function(t,e){var n={name:t.name,children:t.data};Tk(n);var i=this.up=lr(t.levels||[],function(t){return new im(t,this,e)},this),r=HA.createTree(n,this,function(t){t.wrapMethod("getItemModel",function(t,e){var n=r.getNodeByDataIndex(e),o=i[n.depth];return o&&(t.parentModel=o),t})});return r.data},e.prototype.optionUpdated=function(){this.resetViewRoot()},e.prototype.getDataParams=function(e){var n=t.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(e);return n.treePathInfo=WA(i,this),n},e.prototype.getLevelModel=function(t){return this.up&&this.up[t.depth]},e.prototype.getViewRoot=function(){return this.Em},e.prototype.resetViewRoot=function(t){t?this.Em=t:t=this.Em;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this.Em=e)},e.prototype.enableAriaDecal=function(){GA(this)},e.type="series.sunburst",e.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},e}(qy);function Tk(t){var e=0;sr(t.children,function(t){Tk(t);var n=t.value;mr(n)&&(n=n[0]),e+=n});var n=t.value;mr(n)&&(n=n[0]),(null==n||isNaN(n))&&(n=e),n<0&&(n=0),mr(t.value)?t.value[0]=n:t.value=n}var $k=Math.PI/180;function Mk(t,e,n){e.eachSeriesByType(t,function(t){var e=t.get("center"),i=t.get("radius");mr(i)||(i=[0,i]),mr(e)||(e=[e,e]);var r=n.getWidth(),o=n.getHeight(),a=Math.min(r,o),s=Vl(e[0],r),l=Vl(e[1],o),c=Vl(i[0],a/2),h=Vl(i[1],a/2),u=-t.get("startAngle")*$k,d=t.get("minAngle")*$k,f=t.getData().tree.root,p=t.getViewRoot(),m=p.depth,g=t.get("sort");null!=g&&Ak(p,g);var v=0;sr(p.children,function(t){!isNaN(t.getValue())&&v++});var y=p.getValue(),b=Math.PI/(y||v)*2,x=p.depth>0,w=p.height-(x?-1:1),S=(h-c)/(w||1),C=t.get("clockwise"),T=t.get("stillShowZeroSum"),$=C?1:-1,M=function(e,n){if(e){var i=n;if(e!==f){var r=e.getValue(),o=0===y&&T?b:r*b;o<d&&(o=d),i=n+$*o;var h=e.depth-m-(x?-1:1),u=c+S*h,p=c+S*(h+1),g=t.getLevelModel(e);if(g){var v=g.get("r0",!0),w=g.get("r",!0),A=g.get("radius",!0);null!=A&&(v=A[0],w=A[1]),null!=v&&(u=Vl(v,a/2)),null!=w&&(p=Vl(w,a/2))}e.setLayout({angle:o,startAngle:n,endAngle:i,clockwise:C,cx:s,cy:l,r0:u,r:p})}if(e.children&&e.children.length){var N=0;sr(e.children,function(t){N+=M(t,n+N)})}return i-n}};if(x){var A=c,N=c+S,k=2*Math.PI;f.setLayout({angle:k,startAngle:u,endAngle:u+k,clockwise:C,cx:s,cy:l,r0:A,r:N})}M(p,u)})}function Ak(t,e){var n=t.children||[];t.children=function(t,e){if(gr(e)){var n=lr(t,function(t,e){var n=t.getValue();return{params:{depth:t.depth,height:t.height,dataIndex:t.dataIndex,getValue:function(){return n}},index:e}});return n.sort(function(t,n){return e(t.params,n.params)}),lr(n,function(e){return t[e.index]})}var i="asc"===e;return t.sort(function(t,e){var n=(t.getValue()-e.getValue())*(i?1:-1);return 0===n?(t.dataIndex-e.dataIndex)*(i?-1:1):n})}(n,e),n.length&&sr(t.children,function(t){Ak(t,e)})}function Nk(t){var e={};t.eachSeriesByType("sunburst",function(t){var n=t.getData(),i=n.tree;i.eachNode(function(r){var o=r.getModel().getModel("itemStyle").getItemStyle();o.fill||(o.fill=function(t,n,i){if(0===t.depth)return mg.color.neutral50;for(var r=t;r&&r.depth>1;)r=r.parentNode;var o=n.getColorFromPalette(r.name||r.dataIndex+"",e);return t.depth>1&&vr(o)&&(o=us(o,(t.depth-1)/(i-1)*.5)),o}(r,t,i.root.height)),nr(n.ensureUniqueItemVisual(r.dataIndex,"style"),o)})})}var kk=yc(),Rk=tr,_k=fr,Ik=function(){function t(){this.Sm=!1,this.animationThreshold=15}return t.prototype.render=function(t,e,n,i){var r=e.get("value"),o=e.get("status");if(this.Gd=t,this.fp=e,this.Mc=n,i||this.dp!==r||this.mp!==o){this.dp=r,this.mp=o;var a=this.pp,s=this.vp;if(!o||"hide"===o)return a&&a.hide(),void(s&&s.hide());a&&a.show(),s&&s.show();var l={};this.makeElOption(l,r,t,e,n);var c=l.graphicKey;c!==this.bp&&this.clear(n),this.bp=c;var h=this.gp=this.determineAnimation(t,e);if(a){var u=pr(Fk,e,h);this.updatePointerEl(a,l,u),this.updateLabelEl(a,l,u,e)}else a=this.pp=new Il,this.createPointerEl(a,l,t,e),this.createLabelEl(a,l,t,e),n.getZr().add(a);Pk(a,e,!0),this.yp(r)}},t.prototype.remove=function(t){this.clear(t)},t.prototype.dispose=function(t){this.clear(t)},t.prototype.determineAnimation=function(t,e){var n=e.get("animation"),i=t.axis,r="category"===i.type,o=e.get("snap");if(!o&&!r)return!1;if("auto"===n||null==n){var a=this.animationThreshold;if(r&&i.getBandWidth()>a)return!0;if(o){var s=GM(t).seriesDataCount,l=i.getExtent();return Math.abs(l[0]-l[1])/s>a}return!1}return!0===n},t.prototype.makeElOption=function(t,e,n,i,r){},t.prototype.createPointerEl=function(t,e,n,i){var r=e.pointer;if(r){var o=kk(t).pointerEl=new Ep[r.type](Rk(e.pointer));t.add(o)}},t.prototype.createLabelEl=function(t,e,n,i){if(e.label){var r=kk(t).labelEl=new ku(Rk(e.label));t.add(r),Dk(r,i)}},t.prototype.updatePointerEl=function(t,e,n){var i=kk(t).pointerEl;i&&e.pointer&&(i.setStyle(e.pointer.style),n(i,{shape:e.pointer.shape}))},t.prototype.updateLabelEl=function(t,e,n,i){var r=kk(t).labelEl;r&&(r.setStyle(e.label.style),n(r,{x:e.label.x,y:e.label.y}),Dk(r,i))},t.prototype.yp=function(t){if(!this.Sm&&this.updateHandleTransform){var e,n=this.fp,i=this.Mc.getZr(),r=this.vp,o=n.getModel("handle"),a=n.get("status");if(!o.get("show")||!a||"hide"===a)return r&&i.remove(r),void(this.vp=null);this.vp||(e=!0,r=this.vp=yp(o.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(t){Mo(t.event)},onmousedown:_k(this.wp,this,0,0),drift:_k(this.wp,this),ondragend:_k(this.xp,this)}),i.add(r)),Pk(r,n,!1),r.setStyle(o.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=o.get("size");mr(s)||(s=[s,s]),r.scaleX=s[0]/2,r.scaleY=s[1]/2,db(this,"_doDispatchAxisPointer",o.get("throttle")||0,"fixRate"),this.$p(t,e)}},t.prototype.$p=function(t,e){Fk(this.fp,!e&&this.gp,this.vp,Lk(this.getHandleTransform(t,this.Gd,this.fp)))},t.prototype.wp=function(t,e){var n=this.vp;if(n){this.Sm=!0;var i=this.updateHandleTransform(Lk(n),[t,e],this.Gd,this.fp);this.Mp=i,n.stopAnimation(),n.attr(Lk(i)),kk(n).lastProp=null,this.Cp()}},t.prototype.Cp=function(){if(this.vp){var t=this.Mp,e=this.Gd;this.Mc.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:e.axis.dim,axisIndex:e.componentIndex}]})}},t.prototype.xp=function(){if(this.Sm=!1,this.vp){var t=this.fp.get("value");this.$p(t),this.Mc.dispatchAction({type:"hideTip"})}},t.prototype.clear=function(t){this.dp=null,this.mp=null;var e=t.getZr(),n=this.pp,i=this.vp;e&&n&&(this.bp=null,n&&e.remove(n),i&&e.remove(i),this.pp=null,this.vp=null,this.Mp=null),fb(this,"_doDispatchAxisPointer")},t.prototype.doClear=function(){},t.prototype.buildLabel=function(t,e,n){return{x:t[n=n||0],y:t[1-n],width:e[n],height:e[1-n]}},t}();function Fk(t,e,n,i){Ek(kk(n).lastProp,i)||(kk(n).lastProp=i,e?Zf(n,i,t):(n.stopAnimation(),n.attr(i)))}function Ek(t,e){if(xr(t)&&xr(e)){var n=!0;return sr(e,function(e,i){n=n&&Ek(t[i],e)}),!!n}return t===e}function Dk(t,e){t[e.get(["label","show"])?"show":"hide"]()}function Lk(t){return{x:t.x||0,y:t.y||0,rotation:t.rotation||0}}function Pk(t,e,n){var i=e.get("z"),r=e.get("zlevel");t&&t.traverse(function(t){"group"!==t.type&&(null!=i&&(t.z=i),null!=r&&(t.zlevel=r),t.silent=n)})}function zk(t,e,n,i,r){t=e.scale.parse(t);var o=e.scale.getLabel({value:t},{precision:r.precision}),a=r.formatter;if(a){var s={value:wC(e,{value:t}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};sr(i,function(t){var e=n.getSeriesByIndex(t.seriesIndex),i=t.dataIndexInside,r=e&&e.getDataParams(i);r&&s.seriesData.push(r)}),vr(a)?o=a.replace("{value}",o):gr(a)&&(o=a(s))}return o}function Ok(t,e,n){var i=[1,0,0,1,0,0];return Do(i,i,n.rotation),Eo(i,i,n.position),mp([t.dataToCoord(e),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],i)}var Bk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ei(e,t),e.prototype.makeElOption=function(t,e,n,i,r){var o=n.axis,a=o.grid,s=i.get("type"),l=Vk(a,o).getOtherAxis(o).getGlobalExtent(),c=o.toGlobalCoord(o.dataToCoord(e,!0));if(s&&"none"!==s){var h=function(t){var e,n=t.get("type"),i=t.getModel(n+"Style");return"line"===n?(e=i.getLineStyle()).fill=null:"shadow"===n&&((e=i.getAreaStyle()).stroke=null),e}(i),u=Hk[s](o,c,l);u.style=h,t.graphicKey=u.type,t.pointer=u}!function(t,e,n,i,r,o){var a=SM.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=r.get(["label","margin"]),function(t,e,n,i,r){var o=zk(n.get("value"),e.axis,e.ecModel,n.get("seriesDataIndices"),{precision:n.get(["label","precision"]),formatter:n.get(["label","formatter"])}),a=n.getModel("label"),s=Wm(a.get("padding")||0),l=a.getFont(),c=ml(o,l),h=r.position,u=c.width+s[1]+s[3],d=c.height+s[0]+s[2],f=r.align;"right"===f&&(h[0]-=u),"center"===f&&(h[0]-=u/2);var p=r.verticalAlign;"bottom"===p&&(h[1]-=d),"middle"===p&&(h[1]-=d/2),function(t,e,n,i){var r=i.getWidth(),o=i.getHeight();t[0]=Math.min(t[0]+e,r)-e,t[1]=Math.min(t[1]+n,o)-n,t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0)}(h,u,d,i);var m=a.get("backgroundColor");m&&"auto"!==m||(m=e.get(["axisLine","lineStyle","color"])),t.label={x:h[0],y:h[1],style:Op(a,{text:o,font:l,fill:a.getTextColor(),padding:s,backgroundColor:m}),z2:10}}(e,i,r,o,{position:Ok(i.axis,t,n),align:a.textAlign,verticalAlign:a.textVerticalAlign})}(e,t,EM(a.getRect(),n),n,i,r)},e.prototype.getHandleTransform=function(t,e,n){var i=EM(e.axis.grid.getRect(),e,{labelInside:!1});i.labelMargin=n.get(["handle","margin"]);var r=Ok(e.axis,t,i);return{x:r[0],y:r[1],rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,e,n,i){var r=n.axis,o=r.grid,a=r.getGlobalExtent(!0),s=Vk(o,r).getOtherAxis(r).getGlobalExtent(),l="x"===r.dim?0:1,c=[t.x,t.y];c[l]+=e[l],c[l]=Math.min(a[1],c[l]),c[l]=Math.max(a[0],c[l]);var h=(s[1]+s[0])/2,u=[h,h];return u[l]=c[l],{x:c[0],y:c[1],rotation:t.rotation,cursorPoint:u,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]}},e}(Ik);function Vk(t,e){var n={};return n[e.dim+"AxisIndex"]=e.index,t.getCartesian(n)}var Hk={line:function(t,e,n){var i,r,o;return{type:"Line",subPixelOptimize:!0,shape:(i=[e,n[0]],r=[e,n[1]],o=Uk(t),{x1:i[o=o||0],y1:i[1-o],x2:r[o],y2:r[1-o]})}},shadow:function(t,e,n){var i,r,o,a=Math.max(1,t.getBandWidth()),s=n[1]-n[0];return{type:"Rect",shape:(i=[e-a/2,n[0]],r=[a,s],o=Uk(t),{x:i[o=o||0],y:i[1-o],width:r[o],height:r[1-o]})}}};function Uk(t){return"x"===t.dim?0:1}var qk=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.type="axisPointer",e.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:mg.color.border,width:1,type:"dashed"},shadowStyle:{color:mg.color.shadowTint},label:{show:!0,formatter:null,precision:"auto",margin:3,color:mg.color.neutral00,padding:[5,7,5,7],backgroundColor:mg.color.accent60,borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:mg.color.accent40,throttle:40}},e}(pg),Kk=yc(),Wk=sr;function jk(t,e,n){if(!Li.node){var i=e.getZr();Kk(i).records||(Kk(i).records={}),function(t,e){function n(n,i){t.on(n,function(n){var r=function(t){var e={showTip:[],hideTip:[]},n=function(i){var r=e[i.type];r?r.push(i):(i.dispatchAction=n,t.dispatchAction(i))};return{dispatchAction:n,pendings:e}}(e);Wk(Kk(t).records,function(t){t&&i(t,n,r.dispatchAction)}),function(t,e){var n,i=t.showTip.length,r=t.hideTip.length;i?n=t.showTip[i-1]:r&&(n=t.hideTip[r-1]),n&&(n.dispatchAction=null,e.dispatchAction(n))}(r.pendings,e)})}Kk(t).initialized||(Kk(t).initialized=!0,n("click",pr(Xk,"click")),n("mousemove",pr(Xk,"mousemove")),n("globalout",Gk))}(i,e),(Kk(i).records[t]||(Kk(i).records[t]={})).handler=n}}function Gk(t,e,n){t.handler("leave",null,n)}function Xk(t,e,n,i){e.handler(t,n,i)}function Yk(t,e){if(!Li.node){var n=e.getZr();(Kk(n).records||{})[t]&&(Kk(n).records[t]=null)}}var Zk=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n){var i=e.getComponent("tooltip"),r=t.get("triggerOn")||i&&i.get("triggerOn")||"mousemove|click";jk("axisPointer",n,function(t,e,n){"none"!==r&&("leave"===t||r.indexOf(t)>=0)&&n({type:"updateAxisPointer",currTrigger:t,x:e&&e.offsetX,y:e&&e.offsetY})})},e.prototype.remove=function(t,e){Yk("axisPointer",e)},e.prototype.dispose=function(t,e){Yk("axisPointer",e)},e.type="axisPointer",e}(Jy);function Jk(t,e){var n,i=[],r=t.seriesIndex;if(null==r||!(n=e.getSeriesByIndex(r)))return{point:[]};var o=n.getData(),a=vc(o,t);if(null==a||a<0||mr(a))return{point:[]};var s=o.getItemGraphicEl(a),l=n.coordinateSystem;if(n.getTooltipPosition)i=n.getTooltipPosition(a)||[];else if(l&&l.dataToPoint)if(t.isStacked){var c=l.getBaseAxis(),h=l.getOtherAxis(c).dim,u=c.dim,d="x"===h||"radius"===h?1:0,f=o.mapDimension(u),p=[];p[d]=o.get(f,a),p[1-d]=o.get(o.getCalculationInfo("stackResultDimension"),a),i=l.dataToPoint(p)||[]}else i=l.dataToPoint(o.getValues(lr(l.dimensions,function(t){return o.mapDimension(t)}),a))||[];else if(s){var m=s.getBoundingRect().clone();m.applyTransform(s.transform),i=[m.x+m.width/2,m.y+m.height/2]}return{point:i,el:s}}var Qk=yc();function tR(t,e,n){var i=t.currTrigger,r=[t.x,t.y],o=t,a=t.dispatchAction||fr(n.dispatchAction,n),s=e.getComponent("axisPointer").coordSysAxesInfo;if(s){oR(r)&&(r=Jk({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},e).point);var l=oR(r),c=o.axesInfo,h=s.axesInfo,u="leave"===i||oR(r),d={},f={},p={list:[],map:{}},m={showPointer:pr(nR,f),showTooltip:pr(iR,p)};sr(s.coordSysMap,function(t,e){var n=l||t.containPoint(r);sr(s.coordSysAxesInfo[e],function(t,e){var i=t.axis,o=function(t,e){for(var n=0;n<(t||[]).length;n++){var i=t[n];if(e.axis.dim===i.axisDim&&e.axis.model.componentIndex===i.axisIndex)return i}}(c,t);if(!u&&n&&(!c||o)){var a=o&&o.value;null!=a||l||(a=i.pointToData(r)),null!=a&&eR(t,a,m,!1,d)}})});var g={};return sr(h,function(t,e){var n=t.linkGroup;n&&!f[e]&&sr(n.axesInfo,function(e,i){var r=f[i];if(e!==t&&r){var o=r.value;n.mapper&&(o=t.axis.scale.parse(n.mapper(o,rR(e),rR(t)))),g[t.key]=o}})}),sr(g,function(t,e){eR(h[e],t,m,!0,d)}),function(t,e,n){var i=n.axesInfo=[];sr(e,function(e,n){var r=e.axisPointerModel.option,o=t[n];o?(!e.useHandle&&(r.status="show"),r.value=o.value,r.seriesDataIndices=(o.payloadBatch||[]).slice()):!e.useHandle&&(r.status="hide"),"show"===r.status&&i.push({axisDim:e.axis.dim,axisIndex:e.axis.model.componentIndex,value:r.value})})}(f,h,d),function(t,e,n,i){if(!oR(e)&&t.list.length){var r=((t.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};i({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:r.dataIndexInside,dataIndex:r.dataIndex,seriesIndex:r.seriesIndex,dataByCoordSys:t.list})}else i({type:"hideTip"})}(p,r,t,a),function(t,e,n){var i=n.getZr(),r="axisPointerLastHighlights",o=Qk(i)[r]||{},a=Qk(i)[r]={};sr(t,function(t,e){var n=t.axisPointerModel.option;"show"===n.status&&t.triggerEmphasis&&sr(n.seriesDataIndices,function(t){var e=t.seriesIndex+" | "+t.dataIndex;a[e]=t})});var s=[],l=[];sr(o,function(t,e){!a[e]&&l.push(t)}),sr(a,function(t,e){!o[e]&&s.push(t)}),l.length&&n.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&n.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}(h,0,n),d}}function eR(t,e,n,i,r){var o=t.axis;if(!o.scale.isBlank()&&o.containData(e))if(t.involveSeries){var a=function(t,e){var n=e.axis,i=n.dim,r=t,o=[],a=Number.MAX_VALUE,s=-1;return sr(e.seriesModels,function(e,l){var c,h,u=e.getData().mapDimensionsAll(i);if(e.getAxisTooltipData){var d=e.getAxisTooltipData(u,t,n);h=d.dataIndices,c=d.nestestValue}else{if(!(h=e.indicesOfNearest(i,u[0],t,"category"===n.type?.5:null)).length)return;c=e.getData().get(u[0],h[0])}if(null!=c&&isFinite(c)){var f=t-c,p=Math.abs(f);p<=a&&((p<a||f>=0&&s<0)&&(a=p,s=f,r=c,o.length=0),sr(h,function(t){o.push({seriesIndex:e.seriesIndex,dataIndexInside:t,dataIndex:e.getData().getRawIndex(t)})}))}}),{payloadBatch:o,snapToValue:r}}(e,t),s=a.payloadBatch,l=a.snapToValue;s[0]&&null==r.seriesIndex&&nr(r,s[0]),!i&&t.snap&&o.containData(l)&&null!=l&&(e=l),n.showPointer(t,e,s),n.showTooltip(t,a,l)}else n.showPointer(t,e)}function nR(t,e,n,i){t[e.key]={value:n,payloadBatch:i}}function iR(t,e,n,i){var r=n.payloadBatch,o=e.axis,a=o.model,s=e.axisPointerModel;if(e.triggerTooltip&&r.length){var l=e.coordSys.model,c=YM(l),h=t.map[c];h||(h=t.map[c]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},t.list.push(h)),h.dataByAxis.push({axisDim:o.dim,axisIndex:a.componentIndex,axisType:a.type,axisId:a.id,value:i,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:r.slice()})}}function rR(t){var e=t.axis.model,n={},i=n.axisDim=t.axis.dim;return n.axisIndex=n[i+"AxisIndex"]=e.componentIndex,n.axisName=n[i+"AxisName"]=e.name,n.axisId=n[i+"AxisId"]=e.id,n}function oR(t){return!t||null==t[0]||isNaN(t[0])||null==t[1]||isNaN(t[1])}function aR(t){JM.registerAxisPointerClass("CartesianAxisPointer",Bk),t.registerComponentModel(qk),t.registerComponentView(Zk),t.registerPreprocessor(function(t){if(t){(!t.axisPointer||0===t.axisPointer.length)&&(t.axisPointer={});var e=t.axisPointer.link;e&&!mr(e)&&(t.axisPointer.link=[e])}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,function(t,e){t.getComponent("axisPointer").coordSysAxesInfo=function(t,e){var n={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(t,e,n){var i=e.getComponent("tooltip"),r=e.getComponent("axisPointer"),o=r.get("link",!0)||[],a=[];sr(n.getCoordinateSystems(),function(n){if(n.axisPointerEnabled){var s=YM(n.model),l=t.coordSysAxesInfo[s]={};t.coordSysMap[s]=n;var c=n.model.getModel("tooltip",i);if(sr(n.getAxes(),pr(f,!1,null)),n.getTooltipAxes&&i&&c.get("show")){var h="axis"===c.get("trigger"),u="cross"===c.get(["axisPointer","type"]),d=n.getTooltipAxes(c.get(["axisPointer","axis"]));(h||u)&&sr(d.baseAxes,pr(f,!u||"cross",h)),u&&sr(d.otherAxes,pr(f,"cross",!1))}}function f(i,s,h){var u=h.model.getModel("axisPointer",r),d=u.get("show");if(d&&("auto"!==d||i||XM(u))){null==s&&(s=u.get("triggerTooltip")),u=i?function(t,e,n,i,r,o){var a=e.getModel("axisPointer"),s={};sr(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(t){s[t]=tr(a.get(t))}),s.snap="category"!==t.type&&!!o,"cross"===a.get("type")&&(s.type="line");var l=s.label||(s.label={});if(null==l.show&&(l.show=!1),"cross"===r){var c=a.get(["label","show"]);if(l.show=null==c||c,!o){var h=s.lineStyle=a.get("crossStyle");h&&ir(l,h.textStyle)}}return t.model.getModel("axisPointer",new im(s,n,i))}(h,c,r,e,i,s):u;var f=u.get("snap"),p=u.get("triggerEmphasis"),m=YM(h.model),g=s||f||"category"===h.type,v=t.axesInfo[m]={key:m,axis:h,coordSys:n,axisPointerModel:u,triggerTooltip:s,triggerEmphasis:p,involveSeries:g,snap:f,useHandle:XM(u),seriesModels:[],linkGroup:null};l[m]=v,t.seriesInvolved=t.seriesInvolved||g;var y=function(t,e){for(var n=e.model,i=e.dim,r=0;r<t.length;r++){var o=t[r]||{};if(jM(o[i+"AxisId"],n.id)||jM(o[i+"AxisIndex"],n.componentIndex)||jM(o[i+"AxisName"],n.name))return r}}(o,h);if(null!=y){var b=a[y]||(a[y]={axesInfo:{}});b.axesInfo[m]=v,b.mapper=o[y].mapper,v.linkGroup=b}}}})}(n,t,e),n.seriesInvolved&&function(t,e){e.eachSeries(function(e){var n=e.coordinateSystem,i=e.get(["tooltip","trigger"],!0),r=e.get(["tooltip","show"],!0);n&&n.model&&"none"!==i&&!1!==i&&"item"!==i&&!1!==r&&!1!==e.get(["axisPointer","show"],!0)&&sr(t.coordSysAxesInfo[YM(n.model)],function(t){var i=t.axis;n.getAxis(i.dim)===i&&(t.seriesModels.push(e),null==t.seriesDataCount&&(t.seriesDataCount=0),t.seriesDataCount+=e.getData().count())})})}(n,t),n}(t,e)}),t.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},tR)}var sR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,displayTransition:!0,enterable:!1,backgroundColor:mg.color.neutral00,shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,defaultBorderColor:mg.color.border,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:mg.color.borderShade,width:1,type:"dashed",textStyle:{}}},textStyle:{color:mg.color.tertiary,fontSize:14}},e}(pg);function lR(t){var e=t.get("confine");return null!=e?!!e:"richText"===t.get("renderMode")}function cR(t){if(Li.domSupported)for(var e=document.documentElement.style,n=0,i=t.length;n<i;n++)if(t[n]in e)return t[n]}var hR=cR(["transform","webkitTransform","OTransform","MozTransform","msTransform"]);function uR(t,e){if(!t)return e;e=Km(e,!0);var n=t.indexOf(e);return(t=-1===n?e:"-"+t.slice(0,n)+"-"+e).toLowerCase()}var dR=uR(cR(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),"transition"),fR=uR(hR,"transform"),pR="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(Li.transform3dSupported?"will-change:transform;":"");function mR(t,e,n){var i=t.toFixed(0)+"px",r=e.toFixed(0)+"px";if(!Li.transformSupported)return n?"top:"+r+";left:"+i+";":[["top",r],["left",i]];var o=Li.transform3dSupported,a="translate"+(o?"3d":"")+"("+i+","+r+(o?",0":"")+")";return n?"top:0;left:0;"+fR+":"+a+";":[["top",0],["left",0],[hR,a]]}function gR(t,e,n,i,r){var o=e&&e.painter;if(n){var a=o&&o.getViewportRoot();a&&function(t,e,n,i,r){fo(uo,e,i,r,!0)&&fo(t,n,uo[0],uo[1])}(t,a,n,i,r)}else{t[0]=i,t[1]=r;var s=o&&o.getViewportRootOffset();s&&(t[0]+=s.offsetLeft,t[1]+=s.offsetTop)}t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}var vR=function(){function t(t,e){if(this.Sp=!1,this.Rp=[0,0,0,0],this.Ap=!0,this.kp=!1,this.Tp=!0,this.Np=!0,Li.wxa)return null;var n=document.createElement("div");n.domBelongToZr=!0,this.el=n;var i=this.qh=t.getZr(),r=e.appendTo,o=r&&(vr(r)?document.querySelector(r):Cr(r)?r:gr(r)&&r(t.getDom()));gR(this.Rp,i,o,t.getWidth()/2,t.getHeight()/2),(o||t.getDom()).appendChild(n),this.Mc=t,this.Fp=o;var a=this;n.onmouseenter=function(){a.Ap&&(clearTimeout(a._p),a.Sp=!0),a.Ep=!0},n.onmousemove=function(t){if(t=t||window.event,!a.Ap){var e=i.handler;To(i.painter.getViewportRoot(),t,!0),e.dispatch("mousemove",t)}},n.onmouseleave=function(){a.Ep=!1,a.Ap&&a.Sp&&a.hideLater(a.Ip)}}return t.prototype.update=function(t){if(!this.Fp){var e=this.Mc.getDom(),n=function(t){var e=t.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(t);return e?e.position:null}(e),i=e.style;"absolute"!==i.position&&"absolute"!==n&&(i.position="relative")}var r=t.get("alwaysShowContent");r&&this.zp(),this.kp=r,this.Dp=t.get("displayTransition")&&t.get("transitionDuration")>0,this.el.className=t.get("className")||""},t.prototype.show=function(t,e){clearTimeout(this._p),clearTimeout(this.Lp);var n=this.el,i=n.style,r=this.Rp;n.innerHTML?i.cssText=pR+function(t,e,n,i){var r=[],o=t.get("transitionDuration"),a=t.get("backgroundColor"),s=t.get("shadowBlur"),l=t.get("shadowColor"),c=t.get("shadowOffsetX"),h=t.get("shadowOffsetY"),u=t.getModel("textStyle"),d=By(t,"html"),f=c+"px "+h+"px "+s+"px "+l;return r.push("box-shadow:"+f),e&&o>0&&r.push(function(t,e,n){var i="cubic-bezier(0.23,1,0.32,1)",r="",o="";return n&&(o="opacity"+(r=" "+t/2+"s "+i)+",visibility"+r),e||(r=" "+t+"s "+i,o+=(o.length?",":"")+(Li.transformSupported?""+fR+r:",left"+r+",top"+r)),dR+":"+o}(o,n,i)),a&&r.push("background-color:"+a),sr(["width","color","radius"],function(e){var n="border-"+e,i=Km(n),o=t.get(i);null!=o&&r.push(n+":"+o+("color"===e?"":"px"))}),r.push(function(t){var e=[],n=t.get("fontSize"),i=t.getTextColor();i&&e.push("color:"+i),e.push("font:"+t.getFont());var r=Ar(t.get("lineHeight"),Math.round(3*n/2));n&&e.push("line-height:"+r+"px");var o=t.get("textShadowColor"),a=t.get("textShadowBlur")||0,s=t.get("textShadowOffsetX")||0,l=t.get("textShadowOffsetY")||0;return o&&a&&e.push("text-shadow:"+s+"px "+l+"px "+a+"px "+o),sr(["decoration","align"],function(n){var i=t.get(n);i&&e.push("text-"+n+":"+i)}),e.join(";")}(u)),null!=d&&r.push("padding:"+Wm(d).join("px ")+"px"),r.join(";")+";"}(t,!this.Tp,this.Np,this.Dp)+mR(r[0],r[1],!0)+"border-color:"+Zm(e)+";"+(t.get("extraCssText")||"")+";pointer-events:"+(this.Ap?"auto":"none"):i.display="none",this.Sp=!0,this.Tp=!1,this.Np=!1},t.prototype.setContent=function(t,e,n,i,r){var o=this.el;if(null!=t){var a="";if(vr(r)&&"item"===n.get("trigger")&&!lR(n)&&(a=function(t,e,n){if(!vr(n)||"inside"===n)return"";var i=t.get("backgroundColor"),r=t.get("borderWidth");e=Zm(e);var o,a,s="left"===(o=n)?"right":"right"===o?"left":"top"===o?"bottom":"top",l=Math.max(1.5*Math.round(r),6),c="",h=fR+":";rr(["left","right"],s)>-1?(c+="top:50%",h+="translateY(-50%) rotate("+(a="left"===s?-225:-45)+"deg)"):(c+="left:50%",h+="translateX(-50%) rotate("+(a="top"===s?225:45)+"deg)");var u=a*Math.PI/180,d=l+r,f=d*Math.abs(Math.cos(u))+d*Math.abs(Math.sin(u)),p=e+" solid "+r+"px;";return'<div style="'+["position:absolute;width:"+l+"px;height:"+l+"px;z-index:-1;",(c+=";"+s+":-"+Math.round(100*((f-Math.SQRT2*r)/2+Math.SQRT2*r-(f-d)/2))/100+"px")+";"+h+";","border-bottom:"+p,"border-right:"+p,"background-color:"+i+";"].join("")+'"></div>'}(n,i,r)),vr(t))o.innerHTML=t+a;else if(t){o.innerHTML="",mr(t)||(t=[t]);for(var s=0;s<t.length;s++)Cr(t[s])&&t[s].parentNode!==o&&o.appendChild(t[s]);if(a&&o.childNodes.length){var l=document.createElement("div");l.innerHTML=a,o.appendChild(l)}}}else o.innerHTML=""},t.prototype.setEnterable=function(t){this.Ap=t},t.prototype.getSize=function(){var t=this.el;return t?[t.offsetWidth,t.offsetHeight]:[0,0]},t.prototype.moveTo=function(t,e){if(this.el){var n=this.Rp;if(gR(n,this.qh,this.Fp,t,e),null!=n[0]&&null!=n[1]){var i=this.el.style;sr(mR(n[0],n[1]),function(t){i[t[0]]=t[1]})}}},t.prototype.zp=function(){var t=this.Rp[2],e=this.Rp[3];this.moveTo(t*this.qh.getWidth(),e*this.qh.getHeight())},t.prototype.hide=function(){var t=this,e=this.el.style;this.Dp?(e.visibility="hidden",e.opacity="0"):e.display="none",Li.transform3dSupported&&(e.willChange=""),this.Sp=!1,this.Lp=setTimeout(function(){return t.Np=!0},500)},t.prototype.hideLater=function(t){!this.Sp||this.Ep&&this.Ap||this.kp||(t?(this.Ip=t,this.Sp=!1,this._p=setTimeout(fr(this.hide,this),t)):this.hide())},t.prototype.isShow=function(){return this.Sp},t.prototype.dispose=function(){clearTimeout(this._p),clearTimeout(this.Lp);var t=this.qh;!function(t,e){function n(t){var e=t[ho];e&&(e.clearMarkers&&e.clearMarkers(),delete t[ho])}t&&n(t),e&&n(e)}(t&&t.painter&&t.painter.getViewportRoot(),this.Fp);var e=this.el;if(e){e.onmouseenter=e.onmousemove=e.onmouseleave=null;var n=e.parentNode;n&&n.removeChild(e)}this.el=this.Fp=null},t}(),yR=function(){function t(t){this.Sp=!1,this.Rp=[0,0,0,0],this.kp=!1,this.Ap=!0,this.qh=t.getZr(),wR(this.Rp,this.qh,t.getWidth()/2,t.getHeight()/2)}return t.prototype.update=function(t){var e=t.get("alwaysShowContent");e&&this.zp(),this.kp=e},t.prototype.show=function(){this._p&&clearTimeout(this._p),this.el.show(),this.Sp=!0},t.prototype.setContent=function(t,e,n,i,r){var o=this;xr(t)&&rc(""),this.el&&this.qh.remove(this.el);var a=n.getModel("textStyle");this.el=new ku({style:{rich:e.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:a.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:By(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),sr(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(t){o.el.style[t]=n.get(t)}),sr(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(t){o.el.style[t]=a.get(t)||0}),this.qh.add(this.el);var s=this;this.el.on("mouseover",function(){s.Ap&&(clearTimeout(s._p),s.Sp=!0),s.Ep=!0}),this.el.on("mouseout",function(){s.Ap&&s.Sp&&s.hideLater(s.Ip),s.Ep=!1})},t.prototype.setEnterable=function(t){this.Ap=t},t.prototype.getSize=function(){var t=this.el,e=this.el.getBoundingRect(),n=xR(t.style);return[e.width+n.left+n.right,e.height+n.top+n.bottom]},t.prototype.moveTo=function(t,e){var n=this.el;if(n){var i=this.Rp;wR(i,this.qh,t,e),t=i[0],e=i[1];var r=n.style,o=bR(r.borderWidth||0),a=xR(r);n.x=t+o+a.left,n.y=e+o+a.top,n.markRedraw()}},t.prototype.zp=function(){var t=this.Rp[2],e=this.Rp[3];this.moveTo(t*this.qh.getWidth(),e*this.qh.getHeight())},t.prototype.hide=function(){this.el&&this.el.hide(),this.Sp=!1},t.prototype.hideLater=function(t){!this.Sp||this.Ep&&this.Ap||this.kp||(t?(this.Ip=t,this.Sp=!1,this._p=setTimeout(fr(this.hide,this),t)):this.hide())},t.prototype.isShow=function(){return this.Sp},t.prototype.dispose=function(){this.qh.remove(this.el)},t}();function bR(t){return Math.max(0,t)}function xR(t){var e=bR(t.shadowBlur||0),n=bR(t.shadowOffsetX||0),i=bR(t.shadowOffsetY||0);return{left:bR(e-n),right:bR(e+n),top:bR(e-i),bottom:bR(e+i)}}function wR(t,e,n,i){t[0]=n,t[1]=i,t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}var SR=new $u({shape:{x:-1,y:-1,width:2,height:2}}),CR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.init=function(t,e){if(!Li.node&&e.getDom()){var n,i=t.getComponent("tooltip"),r=this.Op="auto"===(n=i.get("renderMode"))?Li.domSupported?"html":"richText":n||"html";this.Pp="richText"===r?new yR(e):new vR(e,{appendTo:i.get("appendToBody",!0)?"body":i.get("appendTo",!0)})}},e.prototype.render=function(t,e,n){if(!Li.node&&n.getDom()){this.group.removeAll(),this.Vp=t,this.cp=e,this.Mc=n;var i=this.Pp;i.update(t),i.setEnterable(t.get("enterable")),this.Bp(),this.Hp(),"richText"!==this.Op&&t.get("transitionDuration")?db(this,"_updatePosition",50,"fixRate"):fb(this,"_updatePosition")}},e.prototype.Bp=function(){var t=this.Vp.get("triggerOn");jk("itemTooltip",this.Mc,fr(function(e,n,i){"none"!==t&&(t.indexOf(e)>=0?this.Up(n,i):"leave"===e&&this.Kp(i))},this))},e.prototype.Hp=function(){var t=this.Vp,e=this.cp,n=this.Mc,i=t.get("triggerOn");if(null!=this.Wp&&null!=this.jp&&"none"!==i&&"click"!==i){var r=this;clearTimeout(this.qp),this.qp=setTimeout(function(){!n.isDisposed()&&r.manuallyShowTip(t,e,n,{x:r.Wp,y:r.jp,dataByCoordSys:r.Gp})})}},e.prototype.manuallyShowTip=function(t,e,n,i){if(i.from!==this.uid&&!Li.node&&n.getDom()){var r=$R(i,n);this.Xp="";var o=i.dataByCoordSys,a=function(t,e,n){var i=wc(t).queryOptionMap,r=i.keys()[0];if(r&&"series"!==r){var o,a=Cc(e,r,i.get(r),{useDefault:!1,enableAll:!1,enableNone:!1}).models[0];if(a)return n.getViewOfComponentModel(a).group.traverse(function(e){var n=Bu(e).tooltipConfig;if(n&&n.name===t.name)return o=e,!0}),o?{componentMainType:r,componentIndex:a.componentIndex,el:o}:void 0}}(i,e,n);if(a){var s=a.el.getBoundingRect().clone();s.applyTransform(a.el.transform),this.Up({offsetX:s.x+s.width/2,offsetY:s.y+s.height/2,target:a.el,position:i.position,positionDefault:"bottom"},r)}else if(i.tooltip&&null!=i.x&&null!=i.y){var l=SR;l.x=i.x,l.y=i.y,l.update(),Bu(l).tooltipConfig={name:null,option:i.tooltip},this.Up({offsetX:i.x,offsetY:i.y,target:l},r)}else if(o)this.Up({offsetX:i.x,offsetY:i.y,position:i.position,dataByCoordSys:o,tooltipOption:i.tooltipOption},r);else if(null!=i.seriesIndex){if(this.Yp(t,e,n,i))return;var c=Jk(i,e),h=c.point[0],u=c.point[1];null!=h&&null!=u&&this.Up({offsetX:h,offsetY:u,target:c.el,position:i.position,positionDefault:"bottom"},r)}else null!=i.x&&null!=i.y&&(n.dispatchAction({type:"updateAxisPointer",x:i.x,y:i.y}),this.Up({offsetX:i.x,offsetY:i.y,position:i.position,target:n.getZr().findHover(i.x,i.y).target},r))}},e.prototype.manuallyHideTip=function(t,e,n,i){var r=this.Pp;this.Vp&&r.hideLater(this.Vp.get("hideDelay")),this.Wp=this.jp=this.Gp=null,i.from!==this.uid&&this.Kp($R(i,n))},e.prototype.Yp=function(t,e,n,i){var r=i.seriesIndex,o=i.dataIndex,a=e.getComponent("axisPointer").coordSysAxesInfo;if(null!=r&&null!=o&&null!=a){var s=e.getSeriesByIndex(r);if(s&&"axis"===TR([s.getData().getItemModel(o),s,(s.coordinateSystem||{}).model],this.Vp).get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:r,dataIndex:o,position:i.position}),!0}},e.prototype.Up=function(t,e){var n=t.target;if(this.Vp){this.Wp=t.offsetX,this.jp=t.offsetY;var i=t.dataByCoordSys;if(i&&i.length)this.Jp(i,t);else if(n){var r,o;if("legend"===Bu(n).ssrType)return;this.Gp=null,Yb(n,function(t){if(t.tooltipDisabled)return r=o=null,!0;r||o||(null!=Bu(t).dataIndex?r=t:null!=Bu(t).tooltipConfig&&(o=t))},!0),r?this.Zp(t,r,e):o?this.Qp(t,o,e):this.Kp(e)}else this.Gp=null,this.Kp(e)}},e.prototype.tv=function(t,e){var n=t.get("showDelay");e=fr(e,this),clearTimeout(this.ev),n>0?this.ev=setTimeout(e,n):e()},e.prototype.Jp=function(t,e){var n=this.cp,i=this.Vp,r=[e.offsetX,e.offsetY],o=TR([e.tooltipOption],i),a=this.Op,s=[],l=Ry("section",{blocks:[],noHeader:!0}),c=[],h=new Vy;sr(t,function(t){sr(t.dataByAxis,function(t){var e=n.getComponent(t.axisDim+"Axis",t.axisIndex),r=t.value;if(e&&null!=r){var o=zk(r,e.axis,n,t.seriesDataIndices,t.valueLabelOpt),u=Ry("section",{header:o,noHeader:!Ir(o),sortBlocks:!0,blocks:[]});l.blocks.push(u),sr(t.seriesDataIndices,function(l){var d=n.getSeriesByIndex(l.seriesIndex),f=l.dataIndexInside,p=d.getDataParams(f);if(!(p.dataIndex<0)){p.axisDim=t.axisDim,p.axisIndex=t.axisIndex,p.axisType=t.axisType,p.axisId=t.axisId,p.axisValue=wC(e.axis,{value:r}),p.axisValueLabel=o,p.marker=h.makeTooltipMarker("item",Zm(p.color),a);var m=Zv(d.formatTooltip(f,!0,null)),g=m.frag;if(g){var v=TR([d],i).get("valueFormatter");u.blocks.push(v?nr({valueFormatter:v},g):g)}m.text&&c.push(m.text),s.push(p)}})}})}),l.blocks.reverse(),c.reverse();var u=e.position,d=o.get("order"),f=Ly(l,h,a,d,n.get("useUTC"),o.get("textStyle"));f&&c.unshift(f);var p="richText"===a?"\n\n":"<br/>",m=c.join(p);this.tv(o,function(){this.nv(t,s)?this.iv(o,u,r[0],r[1],this.Pp,s):this.rv(o,m,s,Math.random()+"",r[0],r[1],u,null,h)})},e.prototype.Zp=function(t,e,n){var i=this.cp,r=Bu(e),o=r.seriesIndex,a=i.getSeriesByIndex(o),s=r.dataModel||a,l=r.dataIndex,c=r.dataType,h=s.getData(c),u=this.Op,d=t.positionDefault,f=TR([h.getItemModel(l),s,a&&(a.coordinateSystem||{}).model],this.Vp,d?{position:d}:null),p=f.get("trigger");if(null==p||"item"===p){var m=s.getDataParams(l,c),g=new Vy;m.marker=g.makeTooltipMarker("item",Zm(m.color),u);var v=Zv(s.formatTooltip(l,!1,c)),y=f.get("order"),b=f.get("valueFormatter"),x=v.frag,w=x?Ly(b?nr({valueFormatter:b},x):x,g,u,y,i.get("useUTC"),f.get("textStyle")):v.text,S="item_"+s.name+"_"+l;this.tv(f,function(){this.rv(f,w,m,S,t.offsetX,t.offsetY,t.position,t.target,g)}),n({type:"showTip",dataIndexInside:l,dataIndex:h.getRawIndex(l),seriesIndex:o,from:this.uid})}},e.prototype.Qp=function(t,e,n){var i="html"===this.Op,r=Bu(e),o=r.tooltipConfig.option||{},a=o.encodeHTMLContent;vr(o)&&(o={content:o,formatter:o},a=!0),a&&i&&o.content&&((o=tr(o)).content=vo(o.content));var s=[o],l=this.cp.getComponent(r.componentMainType,r.componentIndex);l&&s.push(l),s.push({formatter:o.content});var c=t.positionDefault,h=TR(s,this.Vp,c?{position:c}:null),u=h.get("content"),d=Math.random()+"",f=new Vy;this.tv(h,function(){var n=tr(h.get("formatterParams")||{});this.rv(h,u,n,d,t.offsetX,t.offsetY,t.position,e,f)}),n({type:"showTip",from:this.uid})},e.prototype.rv=function(t,e,n,i,r,o,a,s,l){if(this.Xp="",t.get("showContent")&&t.get("show")){var c=this.Pp;c.setEnterable(t.get("enterable"));var h=t.get("formatter");a=a||t.get("position");var u=e,d=this.sv([r,o],n,t.get("trigger"),t.get("borderColor"),t.get("defaultBorderColor",!0)).color;if(h)if(vr(h)){var f=t.ecModel.get("useUTC"),p=mr(n)?n[0]:n;u=h,p&&p.axisType&&p.axisType.indexOf("time")>=0&&(u=Am(p.axisValue,u,f)),u=Ym(u,n,!0)}else if(gr(h)){var m=fr(function(e,i){e===this.Xp&&(c.setContent(i,l,t,d,a),this.iv(t,a,r,o,c,n,s))},this);this.Xp=i,u=h(n,i,m)}else u=h;c.setContent(u,l,t,d,a),c.show(t,d),this.iv(t,a,r,o,c,n,s)}},e.prototype.sv=function(t,e,n,i,r){return"axis"===n||mr(e)?{color:i||r}:mr(e)?void 0:{color:i||e.color||e.borderColor}},e.prototype.iv=function(t,e,n,i,r,o,a){var s=this.Mc.getWidth(),l=this.Mc.getHeight();e=e||t.get("position");var c=r.getSize(),h=t.get("align"),u=t.get("verticalAlign"),d=a&&a.getBoundingRect().clone();if(a&&d.applyTransform(a.transform),gr(e)&&(e=e([n,i],o,r.el,d,{viewSize:[s,l],contentSize:c.slice()})),mr(e))n=Vl(e[0],s),i=Vl(e[1],l);else if(xr(e)){var f=e;f.width=c[0],f.height=c[1];var p=lg(f,{width:s,height:l});n=p.x,i=p.y,h=null,u=null}else if(vr(e)&&a){var m=function(t,e,n,i){var r=n[0],o=n[1],a=Math.ceil(Math.SQRT2*i)+8,s=0,l=0,c=e.width,h=e.height;switch(t){case"inside":s=e.x+c/2-r/2,l=e.y+h/2-o/2;break;case"top":s=e.x+c/2-r/2,l=e.y-o-a;break;case"bottom":s=e.x+c/2-r/2,l=e.y+h+a;break;case"left":s=e.x-r-a,l=e.y+h/2-o/2;break;case"right":s=e.x+c+a,l=e.y+h/2-o/2}return[s,l]}(e,d,c,t.get("borderWidth"));n=m[0],i=m[1]}else m=function(t,e,n,i,r,o,a){var s=n.getSize(),l=s[0],c=s[1];return null!=o&&(t+l+o+2>i?t-=l+o:t+=o),null!=a&&(e+c+a>r?e-=c+a:e+=a),[t,e]}(n,i,r,s,l,h?null:20,u?null:20),n=m[0],i=m[1];h&&(n-=MR(h)?c[0]/2:"right"===h?c[0]:0),u&&(i-=MR(u)?c[1]/2:"bottom"===u?c[1]:0),lR(t)&&(m=function(t,e,n,i,r){var o=n.getSize(),a=o[0],s=o[1];return t=Math.min(t+a,i)-a,e=Math.min(e+s,r)-s,[t=Math.max(t,0),e=Math.max(e,0)]}(n,i,r,s,l),n=m[0],i=m[1]),r.moveTo(n,i)},e.prototype.nv=function(t,e){var n=this.Gp,i=this.ov,r=!!n&&n.length===t.length;return r&&sr(n,function(n,o){var a=n.dataByAxis||[],s=(t[o]||{}).dataByAxis||[];(r=r&&a.length===s.length)&&sr(a,function(t,n){var o=s[n]||{},a=t.seriesDataIndices||[],l=o.seriesDataIndices||[];(r=r&&t.value===o.value&&t.axisType===o.axisType&&t.axisId===o.axisId&&a.length===l.length)&&sr(a,function(t,e){var n=l[e];r=r&&t.seriesIndex===n.seriesIndex&&t.dataIndex===n.dataIndex}),i&&sr(t.seriesDataIndices,function(t){var n=t.seriesIndex,o=e[n],a=i[n];o&&a&&a.data!==o.data&&(r=!1)})})}),this.Gp=t,this.ov=e,!!r},e.prototype.Kp=function(t){this.Gp=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,e){!Li.node&&e.getDom()&&(fb(this,"_updatePosition"),this.Pp.dispose(),Yk("itemTooltip",e))},e.type="tooltip",e}(Jy);function TR(t,e,n){var i,r=e.ecModel;n?(i=new im(n,r,r),i=new im(e.option,i,r)):i=e;for(var o=t.length-1;o>=0;o--){var a=t[o];a&&(a instanceof im&&(a=a.get("tooltip",!0)),vr(a)&&(a={formatter:a}),a&&(i=new im(a,i,r)))}return i}function $R(t,e){return t.dispatchAction||fr(e.dispatchAction,e)}function MR(t){return"center"===t||"middle"===t}var AR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.layoutMode={type:"box",ignoreSize:!0},n}return Ei(e,t),e.type="title",e.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:"center",top:mg.size.m,backgroundColor:mg.color.transparent,borderColor:mg.color.primary,borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:mg.color.primary},subtextStyle:{fontSize:12,color:mg.color.quaternary}},e}(pg),NR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.render=function(t,e,n){if(this.group.removeAll(),t.get("show")){var i=this.group,r=t.getModel("textStyle"),o=t.getModel("subtextStyle"),a=t.get("textAlign"),s=Ar(t.get("textBaseline"),t.get("textVerticalAlign")),l=new ku({style:Op(r,{text:t.get("text"),fill:r.getTextColor()},{disableBox:!0}),z2:10}),c=l.getBoundingRect(),h=t.get("subtext"),u=new ku({style:Op(o,{text:h,fill:o.getTextColor(),y:c.height+t.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),d=t.get("link"),f=t.get("sublink"),p=t.get("triggerEvent",!0);l.silent=!d&&!p,u.silent=!f&&!p,d&&l.on("click",function(){Jm(d,"_"+t.get("target"))}),f&&u.on("click",function(){Jm(f,"_"+t.get("subtarget"))}),Bu(l).eventData=Bu(u).eventData=p?{componentType:"title",componentIndex:t.componentIndex}:null,i.add(l),h&&i.add(u);var m=i.getBoundingRect(),g=t.getBoxLayoutParams();g.width=m.width,g.height=m.height;var v=lg(g,cg(t,n).refContainer,t.get("padding"));a||("middle"===(a=t.get("left")||t.get("right"))&&(a="center"),"right"===a?v.x+=v.width:"center"===a&&(v.x+=v.width/2)),s||("center"===(s=t.get("top")||t.get("bottom"))&&(s="middle"),"bottom"===s?v.y+=v.height:"middle"===s&&(v.y+=v.height/2),s=s||"top"),i.x=v.x,i.y=v.y,i.markRedraw();var y={align:a,verticalAlign:s};l.setStyle(y),u.setStyle(y),m=i.getBoundingRect();var b=v.margin,x=t.getItemStyle(["color","opacity"]);x.fill=t.get("backgroundColor");var w=new $u({shape:{x:m.x-b[3],y:m.y-b[0],width:m.width+b[1]+b[3],height:m.height+b[0]+b[2],r:t.get("borderRadius")},style:x,subPixelOptimize:!0,silent:!0});i.add(w)}},e.type="title",e}(Jy),kR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.layoutMode={type:"box",ignoreSize:!0},n}return Ei(e,t),e.prototype.init=function(t,e,n){this.mergeDefaultAndTheme(t,n),t.selected=t.selected||{},this.av(t)},e.prototype.mergeOption=function(e,n){t.prototype.mergeOption.call(this,e,n),this.av(e)},e.prototype.av=function(t){var e=t.selector,n=this.ecModel;!0===e&&(e=t.selector=["all","inverse"]),mr(e)&&sr(e,function(t,i){vr(t)&&(t={type:t}),e[i]=er(t,function(t,e){return"all"===e?{type:"all",title:t.getLocaleModel().get(["legend","selector","all"])}:"inverse"===e?{type:"inverse",title:t.getLocaleModel().get(["legend","selector","inverse"])}:void 0}(n,t.type))})},e.prototype.optionUpdated=function(){this.lv(this.ecModel);var t=this.Ln;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,n=0;n<t.length;n++){var i=t[n].get("name");if(this.isSelected(i)){this.select(i),e=!0;break}}!e&&this.select(t[0].get("name"))}},e.prototype.lv=function(t){var e=[],n=[];t.eachRawSeries(function(i){var r,o=i.name;if(n.push(o),i.legendVisualProvider){var a=i.legendVisualProvider.getAllNames();t.isSeriesFiltered(i)||(n=n.concat(a)),a.length?e=e.concat(a):r=!0}else r=!0;r&&mc(i)&&e.push(i.name)}),this.hv=n;var i=this.get("data")||e,r=Or(),o=lr(i,function(t){return(vr(t)||br(t))&&(t={name:t}),r.get(t.name)?null:(r.set(t.name,!0),new im(t,this,this.ecModel))},this);this.Ln=hr(o,function(t){return!!t})},e.prototype.getData=function(){return this.Ln},e.prototype.select=function(t){var e=this.option.selected;"single"===this.get("selectedMode")&&sr(this.Ln,function(t){e[t.get("name")]=!1}),e[t]=!0},e.prototype.unSelect=function(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this.Ln,e=this.option.selected;sr(t,function(t){e[t.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var t=this.Ln,e=this.option.selected;sr(t,function(t){var n=t.get("name",!0);e.hasOwnProperty(n)||(e[n]=!0),e[n]=!e[n]})},e.prototype.isSelected=function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&rr(this.hv,t)>=0},e.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",bottom:mg.size.m,align:"auto",backgroundColor:mg.color.transparent,borderColor:mg.color.border,borderRadius:0,borderWidth:0,padding:5,itemGap:8,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:mg.color.disabled,inactiveBorderColor:mg.color.disabled,inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:mg.color.disabled,inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:mg.color.secondary},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:mg.color.tertiary,borderWidth:1,borderColor:mg.color.border},emphasis:{selectorLabel:{show:!0,color:mg.color.quaternary}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1},triggerEvent:!1},e}(pg),RR=pr,_R=sr,IR=Il,FR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.newlineDisabled=!1,n}return Ei(e,t),e.prototype.init=function(){this.group.add(this.uv=new IR),this.group.add(this.fv=new IR),this.mv=!0},e.prototype.getContentGroup=function(){return this.uv},e.prototype.getSelectorGroup=function(){return this.fv},e.prototype.render=function(t,e,n){var i=this.mv;if(this.mv=!1,this.resetInner(),t.get("show",!0)){var r=t.get("align"),o=t.get("orient");r&&"auto"!==r||(r="right"===t.get("left")&&"vertical"===o?"right":"left");var a=t.get("selector",!0),s=t.get("selectorPosition",!0);!a||s&&"auto"!==s||(s="horizontal"===o?"end":"start"),this.renderInner(r,t,e,n,a,o,s);var l=cg(t,n).refContainer,c=t.getBoxLayoutParams(),h=t.get("padding"),u=lg(c,l,h),d=this.layoutInner(t,r,u,i,a,s),f=lg(ir({width:d.width,height:d.height},c),l,h);this.group.x=f.x-d.x,this.group.y=f.y-d.y,this.group.markRedraw(),this.group.add(this.pv=function(t,e){var n=Wm(e.get("padding")),i=e.getItemStyle(["color","opacity"]);return i.fill=e.get("backgroundColor"),new $u({shape:{x:t.x-n[3],y:t.y-n[0],width:t.width+n[1]+n[3],height:t.height+n[0]+n[2],r:e.get("borderRadius")},style:i,silent:!0,z2:-1})}(d,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this.pv&&this.group.remove(this.pv),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,e,n,i,r,o,a){var s=this.getContentGroup(),l=Or(),c=e.get("selectedMode"),h=e.get("triggerEvent"),u=[];n.eachRawSeries(function(t){!t.get("legendHoverLink")&&u.push(t.id)}),_R(e.getData(),function(r,o){var a=this,d=r.get("name");if(!this.newlineDisabled&&(""===d||"\n"===d)){var f=new IR;return f.newline=!0,void s.add(f)}var p=n.getSeriesByName(d)[0];if(!l.get(d))if(p){var m=p.getData(),g=m.getVisual("legendLineStyle")||{},v=m.getVisual("legendIcon"),y=m.getVisual("style"),b=this.vv(p,d,o,r,e,t,g,y,v,c,i);b.on("click",RR(ER,d,null,i,u)).on("mouseover",RR(LR,p.name,null,i,u)).on("mouseout",RR(PR,p.name,null,i,u)),n.ssr&&b.eachChild(function(t){var e=Bu(t);e.seriesIndex=p.seriesIndex,e.dataIndex=o,e.ssrType="legend"}),h&&b.eachChild(function(t){a.packEventData(t,e,p,o,d)}),l.set(d,!0)}else n.eachRawSeries(function(a){var s=this;if(!l.get(d)&&a.legendVisualProvider){var f=a.legendVisualProvider;if(!f.containName(d))return;var p=f.indexOfName(d),m=f.getItemVisual(p,"style"),g=f.getItemVisual(p,"legendIcon"),v=cs(m.fill);v&&0===v[3]&&(v[3]=.2,m=nr(nr({},m),{fill:ms(v,"rgba")}));var y=this.vv(a,d,o,r,e,t,{},m,g,c,i);y.on("click",RR(ER,null,d,i,u)).on("mouseover",RR(LR,null,d,i,u)).on("mouseout",RR(PR,null,d,i,u)),n.ssr&&y.eachChild(function(t){var e=Bu(t);e.seriesIndex=a.seriesIndex,e.dataIndex=o,e.ssrType="legend"}),h&&y.eachChild(function(t){s.packEventData(t,e,a,o,d)}),l.set(d,!0)}},this)},this),r&&this.bv(r,e,i,o,a)},e.prototype.packEventData=function(t,e,n,i,r){var o={componentType:"legend",componentIndex:e.componentIndex,dataIndex:i,value:r,seriesIndex:n.seriesIndex};Bu(t).eventData=o},e.prototype.bv=function(t,e,n,i,r){var o=this.getSelectorGroup();_R(t,function(t){var i=t.type,r=new ku({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){n.dispatchAction({type:"all"===i?"legendAllSelect":"legendInverseSelect",legendId:e.id})}});o.add(r),Pp(r,{normal:e.getModel("selectorLabel"),emphasis:e.getModel(["emphasis","selectorLabel"])},{defaultText:t.title}),Md(r)})},e.prototype.vv=function(t,e,n,i,r,o,a,s,l,c,h){var u=t.visualDrawType,d=r.get("itemWidth"),f=r.get("itemHeight"),p=r.isSelected(e),m=i.get("symbolRotate"),g=i.get("symbolKeepAspect"),v=i.get("icon"),y=function(t,e,n,i,r,o,a){function s(t,e){"auto"===t.lineWidth&&(t.lineWidth=e.lineWidth>0?2:0),_R(t,function(n,i){"inherit"===t[i]&&(t[i]=e[i])})}var l=e.getModel("itemStyle"),c=l.getItemStyle(),h=0===t.lastIndexOf("empty",0)?"fill":"stroke",u=l.getShallow("decal");c.decal=u&&"inherit"!==u?Lx(u,a):i.decal,"inherit"===c.fill&&(c.fill=i[r]),"inherit"===c.stroke&&(c.stroke=i[h]),"inherit"===c.opacity&&(c.opacity=("fill"===r?i:n).opacity),s(c,i);var d=e.getModel("lineStyle"),f=d.getLineStyle();if(s(f,n),"auto"===c.fill&&(c.fill=i.fill),"auto"===c.stroke&&(c.stroke=i.fill),"auto"===f.stroke&&(f.stroke=i.fill),!o){var p=e.get("inactiveBorderWidth"),m=c[h];c.lineWidth="auto"===p?i.lineWidth>0&&m?2:0:c.lineWidth,c.fill=e.get("inactiveColor"),c.stroke=e.get("inactiveBorderColor"),f.stroke=d.get("inactiveColor"),f.lineWidth=d.get("inactiveWidth")}return{itemStyle:c,lineStyle:f}}(l=v||l||"roundRect",i,a,s,u,p,h),b=new IR,x=i.getModel("textStyle");if(!gr(t.getLegendIcon)||v&&"inherit"!==v){var w="inherit"===v&&t.getData().getVisual("symbol")?"inherit"===m?t.getData().getVisual("symbolRotate"):m:0;b.add(function(t){var e=t.icon||"roundRect",n=lx(e,0,0,t.itemWidth,t.itemHeight,t.itemStyle.fill,t.symbolKeepAspect);return n.setStyle(t.itemStyle),n.rotation=(t.iconRotate||0)*Math.PI/180,n.setOrigin([t.itemWidth/2,t.itemHeight/2]),e.indexOf("empty")>-1&&(n.style.stroke=n.style.fill,n.style.fill=mg.color.neutral00,n.style.lineWidth=2),n}({itemWidth:d,itemHeight:f,icon:l,iconRotate:w,itemStyle:y.itemStyle,symbolKeepAspect:g}))}else b.add(t.getLegendIcon({itemWidth:d,itemHeight:f,icon:l,iconRotate:m,itemStyle:y.itemStyle,lineStyle:y.lineStyle,symbolKeepAspect:g}));var S="left"===o?d+5:-5,C=o,T=r.get("formatter"),$=e;vr(T)&&T?$=T.replace("{name}",null!=e?e:""):gr(T)&&($=T(e));var M=p?x.getTextColor():i.get("inactiveColor");b.add(new ku({style:Op(x,{text:$,x:S,y:f/2,fill:M,align:C,verticalAlign:"middle"},{inheritColor:M})}));var A=new $u({shape:b.getBoundingRect(),style:{fill:"transparent"}}),N=i.getModel("tooltip");return N.get("show")&&Tp({el:A,componentModel:r,itemName:e,itemTooltipOption:N.option}),b.add(A),b.eachChild(function(t){t.silent=!0}),A.silent=!c,this.getContentGroup().add(b),Md(b),b.__legendDataIndex=n,b},e.prototype.layoutInner=function(t,e,n,i,r,o){var a=this.getContentGroup(),s=this.getSelectorGroup();sg(t.get("orient"),a,t.get("itemGap"),n.width,n.height);var l=a.getBoundingRect(),c=[-l.x,-l.y];if(s.markRedraw(),a.markRedraw(),r){sg("horizontal",s,t.get("selectorItemGap",!0));var h=s.getBoundingRect(),u=[-h.x,-h.y],d=t.get("selectorButtonGap",!0),f=t.getOrient().index,p=0===f?"width":"height",m=0===f?"height":"width",g=0===f?"y":"x";"end"===o?u[f]+=l[p]+d:c[f]+=h[p]+d,u[1-f]+=l[m]/2-h[m]/2,s.x=u[0],s.y=u[1],a.x=c[0],a.y=c[1];var v={x:0,y:0};return v[p]=l[p]+d+h[p],v[m]=Math.max(l[m],h[m]),v[g]=Math.min(0,h[g]+u[1-f]),v}return a.x=c[0],a.y=c[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this.mv=!0},e.type="legend.plain",e}(Jy);function ER(t,e,n,i){PR(t,e,n,i),n.dispatchAction({type:"legendToggleSelect",name:null!=t?t:e}),LR(t,e,n,i)}function DR(t){for(var e,n=t.getZr().storage.getDisplayList(),i=0,r=n.length;i<r&&!(e=n[i].states.emphasis);)i++;return e&&e.hoverLayer}function LR(t,e,n,i){DR(n)||n.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:i})}function PR(t,e,n,i){DR(n)||n.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:i})}function zR(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries(function(t){for(var n=0;n<e.length;n++)if(!e[n].isSelected(t.name))return!1;return!0})}function OR(t,e,n){var i="allSelect"===t||"inverseSelect"===t,r={},o=[];n.eachComponent({mainType:"legend",query:e},function(n){i?n[t]():n[t](e.name),BR(n,r),o.push(n.componentIndex)});var a={};return n.eachComponent("legend",function(t){sr(r,function(e,n){t[e?"select":"unSelect"](n)}),BR(t,a)}),i?{selected:a,legendIndex:o}:{name:e.name,selected:a}}function BR(t,e){var n=e||{};return sr(t.getData(),function(e){var i=e.get("name");if("\n"!==i&&""!==i){var r=t.isSelected(i);Ur(n,i)?n[i]=n[i]&&r:n[i]=r}}),n}function VR(t){t.registerComponentModel(kR),t.registerComponentView(FR),t.registerProcessor(t.PRIORITY.PROCESSOR.SERIES_FILTER,zR),t.registerSubTypeDefaulter("legend",function(){return"plain"}),function(t){t.registerAction("legendToggleSelect","legendselectchanged",pr(OR,"toggleSelected")),t.registerAction("legendAllSelect","legendselectall",pr(OR,"allSelect")),t.registerAction("legendInverseSelect","legendinverseselect",pr(OR,"inverseSelect")),t.registerAction("legendSelect","legendselected",pr(OR,"select")),t.registerAction("legendUnSelect","legendunselected",pr(OR,"unSelect"))}(t)}var HR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n}return Ei(e,t),e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(e,n,i){var r=dg(e);t.prototype.init.call(this,e,n,i),UR(this,e,r)},e.prototype.mergeOption=function(e,n){t.prototype.mergeOption.call(this,e,n),UR(this,this.option,e)},e.type="legend.scroll",e.defaultOption=am(kR.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:mg.color.accent50,pageIconInactiveColor:mg.color.accent10,pageIconSize:15,pageTextStyle:{color:mg.color.tertiary},animationDurationUpdate:800}),e}(kR);function UR(t,e,n){var i=[1,1];i[t.getOrient().index]=0,ug(e,n,{type:"box",ignoreSize:!!i})}var qR=Il,KR=["width","height"],WR=["x","y"],jR=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.type=e.type,n.newlineDisabled=!0,n.gv=0,n}return Ei(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.group.add(this.jm=new qR),this.jm.add(this.getContentGroup()),this.group.add(this.yv=new qR)},e.prototype.resetInner=function(){t.prototype.resetInner.call(this),this.yv.removeAll(),this.jm.removeClipPath(),this.jm.__rectSize=null},e.prototype.renderInner=function(e,n,i,r,o,a,s){var l=this;t.prototype.renderInner.call(this,e,n,i,r,o,a,s);var c=this.yv,h=n.get("pageIconSize",!0),u=mr(h)?h:[h,h];f("pagePrev",0);var d=n.getModel("pageTextStyle");function f(t,e){var i=t+"DataIndex",o=yp(n.get("pageIcons",!0)[n.getOrient().name][e],{onclick:fr(l.wv,l,i,n,r)},{x:-u[0]/2,y:-u[1]/2,width:u[0],height:u[1]});o.name=t,c.add(o)}c.add(new ku({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),f("pageNext",1)},e.prototype.layoutInner=function(t,e,n,i,r,o){var a=this.getSelectorGroup(),s=t.getOrient().index,l=KR[s],c=WR[s],h=KR[1-s],u=WR[1-s];r&&sg("horizontal",a,t.get("selectorItemGap",!0));var d=t.get("selectorButtonGap",!0),f=a.getBoundingRect(),p=[-f.x,-f.y],m=tr(n);r&&(m[l]=n[l]-f[l]-d);var g=this.xv(t,i,m,s,l,h,u,c);if(r){if("end"===o)p[s]+=g[l]+d;else{var v=f[l]+d;p[s]-=v,g[c]-=v}g[l]+=f[l]+d,p[1-s]+=g[u]+g[h]/2-f[h]/2,g[h]=Math.max(g[h],f[h]),g[u]=Math.min(g[u],f[u]+p[1-s]),a.x=p[0],a.y=p[1],a.markRedraw()}return g},e.prototype.xv=function(t,e,n,i,r,o,a,s){var l=this.getContentGroup(),c=this.jm,h=this.yv;sg(t.get("orient"),l,t.get("itemGap"),i?n.width:null,i?null:n.height),sg("horizontal",h,t.get("pageButtonItemGap",!0));var u=l.getBoundingRect(),d=h.getBoundingRect(),f=this.$v=u[r]>n[r],p=[-u.x,-u.y];e||(p[i]=l[s]);var m=[0,0],g=[-d.x,-d.y],v=Ar(t.get("pageButtonGap",!0),t.get("itemGap",!0));f&&("end"===t.get("pageButtonPosition",!0)?g[i]+=n[r]-d[r]:m[i]+=d[r]+v),g[1-i]+=u[o]/2-d[o]/2,l.setPosition(p),c.setPosition(m),h.setPosition(g);var y={x:0,y:0};if(y[r]=f?n[r]:u[r],y[o]=Math.max(u[o],d[o]),y[a]=Math.min(0,d[a]+g[1-i]),c.__rectSize=n[r],f){var b={x:0,y:0};b[r]=Math.max(n[r]-d[r]-v,0),b[o]=y[o],c.setClipPath(new $u({shape:b})),c.__rectSize=b[r]}else h.eachChild(function(t){t.attr({invisible:!0,silent:!0})});var x=this.Mv(t);return null!=x.pageIndex&&Zf(l,{x:x.contentPosition[0],y:x.contentPosition[1]},f?t:null),this.Cv(t,x),y},e.prototype.wv=function(t,e,n){var i=this.Mv(e)[t];null!=i&&n.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:e.id})},e.prototype.Cv=function(t,e){var n=this.yv;sr(["pagePrev","pageNext"],function(i){var r=null!=e[i+"DataIndex"],o=n.childOfName(i);o&&(o.setStyle("fill",r?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),o.cursor=r?"pointer":"default")});var i=n.childOfName("pageText"),r=t.get("pageFormatter"),o=e.pageIndex,a=null!=o?o+1:0,s=e.pageCount;i&&r&&i.setStyle("text",vr(r)?r.replace("{current}",null==a?"":a+"").replace("{total}",null==s?"":s+""):r({current:a,total:s}))},e.prototype.Mv=function(t){var e=t.get("scrollDataIndex",!0),n=this.getContentGroup(),i=this.jm.__rectSize,r=t.getOrient().index,o=KR[r],a=WR[r],s=this.Sv(e),l=n.children(),c=l[s],h=l.length,u=h?1:0,d={contentPosition:[n.x,n.y],pageCount:u,pageIndex:u-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return d;var f=y(c);d.contentPosition[r]=-f.s;for(var p=s+1,m=f,g=f,v=null;p<=h;++p)(!(v=y(l[p]))&&g.e>m.s+i||v&&!b(v,m.s))&&(m=g.i>m.i?g:v)&&(null==d.pageNextDataIndex&&(d.pageNextDataIndex=m.i),++d.pageCount),g=v;for(p=s-1,m=f,g=f,v=null;p>=-1;--p)(v=y(l[p]))&&b(g,v.s)||!(m.i<g.i)||(g=m,null==d.pagePrevDataIndex&&(d.pagePrevDataIndex=m.i),++d.pageCount,++d.pageIndex),m=v;return d;function y(t){if(t){var e=t.getBoundingRect(),n=e[a]+t[a];return{s:n,e:n+e[o],i:t.__legendDataIndex}}}function b(t,e){return t.e>=e&&t.s<=e+i}},e.prototype.Sv=function(t){return this.$v?(this.getContentGroup().eachChild(function(i,r){var o=i.__legendDataIndex;null==n&&null!=o&&(n=r),o===t&&(e=r)}),null!=e?e:n):0;var e,n},e.type="legend.scroll",e}(FR);function GR(t){RC(VR),t.registerComponentModel(HR),t.registerComponentView(jR),function(t){t.registerAction("legendScroll","legendscroll",function(t,e){var n=t.scrollDataIndex;null!=n&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},function(t){t.setScrollDataIndex(n)})})}(t)}function XR(t,e,n){var i=Oi.createCanvas(),r=e.getWidth(),o=e.getHeight(),a=i.style;return a&&(a.position="absolute",a.left="0",a.top="0",a.width=r+"px",a.height=o+"px",i.setAttribute("data-zr-dom-id",t)),i.width=r*n,i.height=o*n,i}var YR=function(t){function e(e,n,i){var r,o=t.call(this)||this;o.motionBlur=!1,o.lastFrameAlpha=.7,o.dpr=1,o.virtual=!1,o.config={},o.incremental=!1,o.zlevel=0,o.maxRepaintRectCount=5,o.__dirty=!0,o.__firstTimePaint=!0,o.__used=!1,o.__drawIndex=0,o.__startIndex=0,o.__endIndex=0,o.__prevStartIndex=null,o.__prevEndIndex=null,i=i||Zs,"string"==typeof e?r=XR(e,n,i):xr(e)&&(e=(r=e).id),o.id=e,o.dom=r;var a=r.style;return a&&(Hr(r),r.onselectstart=function(){return!1},a.padding="0",a.margin="0",a.borderWidth="0"),o.painter=n,o.dpr=i,o}return Ei(e,t),e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var t=this.dpr;this.domBack=XR("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!==t&&this.ctxBack.scale(t,t)},e.prototype.createRepaintRects=function(t,e,n,i){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var r,o=[],a=this.maxRepaintRectCount,s=!1,l=new Jo(0,0,0,0);function c(t){if(t.isFinite()&&!t.isZero())if(0===o.length)(e=new Jo(0,0,0,0)).copy(t),o.push(e);else{for(var e,n=!1,i=1/0,r=0,c=0;c<o.length;++c){var h=o[c];if(h.intersect(t)){var u=new Jo(0,0,0,0);u.copy(h),u.union(t),o[c]=u,n=!0;break}if(s){l.copy(t),l.union(h);var d=t.width*t.height,f=h.width*h.height,p=l.width*l.height-d-f;p<i&&(i=p,r=c)}}s&&(o[r].union(t),n=!0),n||((e=new Jo(0,0,0,0)).copy(t),o.push(e)),s||(s=o.length>=a)}}for(var h=this.__startIndex;h<this.__endIndex;++h)if(f=t[h]){var u=f.shouldBePainted(n,i,!0,!0);(p=f.__isRendered&&(1&f.__dirty||!u)?f.getPrevPaintRect():null)&&c(p);var d=u&&(1&f.__dirty||!f.__isRendered)?f.getPaintRect():null;d&&c(d)}for(h=this.__prevStartIndex;h<this.__prevEndIndex;++h){var f,p;u=(f=e[h])&&f.shouldBePainted(n,i,!0,!0),!f||u&&f.__zr||!f.__isRendered||(p=f.getPrevPaintRect())&&c(p)}do{for(r=!1,h=0;h<o.length;)if(o[h].isZero())o.splice(h,1);else{for(var m=h+1;m<o.length;)o[h].intersect(o[m])?(r=!0,o[h].union(o[m]),o.splice(m,1)):m++;h++}}while(r);return this.Rv=o,o},e.prototype.debugGetPaintRects=function(){return(this.Rv||[]).slice()},e.prototype.resize=function(t,e){var n=this.dpr,i=this.dom,r=i.style,o=this.domBack;r&&(r.width=t+"px",r.height=e+"px"),i.width=t*n,i.height=e*n,o&&(o.width=t*n,o.height=e*n,1!==n&&this.ctxBack.scale(n,n))},e.prototype.clear=function(t,e,n){var i=this.dom,r=this.ctx,o=i.width,a=i.height;e=e||this.clearColor;var s=this.motionBlur&&!t,l=this.lastFrameAlpha,c=this.dpr,h=this;s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(i,0,0,o/c,a/c));var u=this.domBack;function d(t,n,i,o){if(r.clearRect(t,n,i,o),e&&"transparent"!==e){var a=void 0;Tr(e)?(a=(e.global||e.__width===i&&e.__height===o)&&e.__canvasGradient||dx(r,e,{x:0,y:0,width:i,height:o}),e.__canvasGradient=a,e.__width=i,e.__height=o):null!=e.image&&(e.scaleX=e.scaleX||c,e.scaleY=e.scaleY||c,a=Cx(r,e,{dirty:function(){h.setUnpainted(),h.painter.refresh()}})),r.save(),r.fillStyle=a||e,r.fillRect(t,n,i,o),r.restore()}s&&(r.save(),r.globalAlpha=l,r.drawImage(u,t,n,i,o),r.restore())}!n||s?d(0,0,o,a):n.length&&sr(n,function(t){d(t.x*c,t.y*c,t.width*c,t.height*c)})},e}(ao),ZR=1e5,JR=314159,QR=.01,t_=function(){function t(t,e,n,i){this.type="canvas",this.Av=[],this.kv=[],this.Tv={},this.Nv={},this.Fv=!1,this.type="canvas";var r=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._v=n=nr({},n||{}),this.dpr=n.devicePixelRatio||Zs,this.Ev=r,this.root=t,t.style&&(Hr(t),t.innerHTML=""),this.storage=e;var o=this.Av;this.kv=[];var a=this.Tv;if(r){var s=t,l=s.width,c=s.height;null!=n.width&&(l=n.width),null!=n.height&&(c=n.height),this.dpr=n.devicePixelRatio||1,s.width=l*this.dpr,s.height=c*this.dpr,this.Nt=l,this.Mt=c;var h=new YR(s,this,this.dpr);h.__builtin__=!0,h.initContext(),a[314159]=h,h.zlevel=JR,o.push(JR),this.Iv=t}else{this.Nt=px(t,0,n),this.Mt=px(t,1,n);var u=this.Iv=function(t,e){var n=document.createElement("div");return n.style.cssText=["position:relative","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}(this.Nt,this.Mt);t.appendChild(u)}}return t.prototype.getType=function(){return"canvas"},t.prototype.isSingleCanvas=function(){return this.Ev},t.prototype.getViewportRoot=function(){return this.Iv},t.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},t.prototype.refresh=function(t){var e=this.storage.getDisplayList(!0),n=this.kv,i=this.Av;this.zv=Math.random(),this.Dv(e,n,t,this.zv);for(var r=0;r<i.length;r++){var o=i[r],a=this.Tv[o];if(!a.__builtin__&&a.refresh){var s=0===r?this.pl:null;a.refresh(s)}}return this._v.useDirtyRect&&(this.kv=e.slice()),this},t.prototype.refreshHover=function(){this.Lv(this.storage.getDisplayList(!1))},t.prototype.Lv=function(t){var e=t.length,n=this.Ov;if(n&&n.clear(),e){for(var i,r={inHover:!0,viewWidth:this.Nt,viewHeight:this.Mt},o=0;o<e;o++){var a=t[o];a.__inHover&&(n||(n=this.Ov=this.getLayer(ZR)),i||(i=n.ctx).save(),Ix(i,a,r,o===e-1))}i&&i.restore()}},t.prototype.getHoverLayer=function(){return this.getLayer(ZR)},t.prototype.paintOne=function(t,e){_x(t,e)},t.prototype.Dv=function(t,e,n,i){if(this.zv===i){n=n||!1,this.Pv(t);var r=this.Vv(t,e,n),o=r.finished,a=r.needsRefreshHover;if(this.Fv&&this.Bv(),a&&this.Lv(t),o)this.eachLayer(function(t){t.afterBrush&&t.afterBrush()});else{var s=this;wa(function(){s.Dv(t,e,n,i)})}}},t.prototype.Bv=function(){var t=this.getLayer(JR).ctx,e=this.Iv.width,n=this.Iv.height;t.clearRect(0,0,e,n),this.eachBuiltinLayer(function(i){i.virtual&&t.drawImage(i.dom,0,0,e,n)})},t.prototype.Vv=function(t,e,n){for(var i=this,r=[],o=this._v.useDirtyRect,a=0;a<this.Av.length;a++){var s=this.Av[a],l=this.Tv[s];l.__builtin__&&l!==this.Ov&&(l.__dirty||n)&&r.push(l)}for(var c=!0,h=!1,u=function(a){var s,l=r[a],u=l.ctx,f=o&&l.createRepaintRects(t,e,d.Nt,d.Mt),p=n?l.__startIndex:l.__drawIndex,m=!n&&l.incremental&&Date.now,g=m&&Date.now(),v=l.zlevel===d.Av[0]?d.pl:null;if(l.__startIndex===l.__endIndex)l.clear(!1,v,f);else if(p===l.__startIndex){var y=t[p];y.incremental&&y.notClear&&!n||l.clear(!1,v,f)}-1===p&&(p=l.__startIndex);var b=function(e){var n={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i.Nt,viewHeight:i.Mt};for(s=p;s<l.__endIndex;s++){var r=t[s];if(r.__inHover&&(h=!0),i.Hv(r,l,o,e,n,s===l.__endIndex-1),m&&Date.now()-g>15)break}n.prevElClipPaths&&u.restore()};if(f)if(0===f.length)s=l.__endIndex;else for(var x=d.dpr,w=0;w<f.length;++w){var S=f[w];u.save(),u.beginPath(),u.rect(S.x*x,S.y*x,S.width*x,S.height*x),u.clip(),b(S),u.restore()}else u.save(),b(),u.restore();l.__drawIndex=s,l.__drawIndex<l.__endIndex&&(c=!1)},d=this,f=0;f<r.length;f++)u(f);return Li.wxa&&sr(this.Tv,function(t){t&&t.ctx&&t.ctx.draw&&t.ctx.draw()}),{finished:c,needsRefreshHover:h}},t.prototype.Hv=function(t,e,n,i,r,o){var a=e.ctx;if(n){var s=t.getPaintRect();(!i||s&&s.intersect(i))&&(Ix(a,t,r,o),t.setPrevPaintRect(s))}else Ix(a,t,r,o)},t.prototype.getLayer=function(t,e){this.Ev&&!this.Fv&&(t=JR);var n=this.Tv[t];return n||((n=new YR("zr_"+t,this,this.dpr)).zlevel=t,n.__builtin__=!0,this.Nv[t]?er(n,this.Nv[t],!0):this.Nv[t-QR]&&er(n,this.Nv[t-QR],!0),e&&(n.virtual=e),this.insertLayer(t,n),n.initContext()),n},t.prototype.insertLayer=function(t,e){var n=this.Tv,i=this.Av,r=i.length,o=this.Iv,a=null,s=-1;if(!n[t]&&function(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}(e)){if(r>0&&t>i[0]){for(s=0;s<r-1&&!(i[s]<t&&i[s+1]>t);s++);a=n[i[s]]}if(i.splice(s+1,0,t),n[t]=e,!e.virtual)if(a){var l=a.dom;l.nextSibling?o.insertBefore(e.dom,l.nextSibling):o.appendChild(e.dom)}else o.firstChild?o.insertBefore(e.dom,o.firstChild):o.appendChild(e.dom);e.painter||(e.painter=this)}},t.prototype.eachLayer=function(t,e){for(var n=this.Av,i=0;i<n.length;i++){var r=n[i];t.call(e,this.Tv[r],r)}},t.prototype.eachBuiltinLayer=function(t,e){for(var n=this.Av,i=0;i<n.length;i++){var r=n[i],o=this.Tv[r];o.__builtin__&&t.call(e,o,r)}},t.prototype.eachOtherLayer=function(t,e){for(var n=this.Av,i=0;i<n.length;i++){var r=n[i],o=this.Tv[r];o.__builtin__||t.call(e,o,r)}},t.prototype.getLayers=function(){return this.Tv},t.prototype.Pv=function(t){function e(t){o&&(o.__endIndex!==t&&(o.__dirty=!0),o.__endIndex=t)}if(this.eachBuiltinLayer(function(t,e){t.__dirty=t.__used=!1}),this.Ev)for(var n=1;n<t.length;n++)if((s=t[n]).zlevel!==t[n-1].zlevel||s.incremental){this.Fv=!0;break}var i,r,o=null,a=0;for(r=0;r<t.length;r++){var s,l=(s=t[r]).zlevel,c=void 0;i!==l&&(i=l,a=0),s.incremental?((c=this.getLayer(l+.001,this.Fv)).incremental=!0,a=1):c=this.getLayer(l+(a>0?QR:0),this.Fv),c.__builtin__||Qi("ZLevel "+l+" has been used by unkown layer "+c.id),c!==o&&(c.__used=!0,c.__startIndex!==r&&(c.__dirty=!0),c.__startIndex=r,c.incremental?c.__drawIndex=-1:c.__drawIndex=r,e(r),o=c),1&s.__dirty&&!s.__inHover&&(c.__dirty=!0,c.incremental&&c.__drawIndex<0&&(c.__drawIndex=r))}e(r),this.eachBuiltinLayer(function(t,e){!t.__used&&t.getElementCount()>0&&(t.__dirty=!0,t.__startIndex=t.__endIndex=t.__drawIndex=0),t.__dirty&&t.__drawIndex<0&&(t.__drawIndex=t.__startIndex)})},t.prototype.clear=function(){return this.eachBuiltinLayer(this.Uv),this},t.prototype.Uv=function(t){t.clear()},t.prototype.setBackgroundColor=function(t){this.pl=t,sr(this.Tv,function(t){t.setUnpainted()})},t.prototype.configLayer=function(t,e){if(e){var n=this.Nv;n[t]?er(n[t],e,!0):n[t]=e;for(var i=0;i<this.Av.length;i++){var r=this.Av[i];r!==t&&r!==t+QR||er(this.Tv[r],n[t],!0)}}},t.prototype.delLayer=function(t){var e=this.Tv,n=this.Av,i=e[t];i&&(i.dom.parentNode.removeChild(i.dom),delete e[t],n.splice(rr(n,t),1))},t.prototype.resize=function(t,e){if(this.Iv.style){var n=this.Iv;n.style.display="none";var i=this._v,r=this.root;if(null!=t&&(i.width=t),null!=e&&(i.height=e),t=px(r,0,i),e=px(r,1,i),n.style.display="",this.Nt!==t||e!==this.Mt){for(var o in n.style.width=t+"px",n.style.height=e+"px",this.Tv)this.Tv.hasOwnProperty(o)&&this.Tv[o].resize(t,e);this.refresh(!0)}this.Nt=t,this.Mt=e}else{if(null==t||null==e)return;this.Nt=t,this.Mt=e,this.getLayer(JR).resize(t,e)}return this},t.prototype.clearLayer=function(t){var e=this.Tv[t];e&&e.clear()},t.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this.Iv=this.Tv=null},t.prototype.getRenderedCanvas=function(t){if(t=t||{},this.Ev&&!this.Bv)return this.Tv[314159].dom;var e=new YR("image",this,t.pixelRatio||this.dpr);e.initContext(),e.clear(!1,t.backgroundColor||this.pl);var n=e.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var i=e.dom.width,r=e.dom.height;this.eachLayer(function(t){t.__builtin__?n.drawImage(t.dom,0,0,i,r):t.renderToCanvas&&(n.save(),t.renderToCanvas(n),n.restore())})}else for(var o={inHover:!1,viewWidth:this.Nt,viewHeight:this.Mt},a=this.storage.getDisplayList(!0),s=0,l=a.length;s<l;s++){var c=a[s];Ix(n,c,o,s===l-1)}return e.dom},t.prototype.getWidth=function(){return this.Nt},t.prototype.getHeight=function(){return this.Mt},t}();function e_(t,e,n,i,r,o,a=-Math.PI/2){const s=e+i/2,l=n+r/2,c=i/2,h=r/2;for(let u=0;u<o;u++){const e=2*Math.PI/o*u+a,n=s+c*Math.cos(e),i=l+h*Math.sin(e);0===u?t.moveTo(n,i):t.lineTo(n,i)}t.closePath()}function n_(t,e,n,i,r,o,a=.38){const s=e+i/2,l=n+r/2,c=i/2,h=r/2,u=c*a,d=h*a;for(let f=0;f<2*o;f++){const e=Math.PI/o*f-Math.PI/2,n=f%2==0,i=n?h:d,r=s+(n?c:u)*Math.cos(e),a=l+i*Math.sin(e);0===f?t.moveTo(r,a):t.lineTo(r,a)}t.closePath()}function i_(t,e,n,i,r,o=.1){const a=Math.min(i,r)*o;t.roundRect?t.roundRect(e,n,i,r,a):(t.moveTo(e+a,n),t.lineTo(e+i-a,n),t.arcTo(e+i,n,e+i,n+a,a),t.lineTo(e+i,n+r-a),t.arcTo(e+i,n+r,e+i-a,n+r,a),t.lineTo(e+a,n+r),t.arcTo(e,n+r,e,n+r-a,a),t.lineTo(e,n+a),t.arcTo(e,n,e+a,n,a),t.closePath())}function r_(t,e,n,i,r,o){const a=.6;if("right"===o){const o=.7*i,s=r*a,l=n+r/2;t.moveTo(e,l-s/2),t.lineTo(e+o,l-s/2),t.lineTo(e+o,n),t.lineTo(e+i,l),t.lineTo(e+o,n+r),t.lineTo(e+o,l+s/2),t.lineTo(e,l+s/2)}else if("left"===o){const o=.3*i,s=r*a,l=n+r/2;t.moveTo(e,l),t.lineTo(e+o,n),t.lineTo(e+o,l-s/2),t.lineTo(e+i,l-s/2),t.lineTo(e+i,l+s/2),t.lineTo(e+o,l+s/2),t.lineTo(e+o,n+r)}else if("up"===o){const o=.3*r,s=i*a,l=e+i/2;t.moveTo(l,n),t.lineTo(e+i,n+o),t.lineTo(l+s/2,n+o),t.lineTo(l+s/2,n+r),t.lineTo(l-s/2,n+r),t.lineTo(l-s/2,n+o),t.lineTo(e,n+o)}else if("down"===o){const o=.7*r,s=i*a,l=e+i/2;t.moveTo(l-s/2,n),t.lineTo(l+s/2,n),t.lineTo(l+s/2,n+o),t.lineTo(e+i,n+o),t.lineTo(l,n+r),t.lineTo(e,n+o),t.lineTo(l-s/2,n+o)}t.closePath()}const o_={line(t,e,n,i,r){t.moveTo(e,n),t.lineTo(e+i,n+r)},straightConnector1(t,e,n,i,r){t.moveTo(e,n),t.lineTo(e+i,n+r)},bentConnector3(t,e,n,i,r){const o=e+i/2;t.moveTo(e,n),t.lineTo(o,n),t.lineTo(o,n+r),t.lineTo(e+i,n+r)},curvedConnector3(t,e,n,i,r){const o=e+i/2;t.moveTo(e,n),t.bezierCurveTo(o,n,o,n+r,e+i,n+r)},rect(t,e,n,i,r){t.rect(e,n,i,r)},roundRect(t,e,n,i,r){i_(t,e,n,i,r,.1)},snip1Rect(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e+i-o,n),t.lineTo(e+i,n+o),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.lineTo(e,n),t.closePath()},snip2SameRect(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+o),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.lineTo(e,n+o),t.closePath()},snip2DiagRect(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+o),t.lineTo(e+i,n+r),t.lineTo(e+o,n+r),t.lineTo(e,n+r-o),t.closePath()},snipRoundRect(t,e,n,i,r){const o=.15*Math.min(i,r),a=.1*Math.min(i,r);t.moveTo(e+i-o,n),t.lineTo(e+i,n+o),t.lineTo(e+i,n+r-a),t.arcTo(e+i,n+r,e+i-a,n+r,a),t.lineTo(e+a,n+r),t.arcTo(e,n+r,e,n+r-a,a),t.lineTo(e,n+a),t.arcTo(e,n,e+a,n,a),t.lineTo(e+i-o,n)},round1Rect(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e+i-o,n),t.arcTo(e+i,n,e+i,n+o,o),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.lineTo(e,n),t.closePath()},round2SameRect(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.arcTo(e+i,n,e+i,n+o,o),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.lineTo(e,n+o),t.arcTo(e,n,e+o,n,o),t.closePath()},round2DiagRect(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e,n+o),t.arcTo(e,n,e+o,n,o),t.lineTo(e+i,n),t.lineTo(e+i,n+r-o),t.arcTo(e+i,n+r,e+i-o,n+r,o),t.lineTo(e,n+r),t.closePath()},ellipse(t,e,n,i,r){const o=e+i/2,a=n+r/2;t.ellipse(o,a,i/2,r/2,0,0,2*Math.PI)},triangle(t,e,n,i,r){t.moveTo(e+i/2,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.closePath()},rtTriangle(t,e,n,i,r){t.moveTo(e,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.closePath()},parallelogram(t,e,n,i,r){const o=.2*i;t.moveTo(e+o,n),t.lineTo(e+i,n),t.lineTo(e+i-o,n+r),t.lineTo(e,n+r),t.closePath()},trapezoid(t,e,n,i,r){const o=.2*i;t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.closePath()},diamond(t,e,n,i,r){const o=e+i/2,a=n+r/2;t.moveTo(o,n),t.lineTo(e+i,a),t.lineTo(o,n+r),t.lineTo(e,a),t.closePath()},pentagon(t,e,n,i,r){e_(t,e,n,i,r,5)},hexagon(t,e,n,i,r){e_(t,e,n,i,r,6,0)},heptagon(t,e,n,i,r){e_(t,e,n,i,r,7)},octagon(t,e,n,i,r){e_(t,e,n,i,r,8,Math.PI/8)},decagon(t,e,n,i,r){e_(t,e,n,i,r,10,0)},dodecagon(t,e,n,i,r){e_(t,e,n,i,r,12,Math.PI/12)},pie(t,e,n,i,r){const o=e+i/2,a=n+r/2;t.moveTo(o,a),t.arc(o,a,Math.min(i,r)/2,0,1.5*Math.PI),t.closePath()},chord(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2;t.arc(o,a,s,0,1.5*Math.PI),t.closePath()},teardrop(t,e,n,i,r){const o=.4*Math.min(i,r),a=e+o+.3*(i-2*o),s=n+r-o;t.moveTo(e+i,n),t.bezierCurveTo(a+.5*o,n,a+o,s-.5*o,a+o,s),t.arc(a,s,o,0,Math.PI,!1),t.bezierCurveTo(a-o,s-.5*o,a-.3*o,n,e+i,n),t.closePath()},frame(t,e,n,i,r){const o=.15*Math.min(i,r);t.rect(e,n,i,r),t.moveTo(e+o,n+o),t.lineTo(e+o,n+r-o),t.lineTo(e+i-o,n+r-o),t.lineTo(e+i-o,n+o),t.closePath()},halfFrame(t,e,n,i,r){const o=.2*Math.min(i,r);t.moveTo(e+i-o,n+o),t.lineTo(e+i,n),t.lineTo(e,n),t.lineTo(e,n+r),t.lineTo(e+o,n+r-o),t.lineTo(e+o,n+o),t.closePath()},corner(t,e,n,i,r){const o=.4*Math.min(i,r);t.moveTo(e,n),t.lineTo(e+o,n),t.lineTo(e+o,n+r-o),t.lineTo(e+i,n+r-o),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.closePath()},diagStripe(t,e,n,i,r){const o=.25*Math.min(i,r);t.moveTo(e+o,n),t.lineTo(e+i,n),t.lineTo(e+i-o,n+r),t.lineTo(e,n+r),t.closePath()},plus(t,e,n,i,r){const o=.3*Math.min(i,r),a=e+i/2,s=n+r/2;t.moveTo(a-o/2,n),t.lineTo(a+o/2,n),t.lineTo(a+o/2,s-o/2),t.lineTo(e+i,s-o/2),t.lineTo(e+i,s+o/2),t.lineTo(a+o/2,s+o/2),t.lineTo(a+o/2,n+r),t.lineTo(a-o/2,n+r),t.lineTo(a-o/2,s+o/2),t.lineTo(e,s+o/2),t.lineTo(e,s-o/2),t.lineTo(a-o/2,s-o/2),t.closePath()},plaque(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e,n+o),t.arcTo(e+o,n+o,e+o,n,o),t.lineTo(e+i-o,n),t.arcTo(e+i-o,n+o,e+i,n+o,o),t.lineTo(e+i,n+r-o),t.arcTo(e+i-o,n+r-o,e+i-o,n+r,o),t.lineTo(e+o,n+r),t.arcTo(e+o,n+r-o,e,n+r-o,o),t.closePath()},can(t,e,n,i,r){const o=e+i/2,a=i/2,s=.15*r/2;t.ellipse(o,n+s,a,s,0,0,2*Math.PI),t.moveTo(e+i,n+s),t.lineTo(e+i,n+r-s),t.ellipse(o,n+r-s,a,s,0,0,Math.PI,!1),t.lineTo(e,n+s)},cube(t,e,n,i,r){const o=.3*Math.min(i,r);t.rect(e,n+o,i-o,r-o),t.moveTo(e,n+o),t.lineTo(e+o,n),t.lineTo(e+i,n),t.lineTo(e+i-o,n+o),t.moveTo(e+i-o,n+o),t.lineTo(e+i,n),t.lineTo(e+i,n+r-o),t.lineTo(e+i-o,n+r)},bevel(t,e,n,i,r){const o=.15*Math.min(i,r);t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+o),t.lineTo(e+i,n+r-o),t.lineTo(e+i-o,n+r),t.lineTo(e+o,n+r),t.lineTo(e,n+r-o),t.lineTo(e,n+o),t.closePath(),t.moveTo(e+o,n),t.lineTo(e+o,n+o),t.lineTo(e+i-o,n+o),t.lineTo(e+i-o,n),t.moveTo(e+i-o,n+o),t.lineTo(e+i-o,n+r-o),t.lineTo(e+i,n+r-o),t.moveTo(e+i-o,n+r-o),t.lineTo(e+o,n+r-o),t.lineTo(e+o,n+r),t.moveTo(e+o,n+r-o),t.lineTo(e+o,n+o),t.lineTo(e,n+o)},donut(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2,l=.6*s;t.arc(o,a,s,0,2*Math.PI),t.moveTo(o+l,a),t.arc(o,a,l,0,2*Math.PI,!0)},noSmoking(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2,l=.7*s;t.arc(o,a,s,0,2*Math.PI),t.moveTo(o+l,a),t.arc(o,a,l,0,2*Math.PI,!0);const c=.707*s;t.moveTo(o-c,a-c),t.lineTo(o+c,a+c)},blockArc(t,e,n,i,r){const o=e+i/2,a=n+r,s=Math.min(i,r),l=.5*s;t.arc(o,a,s,Math.PI,0),t.arc(o,a,l,0,Math.PI,!0),t.closePath()},foldedCorner(t,e,n,i,r){const o=.2*Math.min(i,r);t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r-o),t.lineTo(e+i-o,n+r),t.lineTo(e,n+r),t.closePath(),t.moveTo(e+i,n+r-o),t.lineTo(e+i-o,n+r-o),t.lineTo(e+i-o,n+r)},smileyFace(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2;t.arc(o,a,s,0,2*Math.PI),t.moveTo(o-.3*s+.1*s,a-.2*s),t.arc(o-.3*s,a-.2*s,.1*s,0,2*Math.PI),t.moveTo(o+.3*s+.1*s,a-.2*s),t.arc(o+.3*s,a-.2*s,.1*s,0,2*Math.PI),t.moveTo(o-.4*s,a+.1*s),t.quadraticCurveTo(o,a+.5*s,o+.4*s,a+.1*s)},heart(t,e,n,i,r){const o=e+i/2,a=n+.3*r;t.moveTo(o,n+r),t.bezierCurveTo(o,n+.7*r,e,a,e+.25*i,n),t.bezierCurveTo(e+i/2,n,o,a,o,a),t.bezierCurveTo(o,a,e+i/2,n,e+.75*i,n),t.bezierCurveTo(e+i,a,o,n+.7*r,o,n+r)},lightningBolt(t,e,n,i,r){t.moveTo(e+.35*i,n),t.lineTo(e+.45*i,n+.38*r),t.lineTo(e+.25*i,n+.38*r),t.lineTo(e+.4*i,n+.72*r),t.lineTo(e+.15*i,n+.72*r),t.lineTo(e+.35*i,n+r),t.lineTo(e+.6*i,n+.78*r),t.lineTo(e+.5*i,n+.78*r),t.lineTo(e+.7*i,n+.44*r),t.lineTo(e+.6*i,n+.44*r),t.lineTo(e+.8*i,n+.06*r),t.closePath()},sun(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=.3*Math.min(i,r),l=.5*Math.min(i,r);for(let c=0;c<24;c++){const e=Math.PI/12*c,n=c%2==0?l:s,i=o+n*Math.cos(e),r=a+n*Math.sin(e);0===c?t.moveTo(i,r):t.lineTo(i,r)}t.closePath()},moon(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2,l=.3*s;t.arc(o,a,s,0,2*Math.PI,!1),t.arc(o+l,a,.8*s,0,2*Math.PI,!0)},cloud(t,e,n,i,r){const o=.2*i,a=.25*r,s=.25*i;t.arc(e+o,n+a,o,Math.PI,1.5*Math.PI),t.arc(e+i/2,n+.8*a,s,1.2*Math.PI,1.8*Math.PI),t.arc(e+i-o,n+a,o,1.5*Math.PI,0),t.arc(e+i-.5*o,n+r-a,a,0,.5*Math.PI),t.arc(e+i/2,n+r-.6*a,s,.2*Math.PI,.8*Math.PI),t.arc(e+.5*o,n+r-a,a,.5*Math.PI,Math.PI),t.closePath()},arc(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2;t.arc(o,a,s,Math.PI,0)},bracketPair(t,e,n,i,r){const o=.15*i;t.moveTo(e+o,n),t.lineTo(e,n),t.lineTo(e,n+r),t.lineTo(e+o,n+r),t.moveTo(e+i-o,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r),t.lineTo(e+i-o,n+r)},bracePair(t,e,n,i,r){const o=.15*i,a=.2*r,s=n+r/2;t.moveTo(e+o,n),t.quadraticCurveTo(e+.3*o,n,e+.3*o,n+a),t.lineTo(e+.3*o,s-.5*a),t.quadraticCurveTo(e+.3*o,s,e,s),t.quadraticCurveTo(e+.3*o,s,e+.3*o,s+.5*a),t.lineTo(e+.3*o,n+r-a),t.quadraticCurveTo(e+.3*o,n+r,e+o,n+r),t.moveTo(e+i-o,n),t.quadraticCurveTo(e+i-.3*o,n,e+i-.3*o,n+a),t.lineTo(e+i-.3*o,s-.5*a),t.quadraticCurveTo(e+i-.3*o,s,e+i,s),t.quadraticCurveTo(e+i-.3*o,s,e+i-.3*o,s+.5*a),t.lineTo(e+i-.3*o,n+r-a),t.quadraticCurveTo(e+i-.3*o,n+r,e+i-o,n+r)},leftBracket(t,e,n,i,r){const o=.3*i;t.moveTo(e+o,n),t.lineTo(e,n),t.lineTo(e,n+r),t.lineTo(e+o,n+r)},rightBracket(t,e,n,i,r){const o=.3*i;t.moveTo(e+i-o,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r),t.lineTo(e+i-o,n+r)},leftBrace(t,e,n,i,r){const o=.4*i,a=.2*r,s=n+r/2;t.moveTo(e+o,n),t.quadraticCurveTo(e+.3*o,n,e+.3*o,n+a),t.lineTo(e+.3*o,s-.5*a),t.quadraticCurveTo(e+.3*o,s,e,s),t.quadraticCurveTo(e+.3*o,s,e+.3*o,s+.5*a),t.lineTo(e+.3*o,n+r-a),t.quadraticCurveTo(e+.3*o,n+r,e+o,n+r)},rightBrace(t,e,n,i,r){const o=.4*i,a=.2*r,s=n+r/2;t.moveTo(e+i-o,n),t.quadraticCurveTo(e+i-.3*o,n,e+i-.3*o,n+a),t.lineTo(e+i-.3*o,s-.5*a),t.quadraticCurveTo(e+i-.3*o,s,e+i,s),t.quadraticCurveTo(e+i-.3*o,s,e+i-.3*o,s+.5*a),t.lineTo(e+i-.3*o,n+r-a),t.quadraticCurveTo(e+i-.3*o,n+r,e+i-o,n+r)},rightArrow(t,e,n,i,r){r_(t,e,n,i,r,"right")},leftArrow(t,e,n,i,r){r_(t,e,n,i,r,"left")},upArrow(t,e,n,i,r){r_(t,e,n,i,r,"up")},downArrow(t,e,n,i,r){r_(t,e,n,i,r,"down")},leftRightArrow(t,e,n,i,r){const o=.6*r,a=n+r/2,s=.2*i;t.moveTo(e,a),t.lineTo(e+s,n),t.lineTo(e+s,a-o/2),t.lineTo(e+i-s,a-o/2),t.lineTo(e+i-s,n),t.lineTo(e+i,a),t.lineTo(e+i-s,n+r),t.lineTo(e+i-s,a+o/2),t.lineTo(e+s,a+o/2),t.lineTo(e+s,n+r),t.closePath()},upDownArrow(t,e,n,i,r){const o=.6*i,a=e+i/2,s=.2*r;t.moveTo(a,n),t.lineTo(e+i,n+s),t.lineTo(a+o/2,n+s),t.lineTo(a+o/2,n+r-s),t.lineTo(e+i,n+r-s),t.lineTo(a,n+r),t.lineTo(e,n+r-s),t.lineTo(a-o/2,n+r-s),t.lineTo(a-o/2,n+s),t.lineTo(e,n+s),t.closePath()},quadArrow(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=.35*Math.min(i,r),l=.4*s;t.moveTo(o,n),t.lineTo(o+l,n+l),t.lineTo(o+s/2,n+l),t.lineTo(o+s/2,a-s/2),t.lineTo(o+l,a-s/2),t.lineTo(e+i,a),t.lineTo(e+i-l,a+s/2),t.lineTo(o+s/2,a+s/2),t.lineTo(o+s/2,n+r-l),t.lineTo(o+l,n+r-l),t.lineTo(o,n+r),t.lineTo(o-l,n+r-l),t.lineTo(o-s/2,n+r-l),t.lineTo(o-s/2,a+s/2),t.lineTo(e+l,a+s/2),t.lineTo(e,a),t.lineTo(e+l,a-s/2),t.lineTo(o-s/2,a-s/2),t.lineTo(o-s/2,n+l),t.lineTo(o-l,n+l),t.closePath()},leftRightUpArrow(t,e,n,i,r){const o=e+i/2,a=.3*i,s=.5*r,l=.2*i;t.moveTo(o,n),t.lineTo(o+l,n+l),t.lineTo(o+a/2,n+l),t.lineTo(o+a/2,n+s),t.lineTo(e+i-l,n+s),t.lineTo(e+i-l,n+s-a/2),t.lineTo(e+i,n+s+l),t.lineTo(e+i-l,n+s+2*l),t.lineTo(e+i-l,n+s+a/2),t.lineTo(o+a/2,n+s+a/2),t.lineTo(o+a/2,n+r),t.lineTo(o-a/2,n+r),t.lineTo(o-a/2,n+s+a/2),t.lineTo(e+l,n+s+a/2),t.lineTo(e+l,n+s+2*l),t.lineTo(e,n+s+l),t.lineTo(e+l,n+s-a/2),t.lineTo(e+l,n+s),t.lineTo(o-a/2,n+s),t.lineTo(o-a/2,n+l),t.lineTo(o-l,n+l),t.closePath()},bentArrow(t,e,n,i,r){const o=.3*i,a=.4*r;t.moveTo(e,n+r),t.lineTo(e,n+a),t.lineTo(e+i-a,n+a),t.lineTo(e+i-a,n),t.lineTo(e+i,n+1.5*a),t.lineTo(e+i-a,n+3*a),t.lineTo(e+i-a,n+2*a),t.lineTo(e+o,n+2*a),t.lineTo(e+o,n+r),t.closePath()},uturnArrow(t,e,n,i,r){const o=.3*i,a=.3*r,s=(i-o)/2;t.moveTo(e,n+a),t.lineTo(e+a,n),t.lineTo(e+2*a,n+a),t.lineTo(e+a,n+a),t.arc(e+a+s,n+a+s,s,Math.PI,0,!0),t.lineTo(e+i,n+r),t.lineTo(e+i-o,n+r),t.lineTo(e+i-o,n+a+s),t.arc(e+a+s,n+a+s,s-o,0,Math.PI),t.closePath()},leftUpArrow(t,e,n,i,r){const o=.3*i,a=.3*i;t.moveTo(e,n+r/2),t.lineTo(e+a,n+r/2-a),t.lineTo(e+a,n+r/2-o/2),t.lineTo(e+i/2-o/2,n+r/2-o/2),t.lineTo(e+i/2-o/2,n+a),t.lineTo(e+i/2-a,n+a),t.lineTo(e+i/2,n),t.lineTo(e+i/2+a,n+a),t.lineTo(e+i/2+o/2,n+a),t.lineTo(e+i/2+o/2,n+r/2+o/2),t.lineTo(e+a,n+r/2+o/2),t.lineTo(e+a,n+r/2+a),t.closePath()},bentUpArrow(t,e,n,i,r){const o=.3*r,a=.4*i;t.moveTo(e+i/2,n),t.lineTo(e+i,n+a),t.lineTo(e+i/2+o/2,n+a),t.lineTo(e+i/2+o/2,n+r-o),t.lineTo(e,n+r-o),t.lineTo(e,n+r),t.lineTo(e+i/2+o/2,n+r),t.lineTo(e+i/2+o/2,n+2*a),t.lineTo(e+i/2-o/2,n+2*a),t.lineTo(e+i/2-o/2,n+r),t.lineTo(e+i/2-o/2,n+a),t.lineTo(e,n+a),t.closePath()},curvedRightArrow(t,e,n,i,r){const o=n+r/2,a=.4*r,s=.6*r;t.moveTo(e,o-a/2),t.quadraticCurveTo(e+.5*i,n,e+i-s,n),t.lineTo(e+i-s,n),t.lineTo(e+i,o),t.lineTo(e+i-s,n+r),t.lineTo(e+i-s,n+r),t.quadraticCurveTo(e+.5*i,o+a/2,e,o+a/2),t.closePath()},curvedLeftArrow(t,e,n,i,r){const o=n+r/2,a=.4*r,s=.6*r;t.moveTo(e+i,o-a/2),t.quadraticCurveTo(e+.5*i,n,e+s,n),t.lineTo(e+s,n),t.lineTo(e,o),t.lineTo(e+s,n+r),t.lineTo(e+s,n+r),t.quadraticCurveTo(e+.5*i,o+a/2,e+i,o+a/2),t.closePath()},curvedUpArrow(t,e,n,i,r){const o=e+i/2,a=.4*i,s=.6*i;t.moveTo(o-a/2,n+r),t.quadraticCurveTo(e,n+.5*r,e,n+s),t.lineTo(e,n+s),t.lineTo(o,n),t.lineTo(e+i,n+s),t.lineTo(e+i,n+s),t.quadraticCurveTo(o+a/2,n+.5*r,o+a/2,n+r),t.closePath()},curvedDownArrow(t,e,n,i,r){const o=e+i/2,a=.4*i,s=.6*i;t.moveTo(o-a/2,n),t.quadraticCurveTo(e,n+.5*r,e,n+r-s),t.lineTo(e,n+r-s),t.lineTo(o,n+r),t.lineTo(e+i,n+r-s),t.lineTo(e+i,n+r-s),t.quadraticCurveTo(o+a/2,n+.5*r,o+a/2,n),t.closePath()},stripedRightArrow(t,e,n,i,r){const o=.6*r,a=n+r/2,s=.3*i,l=.15*i;t.moveTo(e+2*l,a-o/2),t.lineTo(e+i-s,a-o/2),t.lineTo(e+i-s,n),t.lineTo(e+i,a),t.lineTo(e+i-s,n+r),t.lineTo(e+i-s,a+o/2),t.lineTo(e+2*l,a+o/2),t.closePath(),t.moveTo(e,n+.2*r),t.lineTo(e,n+.8*r),t.moveTo(e+l,n+.2*r),t.lineTo(e+l,n+.8*r)},notchedRightArrow(t,e,n,i,r){const o=.6*r,a=n+r/2,s=.15*i;t.moveTo(e,a-o/2),t.lineTo(e+i-.3*i,a-o/2),t.lineTo(e+i-.3*i,n),t.lineTo(e+i,a),t.lineTo(e+i-.3*i,n+r),t.lineTo(e+i-.3*i,a+o/2),t.lineTo(e,a+o/2),t.lineTo(e+s,a),t.closePath()},homePlate(t,e,n,i,r){const o=.3*i;t.moveTo(e,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+r/2),t.lineTo(e+i-o,n+r),t.lineTo(e,n+r),t.closePath()},chevron(t,e,n,i,r){const o=.3*i;t.moveTo(e,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+r/2),t.lineTo(e+i-o,n+r),t.lineTo(e,n+r),t.lineTo(e+o,n+r/2),t.closePath()},rightArrowCallout(t,e,n,i,r){const o=.6*i,a=.4*r,s=n+r/2;t.moveTo(e,n),t.lineTo(e+o,n),t.lineTo(e+o,s-a/2),t.lineTo(e+i,s),t.lineTo(e+o,s+a/2),t.lineTo(e+o,n+r),t.lineTo(e,n+r),t.closePath()},downArrowCallout(t,e,n,i,r){const o=.6*r,a=.4*i,s=e+i/2;t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i,n+o),t.lineTo(s+a/2,n+o),t.lineTo(s,n+r),t.lineTo(s-a/2,n+o),t.lineTo(e,n+o),t.closePath()},leftArrowCallout(t,e,n,i,r){const o=.6*i,a=.4*r,s=n+r/2;t.moveTo(e+i,n),t.lineTo(e+i,n+r),t.lineTo(e+i-o,n+r),t.lineTo(e+i-o,s+a/2),t.lineTo(e,s),t.lineTo(e+i-o,s-a/2),t.lineTo(e+i-o,n),t.closePath()},upArrowCallout(t,e,n,i,r){const o=.6*r,a=.4*i,s=e+i/2;t.moveTo(e,n+r),t.lineTo(e,n+r-o),t.lineTo(s-a/2,n+r-o),t.lineTo(s,n),t.lineTo(s+a/2,n+r-o),t.lineTo(e+i,n+r-o),t.lineTo(e+i,n+r),t.closePath()},leftRightArrowCallout(t,e,n,i,r){const o=.3*r,a=n+r/2,s=e+.3*i,l=e+.7*i;t.moveTo(s,n),t.lineTo(l,n),t.lineTo(l,a-o/2),t.lineTo(e+i,a),t.lineTo(l,a+o/2),t.lineTo(l,n+r),t.lineTo(s,n+r),t.lineTo(s,a+o/2),t.lineTo(e,a),t.lineTo(s,a-o/2),t.closePath()},quadArrowCallout(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=.3*Math.min(i,r),l=.2*Math.min(i,r);t.moveTo(o-s,n+s),t.lineTo(o+s,n+s),t.lineTo(o+s,a-l),t.lineTo(o+l,a-l),t.lineTo(o+l,n),t.lineTo(o,n-l),t.lineTo(o-l,n),t.lineTo(o-l,a-l),t.lineTo(o-s,a-l),t.lineTo(o-s,a+l),t.lineTo(o-l,a+l),t.lineTo(o-l,n+r),t.lineTo(o,n+r+l),t.lineTo(o+l,n+r),t.lineTo(o+l,a+l),t.lineTo(o+s,a+l),t.lineTo(o+s,n+r-s),t.lineTo(e+i-s,n+r-s),t.lineTo(e+i-s,a+l),t.lineTo(e+i,a+l),t.lineTo(e+i+l,a),t.lineTo(e+i,a-l),t.lineTo(e+i-s,a-l),t.lineTo(e+i-s,n+s),t.closePath()},circularArrow(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=.4*Math.min(i,r),l=.3*s;t.arc(o,a,s,.2*Math.PI,1.8*Math.PI),t.lineTo(o-.5*s,a-.8*s-l),t.lineTo(o-.8*s,a-.5*s),t.lineTo(o-.5*s-l,a-.8*s),t.lineTo(o-.5*s,a-.8*s+l)},mathPlus(t,e,n,i,r){const o=.15*Math.min(i,r),a=e+i/2,s=n+r/2;t.moveTo(a-o/2,n),t.lineTo(a+o/2,n),t.lineTo(a+o/2,s-o/2),t.lineTo(e+i,s-o/2),t.lineTo(e+i,s+o/2),t.lineTo(a+o/2,s+o/2),t.lineTo(a+o/2,n+r),t.lineTo(a-o/2,n+r),t.lineTo(a-o/2,s+o/2),t.lineTo(e,s+o/2),t.lineTo(e,s-o/2),t.lineTo(a-o/2,s-o/2),t.closePath()},mathMinus(t,e,n,i,r){const o=.15*Math.min(i,r),a=n+r/2;t.rect(e,a-o/2,i,o)},mathMultiply(t,e,n,i,r){const o=.15*Math.min(i,r),a=e+i/2,s=n+r/2,l=.35*Math.min(i,r);t.save(),t.translate(a,s),t.rotate(Math.PI/4),t.rect(-o/2,-l,o,2*l),t.rect(-l,-o/2,2*l,o),t.restore()},mathDivide(t,e,n,i,r){const o=.15*Math.min(i,r),a=n+r/2,s=1.2*o;t.rect(e,a-o/2,i,o),t.moveTo(e+i/2+s,n+.25*r),t.arc(e+i/2,n+.25*r,s,0,2*Math.PI),t.moveTo(e+i/2+s,n+.75*r),t.arc(e+i/2,n+.75*r,s,0,2*Math.PI)},mathEqual(t,e,n,i,r){const o=.15*Math.min(i,r),a=.2*r,s=n+r/2;t.rect(e,s-a/2-o,i,o),t.rect(e,s+a/2,i,o)},mathNotEqual(t,e,n,i,r){const o=.15*Math.min(i,r),a=.2*r,s=n+r/2;t.rect(e,s-a/2-o,i,o),t.rect(e,s+a/2,i,o),t.save(),t.translate(e+i/2,s),t.rotate(Math.PI/4),t.rect(-o/2,.6*-r,o,1.2*r),t.restore()},flowChartProcess(t,e,n,i,r){t.rect(e,n,i,r)},flowChartAlternateProcess(t,e,n,i,r){i_(t,e,n,i,r,.15)},flowChartDecision(t,e,n,i,r){const o=e+i/2,a=n+r/2;t.moveTo(o,n),t.lineTo(e+i,a),t.lineTo(o,n+r),t.lineTo(e,a),t.closePath()},flowChartInputOutput(t,e,n,i,r){const o=.15*i;t.moveTo(e+o,n),t.lineTo(e+i,n),t.lineTo(e+i-o,n+r),t.lineTo(e,n+r),t.closePath()},flowChartPredefinedProcess(t,e,n,i,r){const o=.1*i;t.rect(e,n,i,r),t.moveTo(e+o,n),t.lineTo(e+o,n+r),t.moveTo(e+i-o,n),t.lineTo(e+i-o,n+r)},flowChartInternalStorage(t,e,n,i,r){const o=.15*i,a=.15*r;t.rect(e,n,i,r),t.moveTo(e,n+a),t.lineTo(e+i,n+a),t.moveTo(e+o,n),t.lineTo(e+o,n+r)},flowChartDocument(t,e,n,i,r){const o=.1*r;t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r-o),t.quadraticCurveTo(e+.75*i,n+r,e+i/2,n+r-o),t.quadraticCurveTo(e+.25*i,n+r-2*o,e,n+r-o),t.closePath()},flowChartMultidocument(t,e,n,i,r){const o=.05*Math.min(i,r),a=.08*r;t.moveTo(e+2*o,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r-2*o-a),t.quadraticCurveTo(e+.75*i,n+r-2*o,e+i/2,n+r-2*o-a),t.quadraticCurveTo(e+.25*i,n+r-2*o-2*a,e+2*o,n+r-2*o-a),t.closePath(),t.moveTo(e+o,n+o),t.lineTo(e+i-o,n+o),t.moveTo(e+i-o,n+o),t.lineTo(e+i-o,n+r-o-a),t.moveTo(e,n+2*o),t.lineTo(e+i-2*o,n+2*o),t.moveTo(e+i-2*o,n+2*o),t.lineTo(e+i-2*o,n+r-a)},flowChartTerminator(t,e,n,i,r){const o=r/2;t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.arcTo(e+i,n,e+i,n+o,o),t.arcTo(e+i,n+r,e+i-o,n+r,o),t.lineTo(e+o,n+r),t.arcTo(e,n+r,e,n+r-o,o),t.arcTo(e,n,e+o,n,o),t.closePath()},flowChartPreparation(t,e,n,i,r){const o=.15*i;t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+r/2),t.lineTo(e+i-o,n+r),t.lineTo(e+o,n+r),t.lineTo(e,n+r/2),t.closePath()},flowChartManualInput(t,e,n,i,r){const o=.15*r;t.moveTo(e,n+o),t.lineTo(e+i,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.closePath()},flowChartManualOperation(t,e,n,i,r){const o=.1*i;t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i-o,n+r),t.lineTo(e+o,n+r),t.closePath()},flowChartConnector(t,e,n,i,r){const o=e+i/2,a=n+r/2;t.ellipse(o,a,i/2,r/2,0,0,2*Math.PI)},flowChartOffpageConnector(t,e,n,i,r){const o=.15*r,a=e+i/2;t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r-o),t.lineTo(a,n+r),t.lineTo(e,n+r-o),t.closePath()},flowChartPunchedCard(t,e,n,i,r){const o=.1*i;t.moveTo(e+o,n),t.lineTo(e+i,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.lineTo(e,n),t.closePath()},flowChartPunchedTape(t,e,n,i,r){const o=.1*r;t.moveTo(e,n+o),t.quadraticCurveTo(e+.25*i,n,e+i/2,n+o),t.quadraticCurveTo(e+.75*i,n+2*o,e+i,n+o),t.lineTo(e+i,n+r-o),t.quadraticCurveTo(e+.75*i,n+r,e+i/2,n+r-o),t.quadraticCurveTo(e+.25*i,n+r-2*o,e,n+r-o),t.closePath()},flowChartSummingJunction(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2;t.ellipse(o,a,s,s,0,0,2*Math.PI);const l=.707*s;t.moveTo(o-l,a-l),t.lineTo(o+l,a+l),t.moveTo(o+l,a-l),t.lineTo(o-l,a+l)},flowChartOr(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2;t.ellipse(o,a,s,s,0,0,2*Math.PI),t.moveTo(o,a-s),t.lineTo(o,a+s),t.moveTo(o-s,a),t.lineTo(o+s,a)},flowChartCollate(t,e,n,i,r){const o=e+i/2;t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(o,n+r/2),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.lineTo(o,n+r/2),t.closePath()},flowChartSort(t,e,n,i,r){const o=e+i/2,a=n+r/2;t.moveTo(o,n),t.lineTo(e+i,a),t.lineTo(o,n+r),t.lineTo(e,a),t.closePath(),t.moveTo(e,a),t.lineTo(e+i,a)},flowChartExtract(t,e,n,i,r){t.moveTo(e+i/2,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.closePath()},flowChartMerge(t,e,n,i,r){t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i/2,n+r),t.closePath()},flowChartOnlineStorage(t,e,n,i,r){const o=.1*i;t.moveTo(e+o,n),t.lineTo(e+i,n),t.arcTo(e+i+o,n+r/2,e+i,n+r,r/2),t.lineTo(e+o,n+r),t.arcTo(e-o,n+r/2,e+o,n,r/2),t.closePath()},flowChartDelay(t,e,n,i,r){const o=.7*i;t.moveTo(e,n),t.lineTo(e+o,n),t.arcTo(e+i,n,e+i,n+r/2,r/2),t.arcTo(e+i,n+r,e+o,n+r,r/2),t.lineTo(e,n+r),t.closePath()},flowChartMagneticTape(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=i/2,l=r/2;t.ellipse(o,a,s,l,0,Math.PI,2*Math.PI),t.lineTo(e,n+r),t.arcTo(e,n+r+l,o,n+r+l,s),t.arcTo(e+i,n+r+l,e+i,n+r,s),t.closePath()},flowChartMagneticDisk(t,e,n,i,r){const o=.15*r,a=e+i/2;t.ellipse(a,n+o/2,i/2,o/2,0,0,2*Math.PI),t.moveTo(e,n+o/2),t.lineTo(e,n+r-o/2),t.ellipse(a,n+r-o/2,i/2,o/2,0,0,Math.PI),t.lineTo(e+i,n+o/2)},flowChartMagneticDrum(t,e,n,i,r){const o=.15*i,a=n+r/2;t.ellipse(e+o/2,a,o/2,r/2,0,Math.PI/2,1.5*Math.PI),t.lineTo(e+i-o/2,n),t.ellipse(e+i-o/2,a,o/2,r/2,0,-Math.PI/2,Math.PI/2),t.lineTo(e+o/2,n+r)},flowChartDisplay(t,e,n,i,r){const o=.15*i;t.moveTo(e,n),t.lineTo(e+i-o,n),t.arcTo(e+i+o,n+r/2,e+i-o,n+r,r/2),t.lineTo(e,n+r),t.closePath()},irregularSeal1(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2,l=[.85,.95,.75,1,.8,.9,.7,.95,.85,.9];for(let c=0;c<l.length;c++){const e=2*Math.PI/l.length*c-Math.PI/2,n=s*l[c],i=o+n*Math.cos(e),r=a+n*Math.sin(e);0===c?t.moveTo(i,r):t.lineTo(i,r)}t.closePath()},irregularSeal2(t,e,n,i,r){const o=e+i/2,a=n+r/2,s=Math.min(i,r)/2,l=[.9,.7,1,.75,.85,.95,.7,.9,.8,1,.75,.85];for(let c=0;c<l.length;c++){const e=2*Math.PI/l.length*c,n=s*l[c],i=o+n*Math.cos(e),r=a+n*Math.sin(e);0===c?t.moveTo(i,r):t.lineTo(i,r)}t.closePath()},star4(t,e,n,i,r){n_(t,e,n,i,r,4)},star5(t,e,n,i,r){n_(t,e,n,i,r,5)},star6(t,e,n,i,r){n_(t,e,n,i,r,6)},star7(t,e,n,i,r){n_(t,e,n,i,r,7)},star8(t,e,n,i,r){n_(t,e,n,i,r,8)},star10(t,e,n,i,r){n_(t,e,n,i,r,10)},star12(t,e,n,i,r){n_(t,e,n,i,r,12)},star16(t,e,n,i,r){n_(t,e,n,i,r,16)},star24(t,e,n,i,r){n_(t,e,n,i,r,24)},star32(t,e,n,i,r){n_(t,e,n,i,r,32)},ribbon(t,e,n,i,r){const o=.15*i,a=.2*r;t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.lineTo(e+i,n+a),t.lineTo(e+i,n+r-o),t.lineTo(e+i-o,n+r),t.lineTo(e+.6*i,n+r-a),t.lineTo(e+.4*i,n+r-a),t.lineTo(e+o,n+r),t.lineTo(e,n+r-o),t.lineTo(e,n+a),t.closePath()},ribbon2(t,e,n,i,r){const o=.15*i,a=.2*r;t.moveTo(e+o,n+o),t.lineTo(e,n),t.lineTo(e,n+r-a),t.lineTo(e+i-o,n+r-a),t.lineTo(e+i,n+r-a-o),t.lineTo(e+i,n),t.lineTo(e+i-o,n+o),t.lineTo(e+i-o,n+r),t.lineTo(e+.6*i,n+r-1.5*a),t.lineTo(e+.4*i,n+r-1.5*a),t.lineTo(e+o,n+r),t.closePath()},ellipseRibbon(t,e,n,i,r){const o=e+i/2,a=.25*i,s=.15*r;t.moveTo(e,n+s),t.quadraticCurveTo(o,n,e+i,n+s),t.lineTo(e+i,n+r-s),t.lineTo(e+i-a,n+r),t.lineTo(e+i-a,n+.7*r),t.lineTo(o,n+.8*r),t.lineTo(e+a,n+.7*r),t.lineTo(e+a,n+r),t.lineTo(e,n+r-s),t.closePath()},ellipseRibbon2(t,e,n,i,r){const o=e+i/2,a=.25*i,s=.15*r;t.moveTo(e,n+s),t.lineTo(e,n+r-s),t.quadraticCurveTo(o,n+r,e+i,n+r-s),t.lineTo(e+i,n+s),t.lineTo(e+i-a,n),t.lineTo(e+i-a,n+.3*r),t.lineTo(o,n+.2*r),t.lineTo(e+a,n+.3*r),t.lineTo(e+a,n),t.closePath()},verticalScroll(t,e,n,i,r){const o=.1*r,a=e+i/2;t.moveTo(e,n+o),t.arcTo(e,n,a,n,o),t.arcTo(e+i,n,e+i,n+o,o),t.lineTo(e+i,n+r-o),t.arcTo(e+i,n+r,a,n+r,o),t.arcTo(e,n+r,e,n+r-o,o),t.closePath()},horizontalScroll(t,e,n,i,r){const o=.1*i,a=n+r/2;t.moveTo(e+o,n),t.arcTo(e,n,e,a,o),t.arcTo(e,n+r,e+o,n+r,o),t.lineTo(e+i-o,n+r),t.arcTo(e+i,n+r,e+i,a,o),t.arcTo(e+i,n,e+i-o,n,o),t.closePath()},wave(t,e,n,i,r){const o=.2*r,a=n+r/2;t.moveTo(e,a),t.quadraticCurveTo(e+.25*i,n,e+i/2,a),t.quadraticCurveTo(e+.75*i,n+r,e+i,a),t.lineTo(e+i,a+o),t.quadraticCurveTo(e+.75*i,n+r+o,e+i/2,a+o),t.quadraticCurveTo(e+.25*i,n+o,e,a+o),t.closePath()},doubleWave(t,e,n,i,r){const o=.15*r,a=n+r/2;t.moveTo(e,a),t.quadraticCurveTo(e+.17*i,n,e+.33*i,a),t.quadraticCurveTo(e+.5*i,n+r,e+.67*i,a),t.quadraticCurveTo(e+.83*i,n,e+i,a),t.lineTo(e+i,a+o),t.quadraticCurveTo(e+.83*i,n+r+o,e+.67*i,a+o),t.quadraticCurveTo(e+.5*i,n+o,e+.33*i,a+o),t.quadraticCurveTo(e+.17*i,n+r+o,e,a+o),t.closePath()},wedgeRectCallout(t,e,n,i,r){const o=.65*r,a=.2*i,s=e+.2*i;t.moveTo(e,n),t.lineTo(e+i,n),t.lineTo(e+i,n+o),t.lineTo(s+a,n+o),t.lineTo(s,n+r),t.lineTo(s,n+o),t.lineTo(e,n+o),t.closePath()},wedgeRoundRectCallout(t,e,n,i,r){const o=.65*r,a=.12*Math.min(i,r),s=.2*i,l=e+.2*i;t.moveTo(e+a,n),t.lineTo(e+i-a,n),t.arcTo(e+i,n,e+i,n+a,a),t.lineTo(e+i,n+o-a),t.arcTo(e+i,n+o,e+i-a,n+o,a),t.lineTo(l+s,n+o),t.lineTo(l,n+r),t.lineTo(l,n+o),t.lineTo(e+a,n+o),t.arcTo(e,n+o,e,n+o-a,a),t.lineTo(e,n+a),t.arcTo(e,n,e+a,n,a),t.closePath()},wedgeEllipseCallout(t,e,n,i,r){const o=.6*r,a=e+i/2,s=n+o/2,l=i/2,c=o/2;t.ellipse(a,s,l,c,0,0,2*Math.PI);const h=e+.35*i,u=.6*Math.PI,d=.75*Math.PI,f=a+l*Math.cos(u),p=s+c*Math.sin(u),m=a+l*Math.cos(d),g=s+c*Math.sin(d);t.moveTo(f,p),t.lineTo(h,n+r),t.lineTo(m,g)},cloudCallout(t,e,n,i,r){const o=.7*r,a=e+i/2,s=.3*o;t.arc(e+.25*i,n+.6*o,s,.8*Math.PI,1.8*Math.PI),t.arc(a,n+s,1.2*s,1.2*Math.PI,1.9*Math.PI),t.arc(e+.75*i,n+.5*o,s,1.4*Math.PI,.3*Math.PI),t.arc(e+.7*i,n+.8*o,.8*s,.2*-Math.PI,.5*Math.PI),t.arc(a,n+.85*o,.9*s,0,.8*Math.PI),t.arc(e+.3*i,n+.8*o,.7*s,.3*Math.PI,Math.PI),t.closePath();const l=.08*r;t.moveTo(e+.3*i+l,n+.95*o),t.arc(e+.3*i,n+.95*o,l,0,2*Math.PI),t.moveTo(e+.22*i+.6*l,n+.85*r),t.arc(e+.22*i,n+.85*r,.6*l,0,2*Math.PI),t.moveTo(e+.18*i+.35*l,n+.95*r),t.arc(e+.18*i,n+.95*r,.35*l,0,2*Math.PI)},callout1(t,e,n,i,r){const o=e+.35*i,a=.65*i,s=.6*r;t.rect(o,n,a,s),t.moveTo(o,n+.5*s),t.lineTo(e,n+r)},callout2(t,e,n,i,r){const o=e+.35*i,a=.65*i,s=.6*r,l=e+.2*i;t.rect(o,n,a,s),t.moveTo(o,n+.5*s),t.lineTo(l,n+.5*s),t.lineTo(e,n+r)},callout3(t,e,n,i,r){const o=e+.35*i,a=.65*i,s=.6*r,l=e+.15*i,c=n+.5*s,h=n+.75*r;t.rect(o,n,a,s),t.moveTo(o,c),t.lineTo(l,c),t.lineTo(l,h),t.lineTo(e,n+r)},accentCallout1(t,e,n,i,r){const o=e+.3*i,a=e+.38*i,s=.62*i,l=.6*r;t.rect(a,n,s,l),t.moveTo(o,n),t.lineTo(o,n+l),t.moveTo(o,n+.5*l),t.lineTo(e,n+r)},accentCallout2(t,e,n,i,r){const o=e+.3*i,a=e+.38*i,s=.62*i,l=.6*r,c=e+.15*i;t.rect(a,n,s,l),t.moveTo(o,n),t.lineTo(o,n+l),t.moveTo(o,n+.5*l),t.lineTo(c,n+.5*l),t.lineTo(e,n+r)},accentCallout3(t,e,n,i,r){const o=e+.3*i,a=e+.38*i,s=.62*i,l=.6*r,c=e+.12*i,h=n+.75*r;t.rect(a,n,s,l),t.moveTo(o,n),t.lineTo(o,n+l),t.moveTo(o,n+.5*l),t.lineTo(c,n+.5*l),t.lineTo(c,h),t.lineTo(e,n+r)},borderCallout1(t,e,n,i,r){const o=e+.35*i,a=.65*i,s=.6*r;t.rect(o,n,a,s),t.moveTo(o,n+.5*s),t.lineTo(e,n+r)},borderCallout2(t,e,n,i,r){const o=e+.35*i,a=.65*i,s=.6*r,l=e+.2*i;t.rect(o,n,a,s),t.moveTo(o,n+.5*s),t.lineTo(l,n+.5*s),t.lineTo(e,n+r)},borderCallout3(t,e,n,i,r){const o=e+.35*i,a=.65*i,s=.6*r,l=e+.15*i,c=n+.75*r;t.rect(o,n,a,s),t.moveTo(o,n+.5*s),t.lineTo(l,n+.5*s),t.lineTo(l,c),t.lineTo(e,n+r)},accentBorderCallout1(t,e,n,i,r){const o=e+.3*i,a=e+.38*i,s=.62*i,l=.6*r;t.rect(a,n,s,l),t.moveTo(o,n),t.lineTo(o,n+l),t.moveTo(o,n+.5*l),t.lineTo(e,n+r)},accentBorderCallout2(t,e,n,i,r){const o=e+.3*i,a=e+.38*i,s=.62*i,l=.6*r,c=e+.15*i;t.rect(a,n,s,l),t.moveTo(o,n),t.lineTo(o,n+l),t.moveTo(o,n+.5*l),t.lineTo(c,n+.5*l),t.lineTo(e,n+r)},accentBorderCallout3(t,e,n,i,r){const o=e+.3*i,a=e+.38*i,s=.62*i,l=.6*r,c=e+.12*i,h=n+.75*r;t.rect(a,n,s,l),t.moveTo(o,n),t.lineTo(o,n+l),t.moveTo(o,n+.5*l),t.lineTo(c,n+.5*l),t.lineTo(c,h),t.lineTo(e,n+r)}};function a_(t,e,n,i,r,o,a=1){const s=e.shapeType||"rect",l=e.shapeStyle||{},c=e.isConnector||be.includes(s),h=Number.isFinite(a)&&a>0?a:1,u=t=>Math.round(t*h)/h;if(t.save(),!c&&l.fill&&"none"!==l.fill){t.beginPath();const e=o_[s];e?e(t,n,i,r,o):o_.rect(t,n,i,r,o),t.fillStyle=l.fill,t.fill()}const d=Math.max(0,Number(l.strokeWidth)||0),f=!c&&e.isTextBox?Math.max(.5,.85*d):d;if(l.stroke&&f>0){if(t.save(),Math.max(1,Math.round(f*h))%2==1){const e=.5/h;t.translate(e,e)}t.beginPath();const e=o_[s];e?e(t,n,i,r,o):o_.rect(t,n,i,r,o),t.strokeStyle=l.stroke,t.lineWidth=f,c?(t.lineCap="round",t.lineJoin="round"):(t.lineCap="square",t.lineJoin="miter"),t.stroke(),c&&function(t,e,n,i,r,o,a){const s=Math.max(8,3*a.strokeWidth),{startPoint:l,endPoint:c,startAngle:h,endAngle:u}=function(t,e,n,i,r){let o,a,s,l;switch(t){case"line":case"straightConnector1":default:o={x:e,y:n},a={x:e+i,y:n+r},s=Math.atan2(-r,-i),l=Math.atan2(r,i);break;case"bentConnector3":case"curvedConnector3":o={x:e,y:n},a={x:e+i,y:n+r},s=0,l=0}return{startPoint:o,endPoint:a,startAngle:s,endAngle:l}}(e,n,i,r,o);a.startArrow&&"none"!==a.startArrow&&s_(t,l.x,l.y,h+Math.PI,s,a),a.endArrow&&"none"!==a.endArrow&&s_(t,c.x,c.y,u,s,a)}(t,s,n,i,r,o,l),t.restore()}if(t.restore(),e.shapeText&&!c){t.save(),t.fillStyle=l.textColor||"#000000",t.font=`${l.fontSize||11}px ${l.fontFamily||"宋体"}`,t.textBaseline="middle";const a="vertical"===l.textDirection?"vertical":"horizontal",s=!!e.isTextBox,c="vertical"===a?"right":"left",d={"l":"left","r":"right","ctr":"center"}[l.textAlign]||(s?c:"center"),f=e.shapeText.split("\n"),p=1.2*(l.fontSize||11);if("vertical"===a)!function(t,e,n,i,r,o,a,s,l=!1,c=1){const h=Number.isFinite(c)&&c>0?c:1,u=t=>Math.round(t*h)/h,d=l?5:0,f=l?Math.max(1,Math.floor(Math.max(s,o-2*d)/s)):Number.MAX_SAFE_INTEGER,p=[];e.forEach(t=>{const e=Array.from(t||"");if(0!==e.length)for(let n=0;n<e.length;n+=f)p.push(e.slice(n,n+f));else p.push([])}),0===p.length&&p.push([]);const m=Math.max(p.length,1),g=Math.max(...p.map(t=>t.length),1),v=m*s,y="left"===a?n+d:"right"===a?n+r-d-v:n+(r-v)/2,b=l?i+d:i+(o-g*s)/2;l&&(t.save(),t.beginPath(),t.rect(n+d,i+d,Math.max(0,r-2*d),Math.max(0,o-2*d)),t.clip()),t.textAlign="center",p.forEach((e,n)=>{const i=y+(m-1-n)*s+s/2;e.forEach((e,n)=>{const r=b+n*s+s/2;t.fillText(e,u(i),u(r))})}),l&&t.restore()}(t,f,n,i,r,o,d,p,s,h);else{t.textAlign=d;const e="left"===d?n+5:"right"===d?n+r-5:n+r/2,a=s?i+5+p/2:i+o/2-f.length*p/2+p/2;f.forEach((n,i)=>{t.fillText(n,u(e),u(a+i*p))})}t.restore()}}function s_(t,e,n,i,r,o){t.save(),t.translate(e,n),t.rotate(i),t.beginPath(),t.moveTo(0,0),t.lineTo(-r,-r/2),t.lineTo(-r,r/2),t.closePath(),t.fillStyle=o.stroke||"#000000",t.fill(),t.restore()}const l_={line(t,e,n,i,r){t.moveTo(e,n),t.lineTo(i,r);const o=Math.atan2(r-n,i-e);return{startAngle:o,endAngle:o}},straightConnector1:(t,e,n,i,r)=>l_.line(t,e,n,i,r),bentConnector2(t,e,n,i,r){const o=i-e,a=r-n;if(Math.abs(o)>Math.abs(a)){const a=e+o/2;return t.moveTo(e,n),t.lineTo(a,n),t.lineTo(a,r),t.lineTo(i,r),{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const o=n+a/2;return t.moveTo(e,n),t.lineTo(e,o),t.lineTo(i,o),t.lineTo(i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}},bentConnector3(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const a=.5*o;return t.lineTo(e+a,n),t.lineTo(e+a,r),t.lineTo(i,r),{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const o=.5*a;return t.lineTo(e,n+o),t.lineTo(i,n+o),t.lineTo(i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}},bentConnector4(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const s=.33*o,l=.5*a;return t.lineTo(e+s,n),t.lineTo(e+s,n+l),t.lineTo(i,n+l),t.lineTo(i,r),{startAngle:o>0?0:Math.PI,endAngle:a>0?Math.PI/2:-Math.PI/2}}{const s=.33*a,l=.5*o;return t.lineTo(e,n+s),t.lineTo(e+l,n+s),t.lineTo(e+l,r),t.lineTo(i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:o>0?0:Math.PI}}},bentConnector5(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const s=.25*o,l=.5*a,c=.5*o;return t.lineTo(e+s,n),t.lineTo(e+s,n+l),t.lineTo(e+c,n+l),t.lineTo(e+c,r),t.lineTo(i,r),{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const s=.25*a,l=.5*o,c=.5*a;return t.lineTo(e,n+s),t.lineTo(e+l,n+s),t.lineTo(e+l,n+c),t.lineTo(i,n+c),t.lineTo(i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}},curvedConnector2(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const a=.5*o;return t.bezierCurveTo(e+a,n,i-a,r,i,r),{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const o=.5*a;return t.bezierCurveTo(e,n+o,i,r-o,i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}},curvedConnector3(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const s=e+.5*o,l=.25,c=e+o*l,h=n,u=s,d=n,f=s,p=r,m=i-o*l,g=r;return t.bezierCurveTo(c,h,u,d,s,n+.5*a),t.bezierCurveTo(f,p,m,g,i,r),{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const s=n+.5*a,l=.25,c=e,h=n+a*l,u=e,d=s,f=i,p=s,m=i,g=r-a*l;return t.bezierCurveTo(c,h,u,d,e+.5*o,s),t.bezierCurveTo(f,p,m,g,i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}},curvedConnector4(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const s=e+.33*o,l=e+.67*o,c=n+.5*a,h=.15*o;return t.bezierCurveTo(e+h,n,s-h,n,s,n),t.bezierCurveTo(s+h,n,s+h,c,s,c),t.bezierCurveTo(s,c,l,c,l,r),t.bezierCurveTo(l+h,r,i-h,r,i,r),{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const s=n+.33*a,l=n+.67*a,c=e+.5*o,h=.15*a;return t.bezierCurveTo(e,n+h,e,s-h,e,s),t.bezierCurveTo(e,s+h,c,s+h,c,s),t.bezierCurveTo(c,s,c,l,i,l),t.bezierCurveTo(i,l+h,i,r-h,i,r),{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}},curvedConnector5(t,e,n,i,r){const o=i-e,a=r-n;if(t.moveTo(e,n),Math.abs(o)>Math.abs(a)){const s=[{x:e,y:n},{x:e+.25*o,y:n},{x:e+.4*o,y:n+.5*a},{x:e+.6*o,y:n+.5*a},{x:e+.75*o,y:r},{x:i,y:r}];for(let e=0;e<s.length-1;e++){const n=s[e],i=s[e+1],r=.3;t.bezierCurveTo(n.x+(i.x-n.x)*r,n.y,i.x-(i.x-n.x)*r,i.y,i.x,i.y)}return{startAngle:o>0?0:Math.PI,endAngle:o>0?0:Math.PI}}{const s=[{x:e,y:n},{x:e,y:n+.25*a},{x:e+.5*o,y:n+.4*a},{x:e+.5*o,y:n+.6*a},{x:i,y:n+.75*a},{x:i,y:r}];for(let e=0;e<s.length-1;e++){const n=s[e],i=s[e+1],r=.3;t.bezierCurveTo(n.x,n.y+(i.y-n.y)*r,i.x,i.y-(i.y-n.y)*r,i.x,i.y)}return{startAngle:a>0?Math.PI/2:-Math.PI/2,endAngle:a>0?Math.PI/2:-Math.PI/2}}}};function c_(t,e,n,i,r,o,a={}){const s=l_[e];let l;if(t.beginPath(),l=s?s(t,n,i,r,o):l_.straightConnector1(t,n,i,r,o),t.strokeStyle=a.stroke||"#000000",t.lineWidth=a.strokeWidth||1,t.lineCap="round",t.lineJoin="round",a.dashStyle&&"solid"!==a.dashStyle){const e={dash:[5,5],dashDot:[5,5,1,5],dot:[2,3],lgDash:[10,5],lgDashDot:[10,5,2,5],lgDashDotDot:[10,5,2,5,2,5]};t.setLineDash(e[a.dashStyle]||[5,5])}else t.setLineDash([]);return t.stroke(),t.setLineDash([]),l||{startAngle:0,endAngle:0}}function h_(t,e,n,i,r,o,a){t.save(),t.translate(e,n),t.rotate(i),t.fillStyle=a||"#000000",t.strokeStyle=a||"#000000",t.beginPath(),"triangle"===o||"arrow"===o?(t.moveTo(0,0),t.lineTo(-r,-r/2),t.lineTo(-r,r/2),t.closePath(),t.fill()):"oval"===o?(t.arc(-r/2,0,r/2,0,2*Math.PI),t.fill()):"diamond"===o?(t.moveTo(0,0),t.lineTo(-r/2,-r/2),t.lineTo(-r,0),t.lineTo(-r/2,r/2),t.closePath(),t.fill()):"stealth"===o&&(t.moveTo(0,0),t.lineTo(-r,-r/3),t.lineTo(.7*-r,0),t.lineTo(-r,r/3),t.closePath(),t.fill()),t.restore()}RC([function(t){t.registerComponentModel(AR),t.registerComponentView(NR)},function(t){RC(aR),t.registerComponentModel(sR),t.registerComponentView(CR),t.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},qr),t.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},qr)},function(t){RC(VR),RC(GR)},function(t){RC(sA),RC(aR)},xA,function(t){t.registerChartView(c$),t.registerSeriesModel(e$),t.registerLayout(t.PRIORITY.VISUAL.LAYOUT,pr(YS,"bar")),t.registerLayout(t.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,{seriesType:"bar",plan:Qy(),reset:function(t){if(ZS(t)){var e=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),r=n.getOtherAxis(i),o=e.getDimensionIndex(e.mapDimension(r.dim)),a=e.getDimensionIndex(e.mapDimension(i.dim)),s=t.get("showBackground",!0),l=e.mapDimension(r.dim),c=e.getCalculationInfo("stackResultDimension"),h=$S(e,l)&&!!e.getCalculationInfo("stackedOnSeries"),u=r.isHorizontal(),d=function(t,e){var n=e.model.get("startValue");return n||(n=0),e.toGlobalCoord(e.dataToCoord("log"===e.type?n>0?n:1:n))}(0,r),f=JS(t),p=t.get("barMinHeight")||0,m=c&&e.getDimensionIndex(c),g=e.getLayout("size"),v=e.getLayout("offset");return{progress:function(t,e){for(var i,r=t.count,l=f&&KS(3*r),c=f&&s&&KS(3*r),y=f&&KS(r),b=n.master.getRect(),x=u?b.width:b.height,w=e.getStore(),S=0;null!=(i=t.next());){var C=w.get(h?m:o,i),T=w.get(a,i),$=d,M=void 0;h&&(M=+C-w.get(o,i));var A=void 0,N=void 0,k=void 0,R=void 0;if(u){var _=n.dataToPoint([C,T]);h&&($=n.dataToPoint([M,T])[0]),A=$,N=_[1]+v,k=_[0]-$,R=g,Math.abs(k)<p&&(k=(k<0?-1:1)*p)}else _=n.dataToPoint([T,C]),h&&($=n.dataToPoint([T,M])[1]),A=_[0]+v,N=$,k=g,R=_[1]-$,Math.abs(R)<p&&(R=(R<=0?-1:1)*p);f?(l[S]=A,l[S+1]=N,l[S+2]=u?k:R,c&&(c[S]=u?b.x:A,c[S+1]=u?N:b.y,c[S+2]=x),y[i]=i):e.setItemLayout(i,{x:A,y:N,width:k,height:R}),S+=3}f&&e.setLayout({largePoints:l,largeDataIndices:y,largeBackgroundPoints:c,valueAxisHorizontal:u})}}}}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,QT("bar")),t.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,e){var n=t.componentType||"series";e.eachComponent({mainType:n,query:t},function(e){t.sortInfo&&e.axis.setCategorySortInfo(t.sortInfo)})})},function(t){t.registerChartView(XT),t.registerSeriesModel(vT),t.registerLayout(YT("line",!0)),t.registerVisual({seriesType:"line",reset:function(t){var e=t.getData(),n=t.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=e.getVisual("style").fill),e.setVisual("legendLineStyle",n)}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,QT("line"))},function(t){t.registerChartView(z$),t.registerSeriesModel(U$),function(t,e){function n(e,n){var i=[];return e.eachComponent({mainType:"series",subType:t,query:n},function(t){i.push(t.seriesIndex)}),i}sr([[t+"ToggleSelect","toggleSelect"],[t+"Select","select"],[t+"UnSelect","unselect"]],function(t){e(t[0],function(e,i,r){e=nr({},e),r.dispatchAction(nr(e,{type:t[1],seriesIndex:n(i,e)}))})})}("pie",t.registerAction),t.registerLayout(pr(A$,"pie")),t.registerProcessor(k$("pie")),t.registerProcessor({seriesType:"pie",reset:function(t,e){var n=t.getData();n.filterSelf(function(t){var e=n.mapDimension("value"),i=n.get(e,t);return!(br(i)&&!isNaN(i)&&i<0)})}})},function(t){RC(sA),t.registerSeriesModel(q$),t.registerChartView(G$),t.registerLayout(YT("scatter"))},function(t){RC(xA),t.registerChartView(dA),t.registerSeriesModel(fA),t.registerLayout(lA),t.registerProcessor(k$("radar")),t.registerPreprocessor(uA)},function(t){t.registerChartView(rk),t.registerSeriesModel(mk),t.registerPreprocessor(gk),t.registerVisual(nk),t.registerLayout(vk)},function(t){t.registerChartView(Sk),t.registerSeriesModel(Ck),t.registerLayout(pr(Mk,"sunburst")),t.registerProcessor(pr(k$,"sunburst")),t.registerVisual(Nk),function(t){t.registerAction({type:xk,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e,n){var i=UA(t,[xk],e);if(i){var r=e.getViewRoot();r&&(t.direction=KA(r,i.node)?"rollUp":"drillDown"),e.resetViewRoot(i.node)}})}),t.registerAction({type:wk,update:"none"},function(t,e,n){t=nr({},t),e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e){var n=UA(t,[wk],e);n&&(t.dataIndex=n.node.dataIndex)}),n.dispatchAction(nr(t,{type:"highlight"}))}),t.registerAction({type:"sunburstUnhighlight",update:"updateView"},function(t,e,n){t=nr({},t),n.dispatchAction(nr(t,{type:"downplay"}))})}(t)},function(t){t.registerSeriesModel(XA),t.registerChartView(lN),t.registerVisual(TN),t.registerLayout(PN),function(t){for(var e=0;e<jA.length;e++)t.registerAction({type:jA[e],update:"updateView"},qr);t.registerAction({type:"treemapRootToNode",update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"treemap",query:t},function(e,n){var i=UA(t,["treemapZoomToNode","treemapRootToNode"],e);if(i){var r=e.getViewRoot();r&&(t.direction=KA(r,i.node)?"rollUp":"drillDown"),e.resetViewRoot(i.node)}})})}(t)},function(t){t.registerChartView(KN),t.registerSeriesModel(WN),t.registerLayout(jN),t.registerProcessor(k$("funnel"))},function(t){t.registerPainter("canvas",t_)}]);const u_=[{key:"financial",labelKey:"action.formula.content.categories.financial"},{key:"logical",labelKey:"action.formula.content.categories.logical"},{key:"text",labelKey:"action.formula.content.categories.text"},{key:"datetime",labelKey:"action.formula.content.categories.datetime"},{key:"lookup",labelKey:"action.formula.content.categories.lookup"},{key:"math",labelKey:"action.formula.content.categories.math"},{key:"statistical",labelKey:"action.formula.content.categories.statistical"},{key:"engineering",labelKey:"action.formula.content.categories.engineering"},{key:"information",labelKey:"action.formula.content.categories.information"},{key:"compatibility",labelKey:"action.formula.content.categories.compatibility"},{key:"database",labelKey:"action.formula.content.categories.database"},{key:"web",labelKey:"action.formula.content.categories.web"},{key:"cube",labelKey:"action.formula.content.categories.cube"},{key:"addins",labelKey:"action.formula.content.categories.addins"}],d_=[{key:"all",labelKey:"action.formula.content.categories.all"},{key:"recent",labelKey:"action.formula.content.categories.recent"},...u_],f_={common:["SUM","AVERAGE","COUNT","COUNTA","MAX","MIN","IF","AND","OR","VLOOKUP","XLOOKUP","TEXT","DATE","TODAY"],financial:["PMT","PV","FV","NPV","IRR","RATE","NPER","IPMT","PPMT","XIRR","XNPV","SLN"],logical:["IF","IFS","AND","OR","NOT","XOR","SWITCH","IFERROR","IFNA","LET","LAMBDA"],text:["CONCAT","TEXT","TEXTJOIN","LEFT","RIGHT","MID","LEN","FIND","SEARCH","REPLACE","SUBSTITUTE","TRIM","UPPER","LOWER"],datetime:["TODAY","NOW","DATE","TIME","YEAR","MONTH","DAY","EDATE","EOMONTH","WORKDAY","NETWORKDAYS","DATEDIF"],lookup:["XLOOKUP","VLOOKUP","HLOOKUP","INDEX","MATCH","XMATCH","OFFSET","INDIRECT","CHOOSE","LOOKUP","FILTER","SORT","UNIQUE"],math:["SUM","SUMIF","SUMIFS","SUMPRODUCT","ABS","ROUND","ROUNDUP","ROUNDDOWN","INT","MOD","POWER","SQRT","RAND","RANDBETWEEN"]},p_="sn-formula-recent",m_=new Map(u_.map(t=>[t.key,t.labelKey])),g_=new Map,v_=new Map;u_.forEach(t=>v_.set(t.key,[])),[{name:"ABS",category:"math",desc:"Returns the absolute value of a number"},{name:"ACCRINT",category:"financial",desc:"Returns the accrued interest on a bond that pays periodic interest"},{name:"ACCRINTM",category:"financial",desc:"Returns the accrued interest on a bond that pays interest on the maturity date"},{name:"ACOS",category:"math",desc:"Returns the arc cosine of a number"},{name:"ACOSH",category:"math",desc:"Returns the inverse hyperbolic cosine of a number"},{name:"ACOT",category:"math",desc:"Returns the inverse cotangent of a number",version:"2013"},{name:"ACOTH",category:"math",desc:"Returns the hyperbolic inverse cotangent of a number",version:"2013"},{name:"ADDRESS",category:"lookup",desc:"Return reference value as text to a single cell of the worksheet"},{name:"AGGREGATE",category:"math",desc:"Returns a list or an aggregate in the database"},{name:"AMORDEGRC",category:"financial",desc:"Returns the depreciation value for each accounting period using the depreciation factor"},{name:"AMORLINC",category:"financial",desc:"Returns the depreciation value for each accounting period"},{name:"AND",category:"logical",desc:"Returns TRUE if all its parameters are TRUE"},{name:"ARABIC",category:"math",desc:"Convert Roman numerals to Arabic numerals",version:"2013"},{name:"AREAS",category:"lookup",desc:"Returns the number of areas involved in the reference"},{name:"ARRAYTOTEXT",category:"text",desc:"The ARRAYTOTEXT function returns an array of text values ​​within any specified range.",version:"2021"},{name:"ASC",category:"text",desc:"Change full-width (double-byte) English letters or katakana in a string to half-width (single-byte) characters"},{name:"ASIN",category:"math",desc:"Returns the arcsine of a number"},{name:"ASINH",category:"math",desc:"Returns the inverse hyperbolic sine of a number"},{name:"ATAN",category:"math",desc:"Returns the arctangent of a number"},{name:"ATAN2",category:"math",desc:"Returns the arctangent of the X and Y coordinates"},{name:"ATANH",category:"math",desc:"Returns the inverse hyperbolic tangent of a number"},{name:"AVEDEV",category:"statistical",desc:"Returns the average absolute deviation of data points from their mean"},{name:"AVERAGE",category:"statistical",desc:"Returns the average of its parameters"},{name:"AVERAGEA",category:"statistical",desc:"Returns the average of its arguments, including numbers, text, and logical values"},{name:"AVERAGEIF",category:"statistical",desc:"Returns the average (arithmetic mean) of all cells in a range that meet the given criteria"},{name:"AVERAGEIFS",category:"statistical",desc:"Returns the average (arithmetic mean) of all cells that satisfy multiple criteria."},{name:"BAHTTEXT",category:"text",desc:"Convert numbers to text using ß (Thai Baht) currency format"},{name:"BASE",category:"math",desc:"Converts a number to a textual representation with a given base (base)"},{name:"BESSELI",category:"engineering",desc:"Returns the modified Bessel function In(x)"},{name:"BESSELJ",category:"engineering",desc:"Returns the Bessel function Jn(x)"},{name:"BESSELK",category:"engineering",desc:"Returns the modified Bessel function Kn(x)"},{name:"BESSELY",category:"engineering",desc:"Returns the Bessel function Yn(x)"},{name:"BETA.DIST",category:"statistical",desc:"Returns the beta cumulative distribution function",version:"2010"},{name:"BETA.INV",category:"statistical",desc:"Returns the inverse of the cumulative distribution function for the specified beta distribution",version:"2010"},{name:"BETADIST",category:"compatibility",desc:"Returns the beta cumulative distribution function"},{name:"BETAINV",category:"compatibility",desc:"Returns the inverse of the cumulative distribution function for the specified beta distribution"},{name:"BIN2DEC",category:"engineering",desc:"Convert binary number to decimal number"},{name:"BIN2HEX",category:"engineering",desc:"Convert binary number to hexadecimal number"},{name:"BIN2OCT",category:"engineering",desc:"Convert binary number to octal number"},{name:"BINOM.DIST",category:"statistical",desc:"Returns the probability of the binomial distribution",version:"2010"},{name:"BINOM.DIST.RANGE",category:"statistical",desc:"Returns the probability of a trial outcome using the binomial distribution",version:"2013"},{name:"BINOM.INV",category:"statistical",desc:"Returns the minimum value such that the cumulative binomial distribution is less than or equal to the critical value",version:"2010"},{name:"BINOMDIST",category:"compatibility",desc:"Returns the probability of the binomial distribution"},{name:"BITAND",category:"engineering",desc:"Returns the bitwise AND of two numbers",version:"2013"},{name:"BITLSHIFT",category:"engineering",desc:"Returns the number of calculated values ​​shifted left shift_amount bits",version:"2013"},{name:"BITOR",category:"engineering",desc:'Returns the "bitwise OR" of two numbers',version:"2013"},{name:"BITRSHIFT",category:"engineering",desc:"Returns the number of calculated values ​​shifted right by shift_amount bits",version:"2013"},{name:"BITXOR",category:"engineering",desc:"Returns the bitwise exclusive OR of two numbers",version:"2013"},{name:"BYCOL",category:"logical",desc:"Apply LAMBDA to each column and return the resulting array",version:"2024"},{name:"BYROW",category:"logical",desc:"Apply LAMBDA to each row and return the resulting array",version:"2024"},{name:"CALL",category:"addins",desc:"Call a procedure in a dynamic link library or code source"},{name:"CEILING",category:"compatibility",desc:"Rounds a number to the nearest integer or to the nearest multiple of a specified base"},{name:"CEILING.MATH",category:"math",desc:"Rounds a number up to the nearest integer or to the nearest multiple of the specified base",version:"2013"},{name:"CEILING.PRECISE",category:"math",desc:"Rounds a number to the nearest integer or to the nearest multiple of a specified base. The number is rounded up regardless of its sign."},{name:"CELL",category:"information",desc:"Returns information about cell format, location, or contents"},{name:"CHAR",category:"text",desc:"Returns the character specified by the code number"},{name:"CHIDIST",category:"compatibility",desc:"Returns the one-tailed probability of the χ2 distribution"},{name:"CHIINV",category:"compatibility",desc:"Returns the inverse function of the one-tailed probability of the χ2 distribution"},{name:"CHISQ.DIST",category:"statistical",desc:"Returns the cumulative beta probability density function",version:"2010"},{name:"CHISQ.DIST.RT",category:"statistical",desc:"Returns the one-tailed probability of the χ2 distribution",version:"2010"},{name:"CHISQ.INV",category:"statistical",desc:"Returns the cumulative beta probability density function",version:"2010"},{name:"CHISQ.INV.RT",category:"statistical",desc:"Returns the inverse function of the one-tailed probability of the χ2 distribution",version:"2010"},{name:"CHISQ.TEST",category:"statistical",desc:"Returns the independence test value",version:"2010"},{name:"CHITEST",category:"compatibility",desc:"Returns the independence test value"},{name:"CHOOSE",category:"lookup",desc:"Select a value from a list of values"},{name:"CHOOSECOLS",category:"lookup",desc:"Returns the specified column in the array",version:"2024"},{name:"CHOOSEROWS",category:"lookup",desc:"Returns the specified row in the array",version:"2024"},{name:"CLEAN",category:"text",desc:"Remove all non-printing characters from text"},{name:"CODE",category:"text",desc:"Returns the numeric code of the first character in a text string"},{name:"COLUMN",category:"lookup",desc:"Returns the referenced column number"},{name:"COLUMNS",category:"lookup",desc:"Returns the number of columns contained in the reference"},{name:"COMBIN",category:"math",desc:"Returns the number of combinations of a given number of objects"},{name:"COMBINA",category:"math",desc:"",version:"2013"},{name:"COMPLEX",category:"engineering",desc:"Convert real and imaginary coefficients to complex numbers"},{name:"CONCAT",category:"text",desc:"Combines the text of multiple ranges and/or strings without providing a separator or IgnoreEmpty parameter.",version:"2019"},{name:"CONCATENATE",category:"text",desc:"Combine several text items into one text item"},{name:"CONFIDENCE",category:"compatibility",desc:"Returns the confidence interval for the population mean"},{name:"CONFIDENCE.NORM",category:"statistical",desc:"Returns the confidence interval for the population mean",version:"2010"},{name:"CONFIDENCE.T",category:"statistical",desc:"Returns the confidence interval for the population mean (using Student's t-distribution)",version:"2010"},{name:"CONVERT",category:"engineering",desc:"Convert numbers from one measurement system to another"},{name:"COPILOT",category:"text",desc:"Classify, summarize, and generate text using Copilot",version:"Premium Copilot feature, Beta"},{name:"CORREL",category:"statistical",desc:"Returns the correlation coefficient between two data sets"},{name:"COS",category:"math",desc:"Returns the cosine of a number"},{name:"COSH",category:"math",desc:"Returns the hyperbolic cosine of a number"},{name:"COT",category:"math",desc:"Returns the hyperbolic cosine of a number",version:"2013"},{name:"COTH",category:"math",desc:"Returns the cosine of the angle",version:"2013"},{name:"COUNT",category:"statistical",desc:"Count the number of numbers in a parameter list"},{name:"COUNTA",category:"statistical",desc:"Count the number of values ​​in a parameter list"},{name:"COUNTBLANK",category:"statistical",desc:"Count the number of blank cells in a range"},{name:"COUNTIF",category:"statistical",desc:"Count the number of cells in a range that match a given condition"},{name:"COUNTIFS",category:"statistical",desc:"Count the number of cells in a range that match multiple conditions"},{name:"COUPDAYBS",category:"financial",desc:"Returns the number of days from the start of the coupon period to the settlement date"},{name:"COUPDAYS",category:"financial",desc:"Returns the number of days in the coupon period including the settlement date"},{name:"COUPDAYSNC",category:"financial",desc:"Returns the number of days from the settlement date to the next coupon payment date"},{name:"COUPNCD",category:"financial",desc:"Returns the next coupon payment date after the settlement date"},{name:"COUPNUM",category:"financial",desc:"Returns the number of coupons payable between the settlement date and the maturity date"},{name:"COUPPCD",category:"financial",desc:"Returns the last coupon payment date before the settlement date"},{name:"COVAR",category:"compatibility",desc:"Returns the covariance (the average of the products of pairwise deviations)"},{name:"COVARIANCE.P",category:"statistical",desc:"Returns the covariance (the average of the products of pairwise deviations)",version:"2010"},{name:"COVARIANCE.S",category:"statistical",desc:"Returns the sample covariance, which is the average of the products of the deviations for each pair of data points in the two data sets",version:"2010"},{name:"CRITBINOM",category:"compatibility",desc:"Returns the minimum value such that the cumulative binomial distribution is less than or equal to the critical value"},{name:"CSC",category:"math",desc:"Returns the cosecant value of an angle",version:"2013"},{name:"CSCH",category:"math",desc:"Returns the hyperbolic cosecant of an angle",version:"2013"},{name:"CUBEKPIMEMBER",category:"cube",desc:"Returns key performance indicator (KPI) names, attributes, and metrics and displays the names and attributes in the cells. A KPI is a quantifiable metric used to monitor unit performance, such as monthly total profit or quarterly employee adjustments."},{name:"CUBEMEMBER",category:"cube",desc:"Returns a member or tuple in the cube hierarchy. Used to verify whether a member or tuple exists within a cube."},{name:"CUBEMEMBERPROPERTY",category:"cube",desc:"Returns the value of a member property within a cube. Used to verify whether a member name exists in the cube and return the specified attribute of this member."},{name:"CUBERANKEDMEMBER",category:"cube",desc:"Returns the nth or ranked member in the set. Returns one or more elements in a collection, such as the top salespeople or the top 10 students."},{name:"CUBESET",category:"cube",desc:"Define a set of calculated members or tuples by sending a set expression to a cube on the server, which creates the set, and then returns the set to Microsoft Office Excel."},{name:"CUBESETCOUNT",category:"cube",desc:"Returns the number of items in the collection."},{name:"CUBEVALUE",category:"cube",desc:"Returns summary values ​​from the cube."},{name:"CUMIPMT",category:"financial",desc:"Returns the cumulative interest paid between two payment periods"},{name:"CUMPRINC",category:"financial",desc:"Returns the cumulative principal paid on a loan between two payment periods"},{name:"DATE",category:"datetime",desc:"Returns the serial number for a specific date"},{name:"DATEDIF",category:"datetime",desc:"Calculate the number of days, months, or years between two dates. This function is useful in formulas used to calculate age."},{name:"DATEVALUE",category:"datetime",desc:"Convert date in text format to serial number"},{name:"DAVERAGE",category:"database",desc:"Returns the average of selected database entries"},{name:"DAY",category:"datetime",desc:"Convert serial number to month date"},{name:"DAYS",category:"datetime",desc:"Returns the number of days between two dates",version:"2013"},{name:"DAYS360",category:"datetime",desc:"Calculate the number of days between two dates based on a 360-day year"},{name:"DB",category:"financial",desc:"Returns the depreciation value of an asset over a given period using the declining fixed balance method."},{name:"DBCS",category:"text",desc:"Change half-width (single-byte) English letters or katakana in a string to full-width (double-byte) characters",version:"2013"},{name:"DCOUNT",category:"database",desc:"Count the number of cells in a database that contain numbers"},{name:"DCOUNTA",category:"database",desc:"Count the number of non-empty cells in the database"},{name:"DDB",category:"financial",desc:"Returns the depreciation value of an asset over a given period, using the double-declining-balance method or other specified method."},{name:"DEC2BIN",category:"engineering",desc:"Convert decimal number to binary number"},{name:"DEC2HEX",category:"engineering",desc:"Convert decimal number to hexadecimal number"},{name:"DEC2OCT",category:"engineering",desc:"Convert decimal number to octal number"},{name:"DECIMAL",category:"math",desc:"Converts the textual representation of a number in the given base to a decimal number",version:"2013"},{name:"DEGREES",category:"math",desc:"Convert radians to degrees"},{name:"DELTA",category:"engineering",desc:"Test whether two values ​​are equal"},{name:"DETECTLANGUAGE",category:"text",desc:"Identifies the language of the specified text",version:"Microsoft 365"},{name:"DEVSQ",category:"statistical",desc:"Returns the sum of squared deviations"},{name:"DGET",category:"database",desc:"Extract individual records that meet specified conditions from the database"},{name:"DISC",category:"financial",desc:"Returns the bond's discount rate"},{name:"DMAX",category:"database",desc:"Returns the maximum value of the selected database entry"},{name:"DMIN",category:"database",desc:"Returns the minimum value of selected database entries"},{name:"DOLLAR",category:"text",desc:"Convert numbers to text using ￥ (RMB) currency format"},{name:"DOLLARDE",category:"financial",desc:"Convert a price expressed as a fraction to a price expressed as a decimal"},{name:"DOLLARFR",category:"financial",desc:"Convert a price expressed as a decimal to a price expressed as a fraction"},{name:"DPRODUCT",category:"database",desc:"Multiply the values ​​in a specific field of matching records in the database"},{name:"DROP",category:"lookup",desc:"Exclude a specified number of rows or columns from the beginning or end of an array",version:"2024"},{name:"DSTDEV",category:"database",desc:"Estimated standard deviation based on sample of selected database entries"},{name:"DSTDEVP",category:"database",desc:"Calculates the standard deviation based on the sample population of selected database entries"},{name:"DSUM",category:"database",desc:"Sums the numbers in a field column of matching records in the database"},{name:"DURATION",category:"financial",desc:"Returns the annual maturity of a bond that pays periodic interest"},{name:"DVAR",category:"database",desc:"Estimated variance based on sample of selected database entries"},{name:"DVARP",category:"database",desc:"Calculates the variance based on the sample population of selected database entries"},{name:"EDATE",category:"datetime",desc:"Returns the serial number for a date representing the number of months before or after the start date"},{name:"EFFECT",category:"financial",desc:"Returns the annual effective interest rate"},{name:"ENCODEURL",category:"web",desc:"Returns a URL-encoded string",version:"2013"},{name:"EOMONTH",category:"datetime",desc:"Returns the serial number of the last day of the month before or after the specified number of months"},{name:"ERF",category:"engineering",desc:"Return error function"},{name:"ERF.PRECISE",category:"engineering",desc:"Return error function",version:"2010"},{name:"ERFC",category:"engineering",desc:"Returns the complementary error function"},{name:"ERFC.PRECISE",category:"engineering",desc:"Returns the complementary ERF function integrating from x to infinity",version:"2010"},{name:"ERROR.TYPE",category:"information",desc:"Returns the number corresponding to the error type"},{name:"EUROCONVERT",category:"addins",desc:"Convert numbers into euro form, convert numbers from euro form into the currency of an EU member state, or use the euro as an intermediary currency to convert numbers from the currency of one EU member state into the currency of another EU member state (triangular conversion relationship)."},{name:"EVEN",category:"math",desc:"Round a number up to the nearest even number"},{name:"EXACT",category:"text",desc:"Check if two text values ​​are the same"},{name:"EXP",category:"math",desc:"Returns e raised to the nth power"},{name:"EXPAND",category:"lookup",desc:"Expand or fill an array to specified row and column dimensions",version:"2024"},{name:"EXPON.DIST",category:"statistical",desc:"Returns exponential distribution",version:"2010"},{name:"EXPONDIST",category:"compatibility",desc:"Returns exponential distribution"},{name:"F.DIST",category:"statistical",desc:"Returns the F probability distribution",version:"2010"},{name:"F.DIST.RT",category:"statistical",desc:"Returns the F probability distribution",version:"2010"},{name:"F.INV",category:"statistical",desc:"Returns the inverse function of the F probability distribution",version:"2010"},{name:"F.INV.RT",category:"statistical",desc:"Returns the inverse function of the F probability distribution",version:"2010"},{name:"F.TEST",category:"statistical",desc:"Returns the result of the F test",version:"2010"},{name:"FACT",category:"math",desc:"Returns the factorial of a number"},{name:"FACTDOUBLE",category:"math",desc:"Returns the double factorial of a number"},{name:"FALSE",category:"logical",desc:"Returns the logical value FALSE"},{name:"FDIST",category:"compatibility",desc:"Returns the F probability distribution"},{name:"FILTER",category:"lookup",desc:"The FILTER function filters a range of data based on defined conditions.",version:"2021"},{name:"FILTERXML",category:"web",desc:"Returns specific data within the XML content using the specified XPath",version:"2013"},{name:"FIND",category:"text",desc:"Find a text value within another text value (case sensitive)"},{name:"FINDB",category:"text",desc:"Find a text value within another text value (case sensitive)"},{name:"FINV",category:"compatibility",desc:"Returns the inverse function of the F probability distribution"},{name:"FISHER",category:"statistical",desc:"Returns the Fisher transformed value"},{name:"FISHERINV",category:"statistical",desc:"Returns the inverse function of the Fisher transform"},{name:"FIXED",category:"text",desc:"Format a number as text with a fixed number of decimal places"},{name:"FLOOR",category:"compatibility",desc:"Round numbers toward decreasing absolute value"},{name:"FLOOR.MATH",category:"math",desc:"Rounds a number down to the nearest integer or to the nearest multiple of the specified base",version:"2013"},{name:"FLOOR.PRECISE",category:"math",desc:"Rounds a number to the nearest integer or to the nearest multiple of a specified base. The number is rounded up regardless of its sign."},{name:"FORECAST",category:"statistical",desc:"Returns linear trend value"},{name:"FORECAST.ETS",category:"statistical",desc:"Returns a future value based on an existing (historical) value by using the AAA version of the exponential smoothing (ETS) algorithm",version:"2016"},{name:"FORECAST.ETS.CONFINT",category:"statistical",desc:"Returns the confidence interval for the predicted value for a specified target date",version:"2016"},{name:"FORECAST.ETS.SEASONALITY",category:"statistical",desc:"Returns the length of the repeating pattern detected by Excel for the specified time series",version:"2016"},{name:"FORECAST.ETS.STAT",category:"statistical",desc:"Returns statistical values ​​that are the result of time series forecasting.",version:"2016"},{name:"FORECAST.LINEAR",category:"statistical",desc:"Returns a future value based on an existing value",version:"2016"},{name:"FORMULATEXT",category:"lookup",desc:"Returns the formula for the given reference as text",version:"2013"},{name:"FREQUENCY",category:"statistical",desc:"Returns the frequency distribution as a vertical array"},{name:"FTEST",category:"compatibility",desc:"Returns the result of the F test"},{name:"FV",category:"financial",desc:"Returns the future value of an investment"},{name:"FVSCHEDULE",category:"financial",desc:"Returns the future value of the initial principal calculated applying a series of compound interest rates"},{name:"GAMMA",category:"statistical",desc:"Returns the γ function value",version:"2013"},{name:"GAMMA.DIST",category:"statistical",desc:"Returns γ distribution",version:"2010"},{name:"GAMMA.INV",category:"statistical",desc:"Returns γ the inverse of the cumulative distribution function",version:"2010"},{name:"GAMMADIST",category:"compatibility",desc:"Returns γ distribution"},{name:"GAMMAINV",category:"compatibility",desc:"Returns γ the inverse of the cumulative distribution function"},{name:"GAMMALN",category:"statistical",desc:"Returns the natural logarithm of the γ function, Γ(x)"},{name:"GAMMALN.PRECISE",category:"statistical",desc:"Returns the natural logarithm of the γ function, Γ(x)",version:"2010"},{name:"GAUSS",category:"statistical",desc:"Returns values ​​less than 0.5 from the standard normal cumulative distribution",version:"2013"},{name:"GCD",category:"math",desc:"Returns the greatest common divisor"},{name:"GEOMEAN",category:"statistical",desc:"Returns the geometric mean"},{name:"GESTEP",category:"engineering",desc:"Check if the number is greater than the threshold"},{name:"GETPIVOTDATA",category:"lookup",desc:"Return the data stored in the pivot table"},{name:"GROUPBY",category:"lookup",desc:"Help users group, aggregate, sort and filter data based on specified fields",version:"Microsoft 365"},{name:"GROWTH",category:"statistical",desc:"Returns exponential trend value"},{name:"HARMEAN",category:"statistical",desc:"Returns the harmonic mean"},{name:"HEX2BIN",category:"engineering",desc:"Convert hexadecimal number to binary number"},{name:"HEX2DEC",category:"engineering",desc:"Convert hexadecimal number to decimal number"},{name:"HEX2OCT",category:"engineering",desc:"Convert hexadecimal number to octal number"},{name:"HLOOKUP",category:"lookup",desc:"Find the first row of an array and return the value of the specified cell"},{name:"HOUR",category:"datetime",desc:"Convert serial number to hours"},{name:"HSTACK",category:"lookup",desc:"Append an array horizontally in sequence to return a larger array",version:"2024"},{name:"HYPERLINK",category:"lookup",desc:"Create shortcuts or jumps to open documents stored on a network server, intranet, or Internet"},{name:"HYPGEOM.DIST",category:"statistical",desc:"Returns the hypergeometric distribution"},{name:"HYPGEOMDIST",category:"compatibility",desc:"Returns the hypergeometric distribution"},{name:"IF",category:"logical",desc:"Specify the logic tests to perform"},{name:"IFERROR",category:"logical",desc:"If the formula evaluates to an error, returns the value you specify; otherwise, returns the result of the formula"},{name:"IFNA",category:"logical",desc:"If the expression resolves to #N/A, returns the specified value; otherwise, returns the result of the expression",version:"2013"},{name:"IFS",category:"logical",desc:"Checks whether one or more conditions are met and returns the value corresponding to the first TRUE condition.",version:"2019"},{name:"IMABS",category:"engineering",desc:"Returns the absolute value (modulo) of a complex number"},{name:"IMAGE",category:"lookup",desc:"Returns an image from the given source",version:"2024"},{name:"IMAGINARY",category:"engineering",desc:"Returns the imaginary coefficient of a complex number"},{name:"IMARGUMENT",category:"engineering",desc:"Returns the parameter theta, the angle in radians"},{name:"IMCONJUGATE",category:"engineering",desc:"Returns the complex conjugate of a complex number"},{name:"IMCOS",category:"engineering",desc:"Returns the cosine of a complex number"},{name:"IMCOSH",category:"engineering",desc:"Returns the hyperbolic cosine of a complex number",version:"2013"},{name:"IMCOT",category:"engineering",desc:"Returns the cosine of a complex number",version:"2013"},{name:"IMCSC",category:"engineering",desc:"Returns the cosecant value of a complex number",version:"2013"},{name:"IMCSCH",category:"engineering",desc:"Returns the hyperbolic cosecant of a complex number",version:"2013"},{name:"IMDIV",category:"engineering",desc:"Returns the quotient of two complex numbers"},{name:"IMEXP",category:"engineering",desc:"Returns the exponent of a complex number"},{name:"IMLN",category:"engineering",desc:"Returns the natural logarithm of a complex number"},{name:"IMLOG10",category:"engineering",desc:"Returns the base 10 logarithm of a complex number"},{name:"IMLOG2",category:"engineering",desc:"Returns the base 2 logarithm of a complex number"},{name:"IMPOWER",category:"engineering",desc:"Returns a complex number raised to an integer power"},{name:"IMPRODUCT",category:"engineering",desc:"Returns plural Product"},{name:"IMREAL",category:"engineering",desc:"Returns the real coefficients of a complex number"},{name:"IMSEC",category:"engineering",desc:"Returns the secant value of a complex number",version:"2013"},{name:"IMSECH",category:"engineering",desc:"Returns the hyperbolic secant value of a complex number",version:"2013"},{name:"IMSIN",category:"engineering",desc:"Returns the sine of a complex number"},{name:"IMSINH",category:"engineering",desc:"Returns the hyperbolic sine of a complex number",version:"2013"},{name:"IMSQRT",category:"engineering",desc:"Returns the square root of a complex number"},{name:"IMSUB",category:"engineering",desc:"Returns the difference between two complex numbers"},{name:"IMSUM",category:"engineering",desc:"Returns the sum of multiple complex numbers"},{name:"IMTAN",category:"engineering",desc:"Returns the tangent of a complex number",version:"2013"},{name:"INDEX",category:"lookup",desc:"Select a value from a reference or array using index"},{name:"INDIRECT",category:"lookup",desc:"Returns the reference specified by a text value"},{name:"INFO",category:"information",desc:"Returns information about the current operating environment"},{name:"INT",category:"math",desc:"Round a number down to the nearest integer"},{name:"INTERCEPT",category:"statistical",desc:"Returns the intercept of the linear regression line"},{name:"INTRATE",category:"financial",desc:"Returns the interest rate on a fully invested bond"},{name:"IPMT",category:"financial",desc:"Returns the interest paid by an investment during a given period"},{name:"IRR",category:"financial",desc:"Returns the internal rate of return for a series of cash flows"},{name:"ISBLANK",category:"information",desc:"Returns TRUE if the value is empty"},{name:"ISERR",category:"information",desc:"Returns TRUE if the value is any error value except #N/A"},{name:"ISERROR",category:"information",desc:"Returns TRUE if value is any error value"},{name:"ISEVEN",category:"information",desc:"Returns TRUE if the number is even"},{name:"ISFORMULA",category:"information",desc:"Returns TRUE if there is a reference to the cell containing the formula",version:"2013"},{name:"ISLOGICAL",category:"information",desc:"Returns TRUE if the value is a logical value"},{name:"ISNA",category:"information",desc:"Returns TRUE if the value is the error value #N/A"},{name:"ISNONTEXT",category:"information",desc:"Returns TRUE if the value is not text"},{name:"ISNUMBER",category:"information",desc:"Returns TRUE if value is a number"},{name:"ISO.CEILING",category:"math",desc:"Returns a number rounded up to the nearest integer or to the nearest multiple of significant digits",version:"2013"},{name:"ISODD",category:"information",desc:"Returns TRUE if the number is odd"},{name:"ISOMITTED",category:"information",desc:"Checks LAMBDA for missing values ​​and returns TRUE or FALSE",version:"2024"},{name:"ISOWEEKNUM",category:"datetime",desc:"Returns the ISO week number in the year for a given date",version:"2013"},{name:"ISPMT",category:"financial",desc:"Calculate the interest to be paid over a specific investment period"},{name:"ISREF",category:"information",desc:"Returns TRUE if the value is a reference"},{name:"ISTEXT",category:"information",desc:"Returns TRUE if value is text"},{name:"JIS",category:"text",desc:"Change half-width (single-byte) characters in a string to full-width (double-byte) characters"},{name:"KURT",category:"statistical",desc:"Returns the peak value of the data set"},{name:"LAMBDA",category:"logical",desc:"Create custom, reusable items and call them by friendly names",version:"2024"},{name:"LARGE",category:"statistical",desc:"Returns the kth largest value in the data set"},{name:"LCM",category:"math",desc:"Returns the lowest common multiple"},{name:"LEFT",category:"text",desc:"Returns the leftmost character in a text value"},{name:"LEFTB",category:"text",desc:"Returns the leftmost character in a text value"},{name:"LEN",category:"text",desc:"Returns the number of characters in a text string"},{name:"LENB",category:"text",desc:"Returns the number of characters in a text string"},{name:"LET",category:"logical",desc:"Assign a name to a calculation result",version:"2021"},{name:"LINEST",category:"statistical",desc:"Returns the parameters of a linear trend"},{name:"LN",category:"math",desc:"Returns the natural logarithm of a number"},{name:"LOG",category:"math",desc:"Returns the logarithm of a number to the specified base"},{name:"LOG10",category:"math",desc:"Returns the base 10 logarithm of a number"},{name:"LOGEST",category:"statistical",desc:"Returns the parameters of the exponential trend"},{name:"LOGINV",category:"compatibility",desc:"Returns the inverse function of the logarithmic cumulative distribution"},{name:"LOGNORM.DIST",category:"statistical",desc:"Returns the logarithmic cumulative distribution function",version:"2010"},{name:"LOGNORM.INV",category:"statistical",desc:"Returns the inverse function of the logarithmic cumulative distribution",version:"2010"},{name:"LOGNORMDIST",category:"compatibility",desc:"Returns the logarithmic cumulative distribution function"},{name:"LOOKUP",category:"lookup",desc:"Find a value in a vector or array"},{name:"LOWER",category:"text",desc:"Convert text to lowercase"},{name:"MAKEARRAY",category:"logical",desc:"Returns a calculated array of specified row and column sizes by applying LAMBDA",version:"2024"},{name:"MAP",category:"logical",desc:"Creates a new value by applying LAMBDA, returning an array formed by mapping each value in the array to the new value",version:"2024"},{name:"MATCH",category:"lookup",desc:"Find a value in a reference or array"},{name:"MAX",category:"statistical",desc:"Returns the maximum value in the parameter list"},{name:"MAXA",category:"statistical",desc:"Returns the maximum value in the argument list, including numbers, text, and logical values"},{name:"MAXIFS",category:"statistical",desc:"Returns the maximum value between a set of cells specified by a given condition or criterion",version:"2019"},{name:"MDETERM",category:"math",desc:"Returns the value of the matrix determinant of an array"},{name:"MDURATION",category:"financial",desc:"Returns the Macauley modified maturity of a security assuming a par value of $100"},{name:"MEDIAN",category:"statistical",desc:"Returns the median value of a given set of numbers"},{name:"MID",category:"text",desc:"Returns a specific number of characters starting at a specified position in a text string"},{name:"MIDB",category:"text",desc:"Returns a specific number of characters starting at a specified position in a text string"},{name:"MIN",category:"statistical",desc:"Returns the minimum value in the argument list"},{name:"MINA",category:"statistical",desc:"Returns the minimum value in the argument list, including numbers, text, and logical values"},{name:"MINIFS",category:"statistical",desc:"Returns the minimum value between a set of cells specified by a given condition or criterion.",version:"2019"},{name:"MINUTE",category:"datetime",desc:"Convert serial number to minutes"},{name:"MINVERSE",category:"math",desc:"Returns the inverse matrix of an array"},{name:"MIRR",category:"financial",desc:"Returns the internal rate of return calculated at different interest rates for positive and negative cash flows"},{name:"MMULT",category:"math",desc:"Returns the matrix product of two arrays"},{name:"MOD",category:"math",desc:"Returns the remainder of division"},{name:"MODE",category:"compatibility",desc:"Returns the value that occurs most frequently in the data set"},{name:"MODE.MULT",category:"statistical",desc:"Returns a vertical array of the most frequently occurring or recurring values ​​in a set of data or a range of data",version:"2010"},{name:"MODE.SNGL",category:"statistical",desc:"Returns the value that occurs most frequently in the data set",version:"2010"},{name:"MONTH",category:"datetime",desc:"Convert serial number to month"},{name:"MROUND",category:"math",desc:"Returns a number rounded to the desired multiple"},{name:"MULTINOMIAL",category:"math",desc:"Returns a polynomial of a set of numbers"},{name:"MUNIT",category:"math",desc:"Returns the identity matrix or specified dimensions",version:"2013"},{name:"N",category:"information",desc:"Returns the value converted to a number"},{name:"NA",category:"information",desc:"Return error value #N/A"},{name:"NEGBINOM.DIST",category:"statistical",desc:"Returns the negative binomial distribution",version:"2010"},{name:"NEGBINOMDIST",category:"compatibility",desc:"Returns the negative binomial distribution"},{name:"NETWORKDAYS",category:"datetime",desc:"Returns the number of complete working days between two dates"},{name:"NETWORKDAYS.INTL",category:"datetime",desc:"Returns the number of complete working days between two dates (use the parameter to specify how many weekends there are and specify which days)",version:"2010"},{name:"NOMINAL",category:"financial",desc:"Returns the nominal interest rate for the year"},{name:"NORM.DIST",category:"statistical",desc:"Returns the normal cumulative distribution",version:"2010"},{name:"NORM.INV",category:"compatibility",desc:"Returns the inverse function of the normal cumulative distribution",version:"2010"},{name:"NORM.S.DIST",category:"statistical",desc:"Returns the standard normal cumulative distribution",version:"2010"},{name:"NORM.S.INV",category:"statistical",desc:"Returns the inverse function of the standard normal cumulative distribution function",version:"2010"},{name:"NORMDIST",category:"compatibility",desc:"Returns the normal cumulative distribution"},{name:"NORMINV",category:"statistical",desc:"Returns the inverse function of the normal cumulative distribution"},{name:"NORMSDIST",category:"compatibility",desc:"Returns the standard normal cumulative distribution"},{name:"NORMSINV",category:"compatibility",desc:"Returns the inverse function of the standard normal cumulative distribution function"},{name:"NOT",category:"logical",desc:"logical negation of its argument"},{name:"NOW",category:"datetime",desc:"Returns the serial number for the current date and time"},{name:"NPER",category:"financial",desc:"Returns the number of periods invested"},{name:"NPV",category:"financial",desc:"Returns the net present value of an investment based on a series of periodic cash flows and the discount rate"},{name:"NUMBERVALUE",category:"text",desc:"Convert text to numbers in a locale-independent manner",version:"2013"},{name:"OCT2BIN",category:"engineering",desc:"Convert octal number to binary number"},{name:"OCT2DEC",category:"engineering",desc:"Convert octal number to decimal number"},{name:"OCT2HEX",category:"engineering",desc:"Convert octal number to hexadecimal number"},{name:"ODD",category:"math",desc:"Round a number up to the nearest odd number"},{name:"ODDFPRICE",category:"financial",desc:"Returns the current price of each bond with a face value of $100 and an odd-numbered first period."},{name:"ODDFYIELD",category:"financial",desc:"Returns the return on a bond with an odd first period"},{name:"ODDLPRICE",category:"financial",desc:"Returns the current price of each bond with a face value of $100 and an odd-numbered last issue."},{name:"ODDLYIELD",category:"financial",desc:"Returns the return on a bond with an odd last period"},{name:"OFFSET",category:"lookup",desc:"Returns the reference offset from the given reference"},{name:"OR",category:"logical",desc:"If any parameter is TRUE, returns TRUE"},{name:"PDURATION",category:"financial",desc:"Returns the number of periods required for the investment to reach the specified value",version:"2013"},{name:"PEARSON",category:"statistical",desc:"Returns the Pearson product-moment correlation coefficient"},{name:"PERCENTILE",category:"compatibility",desc:"Returns the kth percentile of values ​​in a range"},{name:"PERCENTILE.EXC",category:"statistical",desc:"Returns the kth percentile of a range of values, where k ranges from 0 to 1 (exclusive)",version:"2010"},{name:"PERCENTILE.INC",category:"statistical",desc:"Returns the kth percentile of values ​​in a range",version:"2010"},{name:"PERCENTOF",category:"math",desc:"Sum the values ​​in a subset and divide it by all values",version:"Microsoft 365"},{name:"PERCENTRANK",category:"compatibility",desc:"Returns the percentile ranking of values ​​in a data set"},{name:"PERCENTRANK.EXC",category:"statistical",desc:"Returns the ranking of a value in the data set as the percentile value of the data set, where the percentile value ranges from 0 to 1 (exclusive)",version:"2010"},{name:"PERCENTRANK.INC",category:"statistical",desc:"Returns the percentile ranking of values ​​in a data set",version:"2010"},{name:"PERMUT",category:"statistical",desc:"Returns the number of permutations of a given number of objects"},{name:"PERMUTATIONA",category:"statistical",desc:"Returns the number of permutations for a given number of objects (including duplicates) that can be selected from the total object",version:"2013"},{name:"PHI",category:"statistical",desc:"Returns the density function value of the standard normal distribution",version:"2013"},{name:"PHONETIC",category:"text",desc:"Extract Pinyin (Chinese phonetic notation) characters from a text string"},{name:"PI",category:"math",desc:"Returns the value of pi"},{name:"PIVOTBY",category:"lookup",desc:"Help users group, aggregate, sort and filter data based on specified row and column fields",version:"Microsoft 365"},{name:"PMT",category:"financial",desc:"Returns the periodic payment amount of an annuity"},{name:"POISSON",category:"compatibility",desc:"Returns Poisson distribution"},{name:"POISSON.DIST",category:"statistical",desc:"Returns Poisson distribution",version:"2010"},{name:"POWER",category:"math",desc:"Returns the number raised to a power"},{name:"PPMT",category:"financial",desc:"Returns the principal repaid by an investment over a given period"},{name:"PRICE",category:"financial",desc:"Returns the current price of a bond with a face value of $100 and regular interest payments."},{name:"PRICEDISC",category:"financial",desc:"Returns the current price of each discounted bond with a face value of $100"},{name:"PRICEMAT",category:"financial",desc:"Returns the current price of a bond with a face value of $100 and which pays interest on the maturity date."},{name:"PROB",category:"statistical",desc:"Returns the probability that a value in a range falls within a specified interval"},{name:"PRODUCT",category:"math",desc:"Multiply its parameters"},{name:"PROPER",category:"text",desc:"Capitalize the first letter of each word in a text value"},{name:"PV",category:"financial",desc:"Returns the present value of an investment"},{name:"QUARTILE",category:"compatibility",desc:"Returns the quartile points of a set of data"},{name:"QUARTILE.EXC",category:"statistical",desc:"Returns the quartiles of a data set based on percentile values, where percentile values ​​range from 0 to 1 (exclusive)",version:"2010"},{name:"QUARTILE.INC",category:"statistical",desc:"Returns the quartile points of a set of data",version:"2010"},{name:"QUOTIENT",category:"math",desc:"Returns the integer part of division"},{name:"RADIANS",category:"math",desc:"Convert degrees to radians"},{name:"RAND",category:"math",desc:"Returns a random number between 0 and 1"},{name:"RANDARRAY",category:"math",desc:"The RANDARRAY function returns an array of random numbers between 0 and 1. However, you can specify the number of rows and columns to fill, the minimum and maximum values, and whether to return whole numbers or decimal values.",version:"2021"},{name:"RANDBETWEEN",category:"math",desc:"Returns a random number between two specified numbers"},{name:"RANK",category:"compatibility",desc:"Returns the numerical ranking of a column of numbers"},{name:"RANK.AVG",category:"statistical",desc:"Returns the numerical ranking of a column of numbers",version:"2010"},{name:"RANK.EQ",category:"statistical",desc:"Returns the numerical ranking of a column of numbers",version:"2010"},{name:"RATE",category:"financial",desc:"Returns the interest rate for each period of the annuity"},{name:"RECEIVED",category:"financial",desc:"Returns the amount received on maturity for a fully invested bond"},{name:"REDUCE",category:"logical",desc:"Reduce an array to a cumulative value by applying LAMBDA to each value and returning the total value in an accumulator",version:"2024"},{name:"REGEXEXTRACT",category:"text",desc:"Extracts strings matching a pattern from the provided text",version:"Microsoft 365"},{name:"REGEXREPLACE",category:"text",desc:"Replaces strings matching the pattern in the provided text with the replacement",version:"Microsoft 365"},{name:"REGEXTEST",category:"text",desc:"Determine whether any part of text matches a pattern",version:"Microsoft 365"},{name:"REGISTER.ID",category:"addins",desc:"Returns the registration number of the specified dynamic link library (DLL) or code source that has been registered"},{name:"REPLACE",category:"text",desc:"Replace characters in text"},{name:"REPLACEB",category:"text",desc:"Replace characters in text"},{name:"REPT",category:"text",desc:"Repeat text a given number of times"},{name:"RIGHT",category:"text",desc:"Returns the rightmost character in a text value"},{name:"RIGHTB",category:"text",desc:"Returns the rightmost character in a text value"},{name:"ROMAN",category:"math",desc:"Convert Arabic numerals to literal Roman numerals"},{name:"ROUND",category:"math",desc:"Rounds a number to a specified number of digits"},{name:"ROUNDDOWN",category:"math",desc:"Round numbers toward decreasing absolute value"},{name:"ROUNDUP",category:"math",desc:"Round numbers toward increasing absolute value"},{name:"ROW",category:"lookup",desc:"Returns the referenced line number"},{name:"ROWS",category:"lookup",desc:"Returns the number of rows in the reference"},{name:"RRI",category:"financial",desc:"Returns the equivalent interest rate of an investment's growth",version:"2013"},{name:"RSQ",category:"statistical",desc:"Returns the square of the Pearson product-moment correlation coefficient"},{name:"RTD",category:"lookup",desc:"Retrieve real-time data from COM Automation-enabled programs"},{name:"SCAN",category:"logical",desc:"Scans the array by applying LAMBDA to each value and returns an array with each intermediate value",version:"2024"},{name:"SEARCH",category:"text",desc:"Find a text value within another text value (case insensitive)"},{name:"SEARCHB",category:"text",desc:"Find a text value within another text value (case insensitive)"},{name:"SEC",category:"math",desc:"Returns the secant value of the angle",version:"2013"},{name:"SECH",category:"math",desc:"Returns the hyperbolic tangent of an angle",version:"2013"},{name:"SECOND",category:"datetime",desc:"Convert sequence number to seconds"},{name:"SEQUENCE",category:"math",desc:"The SEQUENCE function generates a sequence of consecutive numbers in an array, for example, 1, 2, 3, 4.",version:"2021"},{name:"SERIESSUM",category:"math",desc:"Returns the sum of power series based on the formula"},{name:"SHEET",category:"information",desc:"Returns the worksheet number of the referenced worksheet",version:"2013"},{name:"SHEETS",category:"information",desc:"Returns the number of worksheets in the reference",version:"2013"},{name:"SIGN",category:"math",desc:"Returns the symbol of the number"},{name:"SIN",category:"math",desc:"Returns the sine of the given angle"},{name:"SINH",category:"math",desc:"Returns the hyperbolic sine of a number"},{name:"SKEW",category:"statistical",desc:"Returns the asymmetry of the distribution"},{name:"SKEW.P",category:"statistical",desc:"Returns the asymmetry of a distribution: used to reflect the degree of asymmetry of a distribution relative to its mean",version:"2013"},{name:"SLN",category:"financial",desc:"Returns the linear depreciation fee for each period of fixed assets"},{name:"SLOPE",category:"statistical",desc:"Returns the slope of the linear regression line"},{name:"SMALL",category:"statistical",desc:"Returns the kth smallest value in the data set"},{name:"SORT",category:"lookup",desc:"Sort the contents of a range or array",version:"2021"},{name:"SORTBY",category:"lookup",desc:"Sorts the contents of a range or array based on the values ​​in the corresponding range or array",version:"2021"},{name:"SQRT",category:"math",desc:"Returns the positive square root"},{name:"SQRTPI",category:"math",desc:"Returns the square root of the product of a number and pi"},{name:"STANDARDIZE",category:"statistical",desc:"Returns the normalized value"},{name:"STDEV",category:"compatibility",desc:"Estimating standard deviation based on sample"},{name:"STDEV.P",category:"statistical",desc:"Calculate the standard deviation based on the entire sample population",version:"2010"},{name:"STDEV.S",category:"statistical",desc:"Estimating standard deviation based on sample",version:"2010"},{name:"STDEVA",category:"statistical",desc:"Estimate standard deviation based on samples (including numbers, text, and logical values)"},{name:"STDEVP",category:"compatibility",desc:"Calculate the standard deviation based on the entire sample population"},{name:"STDEVPA",category:"statistical",desc:"Calculate the standard deviation based on the sample population (including numbers, text, and logical values)"},{name:"STEYX",category:"statistical",desc:"Returns the standard error produced by linear regression in predicting the y value for each x"},{name:"STOCKHISTORY",category:"information",desc:"Retrieve historical data on a financial instrument and load it as an array"},{name:"SUBSTITUTE",category:"text",desc:"Replace old text with new text in a text string"},{name:"SUBTOTAL",category:"math",desc:"Returns a subtotal in a list or database"},{name:"SUM",category:"math",desc:"Find the sum of parameters"},{name:"SUMIF",category:"math",desc:"Sum specified cells based on given criteria"},{name:"SUMIFS",category:"math",desc:"Add cells that meet multiple conditions in a range"},{name:"SUMPRODUCT",category:"math",desc:"Returns the sum of the products of the corresponding array elements"},{name:"SUMSQ",category:"math",desc:"Returns the sum of the squares of the parameters"},{name:"SUMX2MY2",category:"math",desc:"Returns the sum of the squared differences of corresponding values ​​in the two arrays"},{name:"SUMX2PY2",category:"math",desc:"Returns the sum of the squares of corresponding values ​​in two arrays"},{name:"SUMXMY2",category:"math",desc:"Returns the sum of squares of the differences between corresponding values ​​in two arrays"},{name:"SWITCH",category:"logical",desc:"Evaluates an expression against a list of values ​​and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",version:"2019"},{name:"SYD",category:"financial",desc:"Returns the depreciation amount of a fixed asset in each period calculated using the sum-of-years depreciation method."},{name:"T",category:"text",desc:"Convert parameters to text"},{name:"T.DIST",category:"statistical",desc:"Returns the percentile (probability) of the Student's t-distribution",version:"2010"},{name:"T.DIST.2T",category:"statistical",desc:"Returns the percentile (probability) of the Student's t-distribution",version:"2010"},{name:"T.DIST.RT",category:"statistical",desc:"Returns the Student's t-distribution",version:"2010"},{name:"T.INV",category:"statistical",desc:"Returns the t value of the Student's t distribution as a function of probability and degrees of freedom",version:"2010"},{name:"T.INV.2T",category:"statistical",desc:"Returns the inverse function of the Student's t-distribution",version:"2010"},{name:"T.TEST",category:"statistical",desc:"Returns the probability associated with the Student's t-test",version:"2010"},{name:"TAKE",category:"lookup",desc:"Returns a specified number of consecutive rows or columns from the beginning or end of an array",version:"2024"},{name:"TAN",category:"math",desc:"Returns the tangent of a number"},{name:"TANH",category:"math",desc:"Returns the hyperbolic tangent of a number"},{name:"TBILLEQ",category:"financial",desc:"Returns the bond equivalent yield of a Treasury bill"},{name:"TBILLPRICE",category:"financial",desc:"Returns the price of a Treasury bill with a face value of $100"},{name:"TBILLYIELD",category:"financial",desc:"Returns the yield on Treasury Bills"},{name:"TDIST",category:"compatibility",desc:"Returns the Student's t-distribution"},{name:"TEXT",category:"text",desc:"Format and convert numbers to text"},{name:"TEXTAFTER",category:"text",desc:"Returns the text that occurs after the given character or string",version:"2024"},{name:"TEXTBEFORE",category:"text",desc:"Returns the text that occurs before the given character or string",version:"2024"},{name:"TEXTJOIN",category:"text",desc:"Merge text from multiple ranges and/or strings",version:"2019"},{name:"TEXTSPLIT",category:"text",desc:"Split text string using column and row delimiters",version:"2024"},{name:"TIME",category:"datetime",desc:"Returns the sequence number at a specific time"},{name:"TIMEVALUE",category:"datetime",desc:"Convert time in text format to serial number"},{name:"TINV",category:"compatibility",desc:"Returns the inverse function of the Student's t-distribution"},{name:"TOCOL",category:"lookup",desc:"Returns an array in a single column",version:"2024"},{name:"TODAY",category:"datetime",desc:"Returns the serial number for today's date"},{name:"TOROW",category:"lookup",desc:"Returns an array in a single row",version:"2024"},{name:"TRANSLATE",category:"text",desc:"Translate text from one language to another",version:"Microsoft 365"},{name:"TRANSPOSE",category:"lookup",desc:"Returns the transpose of an array"},{name:"TREND",category:"statistical",desc:"Returns linear trend value"},{name:"TRIM",category:"text",desc:"Remove spaces from text"},{name:"TRIMMEAN",category:"statistical",desc:"Returns the internal average of a data set"},{name:"TRIMRANGE",category:"lookup",desc:"Scan from the edge of the range or array until you find a non-blank cell (or value), then exclude these blank rows or columns",version:"Microsoft 365"},{name:"TRUE",category:"logical",desc:"Returns logical value TRUE"},{name:"TRUNC",category:"math",desc:"truncate numbers"},{name:"TTEST",category:"compatibility",desc:"Returns the probability associated with the Student's t-test"},{name:"TYPE",category:"information",desc:"Returns a number representing the data type of the value"},{name:"UNICHAR",category:"text",desc:"Returns the Unicode character referenced by the given numeric value",version:"2013"},{name:"UNICODE",category:"text",desc:"Returns the number (code point) corresponding to the first character of text",version:"2013"},{name:"UNIQUE",category:"lookup",desc:"Returns a list of unique values ​​for a list or range",version:"2021"},{name:"UPPER",category:"text",desc:"Convert text to uppercase"},{name:"VALUE",category:"text",desc:"Convert text parameters to numbers"},{name:"VALUETOTEXT",category:"text",desc:"Return text from any specified value",version:"2021"},{name:"VAR",category:"compatibility",desc:"Estimating variance based on samples"},{name:"VAR.P",category:"statistical",desc:"Calculate the variance based on the sample population",version:"2010"},{name:"VAR.S",category:"statistical",desc:"Estimating variance based on samples",version:"2010"},{name:"VARA",category:"statistical",desc:"Estimate variance based on samples (including numbers, text, and logical values)"},{name:"VARP",category:"compatibility",desc:"Calculate the variance based on the sample population"},{name:"VARPA",category:"statistical",desc:"Calculate the standard deviation based on the sample population (including numbers, text, and logical values)"},{name:"VDB",category:"financial",desc:"Returns the depreciation value of an asset for a given period or part of a period, using the declining balance method."},{name:"VLOOKUP",category:"lookup",desc:"Find in the first column of an array and move between rows to return the value of the cell"},{name:"VSTACK",category:"lookup",desc:"Append arrays vertically in sequence to return a larger array",version:"2024"},{name:"WEBSERVICE",category:"web",desc:"Return data from the web service.",version:"2013"},{name:"WEEKDAY",category:"datetime",desc:"Convert serial number to weekday date"},{name:"WEEKNUM",category:"datetime",desc:"Convert a serial number to a number that represents the week of the year"},{name:"WEIBULL",category:"compatibility",desc:"Calculate the standard deviation based on the sample population (including numbers, text, and logical values)"},{name:"WEIBULL.DIST",category:"statistical",desc:"Returns Weibull distribution",version:"2010"},{name:"WORKDAY",category:"datetime",desc:"Returns the serial number of a date that is a specified number of working days before or after"},{name:"WORKDAY.INTL",category:"datetime",desc:"Returns a sequence number whose date is before or after a specified number of weekdays (use the parameter to specify the number of weekends and specify which days)",version:"2010"},{name:"WRAPCOLS",category:"lookup",desc:"Wraps the row or column of values ​​provided by column after the specified number of elements",version:"2024"},{name:"WRAPROWS",category:"lookup",desc:"Wraps the row or column of values ​​provided by row after the specified number of elements",version:"2024"},{name:"XIRR",category:"financial",desc:"Returns the internal rate of return for a set of cash flows that do not necessarily occur regularly"},{name:"XLOOKUP",category:"lookup",desc:"Searches a range or array and returns the item corresponding to the first match found. If no match exists, XLOOKUP returns the closest (approximate) match.",version:"2021"},{name:"XMATCH",category:"lookup",desc:"Returns the relative position of an item in an array or range of cells.",version:"2021"},{name:"XNPV",category:"financial",desc:"Returns the net present value of a set of cash flows that do not necessarily occur regularly"},{name:"XOR",category:"logical",desc:'Returns the logical "XOR" value of all arguments',version:"2013"},{name:"YEAR",category:"datetime",desc:"Convert serial number to year"},{name:"YEARFRAC",category:"datetime",desc:"Returns the fractional year representing the number of full days between start_date and end_date"},{name:"YIELD",category:"financial",desc:"Returns the yield on a bond that pays periodic interest"},{name:"YIELDDISC",category:"financial",desc:"Returns the annual return on a discounted bond; for example, a Treasury bill"},{name:"YIELDMAT",category:"financial",desc:"Returns the annual return on a bond that pays interest on the maturity date"},{name:"Z.TEST",category:"statistical",desc:"Returns the one-tailed probability value for the z-test",version:"2010"},{name:"ZTEST",category:"compatibility",desc:"Returns the one-tailed probability value for the z-test"}].forEach(t=>{const e={name:t.name,categoryKey:t.category,categoryLabelKey:m_.get(t.category)||"",desc:t.desc,version:t.version||""};g_.set(t.name,e);const n=v_.get(t.category);n&&n.push(e)});const y_=[...g_.values()];function b_(){if("undefined"==typeof localStorage)return[];try{const t=localStorage.getItem(p_),e=JSON.parse(t||"[]");return Array.isArray(e)?e:[]}catch{return[]}}const x_={getDialogCategories:()=>d_,getFormula:t=>t&&g_.get(t.toUpperCase())||null,getFormulasByCategory:t=>"recent"===t?b_().map(t=>g_.get(t)).filter(Boolean):"all"===t?y_:v_.get(t)||[],search(t,e="all"){const n=this.getFormulasByCategory(e),i=(t||"").trim().toLowerCase();return i?n.filter(t=>t.name.toLowerCase().includes(i)||(t.desc||"").toLowerCase().includes(i)):n},addRecent(t){const e=t.toUpperCase();if(!g_.has(e))return;const n=b_().filter(t=>t!==e);n.unshift(e),function(t){"undefined"!=typeof localStorage&&localStorage.setItem(p_,JSON.stringify(t.slice(0,20)))}(n)},getShortcutFormulas(t,e=12){const n=[];return(f_[t]||[]).forEach(t=>{const e=g_.get(t);e&&!n.includes(e)&&n.push(e)}),n.length<e&&("common"===t?y_:this.getFormulasByCategory(t)).forEach(t=>{n.length>=e||n.includes(t)||n.push(t)}),n.slice(0,e)}};function w_(t){t.forEach(t=>{(t.groups||[]).forEach(t=>S_(t.items||[]))})}function S_(t){t.forEach(t=>{"stack"!==t.type&&"row"!==t.type||!Array.isArray(t.items)||S_(t.items),"checkbox"!==t.type&&"labelInput"!==t.type&&(t.text||t.labelKey)&&void 0===t.minimalText&&(t.minimalText=!0)})}const C_={cn:["宋体","新宋体","仿宋","微软雅黑","楷体","黑体","等线","华文细黑","华文楷体","隶书","幼圆"],en:["Arial","Arial Black","Times New Roman","Verdana","Consolas","Georgia","Tahoma","Courier New","Calibri","Cambria","Segoe UI","Trebuchet MS","Lucida Console","Impact","Comic Sans MS"]};function T_(t){const e=e=>({text:e,style:`font-family:'${e}'`,action:`${t}.Action.areasStyle('font',{name:'${e}'})`});return[...C_.cn.map(e),{type:"divider"},...C_.en.map(e)]}function $_(t,e,n={}){const i=n.limit??12,r=n.dialogKey??e,o=x_.getShortcutFormulas(e,i).map(e=>({text:e.name,action:`${t}.Action.insertFunction('${e.name}')`})),a={labelKey:"layout.auto.label2b1c08f4",action:`${t}.Action.openFormulaDialog('${r}')`};return o.length?[...o,{type:"divider"},a]:[a]}const M_={hair:{dash:"1,2",width:1},dotted:{dash:"2,2",width:1},dashed:{dash:"4,2",width:1},dashDot:{dash:"6,2,2,2",width:1},dashDotDot:{dash:"6,2,2,2,2,2",width:1},slantDashDot:{dash:"6,2,2,2",width:1},thin:{dash:"",width:1},medium:{dash:"",width:2},mediumDashed:{dash:"6,3",width:2},mediumDashDot:{dash:"8,3,3,3",width:2},mediumDashDotDot:{dash:"8,3,3,3,3,3",width:2},thick:{dash:"",width:3},double:{dash:"",width:1,double:!0}},A_={none:{paths:[],labelKey:"action.style.border.position.none"},all:{paths:[{d:"M3 3h18v18H3z",stroke:!0},{d:"M12 3v18M3 12h18",stroke:!0}],labelKey:"action.style.border.position.all"},outer:{paths:[{d:"M3 3h18v18H3z",stroke:!0}],labelKey:"action.style.border.position.outer"},inner:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M12 3v18M3 12h18",stroke:!0}],labelKey:"action.style.border.position.inner"},left:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M3 3v18",stroke:!0}],labelKey:"action.style.border.position.left"},right:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M21 3v18",stroke:!0}],labelKey:"action.style.border.position.right"},top:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M3 3h18",stroke:!0}],labelKey:"action.style.border.position.top"},bottom:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M3 21h18",stroke:!0}],labelKey:"action.style.border.position.bottom"},diagonalDown:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M3 3l18 18",stroke:!0}],labelKey:"action.style.border.position.diagonalDown"},diagonalUp:{paths:[{d:"M3 3h18v18H3z",stroke:!0,light:!0},{d:"M3 21l18-18",stroke:!0}],labelKey:"action.style.border.position.diagonalUp"}};function N_(t,e=24){const n=A_[t];if(!n)return"";const i=n.paths.map(t=>{const e=t.light?"#ccc":"currentColor";return`<path d="${t.d}" fill="none" stroke="${e}" stroke-width="1.6"/>`}).join("");return`<svg class="sn-svg" width="${e}" height="${e}" viewBox="0 0 24 24"><path d="M3 3h18v18H3zM12 3v18M3 12h18" fill="none" stroke="#ddd" stroke-width="1"/>${i}</svg>`}const k_={"doubleWave":'<path d="M19 14.5v1c-.449 0-.66.168-1.112.793l-.015.021c-.616.851-1.033 1.186-1.872 1.186-1.07 0-1.607-.359-2.237-1.2l-.062-.083c-.424-.567-.635-.717-1.172-.717-.583 0-.852.182-1.405.826l-.018.021c-.714.832-1.185 1.153-2.105 1.153-.966 0-1.446-.374-1.995-1.23l-.053-.083c-.353-.551-.518-.687-.927-.687-.45 0-.666.17-1.127.796l-.016.021c-.625.849-1.044 1.182-1.882 1.182v-10c.421 0 .625-.162 1.076-.775l.016-.021c.635-.862 1.068-1.204 1.932-1.204.841 0 1.25.338 1.769 1.148l.053.082c.385.599.604.77 1.154.77s.805-.174 1.346-.804l.018-.021c.726-.845 1.213-1.174 2.164-1.174.922 0 1.38.324 1.973 1.118l.062.082c.46.614.738.8 1.437.8.42 0 .62-.161 1.062-.772l.015-.021c.625-.864 1.056-1.207 1.923-1.207v9zm-1 .247V7.141l-.112.152-.015.021c-.616.851-1.033 1.186-1.872 1.186-1.07 0-1.607-.359-2.237-1.2l-.062-.083c-.424-.567-.635-.717-1.172-.717-.583 0-.852.182-1.405.826l-.018.021C10.393 8.179 9.922 8.5 9.002 8.5c-.966 0-1.446-.374-1.995-1.23l-.053-.083c-.353-.551-.518-.687-.927-.687-.45 0-.666.17-1.127.796l-.016.021c-.32.435-.586.734-.882.923v7.587l.076-.102.016-.021c.635-.862 1.068-1.204 1.932-1.204.841 0 1.25.338 1.769 1.148l.053.082c.385.599.604.77 1.154.77s.805-.174 1.346-.804l.018-.021c.726-.845 1.213-1.174 2.164-1.174.922 0 1.38.324 1.973 1.118l.062.082c.46.614.738.8 1.437.8.42 0 .62-.161 1.062-.772l.015-.021c.331-.457.607-.768.923-.96z"/>',"actionButtonSound":'<path d="M3.5 8.5v5h2.638l4.361 2.617V5.883L6.137 8.5H3.499z"/><path d="m13 8 .713-.713C14.519 8.308 15 9.598 15 11s-.481 2.692-1.287 3.713L13 14c.628-.836 1-1.875 1-3s-.372-2.165-1-3M15.135 5.865l.71-.71c1.344 1.572 2.156 3.614 2.156 5.844s-.812 4.272-2.156 5.844l-.71-.71C16.299 14.744 17 12.953 17 10.998s-.701-3.745-1.865-5.135z"/>',"actionButtonBackPrevious":'<path d="M3.5 3.5h15v15h-15z"/><path d="M8.008 11 13.5 7.862v6.277z"/>',"actionButtonBeginning":'<path d="M3.5 3.5h15v15h-15z"/><path d="m9.008 11 5.492 3.138V7.861l-5.492 3.138z"/><path d="M7 7h1v8H7z"/>',"actionButtonDocument":'<path d="M5.5 4.5v13h11V7.704L13.361 4.5z"/><path d="M12 4h1v5h-1zM17 8v1h-4V8z"/>',"actionButtonEnd":'<path d="M3.5 3.5h15v15h-15z"/><path d="M12.992 11 7.5 14.138V7.861l5.492 3.138z"/><path d="M15 7h-1v8h1z"/>',"actionButtonForwardNext":'<path d="M3.5 3.5h15v15h-15z"/><path d="M13.992 11 8.5 7.862v6.277z"/>',"actionButtonHelp":'<path d="M3.5 3.5h15v15h-15z"/><path d="M11.116 7c.717 0 1.291.187 1.733.582.43.385.651.912.651 1.571 0 .538-.143.989-.408 1.341-.099.121-.408.407-.938.857a1.9 1.9 0 0 0-.453.56 1.5 1.5 0 0 0-.177.736v.187h-1.181v-.187c0-.407.066-.758.21-1.044.155-.308.574-.758 1.258-1.363l.188-.209c.199-.253.298-.516.298-.802 0-.385-.11-.681-.32-.901q-.332-.33-.927-.33c-.497 0-.861.154-1.082.462-.199.264-.298.648-.298 1.132H8.5c0-.802.232-1.429.706-1.89.464-.473 1.104-.703 1.909-.703zm-.188 6.429c.232 0 .43.066.585.22q.232.215.232.56c0 .345-.077.418-.232.571a.88.88 0 0 1-.585.22.73.73 0 0 1-.563-.231.73.73 0 0 1-.243-.56c0-.231.077-.418.243-.56.143-.154.331-.22.563-.22"/>',"actionButtonHome":'<path d="M3.5 3.5h15v15h-15z"/><path d="M15.793 11.5 11 6.707 6.207 11.5H7.5v4h2v-3h3v3h2v-4z"/>',"actionButtonInformation":'<path d="M3.5 3.5h15v15h-15z"/><path d="M12 8a1 1 0 1 0-2 0 1 1 0 0 0 2 0M10.124 14.519H9.5v.981h3v-.981h-.623V9.5H9.5v.909h.624z"/>',"actionButtonMovie":'<path d="m19.5 6.946-3 2.045v4.017l3 2.045V6.945z"/><path d="M2.5 5.5h12v11h-12z"/>',"actionButtonReturn":'<path d="M3.5 3.5h15v15h-15z"/><path d="M12.5 10H11l2.5-3 2.5 3h-1.5v2a4 4 0 0 1-8 0v-2h2v2a2 2 0 1 0 4 0z"/>',"borderCallout1":'<path d="M10 8 2 20"/><path d="M8.5 4.5h10v10h-10z"/>',"accentCallout1":'<path d="M10 8 2 20"/><path d="M10.5 4.5h8v10h-8z"/><path d="M11 4h1v1h-1zM11 14h1v1h-1zM13 4h1v1h-1zM13 14h1v1h-1zM15 4h1v1h-1zM15 14h1v1h-1zM17 4h1v1h-1zM18 5h1v1h-1zM10 5h1v1h-1zM18 7h1v1h-1zM10 7h1v1h-1zM18 9h1v1h-1zM10 9h1v1h-1zM18 11h1v1h-1zM10 11h1v1h-1zM18 13h1v1h-1zM10 13h1v1h-1zM17 14h1v1h-1z"/><path d="M8.5 4.5h1v10h-1z"/><path d="M9 4h1v11H9z"/>',"accentBorderCallout1":'<path d="M10 8 2 20"/><path d="M10.5 4.5h8v10h-8z"/><path d="M8.5 4.5h1v10h-1z"/><path d="M9 4h1v11H9z"/>',"callout1":'<path d="M10 8 2 20"/><path d="M8.5 4.5h10v10h-10z"/><path d="M9 4h1v1H9zM9 14h1v1H9zM8 5h1v1H8zM18 5h1v1h-1zM8 9h1v1H8zM18 9h1v1h-1zM8 7h1v1H8zM18 7h1v1h-1zM8 11h1v1H8zM18 11h1v1h-1zM8 13h1v1H8zM18 13h1v1h-1zM13 4h1v1h-1zM13 14h1v1h-1zM11 4h1v1h-1zM11 14h1v1h-1zM15 4h1v1h-1zM15 14h1v1h-1zM17 4h1v1h-1zM17 14h1v1h-1z"/>',"borderCallout2":'<path d="M9 9.5H6L2 20"/><path d="M8.5 4.5h10v10h-10z"/>',"accentCallout2":'<path d="M9 9.5H6L2 20"/><path d="M10.5 4.5h8v10h-8z"/><path d="M11 4h1v1h-1zM11 14h1v1h-1zM13 4h1v1h-1zM13 14h1v1h-1zM15 4h1v1h-1zM15 14h1v1h-1zM17 4h1v1h-1zM18 5h1v1h-1zM10 5h1v1h-1zM18 7h1v1h-1zM10 7h1v1h-1zM18 9h1v1h-1zM10 9h1v1h-1zM18 11h1v1h-1zM10 11h1v1h-1zM18 13h1v1h-1zM10 13h1v1h-1zM17 14h1v1h-1z"/><path d="M8.5 4.5h1v10h-1z"/><path d="M9 4h1v11H9z"/>',"accentBorderCallout2":'<path d="M9 9.5H6L2 20"/><path d="M10.5 4.5h8v10h-8z"/><path d="M8.5 4.5h1v10h-1z"/><path d="M9 4h1v11H9z"/>',"callout2":'<path d="M9 9.5H6L2 20"/><path d="M8.5 4.5h10v10h-10z"/><path d="M9 4h1v1H9zM9 14h1v1H9zM8 5h1v1H8zM18 5h1v1h-1zM8 9h1v1H8zM18 9h1v1h-1zM8 7h1v1H8zM18 7h1v1h-1zM8 11h1v1H8zM18 11h1v1h-1zM8 13h1v1H8zM18 13h1v1h-1zM13 4h1v1h-1zM13 14h1v1h-1zM11 4h1v1h-1zM11 14h1v1h-1zM15 4h1v1h-1zM15 14h1v1h-1zM17 4h1v1h-1zM17 14h1v1h-1z"/>',"borderCallout3":'<path d="M9 9.5H3.5V15l6.5 5"/><path d="M8.5 4.5h10v10h-10z"/>',"accentCallout3":'<path d="M9 9.5H3.5V15l6.5 5"/><path d="M10.5 4.5h8v10h-8z"/><path d="M11 4h1v1h-1zM11 14h1v1h-1zM13 4h1v1h-1zM13 14h1v1h-1zM15 4h1v1h-1zM15 14h1v1h-1zM17 4h1v1h-1zM18 5h1v1h-1zM10 5h1v1h-1zM18 7h1v1h-1zM10 7h1v1h-1zM18 9h1v1h-1zM10 9h1v1h-1zM18 11h1v1h-1zM10 11h1v1h-1zM18 13h1v1h-1zM10 13h1v1h-1zM17 14h1v1h-1z"/><path d="M8.5 4.5h1v10h-1z"/><path d="M9 4h1v11H9z"/>',"accentBorderCallout3":'<path d="M9 9.5H3.5V15l6.5 5"/><path d="M10.5 4.5h8v10h-8z"/><path d="M8.5 4.5h1v10h-1z"/><path d="M9 4h1v11H9z"/>',"callout3":'<path d="M9 9.5H3.5V15l6.5 5"/><path d="M8.5 4.5h10v10h-10z"/><path d="M9 4h1v1H9zM9 14h1v1H9zM8 5h1v1H8zM18 5h1v1h-1zM8 9h1v1H8zM18 9h1v1h-1zM8 7h1v1H8zM18 7h1v1h-1zM8 11h1v1H8zM18 11h1v1h-1zM8 13h1v1H8zM18 13h1v1h-1zM13 4h1v1h-1zM13 14h1v1h-1zM11 4h1v1h-1zM11 14h1v1h-1zM15 4h1v1h-1zM15 14h1v1h-1zM17 4h1v1h-1zM17 14h1v1h-1z"/>',"wedgeEllipseCallout":'<path d="m7.5 17.793 2.359-2.359.235.023q.448.043.906.043c4.162 0 7.5-2.712 7.5-6s-3.338-6-7.5-6-7.5 2.712-7.5 6c0 2.141 1.423 4.102 3.713 5.178l.287.135z"/>',"cloudCallout":'<path d="m16.559 12.903.089-.275.282-.061c1.492-.322 2.571-1.624 2.571-3.139 0-1.773-1.466-3.214-3.278-3.214q-.085 0-.169.004l-.396.02-.109-.381c-.564-1.969-2.402-3.357-4.52-3.357-2.595 0-4.694 2.065-4.694 4.607v.03l.003.437-.433.061c-1.373.193-2.403 1.352-2.403 2.722 0 1.517 1.254 2.75 2.806 2.75q.426 0 .825-.121l.364-.109.203.321a2.82 2.82 0 0 0 2.386 1.302c.709 0 1.374-.258 1.887-.715l.354-.316.334.337a2.35 2.35 0 0 0 1.675.694 2.33 2.33 0 0 0 2.226-1.597zM8 16a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM5 19a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>',"wedgeRectCallout":'<path d="M18.5 14.5v-11h-15v11h4v3.293l3.293-3.293z"/>',"wedgeRoundRectCallout":'<path d="m7.5 17.793 3.293-3.293H16a2.5 2.5 0 0 0 2.5-2.5V6A2.5 2.5 0 0 0 16 3.5H6A2.5 2.5 0 0 0 3.5 6v6A2.5 2.5 0 0 0 6 14.5h1.5z"/>',"ellipseRibbon":'<path d="M14.5 6.5H20L17.375 10 20 13.5h-5.5zM7.5 6.5H2L4.625 10 2 13.5h5.5z"/><path d="M15.091 15.879C13.904 16.603 12.488 17 11 17s-2.904-.397-4.091-1.121V9.338c1.225.647 2.629.996 4.091.996s2.866-.349 4.091-.996zm.22-7.807c-1.23.813-2.73 1.261-4.311 1.261s-3.081-.448-4.311-1.261c-.303-.2-.689.04-.689.429v7.667c0 .176.084.338.22.429 1.373.907 3.035 1.404 4.78 1.404s3.407-.497 4.78-1.404a.51.51 0 0 0 .22-.429V8.501c0-.389-.386-.629-.689-.429"/><path d="M15.091 15.879C13.904 16.603 12.488 17 11 17s-2.904-.397-4.091-1.121V9.338c1.225.647 2.629.996 4.091.996s2.866-.349 4.091-.996z"/>',"ellipseRibbon2":'<path d="M14.5 16.5H20L17.375 13 20 9.5h-5.5zM7.5 16.5H2L4.625 13 2 9.5h5.5z"/><path d="M15.091 7.121C13.904 6.397 12.488 6 11 6s-2.904.397-4.091 1.121v6.541c1.225-.647 2.629-.996 4.091-.996s2.866.349 4.091.996zm.22 7.807c-1.23-.813-2.73-1.261-4.311-1.261s-3.081.448-4.311 1.261c-.303.2-.689-.04-.689-.429V6.832c0-.176.084-.338.22-.429C7.593 5.496 9.255 4.999 11 4.999s3.407.497 4.78 1.404a.51.51 0 0 1 .22.429v7.667c0 .389-.386.629-.689.429"/><path d="M15.091 7.121C13.904 6.397 12.488 6 11 6s-2.904.397-4.091 1.121v6.541c1.225-.647 2.629-.996 4.091-.996s2.866.349 4.091.996z"/>',"ribbon":'<path d="M7.5 13.5H2L4.625 10 2 6.5h5.5zM14.5 13.5H20L17.375 10 20 6.5h-5.5z"/><path d="M7.5 16.5h7a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1h-7a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1z"/>',"irregularSeal1":'<path d="M4.621 13.5h3.943l-.479 3.992 2.143-2.382 1.597 3.332.621-3.042 3.818.855-2.552-4.213h3.266l-3.291-3.238 4.437-1.643-4.025-.745V3.303l-3.1 3.444-3.1-3.444V7.5H3.514l4.748 3.517z"/>',"irregularSeal2":'<path d="m4.118 9.5 2.776 1.388-3.551 3.068h3.809l-.482 4.488 2.302-2.697 2.2 2.208.537-3.26 1.954 2.835 1.042-3.014 2.51 1.084-.838-2.799 2.451-.687-2.867-1.939 2.947-1.253-2.887-1.748 1.843-3.2-4.388 1.691-.614-2.268-1.798 3.596L9.502 4.65v3.283L6.663 6.04l.515 3.459H4.12z"/>',"horizontalScroll":'<path d="M3 5.5A1.5 1.5 0 0 1 4.5 4H6v2h10.5A1.5 1.5 0 0 1 18 7.5v9a2.5 2.5 0 0 1-2.5 2.5H15v-1H4.5A1.5 1.5 0 0 1 3 16.5zm1 1.415V16.5a.5.5 0 0 0 .5.5H15V8h1.5a.5.5 0 0 0 0-1h-12V6h12v1h-12q-.264-.001-.5-.085m13 2a1.5 1.5 0 0 1-.5.085H16v8.915a1.5 1.5 0 0 0 1-1.415zM5 5h-.5a.5.5 0 0 0 0 1H5z"/>',"star4":'<path d="m17.87 11-5.534-1.336L11 4.13 9.664 9.664 4.13 11l5.534 1.336L11 17.87l1.336-5.534z"/>',"star5":'<path d="m15.355 16.994-1.629-5.108 4.32-3.175-5.361-.03L11 3.591l-1.685 5.09-5.361.03 4.32 3.175-1.629 5.108L11 13.867z"/>',"star8":'<path d="m13.021 5.998-2.084-2.254-2.044 2.29-3.068-.12.174 3.065-2.254 2.084 2.29 2.044-.12 3.068 3.065-.174 2.084 2.254 2.044-2.29 3.068.12-.174-3.065 2.254-2.084-2.29-2.044.12-3.068zm3.705 10.11-.519.528-.031-.55zm.402-11.344-.145 3.697 2.76 2.464-2.716 2.511.21 3.693-3.697-.145-2.464 2.76-2.511-2.716-3.693.21.145-3.697-2.76-2.464 2.716-2.511-.21-3.693 3.697.145 2.464-2.76 2.511 2.716zm-3.533.382-.395-.16.235-.013z"/><path d="M9.97 12.351q0 .501.276.777c.276.276.438.276.762.276q.486 0 .762-.276c.276-.276.276-.443.276-.777q0-.52-.281-.789c-.281-.269-.439-.269-.757-.269q-.477 0-.757.269c-.28.269-.281.442-.281.789m-1.47.089q0-.572.276-1.035c.276-.463.453-.542.807-.698q-.521-.328-.678-.709c-.157-.381-.156-.492-.156-.714q0-.74.591-1.262c.591-.522.95-.522 1.668-.522q1.077 0 1.668.522c.591.522.591.769.591 1.262q0 .333-.156.714c-.156.381-.33.475-.678.663q.532.28.799.744c.267.464.268.654.268 1.035q0 .856-.673 1.459c-.673.603-1.075.602-1.879.602q-1.206 0-1.827-.602c-.621-.602-.621-.887-.621-1.459m1.599-3.006q0 .37.241.604c.241.234.383.234.668.234q.432 0 .668-.234c.236-.234.236-.357.236-.604q0-.402-.236-.63c-.236-.228-.38-.227-.668-.227q-.427 0-.668.227c-.241.227-.241.361-.241.63"/>',"star16":'<path d="M12.315 6.092 11 3.931 9.685 6.092 7.466 4.878l-.059 2.529-2.529.059 1.214 2.219L3.931 11l2.161 1.315-1.214 2.219 2.529.059.059 2.529 2.219-1.214L11 18.069l1.315-2.161 2.219 1.214.059-2.529 2.529-.059-1.214-2.219L18.069 11l-2.161-1.315 1.214-2.219-2.529-.059-.059-2.529zM15.5 3.206l.075 3.22 3.22.075-1.545 2.826 2.751 1.674-2.751 1.674 1.545 2.826-3.22.075-.075 3.22-2.826-1.545L11 20.002l-1.674-2.751L6.5 18.796l-.075-3.22-3.22-.075 1.545-2.826-2.751-1.674L4.75 9.327 3.205 6.501l3.22-.075.075-3.22 2.826 1.545L11 2l1.674 2.751zM9.746 4.981l-.67.179.249-.409zM6.905 6.414l-.49.49.011-.479zm6.019-1.254-.67-.179.421-.23z"/><path d="M7 9.854v-.775q.54-.024.755-.072.343-.076.559-.304a1 1 0 0 0 .224-.415 1 1 0 0 0 .044-.232h.947v5.792H8.363V9.853zm4.726 2.161q0 .468.252.763c.252.295.381.296.639.296q.38 0 .597-.286c.217-.286.218-.437.218-.741q0-.507-.248-.777c-.248-.27-.368-.27-.607-.27a.8.8 0 0 0-.515.176q-.336.26-.336.839m1.602-2.501a.6.6 0 0 0-.108-.308q-.184-.272-.555-.272-.555 0-.791.623-.128.343-.176 1.015.212-.251.491-.368c.279-.117.399-.116.639-.116q.77 0 1.264.523c.494.523.493.795.493 1.338q0 .811-.483 1.43c-.483.619-.823.619-1.502.619q-1.095 0-1.614-.915-.403-.715-.403-1.846 0-.663.056-1.079.1-.74.387-1.23.247-.42.649-.675c.402-.255.588-.256.961-.256q.807 0 1.286.413c.479.413.499.642.539 1.101h-1.134z"/>',"star24":'<path d="M12.315 6.092 11 3.931 9.685 6.092 7.466 4.878l-.059 2.529-2.529.059 1.214 2.219L3.931 11l2.161 1.315-1.214 2.219 2.529.059.059 2.529 2.219-1.214L11 18.069l1.315-2.161 2.219 1.214.059-2.529 2.529-.059-1.214-2.219L18.069 11l-2.161-1.315 1.214-2.219-2.529-.059-.059-2.529zM15.5 3.206l.075 3.22 3.22.075-1.545 2.826 2.751 1.674-2.751 1.674 1.545 2.826-3.22.075-.075 3.22-2.826-1.545L11 20.002l-1.674-2.751L6.5 18.796l-.075-3.22-3.22-.075 1.545-2.826-2.751-1.674L4.75 9.327 3.205 6.501l3.22-.075.075-3.22 2.826 1.545L11 2l1.674 2.751z"/><path d="M7 14q.016-.642.276-1.174.251-.597 1.186-1.264.811-.58 1.05-.832.367-.391.367-.857 0-.38-.21-.63c-.21-.25-.34-.251-.601-.251q-.535 0-.729.399-.111.23-.132.733H7.066q.029-.762.276-1.231.47-.894 1.668-.894.947 0 1.507.525c.56.525.56.813.56 1.39q0 .663-.395 1.178-.26.342-.852.762l-.469.334q-.441.313-.603.453c-.162.14-.2.202-.274.325h2.607V14H7.002zm8.163-1.285h-.675V14h-1.149v-1.285h-2.364V11.69l2.195-3.624h1.318v3.731h.675zm-1.825-.918V9.219l-1.495 2.578z"/>',"star32":'<path d="M12.315 6.092 11 3.931 9.685 6.092 7.466 4.878l-.059 2.529-2.529.059 1.214 2.219L3.931 11l2.161 1.315-1.214 2.219 2.529.059.059 2.529 2.219-1.214L11 18.069l1.315-2.161 2.219 1.214.059-2.529 2.529-.059-1.214-2.219L18.069 11l-2.161-1.315 1.214-2.219-2.529-.059-.059-2.529zM15.5 3.206l.075 3.22 3.22.075-1.545 2.826 2.751 1.674-2.751 1.674 1.545 2.826-3.22.075-.075 3.22-2.826-1.545L11 20.002l-1.674-2.751L6.5 18.796l-.075-3.22-3.22-.075 1.545-2.826-2.751-1.674L4.75 9.327 3.205 6.501l3.22-.075.075-3.22 2.826 1.545L11 2l1.674 2.751z"/><path d="M8.125 12.067q0 .35.113.579.208.422.76.422.337 0 .589-.231c.252-.231.251-.376.251-.665q0-.574-.466-.768-.265-.108-.836-.108v-.82q.558-.008.78-.108.382-.169.382-.683 0-.333-.195-.543c-.195-.21-.313-.209-.549-.209q-.407 0-.597.257c-.19.257-.188.401-.183.687H7.105q.016-.434.149-.824.14-.342.442-.631.225-.205.534-.313c.309-.108.459-.108.76-.108q.836 0 1.348.432c.512.432.512.674.512 1.159q0 .514-.305.868a1.05 1.05 0 0 1-.402.301q.157 0 .45.269.438.406.438 1.109 0 .74-.512 1.3c-.512.56-.847.561-1.517.561q-1.238 0-1.72-.808-.254-.43-.281-1.125h1.125zm2.834 1.788q.016-.627.269-1.145.245-.582 1.157-1.234.792-.566 1.025-.812.358-.382.358-.836 0-.369-.205-.615c-.205-.246-.332-.245-.587-.245q-.522 0-.711.39-.108.225-.129.715h-1.113q.028-.744.269-1.202.458-.872 1.628-.872.924 0 1.471.512c.547.512.547.794.547 1.356q0 .646-.386 1.149-.253.333-.832.743l-.458.326q-.43.306-.589.442c-.159.136-.195.197-.267.317h2.544v1.009h-3.991z"/>',"star6":'<path d="m13.08 14.51 4.148-.007L15.16 11l2.068-3.503-4.148-.007L11 3.994 8.92 7.49l-4.148.007L6.84 11l-2.068 3.503 4.148.007L11 18.006zm4.737-8.012.588.001.298.503-.293.497-1.183-.002zm-7.41-3.501.295-.496h.597l.295.496-.593.997zM3.59 7.499l-.293-.497.298-.503.588-.001.59.999zm10.082 8.01L11 20l-2.672-4.491L3 15.5 5.656 11 3 6.5l5.328-.009L11 2l2.672 4.491L19 6.5 16.344 11 19 15.5z"/>',"star7":'<path d="M11.049 2.833 8.247 6.5h-4.47l1.615 3.546-2.616 3.296 3.675 1.816.867 4.068 3.663-1.805 3.645 1.842.906-4.059 3.693-1.778-2.579-3.317 1.588-3.61h-4.487l-2.698-3.667z"/>',"star10":'<path d="M12.69 6.054 11 3.765 9.31 6.054l-2.781-.907.047 2.796-2.811.821L5.531 11l-1.766 2.236 2.811.821-.047 2.796 2.781-.907L11 18.235l1.69-2.289 2.781.907-.047-2.796 2.811-.821L16.469 11l1.766-2.236-2.811-.821.047-2.796zm.412-1.207 3.46-1.128-.059 3.478L20 8.219 17.802 11 20 13.781l-3.497 1.022.059 3.478-3.46-1.128L11 20l-2.102-2.847-3.46 1.128.059-3.478L2 13.781 4.198 11 2 8.219l3.497-1.022-.059-3.478 3.46 1.128L11 2z"/><path d="M7 9.845v-.778q.542-.024.758-.072.345-.076.561-.305.149-.156.225-.417a1 1 0 0 0 .044-.233h.951v5.815H8.368V9.844zm4.765 1.159q0 1.002.164 1.534c.164.532.334.531.674.531q.51 0 .668-.531c.158-.531.158-.866.158-1.534q0-1.051-.158-1.556c-.158-.505-.328-.505-.668-.505q-.51 0-.674.505c-.164.505-.164.856-.164 1.556M12.604 8q1.111 0 1.558.782c.447.782.447 1.262.447 2.222q0 1.44-.447 2.218c-.447.778-.818.778-1.558.778q-1.111 0-1.558-.778c-.447-.778-.447-1.258-.447-2.218q0-1.44.447-2.222C11.493 8 11.864 8 12.604 8"/>',"star12":'<path d="M12.315 6.092 11 3.931 9.685 6.092 7.466 4.878l-.059 2.529-2.529.059 1.214 2.219L3.931 11l2.161 1.315-1.214 2.219 2.529.059.059 2.529 2.219-1.214L11 18.069l1.315-2.161 2.219 1.214.059-2.529 2.529-.059-1.214-2.219L18.069 11l-2.161-1.315 1.214-2.219-2.529-.059-.059-2.529zM15.5 3.206l.075 3.22 3.22.075-1.545 2.826 2.751 1.674-2.751 1.674 1.545 2.826-3.22.075-.075 3.22-2.826-1.545L11 20.002l-1.674-2.751L6.5 18.796l-.075-3.22-3.22-.075 1.545-2.826-2.751-1.674L4.75 9.327 3.205 6.501l3.22-.075.075-3.22 2.826 1.545L11 2l1.674 2.751z"/><path d="M7 9.882v-.799a5 5 0 0 0 .778-.074q.354-.078.577-.313.152-.16.231-.428a1 1 0 0 0 .045-.239h.976V14H8.405V9.882zM10.695 14q.016-.642.276-1.174.251-.597 1.186-1.264.811-.58 1.05-.832.367-.391.367-.857 0-.38-.21-.63c-.21-.25-.34-.251-.601-.251q-.536 0-.729.399-.111.23-.132.733h-1.141q.029-.762.276-1.231.47-.894 1.668-.894.947 0 1.507.525c.56.525.56.813.56 1.39q0 .663-.395 1.178-.26.342-.852.762l-.469.334q-.441.313-.603.453c-.162.14-.2.202-.274.325h2.607V14h-4.089z"/>',"ribbon2":'<path d="M7.5 9.5H2L4.625 13 2 16.5h5.5zM14.5 9.5H20L17.375 13 20 16.5h-5.5z"/><path d="M7.5 6.5h7a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1z"/>',"verticalScroll":'<path d="M4.5 19A1.5 1.5 0 0 1 3 17.5V16h2V5.5A1.5 1.5 0 0 1 6.5 4h9A2.5 2.5 0 0 1 18 6.5V7h-1v10.5a1.5 1.5 0 0 1-1.5 1.5zm1.415-1H15.5a.5.5 0 0 0 .5-.5V7H7V5.5a.5.5 0 0 0-1 0v12H5v-12h1v12q-.001.264-.085.5m2-13q.084.236.085.5V6h8.915A1.5 1.5 0 0 0 15.5 5zM4 17v.5a.5.5 0 0 0 1 0V17z"/>',"wave":'<path d="M18.5 5.193v10.808l-.282-.227-.132-.103a5.32 5.32 0 0 0-7.487 1.077l-.083.108a4.32 4.32 0 0 1-6.106.684l-.909-.733V5.999l.282.227q.064.052.132.103a5.32 5.32 0 0 0 7.487-1.077q.04-.056.083-.108a4.32 4.32 0 0 1 6.106-.684z"/>',"leftRightUpArrow":'<path d="M5 14.586V14h12v.586L18.586 13 17 11.414V12h-5V7h.586L11 5.414 9.414 7H10v5H5v-.586L3.414 13zM16 15H6v2l-4-4 4-4v2h3V8H7l4-4 4 4h-2v3h3V9l4 4-4 4z"/>',"quadArrow":'<path d="M17 9.414V10h-5V5h.586L11 3.414 9.414 5H10v5H5v-.586L3.414 11 5 12.586V12h5v5h-.586L11 18.586 12.586 17H12v-5h5v.586L18.586 11zM16 9V7l4 4-4 4v-2h-3v3h2l-4 4-4-4h2v-3H6v2l-4-4 4-4v2h3V6H7l4-4 4 4h-2v3z"/>',"quadArrowCallout":'<path d="m8 6 3.5-4L15 6h-2v1h2v2h1V7l4 3.5-4 3.5v-2h-1v2h-2v1h2l-3.5 4L8 15h2v-1H8v-2H7v2l-4-3.5L7 7v2h1V7h2V6zm3.5-2.481L10.204 5H11v3H9v2H6v-.796L4.519 10.5 6 11.796V11h3v2h2v3h-.796l1.296 1.481L12.796 16H12v-3h2v-2h3v.796l1.481-1.296L17 9.204V10h-3V8h-2V5h.796z"/>',"blockArc":'<path d="M18.938 14a8.001 8.001 0 0 0-15.876 0h2.021a6.001 6.001 0 0 1 11.834 0zM20 15h-4a5 5 0 0 0-10 0H2c0-4.971 4.029-9 9-9s9 4.029 9 9"/>',"cube":'<path d="m18 4.8-3 2.7v10.086l3-3zM7.414 4l-3 3h9.646l3.333-3zM19 3.9V15l-4 4H3V7l4-4h12zM4 8v10h10V8z"/>',"curvedDownArrow":'<path d="M14 12.5h-2l3.5 4.5 3.5-4.5h-2C16.592 8.554 13.802 5 10.421 5q-.212 0-.421.016A5 5 0 0 0 9.579 5C6.198 5 3.408 8.554 3 12.5h2.842C6.147 9.551 7.782 6.6 10 5.55c2.218 1.05 3.695 4.001 4 6.95z"/>',"curvedLeftArrow":'<path d="M9.5 14v-2L5 15.5 9.5 19v-2c3.946-.408 7.5-3.198 7.5-6.579q0-.212-.016-.421A5 5 0 0 0 17 9.579C17 6.198 13.446 3.408 9.5 3v2.842c2.949.305 5.9 1.94 6.95 4.158-1.05 2.218-4.001 3.695-6.95 4z"/>',"curvedRightArrow":'<path d="M12.5 14v-2l4.5 3.5-4.5 3.5v-2C8.554 16.592 5 13.802 5 10.421q0-.212.016-.421A5 5 0 0 1 5 9.579C5 6.198 8.554 3.408 12.5 3v2.842C9.551 6.147 6.6 7.782 5.55 10c1.05 2.218 4.001 3.695 6.95 4z"/>',"curvedUpArrow":'<path d="M14 9.5h-2L15.5 5 19 9.5h-2c-.408 3.946-3.198 7.5-6.579 7.5q-.212 0-.421-.016a5 5 0 0 1-.421.016C6.198 17 3.408 13.446 3 9.5h2.842c.305 2.949 1.94 5.9 4.158 6.95 2.218-1.05 3.695-4.001 4-6.95z"/>',"halfFrame":'<path d="m15.793 5.5 2-2H3.5v14.293l2-2V5.5z"/>',"line":'<path d="M4 4.673 4.673 4 18 17.327l-.673.673z"/>',"lineArrowEnd":'<path d="M16.861 16.139 19 14v5h-5l2.139-2.139L4 4.722 4.722 4z"/>',"lineArrowBoth":'<path d="m5.861 5.139 11 11L19 14v5h-5l2.139-2.139-11-11L3 8V3h5z"/>',"bentConnector3":'<path d="M10 4h1v13h7v1h-8V5H3V4z"/>',"bentConnector4":'<path d="M16 18h-6V5H3V4h8v13h5v-2l4 2.5-4 2.5z"/>',"bentConnector5":'<path d="M5 5v2L1 4.5 5 2v2h6v13h5v-2l4 2.5-4 2.5v-2h-6V5z"/>',"curvedConnector3":'<path d="M3.181 4.381 3 3.361c5.208-.885 8.594-.148 10.065 2.32.764 1.283.65 2.693-.11 4.473-.209.488-.431.939-.823 1.691-1.313 2.517-1.595 3.379-1.165 4.221.783 1.534 3.411 2.178 7.941 1.787l.093 1.032c-4.924.425-7.937-.313-8.98-2.355-.656-1.285-.33-2.279 1.17-5.155.381-.731.594-1.162.79-1.62.645-1.511.734-2.609.172-3.552-1.19-1.998-4.149-2.641-8.971-1.822z"/>',"curvedConnector4":'<path d="M17 17.959V16l4 2.5-4 2.5v-2.005c-3.747.076-6.086-.716-6.98-2.466-.656-1.285-.33-2.279 1.17-5.155.381-.731.594-1.162.79-1.62.645-1.511.734-2.609.172-3.552-1.19-1.998-4.149-2.641-8.971-1.822L3 3.36c5.208-.885 8.594-.148 10.065 2.32.764 1.283.65 2.693-.11 4.473-.209.488-.431.939-.823 1.691-1.313 2.517-1.595 3.379-1.165 4.221.666 1.305 2.666 1.965 6.034 1.893z"/>',"curvedConnector5":'<path d="M5 3.091c4.083-.387 6.792.452 8.065 2.589.764 1.283.65 2.693-.11 4.473-.209.488-.431.939-.823 1.691-1.313 2.517-1.595 3.379-1.165 4.221.666 1.305 2.666 1.965 6.034 1.893v-1.959l4 2.5-4 2.5v-2.005c-3.747.076-6.086-.716-6.98-2.466-.656-1.285-.33-2.279 1.17-5.155.381-.731.594-1.162.79-1.62.645-1.511.734-2.609.172-3.552-1.032-1.733-3.396-2.447-7.152-2.071v1.868l-4-2.5 4-2.5v2.091z"/>',"flowChartAlternateProcess":'<path d="M5.5 3.5h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-11a2 2 0 0 1 2-2z"/>',"flowChartPunchedCard":'<path d="M18.5 3.5v15h-15V9.695L9.219 3.5z"/>',"flowChartCollate":'<path d="M6.147 18h9.705l-4.853-6.232zM4 3h14l-7 8.768zm7 7.232L15.853 4H6.148zM18 19H4l7-8.768z"/>',"flowChartConnector":'<path d="M16.5 11a5.5 5.5 0 1 1-11 0 5.5 5.5 0 1 1 11 0z"/>',"flowChartInputOutput":'<path d="m9.346 3.5-5.625 15h9.932l5.625-15z"/>',"flowChartDecision":'<path d="M11 4.633 2.814 11 11 17.367 19.186 11z"/>',"flowChartDelay":'<path d="M3.5 3.5v15H11a7.5 7.5 0 0 0 0-15z"/>',"flowChartMagneticDrum":'<path d="M15.5 18.5v-15H6c-1.247 0-2.5 3.342-2.5 7.5s1.253 7.5 2.5 7.5z"/><path d="M16 18.5c-1.381 0-2.5-3.358-2.5-7.5s1.119-7.5 2.5-7.5 2.5 3.358 2.5 7.5-1.119 7.5-2.5 7.5z"/>',"flowChartDisplay":'<path d="M8.277 3.5 3.589 11l4.688 7.5H11a7.5 7.5 0 0 0 0-15z"/>',"flowChartDocument":'<path d="M18.5 16.463V3.5h-15v13.581l1.099.679a4.86 4.86 0 0 0 6.042-.749 5.86 5.86 0 0 1 7.285-.903z"/>',"flowChartExtract":'<path d="M11 4.02 2.855 18.5h16.29z"/>',"flowChartInternalStorage":'<path d="M3.5 3.5h15v15h-15z"/><path d="M6 3h1v16H6z"/><path d="M3 6h16v1H3z"/>',"flowChartMagneticDisk":'<path d="M18.5 6.5h-15V16c0 1.247 3.342 2.5 7.5 2.5s7.5-1.253 7.5-2.5z"/><path d="M18.5 6c0 1.381-3.358 2.5-7.5 2.5S3.5 7.381 3.5 6 6.858 3.5 11 3.5s7.5 1.119 7.5 2.5z"/>',"flowChartManualInput":'<path d="M3.5 9.346V18.5h15V3.722z"/>',"flowChartManualOperation":'<path d="m3.64 3.5 3.75 15h7.219l3.75-15z"/>',"flowChartMerge":'<path d="M11 17.98 2.855 3.5h16.29z"/>',"flowChartMultidocument":'<path d="M19.5 11.873V2.5h-11v9.991l.765.473a3.52 3.52 0 0 0 4.376-.542 4.52 4.52 0 0 1 5.62-.697z"/><path d="M16.5 14.873V5.5h-11v9.991l.765.473a3.52 3.52 0 0 0 4.376-.542 4.52 4.52 0 0 1 5.62-.697z"/><path d="M13.5 17.873V8.5h-11v9.991l.765.473a3.52 3.52 0 0 0 4.376-.542 4.52 4.52 0 0 1 5.62-.697z"/>',"flowChartOffpageConnector":'<path d="M15.5 4.5h-9v8.898l4.5 3.938 4.5-3.938z"/>',"flowChartOr":'<path d="M19.5 10.5a8 8 0 1 1-16 0 8 8 0 0 1 16 0z"/><path d="M11 3h1v15h-1z"/><path d="M19 10v1H4v-1z"/>',"flowChartPredefinedProcess":'<path d="M3.5 3.5h15v15h-15z"/><path d="M6 3h1v16H6zM15 3h1v16h-1z"/>',"flowChartPreparation":'<path d="M7.234 5.5 2.651 11l4.583 5.5h7.532l4.583-5.5-4.583-5.5z"/>',"flowChartProcess":'<path d="M3.5 3.5h15v15h-15z"/>',"flowChartPunchedTape":'<path d="M18.5 5.193v10.808l-.282-.227-.132-.103a5.32 5.32 0 0 0-7.487 1.077l-.083.108a4.32 4.32 0 0 1-6.106.684l-.909-.733V5.999l.282.227q.064.052.132.103a5.32 5.32 0 0 0 7.487-1.077q.04-.056.083-.108a4.32 4.32 0 0 1 6.106-.684z"/>',"flowChartMagneticTape":'<path d="M18.5 18.5v-2h-2.296l.652-.813a7.5 7.5 0 1 0-5.855 2.813h7.5z"/>',"flowChartSort":'<path d="M4.664 11 11 18.241 17.336 11 11 3.759z"/><path d="M5 10.5h12v1H5z"/>',"flowChartOnlineStorage":'<path d="M17.099 5.5H5c-.248 0-.629.483-.94 1.415C3.706 7.978 3.5 9.437 3.5 11s.206 3.021.56 4.085c.311.932.691 1.415.94 1.415h12.099c-.983-1.157-1.599-3.201-1.599-5.5s.616-4.343 1.599-5.5z"/>',"flowChartSummingJunction":'<path d="M6.197 15.803A7.5 7.5 0 1 0 16.804 5.196 7.5 7.5 0 0 0 6.197 15.803m-.707.707A8.501 8.501 0 0 1 17.511 4.489 8.501 8.501 0 0 1 5.49 16.51"/><path d="m16.45 4.843.707.707L6.55 16.157l-.707-.707z"/><path d="m17.157 15.45-.707.707L5.843 5.55l.707-.707z"/>',"flowChartTerminator":'<path d="M18 16.5c.248 0 .629-.483.94-1.415.354-1.063.56-2.522.56-4.085s-.206-3.021-.56-4.085C18.629 5.983 18.249 5.5 18 5.5H4c-.248 0-.629.483-.94 1.415C2.706 7.978 2.5 9.437 2.5 11s.206 3.021.56 4.085c.311.932.691 1.415.94 1.415z"/>',"rect":'<path d="M3.5 3.5h15v15h-15z"/>',"round1Rect":'<path d="M3.5 3.5v15h15V5.207L16.793 3.5z"/>',"round2DiagRect":'<path d="M5.207 3.5 3.5 5.207V18.5h15V5.207L16.793 3.5z"/>',"round2SameRect":'<path d="M3.5 18.5H15a3.5 3.5 0 0 0 3.5-3.5V3.5H7A3.5 3.5 0 0 0 3.5 7z"/>',"roundRect":'<path d="M5.5 3.5h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-11a2 2 0 0 1 2-2z"/>',"snip1Rect":'<path d="M3.5 3.5v15h15V9.695L12.781 3.5z"/>',"snip2DiagRect":'<path d="M3.5 3.5v10.293L8.207 18.5H18.5V8.207L13.793 3.5z"/>',"snip2SameRect":'<path d="M7.24 3.5 3.5 8.175V18.5h15V8.175L14.76 3.5z"/>',"snipRoundRect":'<path d="M5.268 3.5 3.5 6.151V18.5h15V9.181L13.766 3.5z"/>',"bentArrow":'<path d="M12.5 6.5V4l5.333 4-5.333 4V9.5H9A1.5 1.5 0 0 0 7.5 11v7.5h-3V10A3.5 3.5 0 0 1 8 6.5z"/>',"bentUpArrow":'<path d="M17.932 7.5 14 2.781 10.068 7.5H12.5v7h-9v3h12v-10z"/>',"chevron":'<path d="m6.04 6.5 3.6 4.5-3.6 4.5h5.753l4.5-4.5-4.5-4.5z"/>',"circularArrow":'<path d="M3.5 16.5h3V10a3.5 3.5 0 1 1 7 0v3.5h-2.432L15 18.219l3.932-4.719H16.5V10a6.5 6.5 0 1 0-13 0z"/>',"downArrow":'<path d="M8.5 2.5h5v10h3.398L11 19.241 5.102 12.5H8.5z"/>',"downArrowCallout":'<path d="M8.207 15.5 11 18.293l2.793-2.793H12.5v-3h6v-9h-15v9h6v3z"/>',"leftArrow":'<path d="M19.5 8.5v5h-10v3.398L2.759 11 9.5 5.102V8.5z"/>',"leftArrowCallout":'<path d="M6.5 13.793 3.707 11 6.5 8.207V9.5h3v-6h9v15h-9v-6h-3z"/>',"leftRightArrow":'<path d="M8.5 15.913 2.768 11 8.5 6.087V8.5h5V6.087L19.232 11 13.5 15.913V13.5h-5z"/>',"leftRightArrowCallout":'<path d="M5.5 13.793 2.707 11 5.5 8.207V9.5h2v-5h7v5h2V8.207L19.293 11 16.5 13.793V12.5h-2v5h-7v-5h-2z"/>',"leftUpArrow":'<path d="M16.5 16.5v-9h2.432L15 2.781 11.068 7.5H13.5v6h-6v-2.432L2.781 15 7.5 18.932V16.5z"/>',"notchedRightArrow":'<path d="M3.207 13.5H12.5v3.398L19.241 11 12.5 5.102V8.5H3.207l2.5 2.5z"/>',"homePlate":'<path d="M2.5 6.5v9h12.293l4.5-4.5-4.5-4.5z"/>',"rightArrow":'<path d="M2.5 8.5v5h10v3.398L19.241 11 12.5 5.102V8.5z"/>',"rightArrowCallout":'<path d="M15.5 13.793 18.293 11 15.5 8.207V9.5h-3v-6h-9v15h9v-6h3z"/>',"stripedRightArrow":'<path d="M6.5 8.5v5h6v3.398L19.241 11 12.5 5.102V8.5z"/><path d="M4 8h1v6H4zM2 8h1v6H2z"/>',"upArrow":'<path d="M8.5 19.5h5v-10h3.398L11 2.759 5.102 9.5H8.5z"/>',"upArrowCallout":'<path d="M8.207 6.5 11 3.707 13.793 6.5H12.5v3h6v9h-15v-9h6v-3z"/>',"upDownArrow":'<path d="M6.087 8.5 11 2.768 15.913 8.5H13.5v5h2.413L11 19.232 6.087 13.5H8.5v-5z"/>',"uturnArrow":'<path d="M3.5 18.5h3V10a3.5 3.5 0 1 1 7 0v.5h-2.432L15 15.219l3.932-4.719H16.5V10a6.5 6.5 0 1 0-13 0z"/>',"arc":'<path d="M17.5 18c0 7.456-6.044 13.5-13.5 13.5S-9.5 25.456-9.5 18-3.456 4.5 4 4.5 17.5 10.544 17.5 18z"/>',"bevel":'<path d="M3.5 3.5h15v15h-15z"/><path d="M6.5 6.5h9v9h-9zM15 7l4-4M15 15l4 4M7 15l-4 4M7 7 3 3"/>',"can":'<path d="M18.5 5.5h-15V17c0 1.247 3.342 2.5 7.5 2.5s7.5-1.253 7.5-2.5z"/><path d="M18.5 5c0 1.381-3.358 2.5-7.5 2.5S3.5 6.381 3.5 5 6.858 2.5 11 2.5s7.5 1.119 7.5 2.5z"/>',"chord":'<path d="M10.795 2.502a8.5 8.5 0 1 0 8.703 8.703l-8.702-8.702z"/>',"cloud":'<path d="m16.384 15.756.087-.275.282-.062a3.502 3.502 0 0 0-.933-6.914l-.398.02-.108-.384A5 5 0 0 0 5.501 9.5v.032l.003.436-.432.062a3 3 0 1 0 1.309 5.839l.368-.113.203.326a2.997 2.997 0 0 0 4.564.64l.357-.324.337.346a2.502 2.502 0 0 0 4.175-.988z"/>',"corner":'<path d="M19 15v4H3V3h5v11h11zm-1 0H7V4H4v14h14z"/>',"plus":'<path d="M12.5 3.5h-3v6h-6v3h6v6h3v-6h6v-3h-6z"/>',"decagon":'<path d="M8.207 2.5 2.5 8.207v5.586L8.207 19.5h5.586l5.707-5.707V8.207L13.793 2.5z"/><path d="M6.5 9.94v-.818q.57-.025.797-.076.363-.08.59-.32.156-.165.236-.439a1 1 0 0 0 .046-.245h.999v6.114H7.937V9.939H6.499zm5.01 1.218q0 1.054.173 1.613c.173.559.351.559.708.559q.536 0 .702-.559c.166-.559.167-.91.167-1.613q0-1.105-.167-1.636c-.167-.531-.345-.531-.702-.531q-.535 0-.708.531c-.173.531-.173.9-.173 1.636M12.392 8q1.168 0 1.638.822c.47.822.47 1.327.47 2.336q0 1.514-.47 2.332c-.47.818-.86.818-1.638.818q-1.168 0-1.638-.818c-.47-.818-.47-1.323-.47-2.332q0-1.514.47-2.336C11.224 8 11.614 8 12.392 8"/>',"diagStripe":'<path d="M4.5 17.793 18.793 3.5h-6.828l-7.464 7.464z"/>',"diamond":'<path d="M11 2.707 2.707 11 11 19.293 19.293 11z"/>',"dodecagon":'<path d="M8.207 2.5 2.5 8.207v5.586L8.207 19.5h5.586l5.707-5.707V8.207L13.793 2.5z"/><path d="M6.5 9.934v-.821q.572-.025.8-.076.364-.08.593-.322a1.1 1.1 0 0 0 .237-.44 1 1 0 0 0 .047-.245H9.18v6.137H7.944V9.935H6.501zm3.797 4.233q.017-.66.284-1.206.258-.614 1.219-1.299.834-.597 1.079-.855.377-.402.377-.88 0-.39-.216-.648c-.216-.258-.35-.258-.618-.258q-.55 0-.749.411-.114.237-.135.753h-1.172q.03-.783.284-1.265.483-.918 1.714-.918.973 0 1.549.54c.576.54.576.836.576 1.428q0 .681-.406 1.21-.267.351-.876.783l-.482.343q-.453.321-.62.466a1.1 1.1 0 0 0-.281.334h2.679v1.062H10.3z"/>',"donut":'<path d="M19.5 11a8.5 8.5 0 1 1-17.001-.001A8.5 8.5 0 0 1 19.5 11z"/><path d="M16.5 11a5.5 5.5 0 1 1-11 0 5.5 5.5 0 1 1 11 0z"/>',"bracePair":'<path d="M14 4h.948c.55 0 .99.195 1.306.585.289.36.44.869.44 1.499v3.043c0 .45.082.779.261 1.004.192.225.536.345 1.045.375v.989c-.509.015-.852.15-1.045.39-.179.21-.261.54-.261.989v3.058c0 .63-.151 1.124-.44 1.484-.316.39-.756.585-1.306.585H14v-.944h.77c.605 0 .907-.375.907-1.094V12.83c0-.884.371-1.499 1.127-1.829-.756-.315-1.127-.929-1.127-1.829V6.054c0-.749-.302-1.109-.907-1.109H14v-.944zM8 4h-.948c-.55 0-.99.195-1.306.585-.289.36-.44.869-.44 1.499v3.043c0 .45-.082.779-.261 1.004-.192.225-.536.345-1.045.375v.989c.509.015.852.15 1.045.39.179.21.261.54.261.989v3.058c0 .63.151 1.124.44 1.484.316.39.756.585 1.306.585H8v-.944h-.77c-.605 0-.907-.375-.907-1.094V12.83c0-.884-.371-1.499-1.127-1.829.756-.315 1.127-.929 1.127-1.829V6.054c0-.749.302-1.109.907-1.109H8v-.944z"/>',"bracketPair":'<path d="M6 4h2v1.004H6a1 1 0 0 0-1 1v9.991a1 1 0 0 0 1 1h2v1.004H6a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2zM16 4h-2v1.004h2a1 1 0 0 1 1 1v9.991a1 1 0 0 1-1 1h-2v1.004h2a2 2 0 0 0 2-2v-10a2 2 0 0 0-2-2z"/>',"foldedCorner":'<path d="M3.5 3.5h15v9.793l-5.707 5.707H3.5z"/><path d="M18.5 13.5h-5v5"/>',"frame":'<path d="M3.5 3.5h15v15h-15z"/><path d="M5.5 5.5h11v11h-11z"/>',"heart":'<path d="m11 18.279 6.503-6.749c1.33-1.38 1.33-3.624 0-5.004a3.283 3.283 0 0 0-4.77 0L11 8.324 9.267 6.526a3.283 3.283 0 0 0-4.77 0c-1.33 1.38-1.33 3.624 0 5.004z"/>',"heptagon":'<path d="M8.207 2.5 2.5 8.207v5.586L8.207 19.5h5.586l5.707-5.707V8.207L13.793 2.5z"/><path d="M14 9.085q-.312.306-.866 1.092c-.554.786-.679 1.064-.929 1.622q-.297.657-.535 1.605c-.238.948-.238 1.151-.238 1.556h-1.44q.063-1.897 1.245-3.945.763-1.269 1.279-1.77H8.999L9.018 8h4.981z"/>',"hexagon":'<path d="m19 11-4 6.928H7L3 11l4-6.928h8z"/>',"triangle":'<path d="M11 4.02 2.855 18.5h16.29z"/>',"leftBrace":'<path d="M13 4h-.948c-.55 0-.99.195-1.306.585-.289.36-.44.869-.44 1.499v3.043c0 .45-.082.779-.261 1.004-.192.225-.536.345-1.045.375v.989c.509.015.852.15 1.045.39.179.21.261.54.261.989v3.058c0 .63.151 1.124.44 1.484.316.39.756.585 1.306.585H13v-.944h-.77c-.605 0-.907-.375-.907-1.094V12.83c0-.884-.371-1.499-1.127-1.829.756-.315 1.127-.929 1.127-1.829V6.054c0-.749.302-1.109.907-1.109H13v-.944z"/>',"leftBracket":'<path d="M11 4h2v1.004h-2a1 1 0 0 0-1 1v9.991a1 1 0 0 0 1 1h2v1.004h-2a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2z"/>',"lightningBolt":'<path d="m9.088 3.521-6.021 2.23 5.974 3.372-1.775 1.753 5.296 2.615-1.736 2.571 7.645 2.059-3.52-3.477.858-1.695-4.548-2.695 1.858-2.753-4.03-3.981z"/>',"moon":'<path d="M10.152 3.672a7.5 7.5 0 1 0 7.849 11.771H18a8.5 8.5 0 0 1-7.848-11.771z"/>',"noSmoking":'<path d="m6.158 8.279 7.563 7.563-.711.279A5.501 5.501 0 0 1 5.879 8.99zm9.684 5.442L8.279 6.158l.711-.279a5.501 5.501 0 0 1 7.131 7.131zm1.168 3.289A8.501 8.501 0 0 0 4.989 4.989 8.501 8.501 0 0 0 17.01 17.01z"/>',"octagon":'<path d="M8.207 2.5 2.5 8.207v5.586L8.207 19.5h5.586l5.707-5.707V8.207L13.793 2.5z"/><path d="M9.97 12.144q0 .531.276.824c.276.293.438.293.762.293q.486 0 .762-.293c.276-.293.276-.47.276-.824q0-.55-.281-.837c-.281-.287-.439-.286-.757-.286q-.477 0-.757.286c-.28.286-.281.469-.281.837m-1.47.094q0-.606.276-1.097c.276-.491.453-.574.807-.74q-.521-.347-.678-.752c-.157-.405-.156-.522-.156-.757q0-.784.591-1.338C9.931 7 10.29 7 11.008 7q1.077 0 1.668.554c.591.554.591.815.591 1.338q0 .352-.156.757c-.156.405-.33.504-.678.703q.532.298.799.789c.267.491.268.693.268 1.097q0 .909-.673 1.547c-.673.638-1.075.638-1.879.638q-1.206 0-1.827-.638c-.621-.638-.621-.941-.621-1.547m1.599-3.187q0 .393.241.641c.241.248.383.248.668.248q.432 0 .668-.248c.236-.248.236-.379.236-.641q0-.427-.236-.668c-.236-.241-.38-.241-.668-.241q-.427 0-.668.241c-.241.241-.241.383-.241.668"/>',"ellipse":'<path d="M19.5 11a8.5 8.5 0 1 1-17.001-.001A8.5 8.5 0 0 1 19.5 11z"/>',"parallelogram":'<path d="m9.346 3.5-5.625 15h9.932l5.625-15z"/>',"pie":'<path d="M10.5 2.514a8.5 8.5 0 1 0 8.986 8.986H10.5z"/>',"plaque":'<path d="M9.481 18.5h3.038a6.5 6.5 0 0 1 5.981-5.981V9.481A6.5 6.5 0 0 1 12.519 3.5H9.481A6.5 6.5 0 0 1 3.5 9.481v3.038A6.5 6.5 0 0 1 9.481 18.5z"/>',"pentagon":'<path d="M11 3.653 3.581 9.894 6.418 18.5h9.165l2.837-8.606-7.419-6.241z"/>',"rightBrace":'<path d="M9 4h.948c.55 0 .99.195 1.306.585.289.36.44.869.44 1.499v3.043c0 .45.082.779.261 1.004.192.225.536.345 1.045.375v.989c-.509.015-.852.15-1.045.39-.179.21-.261.54-.261.989v3.058c0 .63-.151 1.124-.44 1.484-.316.39-.756.585-1.306.585H9v-.944h.77c.605 0 .907-.375.907-1.094V12.83c0-.884.371-1.499 1.127-1.829-.756-.315-1.127-.929-1.127-1.829V6.054c0-.749-.302-1.109-.907-1.109H9v-.944z"/>',"rightBracket":'<path d="M11 4H9v1.004h2a1 1 0 0 1 1 1v9.991a1 1 0 0 1-1 1H9v1.004h2a2 2 0 0 0 2-2v-10a2 2 0 0 0-2-2z"/>',"rtTriangle":'<path d="M3.5 4.207V18.5h14.293z"/>',"smileyFace":'<path d="M19.5 11a8.5 8.5 0 1 1-17.001-.001A8.5 8.5 0 0 1 19.5 11z"/><path d="M8 8a1 1 0 0 1 1 1v1a1 1 0 0 1-2 0V9a1 1 0 0 1 1-1M14 8a1 1 0 0 1 1 1v1a1 1 0 0 1-2 0V9a1 1 0 0 1 1-1M11 16q2.762 0 5-3-2.5 1.5-5 1.5c-2.5 0-3.333-.5-5-1.5q2.238 3 5 3"/>',"sun":'<path d="M15.5 11a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0z"/><path d="m11 3 1 2h-2zM16.657 5.343l-.707 2.121-1.414-1.414zM19 11l-2 1v-2zM16.657 16.657l-2.121-.707 1.414-1.414zM11 19l-1-2h2zM5.343 16.657l.707-2.121 1.414 1.414zM3 11l2-1v2zM5.343 5.343l2.121.707L6.05 7.464z"/>',"teardrop":'<path d="M19.5 2.5H11a8.5 8.5 0 1 0 8.5 8.5z"/>',"trapezoid":'<path d="m6.39 3.5-3.75 15h16.719l-3.75-15z"/>',"mathEqual":'<path d="M3.5 6.5h15v3h-15zM3.5 12.5h15v3h-15z"/>',"mathMinus":'<path d="M3.5 9.5h15v3h-15z"/>',"mathMultiply":'<path d="M6.8 4.707 4.707 6.8l4.2 4.2-4.2 4.2L6.8 17.293l4.2-4.2 4.2 4.2 2.093-2.093-4.2-4.2 4.2-4.2L15.2 4.707l-4.2 4.2z"/>',"mathNotEqual":'<path d="M3.5 6.5h15v3h-15zM3.5 12.5h15v3h-15z"/><path d="M3 17.545 17.545 3 19 4.455 4.455 19z"/>',"mathPlus":'<path d="M3.5 9.5v3h6v6h3v-6h6v-3h-6v-6h-3v6z"/>',"mathDivide":'<path d="M3.5 9.5h15v3h-15zM12.5 6a1.5 1.5 0 1 1-3.001-.001A1.5 1.5 0 0 1 12.5 6zM12.5 16a1.5 1.5 0 1 1-3.001-.001A1.5 1.5 0 0 1 12.5 16z"/>',"arbitraryShape":'<g transform="translate(-440 -342)"><path d="M443.471 360.46h15v-9.806q-.5-4.97-3.834-5.665c-1.919-.401-4.703-.401-5.473 1.855s3.946 2.812 2.199 5.673-7.01-.028-7.892-.783z" transform="matrix(-1 0 0 1 901.942 0)"/></g>',"freeCurve":'<g transform="translate(-470 -342)"><path d="M481.631 347.29c-1.317-2.251-9.462-1.714-7.253 2.87 1.14 2.368 4.721.184 7.63.695 1.95.343 4.057 1.057 4.718 3.108 1.876 5.818-13.023 9.678-12.348 3.89q.675-5.786 14.768 3.147"/></g>'},R_=[{key:"bar",labelKey:"chart.category.bar",items:[{key:"bar_clustered",labelKey:"chart.item.bar_clustered"},{key:"bar_stacked",labelKey:"chart.item.bar_stacked"},{key:"bar_percent",labelKey:"chart.item.bar_percent"}]},{key:"histogram",labelKey:"chart.category.histogram",items:[{key:"histogram_basic",labelKey:"chart.item.histogram_basic"}]},{key:"line",labelKey:"chart.category.line",items:[{key:"line_basic",labelKey:"chart.item.line_basic"},{key:"line_stacked",labelKey:"chart.item.line_stacked"},{key:"line_percent",labelKey:"chart.item.line_percent"},{key:"line_marker",labelKey:"chart.item.line_marker"},{key:"line_marker_stacked",labelKey:"chart.item.line_marker_stacked"},{key:"line_marker_percent",labelKey:"chart.item.line_marker_percent"}]},{key:"pie",labelKey:"chart.category.pie",items:[{key:"pie_basic",labelKey:"chart.item.pie_basic"},{key:"pie_doughnut",labelKey:"chart.item.pie_doughnut"}]},{key:"barh",labelKey:"chart.category.barh",items:[{key:"barh_clustered",labelKey:"chart.item.barh_clustered"},{key:"barh_stacked",labelKey:"chart.item.barh_stacked"},{key:"barh_percent",labelKey:"chart.item.barh_percent"}]},{key:"area",labelKey:"chart.category.area",items:[{key:"area_basic",labelKey:"chart.item.area_basic"},{key:"area_stacked",labelKey:"chart.item.area_stacked"},{key:"area_percent",labelKey:"chart.item.area_percent"}]},{key:"scatter",labelKey:"chart.category.scatter",items:[{key:"scatter_basic",labelKey:"chart.item.scatter_basic"},{key:"scatter_smooth_marker",labelKey:"chart.item.scatter_smooth_marker"},{key:"scatter_smooth",labelKey:"chart.item.scatter_smooth"},{key:"scatter_line_marker",labelKey:"chart.item.scatter_line_marker"},{key:"scatter_line",labelKey:"chart.item.scatter_line"},{key:"scatter_bubble",labelKey:"chart.item.scatter_bubble"}]},{key:"stock",labelKey:"chart.category.stock",items:[{key:"stock_hlc",labelKey:"chart.item.stock_hlc"},{key:"stock_ohlc",labelKey:"chart.item.stock_ohlc"},{key:"stock_vol_hlc",labelKey:"chart.item.stock_vol_hlc"},{key:"stock_vol_ohlc",labelKey:"chart.item.stock_vol_ohlc"}]},{key:"radar",labelKey:"chart.category.radar",items:[{key:"radar_basic",labelKey:"chart.item.radar_basic"},{key:"radar_marker",labelKey:"chart.item.radar_marker"},{key:"radar_filled",labelKey:"chart.item.radar_filled"}]},{key:"sunburst",labelKey:"chart.category.sunburst",items:[{key:"sunburst_basic",labelKey:"chart.item.sunburst_basic"}]},{key:"treemap",labelKey:"chart.category.treemap",items:[{key:"treemap_basic",labelKey:"chart.item.treemap_basic"}]},{key:"funnel",labelKey:"chart.category.funnel",items:[{key:"funnel_basic",labelKey:"chart.item.funnel_basic"}]},{key:"waterfall",labelKey:"chart.category.waterfall",items:[{key:"waterfall_basic",labelKey:"chart.item.waterfall_basic"}]},{key:"combo",labelKey:"chart.category.combo",items:[{key:"combo_bar_line",labelKey:"chart.item.combo_bar_line"},{key:"combo_area_bar",labelKey:"chart.item.combo_area_bar"}]}],__={chartBar:"bar",chartLine:"line",chartPie:"pie",chartArea:"area",chartScatter:"scatter",chartRadar:"radar"};function I_(t){return R_.map(e=>({...e,text:t.t(e.labelKey),items:e.items.map(e=>({...e,text:t.t(e.labelKey)}))}))}const F_="#4472C4",E_="#5B9BD5",D_="#ED7D31",L_="#A5A5A5",P_="#FFC000",z_="#70AD47",O_=114,B_=76,V_=108,H_=72,U_=t=>{const e=Math.round(10*t)/10;return Number.isInteger(e)?String(e):e.toFixed(1)},q_=t=>U_(6+t*V_),K_=t=>U_(B_-t*H_),W_='<line x1="6" y1="76" x2="114" y2="76" stroke="#c6cbd3" stroke-width="1"/><line x1="6" y1="4" x2="6" y2="76" stroke="#c6cbd3" stroke-width="1"/>',j_=t=>t.map(([t,e])=>`${U_(t)},${U_(e)}`).join(" "),G_=(t,e,n=2)=>`<polyline points="${j_(t)}" fill="none" stroke="${e}" stroke-width="${n}" stroke-linecap="round" stroke-linejoin="round"/>`,X_=(t,e,n)=>`<polygon points="${j_(t)}" fill="${e}" opacity="${n}"/>`,Y_=(t,e,n=2.4)=>t.map(([t,i])=>`<circle cx="${U_(t)}" cy="${U_(i)}" r="${n}" fill="${e}"/>`).join(""),Z_=t=>`<svg viewBox="0 0 120 80" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">${t}</svg>`,J_=[.22,.65,.45,.88,.6],Q_=[.18,.42,.3,.5,.36],tI=[.55,.72,.62,.82,.74],eI=t=>t.map((e,n)=>[6+V_*n/(t.length-1),B_-e*H_]),nI=(t,e,n)=>X_([...t,[O_,B_],[6,B_]],e,n),iI=(t,e,n,i)=>X_([...e,...t.slice().reverse()],n,i),rI=(t,e,n,i)=>{const r=V_*e,o=B_-n*H_,a=B_-o;return`<rect x="${U_(6+t*V_-r/2)}" y="${U_(o)}" width="${U_(r)}" height="${U_(a)}" fill="${i}"/>`},oI=(t,e,n,i)=>{const r=V_*e,o=6+t*V_-r/2;let a=B_;return n.map((t,e)=>{const n=t*H_,s=a-n;return a=s,`<rect x="${U_(o)}" y="${U_(s)}" width="${U_(r)}" height="${U_(n)}" fill="${i[e]}"/>`}).join("")},aI=(t,e,n,i)=>{const r=H_*e,o=n*V_;return`<rect x="6" y="${U_(4+t*H_-r/2)}" width="${U_(o)}" height="${U_(r)}" fill="${i}"/>`},sI=(t,e,n,i)=>{const r=H_*e,o=4+t*H_-r/2;let a=6;return n.map((t,e)=>{const n=t*V_,s=`<rect x="${U_(a)}" y="${U_(o)}" width="${U_(n)}" height="${U_(r)}" fill="${i[e]}"/>`;return a+=n,s}).join("")},lI=(t,e,n,i,r)=>{const o=V_*e,a=6+t*V_-o/2,s=Math.max(n,i),l=Math.min(n,i),c=B_-s*H_,h=(s-l)*H_;return`<rect x="${U_(a)}" y="${U_(c)}" width="${U_(o)}" height="${U_(h)}" fill="${r}"/>`},cI=(t,e,n,i)=>{const r=2*Math.PI*t;let o=0;return n.map((n,a)=>{const s=n*r,l=`${s.toFixed(2)} ${(r-s).toFixed(2)}`,c=`<circle cx="60" cy="40" r="${t}" fill="none" stroke="${i[a]}" stroke-width="${e}" stroke-dasharray="${l}" stroke-dashoffset="${(-o).toFixed(2)}" transform="rotate(-90 60 40)"/>`;return o+=s,c}).join("")},hI=t=>[-90,-18,54,126,198].map(t=>t*Math.PI/180).map(e=>[60+Math.cos(e)*t,40+Math.sin(e)*t]),uI=()=>`${[38,28,18].map(t=>`<polygon points="${j_(hI(t))}" fill="none" stroke="#d7dbe2" stroke-width="1"/>`).join("")}${hI(38).map(([t,e])=>`<line x1="60" y1="40" x2="${U_(t)}" y2="${U_(e)}" stroke="#d7dbe2" stroke-width="1"/>`).join("")}`,dI=(t,e)=>hI(t).map(([t,n],i)=>{const r=e[i]??1;return[60+(t-60)*r,40+(n-40)*r]});function fI(t){const e=eI(J_),n=eI(Q_);return Z_(`${W_}\n        ${G_(n,D_,2)}\n        ${G_(e,F_,2.1)}\n        ${t?`${Y_(n,D_,2.4)}${Y_(e,F_,2.6)}`:""}\n    `)}function pI(t){const e=Q_,n=J_.map((t,n)=>Math.min(.95,t+e[n])),i=eI(e),r=eI(n);return Z_(`${W_}\n        ${G_(i,F_,2)}\n        ${G_(r,D_,2)}\n        ${t?`${Y_(i,F_,2.4)}${Y_(r,D_,2.4)}`:""}\n    `)}function mI(t){const e=Q_.map(t=>Math.max(.18,Math.min(.72,t))),n=tI.map(t=>Math.max(.32,Math.min(.88,t))),i=e.map((t,e)=>{const i=.5+1.5*(t/(t+n[e])-.5);return Math.max(.18,Math.min(.82,i))}),r=eI(i),o=eI(i.map(()=>.98));return Z_(`${W_}\n        ${G_(r,F_,2)}\n        ${G_(o,D_,2)}\n        ${t?`${Y_(r,F_,2.4)}${Y_(o,D_,2.4)}`:""}\n    `)}function gI(t){const e=[[14.64,58],[34.08,31.36],[53.52,47.2],[72.96,19.839999999999996],[92.4,38.56],[105.36,27.04]],n=(t=>{if(t.length<2)return"";let e=`M ${U_(t[0][0])} ${U_(t[0][1])}`;for(let n=0;n<t.length-1;n++){const i=t[n-1]||t[n],r=t[n],o=t[n+1],a=t[n+2]||o,s=r[0]+(o[0]-i[0])/6,l=r[1]+(o[1]-i[1])/6,c=o[0]-(a[0]-r[0])/6,h=o[1]-(a[1]-r[1])/6;e+=` C ${U_(s)} ${U_(l)} ${U_(c)} ${U_(h)} ${U_(o[0])} ${U_(o[1])}`}return e})(e);return Z_(`${W_}<path d="${n}" fill="none" stroke="${F_}" stroke-width="2.1" stroke-linecap="round"/>${t?Y_(e,D_,2.6):""}`)}function vI(t){const e=eI([.25,.6,.4,.8,.55,.7]);return Z_(`${W_}${G_(e,F_,2.2)}${t?Y_(e,D_,2.6):""}`)}function yI(t){const e=[.1,.26,.42,.58,.74,.9],n=[.85,.7,.8,.65,.75,.88],i=[.35,.25,.3,.2,.28,.4],r=[.5,.45,.55,.4,.6,.55],o="#595959",a=t?.05:0,s=B_-H_*(t?.3:0)-H_*a,l=s-4,c=t=>s-t*l,h=e.map((t,e)=>{const a=6+t*V_,s=c(n[e]),l=c(i[e]),h=c(r[e]);return`<line x1="${U_(a)}" y1="${U_(s)}" x2="${U_(a)}" y2="${U_(l)}" stroke="${o}" stroke-width="1.2"/><line x1="${U_(a)}" y1="${U_(h)}" x2="${U_(a+3)}" y2="${U_(h)}" stroke="${o}" stroke-width="1.2"/>`}).join("");let u="",d="";if(t){const t=B_,n=t-(s+H_*a),i=[.6,.8,.5,.7,.55,.65],r=8.64,o=3,l=3;let c="";for(let e=0;e<=l;e++){const t=4+72*e/l;c+=`<line x1="${O_-o}" y1="${U_(t)}" x2="${O_+o}" y2="${U_(t)}" stroke="#c6cbd3" stroke-width="1"/>`}d=`<line x1="114" y1="${U_(4)}" x2="114" y2="${U_(B_)}" stroke="#c6cbd3" stroke-width="1"/>${c}`,u=i.map((i,o)=>{const a=6+e[o]*V_,s=i*n,l=t-s;return`<rect x="${U_(a-r/2)}" y="${U_(l)}" width="${U_(r)}" height="${U_(s)}" fill="${F_}"/>`}).join("")}return Z_(`${W_}${h}${d}${u}`)}function bI(t){const e=[.12,.32,.52,.72,.92],n=[.9,.75,.85,.7,.82],i=[.3,.2,.25,.15,.28],r=[.7,.5,.6,.45,.55],o=[.45,.35,.5,.55,.7],a=t?.05:0,s=B_-H_*(t?.3:0)-H_*a,l=s-4,c=t=>s-t*l,h=e.map((t,e)=>{const a=6+t*V_,s=c(n[e]),l=c(i[e]),h=c(r[e]),u=c(o[e]),d=o[e]>=r[e],f=Math.min(h,u),p=Math.abs(u-h),m=d?"#ffffff":"#595959",g="#595959";return`<line x1="${U_(a)}" y1="${U_(s)}" x2="${U_(a)}" y2="${U_(f)}" stroke="${g}" stroke-width="1"/><line x1="${U_(a)}" y1="${U_(f+p)}" x2="${U_(a)}" y2="${U_(l)}" stroke="${g}" stroke-width="1"/><rect x="${U_(a-4)}" y="${U_(f)}" width="8" height="${U_(p)}" fill="${m}" stroke="${g}" stroke-width="1"/>`}).join("");let u="",d="";if(t){const t=B_,n=t-(s+H_*a),i=[.7,.9,.5,.75,.6],r=10.8,o=3,l=3;let c="";for(let e=0;e<=l;e++){const t=4+72*e/l;c+=`<line x1="${O_-o}" y1="${U_(t)}" x2="${O_+o}" y2="${U_(t)}" stroke="#c6cbd3" stroke-width="1"/>`}d=`<line x1="114" y1="${U_(4)}" x2="114" y2="${U_(B_)}" stroke="#c6cbd3" stroke-width="1"/>${c}`,u=i.map((i,o)=>{const a=6+e[o]*V_,s=i*n,l=t-s;return`<rect x="${U_(a-r/2)}" y="${U_(l)}" width="${U_(r)}" height="${U_(s)}" fill="${F_}"/>`}).join("")}return Z_(`${W_}${h}${d}${u}`)}const xI={bar_clustered:function(){return Z_(`${W_}\n        ${rI(.1,.08,.45,F_)}\n        ${rI(.3,.08,.7,D_)}\n        ${rI(.5,.08,.35,L_)}\n        ${rI(.7,.08,.82,z_)}\n        ${rI(.9,.08,.6,P_)}\n    `)},bar_stacked:function(){return Z_(`${W_}\n        ${oI(.2,.1,[.35,.2],[F_,D_])}\n        ${oI(.5,.1,[.28,.3],[L_,P_])}\n        ${oI(.8,.1,[.22,.32],[z_,E_])}\n    `)},bar_percent:function(){return Z_(`${W_}\n        ${oI(.2,.1,[.5,.3,.2],[F_,D_,L_])}\n        ${oI(.5,.1,[.35,.4,.25],[z_,P_,E_])}\n        ${oI(.8,.1,[.4,.35,.25],[D_,F_,L_])}\n    `)},histogram_basic:function(){return Z_(`${W_}\n        ${rI(.12,.18,.4,F_)}\n        ${rI(.3,.18,.65,D_)}\n        ${rI(.48,.18,.32,L_)}\n        ${rI(.66,.18,.82,z_)}\n        ${rI(.84,.18,.55,P_)}\n    `)},barh_clustered:function(){return Z_(`${W_}\n        ${aI(.2,.12,.7,F_)}\n        ${aI(.5,.12,.85,D_)}\n        ${aI(.8,.12,.55,L_)}\n    `)},barh_stacked:function(){return Z_(`${W_}\n        ${sI(.25,.12,[.35,.25,.18],[F_,D_,L_])}\n        ${sI(.55,.12,[.25,.3,.25],[z_,P_,E_])}\n        ${sI(.85,.12,[.3,.32,.2],[D_,F_,L_])}\n    `)},barh_percent:function(){return Z_(`${W_}\n        ${sI(.25,.12,[.4,.35,.25],[F_,D_,L_])}\n        ${sI(.55,.12,[.3,.45,.25],[z_,P_,E_])}\n        ${sI(.85,.12,[.35,.4,.25],[D_,F_,L_])}\n    `)},line_basic:()=>fI(!1),line_stacked:()=>pI(!1),line_percent:()=>mI(!1),line_marker:()=>fI(!0),line_marker_stacked:()=>pI(!0),line_marker_percent:()=>mI(!0),pie_basic:function(){return Z_(`${cI(20,40,[.4,.3,.3],[F_,D_,L_])}`)},pie_doughnut:function(){const t=cI(30,18,[.45,.25,.3],[F_,D_,z_]);return Z_(`${t}<circle cx="60" cy="40" r="11" fill="#ffffff"/>`)},area_basic:function(){const t=eI(J_);return Z_(`${W_}${nI(t,F_,.25)}${G_(t,F_,2.1)}`)},area_stacked:function(){const t=Q_,e=J_.map((e,n)=>Math.min(.95,e+t[n])),n=eI(t),i=eI(e);return Z_(`${W_}\n        ${nI(n,E_,.25)}\n        ${iI(n,i,D_,.25)}\n        ${G_(n,E_,2)}\n        ${G_(i,D_,2)}\n    `)},area_percent:function(){const t=J_,e=Q_.map((e,n)=>{const i=e+t[n];return Math.max(.12,Math.min(.88,e/i))}),n=eI(e),i=eI(e.map(()=>.98));return Z_(`${W_}\n        ${nI(n,F_,.25)}\n        ${iI(n,i,D_,.25)}\n        ${G_(n,F_,2)}\n        ${G_(i,D_,2)}\n    `)},scatter_basic:function(){return Z_(`${W_}${Y_([[14.64,58],[36.24,32.800000000000004],[54.6,47.2],[70.8,18.4],[6+.78*V_,36.4],[105.36,25.6]],F_,2.8)}`)},scatter_smooth_marker:()=>gI(!0),scatter_smooth:()=>gI(!1),scatter_line_marker:()=>vI(!0),scatter_line:()=>vI(!1),scatter_bubble:function(){return Z_(`${W_}\n        <circle cx="${q_(.2)}" cy="${K_(.35)}" r="6" fill="${F_}" opacity="0.7"/>\n        <circle cx="${q_(.42)}" cy="${K_(.55)}" r="4.5" fill="${D_}" opacity="0.7"/>\n        <circle cx="${q_(.62)}" cy="${K_(.75)}" r="7" fill="${z_}" opacity="0.7"/>\n        <circle cx="${q_(.85)}" cy="${K_(.45)}" r="5.5" fill="${L_}" opacity="0.7"/>\n    `)},stock_hlc:()=>yI(!1),stock_ohlc:()=>bI(!1),stock_vol_hlc:()=>yI(!0),stock_vol_ohlc:()=>bI(!0),radar_basic:function(){const t=uI(),e=dI(32,[.92,.7,.85,.6,.78]),n=dI(32,[.75,.9,.68,.82,.65]),i=`<polygon points="${j_(e)}" fill="none" stroke="${F_}" stroke-width="2.1"/>`,r=`<polygon points="${j_(n)}" fill="none" stroke="${D_}" stroke-width="1.6" opacity="0.8"/>`;return Z_(`${t}${r}${i}`)},radar_marker:function(){const t=uI(),e=dI(32,[1,.82,.9,.68,.78]),n=dI(32,[.7,.88,.6,.8,.66]),i=`<polygon points="${j_(n)}" fill="none" stroke="${L_}" stroke-width="1.4" opacity="0.8"/>`,r=`<polygon points="${j_(e)}" fill="none" stroke="${F_}" stroke-width="2.1"/>`;return Z_(`${t}${i}${r}${Y_(e,D_,2.6)}`)},radar_filled:function(){const t=uI(),e=dI(32,[.92,.7,.82,.6,.76]),n=dI(32,[.68,.86,.7,.84,.62]),i=`<polygon points="${j_(n)}" fill="none" stroke="${D_}" stroke-width="1.6" opacity="0.8"/>`,r=`<polygon points="${j_(e)}" fill="${F_}" opacity="0.3" stroke="${F_}" stroke-width="2"/>`;return Z_(`${t}${i}${r}`)},sunburst_basic:function(){const t=cI(32,8,[.5,.25,.25],[F_,D_,L_]),e=cI(22,8,[.35,.35,.3],[z_,P_,E_]),n=cI(12,8,[.6,.4],["#7030A0",F_]);return Z_(`${t}${e}${n}`)},treemap_basic:function(){const t=V_-66.96,e=27.36,n=.55*44.64;return Z_(`\n        <rect x="${U_(6)}" y="${U_(4)}" width="${U_(66.96)}" height="${U_(44.64)}" fill="${F_}" stroke="#ffffff" stroke-width="1"/>\n        <rect x="${U_(6)}" y="${U_(48.64)}" width="${U_(38.8368)}" height="${U_(e)}" fill="${P_}" stroke="#ffffff" stroke-width="1"/>\n        <rect x="${U_(44.8368)}" y="${U_(48.64)}" width="${U_(28.123199999999997)}" height="${U_(e)}" fill="${z_}" stroke="#ffffff" stroke-width="1"/>\n        <rect x="${U_(72.96)}" y="${U_(4)}" width="${U_(t)}" height="${U_(n)}" fill="${D_}" stroke="#ffffff" stroke-width="1"/>\n        <rect x="${U_(72.96)}" y="${U_(4+n)}" width="${U_(t)}" height="${U_(20.087999999999997)}" fill="${L_}" stroke="#ffffff" stroke-width="1"/>\n        <rect x="${U_(72.96)}" y="${U_(48.64)}" width="${U_(t)}" height="${U_(e)}" fill="${E_}" stroke="#ffffff" stroke-width="1"/>\n    `)},funnel_basic:function(){const t=[{top:.94,bottom:.8,wTop:.92,wBottom:.76,color:F_},{top:.74,bottom:.6,wTop:.74,wBottom:.6,color:D_},{top:.54,bottom:.4,wTop:.56,wBottom:.44,color:L_},{top:.34,bottom:.2,wTop:.4,wBottom:.28,color:z_}].map(t=>{const e=K_(t.top),n=K_(t.bottom),i=t.wTop*V_/2,r=t.wBottom*V_/2,o=60+i,a=60-r,s=60+r;return`<polygon points="${U_(60-i)},${e} ${U_(o)},${e} ${U_(s)},${n} ${U_(a)},${n}" fill="${t.color}" stroke="#ffffff" stroke-width="1"/>`}).join("");return Z_(t)},waterfall_basic:function(){const t=[.14,.4,.66,.88],e=.12;let n=0;const i=[],r=[];[.45,-.22,.32].forEach((o,a)=>{const s=n;n=Math.max(0,Math.min(.9,n+o));const l=o>=0?z_:D_;i.push(lI(t[a],e,s,n,l));const c=K_(n),h=6+t[a]*V_+V_*e/2,u=6+t[a+1]*V_-V_*e/2;r.push(`<line x1="${U_(h)}" y1="${c}" x2="${U_(u)}" y2="${c}" stroke="#9099a8" stroke-width="1"/>`)});const o=lI(t[3],e,0,n,F_);return Z_(`${W_}${i.join("")}${r.join("")}${o}`)},combo_bar_line:()=>function(){const t=`\n        ${rI(.18,.08,.52,F_)}\n        ${rI(.38,.08,.7,F_)}\n        ${rI(.58,.08,.38,F_)}\n        ${rI(.78,.08,.78,F_)}\n    `,e=G_(eI(J_),z_,2.2);return Z_(`${W_}${t}${e}`)}(),combo_area_bar:function(){const t=`\n        ${rI(.2,.08,.48,D_)}\n        ${rI(.4,.08,.68,D_)}\n        ${rI(.6,.08,.38,D_)}\n        ${rI(.8,.08,.76,D_)}\n    `,e=nI(eI(J_),F_,.2);return Z_(`${W_}${e}${t}${G_(eI(J_),F_,2.2)}`)}};function wI(t){const e=xI[t];return e?e():""}function SI(t,e){const n={};let i=3===t.nodeType?t.parentElement:t;for(;i&&i!==e;){if("bold"in n||("B"===i.tagName||"STRONG"===i.tagName||"bold"===i.style?.fontWeight||i.style?.fontWeight>=700?n.bold=!0:"normal"===i.style?.fontWeight&&(n.bold=!1)),"italic"in n||("I"===i.tagName||"EM"===i.tagName||"italic"===i.style?.fontStyle?n.italic=!0:"normal"===i.style?.fontStyle&&(n.italic=!1)),(!("underline"in n)||!("strike"in n))&&i.style){const t=i.style.textDecoration||i.style.textDecorationLine||"";t&&("underline"in n||(n.underline=t.includes("underline")?"single":""),"strike"in n||(n.strike=t.includes("line-through")))}if("underline"in n||"U"!==i.tagName||(n.underline="single"),"strike"in n||"S"!==i.tagName&&"STRIKE"!==i.tagName&&"DEL"!==i.tagName||(n.strike=!0),i.style){if(!("size"in n)&&i.style.fontSize){const t=parseFloat(i.style.fontSize);t>0&&(n.size=Math.round(t/1.333*10)/10)}!("name"in n)&&i.style.fontFamily&&(n.name=i.style.fontFamily.replace(/['"]/g,"")),!("color"in n)&&i.style.color&&(n.color=CI(i.style.color))}i=i.parentElement}return n}function CI(t){if(!t)return"";if(t.startsWith("#"))return t;const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(e){const t=t=>parseInt(t).toString(16).padStart(2,"0");return`#${t(e[1])}${t(e[2])}${t(e[3])}`}return t}function TI(t,e){const n={};let i=!1;return t.bold&&!e.bold?(n.bold=!0,i=!0):!1===t.bold&&e.bold&&(n.bold=!1,i=!0),t.italic&&!e.italic?(n.italic=!0,i=!0):!1===t.italic&&e.italic&&(n.italic=!1,i=!0),t.strike&&!e.strike?(n.strike=!0,i=!0):!1===t.strike&&e.strike&&(n.strike=!1,i=!0),t.underline&&t.underline!==e.underline?(n.underline=t.underline,i=!0):""===t.underline&&e.underline&&(n.underline="",i=!0),t.size&&t.size!=(e.size||11)&&(n.size=t.size,i=!0),t.name&&t.name!==(e.name||"宋体")&&(n.name=t.name,i=!0),t.color&&t.color!==e.color&&(n.color=t.color,i=!0),i?n:{}}function $I(t,e,n,i,r){for(let o=t.firstChild;o;o=o.nextSibling)if(3===o.nodeType){const t=o.textContent;if(t){const r=TI(SI(o,e),n);i.push({text:t,font:r})}}else if(1===o.nodeType){const t=o.tagName;if("BR"===t){if(!o.nextSibling||1===o.nextSibling.nodeType&&"BR"===o.nextSibling.tagName&&!o.nextSibling.nextSibling){i.push({text:"\n",font:{}});break}i.push({text:"\n",font:{}})}else"DIV"===t||"P"===t?(i.length>0&&"\n"!==i[i.length-1].text&&i.push({text:"\n",font:{}}),$I(o,e,n,i)):$I(o,e,n,i)}}function MI(t,e){const n=[];if($I(t,t,e,n),!n.length)return null;const i=function(t){if(!t.length)return t;const e=[t[0]];for(let n=1;n<t.length;n++){const i=e[e.length-1],r=t[n];JSON.stringify(i.font)===JSON.stringify(r.font)?i.text+=r.text:e.push(r)}return e}(n);for(;i.length&&"\n"===i[i.length-1].text;)i.pop();return i.length?1===i.length&&0===Object.keys(i[0].font).length?null:i:null}function AI(t,e){const n=[],i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);let r;for(;r=i.nextNode();)t.intersectsNode(r)&&n.push(r);return n}function NI(t,e){const n=window.getSelection();if(!n||0===n.rangeCount)return{...e};const i=n.getRangeAt(0);if(!t.contains(i.commonAncestorContainer))return{...e};if(i.collapsed){const n=SI(i.startContainer,t);return{...e||{},...n}}const r=AI(i,t);if(!r.length)return{...e};const o=r.map(n=>{const i=SI(n,t);return{...e||{},...i}}),a={...o[0]};for(let s=1;s<o.length;s++)for(const t of Object.keys(a))a[t]!==o[s][t]&&delete a[t];return a}const kI=new Set(["bold","italic","strike","underline"]);function RI(t,e,n){if("bold"===e)t.style.fontWeight=n?"bold":"normal";else if("italic"===e)t.style.fontStyle=n?"italic":"normal";else if("underline"===e){const e=(t.style.textDecoration||"").includes("line-through"),i=[];n&&i.push("underline"),e&&i.push("line-through"),t.style.textDecoration=i.length?i.join(" "):"none"}else if("strike"===e){const e=[];(t.style.textDecoration||"").includes("underline")&&e.push("underline"),n&&e.push("line-through"),t.style.textDecoration=e.length?e.join(" "):"none"}else"size"===e?t.style.fontSize=n?1.333*n+"px":"":"name"===e?t.style.fontFamily=n||"":"color"===e&&(t.style.color=n||"")}function _I(t,e,n){const i=window.getSelection();if(!i||0===i.rangeCount)return;const r=i.getRangeAt(0);if(!t.contains(r.commonAncestorContainer))return;if(kI.has(e)&&"boolean"==typeof n){let i=r.startContainer;if(3!==i.nodeType){const e=AI(r,t);e.length&&(i=e[0])}const o=SI(i,t);n="underline"===e?o.underline?"":"single":!o[e]}if(r.collapsed){const o=document.createElement("span");RI(o,e,n);const a=3===r.startContainer.nodeType?r.startContainer.parentElement:r.startContainer;if(a&&a!==t&&a.style){const t=a.style;!o.style.fontWeight&&t.fontWeight&&(o.style.fontWeight=t.fontWeight),!o.style.fontStyle&&t.fontStyle&&(o.style.fontStyle=t.fontStyle),!o.style.fontSize&&t.fontSize&&(o.style.fontSize=t.fontSize),!o.style.fontFamily&&t.fontFamily&&(o.style.fontFamily=t.fontFamily),!o.style.color&&t.color&&(o.style.color=t.color),!o.style.textDecoration&&t.textDecoration&&(o.style.textDecoration=t.textDecoration)}o.textContent="​",r.insertNode(o);const s=document.createRange();return s.setStart(o.firstChild,1),s.collapse(!0),i.removeAllRanges(),void i.addRange(s)}const o=r.extractContents(),a=document.createElement("span");!function(t,e,n,i){const r=t.querySelectorAll("span[style]");r.length&&r.forEach(t=>RI(t,n,i));for(let o=t.firstChild;o;o=o.nextSibling)if(3===o.nodeType&&o.textContent){const e=document.createElement("span");RI(e,n,i),e.textContent=o.textContent,t.replaceChild(e,o),o=e}}(o,0,e,n),a.appendChild(o),r.insertNode(a);let s=a.parentElement;for(;s&&s!==t&&"SPAN"===s.tagName&&![...s.childNodes].some(t=>t!==a&&(1===t.nodeType||3===t.nodeType&&t.textContent));)s.parentElement.insertBefore(a,s),s.remove(),s=a.parentElement;const l=document.createRange();l.selectNodeContents(a),i.removeAllRanges(),i.addRange(l)}const II={goodBadNeutral:{labelKey:"action.style.cellStyle.group.goodBadNeutral"},dataAndModel:{labelKey:"action.style.cellStyle.group.dataAndModel"},titlesAndHeadings:{labelKey:"action.style.cellStyle.group.titlesAndHeadings"},themedCellStyles:{labelKey:"action.style.cellStyle.group.themedCellStyles"},numberFormat:{labelKey:"action.style.cellStyle.group.numberFormat"}},FI={goodBadNeutral:[{name:"good",labelKey:"action.style.cellStyle.item.good",font:{color:"#006100"},fill:{fgColor:"#C6EFCE"}},{name:"bad",labelKey:"action.style.cellStyle.item.bad",font:{color:"#9C0006"},fill:{fgColor:"#FFC7CE"}},{name:"neutral",labelKey:"action.style.cellStyle.item.neutral",font:{color:"#9C5700"},fill:{fgColor:"#FFEB9C"}}],dataAndModel:[{name:"calculation",labelKey:"action.style.cellStyle.item.calculation",font:{color:"#FA7D00",bold:!0},fill:{fgColor:"#F2F2F2"},border:{style:"thin",color:"#7F7F7F"}},{name:"checkCell",labelKey:"action.style.cellStyle.item.checkCell",font:{color:"#FFFFFF",bold:!0},fill:{fgColor:"#A5A5A5"},border:{style:"double",color:"#3F3F76"}},{name:"explanatory",labelKey:"action.style.cellStyle.item.explanatory",font:{color:"#7F7F7F",italic:!0}},{name:"input",labelKey:"action.style.cellStyle.item.input",font:{color:"#3F3F76"},fill:{fgColor:"#FFCC99"},border:{style:"thin",color:"#7F7F7F"}},{name:"linkedCell",labelKey:"action.style.cellStyle.item.linkedCell",font:{color:"#FA7D00"},border:{style:"thin",color:"#FF8001",area:"bottom"}},{name:"note",labelKey:"action.style.cellStyle.item.note",fill:{fgColor:"#FFFFCC"},border:{style:"thin",color:"#B2B2B2"}},{name:"output",labelKey:"action.style.cellStyle.item.output",font:{color:"#3F3F3F",bold:!0},fill:{fgColor:"#F2F2F2"},border:{style:"thin",color:"#3F3F3F"}},{name:"warningText",labelKey:"action.style.cellStyle.item.warningText",font:{color:"#FF0000"}}],titlesAndHeadings:[{name:"title",labelKey:"action.style.cellStyle.item.title",font:{color:"#44546A",size:18,bold:!0}},{name:"heading1",labelKey:"action.style.cellStyle.item.heading1",font:{color:"#44546A",size:15,bold:!0},border:{style:"thick",color:"#5B9BD5",area:"bottom"}},{name:"heading2",labelKey:"action.style.cellStyle.item.heading2",font:{color:"#44546A",size:13,bold:!0},border:{style:"thick",color:"#5B9BD5",area:"bottom"}},{name:"heading3",labelKey:"action.style.cellStyle.item.heading3",font:{color:"#44546A",bold:!0},border:{style:"medium",color:"#5B9BD5",area:"bottom"}},{name:"heading4",labelKey:"action.style.cellStyle.item.heading4",font:{color:"#44546A",bold:!0}},{name:"total",labelKey:"action.style.cellStyle.item.total",font:{bold:!0},border:{style:"thin",color:"#5B9BD5",area:"top"},border2:{style:"double",color:"#5B9BD5",area:"bottom"}}],themedCellStyles:function(){const t=[{name:"accent1",colors:["#DCE6F1","#B8CCE4","#4F81BD"]},{name:"accent2",colors:["#FDE9D9","#FCD5B4","#F79646"]},{name:"accent3",colors:["#D9D9D9","#BFBFBF","#808080"]},{name:"accent4",colors:["#FFF2CC","#FFE599","#FFCC00"]},{name:"accent5",colors:["#DAEEF3","#B7DEE8","#4BACC6"]},{name:"accent6",colors:["#EBF1DE","#D8E4BC","#9BBB59"]}],e=["20%","40%","60%"],n=["20","40","60"],i=[];for(let r=0;r<3;r++)for(const o of t)i.push({name:`${o.name}_${e[r]}`,labelKey:`action.style.cellStyle.item.${o.name}_${n[r]}`,font:2===r?{color:"#FFFFFF"}:null,fill:{fgColor:o.colors[r]}});return i}(),numberFormat:[{name:"comma",labelKey:"action.style.cellStyle.item.comma",numFmt:"#,##0.00"},{name:"commaNoDecimal",labelKey:"action.style.cellStyle.item.commaNoDecimal",numFmt:"#,##0"},{name:"currency",labelKey:"action.style.cellStyle.item.currency",numFmt:"¥#,##0.00"},{name:"currencyNoDecimal",labelKey:"action.style.cellStyle.item.currencyNoDecimal",numFmt:"¥#,##0"},{name:"percent",labelKey:"action.style.cellStyle.item.percent",numFmt:"0%"}]};function EI(t,e){const{s:n,e:i}=t,r=0===n.c&&i.c===e.colCount-1,o=0===n.r&&i.r===e.rowCount-1,a=[],s=[];if(r)for(let l=n.r;l<=i.r;l++)a.push(l);if(o)for(let l=n.c;l<=i.c;l++)s.push(l);return{isFullRow:r,isFullCol:o,rows:a,cols:s}}const DI={font:"#FF0000",fill:"#FFFF00",border:"all",borderStyle:"thin"};function LI(t){return t?.containerDom?.querySelector(".sn-tools")||null}function PI(t,e,n){const i=t?.containerDom?.querySelector(`.sn-split-btn[data-color-type="${e}"]`);i&&(n?i.removeAttribute("data-color-empty"):i.setAttribute("data-color-empty","true"))}function zI(t){if(!t)return;t.toolbarDefaults?Object.keys(DI).forEach(e=>{void 0===t.toolbarDefaults[e]&&(t.toolbarDefaults[e]=DI[e])}):t.toolbarDefaults={...DI};const e=LI(t);e&&(e.style.setProperty("--sn-font-color",t.toolbarDefaults.font||"transparent"),e.style.setProperty("--sn-fill-color",t.toolbarDefaults.fill||"transparent")),PI(t,"font",t.toolbarDefaults.font),PI(t,"fill",t.toolbarDefaults.fill)}function OI(t,e,n){zI(t),t.toolbarDefaults[e]=n||"";const i=LI(t);if(i){const t="font"===e?"--sn-font-color":"--sn-fill-color";i.style.setProperty(t,n||"transparent")}PI(t,e,n)}function BI(t,e){return zI(t),t.toolbarDefaults[e]}function VI(t,e){!function(t,e,n){const i=function(t){return t?.containerDom?.querySelector('.sn-split-btn[data-tool="border"] .sn-svg')||null}(t);i&&(i.outerHTML=n)}(t,0,N_(e||"all",16))}const HI={none:{area:"none",style:null},all:{area:"all"},outer:{area:"out"},inner:{area:"inner"},left:{area:"left"},top:{area:"top"},right:{area:"right"},bottom:{area:"bottom"},diagonalDown:{area:"diagonalDown"},diagonalUp:{area:"diagonalUp"}};function UI(t,e){if("font"===t&&this.SN.Canvas?.inputEditing){const t=this.SN.Canvas;if(!this.SN.activeSheet.getCell(t.currentCell.r,t.currentCell.c).isFormula){for(const[n,i]of Object.entries(e))_I(t.input,n,i);return void(t.formulaBar.value=t.input.innerText)}}const n=this.SN.activeSheet,i=n.activeAreas,r=new Set,o=new Set;i.forEach(t=>{"string"==typeof t&&(t=n.rangeStrToNum(t));const{isFullRow:e,isFullCol:i,rows:a,cols:s}=EI(t,n);e&&!i?a.forEach(t=>r.add(t)):i&&!e&&s.forEach(t=>o.add(t))}),r.forEach(i=>{n.getRow(i)[t]=e}),o.forEach(i=>{n.getCol(i)[t]=e}),n.eachCells(i,(i,r,o)=>{const{isFullRow:a,isFullCol:s}=EI({s:o.s,e:o.e},n);a&&!s||s&&!a||(n.getCell(i,r)[t]=e)}),this.SN.ue()}const qI=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],KI={none:0,ccw45:45,cw45:135,vertical:255,up90:90,down90:180},WI=new Map,jI="#63BE7B",GI="#DBAF00",XI="#F8696B",YI="#808080",ZI="#404040";function JI(t,e=16){const n=`${t}-${e}`;if(WI.has(n))return WI.get(n);const i=document.createElement("canvas");return i.width=e,i.height=e,function(t,e,n){t.save(),e.startsWith("arrow")?function(t,e,n){const i=n/2,r=n/2,o=.35*n;let a,s;e.includes("Gray")?(a=YI,s="#555"):e.includes("Tilt")?(a=GI,s="#a08000"):e.includes("Up")?(a=jI,s="#3d8b4f"):e.includes("Down")?(a=XI,s="#c44"):(a=GI,s="#a08000"),t.fillStyle=a,t.strokeStyle=s,t.lineWidth=.5,t.beginPath(),e.includes("Up")&&!e.includes("Tilt")?(t.moveTo(i,r-o),t.lineTo(i+o,r+.5*o),t.lineTo(i+.3*o,r+.5*o),t.lineTo(i+.3*o,r+o),t.lineTo(i-.3*o,r+o),t.lineTo(i-.3*o,r+.5*o),t.lineTo(i-o,r+.5*o)):e.includes("Down")&&!e.includes("Tilt")?(t.moveTo(i,r+o),t.lineTo(i+o,r-.5*o),t.lineTo(i+.3*o,r-.5*o),t.lineTo(i+.3*o,r-o),t.lineTo(i-.3*o,r-o),t.lineTo(i-.3*o,r-.5*o),t.lineTo(i-o,r-.5*o)):e.includes("TiltUp")?(t.save(),t.translate(i,r),t.rotate(Math.PI/4),t.translate(-i,-r),t.moveTo(i,r-o),t.lineTo(i+o,r+.5*o),t.lineTo(i+.3*o,r+.5*o),t.lineTo(i+.3*o,r+o),t.lineTo(i-.3*o,r+o),t.lineTo(i-.3*o,r+.5*o),t.lineTo(i-o,r+.5*o),t.restore()):e.includes("TiltDown")?(t.save(),t.translate(i,r),t.rotate(-Math.PI/4),t.translate(-i,-r),t.moveTo(i,r+o),t.lineTo(i+o,r-.5*o),t.lineTo(i+.3*o,r-.5*o),t.lineTo(i+.3*o,r-o),t.lineTo(i-.3*o,r-o),t.lineTo(i-.3*o,r-.5*o),t.lineTo(i-o,r-.5*o),t.restore()):e.includes("Side")&&(t.moveTo(i+o,r),t.lineTo(i-.5*o,r-o),t.lineTo(i-.5*o,r-.3*o),t.lineTo(i-o,r-.3*o),t.lineTo(i-o,r+.3*o),t.lineTo(i-.5*o,r+.3*o),t.lineTo(i-.5*o,r+o)),t.closePath(),t.fill(),t.stroke()}(t,e,n):e.startsWith("light")?function(t,e,n){const i=n/2,r=n/2,o=.35*n;let a;if(a=e.includes("Green")?jI:e.includes("Yellow")?GI:e.includes("Red")?XI:ZI,e.includes("2")){const e=.8*n,s=(n-e)/2,l=(n-e)/2,c=.15*n;t.fillStyle="#404040",t.beginPath(),t.roundRect(s,l,e,e,c),t.fill(),t.fillStyle=a,t.beginPath(),t.arc(i,r,.85*o,0,2*Math.PI),t.fill()}else t.fillStyle=a,t.beginPath(),t.arc(i,r,o,0,2*Math.PI),t.fill()}(t,e,n):e.startsWith("flag")?function(t,e,n){const i=.25*n,r=.15*n,o=.5*n,a=.4*n;let s;s=e.includes("Green")?jI:e.includes("Yellow")?GI:XI,t.fillStyle="#666",t.fillRect(i-1,r,2,.7*n),t.fillStyle=s,t.beginPath(),t.moveTo(i,r),t.lineTo(i+o,r+.5*a),t.lineTo(i,r+a),t.closePath(),t.fill()}(t,e,n):e.startsWith("sign")?function(t,e,n){const i=n/2,r=n/2,o=.35*n;let a;if(a=e.includes("Green")?jI:e.includes("Yellow")?GI:XI,t.fillStyle=a,t.beginPath(),e.includes("Red")){const e=.4*n;t.moveTo(i,r-e),t.lineTo(i+e,r),t.lineTo(i,r+e),t.lineTo(i-e,r)}else e.includes("Yellow")?(t.moveTo(i,r-o),t.lineTo(i+o,r+.7*o),t.lineTo(i-o,r+.7*o)):t.arc(i,r,o,0,2*Math.PI);t.closePath(),t.fill()}(t,e,n):e.startsWith("symbol")?function(t,e,n){const i=n/2,r=n/2,o=e.includes("2"),a=o?.45*n:.35*n+2;e.includes("Check")?(o?(t.strokeStyle=jI,t.lineWidth=2):(t.fillStyle=jI,t.beginPath(),t.arc(i,r,a,0,2*Math.PI),t.fill(),t.strokeStyle="#fff",t.lineWidth=1.5),t.beginPath(),t.moveTo(i-.5*a,r),t.lineTo(i-.15*a,r+.45*a),t.lineTo(i+.5*a,r-.35*a),t.stroke()):e.includes("Exclaim")?o?(t.strokeStyle=GI,t.lineCap="round",t.lineWidth=2.5,t.beginPath(),t.moveTo(i,r-.6*a),t.lineTo(i,r+.1*a),t.stroke(),t.fillStyle=GI,t.beginPath(),t.arc(i,r+.5*a,2,0,2*Math.PI),t.fill()):(t.fillStyle=GI,t.beginPath(),t.arc(i,r,a,0,2*Math.PI),t.fill(),t.fillStyle="#fff",t.beginPath(),t.roundRect(i-1.5,r-.6*a,3,.55*a,1),t.fill(),t.beginPath(),t.arc(i,r+.45*a,2,0,2*Math.PI),t.fill()):e.includes("X")&&(o?(t.strokeStyle=XI,t.lineWidth=2):(t.fillStyle=XI,t.beginPath(),t.arc(i,r,a,0,2*Math.PI),t.fill(),t.strokeStyle="#fff",t.lineWidth=1.5),t.beginPath(),t.moveTo(i-.4*a,r-.4*a),t.lineTo(i+.4*a,r+.4*a),t.moveTo(i+.4*a,r-.4*a),t.lineTo(i-.4*a,r+.4*a),t.stroke())}(t,e,n):e.startsWith("star")?function(t,e,n){const i=n/2,r=n/2,o=.4*n,a=.2*n;t.fillStyle="#FFD700",t.strokeStyle="#B8860B",t.lineWidth=1,t.beginPath();for(let s=0;s<5;s++){const e=2*s*Math.PI/5-Math.PI/2,n=e+Math.PI/5,l=i+o*Math.cos(e),c=r+o*Math.sin(e),h=i+a*Math.cos(n),u=r+a*Math.sin(n);0===s?t.moveTo(l,c):t.lineTo(l,c),t.lineTo(h,u)}t.closePath(),e.includes("Full")?(t.fill(),t.stroke()):e.includes("Half")?(t.stroke(),t.save(),t.clip(),t.fillRect(0,0,i,n),t.restore()):t.stroke()}(t,e,n):e.startsWith("triangle")?function(t,e,n){const i=n/2,r=n/2,o=.35*n;e.includes("Up")?(t.fillStyle=jI,t.beginPath(),t.moveTo(i,r-o),t.lineTo(i+o,r+.7*o),t.lineTo(i-o,r+.7*o),t.closePath(),t.fill()):e.includes("Down")?(t.fillStyle=XI,t.beginPath(),t.moveTo(i,r+o),t.lineTo(i+o,r-.7*o),t.lineTo(i-o,r-.7*o),t.closePath(),t.fill()):(t.fillStyle=GI,t.fillRect(i-o,r-2,2*o,4))}(t,e,n):e.startsWith("rating")?function(t,e,n){const i=parseInt(e.replace("rating",""))||0,r=i<=4?4:5,o=n*(5===r?.12:.15),a=.04*n,s=(n-(r*o+(r-1)*a))/2;for(let l=0;l<r;l++){const e=s+l*(o+a),r=n*(.25+.12*l),c=n-r-.1*n;t.fillStyle=l<i?"#4472C4":"#ddd",t.fillRect(e,c,o,r)}}(t,e,n):e.startsWith("circle")?function(t,e,n){const i=n/2,r=n/2,o=.35*n;let a;a=e.includes("Red")?XI:e.includes("Pink")?"#FFB6C1":e.includes("Gray")?YI:ZI,t.fillStyle=a,t.beginPath(),t.arc(i,r,o,0,2*Math.PI),t.fill()}(t,e,n):e.startsWith("quarter")?function(t,e,n){const i=n/2,r=n/2,o=.35*n,a=parseInt(e.replace("quarter",""))||0;t.fillStyle="#ddd",t.beginPath(),t.arc(i,r,o,0,2*Math.PI),t.fill(),a>0&&(t.fillStyle="#333",t.beginPath(),t.moveTo(i,r),t.arc(i,r,o,-Math.PI/2,-Math.PI/2+a/4*Math.PI*2),t.closePath(),t.fill()),t.strokeStyle="#666",t.lineWidth=1,t.beginPath(),t.arc(i,r,o,0,2*Math.PI),t.stroke()}(t,e,n):e.startsWith("box")&&function(t,e,n){const i=parseInt(e.replace("box",""))||0,r=.32*n,o=.06*n,a=2*r+o,s=(n-a)/2,l=(n-a)/2,c=[[0,0],[1,0],[0,1],[1,1]];for(let h=0;h<4;h++){const[e,n]=c[h],a=s+e*(r+o),u=l+n*(r+o);t.fillStyle=h<i?"#4472C4":"#ddd",t.fillRect(a,u,r,r),t.strokeStyle="#999",t.lineWidth=.5,t.strokeRect(a,u,r,r)}}(t,e,n),t.restore()}(i.getContext("2d"),t,e),WI.set(n,i),i}class QI{constructor(t,e=null,n=null){this.ns=t,this.SN=e,this.config=function(t){const e=[{key:"file",labelKey:"layout.auto.labelB7394238",groups:[{items:[{type:"large",icon:"daoru",labelKey:"layout.file.import",action:`${t}.containerDom.querySelector('.sn-upload').click()`},{type:"stack",items:[{icon:"jurassic_addForm",labelKey:"layout.file.newWorkbook",action:`${t}.Action.confirmNewWorkbook()`},{icon:"url",labelKey:"layout.file.importFromUrl",action:`${t}.Action.importFromUrl()`}]}]},{items:[{type:"large",icon:"daochu",labelKey:"layout.file.exportXlsx",action:`${t}.IO.export()`},{type:"stack",items:[{icon:"csv",labelKey:"layout.file.exportCsv",action:`${t}.IO.export('CSV')`},{icon:"json",labelKey:"layout.file.exportJson",action:`${t}.IO.export('JSON')`,titleKey:"layout.file.exportJsonTitle"}]},{type:"stack",items:[{icon:"html",labelKey:"layout.file.exportHtml",action:`${t}.IO.export('HTML')`,titleKey:"layout.file.exportHtmlTitle"},{icon:"tp",labelKey:"layout.file.exportImage",action:`${t}.IO.exportAllImage()`}]},{type:"stack",items:[{icon:"pdf",labelKey:"layout.file.exportPdf",action:`${t}.Action.exportPdf()`}]}]},{items:[{type:"stack",items:[{icon:"baocun",labelKey:"layout.file.browserSave",action:`${t}.Action.saveToLocal()`},{icon:"huifu",labelKey:"layout.file.browserRestore",action:`${t}.Action.loadFromLocal()`}]}]},{items:[{type:"large",icon:"dayinyulan",labelKey:"layout.file.printPreview",action:`${t}.Action.printPreview()`},{type:"stack",items:[{type:"checkbox",labelKey:"layout.file.readOnlyAfterExport",id:"readOnly",checked:t=>t.readOnly,action:`${t}.readOnly=this.checked`},{icon:"shuxing",labelKey:"layout.file.properties",action:`${t}.Action.showProperties()`}]}]}]},{key:"start",labelKey:"layout.auto.label396990f1",groups:[{items:[{type:"large",icon:"geshihua",labelKey:"layout.auto.labelE3362dac",id:"formatBrush",action:`${t}.activeSheet.setBrush()`,dblAction:`${t}.activeSheet.setBrush(true)`,active:t=>!!t.activeSheet?.mo?.area,titleKey:"layout.auto.title57c65c9c"},{type:"large",icon:"niantie",labelKey:"layout.auto.label3d33e8d4",menu:"paste"},{type:"stack",items:[{icon:"chexiao",titleKey:"layout.auto.title1c9e8d5c",action:`${t}.UndoRedo.undo()`},{icon:"fuzhi",titleKey:"layout.auto.titleF9d572aa",action:`${t}.Action.copy()`}]},{type:"stack",items:[{icon:"chongzuo",titleKey:"layout.auto.titleC3cf1168",action:`${t}.UndoRedo.redo()`},{icon:"jianqie",titleKey:"layout.auto.title46adc7a1",action:`${t}.Action.cut()`}]}]},{items:[{type:"row",items:[{type:"dropdown",labelKey:"layout.auto.label9d40cd00",width:"123px",id:"fontName",menu:"fontName"},{type:"dropdown",labelKey:"layout.auto.label1ceb2bd8",width:"35px",id:"fontSize",menu:"fontSize"},{icon:"zengjiazihao",action:`${t}.Action.changeFontSize(true)`,titleKey:"layout.auto.titleF2e72f6d"},{icon:"jszh",action:`${t}.Action.changeFontSize(false)`,titleKey:"layout.auto.title1a808f64"}]},{type:"row",items:[{icon:"bold",action:`${t}.Action.fontInversion('bold')`,titleKey:"layout.auto.titleE3aeedb4"},{icon:"italic",action:`${t}.Action.fontInversion('italic')`,titleKey:"layout.auto.title27c68cf4"},{icon:"underline",action:`${t}.Action.fontInversion('underline','single')`,titleKey:"layout.auto.title7bd6a6c3"},{icon:"strikethrough",action:`${t}.Action.fontInversion('strike')`,titleKey:"layout.auto.titleFd05e5a8"},{type:"splitDropdown",icon:"jurassic_borderAll",titleKey:"layout.auto.title20d59678",action:`${t}.Action.applyBorderPreset()`,menu:"border",menuWidth:"180px"},{type:"splitColorPicker",icon:"fontColor",titleKey:"layout.auto.titleFf0455e0",colorType:"font"},{type:"splitColorPicker",icon:"styleFill",titleKey:"layout.auto.titleB46e89c8",colorType:"fill"},{type:"dropdown",icon:"qingchugeshi1",action:`${t}.Action.clearAreaFormat()`,menu:"clear",titleKey:"layout.auto.titleAb4a78ac"}]}]},{items:[{type:"row",items:[{icon:"alignTop",titleKey:"layout.auto.title2d6a5a8c",action:`${t}.Action.areasStyle('alignment',{vertical:'top'})`},{icon:"alignVertically",titleKey:"layout.auto.titleF2b067c8",action:`${t}.Action.areasStyle('alignment',{vertical:'center'})`},{icon:"alignBottom",titleKey:"layout.auto.title09162f60",action:`${t}.Action.areasStyle('alignment',{vertical:'bottom'})`},{icon:"textWrap",titleKey:"layout.auto.title4fcc8180",action:`${t}.Action.toggleWrapText()`},{type:"dropdown",icon:"ic_zitifangxiang",titleKey:"layout.auto.titleFaa5e594",menu:"textRotation"}]},{type:"row",items:[{icon:"alignLeft",titleKey:"layout.auto.title2f9e586c",action:`${t}.Action.areasStyle('alignment',{horizontal:'left'})`},{icon:"alignCenter",titleKey:"layout.auto.title2724f9ac",action:`${t}.Action.areasStyle('alignment',{horizontal:'center'})`},{icon:"alignRight",titleKey:"layout.auto.title09f772c4",action:`${t}.Action.areasStyle('alignment',{horizontal:'right'})`},{icon:"indentIncrease",titleKey:"layout.auto.title99310054",action:`${t}.Action.changeIndent(1)`},{icon:"indentDecrease",titleKey:"layout.auto.title1cabceb8",action:`${t}.Action.changeIndent(-1)`}]},{type:"large",icon:"hebing",labelKey:"layout.auto.labelC602cd4a",hasArrow:!0,menu:"merge"}]},{items:[{type:"row",items:[{type:"dropdown",labelKey:"layout.auto.label046ee664",width:"60px",menu:"numFmt",menuWidth:"200px"},{type:"dropdown",icon:"zhuanhuan",labelKey:"layout.auto.labelF328662a",menu:"convert"}]},{type:"row",items:[{type:"splitDropdown",icon:"licai",titleKey:"layout.auto.title05adf36c",action:`${t}.Action.areasNumFmt('¥#,##0.00')`,menu:"currency"},{icon:"_15xiankuantubiaoheji_115",titleKey:"layout.auto.title047aaa30",action:`${t}.Action.areasNumFmt('0.00%')`},{icon:"yunfengdie_tongjishuzhiqianfenwei",titleKey:"layout.auto.titleD8b83d9c",action:`${t}.Action.areasNumFmt('#,##0.00')`},{icon:"_16Gongjutubiao2Jianshaoxiaoshuweishu",titleKey:"layout.auto.title67656060",action:`${t}.Action.decimalPlaces('cut')`},{icon:"_16Gongjutubiao2Zengjiaxiaoshuweishu",titleKey:"layout.auto.titleA8781ce4",action:`${t}.Action.decimalPlaces('add')`}]}]},{items:[{type:"stack",items:[{type:"dropdown",icon:"hanglie",labelKey:"layout.auto.labelEfe10954",menu:"rowCol"},{type:"dropdown",icon:"quanxianpeizhi",labelKey:"layout.auto.label1a7e1503",id:"sheetProtection",menu:"protection",active:t=>t.activeSheet?.protection?.enabled}]}]},{items:[{type:"large",minimalText:!1,icon:"tiaojiangeshi",labelKey:"layout.auto.labelB2fe241c",hasArrow:!0,menu:"condFormat",menuWidth:"160px"},{type:"stack",items:[{type:"dropdown",minimalText:!1,icon:"biaogeyangshi",labelKey:"layout.auto.label727a825c",menu:"formatAsTable",menuWidth:"340px"},{type:"dropdown",minimalText:!1,icon:"danyuangeyangshi",labelKey:"layout.auto.labelD006b2ec",menu:"cellStyles",menuWidth:"420px"}]}]},{items:[{type:"large",icon:"paixu",labelKey:"layout.auto.label328b35a0",menu:"sort"},{type:"large",icon:"shaixuan",labelKey:"layout.auto.labelF3e084a4",menu:"filter"},{type:"large",icon:"dongjie",labelKey:"layout.auto.label2bb8d6d0",menu:"freeze"},{type:"large",icon:"qiuhe",labelKey:"layout.auto.label304be598",hasArrow:!0,menu:"autoSum"},{type:"large",icon:"chazhao",labelKey:"layout.auto.label36263538",menu:"find"}]}]},{key:"insert",labelKey:"layout.auto.label47acfc84",groups:[{items:[{type:"large",icon:"shengchengshujutoushibiao",labelKey:"layout.auto.labelA05734b8",action:`${t}.Action.createPivotTable()`},{type:"large",icon:"biaoge",labelKey:"layout.auto.label3dbdf26c",action:`${t}.Action.createTable()`}]},{items:[{type:"large",icon:"tupian",labelKey:"layout.auto.labelCba453e4",action:`${t}.Action.insertImages()`},{type:"large",icon:"jietu",labelKey:"layout.auto.label2d0ee700",action:`${t}.Action.insertAreaScreenshot()`},{type:"large",icon:"xingzhuang",labelKey:"layout.auto.label6561bb16",hasArrow:!0,menu:"shapes",menuWidth:"310px"}]},{items:[{type:"large",icon:"component",labelKey:"layout.auto.labelC6887918",disabled:!0}]},{items:[{type:"large",icon:"tubiao",labelKey:"toolbar.insert.chart",action:`${t}.Action.openChartModal()`},{type:"row",items:[{type:"dropdown",icon:"tubiaoZhuzhuangtu",titleKey:"chart.category.bar",menu:"chartBar"},{type:"dropdown",icon:"zhexiantu",titleKey:"chart.category.line",menu:"chartLine"},{type:"dropdown",icon:"bingtu",titleKey:"chart.category.pie",menu:"chartPie"}]},{type:"row",items:[{type:"dropdown",icon:"mianjitu",titleKey:"chart.category.area",menu:"chartArea"},{type:"dropdown",icon:"sandiantu",titleKey:"chart.category.scatter",menu:"chartScatter"},{type:"dropdown",icon:"leidatu",titleKey:"chart.category.radar",menu:"chartRadar"}]}]},{items:[{type:"large",icon:"minitu",labelKey:"layout.auto.label92d86c42",menu:"sparkline"}]},{items:[{type:"large",icon:"chaolianjie",labelKey:"layout.auto.label72788608",action:`${t}.Action.insertHyperlink()`},{type:"large",icon:"charugongshi",labelKey:"layout.auto.label92ff62e4",action:`${t}.Action.openFormulaDialog('all')`}]},{items:[{type:"large",icon:"_24_nor",labelKey:"layout.auto.labelD6d89414",action:`${t}.Action.insertComment()`}]},{items:[{type:"large",icon:"wenbenkuang",labelKey:"layout.auto.labelEd8aca00",hasArrow:!0,menu:"textBox"}]},{items:[{type:"large",icon:"huatifuhao",labelKey:"layout.auto.label9026bf7c",disabled:!0}]}]},{key:"formula",labelKey:"layout.auto.label5613e7b9",groups:[{items:[{type:"large",icon:"charugongshi",labelKey:"layout.auto.label92ff62e4",action:`${t}.Action.openFormulaDialog('all')`},{type:"large",icon:"qiuhe",labelKey:"layout.auto.label304be598",hasArrow:!0,menu:"autoSum"},{type:"large",icon:"icon_fn_fx",labelKey:"layout.auto.labelD9d58d20",menu:"commonFn",menuWidth:"220px"},{type:"stack",items:[{type:"dropdown",icon:"caiwu",labelKey:"layout.auto.label20a672e0",menu:"financeFn"},{type:"dropdown",icon:"luojiti",labelKey:"layout.auto.label92f61dec",menu:"logicFn"}]},{type:"stack",items:[{type:"dropdown",icon:"_24glFileText",labelKey:"layout.auto.label5d77ac8c",menu:"textFn"},{type:"dropdown",icon:"calendar",labelKey:"layout.auto.label92fd0eec",menu:"dateFn"}]},{type:"stack",items:[{type:"dropdown",icon:"chaxun",labelKey:"layout.auto.label36263538",menu:"lookupFn"},{type:"dropdown",icon:"shuxue",labelKey:"layout.auto.label3a60f922",menu:"mathFn"}]}]},{items:[{type:"large",icon:"vipZidingyimingcheng",labelKey:"layout.auto.label62002448",action:`${t}.Action.nameManager()`},{type:"stack",items:[{icon:"picimingcheng",labelKey:"layout.auto.label4b5562f8",action:`${t}.Action.defineName()`},{icon:"gongshi",labelKey:"layout.auto.labelB0c44120",action:`${t}.Action.useInFormula()`}]}]},{items:[{type:"stack",items:[{icon:"zhuizong",labelKey:"layout.auto.labelF189a560",action:`${t}.Action.tracePrecedents()`},{icon:"zhuizongqibeifen",labelKey:"layout.auto.label071821ca",action:`${t}.Action.traceDependents()`}]},{type:"stack",items:[{type:"dropdown",icon:"yichu",labelKey:"layout.auto.label2d72febc",menu:"removeArrows"},{icon:"xianshi",labelKey:"layout.auto.labelDfebdd0c",action:`${t}.Action.showFormulas()`}]},{type:"stack",items:[{icon:"jiancha",labelKey:"layout.auto.label04218143",action:`${t}.Action.errorCheck()`},{icon:"jisuan",labelKey:"layout.auto.labelF3321014",action:`${t}.Action.evaluateFormula()`}]}]},{items:[{type:"large",icon:"zhihangzhongsuan",labelKey:"layout.auto.labelFf7d7c40",action:`${t}.Action.calculateNow()`},{type:"stack",items:[{type:"dropdown",icon:"xuanxiang",labelKey:"layout.auto.label6d1763f6",menu:"calcOptions"},{icon:"jisuan",labelKey:"layout.auto.label9d54bf30",action:`${t}.Action.calculateSheet()`}]}]}]},{key:"data",labelKey:"layout.auto.label426d9dba",groups:[{items:[{type:"large",icon:"shengchengshujutoushibiao",labelKey:"layout.auto.labelA05734b8",action:`${t}.Action.createPivotTable()`}]},{items:[{type:"large",icon:"shaixuan",labelKey:"layout.auto.labelF3e084a4",hasArrow:!0,menu:"filter"},{type:"large",icon:"paixu",labelKey:"layout.auto.label328b35a0",hasArrow:!0,menu:"sort"},{type:"stack",items:[{icon:"xianshi",labelKey:"layout.auto.labelCfc23d16",action:`${t}.Action.clearFilter()`},{icon:"gengduo",labelKey:"layout.auto.label53f4d744",action:`${t}.Action.reapplyFilter()`}]}]},{items:[{type:"large",icon:"fenlie",labelKey:"layout.auto.label37d4df3d",action:`${t}.Action.textToColumns()`},{type:"large",icon:"shujuyanzheng",labelKey:"layout.auto.label065032d4",hasArrow:!0,menu:"dataValidation"},{type:"large",icon:"rongqi_2024_10_15T145712642",labelKey:"layout.auto.label24db7740",action:`${t}.Action.removeDuplicates()`},{type:"large",icon:"shengcheng",labelKey:"layout.auto.labelEdc074b8",action:`${t}.Action.flashFill()`}]},{items:[{type:"large",icon:"chuangjianzu",labelKey:"layout.auto.labelD27bcc48",action:`${t}.Action.groupRows()`},{type:"large",icon:"ungroup",labelKey:"layout.auto.label3661dfec",action:`${t}.Action.ungroupRows()`},{type:"large",icon:"fenleihuizong",labelKey:"layout.auto.label6fbb5db4",action:`${t}.Action.subtotal()`}]},{items:[{type:"large",icon:"jisuan",labelKey:"layout.auto.label32e3aa24",action:`${t}.Action.consolidate()`},{type:"large",icon:"monifenxi",labelKey:"layout.auto.labelF5b9a3ae",hasArrow:!0,menu:"whatIfAnalysis",disabled:!0}]}]},{key:"view",labelKey:"layout.auto.label7d9a5030",groups:[{items:[{type:"large",icon:"huyan_",labelKey:"layout.auto.label15a1b75c",action:`${t}.Canvas.toggleEyeProtection()`},{type:"large",icon:"dangqianhangliegaoliang",labelKey:"layout.auto.labelF5e868d8",hasArrow:!0,menu:"highlight"}]},{items:[{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label36cb3b80",id:"showFormulaBar",checked:t=>t.Layout.showFormulaBar,action:`${t}.Layout.showFormulaBar=this.checked`},{type:"checkbox",labelKey:"layout.auto.label805a4b6c",id:"showGridlines",checked:t=>!1!==t.activeSheet?.showGridLines,action:`${t}.activeSheet.showGridLines=this.checked;${t}._r()`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label5728db81",id:"showSheetTabBar",checked:t=>t.Layout.showSheetTabBar,action:`${t}.Layout.showSheetTabBar=this.checked`},{type:"checkbox",labelKey:"layout.auto.labelFcc62550",id:"showAIChat",checked:t=>t.Layout.showAIChat,action:`${t}.Layout.showAIChat=this.checked`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label880beb90",id:"showStats",checked:t=>t.Layout.showStats,action:`${t}.Layout.showStats=this.checked`},{type:"checkbox",labelKey:"layout.auto.label82b852ee",id:"fullScreen",checked:()=>!!document.fullscreenElement,action:`${t}.Action.fullScreen()`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.labelE8420025",id:"showRowColHeaders",checked:t=>!1!==t.activeSheet?.showRowColHeaders,action:`${t}.activeSheet.showRowColHeaders=this.checked;${t}._r()`},{type:"checkbox",labelKey:"layout.auto.labelCbc4bc74",id:"minimalToolbar",checked:t=>"minimal"===t.Layout.toolbarMode,disabled:t=>t.Layout.isToolbarModeLocked,action:`${t}.Layout.toggleMinimalToolbar(this.checked)`}]}]},{items:[{type:"large",icon:"xianshibili",labelKey:"layout.auto.label89be961f",hasArrow:!0,menu:"zoom"},{type:"large",icon:"yby",labelKey:"layout.auto.label2f97df3c",action:`${t}.activeSheet.zoom=1`},{type:"large",icon:"suofang",labelKey:"layout.auto.label8b57557b",action:`${t}.activeSheet.zoomToSelection()`}]},{items:[{type:"large",icon:"hanglieqiehuan",labelKey:"layout.auto.label905e4698",menu:"rowColSize"},{type:"stack",items:[{icon:"Edit_dongjiehang_freezeLine_linear",labelKey:"layout.auto.label12163f5a",action:`${t}.Action.freezeRows(1)`},{icon:"Edit_dongjielie_freezeColumn_linear",labelKey:"layout.auto.labelB99d153f",action:`${t}.Action.freezeCols(1)`}]}]}]},{key:"page",labelKey:"layout.auto.labelDbb08c76",groups:[{items:[{type:"large",icon:"zhuti_04",labelKey:"layout.page.theme",menu:"theme",disabled:!0},{type:"stack",items:[{type:"dropdown",icon:"yanse",labelKey:"layout.page.colors",menu:"themeColors",disabled:!0},{type:"dropdown",icon:"ziti",labelKey:"layout.page.fonts",menu:"themeFonts",disabled:!0}]}]},{items:[{type:"large",icon:"dayinyulan",labelKey:"layout.page.printPreview",action:`${t}.Action.printPreview()`},{type:"large",icon:"yebianju",labelKey:"layout.page.margins",hasArrow:!0,menu:"pageMargins"},{type:"large",icon:"fangxiang",labelKey:"layout.page.orientation",hasArrow:!0,menu:"pageOrientation"},{type:"large",icon:"_24glFileText",labelKey:"layout.page.paperSize",hasArrow:!0,menu:"paperSize"},{type:"large",icon:"dayinquyuxianxing",labelKey:"layout.page.printArea",hasArrow:!0,menu:"printArea"},{type:"large",icon:"dayinsuofang",labelKey:"layout.page.printScale",hasArrow:!0,menu:"printScale"},{type:"large",icon:"beijingtupian",labelKey:"layout.page.background",action:`${t}.Action.setPageBackground()`},{type:"stack",items:[{icon:"dayinbiaotihuobiaotou",labelKey:"layout.page.printTitles",action:`${t}.Action.setPrintTitles()`},{icon:"yemeiyejiao_01",labelKey:"layout.page.headerFooter",action:`${t}.Action.setHeaderFooter()`}]}]},{items:[{type:"stack",items:[{type:"checkbox",labelKey:"layout.page.printGridlines",id:"printGridlines",checked:t=>!0===t.activeSheet?.printSettings?.printOptions?.gridlines,action:`${t}.Action.togglePrintGridlines(this.checked)`},{type:"checkbox",labelKey:"layout.page.printHeadings",id:"printHeadings",checked:t=>!0===t.activeSheet?.printSettings?.printOptions?.headings,action:`${t}.Action.togglePrintHeadings(this.checked)`}]}]},{items:[{type:"large",icon:"dayinyulan1",labelKey:"layout.page.pagePreview",action:`${t}.Action.pageBreakPreview()`},{type:"stack",items:[{type:"checkbox",labelKey:"layout.page.pageBreaks",id:"showPageBreaks",checked:t=>!0===t.activeSheet?.showPageBreaks,action:`${t}.Action.toggleShowPageBreaks(this.checked)`},{icon:"_24glPageBreak",labelKey:"layout.page.addBreak",action:`${t}.Action.insertPageBreak()`}]}]}]},{key:"tableDesign",labelKey:"layout.auto.labelD4fa30c8",contextual:!0,contextType:"table",groups:[{labelKey:"layout.auto.label54132264",items:[{type:"labelInput",id:"tableName",labelKey:"layout.auto.labelD31c02a0",action:`${t}.Action.renameTable(this.value)`},{type:"large",icon:"shengchengshujutoushibiao",labelKey:"layout.auto.label52fa4c98",action:`${t}.Action.resizeTable()`}]},{labelKey:"layout.auto.label9f1d3d34",items:[{type:"large",icon:"shengchengshujutoushibiao",labelKey:"layout.auto.label765501ea",action:`${t}.Action.createPivotTable()`},{type:"large",icon:"_chartWqiepianqi",labelKey:"layout.auto.label694838cc",action:`${t}.Action.insertSlicer()`},{type:"stack",items:[{icon:"rongqi_2024_10_15T145712642",labelKey:"layout.auto.labelEb15f260",action:`${t}.Action.removeDuplicates()`},{icon:"zhuanhuan",labelKey:"layout.auto.labelA6b39eb4",action:`${t}.Action.convertTableToRange()`}]}]},{labelKey:"layout.auto.label32ac6bce",items:[{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label240fc094",id:"tableHeaderRow",checked:t=>!0===t.Layout.Kv?.showHeaderRow,action:`${t}.Action.toggleTableOption('headerRow')`},{type:"checkbox",labelKey:"layout.auto.labelC0185cac",id:"tableTotalsRow",checked:t=>!0===t.Layout.Kv?.showTotalsRow,action:`${t}.Action.toggleTableOption('totalsRow')`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label37030c7c",id:"tableRowStripes",checked:t=>!0===t.Layout.Kv?.showRowStripes,action:`${t}.Action.toggleTableOption('rowStripes')`},{type:"checkbox",labelKey:"layout.auto.label7af7db1c",id:"tableColStripes",checked:t=>!0===t.Layout.Kv?.showColumnStripes,action:`${t}.Action.toggleTableOption('columnStripes')`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.labelE30beb48",id:"tableFirstColumn",checked:t=>!0===t.Layout.Kv?.showFirstColumn,action:`${t}.Action.toggleTableOption('firstColumn')`},{type:"checkbox",labelKey:"layout.auto.label798a4a6c",id:"tableLastColumn",checked:t=>!0===t.Layout.Kv?.showLastColumn,action:`${t}.Action.toggleTableOption('lastColumn')`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label54197afc",id:"tableAutoFilter",checked:t=>!0===t.Layout.Kv?.autoFilterEnabled,action:`${t}.Action.toggleTableOption('autoFilter')`}]}]},{labelKey:"layout.auto.label727a825c",items:[{type:"large",icon:"biaogeyangshi",labelKey:"layout.auto.label801897e0",hasArrow:!0,menu:"tableStyles",menuWidth:"340px"}]},{labelKey:"layout.auto.labelD932aecc",items:[{type:"large",icon:"biaogeyangshi",labelKey:"layout.auto.label2c95d4cc",action:`${t}.Action.deleteTable()`}]}]},{key:"pivotAnalyze",labelKey:"layout.auto.labelDa7a0418",contextual:!0,contextType:"pivotTable",groups:[{labelKey:"layout.auto.label6d96702e",items:[{type:"labelInput",id:"pivotTableName",labelKey:"layout.auto.labelD8cbc426",action:`${t}.Action.renamePivotTable(this.value)`},{type:"large",icon:"xuanxiang",labelKey:"layout.auto.labelEebdf267",menu:"pivotOptions"},{type:"labelInput",id:"pivotTableName",labelKey:"layout.auto.label067fc51e",action:`${t}.Action.renamePivotTable(this.value)`},{type:"large",icon:"xuanxiang",labelKey:"layout.auto.labelE7274318",action:`${t}.Action.pivotFieldSettings()`},{type:"stack",items:[{icon:"niantie",labelKey:"layout.auto.labelCa8595e4",action:`${t}.refreshAllPivotTables()`},{icon:"niantie",labelKey:"layout.auto.label10481acc",action:`${t}.Action.changePivotDataSource()`}]}]},{labelKey:"layout.auto.label34005110",items:[{type:"large",icon:"niantie",labelKey:"layout.auto.label694838cc",action:`${t}.Action.insertPivotSlicer()`}]},{labelKey:"layout.auto.label426d9dba",items:[{type:"large",icon:"niantie",labelKey:"layout.auto.label8d9fe558",action:`${t}.Action.refreshPivotTable()`},{type:"stack",items:[{icon:"niantie",labelKey:"layout.auto.label1b11c6bc",action:`${t}.refreshAllPivotTables()`},{icon:"niantie",labelKey:"layout.auto.label9371a726",action:`${t}.Action.changePivotDataSource()`}]}]},{labelKey:"layout.auto.labelD932aecc",items:[{type:"large",icon:"niantie",labelKey:"layout.auto.label0b9d2bac",hasArrow:!0,menu:"pivotClear"},{type:"large",icon:"niantie",labelKey:"layout.auto.label26529d60",action:`${t}.Action.movePivotTable()`}]},{labelKey:"layout.auto.labelF82f77ee",items:[{type:"large",icon:"niantie",id:"pivotFieldList",labelKey:"layout.auto.labelFd70269c",action:`${t}.Action.togglePivotFieldList()`},{type:"large",icon:"niantie",id:"pivotDrillButtons",labelKey:"layout.auto.label97beaff2",action:`${t}.Action.togglePivotDrillButtons()`},{type:"large",icon:"niantie",id:"pivotFieldHeaders",labelKey:"layout.auto.labelF43382bc",action:`${t}.Action.togglePivotFieldHeaders()`}]}]},{key:"pivotDesign",labelKey:"layout.auto.label27023994",contextual:!0,contextType:"pivotTable",groups:[{labelKey:"layout.auto.labelD4037dd0",items:[{type:"large",icon:"fenleihuizong",labelKey:"layout.auto.label6fbb5db4",hasArrow:!0,menu:"pivotSubtotals"},{type:"large",icon:"qiuhe",labelKey:"layout.auto.label142c257c",hasArrow:!0,menu:"pivotGrandTotals"},{type:"large",icon:"niantie",labelKey:"layout.auto.label76fd7400",hasArrow:!0,menu:"pivotReportLayout"},{type:"large",icon:"niantie",labelKey:"layout.auto.label170d7ba0",hasArrow:!0,menu:"pivotBlankRows"}]},{labelKey:"layout.auto.label62572410",items:[{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label9975a578",id:"pivotRowHeaders",checked:t=>!1!==t.Layout.Kv?.showRowHeaders,action:`${t}.Action.togglePivotOption('rowHeaders')`},{type:"checkbox",labelKey:"layout.auto.labelCd612c50",id:"pivotColHeaders",checked:t=>!1!==t.Layout.Kv?.showColHeaders,action:`${t}.Action.togglePivotOption('colHeaders')`}]},{type:"stack",items:[{type:"checkbox",labelKey:"layout.auto.label37030c7c",id:"pivotRowStripes",checked:t=>!0===t.Layout.Kv?.showRowStripes,action:`${t}.Action.togglePivotOption('rowStripes')`},{type:"checkbox",labelKey:"layout.auto.label7af7db1c",id:"pivotColStripes",checked:t=>!0===t.Layout.Kv?.showColStripes,action:`${t}.Action.togglePivotOption('colStripes')`}]}]},{labelKey:"layout.auto.label57267dc8",items:[{type:"large",icon:"biaogeyangshi",labelKey:"layout.auto.label801897e0",hasArrow:!0,menu:"pivotStyles",menuWidth:"340px"}]}]}];return w_(e),e}(t),"function"==typeof n&&(this.config=n(this.config)),this.menuConfig=function(t){return{fontName:T_(t),fontSize:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72].map(e=>({text:String(e),action:`${t}.Action.areasStyle('font',{size:${e}})`})),hAlign:[{labelKey:"layout.auto.label2f9e586c",icon:"zuoduiqi",action:`${t}.Action.areasStyle('alignment',{horizontal:'left'})`},{labelKey:"layout.auto.label5957a658",icon:"juzhongduiqi",action:`${t}.Action.areasStyle('alignment',{horizontal:'center'})`},{labelKey:"layout.auto.label09f772c4",icon:"youduiqi",action:`${t}.Action.areasStyle('alignment',{horizontal:'right'})`}],vAlign:[{labelKey:"layout.auto.label2d6a5a8c",icon:"pingjunfenbuduiqiicon_huabanfuben4",action:`${t}.Action.areasStyle('alignment',{vertical:'top'})`},{labelKey:"layout.auto.labelF2b067c8",icon:"pingjunfenbuduiqiicon_huabanfuben6",action:`${t}.Action.areasStyle('alignment',{vertical:'center'})`},{labelKey:"layout.auto.label09162f60",icon:"pingjunfenbuduiqiicon_huabanfuben1",action:`${t}.Action.areasStyle('alignment',{vertical:'bottom'})`}],textRotation:[{labelKey:"layout.auto.labelB1f1d5ca",action:`${t}.Action.setTextRotation('ccw45')`},{labelKey:"layout.auto.labelC1ea5002",action:`${t}.Action.setTextRotation('cw45')`},{labelKey:"layout.auto.label2e9bdfc6",action:`${t}.Action.setTextRotation('vertical')`},{labelKey:"layout.auto.label3cd54380",action:`${t}.Action.setTextRotation('up90')`},{labelKey:"layout.auto.labelCf38367c",action:`${t}.Action.setTextRotation('down90')`},{type:"divider"},{labelKey:"layout.auto.label8c5bd7f4",action:`${t}.Action.setTextRotation('none')`}],merge:[{labelKey:"layout.auto.labelDfde92a4",action:`${t}.activeSheet.mergeCells(null,'center');${t}._r()`},{labelKey:"layout.auto.labelC2f55060",action:`${t}.activeSheet.mergeCells();${t}._r()`},{labelKey:"layout.auto.labelD7a9dd2c",action:`${t}.activeSheet.mergeCells(null,'same');${t}._r()`},{labelKey:"layout.auto.labelF0e14500",action:`${t}.activeSheet.mergeCells(null,'content');${t}._r()`},{type:"divider"},{labelKey:"layout.auto.label81ccfc88",action:`${t}.activeSheet.unMergeCells();${t}._r()`}],numFmt:[{labelKey:"toolbar.numFmt.general",action:`${t}.Action.areasNumFmt('')`},{labelKey:"toolbar.numFmt.number",extraKey:"layout.auto.exampleD718a29c",extra:"0.01",action:`${t}.Action.areasNumFmt('0.00')`},{labelKey:"toolbar.numFmt.percent",extraKey:"layout.auto.example2de1ff5c",extra:"0.60%",action:`${t}.Action.areasNumFmt('0.00%')`},{labelKey:"toolbar.numFmt.fraction",extraKey:"layout.auto.example92b9c712",extra:"2 1/2",action:`${t}.Action.areasNumFmt('# ?/?')`},{labelKey:"toolbar.numFmt.scientific",extraKey:"layout.auto.exampleCd80dac4",extra:"6.00E-03",action:`${t}.Action.areasNumFmt('0.00E+00')`},{type:"divider"},{labelKey:"toolbar.numFmt.cny",extraKey:"layout.auto.example739db61c",extra:"¥0.01",action:`${t}.Action.areasNumFmt('¥#,##0.00')`},{labelKey:"toolbar.numFmt.usd",extraKey:"layout.auto.exampleCb87bb63",extra:"$0.01",action:`${t}.Action.areasNumFmt('$#,##0.00')`},{labelKey:"toolbar.numFmt.accounting",extraKey:"layout.auto.example739db61c",extra:"¥0.01",action:`${t}.Action.areasNumFmt('_ ¥* #,##0.00_ ;_ ¥* -#,##0.00_ ;_ ¥* &quot;-&quot;??_ ;_ @_ ')`},{type:"divider"},{labelKey:"toolbar.numFmt.date",extraKey:"layout.auto.exampleB975896c",extra:"1900/1/1",action:`${t}.Action.areasNumFmt('yyyy/m/d')`},{labelKey:"toolbar.numFmt.longDate",extraKey:"toolbar.numFmt.longDateExample",extra:"January 1, 1900",action:`${t}.Action.areasNumFmt('yyyy/m/d')`},{labelKey:"toolbar.numFmt.time",extraKey:"layout.auto.exampleB3542328",extra:"0:08:38",action:`${t}.Action.areasNumFmt('h:mm:ss')`},{labelKey:"toolbar.numFmt.dateTime",extraKey:"layout.auto.example59160d28",extra:"2024/10/1 12:00",action:`${t}.Action.areasNumFmt('yyyy/m/d h:mm:ss')`},{type:"divider"},{labelKey:"toolbar.numFmt.text",extraKey:"layout.auto.example46c5d49a",extra:"0.006",action:`${t}.Action.areasNumFmt('@')`},{type:"divider"},{labelKey:"toolbar.numFmt.custom",action:`${t}.Action.customNumFmtDialog()`}],currency:[{labelKey:"layout.auto.label82496aef",action:`${t}.Action.areasNumFmt('$#,##0.00')`},{labelKey:"layout.auto.labelF7b3d440",action:`${t}.Action.areasNumFmt('€#,##0.00')`},{labelKey:"layout.auto.label5a640746",action:`${t}.Action.areasNumFmt('£#,##0.00')`},{labelKey:"layout.auto.labelDa8abb77",action:`${t}.Action.areasNumFmt('¥#,##0.00')`},{labelKey:"layout.auto.labelE2433858",action:`${t}.Action.areasNumFmt('₩#,##0')`},{labelKey:"layout.auto.label7844abc8",action:`${t}.Action.areasNumFmt('₹#,##0.00')`},{labelKey:"layout.auto.label47c40973",action:`${t}.Action.areasNumFmt('₽#,##0.00')`},{labelKey:"layout.auto.label4674137c",action:`${t}.Action.areasNumFmt('CHF #,##0.00')`},{labelKey:"layout.auto.label46ecf058",action:`${t}.Action.areasNumFmt('A$#,##0.00')`},{labelKey:"layout.auto.label7d40574d",action:`${t}.Action.areasNumFmt('C$#,##0.00')`},{labelKey:"layout.auto.label525c8b3c",action:`${t}.Action.areasNumFmt('HK$#,##0.00')`}],clear:[{labelKey:"layout.auto.labelB683336c",action:`${t}.Action.clearAreaFormat()`},{labelKey:"layout.auto.labelAb4a78ac",action:`${t}.Action.clearAreaFormat('style')`},{labelKey:"layout.auto.label80c65db8",action:`${t}.Action.clearAreaFormat('value')`},{labelKey:"layout.auto.label83c5b1ec",action:`${t}.Action.clearAreaFormat('border')`}],protection:[{labelKey:"layout.auto.labelEa7f2a4b",action:`${t}.Action.configProtection()`},{labelKey:"layout.auto.label476f4998",action:`${t}.Action.configCellProtection()`},{labelKey:"layout.auto.label6ea6ad84",action:`${t}.Action.cancelProtection()`}],freeze:[{labelKey:"layout.auto.label06a5c768",action:`${t}.Action.freezeAtActiveCell()`,titleKey:"layout.auto.titleAb81d070"},{type:"divider"},{labelKey:"layout.auto.label12163f5a",action:`${t}.Action.freezeRows(1)`},{labelKey:"layout.auto.labelB99d153f",action:`${t}.Action.freezeCols(1)`},{labelKey:"layout.auto.labelDba82348",action:`${t}.Action.freezeRowsAndCols(1,1)`},{type:"divider"},{labelKey:"layout.auto.label8fd62c48",action:`${t}.Action.freezeToCurrentRow()`},{labelKey:"layout.auto.labelB9b1a1f8",action:`${t}.Action.freezeToCurrentCol()`},{type:"divider"},{labelKey:"layout.auto.labelD8bfe629",action:`${t}.Action.unfreeze()`}],saveAs:[{labelKey:"layout.auto.label4868045c",action:`${t}.IO.downloadXlsx()`},{labelKey:"layout.auto.labelE62a5aa0",action:`${t}.IO.downloadCsv()`},{labelKey:"layout.auto.label5ed9f2ae",action:`${t}.IO.downloadJson()`}],zoom:[{labelKey:"layout.auto.label20989160",action:`${t}.activeSheet.zoom=0.5`},{labelKey:"layout.auto.label28d8b828",action:`${t}.activeSheet.zoom=0.75`},{labelKey:"layout.auto.label2f97df3c",action:`${t}.activeSheet.zoom=1`},{labelKey:"layout.auto.labelE8d30c78",action:`${t}.activeSheet.zoom=1.25`},{labelKey:"layout.auto.label58e5db03",action:`${t}.activeSheet.zoom=1.5`},{labelKey:"layout.auto.label60974ee4",action:`${t}.activeSheet.zoom=2`},{type:"divider"},{labelKey:"layout.auto.label8ad96a3c",action:`${t}.Action.zoomCustom()`}],pageMargins:[{labelKey:"layout.menu.pageMargins.normal",action:`${t}.Action.setPageMarginsPreset('normal')`},{labelKey:"layout.menu.pageMargins.narrow",action:`${t}.Action.setPageMarginsPreset('narrow')`},{labelKey:"layout.menu.pageMargins.wide",action:`${t}.Action.setPageMarginsPreset('wide')`},{type:"divider"},{labelKey:"layout.menu.custom",action:`${t}.Action.setPageMarginsDialog()`}],pageOrientation:[{labelKey:"layout.menu.pageOrientation.portrait",action:`${t}.Action.setPageOrientation('portrait')`},{labelKey:"layout.menu.pageOrientation.landscape",action:`${t}.Action.setPageOrientation('landscape')`}],paperSize:[{labelKey:"layout.menu.paperSize.a4",action:`${t}.Action.setPaperSize('A4')`},{labelKey:"layout.menu.paperSize.letter",action:`${t}.Action.setPaperSize('Letter')`}],printArea:[{labelKey:"layout.menu.printArea.set",action:`${t}.Action.setPrintAreaFromSelection()`},{labelKey:"layout.menu.printArea.clear",action:`${t}.Action.clearPrintArea()`}],printScale:[{labelKey:"layout.auto.label2f97df3c",action:`${t}.Action.setPrintScale(100)`},{labelKey:"layout.auto.labelCacab6cb",action:`${t}.Action.setPrintScale(90)`},{labelKey:"layout.auto.label38a173b8",action:`${t}.Action.setPrintScale(80)`},{labelKey:"layout.auto.labelA9ccb748",action:`${t}.Action.setPrintScale(70)`},{type:"divider"},{labelKey:"layout.menu.custom",action:`${t}.Action.setPrintScaleDialog()`}],paste:[{labelKey:"layout.auto.label3d33e8d4",action:`${t}.Action.paste('all')`},{type:"divider"},{labelKey:"layout.auto.label39583efc",action:`${t}.Action.paste('value')`},{labelKey:"layout.auto.label5613e7b9",action:`${t}.Action.paste('formula')`},{labelKey:"layout.auto.label9c5bc988",action:`${t}.Action.paste('format')`},{labelKey:"layout.auto.label36d826ce",action:`${t}.Action.paste('noBorder')`},{labelKey:"layout.auto.label0b046e3f",action:`${t}.Action.paste('colWidth')`},{labelKey:"layout.auto.labelE7546746",action:`${t}.Action.paste('transpose')`},{type:"divider"},{labelKey:"layout.auto.label00724f4c",action:`${t}.Action.paste('valueNumberFormat')`},{labelKey:"layout.auto.label6ac6d174",action:`${t}.Action.paste('formulaNumberFormat')`},{type:"divider"},{labelKey:"layout.auto.labelD6d89414",action:`${t}.Action.paste('comment')`},{labelKey:"layout.auto.label065032d4",action:`${t}.Action.paste('validation')`}],convert:[{labelKey:"layout.auto.label40bdc8a4",action:`${t}.Action.textToNumber()`},{labelKey:"layout.auto.labelB67479f3",action:`${t}.Action.numberToText()`},{type:"divider"},{labelKey:"layout.auto.label2eedfce4",action:`${t}.Action.toLowercase()`},{labelKey:"layout.auto.label64f57004",action:`${t}.Action.toUppercase()`},{type:"divider"},{labelKey:"layout.auto.label28152900",action:`${t}.Action.trimSpaces()`}],dataValidation:[{labelKey:"layout.menu.dataValidation.open",action:`${t}.Action.dataValidationDialog()`},{type:"divider"},{labelKey:"layout.menu.dataValidation.clear",action:`${t}.Action.clearDataValidation()`}],rowColSize:[{labelKey:"layout.auto.labelE9cb6cfc",action:`${t}.Action.setRowHeightDialog()`},{labelKey:"layout.auto.labelDbcee390",action:`${t}.Action.setColWidthDialog()`},{labelKey:"layout.auto.label591efe60",action:`${t}.Action.autoFitRowHeight()`},{labelKey:"layout.auto.labelC14245a4",action:`${t}.Action.autoFitColWidth()`},{type:"divider"},{labelKey:"layout.auto.labelDda0aee0",action:`${t}.Action.setDefaultRowHeightDialog()`},{labelKey:"layout.auto.labelA0c3dddc",action:`${t}.Action.setDefaultColWidthDialog()`}],autoSum:[{labelKey:"layout.auto.label304be598",action:`${t}.Action.insertFunction('SUM')`},{labelKey:"layout.auto.labelB191c97c",action:`${t}.Action.insertFunction('AVERAGE')`},{labelKey:"layout.auto.label0c22da14",action:`${t}.Action.insertFunction('COUNT')`},{labelKey:"layout.auto.label5d3d9fbc",action:`${t}.Action.insertFunction('MAX')`},{labelKey:"layout.auto.labelD13c02d3",action:`${t}.Action.insertFunction('MIN')`},{type:"divider"},{labelKey:"layout.auto.label2b1c08f4",action:`${t}.Action.openFormulaDialog('math')`}],sparkline:[{labelKey:"layout.auto.label8b22223e",action:`${t}.Action.openSparklineDialog('line')`},{labelKey:"layout.auto.labelE5f2b110",action:`${t}.Action.openSparklineDialog('column')`},{labelKey:"layout.auto.label637e3b1e",action:`${t}.Action.openSparklineDialog('win_loss')`}],textBox:[{labelKey:"layout.auto.label16d80ff6",action:`${t}.Action.insertTextBox('horizontal')`},{labelKey:"layout.auto.labelB1fa2802",action:`${t}.Action.insertTextBox('vertical')`}],sort:[{labelKey:"layout.auto.label27c10e35",action:`${t}.Action.sortAsc()`},{labelKey:"layout.auto.label56ec896c",action:`${t}.Action.sortDesc()`},{type:"divider"},{labelKey:"layout.auto.label3fdb3ab0",action:`${t}.Action.customSort()`}],filter:[{labelKey:"layout.auto.label2c508544",action:`${t}.Action.toggleAutoFilter()`},{type:"divider"},{labelKey:"layout.auto.label0fba4654",action:`${t}.Action.clearFilter()`},{labelKey:"layout.auto.label53f4d744",action:`${t}.Action.reapplyFilter()`}],find:[{labelKey:"findReplace.tab.find",action:`${t}.Action.openFindDialog('find')`},{labelKey:"findReplace.tab.replace",action:`${t}.Action.openFindDialog('replace')`},{type:"divider"},{labelKey:"findReplace.tab.goto",action:`${t}.Action.openFindDialog('goto')`}],removeArrows:[{labelKey:"layout.auto.label7673ae70",action:`${t}.Action.removeArrows('precedents')`},{labelKey:"layout.auto.label6e89ee74",action:`${t}.Action.removeArrows('dependents')`},{type:"divider"},{labelKey:"layout.auto.label7c9ea1ac",action:`${t}.Action.removeArrows('all')`}],calcOptions:[{labelKey:"layout.auto.labelE2d8213c",action:`${t}.Action.setCalcMode('auto')`,checked:()=>"manual"!==window[t]?.calcMode},{labelKey:"layout.auto.label6f816c60",action:`${t}.Action.setCalcMode('manual')`,checked:()=>"manual"===window[t]?.calcMode}],tableStyles:"special:tableStyles",formatAsTable:"special:formatAsTable",cellStyles:"special:cellStyles",condFormat:"special:condFormat",pivotOptions:[{labelKey:"layout.auto.label8b46f723",action:`${t}.Action.openPivotTableOptions()`},{labelKey:"layout.auto.label5f1a7cbc",action:`${t}.Action.showPivotReportFilterPages()`}],pivotClear:[{labelKey:"layout.auto.labelAac1ce9c",action:`${t}.Action.clearPivotTable('all')`},{type:"divider"},{labelKey:"layout.auto.labelFde78e74",action:`${t}.Action.clearPivotTable('filters')`}],pivotSubtotals:[{labelKey:"layout.auto.labelB6f3db09",action:`${t}.Action.setPivotSubtotals('none')`},{labelKey:"layout.auto.labelF53301bc",action:`${t}.Action.setPivotSubtotals('bottom')`},{labelKey:"layout.auto.label45d4ed20",action:`${t}.Action.setPivotSubtotals('top')`}],pivotGrandTotals:[{labelKey:"layout.auto.label1b148794",action:`${t}.Action.setPivotGrandTotals('none')`},{labelKey:"layout.auto.label42a69c1c",action:`${t}.Action.setPivotGrandTotals('both')`},{labelKey:"layout.auto.labelEac219e0",action:`${t}.Action.setPivotGrandTotals('rows')`},{labelKey:"layout.auto.label46acc0ac",action:`${t}.Action.setPivotGrandTotals('cols')`}],pivotReportLayout:[{labelKey:"layout.auto.labelB290c756",action:`${t}.Action.setPivotLayout('compact')`},{labelKey:"layout.auto.label69e81956",action:`${t}.Action.setPivotLayout('outline')`},{labelKey:"layout.auto.label2364c11e",action:`${t}.Action.setPivotLayout('tabular')`},{type:"divider"},{labelKey:"layout.auto.label7cc4a190",action:`${t}.Action.setPivotRepeatLabels(true)`},{labelKey:"layout.auto.label669baeb8",action:`${t}.Action.setPivotRepeatLabels(false)`}],pivotBlankRows:[{labelKey:"layout.auto.labelB0a4de64",action:`${t}.Action.setPivotBlankRows(true)`},{labelKey:"layout.auto.labelCdcccef2",action:`${t}.Action.setPivotBlankRows(false)`}],pivotStyles:"special:pivotStyles",commonFn:$_(t,"common",{limit:12,dialogKey:"recent"}),financeFn:$_(t,"financial"),logicFn:$_(t,"logical"),textFn:$_(t,"text"),dateFn:$_(t,"datetime"),lookupFn:$_(t,"lookup"),mathFn:$_(t,"math")}}(t),this.Wv=0,this.jv=new WeakMap,this.qv=new Map,this.Gv={"内框":"Inside Borders","外框":"Outside Borders","左上-右下":"Diagonal Down","左下-右上":"Diagonal Up","左":"Left","右":"Right","上":"Top","下":"Bottom","无":"None","浅色":"Light","中等深浅":"Medium","深色":"Dark","关闭高亮":"Turn Off Highlight","好、差和适中":"Good, Bad, and Neutral","数据和模型":"Data and Model","主题单元格样式":"Themed Cell Styles","数字格式":"Number Format","透视表样式":"PivotTable Styles","透视表样式选项":"PivotTable Style Options","表格样式选项":"Table Style Options","1900年1月1日":"1900/1/1"},this.activePanel=this.config[1]?.key||this.config[0]?.key||"start"}setSN(t){this.SN=t}Xv(t){return"string"!=typeof t?t:this.SN.t(t)}mn(t,e="",n={}){const i=this.SN.t(t,n);return i===t&&e?e:i}Yv(t){return t}Jv(t){return"string"==typeof t&&/[\u4e00-\u9fff]/.test(t)}Zv(){const t=this.SN?.locale||"";return/^en\b/i.test(t)}Qv(t){if("string"!=typeof t)return"";const e=t.replace(/([a-z0-9])([A-Z])/g,"$1 $2").replace(/[_-]+/g," ").replace(/([A-Za-z])(\d)/g,"$1 $2").replace(/(\d)([A-Za-z])/g,"$1 $2").trim();return e?e.split(/\s+/).map(t=>t?/^[A-Z0-9]+$/.test(t)?t:`${t.charAt(0).toUpperCase()}${t.slice(1)}`:t).join(" "):""}tb(t,e=""){const n=this.Xv(t);return this.Zv()&&this.Jv(n)&&(e||this.Gv[t]||this.Gv[n])||n}eb(t){if(!t)return"";const e=t.text||t.label||"";if(t.titleKey){const e=this.mn(t.titleKey);if(e!==t.titleKey)return e}return t.labelKey?this.mn(t.labelKey,e):this.tb(e)}getToolbarItemByDisabledUid(t){return null==t?null:this.qv.get(String(t))||null}buildPanelsOnly(){const t=this.config.map(t=>{const e=t.key===this.activePanel,n=e?this.buildPanel(t):"";return`<div class="sn-tools-panel${e?" active":""}" data-panel="${t.key}"${e?' data-rendered="true"':""}>${n}</div>`}).join("");return this.Yv(t)}renderPanelIfNeeded(t){if(t.dataset.rendered)return!1;const e=t.dataset.panel,n=this.config.find(t=>t.key===e);return!!n&&(t.innerHTML=this.buildPanel(n),t.dataset.rendered="true",!0)}buildPanel(t){const e=t.groups.map((e,n)=>this.buildGroup(e,n===t.groups.length-1)).join("");return this.Yv(e)}buildGroup(t,e){const n=[];let i=[];const r=()=>{i.length>0&&(n.push(`<div class="sn-tools-rows">${i.join("")}</div>`),i=[])};for(const o of t.items)"row"===o.type?i.push(this.buildItem(o)):(r(),n.push(this.buildItem(o)));return r(),`<div class="sn-tools-group${e?" last":""}"><div class="sn-tools-group-content">${n.join("")}</div></div>`}buildItem(t){switch(t.type){case"large":return this.buildLargeItem(t);case"stack":return this.buildStack(t);case"row":return this.buildRow(t);case"dropdown":return this.buildDropdown(t);case"splitDropdown":return this.buildSplitDropdown(t);case"colorPicker":return this.buildColorPicker(t);case"splitColorPicker":return this.buildSplitColorPicker(t);case"checkbox":return this.buildCheckbox(t);case"labelInput":return this.buildLabelInput(t);default:return this.buildSmallItem(t)}}nb(t,{baseClass:e="",withArrow:n=!1}={}){if(!t)return"";if(!(t.text||t.label||t.labelKey||t.minimalLabel||t.minimalLabelKey))return"";const i=`${e}${!1!==t.minimalText?" sn-minimal-text-label":""}`.trim(),r=i?` class="${i}"`:"",o=n?'<i class="sn-arrow"></i>':"",a=t.minimalLabel||t.text||t.label,s=t.minimalLabelKey||t.labelKey||"";return`<span${r}>${s?this.mn(s,a):this.Xv(a)}${o}</span>`}ib(t){return"function"==typeof t?.disabled?!!this.SN&&!!t.disabled(this.SN):!!t?.disabled}rb(t){if(!t||"object"!=typeof t)return"";if(this.jv.has(t))return this.jv.get(t);const e=String(++this.Wv);return this.jv.set(t,e),this.qv.set(e,t),e}sb(t){if(!t||void 0===t.disabled)return{isDisabled:!1,disabledClass:"",disabledAttr:"",disabledGetterAttr:"",disabledUidAttr:"",ariaDisabledAttr:""};const e=this.ib(t),n=this.rb(t);return{isDisabled:e,disabledClass:e?" sn-item-disabled":"",disabledAttr:e?"disabled":"",disabledGetterAttr:"function"==typeof t.disabled?'data-disabled-getter="true"':"",disabledUidAttr:`data-disabled-uid="${n}"`,ariaDisabledAttr:`aria-disabled="${e?"true":"false"}"`}}buildLargeItem(t){const e=t.id?`data-field="${t.id}"`:"",n=this.sb(t);let i="",r="";if("function"==typeof t.active&&(i=this.SN&&t.active(this.SN)?" sn-btn-selected":"",r='data-active-getter="true"'),t.menu){const o=t.menuWidth?`style="width:${t.menuWidth}"`:"";return`\n                <div class="sn-dropdown sn-tools-item large${i}${n.disabledClass}" ${e} ${r} ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr}>\n                    <div class="sn-dropdown-toggle sn-no-icon" title="${this.eb(t)}">\n                        ${cn(t.icon)}\n                        ${this.nb(t,{baseClass:"sn-tools-item-label",withArrow:!0})}\n                    </div>\n                    <ul class="sn-dropdown-menu" data-lazy-menu="${t.menu}" ${o}></ul>\n                </div>`}const o=t.action?`onclick="${t.action}"`:"",a=t.dblAction?`ondblclick="${t.dblAction}"`:"";return`\n            <div class="sn-tools-item large${i}${n.disabledClass}" ${e} ${o} ${a} ${r} ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr} title="${this.eb(t)}">\n                ${cn(t.icon)}\n                ${this.nb(t,{baseClass:"sn-tools-item-label"})}\n            </div>`}buildSmallItem(t){const e=t.id?`data-field="${t.id}"`:"",n=this.sb(t),i=t.action?`onclick="${t.action}"`:"",r=t.dblAction?`ondblclick="${t.dblAction}"`:"",o=this.eb(t);return`<div class="sn-tools-item small${n.disabledClass}" ${e} ${i} ${r} ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr} title="${o}">${cn(t.icon)}</div>`}buildStack(t){return`<div class="sn-tools-stack">${t.items.map(t=>"dropdown"===t.type?this.buildStackDropdown(t):"splitDropdown"===t.type?this.buildStackSplitDropdown(t):"checkbox"===t.type?this.buildCheckbox(t):this.buildStackItem(t)).join("")}</div>`}buildStackItem(t){const e=t.id?`data-field="${t.id}"`:"",n=this.sb(t),i=t.action?`onclick="${t.action}"`:"",r=this.eb(t),o=this.nb(t);let a="",s="";return"function"==typeof t.active&&(a=this.SN&&t.active(this.SN)?" sn-btn-selected":"",s='data-active-getter="true"'),`<div class="sn-tools-stack-item${a}${n.disabledClass}" ${e} ${i} ${s} ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr} title="${r}">${cn(t.icon)}${o}</div>`}buildStackDropdown(t){const e=this.nb(t),n=t.menuWidth?`style="width:${t.menuWidth}"`:"",i=this.sb(t);return`\n            <div class="sn-dropdown sn-tools-stack-item${i.disabledClass}" ${i.disabledGetterAttr} ${i.disabledUidAttr} ${i.ariaDisabledAttr} title="${this.eb(t)}">\n                <div class="sn-dropdown-toggle sn-no-icon">${cn(t.icon)}${e}<i class="sn-arrow"></i></div>\n                <ul class="sn-dropdown-menu" data-lazy-menu="${t.menu}" ${n}></ul>\n            </div>`}buildStackSplitDropdown(t){const e=t.keepOpen?'data-keep-open="true"':"",n=this.nb(t),i=this.sb(t);return`\n            <div class="sn-split-btn sn-stack-split${i.disabledClass}" ${i.disabledGetterAttr} ${i.disabledUidAttr} ${i.ariaDisabledAttr} title="${this.eb(t)}">\n                <div class="sn-split-btn-main" onclick="${t.action}">${cn(t.icon)}${n}</div>\n                <div class="sn-dropdown sn-split-btn-arrow" ${e}>\n                    <div class="sn-dropdown-toggle sn-no-icon"><i class="sn-arrow"></i></div>\n                    <ul class="sn-dropdown-menu" data-lazy-menu="${t.menu}"></ul>\n                </div>\n            </div>`}buildRow(t){return`<div class="sn-tools-row">${t.items.map(t=>this.buildRowItem(t)).join("")}</div>`}buildRowItem(t){if("dropdown"===t.type)return t.width?this.buildInlineDropdown(t):this.buildDropdown(t);if("splitDropdown"===t.type)return this.buildSplitDropdown(t);if("colorPicker"===t.type)return this.buildColorPicker(t);if("splitColorPicker"===t.type)return this.buildSplitColorPicker(t);const e=t.id?`data-field="${t.id}"`:"",n=this.sb(t),i=t.action?`onclick="${t.action}"`:"",r=this.eb(t),o=this.nb(t);return`<div class="sn-tools-item small${n.disabledClass}" ${e} ${i} ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr} title="${r}">${cn(t.icon)}${o}</div>`}buildInlineDropdown(t){const e=this.buildMenuHTML(t.menu),n=t.width?`style="width:${t.width}"`:"",i=t.keepOpen?'data-keep-open="true"':"",r=t.menuWidth?`style="width:${t.menuWidth}"`:"",o=t.icon?cn(t.icon):"",a=t.labelKey?this.mn(t.labelKey,t.text||t.label||""):this.Xv(t.text||t.label||""),s=t.placeholderKey?this.mn(t.placeholderKey,t.placeholder||""):this.Xv(t.placeholder||""),l=t.id||"",c=this.sb(t);return`\n            <div class="sn-dropdown sn-combobox${c.disabledClass}" ${i} ${c.disabledGetterAttr} ${c.disabledUidAttr} ${c.ariaDisabledAttr} data-menu="${t.menu}" title="${this.eb(t)}">\n                <div class="sn-combobox-main" ${n}>\n                    ${o}<input type="text" class="sn-combobox-input" value="${a}" data-id="${l}" placeholder="${s}" ${c.disabledAttr}>\n                </div>\n                <div class="sn-dropdown-toggle sn-combobox-arrow sn-no-icon"><i class="sn-arrow"></i></div>\n                <ul class="sn-dropdown-menu" ${r}>${e}</ul>\n            </div>`}buildSplitDropdown(t){const e=t.keepOpen?'data-keep-open="true"':"",n=t.menuWidth?`style="width:${t.menuWidth}"`:"",i=t.icon?cn(t.icon):"",r=this.nb(t),o="jurassic_borderAll"===t.icon?'data-tool="border"':"",a=this.sb(t),s="border"===t.menu,l=s?this.buildMenuHTML(t.menu):"",c=s?"":`data-lazy-menu="${t.menu}"`;return`\n            <div class="sn-split-btn${a.disabledClass}" ${o} ${a.disabledGetterAttr} ${a.disabledUidAttr} ${a.ariaDisabledAttr} title="${this.eb(t)}">\n                <div class="sn-split-btn-main" onclick="${t.action}">${i}${r}</div>\n                <div class="sn-dropdown sn-split-btn-arrow" ${e}>\n                    <div class="sn-dropdown-toggle sn-no-icon"><i class="sn-arrow"></i></div>\n                    <ul class="sn-dropdown-menu" ${c} ${n}>${l}</ul>\n                </div>\n            </div>`}buildDropdown(t){const e=t.keepOpen?'data-keep-open="true"':"",n=this.nb(t),i=this.sb(t);return`\n            <div class="sn-dropdown sn-tools-item small${i.disabledClass}" ${e} ${i.disabledGetterAttr} ${i.disabledUidAttr} ${i.ariaDisabledAttr} title="${this.eb(t)}">\n                <div class="sn-dropdown-toggle sn-no-icon">${cn(t.icon)}${n}<i class="sn-arrow"></i></div>\n                <ul class="sn-dropdown-menu" data-lazy-menu="${t.menu}"></ul>\n            </div>`}buildColorPicker(t){const e="font"===(t.colorType||"font")?"fontColorBtn":"fillColorBtn",n=this.sb(t);return`\n            <div class="sn-dropdown sn-tools-item small${n.disabledClass}" data-keep-open="true" ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr} title="${this.eb(t)}">\n                <div class="sn-dropdown-toggle sn-no-icon">${cn(t.icon)}<i class="sn-arrow"></i></div>\n                <ul class="sn-dropdown-menu" style="width:220px;"><div class="sn-color-select" onclick="${this.ns}.Action.${e}(event)"></div></ul>\n            </div>`}buildSplitColorPicker(t){const e=t.colorType||"font",n="font"===e?"fontColorBtn":"fillColorBtn",i="font"===e?"applyFontColor":"applyFillColor",r=t.keepOpen?'data-keep-open="true"':"",o=this.sb(t);return`\n            <div class="sn-split-btn${o.disabledClass}" ${o.disabledGetterAttr} ${o.disabledUidAttr} ${o.ariaDisabledAttr} data-color-type="${e}" title="${this.eb(t)}">\n                <div class="sn-split-btn-main" onclick="${this.ns}.Action.${i}()"><span class="sn-color-icon">${cn(t.icon)}</span><span class="sn-color-bar"></span></div>\n                <div class="sn-dropdown sn-split-btn-arrow" ${r}>\n                    <div class="sn-dropdown-toggle sn-no-icon"><i class="sn-arrow"></i></div>\n                    <ul class="sn-dropdown-menu" style="width:220px;"><div class="sn-color-select" onclick="${this.ns}.Action.${n}(event)"></div></ul>\n                </div>\n            </div>`}buildCheckbox(t){let e=!1;e="function"==typeof t.checked?!!this.SN&&!!t.checked(this.SN):!!t.checked;const n=e?"checked":"",i=this.sb(t),r=t.action?`onchange="${t.action}"`:"",o="function"==typeof t.checked?'data-getter="true"':"",a=t.labelKey?this.mn(t.labelKey,t.text||t.label||""):this.Xv(t.text||t.label||"");return`<label class="sn-tools-checkbox${i.disabledClass}" ${i.ariaDisabledAttr} title="${this.eb(t)}"><input type="checkbox" data-field="${t.id}" ${n} ${r} ${o} ${i.disabledGetterAttr} ${i.disabledUidAttr} ${i.disabledAttr}><span>${a}</span></label>`}buildLabelInput(t){const e=t.action?`onchange="${t.action}"`:"",n=this.sb(t);return`\n            <div class="sn-tools-label-input${n.disabledClass}" ${n.disabledGetterAttr} ${n.disabledUidAttr} ${n.ariaDisabledAttr} title="${this.eb(t)}">\n                <label>${t.labelKey?this.mn(t.labelKey,t.text||t.label||""):this.Xv(t.text||t.label||"")}</label>\n                <input type="text" data-field="${t.id}" ${e} ${n.disabledAttr}>\n            </div>`}buildMenuHTML(t){if("border"===t)return this.buildBorderMenuHTML();if("condFormat"===t)return this.buildCondFormatMenuHTML();if("shapes"===t)return this.buildShapesMenuHTML();if("tableStyles"===t)return this.buildTableStylesMenuHTML();if("formatAsTable"===t)return this.buildFormatAsTableMenuHTML();if("cellStyles"===t)return this.buildCellStylesMenuHTML();if("highlight"===t)return this.buildHighlightMenuHTML();if("rowCol"===t)return this.buildRowColMenuHTML();if(__[t])return this.buildChartMenuHTML(t);const e=this.menuConfig[t];if(!e)return"";const n=e.map(t=>{if("divider"===t.type)return'<li class="sn-dropdown-divider"></li>';const e=t.style?`style="${t.style}"`:"",n=t.extraKey?this.mn(t.extraKey,t.extra||""):t.extra?this.tb(t.extra):"",i=n?`<span class="sn-float-end sn-color-999">${n}</span>`:"",r=t.icon?cn(t.icon):"",o=t.labelKey?this.mn(t.labelKey,t.text||t.label||""):this.tb(t.text||t.label);return`<li onclick="${t.action}" ${e} data-value="${o}">${r}<span>${o}</span>${i}</li>`}).join("");return this.Yv(n)}buildRowColMenuHTML(){const t=this.ns,e=`\n            <ul class="sn-dropdown-submenu sn-rowcol-submenu">\n                <li class="sn-rowcol-insert-item" onclick="${t}.Action.applyRowColInsertByPos(event, 'above')">\n                    <span>在上方插入</span>\n                    <input type="number" data-field="rowcol-insert-count" min="1" max="10000" value="1"\n                        onclick="event.stopPropagation()" onmousedown="event.stopPropagation()">\n                    <span>行</span>\n                </li>\n                <li class="sn-rowcol-insert-item" onclick="${t}.Action.applyRowColInsertByPos(event, 'below')">\n                    <span>在下方插入</span>\n                    <input type="number" data-field="rowcol-insert-count" min="1" max="10000" value="1"\n                        onclick="event.stopPropagation()" onmousedown="event.stopPropagation()">\n                    <span>行</span>\n                </li>\n                <li class="sn-rowcol-insert-item" onclick="${t}.Action.applyRowColInsertByPos(event, 'left')">\n                    <span>在左侧插入</span>\n                    <input type="number" data-field="rowcol-insert-count" min="1" max="10000" value="1"\n                        onclick="event.stopPropagation()" onmousedown="event.stopPropagation()">\n                    <span>列</span>\n                </li>\n                <li class="sn-rowcol-insert-item" onclick="${t}.Action.applyRowColInsertByPos(event, 'right')">\n                    <span>在右侧插入</span>\n                    <input type="number" data-field="rowcol-insert-count" min="1" max="10000" value="1"\n                        onclick="event.stopPropagation()" onmousedown="event.stopPropagation()">\n                    <span>列</span>\n                </li>\n            </ul>\n        `;return this.Yv(`\n            <li onclick="${t}.Action.setRowHeightDialog()" data-value="设置行高"><span>设置行高</span></li>\n            <li onclick="${t}.Action.autoFitRowHeight()" data-value="最合适的行高"><span>最合适的行高</span></li>\n            <li onclick="${t}.Action.setDefaultRowHeightDialog()" data-value="默认行高"><span>默认行高</span></li>\n            <li class="sn-dropdown-divider"></li>\n            <li onclick="${t}.Action.setColWidthDialog()" data-value="设置列宽"><span>设置列宽</span></li>\n            <li onclick="${t}.Action.autoFitColWidth()" data-value="最合适的列宽"><span>最合适的列宽</span></li>\n            <li onclick="${t}.Action.setDefaultColWidthDialog()" data-value="默认列宽"><span>默认列宽</span></li>\n            <li class="sn-dropdown-divider"></li>\n            <li class="sn-has-submenu">\n                <span>插入行列</span>\n                ${e}\n            </li>\n            <li class="sn-dropdown-divider"></li>\n            <li onclick="${t}.Action.deleteRowAction()" data-value="删除行"><span>删除行</span></li>\n            <li onclick="${t}.Action.deleteColAction()" data-value="删除列"><span>删除列</span></li>\n            <li class="sn-dropdown-divider"></li>\n            <li class="sn-has-submenu">\n                <span>隐藏和取消隐藏</span>\n                <ul class="sn-dropdown-submenu">\n                    <li onclick="${t}.Action.hideRowAction()" data-value="隐藏行"><span>隐藏行</span></li>\n                    <li onclick="${t}.Action.hideColAction()" data-value="隐藏列"><span>隐藏列</span></li>\n                    <li onclick="${t}.Action.unhideRowAction()" data-value="取消隐藏行"><span>取消隐藏行</span></li>\n                    <li onclick="${t}.Action.unhideColAction()" data-value="取消隐藏列"><span>取消隐藏列</span></li>\n                    <li class="sn-dropdown-divider"></li>\n                    <li onclick="${t}.Action.unhideAllRowsAction()" data-value="取消隐藏所有行"><span>取消隐藏所有行</span></li>\n                    <li onclick="${t}.Action.unhideAllColsAction()" data-value="取消隐藏所有列"><span>取消隐藏所有列</span></li>\n                </ul>\n            </li>\n        `)}buildChartMenuHTML(t){const e=__[t],n=I_(this.SN).find(t=>t.key===e);return n?n.items.map(t=>{const e=t.text||t.label||this.Qv(t.key);return`<li class="sn-chart-menu-item" onclick="${this.ns}.Action.insertChart('${t.key}')" data-value="${e}" title="${e}">\n                <span class="sn-chart-menu-label">${e}</span>\n                <div class="sn-chart-menu-preview">${wI(t.key)}</div>\n            </li>`}).join(""):""}buildCondFormatMenuHTML(){const t=`${this.ns}.Action.condFormat`,e=[{labelKey:"action.condFormat.menu.highlightRules.greaterThan",action:`${t}('cellIs','greaterThan')`},{labelKey:"action.condFormat.menu.highlightRules.lessThan",action:`${t}('cellIs','lessThan')`},{labelKey:"action.condFormat.menu.highlightRules.between",action:`${t}('cellIs','between')`},{labelKey:"action.condFormat.menu.highlightRules.equalTo",action:`${t}('cellIs','equal')`},{labelKey:"action.condFormat.menu.highlightRules.containsText",action:`${t}('containsText')`},{labelKey:"action.condFormat.menu.highlightRules.dateOccurring",action:`${t}('timePeriod')`},{labelKey:"action.condFormat.menu.highlightRules.duplicateValues",action:`${t}('duplicateValues')`}],n=[{labelKey:"action.condFormat.menu.topRules.top10Items",action:`${t}('top10','top')`},{labelKey:"action.condFormat.menu.topRules.bottom10Items",action:`${t}('top10','bottom')`},{labelKey:"action.condFormat.menu.topRules.top10Percent",action:`${t}('top10','topPercent')`},{labelKey:"action.condFormat.menu.topRules.bottom10Percent",action:`${t}('top10','bottomPercent')`},{labelKey:"action.condFormat.menu.topRules.aboveAverage",action:`${t}('aboveAverage','above')`},{labelKey:"action.condFormat.menu.topRules.belowAverage",action:`${t}('aboveAverage','below')`}],i={Direction:"action.condFormat.menu.iconSetCategory.direction",Shapes:"action.condFormat.menu.iconSetCategory.shapes",Indicators:"action.condFormat.menu.iconSetCategory.indicators",Rating:"action.condFormat.menu.iconSetCategory.rating"},r=t=>t.map(t=>`<li onclick="${t.action}"><span>${this.mn(t.labelKey)}</span></li>`).join(""),o=(e,n)=>{const i=n?"gradient":"solid";return`<div class="sn-cf-databar-grid">${e.map(e=>`<div class="sn-cf-databar-item" onclick="${t}('dataBar','${i}','${e.color}')" title="${this.Xv(e.text)}">\n                    <div class="sn-cf-databar-preview" style="background:${n?`linear-gradient(to right, ${e.color}, ${e.color}00)`:e.color}"></div>\n                </div>`).join("")}</div>`},a=(e,n)=>{const r=window.devicePixelRatio||1,o=Math.round(16*r),a=i[e];return`<div class="sn-cf-iconset-category">\n                <div class="sn-cf-iconset-label">${a?this.mn(a,e):e}</div>\n                <div class="sn-cf-iconset-grid">${n.map(e=>{const n=Oe[e.name];if(!n)return"";const i=[...n.icons].reverse().map(t=>`<img src="${JI(t,o).toDataURL()}">`).join("");return`<div class="sn-cf-iconset-item" onclick="${t}('iconSet','${e.name}')" title="${this.Xv(e.text)}">\n                        <div class="sn-cf-iconset-preview">${i}</div>\n                    </div>`}).join("")}</div>\n            </div>`};return this.Yv(`\n            <li class="sn-has-submenu"><span>${this.mn("action.condFormat.menu.group.highlightCellRules")}</span><i class="sn-arrow-right"></i>\n                <ul class="sn-dropdown-submenu">${r(e)}</ul>\n            </li>\n            <li class="sn-has-submenu"><span>${this.mn("action.condFormat.menu.group.topBottomRules")}</span><i class="sn-arrow-right"></i>\n                <ul class="sn-dropdown-submenu">${r(n)}</ul>\n            </li>\n            <li class="sn-dropdown-divider"></li>\n            <li class="sn-has-submenu"><span>${this.mn("action.condFormat.menu.group.dataBar")}</span><i class="sn-arrow-right"></i>\n                <ul class="sn-dropdown-submenu sn-cf-submenu" style="width:200px">\n                    <li class="sn-cf-section-title">${this.mn("action.condFormat.menu.section.gradientFill")}</li>\n                    ${o([{color:"#638EC6",text:"Blue"},{color:"#63C384",text:"Green"},{color:"#FF555A",text:"Red"},{color:"#FFB628",text:"Orange"},{color:"#8FAADC",text:"Light Blue"},{color:"#C6EFCE",text:"Light Green"}],!0)}\n                    <li class="sn-cf-section-title">${this.mn("action.condFormat.menu.section.solidFill")}</li>\n                    ${o([{color:"#638EC6",text:"Blue"},{color:"#63C384",text:"Green"},{color:"#FF555A",text:"Red"},{color:"#FFB628",text:"Orange"},{color:"#8FAADC",text:"Light Blue"},{color:"#C6EFCE",text:"Light Green"}],!1)}\n                    <li class="sn-dropdown-divider"></li>\n                    <li onclick="${t}('dataBar','custom')"><span>${this.mn("action.condFormat.menu.item.moreRules")}</span></li>\n                </ul>\n            </li>\n            <li class="sn-has-submenu"><span>${this.mn("action.condFormat.menu.group.colorScale")}</span><i class="sn-arrow-right"></i>\n                <ul class="sn-dropdown-submenu sn-cf-submenu" style="width:220px">\n                    ${(()=>`<div class="sn-cf-colorscale-grid">${[{colors:["#F8696B","#63BE7B"],text:"Red-Green"},{colors:["#63BE7B","#F8696B"],text:"Green-Red"},{colors:["#F8696B","#FCFCFF"],text:"Red-White"},{colors:["#FCFCFF","#F8696B"],text:"White-Red"},{colors:["#63BE7B","#FCFCFF"],text:"Green-White"},{colors:["#FCFCFF","#63BE7B"],text:"White-Green"},{colors:["#5A8AC6","#FCFCFF"],text:"Blue-White"},{colors:["#FCFCFF","#5A8AC6"],text:"White-Blue"},{colors:["#F8696B","#FFEB84","#63BE7B"],text:"Red-Yellow-Green"},{colors:["#63BE7B","#FFEB84","#F8696B"],text:"Green-Yellow-Red"},{colors:["#5A8AC6","#FCFCFF","#F8696B"],text:"Blue-White-Red"},{colors:["#F8696B","#FCFCFF","#5A8AC6"],text:"Red-White-Blue"}].map((e,n)=>{const i=2===e.colors.length?`linear-gradient(to right, ${e.colors[0]}, ${e.colors[1]})`:`linear-gradient(to right, ${e.colors[0]}, ${e.colors[1]}, ${e.colors[2]})`;return`<div class="sn-cf-colorscale-item" onclick="${t}('colorScale',${JSON.stringify(e.colors).replace(/"/g,"'")})" title="${this.Xv(e.text)}">\n                    <div class="sn-cf-colorscale-preview" style="background:${i}"></div>\n                </div>`}).join("")}</div>`)()}\n                    <li class="sn-dropdown-divider"></li>\n                    <li onclick="${t}('colorScale','custom')"><span>${this.mn("action.condFormat.menu.item.moreRules")}</span></li>\n                </ul>\n            </li>\n            <li class="sn-has-submenu"><span>${this.mn("action.condFormat.menu.group.iconSet")}</span><i class="sn-arrow-right"></i>\n                <ul class="sn-dropdown-submenu sn-cf-submenu sn-cf-iconset-menu" style="width:240px">\n                    ${Object.entries({Direction:[{name:"3Arrows",text:"3 Arrows"},{name:"3ArrowsGray",text:"3 Arrows (Gray)"},{name:"3Triangles",text:"3 Triangles"},{name:"4Arrows",text:"4 Arrows"},{name:"4ArrowsGray",text:"4 Arrows (Gray)"},{name:"5Arrows",text:"5 Arrows"},{name:"5ArrowsGray",text:"5 Arrows (Gray)"}],Shapes:[{name:"3TrafficLights1",text:"Traffic Lights"},{name:"3TrafficLights2",text:"Traffic Lights (Rimmed)"},{name:"4TrafficLights",text:"4 Traffic Lights"},{name:"3Signs",text:"3 Signs"},{name:"4RedToBlack",text:"Red to Black"}],Indicators:[{name:"3Symbols",text:"3 Symbols"},{name:"3Symbols2",text:"3 Circled Symbols"},{name:"3Flags",text:"3 Flags"}],Rating:[{name:"3Stars",text:"3 Stars"},{name:"4Rating",text:"4 Ratings"},{name:"5Rating",text:"5 Ratings"},{name:"5Quarters",text:"5 Pies"},{name:"5Boxes",text:"5 Boxes"}]}).map(([t,e])=>a(t,e)).join("")}\n                    <li class="sn-dropdown-divider"></li>\n                    <li onclick="${t}('iconSet','custom')"><span>${this.mn("action.condFormat.menu.item.moreRules")}</span></li>\n                </ul>\n            </li>\n            <li class="sn-dropdown-divider"></li>\n            <li onclick="${t}('newRule')"><span>${this.mn("action.condFormat.menu.item.newRule")}</span></li>\n            <li class="sn-has-submenu"><span>${this.mn("action.condFormat.menu.group.clearRules")}</span><i class="sn-arrow-right"></i>\n                <ul class="sn-dropdown-submenu" style="width:180px">\n                    <li onclick="${t}('clearSelection')"><span>${this.mn("action.condFormat.menu.item.clearSelection")}</span></li>\n                    <li onclick="${t}('clearSheet')"><span>${this.mn("action.condFormat.menu.item.clearSheet")}</span></li>\n                </ul>\n            </li>\n            <li onclick="${t}('manage')"><span>${this.mn("action.condFormat.menu.item.manageRules")}</span></li>\n        `)}buildBorderMenuHTML(){const t=this.ns,e=[{key:"none",action:`${t}.Action.applyBorderPreset('none')`},{key:"all",action:`${t}.Action.applyBorderPreset('all')`},{key:"outer",action:`${t}.Action.applyBorderPreset('outer')`},{key:"inner",action:`${t}.Action.applyBorderPreset('inner')`},{key:"left",action:`${t}.Action.applyBorderPreset('left')`},{key:"top",action:`${t}.Action.applyBorderPreset('top')`},{key:"right",action:`${t}.Action.applyBorderPreset('right')`},{key:"bottom",action:`${t}.Action.applyBorderPreset('bottom')`},{key:"diagonalDown",action:`${t}.Action.applyBorderPreset('diagonalDown')`},{key:"diagonalUp",action:`${t}.Action.applyBorderPreset('diagonalUp')`}].map(t=>{const e=A_[t.key]||{},n=e.labelKey?this.mn(e.labelKey):this.Qv(t.key);return`<div class="sn-border-pos-item" onclick="${t.action}" title="${n}">${N_(t.key,22)}</div>`}).join(""),n=["hair","dotted","dashDotDot","dashDot","slantDashDot","dashed","thin","mediumDashDotDot","mediumDashDot","mediumDashed","medium","double","thick"].map(e=>`<li class="sn-border-style-item" onclick="${t}.Action.applyBorderStyle('${e}')">${function(t,e=80,n=20){const i=M_[t];if(!i)return"";const r=n/2;return i.double?`<svg class="sn-svg" width="${e}" height="${n}"><line x1="4" y1="${r-2}" x2="${e-4}" y2="${r-2}" stroke="currentColor" stroke-width="1"/><line x1="4" y1="${r+2}" x2="${e-4}" y2="${r+2}" stroke="currentColor" stroke-width="1"/></svg>`:`<svg class="sn-svg" width="${e}" height="${n}"><line x1="4" y1="${r}" x2="${e-4}" y2="${r}" stroke="currentColor" stroke-width="${i.width}" stroke-dasharray="${i.dash}"/></svg>`}(e,100,18)}</li>`).join("");return this.Yv(`\n            <div class="sn-border-pos-wrap"><div class="sn-border-pos-grid">${e}</div></div>\n            <li class="sn-dropdown-divider"></li>\n            <li class="sn-has-submenu"><span>${this.mn("action.style.border.menu.color")}</span><i class="sn-arrow-right"></i>\n                <ul style="width:220px;" class="sn-dropdown-submenu sn-border-color-submenu"><div class="sn-color-select" onclick="${t}.Action.borderColorBtn(event)"></div></ul>\n            </li>\n            <li class="sn-has-submenu"><span>${this.mn("action.style.border.menu.style")}</span><i class="sn-arrow-right"></i>\n                <ul style="width:120px;min-width:120px" class="sn-dropdown-submenu sn-border-style-submenu">${n}</ul>\n            </li>\n        `)}buildShapesMenuHTML(){const t=this.ns,e={"line":{shapeType:"line",arrows:"none"},"lineArrowEnd":{shapeType:"straightConnector1",arrows:"end"},"lineArrowBoth":{shapeType:"straightConnector1",arrows:"both"},"bentConnector3":{shapeType:"bentConnector3",arrows:"none"},"bentConnector4":{shapeType:"bentConnector3",arrows:"end"},"bentConnector5":{shapeType:"bentConnector3",arrows:"both"},"curvedConnector3":{shapeType:"curvedConnector3",arrows:"none"},"curvedConnector4":{shapeType:"curvedConnector3",arrows:"end"},"curvedConnector5":{shapeType:"curvedConnector3",arrows:"both"}},n={line:"直线",lineArrowEnd:"箭头",lineArrowBoth:"双箭头",bentConnector3:"肘形连接符",bentConnector4:"肘形箭头连接符",bentConnector5:"肘形双箭头连接符",curvedConnector3:"曲线连接符",curvedConnector4:"曲线箭头连接符",curvedConnector5:"曲线双箭头连接符",rect:"矩形",roundRect:"圆角矩形",round1Rect:"单圆角矩形",round2SameRect:"同侧圆角矩形",round2DiagRect:"对角圆角矩形",snip1Rect:"剪去单角矩形",snip2SameRect:"剪去同侧角矩形",snip2DiagRect:"剪去对角矩形",snipRoundRect:"剪去圆角矩形",ellipse:"椭圆",triangle:"等腰三角形",rtTriangle:"直角三角形",parallelogram:"平行四边形",trapezoid:"梯形",diamond:"菱形",pentagon:"五边形",hexagon:"六边形",heptagon:"七边形",octagon:"八边形",decagon:"十边形",dodecagon:"十二边形",pie:"饼形",chord:"弦形",teardrop:"泪滴形",frame:"框架",halfFrame:"半框",corner:"L形",diagStripe:"斜纹",plus:"十字形",plaque:"缺角矩形",can:"圆柱形",cube:"立方体",bevel:"棱台",donut:"圆环",noSmoking:"禁止符",blockArc:"空心弧",foldedCorner:"折角形",smileyFace:"笑脸",heart:"心形",lightningBolt:"闪电形",sun:"太阳形",moon:"月亮形",cloud:"云形",arc:"弧形",bracketPair:"双括号",bracePair:"大括号",leftBracket:"左中括号",rightBracket:"右中括号",leftBrace:"左大括号",rightBrace:"右大括号",rightArrow:"右箭头",leftArrow:"左箭头",upArrow:"上箭头",downArrow:"下箭头",leftRightArrow:"左右箭头",upDownArrow:"上下箭头",quadArrow:"四向箭头",leftRightUpArrow:"丁字箭头",bentArrow:"直角箭头",uturnArrow:"U形箭头",leftUpArrow:"左上箭头",bentUpArrow:"直角上箭头",curvedRightArrow:"右弯箭头",curvedLeftArrow:"左弯箭头",curvedUpArrow:"上弯箭头",curvedDownArrow:"下弯箭头",stripedRightArrow:"虚尾箭头",notchedRightArrow:"燕尾箭头",homePlate:"五边箭头",chevron:"V形箭头",rightArrowCallout:"右箭头标注",leftArrowCallout:"左箭头标注",upArrowCallout:"上箭头标注",downArrowCallout:"下箭头标注",leftRightArrowCallout:"左右箭头标注",quadArrowCallout:"四向箭头标注",circularArrow:"环形箭头",mathPlus:"加号",mathMinus:"减号",mathMultiply:"乘号",mathDivide:"除号",mathEqual:"等号",mathNotEqual:"不等号",flowChartProcess:"过程",flowChartAlternateProcess:"可选过程",flowChartDecision:"决策",flowChartInputOutput:"数据",flowChartPredefinedProcess:"预定义过程",flowChartInternalStorage:"内部存储",flowChartDocument:"文档",flowChartMultidocument:"多文档",flowChartTerminator:"终止",flowChartPreparation:"准备",flowChartManualInput:"手动输入",flowChartManualOperation:"手动操作",flowChartConnector:"接点",flowChartOffpageConnector:"离页连接符",flowChartPunchedCard:"卡片",flowChartPunchedTape:"纸带",flowChartSummingJunction:"汇总连接",flowChartOr:"或",flowChartCollate:"整理",flowChartSort:"排序",flowChartExtract:"摘录",flowChartMerge:"合并",flowChartOnlineStorage:"存储数据",flowChartDelay:"延期",flowChartMagneticTape:"磁带",flowChartMagneticDisk:"磁盘",flowChartMagneticDrum:"直接访问存储器",flowChartDisplay:"显示",irregularSeal1:"爆炸形1",irregularSeal2:"爆炸形2",star4:"四角星",star5:"五角星",star6:"六角星",star7:"七角星",star8:"八角星",star10:"十角星",star12:"十二角星",star16:"十六角星",star24:"二十四角星",star32:"三十二角星",ribbon:"前凸带形",ribbon2:"上凸带形",ellipseRibbon:"上凸弯带形",ellipseRibbon2:"下凸弯带形",verticalScroll:"竖卷形",horizontalScroll:"横卷形",wave:"波形",doubleWave:"双波形",wedgeRectCallout:"矩形标注",wedgeRoundRectCallout:"圆角矩形标注",wedgeEllipseCallout:"椭圆形标注",cloudCallout:"云形标注",callout1:"线形标注1",callout2:"线形标注2",callout3:"线形标注3",borderCallout1:"线形标注1(带边框)",borderCallout2:"线形标注2(带边框)",borderCallout3:"线形标注3(带边框)",accentCallout1:"线形标注1(强调线)",accentCallout2:"线形标注2(强调线)",accentCallout3:"线形标注3(强调线)",accentBorderCallout1:"线形标注1(带强调边框)",accentBorderCallout2:"线形标注2(带强调边框)",accentBorderCallout3:"线形标注3(带强调边框)"},i=i=>{const r=k_[i];if(!r)return"";const o=this.tb(n[i]||i,this.Qv(i)),a=e[i];let s;if(a){const e="none"!==a.arrows?`,{arrows:'${a.arrows}'}`:"";s=`${t}.activeSheet.Drawing.addShape('${a.shapeType}'${e});${t}._r()`}else s=`${t}.activeSheet.Drawing.addShape('${i}');${t}._r()`;return`<div class="sn-shape-item" onclick="${s}" title="${o}">\n                <svg viewBox="0 0 22 22" width="24" height="24" fill="none" stroke="currentColor" stroke-width="1">${r}</svg>\n            </div>`},r=["Lines","Rectangles","Basic Shapes","Block Arrows","Equation Shapes","Flowchart","Stars and Banners","Callouts"],o=(t,e)=>{const n=t.shapes.filter(t=>k_[t]).map(i).join("");return n?`<div class="sn-shape-category">\n                <div class="sn-shape-category-title">${this.tb(t.name,r[e]||this.Qv(t.name))}</div>\n                <div class="sn-shape-grid">${n}</div>\n            </div>`:""};return this.Yv(`<div class="sn-shapes-menu">${[{name:"线条",shapes:["line","lineArrowEnd","lineArrowBoth","bentConnector3","bentConnector4","bentConnector5","curvedConnector3","curvedConnector4","curvedConnector5"]},{name:"矩形",shapes:["rect","roundRect","snip1Rect","snip2SameRect","snip2DiagRect","snipRoundRect","round1Rect","round2SameRect","round2DiagRect"]},{name:"基本形状",shapes:["ellipse","triangle","rtTriangle","parallelogram","trapezoid","diamond","pentagon","hexagon","heptagon","octagon","decagon","dodecagon","pie","chord","teardrop","frame","halfFrame","corner","diagStripe","plus","plaque","can","cube","bevel","donut","noSmoking","blockArc","foldedCorner","smileyFace","heart","lightningBolt","sun","moon","cloud","arc","bracketPair","bracePair","leftBracket","rightBracket","leftBrace","rightBrace"]},{name:"箭头总汇",shapes:["rightArrow","leftArrow","upArrow","downArrow","leftRightArrow","upDownArrow","quadArrow","leftRightUpArrow","bentArrow","uturnArrow","leftUpArrow","bentUpArrow","curvedRightArrow","curvedLeftArrow","curvedUpArrow","curvedDownArrow","stripedRightArrow","notchedRightArrow","homePlate","chevron","rightArrowCallout","downArrowCallout","leftArrowCallout","upArrowCallout","leftRightArrowCallout","quadArrowCallout","circularArrow"]},{name:"公式形状",shapes:["mathPlus","mathMinus","mathMultiply","mathDivide","mathEqual","mathNotEqual"]},{name:"流程图",shapes:["flowChartProcess","flowChartAlternateProcess","flowChartDecision","flowChartInputOutput","flowChartPredefinedProcess","flowChartInternalStorage","flowChartDocument","flowChartMultidocument","flowChartTerminator","flowChartPreparation","flowChartManualInput","flowChartManualOperation","flowChartConnector","flowChartOffpageConnector","flowChartPunchedCard","flowChartPunchedTape","flowChartSummingJunction","flowChartOr","flowChartCollate","flowChartSort","flowChartExtract","flowChartMerge","flowChartOnlineStorage","flowChartDelay","flowChartMagneticTape","flowChartMagneticDisk","flowChartMagneticDrum","flowChartDisplay"]},{name:"星与旗帜",shapes:["irregularSeal1","irregularSeal2","star4","star5","star6","star7","star8","star10","star12","star16","star24","star32","ribbon2","ribbon","ellipseRibbon2","ellipseRibbon","verticalScroll","horizontalScroll","wave","doubleWave"]},{name:"标注",shapes:["wedgeRectCallout","wedgeRoundRectCallout","wedgeEllipseCallout","cloudCallout","callout1","callout2","callout3","borderCallout1","borderCallout2","borderCallout3","accentCallout1","accentCallout2","accentCallout3","accentBorderCallout1","accentBorderCallout2","accentBorderCallout3"]}].map((t,e)=>o(t,e)).join("")}</div>`)}buildTableStylesMenuHTML(){const t=this.ns,e=e=>{const n=j(e,this.SN);return n?`\n                <div class="sn-table-style-item" onclick="${t}.Action.changeTableStyle('${e}')" title="${e}">\n                    <div class="sn-table-style-preview">\n                        <div class="sn-table-style-row header" style="background:${n.header};border-color:${n.border}"></div>\n                        <div class="sn-table-style-row" style="background:${n.stripe1};border-color:${n.border}"></div>\n                        <div class="sn-table-style-row stripe" style="background:${n.stripe2};border-color:${n.border}"></div>\n                        <div class="sn-table-style-row" style="background:${n.stripe1};border-color:${n.border}"></div>\n                    </div>\n                </div>`:""},n=(t,n,i="")=>{const r=n.map(e).join("");return`\n                <div class="sn-table-style-group">\n                    <div class="sn-table-style-group-title">${this.tb(t,i)}</div>\n                    <div class="sn-table-style-grid">${r}</div>\n                </div>`};return this.Yv(`\n            <div class="sn-table-styles-menu sn-scrollbar">\n                ${n("浅色",W.light,"Light")}\n                ${n("中等深浅",W.medium,"Medium")}\n                ${n("深色",W.dark,"Dark")}\n                <li class="sn-dropdown-divider"></li>\n                <li onclick="${t}.Action.clearTableStyle()"><span>清除表格样式</span></li>\n            </div>`)}buildFormatAsTableMenuHTML(){const t=this.ns,e=e=>{const n=j(e,this.SN);return n?`\n                <div class="sn-table-style-item" onclick="${t}.Action.formatAsTable('${e}')" title="${e}">\n                    <div class="sn-table-style-preview">\n                        <div class="sn-table-style-row header" style="background:${n.header};border-color:${n.border}"></div>\n                        <div class="sn-table-style-row" style="background:${n.stripe1};border-color:${n.border}"></div>\n                        <div class="sn-table-style-row stripe" style="background:${n.stripe2};border-color:${n.border}"></div>\n                        <div class="sn-table-style-row" style="background:${n.stripe1};border-color:${n.border}"></div>\n                    </div>\n                </div>`:""},n=(t,n,i="")=>`\n            <div class="sn-table-style-group">\n                <div class="sn-table-style-group-title">${this.tb(t,i)}</div>\n                <div class="sn-table-style-grid">${n.map(e).join("")}</div>\n            </div>`;return this.Yv(`\n            <div class="sn-table-styles-menu sn-scrollbar">\n                ${n("浅色",W.light,"Light")}\n                ${n("中等深浅",W.medium,"Medium")}\n                ${n("深色",W.dark,"Dark")}\n                <li class="sn-dropdown-divider"></li>\n                <li onclick="${t}.Action.clearTableStyle()"><span>清除表格样式</span></li>\n            </div>`)}buildCellStylesMenuHTML(){const t=this.ns,e=e=>{const n=e.fill?.fgColor||"#FFFFFF",i=e.font?.color||"#000000",r=e.font?.bold?"font-weight:bold;":"",o=e.font?.italic?"font-style:italic;":"",a=e.font?.size?`font-size:${Math.min(e.font.size,11)}px;`:"",s=e.border?`border:1px solid ${e.border.color||"#ccc"};`:"",l=e.labelKey?this.mn(e.labelKey):this.Qv(e.name);return`\n                <div class="sn-cell-style-item" onclick="${t}.Action.applyCellStyle('${e.name}')" title="${l}">\n                    <div class="sn-cell-style-preview" style="background:${n};color:${i};${r}${o}${a}${s}">\n                        ${e.numFmt?"123":"Aa"}\n                    </div>\n                    <div class="sn-cell-style-label">${l}</div>\n                </div>`},n=(t,n)=>{if(!n?.length)return"";const i=II[t]||{};return`\n                <div class="sn-cell-style-group">\n                    <div class="sn-cell-style-group-title">${i.labelKey?this.mn(i.labelKey):this.Qv(t)}</div>\n                    <div class="sn-cell-style-grid">${n.map(e).join("")}</div>\n                </div>`},i=Object.entries(FI).map(([t,e])=>n(t,e)).join("");return this.Yv(`<div class="sn-cell-styles-menu sn-scrollbar">${i}</div>`)}buildHighlightMenuHTML(){const t=this.ns,e=["rgba(255,254,254,0.45)","rgba(255,255,204,0.45)","rgba(204,255,211,0.45)","rgba(230,233,255,0.45)","rgba(255,242,227,0.45)","rgba(224,252,255,0.45)","rgba(255,242,255,0.45)","rgba(221,221,221,0.45)","rgba(255,186,187,0.45)","rgba(255,253,186,0.45)","rgba(169,255,182,0.45)","rgba(214,215,255,0.45)","rgba(255,229,201,0.45)","rgba(193,249,255,0.45)","rgba(255,213,255,0.45)"],n=t=>`<span class="sn-hl-btn" data-color="${t}" style="background:${t.replace(",0.45)",",1)")}"></span>`;return this.Yv(`\n            <div class="sn-highlight-panel" onclick="${t}.Canvas.setHighlight(event)">\n                <div class="sn-hl-row">\n                    <span class="sn-hl-btn sn-hl-off" data-color="" title="${this.tb("Turn Off Highlight","Turn Off Highlight")}">✕</span>\n                    ${e.slice(0,7).map(n).join("")}\n                </div>\n                <div class="sn-hl-row">\n                    ${e.slice(7).map(n).join("")}\n                </div>\n            </div>`)}}let tF=null,eF="";function nF(t){return/^zh\b/i.test(t?.$?.locale||"")?"宋体":"Calibri"}let iF=null;function rF(t,e,n=t=>t){if("General"===t)return n("toolbar.numFmt.general");const i=function(t){if(iF)return iF;iF=new Map;const e=t?.numFmt;if(!Array.isArray(e))return iF;for(const n of e){if("divider"===n.type||!n.action)continue;const t=n.action.match(/areasNumFmt\(['"]([^'"]*)['"]\)/);if(t){const e=t[1];iF.set(e,n.labelKey||"")}}return iF}(e),r=i.get(t);if(r)return n(r);const o=t.replace(/￥/g,"¥").replace(/&quot;/g,'"');return n(i.get(o)||"toolbar.numFmt.custom")}function oF(t,e,n){const i=t.querySelector(".sn-tools");if(!i)return;let r,o;e.$?.Canvas?.inputEditing&&!e.isFormula?(r=NI(e.$.Canvas.input,e.font)||{},o=r):(r=e.style?.font||{},o=e.font||{});const a=e.style?.alignment||{},s=e.fill||{},l=e.numFmt||"General",c=e.$?.toolbarDefaults?.font,h=e.$?.toolbarDefaults?.fill,u={fontName:r.name||nF(e),fontSize:r.size||11,numFmt:rF(l,n,t=>e.$.t(t)),fontColor:o.color||c||"#FF0000",fillColor:s.fgColor||h||"#FFFF00",bold:!!r.bold,italic:!!r.italic,underline:r.underline||"",strike:!!r.strike,hAlign:a.horizontal||"",vAlign:a.vertical||""},d=JSON.stringify(u);if(d===eF)return;const f=[];for(const p in u)tF&&u[p]===tF[p]||f.push(p);f.length>0&&function(t,e,n){for(const i of n)switch(i){case"fontName":{const n=t.querySelector('.sn-combobox[data-menu="fontName"] .sn-combobox-input');n&&(n.value=e.fontName,n.style.fontFamily=e.fontName);break}case"fontSize":{const n=t.querySelector('.sn-combobox[data-menu="fontSize"] .sn-combobox-input');n&&(n.value=e.fontSize);break}case"bold":{const n=t.querySelector('.sn-tools-item [data-icon="bold"]')?.closest(".sn-tools-item");n&&n.classList.toggle("sn-btn-selected",e.bold);break}case"italic":{const n=t.querySelector('.sn-tools-item [data-icon="italic"]')?.closest(".sn-tools-item");n&&n.classList.toggle("sn-btn-selected",e.italic);break}case"underline":{const n=t.querySelector('.sn-tools-item [data-icon="underline"]')?.closest(".sn-tools-item");n&&n.classList.toggle("sn-btn-selected",!!e.underline);break}case"strike":{const n=t.querySelector('.sn-tools-item [data-icon="strikethrough"]')?.closest(".sn-tools-item");n&&n.classList.toggle("sn-btn-selected",e.strike);break}case"fontColor":{t.style.setProperty("--sn-font-color",e.fontColor||"transparent");const n=t.querySelector('.sn-split-btn[data-color-type="font"]');n&&(e.fontColor?n.removeAttribute("data-color-empty"):n.setAttribute("data-color-empty","true"));break}case"fillColor":{t.style.setProperty("--sn-fill-color",e.fillColor||"transparent");const n=t.querySelector('.sn-split-btn[data-color-type="fill"]');n&&(e.fillColor?n.removeAttribute("data-color-empty"):n.setAttribute("data-color-empty","true"));break}case"hAlign":{const n={left:"alignLeft",center:"alignCenter",right:"alignRight"};for(const[i,r]of Object.entries(n)){const n=t.querySelector(`.sn-tools-item [data-icon="${r}"]`)?.closest(".sn-tools-item");n&&n.classList.toggle("sn-btn-selected",e.hAlign===i)}break}case"vAlign":{const n={top:"alignTop",center:"alignVertically",bottom:"alignBottom"};for(const[i,r]of Object.entries(n)){const n=t.querySelector(`.sn-tools-item [data-icon="${r}"]`)?.closest(".sn-tools-item");n&&n.classList.toggle("sn-btn-selected",e.vAlign===i)}break}case"numFmt":{const n=t.querySelector('.sn-combobox[data-menu="numFmt"] .sn-combobox-input');n&&(n.value=e.numFmt);break}}}(i,u,f),tF=u,eF=d}function aF(t,e){if(!t||!e?.SN)return;const n=t.querySelector(".sn-tools");n&&n.querySelectorAll('[data-disabled-getter="true"][data-disabled-uid]').forEach(t=>{const n=t.dataset.disabledUid;if(!n)return;const i=e.getToolbarItemByDisabledUid(n);if(!i||"function"!=typeof i.disabled)return;const r=!!i.disabled(e.SN);if(t.matches('input[type="checkbox"]')){t.disabled=r;const e=t.closest(".sn-tools-checkbox");return void(e&&(e.classList.toggle("sn-item-disabled",r),e.setAttribute("aria-disabled",r?"true":"false")))}if(t.classList.contains("sn-combobox")){const e=t.querySelector(".sn-combobox-input");e&&(e.disabled=r)}if(t.classList.contains("sn-tools-label-input")){const e=t.querySelector("input, select, textarea");e&&(e.disabled=r)}t.classList.toggle("sn-item-disabled",r),t.setAttribute("aria-disabled",r?"true":"false"),r&&(t.classList.remove("active"),t.querySelectorAll(".sn-dropdown.active").forEach(t=>{t.classList.remove("active")}))})}function sF(t,e,n){if(!t.length)return[];t.sort((t,n)=>t[e]-n[e]);const i=[{...t[0]}];for(let r=1;r<t.length;r++){const o=i[i.length-1],a=t[r];a[e]<=o[n]?o[n]=Math.max(o[n],a[n]):i.push({...a})}return i}function lF(t,e,n){const i=new Map;let r=e;return t.forEach(t=>{i.set(t,r),r+=n(t)}),{starts:i,end:r}}function cF(t,e,n){if(e>n)return!0;for(let i=e;i<=n;i++)if(!t.getRow(i).hidden)return!1;return!0}function hF(t,e,n){if(e>n)return!0;for(let i=e;i<=n;i++)if(!t.getCol(i).hidden)return!1;return!0}function uF(t,e,n,i,r,o,a){if(!Number.isFinite(e)||!n.length)return null;const s=n[0],l=n[n.length-1];if(e<=s)return e===s?r:"row"===a?cF(t,e,s-1)?r:null:hF(t,e,s-1)?r:null;for(const c of n)if(c>=e)return i.get(c)??null;return e===l+1?o:e>l+1?"row"===a?cF(t,l+1,e-1)?o:null:hF(t,l+1,e-1)?o:null:null}function dF(t,e,n){const i=t.location?.ref;if(!i)return!1;const r=function(t){const e=t.split(":"),n=fF(e[0]),i=e.length>1?fF(e[1]):n;return n&&i?{s:n,e:i}:null}(i);return!!r&&e>=r.s.r&&e<=r.e.r&&n>=r.s.c&&n<=r.e.c}function fF(t){const e=t.replace(/\$/g,"").match(/^([A-Z]+)(\d+)$/i);if(!e)return null;const n=e[1].toUpperCase(),i=parseInt(e[2],10)-1;let r=0;for(let o=0;o<n.length;o++)r=26*r+(n.charCodeAt(o)-64);return r-=1,{r:i,c:r}}function pF(t,e){const n=e||t.t("dataValidation.errors.inputRuleMismatch");return t.t(n)}function mF(...t){for(const e of t)if(void 0!==e)return e}function gF(t,e,n,i=1,r=1){const o=Math.max(1,i||1);return t%(o+Math.max(1,r||1))<o?e:n}function vF(t,e,n){if(!t.PivotTable||0===t.PivotTable.size)return null;for(const i of t.PivotTable.getAll()){const t=i.location?.ref;if(!t)continue;const r=t.split(":"),o=yF(r[0]),a=r.length>1?yF(r[1]):o;if(o&&a&&e>=o.r&&e<=a.r&&n>=o.c&&n<=a.c)return i}return null}function yF(t){const e=t.replace(/\$/g,"").match(/^([A-Z]+)(\d+)$/i);if(!e)return null;const n=e[1].toUpperCase(),i=parseInt(e[2],10)-1;let r=0;for(let o=0;o<n.length;o++)r=26*r+(n.charCodeAt(o)-64);return{r:i,c:r-1}}const bF=[],xF={"row-col-resize":function(t,e){const n=this.lazyDOM.dragLine,{mouseX:i,mouseY:r,sheet:o}=e,a=this.handleLayer;let s=this.getCellIndex(t);const l=o.getCellInViewInfo(s.r,s.c),c=r<o.headHeight;i<o.indexWidth&&Math.abs(l.y-r)<=5&&s.r>0?s.r=o.No(s.r,1):c&&Math.abs(l.x-i)<=5&&s.c>0&&(s.c=o.Fo(s.c,1));const h="ew-resize"===a.style.cursor,u=h?o.getCol(s.c).width:o.getRow(s.r).height;let d=null;const f=t=>{const{x:e,y:l}=this.getEventPosition(t),c=h?e-i:l-r,f=Math.max(c+u,3);Object.assign(n.style,{display:"block",cursor:a.style.cursor,width:h?"1px":`${this.width}px`,height:h?`${this.height}px`:"1px",transform:h?`translateX(${t.offsetX}px)`:`translateY(${t.offsetY}px)`}),d=()=>{h?o.getCol(s.c).width=f:o.getRow(s.r).height=f}};a.addEventListener("mousemove",f),window.addEventListener("mouseup",()=>{a.removeEventListener("mousemove",f),d?.(),d=null,a.style.cursor="default",n.style.display="none",this.disableMoveCheck=!1,this.r()},{once:!0})},"drawing":function(t,e){const{mouseX:n,mouseY:i,sheet:r}=e;let o=this.activeDrawing;o.active=!0;let a=n-o.position.x,s=i-o.position.y;const l=this.handleLayer,c=t=>{const{x:e,y:n}=this.getEventPosition(t);o?.position&&(o.position.x=e-a,o.position.y=n-s,o.position.x<r.indexWidth&&(o.position.x=r.indexWidth),o.position.y<r.headHeight&&(o.position.y=r.headHeight)),o.moving=!0,this.r("s")};l.addEventListener("mousemove",c),window.addEventListener("mouseup",()=>{if(l.removeEventListener("mousemove",c),o.moving){const{x:t,y:e,w:n,h:i}=o.position;o.startCell=this.getCellIndexByPosition(t,e);const a=r.getCellInViewInfo(o.startCell.r,o.startCell.c,!1);o.offsetX=t-a.x,o.offsetY=e-a.y,o.width=n,o.height=i,r.getCell(o.area.e.r,o.area.e.c)}o.moving=!1,this.disableMoveCheck=!1,bF.push(()=>o.active=!1),this.r()},{once:!0}),this.r("s")},"active-border":function(t,e){const n=this.handleLayer,{sheet:i}=e,r=this.activeSheet.activeAreas,o=e=>{const n=this.getCellIndex(e),i=UF.call(this,r,this.getCellIndex(t),n);(Object.keys(this.mpBorder).length<1||i.s.r!=this.mpBorder.s.r||i.s.c!=this.mpBorder.s.c)&&(this.mpBorder=i,this.r())};n.addEventListener("mousemove",o),n.addEventListener("mouseup",()=>{n.removeEventListener("mousemove",o),Object.keys(this.mpBorder).length>0&&!1!==i.moveArea(r[r.length-1],this.mpBorder)&&(i.activeAreas=[this.mpBorder]),this.mpBorder={},this.disableMoveCheck=!1,this.r()},{once:!0})},"fill-handle":function(t,e){const n=this.handleLayer,i=this.activeSheet,r=this.activeSheet.activeAreas,o=t=>{const e=VF.call(this,this.getCellIndex(t));e?(Object.keys(this.mpBorder).length<1||e.s.r!=this.mpBorder.s.r||e.s.c!=this.mpBorder.s.c||e.e.r!=this.mpBorder.e.r||e.e.c!=this.mpBorder.e.c)&&(this.mpBorder=e,this.r()):Object.keys(this.mpBorder).length>0&&(this.mpBorder={},this.r())};n.addEventListener("mousemove",o),n.addEventListener("mouseup",()=>{if(n.removeEventListener("mousemove",o),Object.keys(this.mpBorder).length>0){if(this.lastPadding={oArea:r[r.length-1],targetArea:this.mpBorder},!1===i.paddingArea())return this.mpBorder={},this.r(),void(this.disableMoveCheck=!1);i.activeAreas=[BF.call(this,this.mpBorder,r[r.length-1])],this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile();const t=i.activeAreas[i.activeAreas.length-1],e=i.getAreaInviewInfo(t);e.inView&&(this.paddingType.style.left=`${this.toPhysical(e.x+e.w)+5}px`,this.paddingType.style.top=`${this.toPhysical(e.y+e.h)+5}px`,this.paddingType.style.display="block",bF.push(()=>this.paddingType.style.display="none")),this.mpBorder={}}this.r(),this.disableMoveCheck=!1},{once:!0})},"d-left-top":function(t,e){RF.call(this,t,e,"left-top")},"d-right-top":function(t,e){RF.call(this,t,e,"right-top")},"d-left-bottom":function(t,e){RF.call(this,t,e,"left-bottom")},"d-right-bottom":function(t,e){RF.call(this,t,e,"right-bottom")},"d-left":function(t,e){RF.call(this,t,e,"left")},"d-right":function(t,e){RF.call(this,t,e,"right")},"d-top":function(t,e){RF.call(this,t,e,"top")},"d-bottom":function(t,e){RF.call(this,t,e,"bottom")},"d-rotate":function(t,e){const n=this.activeDrawing;n.active=!0;const i=n.position,r=i.x+i.w/2,o=i.y+i.h/2,{x:a,y:s}=this.getEventPosition(t),l=Math.atan2(a-r,-(s-o)),c=n.Fn||0,h=this.handleLayer;h.style.cursor="grabbing";const u=t=>{const{x:e,y:i}=this.getEventPosition(t),a=Math.atan2(e-r,-(i-o));let s=c+180*(a-l)/Math.PI;t.shiftKey&&(s=15*Math.round(s/15)),n.rotation=s,this.r("s")};h.addEventListener("mousemove",u),window.addEventListener("mouseup",()=>{h.removeEventListener("mousemove",u),h.style.cursor="default",this.disableMoveCheck=!1,bF.push(()=>n.active=!1),this.r("s")},{once:!0}),this.r("s")}};let wF=0;function SF(t){const e=performance.now();if(e-wF<20)return;if(wF=e,this.moveAreaName=null,this.disableMoveCheck)return;const n=this.activeSheet;if(n.mo.area)return this.handleLayer.style.cursor="cell";const{x:i,y:r}=this.getEventPosition(t),o=IF.call(this,i,r,t,n);if(o)return this.handleLayer.style.cursor=o;const a=HF.call(this,i,r);if(a)return this.handleLayer.style.cursor=a;const s=FF.call(this,i,r);if(s)return this.handleLayer.style.cursor=s;const l=this.getCellIndex(t),c=n.SN.Utils.cellNumToStr(l),h=n.Comment.get(c),u=n.getCell(l.r,l.c);if(u.hyperlink?.tooltip){const{x:t,y:e,w:i,h:r}=n.getCellInViewInfo(l.r,l.c);this.hyperlinkTip.textContent=u.hyperlink.tooltip,this.hyperlinkTip.style.left=`${this.toPhysical(t)}px`,this.hyperlinkTip.style.top=`${this.toPhysical(e+r)+2}px`,this.hyperlinkTip.style.display="block"}else this.hyperlinkTip.style.display="none";if(h)this.hoveredComment!==h&&(this.hoveredComment=h,this.r());else if(this.hoveredComment){const t=n.activeCell;if(t){const e=n.SN.Utils.cellNumToStr(t);if(n.Comment.get(e)===this.hoveredComment)return void(this.handleLayer.style.cursor="default")}this.hoveredComment=null,this.r()}this.handleLayer.style.cursor="default"}function CF(t){const{x:e,y:n}=this.getEventPosition(t),i=EF.call(this,e,n);if(i&&"shape"===i.type&&i.isTextBox&&!i.isConnector)return this.inputEditing&&this.updInputValue(),this.activeDrawing=i,i.active=!0,this.r("s"),void PF.call(this,i);zF.call(this,!0),this.showCellInput(!1,!0)}function TF(t){if(zF.call(this,!0),setTimeout(()=>this.input.focus()),bF.splice(0).forEach(t=>t()),2==t.button)return;const{left:e,top:n,width:i,height:r}=this.handleLayer.getBoundingClientRect(),o=this.activeSheet,a=this.toLogical(t.clientX-e),s=this.toLogical(t.clientY-n);if(this.disableMoveCheck=!0,this.moveAreaName)return xF[this.moveAreaName].call(this,t,{left:e,top:n,mouseX:a,mouseY:s,sheet:o});this.disableMoveCheck=!1;const l=this.getCellIndex(t);let c=o.getCell(l.r,l.c);c.master&&(c=o.getCell(c.master.r,c.master.c));const h=c?.row?.rIndex??l.r,u=c?.cIndex??l.c,d=vF(o,h,u);if(d){const e=d.getRowToggleInfo(h,u),n=c?.Vs;if(e?.hasToggle&&n&&a>=n.x&&a<=n.x+n.w&&s>=n.y&&s<=n.y+n.h){const n=o.getCell(l.r,l.c);return o.activeCell={c:n.master?.c??l.c,r:n.master?.r??l.r},t.ctrlKey?o.activeAreas.push({s:{c:l.c,r:l.r},e:{c:l.c,r:l.r}}):o.activeAreas=[],d.toggleRowCollapsed(e.level,e.values),void d.render()}}if(c.hyperlink){const{x:t,y:e,w:n,h:i}=o.getCellInViewInfo(l.r,l.c);this.hyperlinkJumpBtn.style.top=this.toPhysical(e)-2+"px",this.hyperlinkJumpBtn.style.left=`${this.toPhysical(n+t)+5}px`,this.hyperlinkJumpBtn.style.display="block",bF.push(()=>this.hyperlinkJumpBtn.style.display="none")}if(c?._){const{x:t,y:e,w:n,h:i}=o.getCellInViewInfo(l.r,l.c);if(c._.showInputMessage&&c._.prompt&&(this.validTip.querySelector("div").innerText=c._.promptTitle??"",this.validTip.querySelector("span").innerText=c._.prompt??"",this.validTip.style.top=`${this.toPhysical(e+i)+5}px`,this.validTip.style.left=`${this.toPhysical(t)}px`,this.validTip.style.display="block",bF.push(()=>this.validTip.style.display="none")),"list"==c._?.type&&c?._?.showDropDown){this.validSelect.style.left=`${this.toPhysical(n+t)+4}px`,this.validSelect.style.top=this.toPhysical(e+i)-20+"px",this.validSelect.style.display="block";const r=this.SN.namespace,o=c?._.formula1.map(t=>`<li onclick="${r}.activeSheet.getCell(${c.row.rIndex},${c.cIndex}).editVal='${t}';${r}._r();">${t}</li>`).join("");this.validSelect.querySelector("ul").innerHTML=o,bF.push(()=>this.validSelect.style.display="none")}}const f=this.getFilterIconAtPosition(a,s);if(f){const{colIndex:t,scopeId:e}=f,n=o.AutoFilter;if(n?.isScopeEnabled(e)){const i=n.getScopeHeaderRow(e),r=o.getCellInViewInfo(i,t),a=r.x+r.w,s=r.y+r.h;return void this.filterPanelManager.show(t,this.toPhysical(a),this.toPhysical(s),e)}}const p=c?.Us;if(p&&a>=p.x&&a<=p.x+p.w&&s>=p.y&&s<=p.y+p.h){const t=vF(o,h,u);if(t&&c?.Hs){const e=p.x+p.w,n=p.y+p.h;return void this.filterPanelManager?.showPivotFilter?.(t,c.Hs,this.toPhysical(e),this.toPhysical(n))}}const m=o.protection,g=!m.enabled||m.selectLockedCells,v=!m.enabled||m.selectUnlockedCells;let y=0;const b=t=>{const e=(t=>{if(!m.enabled)return"";if(!g&&!v)return o.SN.t("core.sheet.sheetProtection.message.selectionBlocked");if(!t)return"";const e="string"==typeof t?o.rangeStrToNum(t):t;if(!e?.s||!e?.e)return"";const n=Math.min(e.s.r,e.e.r),i=Math.max(e.s.r,e.e.r),r=Math.min(e.s.c,e.e.c),a=Math.max(e.s.c,e.e.c);for(let s=n;s<=i;s++)for(let t=r;t<=a;t++){const e=o.getCell(s,t),n=m.isCellLocked(e);if(n&&!g)return o.SN.t("core.sheet.sheetProtection.message.cannotSelectLocked");if(!n&&!v)return o.SN.t("core.sheet.sheetProtection.message.cannotSelectUnlocked")}return""})(t);return!!e&&((t=>{const e=Date.now();e-y<500||(y=e,o.SN?.Utils?.toast?.(t))})(e),!0)};if(s<o.headHeight&&a<o.indexWidth){const t={s:{c:0,r:0},e:{c:o.colCount-1,r:o.rowCount-1}};if(b(t))return;return o.activeCell={c:0,r:0},o.activeAreas=[t],this.r("s")}if(s<o.headHeight){const e={s:{c:l.c,r:0},e:{c:l.c,r:o.rowCount-1}};if(b(e))return;o.activeCell={c:l.c,r:0},t.ctrlKey?o.activeAreas.push(e):o.activeAreas=[e]}else if(a<o.indexWidth){const e={s:{c:0,r:l.r},e:{c:o.colCount-1,r:l.r}};if(b(e))return;o.activeCell={c:0,r:l.r},t.ctrlKey?o.activeAreas.push(e):o.activeAreas=[e]}else{const e=o.getCell(l.r,l.c);if(b(o.Ro({s:{c:l.c,r:l.r},e:{c:l.c,r:l.r}})))return;o.activeCell={c:e.master?.c??l.c,r:e.master?.r??l.r},t.ctrlKey?o.activeAreas.push({s:{c:l.c,r:l.r},e:{c:l.c,r:l.r}}):o.activeAreas=[]}this.inputEditing||this.r("s");const x=vF(o,l.r,l.c);x?(this.SN.Layout?.updateContextualToolbar({type:"pivotTable",data:x,autoSwitch:!0}),this.SN.Layout?.autoOpenPivotPanel(x)):this.SN.Layout?.closePivotPanel?.(),_F.call(this,l,e,n,i,r)}function $F(t){if(2!=t.button)return;const e=this.activeSheet.activeAreas,n=this.handleLayer.getBoundingClientRect(),i=t.clientX-n.left,r=t.clientY-n.top,o=this.toLogical(i),a=this.toLogical(r),s=this.getCellIndex(t),l=this.activeSheet.vi.side;if(o<this.activeSheet.indexWidth){(e[e.length-1].s.c!=l.l||e[e.length-1].e.c!=l.r||s.r<e[e.length-1].s.r||s.r>e[e.length-1].e.r)&&(this.activeSheet.activeAreas=[{s:{c:l.l,r:s.r},e:{c:l.r,r:s.r}}],this.r("s"));const t=this.lazyDOM.rowContextMenu;t.style.display="block",t.style.left=i+5+"px",t.style.top=r+5+"px",bF.push(()=>t.style.display="none")}else if(a<this.activeSheet.headHeight){(e[e.length-1].s.r!=l.t||e[e.length-1].e.r!=l.b||s.c<e[e.length-1].s.c||s.c>e[e.length-1].e.c)&&(this.activeSheet.activeAreas=[{s:{c:s.c,r:l.t},e:{c:s.c,r:l.b}}],this.r("s"));const t=this.lazyDOM.colContextMenu;t.style.display="block",t.style.left=i+5+"px",t.style.top=r+5+"px",bF.push(()=>t.style.display="none")}else if("drawing"==this.moveAreaName){const t=this.activeDrawing;t.active=!0,bF.push(()=>t.active=!1),this.r("s");const e=this.lazyDOM.drawingContextMenu;e.style.display="block",e.style.left=i+5+"px",e.style.top=r+5+"px",bF.push(()=>e.style.display="none")}else{(s.r<e[e.length-1].s.r||s.r>e[e.length-1].e.r||s.c<e[e.length-1].s.c||s.c>e[e.length-1].e.c)&&(this.activeSheet.activeCell=s,this.activeSheet.activeAreas=[],this.r("s"));const t=this.lazyDOM.cellContextMenu;t.style.display="block",t.style.left=i+5+"px",t.style.top=r+5+"px",bF.push(()=>t.style.display="none")}}function MF(t){if(this.disableScroll)return;if(t.ctrlKey||t.metaKey){t.preventDefault();const e=this.activeSheet?.zoom??1,n=t.deltaY<0?.1:-.1,i=Math.round(100*(e+n))/100;return void(this.activeSheet&&(this.activeSheet.zoom=i))}const e=this.activeSheet,n=e.ro||0,i=e.io||0;if(!e.vi)return;const r=e.vi.side?.b??e.rowCount-1,o=e.vi.side?.r??e.colCount-1;if(t.deltaY>0){const t=e.vi.rowArr?.[3],i=Number.isFinite(t)?t:e.$o(e.vi.rowArr[0],3);e.vi.rowArr[0]=Math.min(Math.max(i,n),r)}else if(t.deltaY<0){const t=e.No(e.vi.rowArr[0],3);e.vi.rowArr[0]=Math.max(t,n)}else if(t.deltaX>0){const t=e.vi.colArr?.[3],n=Number.isFinite(t)?t:e.Mo(e.vi.colArr[0],3);e.vi.colArr[0]=Math.min(Math.max(n,i),o)}else{if(!(t.deltaX<0))return;{const t=e.Fo(e.vi.colArr[0],3);e.vi.colArr[0]=Math.max(t,i)}}if(this.r(),this.updateScrollBar(),t.preventDefault(),this.inputEditing){const t=new Event("blur");this.input.dispatchEvent(t)}}function AF(t){if(this.disableScroll)return;if(1!==t.touches.length)return;if(this.disableMoveCheck)return;const e=t.touches[0],n=this.handleLayer.getBoundingClientRect(),i=e.clientX-n.left,r=e.clientY-n.top;this.touchStartInfo={x:e.clientX,y:e.clientY,localX:i,localY:r,time:Date.now(),scrollX:this.activeSheet.vi.colArr[0],scrollY:this.activeSheet.vi.rowArr[0],moved:!1,lastRenderTime:Date.now()},this.canvasContainer&&(this.canvasContainer.style.transform="")}function NF(t){if(this.disableScroll)return;if(!this.touchStartInfo||1!==t.touches.length)return;const e=t.touches[0],n=e.clientX-this.touchStartInfo.x,i=e.clientY-this.touchStartInfo.y,r=n/(this.activeSheet?.zoom??1),o=i/(this.activeSheet?.zoom??1);if(!this.touchStartInfo.moved&&(Math.abs(n)>5||Math.abs(i)>5)&&(this.touchStartInfo.moved=!0),!this.touchStartInfo.moved)return;t.preventDefault();const a=this.activeSheet,s=Date.now();if(this.canvasContainer&&(this.canvasContainer.style.transform=`translate(${n}px, ${i}px)`),s-this.touchStartInfo.lastRenderTime<150)return;const l=Math.floor(Math.abs(r)/15),c=Math.floor(Math.abs(o)/15),h=a.ro||0,u=a.io||0;let d=!1;if(Math.abs(r)>Math.abs(o)&&l>0){let t;r<0?(t=a.Mo(this.touchStartInfo.scrollX,1),t!==a.vi.colArr[0]&&(a.vi.colArr[0]=t,d=!0)):(t=a.Fo(this.touchStartInfo.scrollX,1),t=Math.max(t,u),t!==a.vi.colArr[0]&&(a.vi.colArr[0]=t,d=!0)),d&&(this.touchStartInfo.x=e.clientX,this.touchStartInfo.scrollX=a.vi.colArr[0])}else if(c>0){let t;o<0?(t=a.$o(this.touchStartInfo.scrollY,2),t!==a.vi.rowArr[0]&&(a.vi.rowArr[0]=t,d=!0)):(t=a.No(this.touchStartInfo.scrollY,2),t=Math.max(t,h),t!==a.vi.rowArr[0]&&(a.vi.rowArr[0]=t,d=!0)),d&&(this.touchStartInfo.y=e.clientY,this.touchStartInfo.scrollY=a.vi.rowArr[0])}d&&(this.canvasContainer&&(this.canvasContainer.style.transform=""),this.r(),this.updateScrollBar(),this.touchStartInfo.lastRenderTime=s)}function kF(t){if(this.touchStartInfo&&(this.canvasContainer&&(this.canvasContainer.style.transform=""),this.touchStartInfo.moved&&(this.r(),this.updateScrollBar()),this.touchStartInfo=null,this.inputEditing)){const t=new Event("blur");this.input.dispatchEvent(t)}}function RF(t,e,n){const{left:i,top:r,sheet:o}=e;let a=0;const s={start:{...this.activeDrawing.area.s},end:{...this.activeDrawing.area.e}},l=o.getCellInViewInfo(s.start.r,s.start.c),c=o.getCellInViewInfo(s.end.r,s.end.c),h={left:l.x+s.start.offsetX,top:l.y+s.start.offsetY,right:c.x+s.end.offsetX,bottom:c.y+s.end.offsetY};this.activeDrawing.active=!0;const u=this.activeDrawing;bF.push(()=>u.active=!1);const d=t=>{const e=Date.now();if(e-a<16)return;a=e;const s=Math.max(o.indexWidth,this.toLogical(t.clientX-i)),l=Math.max(o.headHeight,this.toLogical(t.clientY-r)),c={...h};switch(n){case"left-top":c.left=s,c.top=l;break;case"right-top":c.right=s,c.top=l;break;case"left-bottom":c.left=s,c.bottom=l;break;case"right-bottom":c.right=s,c.bottom=l;break;case"left":c.left=s;break;case"right":c.right=s;break;case"top":c.top=l;break;case"bottom":c.bottom=l}const u={left:Math.min(c.left,c.right),top:Math.min(c.top,c.bottom),right:Math.max(c.left,c.right),bottom:Math.max(c.top,c.bottom)},d=20;u.right-u.left<d&&(n.includes("left")?u.left=u.right-d:u.right=u.left+d),u.bottom-u.top<d&&(n.includes("top")?u.top=u.bottom-d:u.bottom=u.top+d);const f=this.getCellIndexByPosition(u.left,u.top),p=o.getCellInViewInfo(f.r,f.c,!1),m=u.left-p.x,g=u.top-p.y;this.activeDrawing.startCell={r:f.r,c:f.c},this.activeDrawing.offsetX=m,this.activeDrawing.offsetY=g,this.activeDrawing.width=u.right-u.left,this.activeDrawing.height=u.bottom-u.top,this.r("s")};this.handleLayer.addEventListener("mousemove",d),window.addEventListener("mouseup",()=>{this.handleLayer.removeEventListener("mousemove",d),this.disableMoveCheck=!1,"image"!=this.activeDrawing.type&&(this.activeDrawing.drawCache=null),this.r("s")},{once:!0})}function _F(t,e,n,i,r){this.disableMoveCheck=!0;let o=null;const a=this.activeSheet,s=a.protection,l=!s.enabled||s.selectLockedCells,c=!s.enabled||s.selectUnlockedCells;let h=0;const u=t=>{const e=(t=>{if(!s.enabled)return"";if(!l&&!c)return a.SN.t("core.sheet.sheetProtection.message.selectionBlocked");if(!t)return"";const e="string"==typeof t?a.rangeStrToNum(t):t;if(!e?.s||!e?.e)return"";const n=Math.min(e.s.r,e.e.r),i=Math.max(e.s.r,e.e.r),r=Math.min(e.s.c,e.e.c),o=Math.max(e.s.c,e.e.c);for(let h=n;h<=i;h++)for(let t=r;t<=o;t++){const e=a.getCell(h,t),n=s.isCellLocked(e);if(n&&!l)return a.SN.t("core.sheet.sheetProtection.message.cannotSelectLocked");if(!n&&!c)return a.SN.t("core.sheet.sheetProtection.message.cannotSelectUnlocked")}return""})(t);return!!e&&((t=>{const e=Date.now();e-h<500||(h=e,a.SN?.Utils?.toast?.(t))})(e),!0)},d=t=>t?{s:{r:t.s.r,c:t.s.c},e:{r:t.e.r,c:t.e.c}}:null;let f=a.activeAreas.length?d(a.activeAreas[a.activeAreas.length-1]):null;const p=s=>{const l=this.getCellIndex(s),c=a.activeAreas.length,h=a.activeAreas[c-1];if(0===c){const e={s:{...t},e:{c:l.c,r:l.r}},n=a.Ro(e);if(u(n))return;return a.activeAreas.push(n),f=d(n),this.r("s")}if(-1==t.c){if(h.e.r==l.r)return;l.c=a.colCount-1;const e=OF({s:{r:t.r,c:0},e:l});if(u(e))return;return a.activeAreas[c-1]=e,f=d(e),this.r("s")}if(-1==t.r){if(h.e.c==l.c)return;l.r=a.rowCount-1;const e=OF({s:{r:0,c:t.c},e:l});if(u(e))return;return a.activeAreas[c-1]=e,f=d(e),this.r("s")}{const e=l;-1==e.r&&(e.r=a.vi.rowArr[0]),-1==e.c&&(e.c=a.vi.colArr[0]);const n=OF({s:{...t},e:l}),i=a.Ro(n);if(u(i))return;a.activeAreas[c-1]=i,h.e.c==i.e.c&&h.e.r==i.e.r&&h.s.c==i.s.c&&h.s.r==i.s.r||this.r("s"),f=d(i)}const p=this.activeSheet?.zoom??1,m=s.clientX-e,g=s.clientY-n,v=a.indexWidth*p,y=a.headHeight*p,b=a.vi.w*p,x=a.vi.h*p,w=m<=30+v,S=m>=i-30||m>b,C=g<=30+y,T=g>=r-30||g>x;clearInterval(o),o=setInterval(()=>{const t=a.activeAreas;if(!t.length)return;const e=a.vi.colArr,n=a.vi.rowArr;if(w)e[0]=a.Fo(e[0],1),t[t.length-1].s.c<t[t.length-1].e.c?t[t.length-1].s.c=Math.max(e[0],0):t[t.length-1].e.c=Math.max(e[0],0);else if(S&&a.vi.w*p>this.width)e[0]=e[1]??a.vi.side.r,t[t.length-1].e.c=Math.max(e[e.length-1],0);else if(C)n[0]=a.No(n[0],2),t[t.length-1].s.r<t[t.length-1].e.r?t[t.length-1].s.r=Math.max(n[0],0):t[t.length-1].e.r=Math.max(n[0],0);else{if(!(T&&a.vi.h*p>this.height))return;n[0]=n[2]??n[1]??a.vi.side.b,t[t.length-1].s.r>t[t.length-1].e.r?t[t.length-1].s.r=Math.max(n[n.length-1],0):t[t.length-1].e.r=Math.max(n[n.length-1],0)}const i=t[t.length-1];if(u(i))return f&&(t[t.length-1]=d(f)),void this.r();f=d(i),this.r()},100)};this.handleLayer.addEventListener("mousemove",p),window.addEventListener("mouseup",()=>{if(this.handleLayer.removeEventListener("mousemove",p),this.disableMoveCheck=!1,clearInterval(o),!this.activeSheet.mo.area)return;const t=this.activeSheet.activeAreas[this.activeSheet.activeAreas.length-1];this.activeSheet.applyBrush(t),this.r()},{once:!0})}function IF(t,e,n,i){if(t<i.indexWidth||e<i.headHeight){const r=this.getCellIndex(n),o=i.getCellInViewInfo(r.r,r.c);return e<i.headHeight&&(Math.abs(o.x-t)<=5||Math.abs(o.x+i.getCol(r.c).width-t)<=5)?(this.moveAreaName="row-col-resize","ew-resize"):t<i.indexWidth&&(Math.abs(o.y-e)<=5||Math.abs(o.y+i.getRow(r.r).height-e)<=5)?(this.moveAreaName="row-col-resize","ns-resize"):null}}function FF(t,e){const n=this.activeSheet.Drawing.getAll();for(let i=n.length-1;i>=0;i--){const r=n[i];if(!r.position||!r.inView)continue;const{x:o,y:a,w:s,h:l}=r.position;let c=t,h=e;if(r.Fn){const n=o+s/2,i=a+l/2,u=-r.Fn*Math.PI/180,d=Math.cos(u),f=Math.sin(u),p=t-n,m=e-i;c=n+p*d-m*f,h=i+p*f+m*d}if(r.active){const t=o+s,e=a+l,n=o+(s>>1),i=a+(l>>1);if("image"===r.type||"shape"===r.type&&!r.isConnector){const t=a-30;if(c>=n-6&&c<=n+6&&h>=t-6&&h<=t+6)return this.activeDrawing=r,this.moveAreaName="d-rotate","grab"}if(c>=o-4&&c<=o+4&&h>=a-4&&h<=a+4)return this.activeDrawing=r,this.moveAreaName="d-left-top","nw-resize";if(c>=t-4&&c<=t+4&&h>=a-4&&h<=a+4)return this.activeDrawing=r,this.moveAreaName="d-right-top","ne-resize";if(c>=o-4&&c<=o+4&&h>=e-4&&h<=e+4)return this.activeDrawing=r,this.moveAreaName="d-left-bottom","sw-resize";if(c>=t-4&&c<=t+4&&h>=e-4&&h<=e+4)return this.activeDrawing=r,this.moveAreaName="d-right-bottom","se-resize";if(c>=n-4&&c<=n+4&&h>=a-4&&h<=a+4)return this.activeDrawing=r,this.moveAreaName="d-top","n-resize";if(c>=n-4&&c<=n+4&&h>=e-4&&h<=e+4)return this.activeDrawing=r,this.moveAreaName="d-bottom","s-resize";if(c>=o-4&&c<=o+4&&h>=i-4&&h<=i+4)return this.activeDrawing=r,this.moveAreaName="d-left","w-resize";if(c>=t-4&&c<=t+4&&h>=i-4&&h<=i+4)return this.activeDrawing=r,this.moveAreaName="d-right","e-resize"}if(c>=o&&c<=o+s&&h>=a&&h<=a+l)return this.activeDrawing=r,this.moveAreaName="drawing","move"}return null}function EF(t,e){const n=this.activeSheet.Drawing.getAll();for(let i=n.length-1;i>=0;i--){const r=n[i];if(!r.position||!r.inView)continue;const{x:o,y:a,w:s,h:l}=r.position;let c=t,h=e;if(r.Fn){const n=o+s/2,i=a+l/2,u=-r.Fn*Math.PI/180,d=Math.cos(u),f=Math.sin(u),p=t-n,m=e-i;c=n+p*d-m*f,h=i+p*f+m*d}if(c>=o&&c<=o+s&&h>=a&&h<=a+l)return r}return null}function DF(){const t=this.ob;if(t?.editor?.isConnected)return t;const e=this.SN.containerDom.querySelector(".sn-top-layer");if(!e)return null;const n=document.createElement("div");n.className="sn-textbox-editor",n.contentEditable="true",n.spellcheck=!1,n.style.display="none",n.style.pointerEvents="none",e.appendChild(n);const i=t??{};return i.editor=n,i.active=!1,i.drawing=null,i.originalText="",i.closing=!1,this.ob=i,this.ab=()=>LF.call(this),this.lb=(t=!0)=>zF.call(this,t),n.addEventListener("mousedown",t=>t.stopPropagation()),n.addEventListener("dblclick",t=>t.stopPropagation()),n.addEventListener("keydown",t=>{if(i.active)return t.stopPropagation(),"Escape"===t.key?(t.preventDefault(),zF.call(this,!1),void this.input.focus()):(t.ctrlKey||t.metaKey)&&"Enter"===t.key?(t.preventDefault(),zF.call(this,!0),void this.input.focus()):void("Tab"===t.key&&(t.preventDefault(),zF.call(this,!0),this.input.focus()))}),n.addEventListener("blur",()=>{i.active&&!i.closing&&zF.call(this,!0)}),i}function LF(){const t=this.ob,e=t?.editor;if(!e)return;const n=t.drawing;if(!t.active||!n?.position)return e.style.display="none",void(e.style.pointerEvents="none");if(!n.inView)return e.style.display="none",void(e.style.pointerEvents="none");const{x:i,y:r,w:o,h:a}=n.position,s=n.shapeStyle||{},l="vertical"===s.textDirection?"vertical":"horizontal",c=this.activeSheet?.zoom??1,h=(s.fontSize||11)*c,u=s.stroke&&"none"!==s.stroke?s.stroke:"#6493f0",d=s.fill&&"none"!==s.fill?s.fill:"transparent",f=function(t={},e=!1){return e?{l:"end",r:"start",ctr:"center"}[t.textAlign]||"start":{l:"left",r:"right",ctr:"center"}[t.textAlign]||"left"}(s,"vertical"===l);e.style.display="block",e.style.pointerEvents="auto",e.style.left=`${this.toPhysical(i)}px`,e.style.top=`${this.toPhysical(r)}px`,e.style.width=`${Math.max(12,this.toPhysical(o))}px`,e.style.height=`${Math.max(12,this.toPhysical(a))}px`,e.style.fontSize=`${h}px`,e.style.lineHeight=1.2*h+"px",e.style.fontFamily=s.fontFamily||"宋体",e.style.color=s.textColor||"#000000",e.style.backgroundColor=d,e.style.borderColor=u,e.style.textAlign=f,e.style.writingMode="vertical"===l?"vertical-rl":"horizontal-tb",e.style.textOrientation="vertical"===l?"upright":"mixed",e.style.transformOrigin="center center",e.style.transform=n.Fn?`rotate(${n.Fn}deg)`:"none"}function PF(t){if(!t)return!1;const e=DF.call(this);return!!e?.editor&&(e.active&&e.drawing&&e.drawing!==t&&zF.call(this,!0),e.active=!0,e.drawing=t,e.originalText=t.shapeText||"",e.editor.innerText=e.originalText,this.activeDrawing=t,t.active=!0,LF.call(this),requestAnimationFrame(()=>{e.active&&e.drawing===t&&(e.editor.focus(),function(t){const e=window.getSelection();if(!e)return;const n=document.createRange();n.selectNodeContents(t),n.collapse(!1),e.removeAllRanges(),e.addRange(n)}(e.editor))}),!0)}function zF(t=!0){const e=this.ob,n=e?.editor;if(!e?.active||!n||e.closing)return!1;e.closing=!0;const i=e.drawing;if(t&&i){const t=function(t){return String(t?.innerText??"").replace(/\r\n/g,"\n").replace(/\u00a0/g," ").replace(/\n$/,"")}(n);i.shapeText!==t&&(i.shapeText=t,i.drawCache=null)}return e.active=!1,e.drawing=null,e.originalText="",n.style.display="none",n.style.pointerEvents="none",n.style.transform="none",document.activeElement===n&&n.blur(),e.closing=!1,this.r("s"),!0}function OF(t){const{s:e,e:n}=t;return{s:{c:Math.min(e.c,n.c),r:Math.min(e.r,n.r)},e:{c:Math.max(e.c,n.c),r:Math.max(e.r,n.r)}}}function BF(t,e){const n=Math.min(t.s.r,e.s.r,t.e.r,e.e.r),i=Math.min(t.s.c,e.s.c,t.e.c,e.e.c),r=Math.max(t.s.r,e.s.r,t.e.r,e.e.r);return{s:{c:i,r:n},e:{c:Math.max(t.s.c,e.s.c,t.e.c,e.e.c),r}}}function VF(t){const{s:e,e:n}=this.activeSheet.activeAreas[this.activeSheet.activeAreas.length-1],{c:i,r}=t;if(i>=e.c&&i<=n.c&&r>=e.r&&r<=n.r)return null;let o={s:{c:i,r},e:{c:i,r}};return i<e.c||i>n.c?(o.s.c=Math.min(n.c+1,i),o.e.c=Math.max(e.c-1,i),o.s.r=e.r,o.e.r=n.r):(r<e.r||r>n.r)&&(o.s.r=Math.min(n.r+1,r),o.e.r=Math.max(e.r-1,r),o.s.c=e.c,o.e.c=n.c),o}function HF(t,e){if(!this.activeSheet.protection.isSelectionVisible())return null;const{x:n,y:i,w:r,h:o}=this.activeBorderInfo;return t>=n+r+1-5&&t<=n+r+1+5&&e>=i+o+1-5&&e<=i+o+1+5?(this.moveAreaName="fill-handle","crosshair"):t>=n-1&&t<=n+r+1&&e>=i-1&&e<=i+o+1&&!(t>n+1&&t<n+r-1&&e>i+1&&e<i+o-1)?(this.moveAreaName="active-border","move"):null}function UF(t,e,n,i=this.activeSheet.vi.side){t=t[t.length-1];const r=n.r-e.r,o=n.c-e.c;let a={s:{r:t.s.r+r,c:t.s.c+o},e:{r:t.e.r+r,c:t.e.c+o}};if(a.s.r<i.t){const t=i.t-a.s.r;a.s.r=i.t,a.e.r+=t}if(a.s.c<i.l){const t=i.l-a.s.c;a.s.c=i.l,a.e.c+=t}if(a.e.r>i.b){const t=a.e.r-i.b;a.e.r=i.b,a.s.r-=t}if(a.e.c>i.r){const t=a.e.c-i.r;a.e.c=i.r,a.s.c-=t}return a}function qF(t){if(t.altKey){const e=document.activeElement===this.formulaBar;return void("Enter"!==t.key||e||(this.inputEditing||document.activeElement!==this.input||(t.preventDefault(),this.showCellInput(!1,!0)),this.inputEditing&&(t.preventDefault(),document.activeElement!==this.input&&this.input.focus(),function(t){const e=window.getSelection();if(!e)return!1;let n=null;if(e.rangeCount>0){const i=e.getRangeAt(0);t.contains(i.commonAncestorContainer)&&(n=i)}n||(n=document.createRange(),n.selectNodeContents(t),n.collapse(!1),e.removeAllRanges(),e.addRange(n)),n.deleteContents();const i=document.createElement("br");n.insertNode(i);const r=i.nextSibling;r&&(3!==r.nodeType||r.textContent)||t.appendChild(document.createElement("br"));const o=document.createRange();return o.setStartAfter(i),o.collapse(!0),e.removeAllRanges(),e.addRange(o),!0}(this.input)&&(this.formulaBar.value=this.input.innerText))))}const e=this.activeSheet;if(e.activeAreas[e.activeAreas.length-1],"F9"===t.key)return t.preventDefault(),void this.SN.recalculate(t.shiftKey);if(t.ctrlKey){if(document.activeElement.classList.contains("sn-prompt-input")&&"i"==t.key){t.preventDefault();const e=document.activeElement,n=e.selectionStart,i=e.selectionEnd,r=e.value,o=this.areaInput?.value||"",a=r.slice(0,n)+o+r.slice(i);return e.value=a,void(e.selectionStart=e.selectionEnd=n+o.length)}if(document.activeElement!==this.input||this.inputEditing||window.getSelection().toString())return;"c"==t.key?(t.preventDefault(),this.SN.Action.copy()):"x"==t.key?(t.preventDefault(),this.SN.Action.cut(),this.r()):"v"==t.key?e.hasClipboardData()&&(t.preventDefault(),this.SN.Action.paste()):"z"===t.key?(this.SN.UndoRedo.undo(),t.preventDefault()):"y"===t.key?(this.SN.UndoRedo.redo(),t.preventDefault()):"V"===t.key&&t.shiftKey&&(t.preventDefault(),this.SN.Action.pasteSpecial())}else if(["ArrowUp","ArrowRight","ArrowLeft","ArrowDown","Enter"].includes(t.key)&&document.activeElement!==this.formulaBar&&document.activeElement===this.input){if(this.inputEditing){const t=new Event("blur");this.input.dispatchEvent(t)}let{c:n,r:i}=e.activeCell;const r=e.getCell(i,n),o=r.master?e.merges.find(t=>t.s.r===r.master.r&&t.s.c===r.master.c):null,a={t:i,b:i,l:n,r:n};o&&(a.t=o.s.r,a.b=o.e.r,a.l=o.s.c,a.r=o.e.c),"Enter"==t.key||"ArrowDown"==t.key&&a.b<e.vi.side.b?e.activeCell.r=e.$o(a.b,1):"ArrowUp"==t.key&&a.t>e.vi.side.t?e.activeCell.r=e.No(a.t,1):"ArrowLeft"==t.key&&a.l>e.vi.side.l?e.activeCell.c=e.Fo(a.l,1):("ArrowRight"==t.key||"Tab"==t.key)&&a.r<e.vi.side.r&&(e.activeCell.c=e.Mo(a.r,1));const s=e.vi.colArr,l=e.vi.rowArr;i<l[2]?l[0]=e.No(l[0],1):i>l[l.length-3]?l[0]=e.$o(l[0],1):n<s[2]?s[0]=e.Fo(s[0],1):n>s[s.length-3]&&(s[0]=e.Mo(s[0],1)),e.activeAreas=[],this.r()}else if("Delete"==t.key)e.eachCells(e.activeAreas,(t,n)=>{e.getCell(t,n).editVal=""}),this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),this.r();else if("Escape"==t.key){if(e.cancelBrush())return void this.r();e.hasClipboardData()&&(e.clearClipboard(),this.r())}else document.activeElement!==this.input||this.inputEditing||this.showCellInput(!0,!0)}function KF(t){document.activeElement!==this.input||this.inputEditing||(t.preventDefault(),this.SN.Action.handlePasteEvent(t))}function WF(t){document.activeElement!==this.input||this.inputEditing?this.SN.Action.clearClipboard():window.getSelection().toString()||(t.preventDefault(),this.SN.Action.copy())}function jF(t){document.activeElement!==this.input||this.inputEditing?this.SN.Action.clearClipboard():window.getSelection().toString()||(t.preventDefault(),this.SN.Action.cut(),this.r())}function GF(t){const e=t.pageY,n=this.rollYS.style.transform,i=n?Number(n.match(/translateY\(([-\d.]+)px\)/)?.[1]):0;let r=null;const o=this.activeSheet;this.SN.t("layoutScrollTipRow");const a=o.ro||0;let s=0;for(let d=0;d<a;d++)s+=o.getRow(d).height||0;const l=o.getTotalHeight()-s,c=o.getRow(o.rowCount-1)?.height||0,h=Math.max(1,l-c),u=t=>{const n=i+t.pageY-e;let l=Math.max(0,Math.min(n,this.maxTop));const c=l/this.maxTop*h;let u=o.getRowIndexByScrollTop(c+s);u=Math.max(u,a),this.rollYS.style.transform=`translateY(${l}px)`,u!=r&&(r=u,o.vi.rowArr[0]=u,this.r())};window.addEventListener("mousemove",u),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",u)},{once:!0})}function XF(t){const e=t.pageX,n=this.rollXS.style.transform,i=n?Number(n.match(/translateX\(([-\d.]+)px\)/)?.[1]):0;let r=null;const o=this.activeSheet,a=o.io||0;let s=0;for(let d=0;d<a;d++)s+=o.getCol(d)?.width||0;const l=o.getTotalWidth()-s,c=o.getCol(o.colCount-1)?.width||0,h=Math.max(1,l-c),u=t=>{const n=i+t.pageX-e;let l=Math.max(0,Math.min(n,this.maxLeft));const c=l/this.maxLeft*h;let u=o.getColIndexByScrollLeft(c+s);u=Math.max(u,a),this.rollXS.style.transform=`translateX(${l}px)`,u!=r&&(r=u,o.vi.colArr[0]=u,this.r())};window.addEventListener("mousemove",u),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",u)},{once:!0})}function YF(t){if(1!==t.touches.length)return;t.preventDefault();const e=t.touches[0].pageY,n=this.rollYS.style.transform,i=n?Number(n.match(/translateY\(([-\d.]+)px\)/)?.[1]):0;let r=null;const o=this.activeSheet,a=o.ro||0;let s=0;for(let f=0;f<a;f++)s+=o.getRow(f)?.height||0;const l=o.getTotalHeight()-s,c=o.getRow(o.rowCount-1)?.height||0,h=Math.max(1,l-c);this.scrollTip.style.display="block";const u=t=>{if(1!==t.touches.length)return;t.preventDefault();const n=t.touches[0],l=i+n.pageY-e;let c=Math.max(0,Math.min(l,this.maxTop));const u=c/this.maxTop*h;let d=o.getRowIndexByScrollTop(u+s);d=Math.max(d,a),this.rollYS.style.transform=`translateY(${c}px)`,r=d,this.scrollTip.textContent=`${rowTipPrefix} ${d+1}`},d=()=>{window.removeEventListener("touchmove",u),window.removeEventListener("touchend",d),this.scrollTip.style.display="none",null!==r&&(o.vi.rowArr[0]=r,this.r())};window.addEventListener("touchmove",u,{passive:!1}),window.addEventListener("touchend",d,{once:!0})}function ZF(t){if(1!==t.touches.length)return;t.preventDefault();const e=t.touches[0].pageX,n=this.rollXS.style.transform,i=n?Number(n.match(/translateX\(([-\d.]+)px\)/)?.[1]):0;let r=null;const o=this.activeSheet,a=this.SN.t("layoutScrollTipCol"),s=o.io||0;let l=0;for(let p=0;p<s;p++)l+=o.getCol(p)?.width||0;const c=o.getTotalWidth()-l,h=o.getCol(o.colCount-1)?.width||0,u=Math.max(1,c-h);this.scrollTip.style.display="block";const d=t=>{if(1!==t.touches.length)return;t.preventDefault();const n=t.touches[0],c=i+n.pageX-e;let h=Math.max(0,Math.min(c,this.maxLeft));const d=h/this.maxLeft*u;let f=o.getColIndexByScrollLeft(d+l);f=Math.max(f,s),this.rollXS.style.transform=`translateX(${h}px)`,r=f,this.scrollTip.textContent=`${a} ${this.Utils.numToChar(f)}`},f=()=>{window.removeEventListener("touchmove",d),window.removeEventListener("touchend",f),this.scrollTip.style.display="none",null!==r&&(o.vi.colArr[0]=r,this.r())};window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("touchend",f,{once:!0})}function JF(){const t=this.formulaBar.value;this.hb=t,this.opCancel||(this.opCancel=this.SN.containerDom.querySelector(".sn-op-cancel"),this.opConfirm=this.SN.containerDom.querySelector(".sn-op-confirm"),this.opFun=this.SN.containerDom.querySelector(".sn-op-fun")),this.showCellInput(!1,!1),this.opCancel.style.color="red",this.opConfirm.style.color="green",this.opFun.style.color="blue";const e=()=>{this.input.innerText=this.formulaBar.value};this.formulaBar.addEventListener("input",e),this.opCancel.addEventListener("mousedown",()=>{this.input.innerText=t},{once:!0}),this.formulaBar.addEventListener("blur",()=>{this.updInputValue(),this.formulaBar.removeEventListener("input",e),this.opConfirm.style.color="",this.opCancel.style.color="",this.opFun.style.color=""},{once:!0})}function QF(){this.formulaBar.value=this.input.innerText}function tE(t){if("Escape"===t.key)return t.preventDefault(),this.input.innerText=this.hb??"",void this.formulaBar.blur();if("Enter"===t.key){if(t.altKey){t.preventDefault();const e=this.formulaBar.selectionStart,n=this.formulaBar.selectionEnd,i=this.formulaBar.value;this.formulaBar.value=i.substring(0,e)+"\n"+i.substring(n),this.formulaBar.selectionStart=this.formulaBar.selectionEnd=e+1,this.input.innerText=this.formulaBar.value;const r=this.formulaBar;return r.style.height="auto",void(r.style.height=Math.min(r.scrollHeight,200)+"px")}t.preventDefault(),this.formulaBar.blur()}}const eE={series:"#376092",negative:"#D00000",axis:"#000000",markers:"#D00000",first:"#D00000",last:"#D00000",high:"#D00000",low:"#D00000"},nE=(t,e)=>t?.colors?.[e]??eE[e];function iE(t,e,n,i,r,o,a){const{group:s}=r,l=this.bc;let c,h,u,d;"line"===s.type?(u=.15*n,d=.15*n,c=3,h=3):"column"===s.type?(c=2,h=2,u=3,d=3):(c=2,h=2,u=2,d=2);const f=t+u,p=e+c,m=n-u-d,g=i-c-h;if(m<=0||g<=0)return;const v=Math.max(...o),y=Math.min(...o),b=s.manualMax??v,x=s.manualMin??y,w=b-x||1;switch(l.save(),s.type){case"line":rE.call(this,l,f,p,m,g,o,x,w,s);break;case"column":oE.call(this,l,f,p,m,g,o,x,b,w,s,y,v);break;case"stacked":aE.call(this,l,f,p,m,g,o,s)}l.restore()}function rE(t,e,n,i,r,o,a,s,l){const c=o.length,h=i/(c-1||1);t.beginPath(),t.strokeStyle=nE(l,"series");const u=l.lineWeight||1;if(t.lineWidth=this.px(u),o.forEach((i,o)=>{const l=e+o*h,c=n+r-(i-a)/s*r;0===o?t.moveTo(l,c):t.lineTo(l,c)}),t.stroke(),l.markers||l.first||l.last||l.high||l.low){const i=Math.max(...o),u=Math.min(...o),d=o.indexOf(i),f=o.indexOf(u),p=nE(l,"markers"),m=nE(l,"first"),g=nE(l,"last"),v=nE(l,"high"),y=nE(l,"low");o.forEach((i,o)=>{const u=e+o*h,b=n+r-(i-a)/s*r;let x=!1,w=p;l.markers&&(x=!0),l.first&&0===o&&(x=!0,w=m),l.last&&o===c-1&&(x=!0,w=g),l.high&&o===d&&(x=!0,w=v),l.low&&o===f&&(x=!0,w=y),x&&(t.beginPath(),t.fillStyle=w,t.arc(u,b,1.5,0,2*Math.PI),t.fill())})}}function oE(t,e,n,i,r,o,a,s,l,c,h,u){const d=o.length,f=i/d,p=Math.max(.5,.1*f),m=Math.max(1,f-p),g=s<=0?n:a>=0?n+r:n+r- -a/l*r,v=nE(c,"axis"),y=nE(c,"series"),b=nE(c,"negative"),x=nE(c,"first"),w=nE(c,"last"),S=nE(c,"high"),C=nE(c,"low");a<0&&s>0&&(t.beginPath(),t.strokeStyle=v,t.lineWidth=this.px(1),t.moveTo(e,g),t.lineTo(e+i,g),t.stroke()),o.forEach((n,i)=>{if(0===n&&0===a&&0===s)return;const o=e+i*f+p/2;let v,T;a>=0?(v=Math.max(1,(n-a)/l*r),T=g-v):s<=0?(v=Math.max(1,Math.abs(n-s)/l*r),T=g):(v=Math.max(1,Math.abs(n)/l*r),T=n>=0?g-v:g);let $=y;n<0&&c.negative&&($=b),c.first&&0===i&&($=x),c.last&&i===d-1&&($=w),c.high&&n===u&&($=S),c.low&&n===h&&($=C),t.fillStyle=$,t.fillRect(o,T,m,v)})}function aE(t,e,n,i,r,o,a){const s=o.length,l=i/s,c=Math.max(.5,.1*l),h=Math.max(1,l-c),u=n+r/2,d=r/2-1,f=nE(a,"axis"),p=nE(a,"series"),m=nE(a,"negative"),g=nE(a,"first"),v=nE(a,"last"),y=nE(a,"high"),b=nE(a,"low"),x=Math.max(...o),w=Math.min(...o);t.beginPath(),t.strokeStyle=f,t.lineWidth=this.px(1),t.moveTo(e,u),t.lineTo(e+i,u),t.stroke(),o.forEach((n,i)=>{if(0===n)return;const r=e+i*l+c/2,o=n>0?u-d:u;let f=n>0?p:m;a.first&&0===i&&(f=g),a.last&&i===s-1&&(f=v),a.high&&n===x&&(f=y),a.low&&n===w&&(f=b),t.fillStyle=f,t.fillRect(r,o,h,d)})}function sE(t){return{x:t.x+t.w-6-1,y:t.y+1,size:6}}function lE(t,e,n,i,r,o){const a=r||o,s=t.createLinearGradient(e,n,e,n+i);s.addColorStop(0,"#ffffff"),s.addColorStop(1,"#f0f0f0"),t.fillStyle=s,t.fillRect(e,n,i,i),t.strokeStyle=a?"#4f7cf6":"#ddd",t.lineWidth=1,t.strokeRect(e+.5,n+.5,Math.max(0,i-1),Math.max(0,i-1));const l=e+i/2,c=n+i/2;t.fillStyle=a?"#4f7cf6":"#666",t.beginPath(),"asc"===o?(t.moveTo(l-4,c+1),t.lineTo(l+4,c+1),t.lineTo(l,c-4+1)):(t.moveTo(l-4,c-1),t.lineTo(l+4,c-1),t.lineTo(l,c+4-1)),t.closePath(),t.fill()}const cE=new Path2D;function hE(t){return 0===t.rowFields.length&&0===t.colFields.length&&0===t.dataFields.length&&0===t.pageFields.length}function uE(t,e,n){const i=e+18-1,r=n+3-1,o=t.vi.colsIndex,a=t.vi.rowsIndex;if(i<a[0]||e>a[a.length-1]||r<o[0]||n>o[o.length-1])return{inView:!1};let s=t.indexWidth,l=t.headHeight;for(let u=o[0];u<n;u++)s+=t.getCol(u).width;for(let u=n;u<o[0];u++)s-=t.getCol(u).width;for(let u=a[0];u<e;u++)l+=t.getRow(u).height;for(let u=e;u<a[0];u++)l-=t.getRow(u).height;let c=0,h=0;for(let u=n;u<=r;u++)c+=t.getCol(u).width;for(let u=e;u<=i;u++)h+=t.getRow(u).height;return{x:s,y:l,w:c,h,inView:!0}}function dE(t,e,n,i,r,o){const{x:a,y:s,w:l,h:c}=n,h=t=>Math.round(t*r)/r,u=t=>t/r;t.save();const d=Math.max(a,i.indexWidth),f=Math.max(s,i.headHeight),p=l-(d-a),m=c-(f-s);if(p<=0||m<=0)return void t.restore();t.beginPath(),t.rect(d,f,p,m),t.clip(),t.fillStyle="#f5f5f5",t.fillRect(a,s,l,c),t.strokeStyle="#b4b4b4",t.lineWidth=u(1),t.setLineDash([u(4),u(2)]);const g=h(a),v=h(s),y=h(a+l),b=h(s+c);t.strokeRect(g,v,y-g,b-v),t.setLineDash([]);const x=a+l/2,w=s+c/2,S=x-16,C=w-60;t.save(),t.translate(S,C),t.scale(32/24,32/24),t.strokeStyle="#999",t.lineWidth=1.5,t.stroke(cE),t.restore(),t.fillStyle="#333",t.font='bold 13px "Microsoft YaHei", sans-serif',t.textAlign="center",t.textBaseline="middle",t.fillText(e.name,x,w-15),t.fillStyle="#666",t.font='12px "Microsoft YaHei", sans-serif',t.fillText(o.t("core.canvas.pivotTableRenderer.placeholder.generateFrom"),x,w+10),t.fillText(o.t("core.canvas.pivotTableRenderer.placeholder.selectFields"),x,w+28),t.strokeStyle="#ccc",t.lineWidth=u(1),t.beginPath();const T=h(w+50);t.moveTo(h(x-80),T),t.lineTo(h(x+80),T),t.stroke(),t.fillStyle="#888",t.font='11px "Microsoft YaHei", sans-serif',t.fillText(o.t("core.canvas.pivotTableRenderer.placeholder.clickToUse"),x,w+70),t.restore()}cE.moveTo(0,0),cE.lineTo(24,0),cE.lineTo(24,24),cE.lineTo(0,24),cE.closePath(),cE.moveTo(8,0),cE.lineTo(8,24),cE.moveTo(16,0),cE.lineTo(16,24),cE.moveTo(0,8),cE.lineTo(24,8),cE.moveTo(0,16),cE.lineTo(24,16);class fE{constructor(t){this.canvas=t,this.$=t.SN,this.ub=null,this.pb=null,this.bb=null,this.gb=[],this.yb=new Set,this.wb=this.xb.bind(this),this.$b=null,this.Mb=!0}get autoFilter(){return this.$.activeSheet?.AutoFilter}mn(t,e={}){return t&&"string"==typeof t?this.$.t(t,e):""}Cb(){if(this.ub)return this.ub;const t=document.createElement("div");return t.className="sn-filter-panel",t.innerHTML=`\n            <div class="sn-filter-header">\n                <span class="sn-filter-title">${this.mn("autoFilter.panel.title")}</span>\n                <span class="sn-filter-close">×</span>\n            </div>\n            <div class="sn-filter-field">\n                <label>${this.mn("autoFilter.panel.field")}</label>\n                <select class="sn-filter-field-select"></select>\n            </div>\n            <div class="sn-filter-sort">\n                <div class="sn-filter-sort-item" data-sort="asc">\n                    ${cn("filter_sortAsc")}\n                    <span>${this.mn("autoFilter.panel.sortAsc")}</span>\n                </div>\n                <div class="sn-filter-sort-item" data-sort="desc">\n                    ${cn("filter_sortDesc")}\n                    <span>${this.mn("autoFilter.panel.sortDesc")}</span>\n                </div>\n            </div>\n            <div class="sn-filter-search">\n                <input type="text" placeholder="${this.mn("autoFilter.panel.searchPlaceholder")}" class="sn-filter-search-input">\n            </div>\n            <div class="sn-filter-actions">\n                <span class="sn-filter-select-all">${this.mn("autoFilter.panel.selectAll")}</span>\n                <span class="sn-filter-clear-all">${this.mn("autoFilter.panel.clear")}</span>\n            </div>\n            <div class="sn-filter-list"></div>\n            <div class="sn-filter-footer">\n                <button class="sn-filter-cancel">${this.mn("common.cancel")}</button>\n                <button class="sn-filter-apply primary">${this.mn("common.ok")}</button>\n            </div>\n        `,document.body.appendChild(t),this.ub=t,this.Sb(),t}Sb(){const t=this.ub;if(!t)return;t.querySelector(".sn-filter-close")?.addEventListener("click",()=>this.hide());const e=t.querySelector(".sn-filter-search-input");e?.addEventListener("input",t=>this.Rb(t.target.value)),t.querySelector(".sn-filter-select-all")?.addEventListener("click",()=>this.Ab()),t.querySelector(".sn-filter-clear-all")?.addEventListener("click",()=>this.kb()),t.querySelectorAll(".sn-filter-sort-item").forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.sort;this.Tb(e)})}),t.querySelector(".sn-filter-apply")?.addEventListener("click",()=>this.Nb()),t.querySelector(".sn-filter-cancel")?.addEventListener("click",()=>this.hide()),t.addEventListener("mousedown",t=>t.stopPropagation());const n=t.querySelector(".sn-filter-field-select");n?.addEventListener("change",()=>{if("pivot"===this.$b?.type){const t=Number(n.value);this.Fb(t)}})}xb(t){this.ub&&(t.target.closest&&t.target.closest(".sn-filter-icon")||this.ub.contains(t.target)||this.hide())}show(t,e,n,i=null){const r=this.autoFilter;if(!r?.isScopeEnabled(i))return;document.removeEventListener("mousedown",this.wb),this.Cb(),this.pb=t,this.bb=i,this.$b=null,this.Mb=!0,this._b(!1),this.gb=r.getColumnValues(t,this.bb);const o=r.getColumnFilter(t,this.bb);this.yb="values"===o?.type?new Set(o.values.map(t=>String(t??""))):new Set(this.gb.map(t=>String(t.value??""))),this.Eb(this.gb);const a=this.ub.querySelector(".sn-filter-search-input");a&&(a.value="");const s=this.ub.querySelector(".sn-filter-title");if(s){const e=this.$.Utils.numToChar(t);s.textContent=this.mn("autoFilter.panel.titleColumn",{column:e})}const l=r.getSortOrder(t,this.bb);this.ub.querySelectorAll(".sn-filter-sort-item").forEach(t=>{t.dataset.sort===l?t.classList.add("active"):t.classList.remove("active")}),this.Ib(e,n)}showPivotFilter(t,e,n,i){const r=Array.isArray(e?.fields)?e.fields:[];if(!t||0===r.length)return;document.removeEventListener("mousedown",this.wb),this.Cb();const o=new Map;r.forEach(e=>{const n=t.pivotFields?.[e],i=new Set;this.zb(n).forEach(({item:t,itemIndex:e})=>{"1"!==t.h&&i.add(String(e))}),o.set(e,i)}),this.$b={type:"pivot",pivotTable:t,fields:r,activeField:r[0],pendingSelections:o},this.Mb=!1,this._b(r.length>1,r),this.Fb(r[0]),this.Ib(n,i)}hide(){this.ub&&this.ub.classList.remove("active"),this.pb=null,this.bb=null,this.$b=null,document.removeEventListener("mousedown",this.wb)}destroy(){this.hide(),this.ub&&this.ub.parentNode&&this.ub.parentNode.removeChild(this.ub),this.ub=null}Eb(t){const e=this.ub.querySelector(".sn-filter-list");if(!e)return;const n="pivot"!==this.$b?.type||!1!==this.$b?.pivotTable?.multipleFieldFilters;if(!n&&this.yb.size>1){const t=this.yb.values().next().value;this.yb=new Set(t?[t]:[])}e.innerHTML=t.map(t=>{const e=String(t.value??""),n=this.yb.has(e)?"checked":"",i=this.Db(t.text),r=this.Mb&&void 0!==t.count&&null!==t.count;return`\n                <div class="sn-filter-item" data-value="${this.Db(e)}">\n                    <input type="checkbox" ${n}>\n                    <label>${i}</label>\n                    ${r?`<span class="sn-filter-count">(${t.count})</span>`:""}\n                </div>\n            `}).join(""),e.querySelectorAll(".sn-filter-item").forEach(t=>{const e=t.querySelector('input[type="checkbox"]'),i=t.dataset.value;t.addEventListener("click",t=>{if(t.target!==e&&(e.checked=!e.checked),!n)return this.yb.clear(),this.yb.add(i),void this.Eb(this.gb);e.checked?this.yb.add(i):this.yb.delete(i)})})}Rb(t){const e=(t=t.toLowerCase().trim())?this.gb.filter(e=>e.text.toLowerCase().includes(t)):this.gb;this.Eb(e)}Ab(){if("pivot"===this.$b?.type){const t=this.$b.activeField,e=this.$b.pendingSelections;let n=e?.get(t);return n||(n=new Set,e?.set(t,n)),n.clear(),this.gb.forEach(t=>{n.add(String(t.value??""))}),this.yb=n,void this.Eb(this.gb)}this.yb=new Set(this.gb.map(t=>String(t.value??""))),this.Eb(this.gb)}kb(){if("pivot"===this.$b?.type){const t=this.$b.activeField,e=this.$b.pendingSelections;let n=e?.get(t);return n||(n=new Set,e?.set(t,n)),n.clear(),this.yb=n,void this.Eb(this.gb)}this.yb.clear(),this.Eb(this.gb)}Tb(t){if("pivot"===this.$b?.type){const e=this.$b.pivotTable,n=this.$b.activeField;if(!e||null==n)return;return e.setFieldSort(n,"asc"===t?"ascending":"descending"),e.calculate(),e.render(),void this.hide()}if(null===this.pb)return;const e=this.$.activeSheet,n=this.autoFilter.getScopeRange(this.bb);n&&(Tt(e,n,{col:this.pb,order:t})&&(this.autoFilter.setSortState(this.pb,t,this.bb),this.autoFilter.he(this.bb)),this.hide(),this.$.ue())}Nb(){if("pivot"===this.$b?.type){const t=this.$b.pivotTable,e=this.$b.fields||[],n=this.$b.pendingSelections;if(!t||0===e.length||!n)return;return e.forEach(e=>{const i=t.pivotFields?.[e];if(!i)return;const r=n.get(e)||new Set,o=this.zb(i);if(0===o.length)return void t.clearFieldFilter(e);if(r.size===o.length)return void t.clearFieldFilter(e);const a={};o.forEach(({itemIndex:t})=>{a[t]=!r.has(String(t))}),t.setItemsHidden(e,a)}),t.calculate(),t.render(),void this.hide()}if(null!==this.pb&&this.autoFilter){if(this.yb.size===this.gb.length)this.autoFilter.clearColumnFilter(this.pb,this.bb);else{const t=Array.from(this.yb).map(t=>{const e=this.gb.find(e=>String(e.value??"")===t);return e?e.value:t});this.autoFilter.setColumnFilter(this.pb,{type:"values",values:t},this.bb)}this.hide()}}_b(t,e=[]){const n=this.ub?.querySelector(".sn-filter-field"),i=this.ub?.querySelector(".sn-filter-field-select");if(!n||!i)return;if(!t)return n.classList.remove("active"),void(i.innerHTML="");const r=this.$b?.pivotTable;i.innerHTML=e.map(t=>`<option value="${t}">${r?.pivotFields?.[t]?.name||this.mn("pivot.field.fallbackName",{index:t+1})}</option>`).join(""),n.classList.add("active"),i.value=String(this.$b?.activeField??e[0])}Fb(t){const e=this.$b?.pivotTable;if(!e)return;const n=e.pivotFields?.[t];if(!n)return;const i=this.zb(n),r=new Set(i.map(({itemIndex:t})=>String(t)));this.$b.activeField=t,this.gb=i.map(({item:n,itemIndex:i})=>({value:String(i),text:e.Oi(t,n.x)||""}));const o=this.$b?.pendingSelections;let a=o?.get(t);a?(a=new Set([...a].filter(t=>r.has(String(t)))),o?.set(t,a)):(a=new Set,i.forEach(({item:t,itemIndex:e})=>{"1"!==t.h&&a.add(String(e))}),o?.set(t,a)),this.yb=a;const s=this.ub?.querySelector(".sn-filter-title");if(s){const e=n.name||this.mn("pivot.field.fallbackName",{index:t+1});s.textContent=this.mn("autoFilter.panel.titleField",{field:e})}const l=this.ub?.querySelector(".sn-filter-search-input");l&&(l.value=""),this.ub?.querySelectorAll(".sn-filter-sort-item").forEach(t=>{const e=n.sortType,i="asc"===t.dataset.sort&&"ascending"===e||"desc"===t.dataset.sort&&"descending"===e;t.classList.toggle("active",i)}),this.Eb(this.gb)}zb(t){if(!t?.items?.length)return[];const e=[];return t.items.forEach((t,n)=>{Number.isFinite(t?.x)&&e.push({item:t,itemIndex:n})}),e}Ib(t,e){const n=window.innerWidth,i=window.innerHeight,r=this.canvas.handleLayer.getBoundingClientRect();let o=r.left+t,a=r.top+e;o+260>n-10&&(o=n-260-10),a+400>i-10&&(a=i-400-10),o<10&&(o=10),a<10&&(a=10),this.ub.style.position="fixed",this.ub.style.left=`${o}px`,this.ub.style.top=`${a}px`,this.ub.style.zIndex="10000",this.ub.classList.add("active"),setTimeout(()=>{document.addEventListener("mousedown",this.wb)},0)}Db(t){return null==t?"":String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}}class pE{constructor(t){this.SN=t,this.ns=t.namespace,this.cache=new Map}get(t){if(!this.cache.has(t)){const e=this.creators[t];if(!e)return null;const n=e.call(this);this.cache.set(t,n)}return this.cache.get(t)}has(t){return this.cache.has(t)}destroy(t){const e=this.cache.get(t);e&&(e.remove(),this.cache.delete(t))}destroyAll(){this.cache.forEach(t=>t.remove()),this.cache.clear()}creators={"drag-line":function(){const t=document.createElement("div");return t.className="sn-drag-line",this.SN.containerDom.querySelector(".sn-top-layer").appendChild(t),t},"scroll-tip":function(){const t=document.createElement("div");return t.className="sn-scroll-tip",this.SN.containerDom.querySelector(".sn-top-layer").appendChild(t),t},"padding-type":function(){const t=this.ns,e=document.createElement("div");e.className="sn-dropdown sn-padding-type";const n=`\n                <div class="sn-dropdown-toggle">${cn("biaoge")}</div>\n                <ul class="sn-dropdown-menu">\n                    <li onclick="${t}.activeSheet.paddingArea(undefined,undefined,'order');${t}._r();">Sequence Fill</li>\n                    <li onclick="${t}.activeSheet.paddingArea(undefined,undefined,'copy');${t}._r();">Copy Cells</li>\n                    <li onclick="${t}.activeSheet.paddingArea(undefined,undefined,'format');${t}._r();">Fill Formatting Only</li>\n                    <li onclick="${t}.activeSheet.paddingArea(undefined,undefined,'noFormat');${t}._r();">Fill Without Formatting</li>\n                </ul>\n            `;return e.innerHTML=n,this.SN.containerDom.querySelector(".sn-top-layer").appendChild(e),e},"hyperlink-btn":function(){const t=document.createElement("div");return t.className="sn-hyperlink-jump-btn sn-cur",t.innerHTML=cn("chongzuo"),t.onclick=()=>this.SN.activeSheet.hyperlinkJump(t),this.SN.containerDom.querySelector(".sn-top-layer").appendChild(t),t},"hyperlink-tip":function(){const t=document.createElement("div");return t.className="sn-hyperlink-tip",this.SN.containerDom.querySelector(".sn-top-layer").appendChild(t),t},"valid-tip":function(){const t=document.createElement("div");return t.className="sn-valid-tip",t.innerHTML='<div class="fw-bold"></div><span></span>',this.SN.containerDom.querySelector(".sn-top-layer").appendChild(t),t},"valid-select":function(){const t=document.createElement("div");return t.className="sn-dropdown sn-cur bg-white sn-valid-select",t.innerHTML='<div class="sn-dropdown-toggle"></div><ul class="sn-dropdown-menu"></ul>',this.SN.containerDom.querySelector(".sn-top-layer").appendChild(t),t},"col-context-menu":function(){const t=this.ns,e=document.createElement("div");e.className="rc-box sn-col-rc";const n=`\n                <div onclick="${t}.Action.addCols(event,'left')">Insert <input type="number" min="1" max="10" value="1"> column(s) left</div>\n                <div onclick="${t}.Action.addCols(event,'right')">Insert <input type="number" min="1" max="10" value="1"> column(s) right</div>\n                <div onclick="${t}.Action.hidCols()">Hide Columns</div>\n                <div onclick="${t}.Action.delCols()">Delete Columns</div>\n            `;return e.innerHTML=n,this.SN.containerDom.querySelector(".sn-top-layer").appendChild(e),e},"row-context-menu":function(){const t=this.ns,e=document.createElement("div");e.className="rc-box sn-row-rc";const n=`\n                <div onclick="${t}.Action.addRows(event,'top')">Insert <input type="number" min="1" max="10" value="1"> row(s) above</div>\n                <div onclick="${t}.Action.addRows(event,'bottom')">Insert <input type="number" min="1" max="10" value="1"> row(s) below</div>\n                <div onclick="${t}.Action.hidRows()">Hide Rows</div>\n                <div onclick="${t}.Action.delRows()">Delete Rows</div>\n            `;return e.innerHTML=n,this.SN.containerDom.querySelector(".sn-top-layer").appendChild(e),e},"cell-context-menu":function(){const t=this.ns,e=document.createElement("div");e.className="rc-box sn-cell-rc",e.onclick=()=>{e.style.display="none"};const n=`\n                <div onclick="${t}.Action.fontInversion('bold');">${cn("bold")} Bold</div>\n                <div onclick="${t}.Action.fontInversion('italic');">${cn("italic")} Italic</div>\n                <div onclick="${t}.Action.fontInversion('underline','single');">${cn("underline")} Underline</div>\n                <div onclick="${t}.Action.fontInversion('strike');">${cn("strikethrough")} Strikethrough</div>\n                <div onclick="${t}.AI.chatInput(areaDom.innerText)">${cn("gengduo")} More</div>\n            `;return e.innerHTML=n,this.SN.containerDom.querySelector(".sn-top-layer").appendChild(e),e},"drawing-context-menu":function(){const t=this.ns,e=document.createElement("div");e.className="rc-box sn-drawing-rc",e.onclick=()=>{e.style.display="none"};const n=`\n                <div onclick="${t}.AI.chatInput('Please adjust drawing ID ' + ${t}.Canvas.activeDrawing?.id + ': ')">${cn("monifenxi")} AI Adjust</div>\n                <div onclick="${t}.Canvas.activeDrawing.updIndex('top');${t}._r('s');">${cn("alignTop")} Bring to Front</div>\n                <div onclick="${t}.Canvas.activeDrawing.updIndex('bottom');${t}._r('s');">${cn("alignBottom")} Send to Back</div>\n                <div onclick="${t}.Canvas.activeDrawing.updIndex('up');${t}._r('s');">${cn("plus")} Bring Forward</div>\n                <div onclick="${t}.Canvas.activeDrawing.updIndex('down');${t}._r('s');">${cn("minus")} Send Backward</div>\n                <div onclick="${t}.activeSheet.Drawing.remove(${t}.Canvas.activeDrawing.id);${t}._r('s');">${cn("clear")} Delete Drawing</div>\n            `;return e.innerHTML=n,this.SN.containerDom.querySelector(".sn-top-layer").appendChild(e),e}};get dragLine(){return this.get("drag-line")}get scrollTip(){return this.get("scroll-tip")}get paddingType(){return this.get("padding-type")}get hyperlinkBtn(){return this.get("hyperlink-btn")}get hyperlinkTip(){return this.get("hyperlink-tip")}get validTip(){return this.get("valid-tip")}get validSelect(){return this.get("valid-select")}get colContextMenu(){return this.get("col-context-menu")}get rowContextMenu(){return this.get("row-context-menu")}get cellContextMenu(){return this.get("cell-context-menu")}get drawingContextMenu(){return this.get("drawing-context-menu")}}class mE{constructor(t){this.SN=t,this.Utils=t.Utils,this.dom=t.containerDom.querySelector(".sn-canvas"),this.showLayer=t.containerDom.querySelector(".sn-show-layer"),this.handleLayer=t.containerDom.querySelector(".sn-handle-layer"),this.buffer=document.createElement("canvas"),this.showLayerKZ=document.createElement("canvas"),this.pCanvas=document.createElement("canvas"),this.pCanvas.width=this.pCanvas.height=8,this.pCtx=this.pCanvas.getContext("2d"),this.activeBorderInfo=null,this.mpBorder={},this.lastPadding=null,this.moveAreaName=null,this.disableMoveCheck=!1,this.disableScroll=!1,this.input=t.containerDom.querySelector(".sn-input-editor"),this.formulaBar=t.containerDom.querySelector(".sn-formula-bar"),this.inputEditing=!1,this.areaInput=t.containerDom.querySelector(".sn-area-input"),this.areaBox=t.containerDom.querySelector(".sn-area-box"),this.areaDropdown=t.containerDom.querySelector(".sn-area-dropdown"),this.rollX=t.containerDom.querySelector(".sn-roll-x"),this.rollXS=t.containerDom.querySelector(".sn-roll-x>div"),this.rollY=t.containerDom.querySelector(".sn-roll-y"),this.rollYS=t.containerDom.querySelector(".sn-roll-y>div"),this.drawingsCon=t.containerDom.querySelector(".sn-drawings-con"),this.slicersCon=t.containerDom.querySelector(".sn-slicers-con"),this.maxTop=0,this.maxLeft=0,this.lazyDOM=new pE(t),this.filterPanelManager=new fE(this),this.rCount=0,this.hoveredComment=null,this.statSum=t.containerDom.querySelector('[data-stat="sum"]'),this.statCount=t.containerDom.querySelector('[data-stat="count"]'),this.statAvg=t.containerDom.querySelector('[data-stat="avg"]'),this.Lb=null,this.highlightColor=null,this.eyeProtectionMode=!1,this.eyeProtectionColor="rgb(204,232,207)",this.addEventListeners(),this.Ob(),this.viewResize()}get paddingType(){return this.lazyDOM.paddingType}get hyperlinkJumpBtn(){return this.lazyDOM.hyperlinkBtn}get hyperlinkTip(){return this.lazyDOM.hyperlinkTip}get validSelect(){return this.lazyDOM.validSelect}get validTip(){return this.lazyDOM.validTip}get scrollTip(){return this.lazyDOM.scrollTip}viewResize(){this.dpr=window.devicePixelRatio||1;const{clientWidth:t,clientHeight:e}=this.dom;[this.showLayer,this.handleLayer,this.buffer,this.showLayerKZ].forEach(n=>{n.width=t*this.dpr,n.height=e*this.dpr,n.style.width=t+"px",n.style.height=e+"px"}),this.Nt=null,this.Mt=null,this.ctx=this.showLayer.getContext("2d"),this.ctxKZ=this.showLayerKZ.getContext("2d"),this.HDctx=this.handleLayer.getContext("2d"),this.#s(),this.activeSheet&&(this.updateScrollBarSize(),this.updateOverlayContainers())}get width(){return this.Nt??(this.Nt=this.showLayer.offsetWidth)}get height(){return this.Mt??(this.Mt=this.showLayer.offsetHeight)}get viewWidth(){return this.width/(this.activeSheet?.zoom??1)}get viewHeight(){return this.height/(this.activeSheet?.zoom??1)}toLogical(t){return t/(this.activeSheet?.zoom??1)}toPhysical(t){return t*(this.activeSheet?.zoom??1)}get pixelRatio(){return this.Pb??(this.dpr||1)*(this.activeSheet?.zoom??1)}get halfPixel(){return.5/this.pixelRatio}px(t){return t/this.pixelRatio}snap(t){const e=this.pixelRatio;return Math.round(t*e)/e}snapRect(t,e,n,i){const r=this.pixelRatio,o=Math.round(t*r)/r,a=Math.round(e*r)/r;return{x:o,y:a,w:Math.round((t+n)*r)/r-o,h:Math.round((e+i)*r)/r-a}}get activeSheet(){return this.SN.activeSheet}get inputEditing(){return!0===this.Vb}set inputEditing(t){const e=Boolean(t);this.Vb!==e&&(this.Vb=e,this.#l())}#l(){if(this.input){if(this.Vb)return this.input.style.zIndex="999",this.input.style.opacity="1",void(this.input.style.pointerEvents="auto");this.input.style.zIndex="-1",this.input.style.opacity="0",this.input.style.pointerEvents="none"}}getEventPosition(t){const e=this.handleLayer.getBoundingClientRect();return{x:this.toLogical(t.clientX-e.left),y:this.toLogical(t.clientY-e.top)}}getCellIndexByPosition(t,e){let n=this.activeSheet.indexWidth,i=this.activeSheet.headHeight,r=-1;this.activeSheet.vi.rowsIndex.forEach(t=>{const n=this.activeSheet.getRow(t).height;e>=i&&e<i+n&&-1===r&&(r=t),i+=n});let o=-1;return n=this.activeSheet.indexWidth,this.activeSheet.vi.colsIndex.forEach(e=>{const i=this.activeSheet.getCol(e).width;t>=n&&t<n+i&&-1===o&&(o=e),n+=i}),-1==o&&t>=this.activeSheet.vi.w&&(o=this.activeSheet.vi.colsIndex[this.activeSheet.vi.colsIndex.length-1]),-1==r&&e>=this.activeSheet.vi.h&&(r=this.activeSheet.vi.rowsIndex[this.activeSheet.vi.rowsIndex.length-1]),{c:o,r}}applyZoom(){if(!this.bc)return;const t=this.activeSheet?.zoom??1,e=(this.dpr||1)*t;this.Pb=e,this.bc.setTransform(e,0,0,e,0,0),this.bc.translate(-.5/e,-.5/e),this.Nt=null,this.Mt=null,this.activeSheet&&(this.updateScrollBarSize(),this.updateOverlayContainers(),this.updateScrollBar()),this.inputEditing&&this.currentCell&&this.updateInputPosition?.()}clearBuffer(t=this.buffer.width,e=this.buffer.height){this.bc&&(this.bc.save(),this.bc.setTransform(1,0,0,1,0,0),this.bc.clearRect(0,0,t,e),this.bc.restore())}#s(){this.bc=this.buffer.getContext("2d");const t=this.activeSheet?.zoom??1,e=(this.dpr||1)*t;this.Pb=e,this.bc.setTransform(e,0,0,e,0,0),this.bc.font="14.6px 宋体",this.bc.lineWidth=1,this.bc.translate(-.5/e,-.5/e)}updateScrollBarSize(){const t=this.activeSheet;if(!t)return;const e=Math.max(0,this.viewHeight-t.headHeight),n=Math.max(0,this.viewWidth-t.indexWidth),i=t.getTotalHeight(),r=t.getTotalWidth(),o=this.rollY.offsetHeight,a=this.rollX.offsetWidth,s=Math.min(.3,e/i),l=Math.min(.3,n/r),c=Math.max(30,o*s),h=Math.max(30,a*l);this.rollYS.style.height=c+"px",this.rollXS.style.width=h+"px",this.maxTop=o-c,this.maxLeft=a-h}updateOverlayContainers(){const t=this.activeSheet;if(!t)return;const e=t.zoom??1,n=t.indexWidth*e,i=t.headHeight*e,r=Math.max(0,this.width-n),o=Math.max(0,this.height-i),a=t=>{t&&(t.style.left=`${n}px`,t.style.top=`${i}px`,t.style.width=`${r}px`,t.style.height=`${o}px`)};a(this.slicersCon),a(this.drawingsCon)}updateScrollBar(){const t=this.activeSheet;if(!t||!t.vi)return;const e=t.getTotalHeight(),n=t.getTotalWidth(),i=t.getRow(t.rowCount-1)?.height||0,r=t.getCol(t.colCount-1)?.width||0,o=Math.max(0,e-i),a=Math.max(0,n-r),s=t.getScrollTop(t.vi.rowArr[0]),l=t.getScrollLeft(t.vi.colArr[0]),c=o>0?s/o*this.maxTop:0,h=a>0?l/a*this.maxLeft:0;this.rollYS.style.transform=`translateY(${Math.min(c,this.maxTop)}px)`,this.rollXS.style.transform=`translateX(${Math.min(h,this.maxLeft)}px)`}#c(t){if(Object.keys(this.mpBorder).length<1)return;const{x:e,y:n,w:i,h:r,inView:o}=t.getAreaInviewInfo(this.mpBorder);if(!o)return;const a=this.snapRect(e,n,i,r),s=this.px(5);this.bc.beginPath(),this.bc.lineWidth=this.px(1.5),this.bc.setLineDash([s,s]),this.bc.strokeStyle="#333",this.bc.strokeRect(a.x,a.y,a.w,a.h),this.bc.closePath(),this.bc.lineWidth=this.px(1),this.bc.setLineDash([])}#h(t){this.bc.beginPath(),this.bc.strokeStyle="#36c",this.bc.lineWidth=this.px(1);const e=t.vi;if(0!=e.frozenCols.length){const t=this.snap(e.fw);this.bc.moveTo(t,0),this.bc.lineTo(t,this.viewHeight),this.bc.stroke()}if(0!=e.frozenRows.length){const t=this.snap(e.fh);this.bc.moveTo(0,t),this.bc.lineTo(this.viewWidth,t),this.bc.stroke()}}getCellIndex(t){const{x:e,y:n}=this.getEventPosition(t);return this.getCellIndexByPosition(e,n)}Bb(){this.statSum&&this.statCount&&this.statAvg&&(this.Lb&&cancelAnimationFrame(this.Lb),this.Lb=requestAnimationFrame(()=>{const t=this.activeSheet;let e=0,n=0;const i=this.SN.t("layout.zoomSum"),r=this.SN.t("layout.zoomCount"),o=this.SN.t("layout.zoomAverage");t.eachCells(t.activeAreas,(i,r)=>{const o=t.getCell(i,r);if(o.isMerged&&o.master)return;const a=o.H;"number"!=typeof a||isNaN(a)||(e+=a,n++)}),this.statSum.textContent=`${i}: ${n?e.toLocaleString():"-"}`,this.statCount.textContent=`${r}: ${n||"-"}`,this.statAvg.textContent=`${o}: ${n?(e/n).toLocaleString():"-"}`}))}setHighlight(t){const e=t.target.closest(".sn-hl-btn");if(!e)return;this.highlightColor=e.dataset.color||null;const n=this.highlightColor,i=this.SN.containerDom.querySelector(".sn-highlight-menu .sn-highlight-panel");if(i){i.querySelectorAll(".sn-hl-btn").forEach(t=>{t.classList.toggle("sn-btn-selected",t.dataset.color===(n??""))});const t=i.closest(".sn-dropdown");t&&t.classList.toggle("sn-hl-active",!!n)}this.r()}toggleEyeProtection(){this.eyeProtectionMode=!this.eyeProtectionMode;const t=this.SN.containerDom.querySelector('[data-icon="huyan_"]')?.closest(".sn-tools-item");t&&t.classList.toggle("sn-btn-selected",this.eyeProtectionMode),this.r()}async r(t,e={}){performance.now();const n=!!e.targetCanvas,i=this.dpr;n&&Number.isFinite(e.dpr)&&(this.dpr=e.dpr);let r=this.activeSheet;try{if(n)r=e.sheet||this.activeSheet,e.Hb=this.buffer.width,e.Ub=this.buffer.height,this.buffer.width=e.width,this.buffer.height=e.height,this.#s(),e.Kb=this.Nt,e.Wb=this.Mt,this.Nt=e.width/this.dpr,this.Mt=e.height/this.dpr;else{if(this.jb)return this.qb=!0,void(this.Gb=t);this.jb=!0,this.qb=!1,requestAnimationFrame(()=>{this.jb=!1,this.qb&&(this.qb=!1,this.r(this.Gb))}),this.ctx.clearRect(0,0,this.showLayer.width,this.showLayer.height)}if(this.clearBuffer(n?e.width:void 0,n?e.height:void 0),"s"==t)return this.ctx.drawImage(this.showLayerKZ,0,0),this.rIndex(r),void this.Bb();if(n){const t=this.dpr||1;r.To(e.width/t,e.height/t)}else r.To(),this.updateOverlayContainers();if(this.rBaseData(r),this.rConditionalFormats(r),this.rMerged(r),this.rSparklines(r),this.rCommentIndicators(r),this.rCommentBoxes(r),this.rFilterIcons(r),this.rPivotTablePlaceholders(r),this.rBorder(this.borders),this.#c(r),this.#h(r),n||(this.ctxKZ.clearRect(0,0,this.showLayer.width,this.showLayer.height),this.ctxKZ.drawImage(this.buffer,0,0)),n){this.rIndex(r,!0,{hideSelectionFrame:!!e.hideSelectionFrame});const t=++this.rCount;await this.rDrawing(t,e);const n=this.getLight(),o=e.hideSelectionFrame?{rows:[],columns:[]}:n;this.rRowColHeaders(r,o);const a=e.targetCanvas.getContext("2d");a.clearRect(0,0,e.width,e.height),a.drawImage(this.buffer,0,0),this.dpr!==i&&(this.dpr=i),this.buffer.width=e.Hb,this.buffer.height=e.Ub,this.#s(),this.Nt=e.Kb,this.Mt=e.Wb}else this.rIndex(r),this.updateScrollBarSize(),this.updateScrollBar()}finally{n&&this.dpr!==i&&(this.dpr=i,this.Pb=null)}}}Object.assign(mE.prototype,{rCell:wi,rCellBackground:yi,rCellText:bi,rCellTextWithOverflow:xi,rMerged:function(t){t.merges.forEach(e=>{const{s:n,e:i}=e,r=t.getAreaInviewInfo(e),o=t.getCell(n.r,n.c);if(r.inView){wi.call(this,r.x,r.y,r.w,r.h,o);const{s:n,e:i}=e,a=n.r,s=n.c,l=i.r,c=i.c,h={};let u=!0;const d=t.getCell(a,s).border.top;for(let e=s+1;e<=c;e++){const n=t.getCell(a,e).border.top;if(!n||n.color!==d.color||n.style!==d.style){u=!1;break}}u&&d&&(h.top={color:d.color,style:d.style});let f=!0;const p=t.getCell(a,c).border.right;for(let e=a+1;e<=l;e++){const n=t.getCell(e,c).border.right;if(!n||n.color!==p.color||n.style!==p.style){f=!1;break}}f&&p&&(h.right={color:p.color,style:p.style});let m=!0;const g=t.getCell(l,s).border.bottom;for(let e=s+1;e<=c;e++){const n=t.getCell(l,e).border.bottom;if(!n||n.color!==g.color||n.style!==g.style){m=!1;break}}m&&g&&(h.bottom={color:g.color,style:g.style});let v=!0;const y=t.getCell(a,s).border.left;for(let e=a+1;e<=l;e++){const n=t.getCell(e,s).border.left;if(!n||n.color!==y.color||n.style!==y.style){v=!1;break}}v&&y&&(h.left={color:y.color,style:y.style});const b=t.getCell(a,s).border;b.diagonal&&(h.diagonal={color:b.diagonal.color,style:b.diagonal.style},b.diagonalDown&&(h.diagonalDown=!0),b.diagonalUp&&(h.diagonalUp=!0)),Object.keys(h).length>0&&this.borders.push({b:h,x:r.x,y:r.y,w:r.w,h:r.h,r:a,c:s})}})},rBorder:function(t){const e=t=>this.snap(t),n=t=>this.px(t),i={thin:{lineWidth:1},dotted:{lineWidth:1,lineDash:[1,2]},dashDot:{lineWidth:1,lineDash:[4,2,1,2]},hair:{lineWidth:.5},dashDotDot:{lineWidth:1,lineDash:[4,2,1,2,1,2]},slantDashDot:{lineWidth:1,lineDash:[5,5]},mediumDashed:{lineWidth:1.5,lineDash:[7,5]},mediumDashDotDot:{lineWidth:1.5,lineDash:[4,2,1,2,1,2]},mediumDashDot:{lineWidth:1.5,lineDash:[4,2,1,2]},medium:{lineWidth:1.5},double:{lineWidth:1},thick:{lineWidth:2.5},dashed:{lineWidth:1,lineDash:[5,5]}},r=(t,r,o,a,s,l,c,h)=>{const u=i[c];if(!u)return;const d=e(r),f=e(o),p=e(r+a),m=e(o+s),g=n(1),v="hair"===c;t.save(),t.beginPath(),t.strokeStyle=h,t.lineWidth=n(v?1:u.lineWidth),v&&(t.globalAlpha=.5),u.lineDash?t.setLineDash(u.lineDash.map(n)):t.setLineDash([]);const y=(e,n,i,r)=>{t.moveTo(e,n),t.lineTo(i,r)},b=(t,n,i,r)=>{const o=i-t,a=r-n,s=Math.hypot(o,a)||1,l=a/s*g,c=-o/s*g;y(e(t-l),e(n-c),e(i-l),e(r-c)),y(e(t+l),e(n+c),e(i+l),e(r+c))};switch(l){case"top":"double"===c?(y(d,e(f-g),p,e(f-g)),y(d,e(f+g),p,e(f+g))):y(d,f,p,f);break;case"bottom":"double"===c?(y(d,e(m-g),p,e(m-g)),y(d,e(m+g),p,e(m+g))):y(d,m,p,m);break;case"left":"double"===c?(y(e(d-g),f,e(d-g),m),y(e(d+g),f,e(d+g),m)):y(d,f,d,m);break;case"right":"double"===c?(y(e(p-g),f,e(p-g),m),y(e(p+g),f,e(p+g),m)):y(p,f,p,m);break;case"diagonalDown":"double"===c?b(d,f,p,m):y(d,f,p,m);break;case"diagonalUp":"double"===c?b(d,m,p,f):y(d,m,p,f)}t.stroke(),t.closePath(),t.restore()};t.forEach(t=>{const e=this.hiddenBorders&&void 0!==t.r&&void 0!==t.c?this.hiddenBorders.get(`${t.r},${t.c}`):null;["top","bottom","left","right"].forEach(n=>{const o=t.b[n];e&&e[n]||i[o?.style]&&r(this.bc,t.x,t.y,t.w,t.h,n,o.style,o.color)});const n=t.b.diagonal;if(i[n?.style]){const e=!0===t.b.diagonalUp;(!0===t.b.diagonalDown||!e&&void 0===t.b.diagonalDown)&&r(this.bc,t.x,t.y,t.w,t.h,"diagonalDown",n.style,n.color),e&&r(this.bc,t.x,t.y,t.w,t.h,"diagonalUp",n.style,n.color)}})},rBaseData:function(t){this.bc.strokeStyle="#ddd",this.bc.textAlign="left",this.bc.textBaseline="top",this.borders=[],this.hiddenBorders=new Map;const e=new Map,n=new Set,i=t.CF,r=i&&i.rules.length>0;let o=null;r&&(o=new Map,i.rules.forEach(t=>{t.needsRangeData&&!o.has(t.sqref)&&o.set(t.sqref,t.getRangeData())}));let a=t.headHeight;if(t.vi.rowsIndex.forEach(o=>{let s=t.indexWidth,l=t.getRow(o).height;t.getRow(o),t.vi.colsIndex.forEach(c=>{let h=t.getCol(c).width;const u=t.getCell(o,c);if(!u.isMerged){const d=s,f=a,p=r?i.getFormat(o,c):null,m=function(t,e,n){if(!t?.Table?.size)return null;const i=t.Table.getTableAt(e,n);if(!i)return null;const r=i.style;if(!r)return null;const o=!0!==r.be,a=r.dataFg;if(i.isHeaderCell(e,n)){const t={bgColor:r.headerBg,fgColor:r.headerFg??a,isBold:!1!==r.headerBold,borderColor:r.headerBorder??r.border,Ce:!0===i.Ce};return gi(o?mi(t,i.Pe?.()):t,a)}if(i.isTotalsCell(e,n))return gi({bgColor:r.totalsBg,fgColor:r.totalsFg??a,isBold:!1!==r.totalsBold,borderColor:r.border,Ce:!0===i.Ce},a);if(i.isDataCell(e,n)){const t=i.getDataRowIndex(e),s=i.getColumnIndex(n);let l=r.dataBg??null,c=a??null,h=!!r.dataBold;i.showRowStripes&&t>=0&&(l=vi(t,r.rowStripe1,r.rowStripe2,r.rowStripe1Size,r.rowStripe2Size)),i.showColumnStripes&&s>=0&&(l=vi(s,pi(r.columnStripe1,r.rowStripe2,r.rowStripe1,l),pi(r.columnStripe2,r.rowStripe1,r.rowStripe2,l),r.columnStripe1Size,r.columnStripe2Size)),i.showFirstColumn&&0===s&&(l=pi(r.firstColumnBg,l),c=pi(r.firstColumnFg,c),h=r.firstColumnBold??h);const u=i.range.e.c-i.range.s.c;return i.showLastColumn&&s===u&&(l=pi(r.lastColumnBg,l),c=pi(r.lastColumnFg,c),h=r.lastColumnBold??h),gi(o?mi({bgColor:l,fgColor:c,isBold:h,borderColor:r.border,Ce:!0===i.Ce},i.Ve?.(s)):{bgColor:l,fgColor:c,isBold:h,borderColor:r.border,Ce:!0===i.Ce},a)}return null}(t,o,c);yi.call(this,d,f,h,l,u,!0,p,m),e.set(`${o},${c}`,{x:d,y:f,w:h,h:l,cellInfo:u,row:o,col:c,cfFormat:p,tableStyle:m}),u.showVal&&u.showVal.toString()&&n.add(`${o},${c}`);const g=!0===m?.Ce?m?.borderColor:null,v=g?function(t,e){if(!t||"object"!=typeof t||!e)return t||{};let n=!1;const i={...t},r=["top","right","bottom","left"];for(const o of r){const r=t[o];r?.style&&(i[o]={...r,color:e},n=!0)}return t.diagonal?.style&&(i.diagonal={...t.diagonal,color:e},n=!0),n?i:t}(u.border||{},g):u.border||{},y=p?.border?{...v,...p.border}:v;Object.keys(y).length>0&&this.borders.push({b:y,x:d,y:f,w:h,h:l,r:o,c})}s+=h}),a+=l}),this.Xb=e,e.forEach((t,e)=>{const{x:n,y:i,w:r,h:o,cfFormat:a}=t;a?.dataBar&&this.rDataBar(n,i,r,o,a.dataBar)}),e.forEach((e,i)=>{const{x:r,y:o,w:a,h:s,cellInfo:l,row:c,col:h,cfFormat:u,tableStyle:d}=e;l.showVal&&l.showVal.toString()&&!l.isMerged&&xi.call(this,c,h,r,o,a,s,l,t,n,u,d)}),t.showGridLines){const t=this.px(1);e.forEach((e,n)=>{const{x:i,y:r,w:o,h:a,cellInfo:s,cfFormat:l}=e,c=this.hiddenBorders.get(n),h=this.snap(i),u=this.snap(r),d=this.snap(i+o),f=this.snap(r+a),p=l?.fill?.fgColor;this.bc.strokeStyle=p||s.fill.fgColor||"#ddd",this.bc.lineWidth=t,this.bc.beginPath(),c?(c.top||(this.bc.moveTo(h,u),this.bc.lineTo(d,u)),c.bottom||(this.bc.moveTo(h,f),this.bc.lineTo(d,f)),c.left||(this.bc.moveTo(h,u),this.bc.lineTo(h,f)),c.right||(this.bc.moveTo(d,u),this.bc.lineTo(d,f)),this.bc.stroke()):this.bc.strokeRect(h,u,d-h,f-u)})}t.vi.hasContent=n.size>0},getOffset:function(t,e,n,i){const r=this.handleLayer.getBoundingClientRect(),o=this.activeSheet?.zoom??1,a={s:{},e:{}},{r:s,c:l}=this.getCellIndex({clientX:r.left+t*o,clientY:r.top+e*o}),{r:c,c:h}=this.getCellIndex({clientX:r.left+(t+n)*o,clientY:r.top+(e+i)*o});a.s.r=s,a.s.c=l,a.e.r=c,a.e.c=h;const u=this.activeSheet,d=u.getCellInViewInfo(s,l,!1),f=u.getCellInViewInfo(c,h,!1);return a.s.offsetX=t-d.x,a.s.offsetY=e-d.y,a.e.offsetX=t+n-f.x,a.e.offsetY=e+i-f.y,a},rDrawing:async function(t,e={}){const n=!!e.targetCanvas;!n&&this.slicersCon&&this.slicersCon.querySelectorAll(".sn-slicer").forEach(t=>{t.style.display="none"}),n||this.HDctx.clearRect(0,0,this.showLayer.width,this.showLayer.height);const i=this.activeSheet;if(0!=i.Drawing.getAll().length){n||this.clearBuffer();for(let e of i.Drawing.getAll()){if(e.zn&&(await e.zn,t!==this.rCount))return;const n=i.ko(e.area,!0);if(e.inView=n.inView,!n.inView){"slicer"===e.type&&e.Slicer&&e.Slicer.render(this,0,0,0,0,!1);continue}let r,o,a=n.w-e.area.s.offsetX-(i.getCol(e.area.e.c).width-e.area.e.offsetX),s=n.h-e.area.s.offsetY-(i.getRow(e.area.e.r).height-e.area.e.offsetY);if("twoCell"!==e.anchorType&&(a=e.width,s=e.height),e.moving?(r=e.position.x,o=e.position.y):(e.position,r=n.x+e.area.s.offsetX,o=n.y+e.area.s.offsetY),"slicer"===e.type)e.Slicer&&e.Slicer.render(this,r,o,a,s,!0);else if("image"===e.type)try{if(!e.drawCache){const n=new Image;if(await new Promise((t,i)=>{n.onload=()=>{e.drawCache=n,t()},n.onerror=i,n.src=e.imageBase64}),t!==this.rCount)return}if(t!==this.rCount)return;e.Fn?(this.bc.save(),this.bc.translate(r+a/2,o+s/2),this.bc.rotate(e.Fn*Math.PI/180),this.bc.drawImage(e.drawCache,-a/2,-s/2,a,s),this.bc.restore()):this.bc.drawImage(e.drawCache,r,o,a,s)}catch(t){}if("chart"===e.type){const n=this.pixelRatio,i=this.snapRect(r,o,a,s),l=i.w,c=i.h;if(!e.drawCache||e.Yb!==l||e.Jb!==c||!Number.isFinite(e.Zb)||Math.abs(e.Zb-n)>.001){const t=this.rCount,i=document.createElement("canvas"),r=Math.max(1,Math.round(l*n)),o=Math.max(1,Math.round(c*n));i.width=r,i.height=o;const a=Lw(i,null,{renderer:"canvas",width:l,height:c,devicePixelRatio:n});e.drawCache=i,e.Yb=l,e.Jb=c,e.Zb=n;const s=new Promise((t,e)=>{a.on("finished",()=>{t()}),a.on("error",t=>{e(t)})});if(a.setOption(e.renderOption),await s,t!==this.rCount)return}if(t!==this.rCount)return;const h=this.halfPixel,u=this.bc.imageSmoothingEnabled;this.bc.imageSmoothingEnabled=!1,this.bc.drawImage(e.drawCache,i.x+h,i.y+h,i.w,i.h),this.bc.imageSmoothingEnabled=u,this.bc.strokeStyle="#ccc",this.bc.lineWidth=this.px(1),this.bc.strokeRect(i.x+h,i.y+h,i.w,i.h)}if("shape"===e.type)if(e.isConnector){const t=r,n=o,i=r+a,l=o+s,c=e.shapeStyle,h=e.shapeType||"straightConnector1",u=c_(this.bc,h,t,n,i,l,c),d=8*(c.strokeWidth||1);c.startArrow&&"none"!==c.startArrow&&h_(this.bc,t,n,u.startAngle+Math.PI,d,c.startArrow,c.stroke),c.endArrow&&"none"!==c.endArrow&&h_(this.bc,i,l,u.endAngle,d,c.endArrow,c.stroke)}else{const n=this.pixelRatio,i=Math.max(1,a),l=Math.max(1,s);if(e.isTextBox){const t=this.snapRect(r,o,i,l);e.Fn?(this.bc.save(),this.bc.translate(t.x+t.w/2,t.y+t.h/2),this.bc.rotate(e.Fn*Math.PI/180),a_(this.bc,e,-t.w/2,-t.h/2,t.w,t.h,n),this.bc.restore()):a_(this.bc,e,t.x,t.y,t.w,t.h,n)}else{const a=Math.max(0,e.shapeStyle?.strokeWidth||0),s=Math.max(1,Math.ceil(2*a)),c=i+2*s,h=l+2*s;if(!e.drawCache||e.Yb!==i||e.Jb!==l||e.Qb!==a||!Number.isFinite(e.Zb)||Math.abs(e.Zb-n)>.001){const t=document.createElement("canvas");t.width=Math.max(1,Math.round(c*n)),t.height=Math.max(1,Math.round(h*n));const r=t.getContext("2d");r.setTransform(n,0,0,n,0,0),a_(r,e,s,s,i,l,n),e.drawCache=t,e.Yb=i,e.Jb=l,e.Qb=a,e.Zb=n}if(t!==this.rCount)return;const u=r-s,d=o-s,f=i+2*s,p=l+2*s,m=this.snapRect(u,d,f,p);e.Fn?(this.bc.save(),this.bc.translate(m.x+m.w/2,m.y+m.h/2),this.bc.rotate(e.Fn*Math.PI/180),this.bc.drawImage(e.drawCache,-m.w/2,-m.h/2,m.w,m.h),this.bc.restore()):this.bc.drawImage(e.drawCache,m.x,m.y,m.w,m.h)}}if(e.active){const t=8,n=t/2,i=r+a/2,l=o+s/2;e.Fn&&(this.bc.save(),this.bc.translate(i,l),this.bc.rotate(e.Fn*Math.PI/180),this.bc.translate(-i,-l));const c=[{x:r,y:o},{x:i,y:o},{x:r+a,y:o},{x:r,y:l},{x:r+a,y:l},{x:r,y:o+s},{x:i,y:o+s},{x:r+a,y:o+s}];if(this.bc.fillStyle="white",this.bc.strokeStyle="#333",this.bc.lineWidth=1,this.bc.strokeRect(r,o,a,s),c.forEach(e=>{const i=e.x-n,r=e.y-n;this.bc.fillRect(i,r,t,t),this.bc.strokeRect(i,r,t,t)}),"image"===e.type||"shape"===e.type&&!e.isConnector){const t=5,e=i,r=o-30;this.bc.strokeStyle="#333",this.bc.beginPath(),this.bc.moveTo(i,o-n),this.bc.lineTo(e,r+t),this.bc.stroke(),this.bc.beginPath(),this.bc.arc(e,r,t,0,2*Math.PI),this.bc.fillStyle="white",this.bc.fill(),this.bc.stroke()}e.Fn&&this.bc.restore()}e.position={x:r,y:o,w:a,h:s}}this.ab?.(),t===this.rCount&&(n||(this.bc.clearRect(-.5,-.5,this.showLayer.width+1,i.headHeight+1),this.bc.clearRect(-.5,-.5,i.indexWidth+1,this.showLayer.height+1),this.HDctx.drawImage(this.buffer,0,0)))}else this.ab?.()},captureScreenshot:async function(t,e="topleft",n={}){const{width:i=1600,height:r=1e3,compress:o=!0,hideSelectionFrame:a=!1}=n;let s,l;t.includes("!")?([s,l]=t.split("!"),s&&s.startsWith("'")&&s.endsWith("'")&&(s=s.slice(1,-1))):(l=t,s=null);const c=this.SN.sheets.find(t=>t.name===s)||this.activeSheet;c.J();let{r:h,c:u}=this.Utils.cellStrToNum(l);if("center"===e){const t=c.defaultColWidth||80,e=c.defaultRowHeight||25,n=Math.floor(i/t/2),o=Math.floor(r/e/2);h=Math.max(0,h-o),u=Math.max(0,u-n)}const d=c.vi,f=d?null:{...c.viewStart};try{c.vi={rowArr:[h],colArr:[u]},this.screenshotCanvas||(this.screenshotCanvas=document.createElement("canvas"));const t=2,e=Math.round(i*t),n=Math.round(r*t);if(this.screenshotCanvas.width=e,this.screenshotCanvas.height=n,await this.r(null,{sheet:c,targetCanvas:this.screenshotCanvas,width:e,height:n,dpr:t,hideSelectionFrame:a}),!1===o)return this.screenshotCanvas.toDataURL("image/png");const s="number"==typeof o?o:.45;return this.screenshotCanvas.toDataURL("image/webp",s)}finally{d?c.vi=d:f&&(c.viewStart=f,c.To())}},getLight:function(){const t=this.activeSheet,e=t.activeAreas,n=new Set,i=new Set,r=[];return e.forEach(e=>{const{x:o,y:a,w:s,h:l,inView:c}=t.getAreaInviewInfo(e);r.push({x:o,y:a,w:s,h:l,inView:c,area:e});for(let i=e.s.r;i<=e.e.r;i++)t.vi.rowsIndex.includes(i)&&n.add(i);for(let n=e.s.c;n<=e.e.c;n++)t.vi.colsIndex.includes(n)&&i.add(n)}),this.activeBorderInfo=r[r.length-1],{frames:r,lastFrame:this.activeBorderInfo,rows:Array.from(n),columns:Array.from(i)}},rAllBtn:function(){this.bc.beginPath(),this.bc.strokeStyle="#ddd",this.bc.lineWidth=this.px(1),this.bc.fillStyle="#f0f0f0",this.bc.fillRect(0,0,this.activeSheet.indexWidth,this.activeSheet.headHeight),this.bc.beginPath(),this.bc.moveTo(this.activeSheet.indexWidth/2,this.activeSheet.headHeight-5),this.bc.lineTo(this.activeSheet.indexWidth-5,3),this.bc.lineTo(this.activeSheet.indexWidth-5,this.activeSheet.headHeight-5),this.bc.fillStyle="#ccc",this.bc.fill()},rRowColHeaders:function(t,e){this.rAllBtn();let n=t.headHeight,i=t.indexWidth;this.bc.textBaseline="middle",this.bc.textAlign="center",this.bc.strokeStyle="#ccc";const r=this.px(1);this.bc.lineWidth=r,this.bc.font="13px Arial",t.vi.colsIndex.forEach(n=>{if(0==i)return;const o=e.columns.includes(n);let a=t.getCol(n).width;this.bc.fillStyle=o?"#d9d9d9":"#f0f0f0",this.bc.fillRect(i,0,a,t.headHeight),this.bc.beginPath(),this.bc.strokeStyle="#ccc";const s=this.snapRect(i,0,a,t.headHeight);if(this.bc.lineWidth=r,this.bc.strokeRect(s.x,s.y,s.w,s.h),o){this.bc.beginPath(),this.bc.lineWidth=2,this.bc.strokeStyle="#36c";const e=this.halfPixel,n=this.snap(t.headHeight)+e;this.bc.moveTo(this.snap(i)+e,n),this.bc.lineTo(this.snap(i+a)+e,n),this.bc.stroke()}this.bc.beginPath(),this.bc.lineWidth=r,this.bc.fillStyle="#333",this.bc.fillText(this.Utils.numToChar(n),i+a/2,t.headHeight/2+2),i+=a}),this.bc.font="14.6px Arial",t.vi.rowsIndex.forEach(o=>{if(0==n)return;const a=e.rows.includes(o);i=t.indexWidth;let s=t.getRow(o).height;this.bc.fillStyle=a?"#d9d9d9":"#f0f0f0",this.bc.fillRect(0,n,t.indexWidth,s),this.bc.beginPath(),this.bc.strokeStyle="#ccc";const l=this.snapRect(0,n,t.indexWidth,s);if(this.bc.lineWidth=r,this.bc.strokeRect(l.x,l.y,l.w,l.h),a){this.bc.beginPath(),this.bc.lineWidth=2,this.bc.strokeStyle="#36c";const e=this.halfPixel,i=this.snap(t.indexWidth)+e;this.bc.moveTo(i,this.snap(n)+e),this.bc.lineTo(i,this.snap(n+s)+e),this.bc.stroke()}this.bc.beginPath(),this.bc.lineWidth=r,this.bc.fillStyle="#333",this.bc.fillText(o+1,t.indexWidth/2,n+s/2+2),n+=t.getRow(o).height})},rHighlightBars:function(t,e){const n=this.highlightColor;if(!n)return;const{indexWidth:i,headHeight:r}=t,o=e.frames;this.bc.fillStyle=n,e.rows.forEach(e=>{let n=r;for(const i of t.vi.rowsIndex){if(i===e)break;n+=t.getRow(i).height}const a=t.getRow(e).height,s=sF(o.filter(t=>t.inView&&e>=t.area.s.r&&e<=t.area.e.r).map(t=>({x1:t.x,x2:t.x+t.w})),"x1","x2");let l=i;for(const t of s)t.x1>l&&this.bc.fillRect(l,n,t.x1-l,a),l=t.x2;l<this.viewWidth&&this.bc.fillRect(l,n,this.viewWidth-l,a)}),e.columns.forEach(e=>{let n=i;for(const i of t.vi.colsIndex){if(i===e)break;n+=t.getCol(i).width}const a=t.getCol(e).width,s=sF(o.filter(t=>t.inView&&e>=t.area.s.c&&e<=t.area.e.c).map(t=>({y1:t.y,y2:t.y+t.h})),"y1","y2");let l=r;for(const t of s)t.y1>l&&this.bc.fillRect(n,l,a,t.y1-l),l=t.y2;l<this.viewHeight&&this.bc.fillRect(n,l,a,this.viewHeight-l)})},rPageBreaks:function(t){if(!t.showPageBreaks)return;const e=this.SN.Print?.getPageBreakGuides?.(t);if(!e?.range)return;const n=t.vi?.rowsIndex||[],i=t.vi?.colsIndex||[];if(!n.length||!i.length)return;const r=lF(n,t.headHeight,e=>t.getRow(e).height),o=lF(i,t.indexWidth,e=>t.getCol(e).width),a=uF(t,e.range.s.c,i,o.starts,t.indexWidth,o.end,"col"),s=uF(t,e.range.e.c+1,i,o.starts,t.indexWidth,o.end,"col"),l=uF(t,e.range.s.r,n,r.starts,t.headHeight,r.end,"row"),c=uF(t,e.range.e.r+1,n,r.starts,t.headHeight,r.end,"row"),h=Math.max(t.indexWidth,a??t.indexWidth),u=Math.min(this.viewWidth,s??this.viewWidth),d=Math.max(t.headHeight,l??t.headHeight),f=Math.min(this.viewHeight,c??this.viewHeight);if(u<=h||f<=d)return;const p={color:"#7f9bff",width:1,dash:[this.px(6),this.px(4)]},m={color:"#2f62ff",width:1.2,dash:[]},g={color:"#2f62ff",width:1.2,dash:[]},v=this.halfPixel,y=(t,e,n,i,r)=>{if(this.bc.beginPath(),this.bc.strokeStyle=r.color,this.bc.lineWidth=this.px(r.width),this.bc.setLineDash(r.dash||[]),Math.abs(t-n)<1e-4){const n=this.snap(t)+v;this.bc.moveTo(n,this.snap(e)),this.bc.lineTo(n,this.snap(i))}else{const i=this.snap(e)+v;this.bc.moveTo(this.snap(t),i),this.bc.lineTo(this.snap(n),i)}this.bc.stroke()};e.rowBreaks.forEach(e=>{const i=uF(t,e.index,n,r.starts,t.headHeight,r.end,"row");null!=i&&y(h,i,u,i,e.manual?m:p)}),e.colBreaks.forEach(e=>{const n=uF(t,e.index,i,o.starts,t.indexWidth,o.end,"col");null!=n&&y(n,d,n,f,e.manual?m:p)}),null!=a&&y(a,d,a,f,g),null!=s&&y(s,d,s,f,g),null!=l&&y(h,l,u,l,g),null!=c&&y(h,c,u,c,g),this.bc.setLineDash([])},rIndex:function(t,e=!1,n={}){e||this.clearBuffer();const i=this.getLight(),r=t.protection.isSelectionVisible(),o=!!n.hideSelectionFrame;!e&&r&&this.rHighlightBars(t,i),e||this.rPageBreaks(t),!e&&r&&i.frames.forEach(t=>{t.inView&&(this.bc.fillStyle="rgba(99, 99, 99, 0.2)",this.bc.fillRect(t.x+1.5,t.y+1.5,t.w-3,t.h-3))}),e||this.rRowColHeaders(t,r?i:{rows:[],columns:[]});const a=i.lastFrame;if(r&&a&&a.inView&&(!e||!o)){let{x:n,y:i,w:r,h:o}=a;const s=t.getCellInViewInfo(t.activeCell.r,t.activeCell.c);s.inView&&!e&&this.bc.clearRect(s.x+1,s.y+1,s.w-2,s.h-2);const l=this.halfPixel,c=this.snapRect(n,i,r,o);this.bc.strokeStyle="#36c",this.bc.lineWidth=1.5,this.bc.strokeRect(c.x-l,c.y-l,c.w+2*l,c.h+2*l);const h=7,u=n+r-h/2,d=i+o-h/2;this.bc.fillStyle="#36c",this.bc.fillRect(u,d,h,h),this.bc.strokeStyle="#ffffff",this.bc.lineWidth=2,this.bc.strokeRect(u,d,h,h),this.bc.beginPath(),this.bc.lineWidth=this.px(1)}if(!e){this.ctx.drawImage(this.showLayerKZ,0,0),this.ctx.drawImage(this.buffer,0,0),this.SN.License?.tg(this.ctx,this.showLayer.width,this.showLayer.height,this.dpr),this.renderTraceArrows(t);const e=++this.rCount;this.rDrawing(e),this.rDom()}},rDom:function(){const t=this.activeSheet;if(!t.protection.isSelectionVisible())return this.areaInput.value="",this.formulaBar.value="",void this.SN.Layout?.closePivotPanel?.();const{r:e,c:n}=t.activeCell,i=t.activeAreas;i.length>0&&(i[i.length-1].s.r!=i[i.length-1].e.r||i[i.length-1].s.c!=i[i.length-1].e.c)?this.areaInput.value=this.Utils.rangeNumToStr(i[i.length-1]):Object.keys(t.activeCell).length>0&&(this.areaInput.value=this.Utils.numToChar(n)+(e+1));const r=t.getCell(e,n);this.formulaBar.value=fi(t,r),oF(this.SN.containerDom,r,this.SN.Layout?.eg?.menuConfig),this.ng(t,e,n)},ng:function(t,e,n){if(!this.SN.Layout?.updateContextualToolbar)return;const i=t.Table?.getTableAt(e,n);if(i)return void this.SN.Layout.updateContextualToolbar({type:"table",data:i});const r=function(t,e,n){if(!t.PivotTable||0===t.PivotTable.size)return null;for(const i of t.PivotTable.getAll())if(dF(i,e,n))return i;return null}(t,e,n);r?this.SN.Layout.updateContextualToolbar({type:"pivotTable",data:r}):this.SN.Layout.updateContextualToolbar(null)},showCellInput:function(t=!1,e=!1){const n=this.activeSheet,{c:i,r}=n.activeCell,o=n.getCell(r,i),a=this.activeSheet.getCellInViewInfo(r,i),s=this.activeSheet.zoom??1,l=1.333*(o.font.size??11),c=a.w*s,h=a.h*s;this.input.style.left=a.x*s+"px",this.input.style.top=a.y*s+"px",this.input.style.minWidth=`${Math.max(1,c-1)}px`,this.input.style.minHeight=`${Math.max(1,h-1)}px`,this.input.style.fontSize=l*s+"px",this.input.style.fontFamily=o.font.name??"Calibri";const u=o.horizontalAlign;this.input.style.textAlign="center"===u?"center":"right"===u?"right":"left",this.input.style.lineHeight=1.35*l*s+"px";const d=o.verticalAlign,f=1.35*l*s;this.input.style.paddingTop="center"===d?`${Math.max(0,(h-f)/2)}px`:"top"===d?2*s+"px":`${Math.max(0,h-f-1)}px`;const p=o.alignment?.indent||0;if(this.input.style.paddingLeft=p?9*p*s+2+"px":"2px",this.input.style.paddingRight="2px",this.input.style.color=o.font.color||"",this.input.style.backgroundColor=function(t,e,n,i,r,o){const a=r?o:"#ffffff",s=t.CF?.rules?.length?t.CF.getFormat(n,i)?.fill?.fgColor:null,l=function(t,e,n){if(!t?.Table?.size)return null;const i=t.Table.getTableAt(e,n);if(!i)return null;const r=i.style;if(!r)return null;const o=!0!==r.be,a=!0===i.Ce;if(i.isHeaderCell(e,n)){let t=r.headerBg??null;if(o){const e=i.Pe?.();e?.fill?.fgColor&&(t=e.fill.fgColor)}return{bgColor:t,fromImport:a}}if(i.isTotalsCell(e,n))return{bgColor:r.totalsBg??null,fromImport:a};if(!i.isDataCell(e,n))return null;const s=i.getDataRowIndex(e),l=i.getColumnIndex(n);let c=r.dataBg??null;i.showRowStripes&&s>=0&&(c=gF(s,r.rowStripe1,r.rowStripe2,r.rowStripe1Size,r.rowStripe2Size)),i.showColumnStripes&&l>=0&&(c=gF(l,mF(r.columnStripe1,r.rowStripe2,r.rowStripe1,c),mF(r.columnStripe2,r.rowStripe1,r.rowStripe2,c),r.columnStripe1Size,r.columnStripe2Size)),i.showFirstColumn&&0===l&&(c=mF(r.firstColumnBg,c));const h=i.range.e.c-i.range.s.c;if(i.showLastColumn&&l===h&&(c=mF(r.lastColumnBg,c)),o){const t=i.Ve?.(l);t?.fill?.fgColor&&(c=t.fill.fgColor)}return{bgColor:c,fromImport:a}}(t,n,i),c=l?.bgColor,h=!0===l?.fromImport,u=e.fill||{};if(s)return s;if(h&&c)return c;if("pattern"===u.type&&"solid"===u.pattern&&u.fgColor)return u.fgColor;if(c)return c;if("pattern"===u.type)return"solid"===u.pattern||"none"===u.pattern?u.fgColor??a:u.bgColor||a;if("gradient"===u.type){if(Array.isArray(u.stops)&&u.stops.length>0){const t=u.stops.find(t=>t?.color);if(t?.color)return t.color}return u.fgColor||u.bgColor||a}return u.fgColor||a}(n,o,r,i,this.eyeProtectionMode,this.eyeProtectionColor),this.inputEditing=!!a.inView,t||!o.W||o.isFormula||"number"==typeof o.B?this.input.innerText=t?"":fi(n,o):this.input.innerHTML=function(t,e,n=1){return t&&t.length?t.map(t=>{const i=function(t,e,n){const i={...e,...t},r=[];i.bold?r.push("font-weight:bold"):!1===i.bold&&r.push("font-weight:normal"),i.italic?r.push("font-style:italic"):!1===i.italic&&r.push("font-style:normal");const o=[];return i.underline&&o.push("underline"),i.strike&&o.push("line-through"),o.length?r.push(`text-decoration:${o.join(" ")}`):""!==i.underline&&!1!==i.strike||r.push("text-decoration:none"),i.size&&r.push(`font-size:${1.333*i.size*n}px`),i.name&&r.push(`font-family:'${i.name}'`),i.color&&r.push(`color:${i.color}`),r.join(";")}(t.font||{},e,n);var r;return`<span style="${i}">${(r=t.text,r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/\n/g,"<br>")}</span>`}).join(""):""}(o.W,o.font,s),this.currentCell={...this.activeSheet.activeCell},this.activeSheet.cancelBrush(),!e||!this.inputEditing)return;this.input.focus();const m=window.getSelection();if(!m)return;const g=document.createRange();g.selectNodeContents(this.input),g.collapse(!1),m.removeAllRanges(),m.addRange(g)},updateInputPosition:function(){if(!this.inputEditing||!this.currentCell)return;const{c:t,r:e}=this.currentCell,n=this.activeSheet.getCell(e,t),i=this.activeSheet.getCellInViewInfo(e,t);if(!i)return;const r=this.activeSheet.zoom??1,o=1.333*(n.font.size??11),a=i.w*r,s=i.h*r;this.input.style.left=i.x*r+"px",this.input.style.top=i.y*r+"px",this.input.style.minWidth=`${Math.max(1,a-1)}px`,this.input.style.minHeight=`${Math.max(1,s-1)}px`,this.input.style.fontSize=o*r+"px",this.input.style.lineHeight=1.35*o*r+"px"},updInputValue:function(){const{c:t,r:e}=this.currentCell,n=this.activeSheet.getCell(e,t),i=this.input.innerText.trim();if((isNaN(i)||!(i.length<=15)||""===i)&&null!==this.input.querySelector("span[style], b, i, u, s, strong, em, strike, del")&&!n.isFormula){const t=MI(this.input,n.font);if(t&&t.length>0)return n.richText=t,!n.validData&&n._?.showErrorMessage?(alert(pF(this.SN,n._.error)),this.inputEditing=!1,this.input.innerHTML="",void(n.richText=null)):(this.inputEditing=!1,this.input.innerHTML="",this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),void this.r())}const r=isNaN(i)||i.length>15||""==i?i:Number(i),o=n.editVal;if(n.editVal=r,!n.validData&&n._.showErrorMessage)return alert(pF(this.SN,n._.error)),this.inputEditing=!1,this.input.innerHTML="",n.editVal=o;this.inputEditing=!1,this.input.innerHTML="",this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),this.r()},addEventListeners:function(){window.addEventListener("keydown",t=>qF.call(this,t)),document.addEventListener("paste",t=>KF.call(this,t)),document.addEventListener("copy",t=>WF.call(this,t)),document.addEventListener("cut",t=>jF.call(this,t)),this.handleLayer.addEventListener("mousedown",t=>TF.call(this,t)),this.handleLayer.addEventListener("mousedown",t=>$F.call(this,t)),this.handleLayer.addEventListener("contextmenu",function(t){t.preventDefault()}),this.handleLayer.addEventListener("mousemove",t=>SF.call(this,t)),this.handleLayer.addEventListener("wheel",t=>MF.call(this,t)),this.handleLayer.addEventListener("dblclick",t=>CF.call(this,t)),this.handleLayer.addEventListener("touchstart",t=>AF.call(this,t),{passive:!0}),this.handleLayer.addEventListener("touchmove",t=>NF.call(this,t),{passive:!1}),this.handleLayer.addEventListener("touchend",t=>kF.call(this,t)),this.rollYS.addEventListener("mousedown",t=>GF.call(this,t)),this.rollXS.addEventListener("mousedown",t=>XF.call(this,t)),this.rollYS.addEventListener("touchstart",t=>YF.call(this,t),{passive:!1}),this.rollXS.addEventListener("touchstart",t=>ZF.call(this,t),{passive:!1}),this.input.addEventListener("input",()=>QF.call(this)),this.input.addEventListener("blur",()=>{this.inputEditing&&this.updInputValue()}),this.formulaBar.addEventListener("focus",()=>JF.call(this)),this.formulaBar.addEventListener("keydown",t=>tE.call(this,t));const t=this.SN.containerDom.querySelector(".sn-tools"),e=this.SN.containerDom.querySelector(".sn-menu-list"),n=t=>{this.inputEditing&&t.preventDefault()};t&&t.addEventListener("mousedown",n),e&&e.addEventListener("mousedown",n),document.addEventListener("selectionchange",()=>{if(!this.inputEditing||!this.currentCell)return;const{c:t,r:e}=this.currentCell,n=this.activeSheet.getCell(e,t);oF(this.SN.containerDom,n,this.SN.Layout?.eg?.menuConfig)})},rSparklines:function(t){if(!t.Sparkline||0===t.Sparkline.map.size)return;const{rowsIndex:e,colsIndex:n}=t.vi;let i=t.headHeight;for(let r=0;r<e.length;r++){const o=e[r],a=t.getRow(o).height;let s=t.indexWidth;for(let e=0;e<n.length;e++){const r=n[e],l=t.getCol(r).width,c=t.Sparkline.get({r:o,c:r});if(c){const e=c.getData();if(e&&e.length>0){const n=e.filter(t=>null!==t);n.length>0&&iE.call(this,s,i,l,a,c,n,t)}}s+=l}i+=a}},rCommentIndicators:function(t){const e=t.Comment.getAll();if(0===e.length)return;const n=this.bc,i=e.filter(e=>{const{r:n,c:i}=e.cellPos,r=t.getCellInViewInfo(n,i);return r&&r.inView});n.save(),n.fillStyle="#FF0000",i.forEach(e=>{const{r:i,c:r}=e.cellPos,o=t.getCellInViewInfo(i,r);if(!o||!o.inView)return;const{x:a,y:s,size:l}=sE(o);n.beginPath(),n.moveTo(a+l,s),n.lineTo(a+l,s+l),n.lineTo(a,s),n.closePath(),n.fill()}),n.restore()},rCommentBoxes:function(t){const e=this.bc,n=[];t.Comment.getAll().forEach(t=>{t.visible&&n.push(t)}),this.hoveredComment&&!this.hoveredComment.visible&&n.push(this.hoveredComment),0!==n.length&&(e.save(),n.forEach(n=>{const{r:i,c:r}=n.cellPos,o=t.getCellInViewInfo(i,r);if(!o||!o.inView)return;const a=1.33,s=o.x+n.marginLeft*a,l=o.y+n.marginTop*a,c=n.width*a,h=n.height*a;e.shadowColor="rgba(0, 0, 0, 0.2)",e.shadowBlur=4,e.shadowOffsetX=2,e.shadowOffsetY=2,e.fillStyle="#FFFFE1",e.fillRect(s,l,c,h),e.shadowColor="transparent",e.strokeStyle="#000000",e.lineWidth=1,e.strokeRect(s,l,c,h);const u=sE(o),d=u.x+u.size,f=u.y;e.strokeStyle="#000000",e.lineWidth=1,e.beginPath(),e.moveTo(s,l),e.lineTo(d,f),e.stroke();const p=s-d,m=l-f,g=Math.sqrt(p*p+m*m),v=p/g,y=m/g,b=-y,x=v;if(e.fillStyle="#000000",e.beginPath(),e.moveTo(d,f),e.lineTo(d+5*v*2+5*b,f+5*y*2+5*x),e.lineTo(d+5*v*2-5*b,f+5*y*2-5*x),e.closePath(),e.fill(),n.text){e.fillStyle="#000000";const t=10,i=0,r=16,o=c-2*t;let a=l+i+12;n.author&&(e.font="bold 12px Arial",e.fillText(n.author+":",s+t,a),a+=r),e.font="12px Arial";const u=function(t,e,n){const i=[];return e.split("\n").forEach(e=>{if(!e)return void i.push("");let r="";const o=e.split("");for(let a=0;a<o.length;a++){const e=r+o[a];t.measureText(e).width>n&&r?(i.push(r),r=o[a]):r=e}r&&i.push(r)}),i}(e,n.text,o);u.forEach((n,o)=>{const c=a+o*r;c+r<=l+h-i&&e.fillText(n,s+t,c)})}}),e.restore())},rConditionalFormats:function(t){const e=t.CF;if(!e||0===e.rules.length)return;const n=this.bc,i=this.pixelRatio,r=this.Xb;r&&r.forEach((t,e)=>{const{x:r,y:o,w:a,h:s,cellInfo:l,cfFormat:c}=t;c&&c.icon&&function(t,e,n,i,r,o,a,s){const l=t=>Math.round(t*s)/s,{set:c,index:h,showValue:u}=o,d=Oe[c];if(!d||!d.icons[h])return;const f=d.icons[h],p=Math.min(16,r-4),m=JI(f,Math.round(p*s));if(!m)return;const g=l(Math.floor(e+2)),v=l(Math.floor(n+(r-p)/2));t.drawImage(m,g,v,p,p),u||(a.ig=!0)}(n,r,o,0,s,c.icon,l,i)})},rDataBar:function(t,e,n,i,r){!function(t,e,n,i,r,o,a){const s=t=>Math.round(t*a)/a,l=1/a,{percent:c,color:h,gradient:u,borderColor:d,axisPosition:f,axisColor:p,isNegative:m,showValue:g}=o,v=r-4,y=n+2;let b,x;if(null!=f){const o=e+i*f;t.strokeStyle=p||"#000000",t.lineWidth=l,t.beginPath();const a=s(o);t.moveTo(a,s(n)),t.lineTo(a,s(n+r)),t.stroke(),c>=0?(b=o,x=(i-(o-e))*Math.abs(c)):(x=(o-e)*Math.abs(c),b=o-x)}else b=e+2,x=(i-4)*Math.abs(c);if(x=Math.max(0,x),x>0){if(u){const e=t.createLinearGradient(b,y,b+x,y);e.addColorStop(0,h),e.addColorStop(1,function(t){return ke(Ne(t).map(t=>t+.65*(255-t)))}(h)),t.fillStyle=e}else t.fillStyle=h;if(t.fillRect(b,y,x,v),d){t.strokeStyle=d,t.lineWidth=l;const e=s(b),n=s(y),i=s(b+x),r=s(y+v);t.strokeRect(e,n,i-e,r-n)}}}(this.bc,t,e,n,i,r,this.pixelRatio)},rFilterIcons:function(t){const e=t.AutoFilter;this.rg=[];const n=e?.getEnabledScopes?.();if(!Array.isArray(n)||0===n.length)return;const i=new Map;let r=t.indexWidth;for(const s of t.vi.colsIndex){const e=t.getCol(s).width;i.set(s,{x:r,w:e}),r+=e}const o=new Map;let a=t.headHeight;for(const s of t.vi.rowsIndex){const e=t.getRow(s).height;o.set(s,{y:a,h:e}),a+=e}n.forEach(n=>{const r=n.range,a=n.headerRow,s=o.get(a);if(r&&s)for(const o of t.vi.colsIndex){if(o<r.s.c||o>r.e.c)continue;const t=i.get(o);if(!t)continue;const a=e.hasFilter(o,n.scopeId),l=e.getSortOrder(o,n.scopeId),c=15,h=2,u=t.x+t.w-c-h,d=s.y+s.h-c-h;this.rg.push({x:u,y:d,w:c,h:c,colIndex:o,scopeId:n.scopeId}),lE(this.bc,u,d,c,a,l)}})},clearFilterIconPositions:function(){this.rg=[]},getFilterIconAtPosition:function(t,e){if(!this.rg||0===this.rg.length)return null;for(const n of this.rg){const i=5;if(t>=n.x-i&&t<=n.x+n.w+i&&e>=n.y-i&&e<=n.y+n.h+i)return{colIndex:n.colIndex,scopeId:n.scopeId}}return null},drawFilterIcon:lE,rPivotTablePlaceholders:function(t){if(!t.PivotTable||0===t.PivotTable.size)return;const e=this.bc,n=this.pixelRatio;for(const i of t.PivotTable.getAll()){if(!hE(i))continue;const r=i.location.ref.split(":")[0],o=this.SN.Utils.cellStrToNum?this.SN.Utils.cellStrToNum(r):{r:0,c:0},a=o.r+18-1,s=o.c+3-1,l=this.SN.Utils.cellNumToStr?this.SN.Utils.cellNumToStr({r:a,c:s}):`${String.fromCharCode(65+s)}${a+1}`;i.location.ref=`${r}:${l}`;const c=uE(t,o.r,o.c);c&&c.inView&&(i.sg={x:c.x,y:c.y,w:c.w,h:c.h,startRow:o.r,startCol:o.c},dE(e,i,c,t,n,this.SN))}},getPivotTableAtPosition:function(t,e,n){if(!t.PivotTable||0===t.PivotTable.size)return null;for(const i of t.PivotTable.getAll()){if(!hE(i))continue;const t=i.sg;if(t&&e>=t.x&&e<=t.x+t.w&&n>=t.y&&n<=t.y+t.h)return i}return null}}),mE.prototype.Ob=function(){const{areaBox:t,areaDropdown:e,areaInput:n,SN:i}=this;if(!t||!e||!n)return;const r=()=>t.classList.remove("open"),o=t=>{if(!t)return;const e=t.match(/^(?:(.+?)!)?(.+)$/);if(!e)return;const[,n,r]=e;let o=i.activeSheet;if(n){const t=n.replace(/^'+|'+$/g,"");if(o=i.sheets.find(e=>e.name===t),!o)return}const a=(t=>{const e=t.replace(/\$/g,"").split(":"),n=i.Utils.cellStrToNum(e[0]),r=e[1]?i.Utils.cellStrToNum(e[1]):{...n};return n&&r?{s:n,e:r}:null})(r);if(!a)return;o.J();const{rowsIndex:s,colsIndex:l}=o.vi;s.includes(a.s.r)&&s.includes(a.e.r)&&l.includes(a.s.c)&&l.includes(a.e.c)||(o.vi.rowArr[0]=Math.max(0,a.s.r-2),o.vi.colArr[0]=Math.max(0,a.s.c-1)),o.activeCell={r:a.s.r,c:a.s.c},o.activeAreas=[a],o!==i.activeSheet?i.activeSheet=o:i.ue()};t.querySelector(".sn-area-arrow")?.addEventListener("click",n=>{n.stopPropagation(),t.classList.toggle("open"),t.classList.contains("open")&&(()=>{const t=Object.entries(i.yn||{});t.length?e.innerHTML=t.map(([t,e])=>`\n            <div class="sn-area-dropdown-item" data-name="${t}" data-ref="${e}">\n                <span class="sn-area-dropdown-name">${t}</span>\n                <span class="sn-area-dropdown-ref">${e}</span>\n            </div>\n        `).join(""):e.innerHTML=`<div class="sn-area-dropdown-empty">${i.t("core.canvas.canvas.areaDropdown.empty")}</div>`})()}),e.addEventListener("click",t=>{const e=t.target.closest(".sn-area-dropdown-item");e&&(o(e.dataset.ref),r())}),n.addEventListener("blur",()=>{const t=n.value.trim();if(!t)return;const e=i.yn?.[t];e?o(e):(/^[A-Z]+\d+(:[A-Z]+\d+)?$/i.test(t)||t.includes("!"))&&o(t)}),n.addEventListener("keydown",t=>{"Enter"===t.key&&(t.preventDefault(),n.blur()),"Escape"===t.key&&(r(),n.blur())}),n.addEventListener("focus",()=>{n.select()}),document.addEventListener("click",e=>{t.contains(e.target)||r()})},mE.prototype.renderTraceArrows=function(t){const e=t.og;if(!e||0===e.precedents.length&&0===e.dependents.length)return;const n=this.ctx,i=(this.dpr||1)*(t.zoom??1);n.save(),n.strokeStyle="#4472C4",n.fillStyle="#4472C4",n.lineWidth=1.5*i,e.precedents.forEach(e=>{this.drawTraceArrow(n,t,e.from,e.to,i)}),n.strokeStyle="#C44444",n.fillStyle="#C44444",n.lineWidth=1.5*i,e.dependents.forEach(e=>{this.drawTraceArrow(n,t,e.from,e.to,i)}),n.restore()},mE.prototype.drawTraceArrow=function(t,e,n,i,r){const o=e.getCellInViewInfo(n.r,n.c,!1),a=e.getCellInViewInfo(i.r,i.c,!1);if(!o.inView&&!a.inView)return;const s=(o.x+o.w/2)*r,l=(o.y+o.h/2)*r,c=(a.x+a.w/2)*r,h=(a.y+a.h/2)*r;t.beginPath(),t.moveTo(s,l),t.lineTo(c,h),t.stroke(),t.beginPath(),t.arc(s,l,4*r,0,2*Math.PI),t.fill();const u=Math.atan2(h-l,c-s),d=10*r;t.beginPath(),t.moveTo(c,h),t.lineTo(c-d*Math.cos(u-Math.PI/6),h-d*Math.sin(u-Math.PI/6)),t.lineTo(c-d*Math.cos(u+Math.PI/6),h-d*Math.sin(u+Math.PI/6)),t.closePath(),t.fill()};class gE{static ag=!1;constructor(t){this.$=t,this.lg=document.createElement("textarea"),this.cg()}objToArr(t){return Array.isArray(t)?t:null!=t?[t]:[]}rgbToHex(t){const[e,n,i]=t.match(/\d+/g).map(Number);return`#${((1<<24)+(e<<16)+(n<<8)+i).toString(16).slice(1).toUpperCase()}`}emuToPx(t){return Math.round(96*t/914400)}pxToEmu(t){return Math.round(914400*t/96)}decodeEntities(t){return this.lg.innerHTML=t,this.lg.value}sortObjectInPlace(t,e){const n={};for(const i of e)i in t&&(n[i]=t[i]);for(const i in t)i in n||(n[i]=t[i]);for(const i in t)delete t[i];for(const i in n)t[i]=n[i]}debounce(t,e){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>t.apply(this,i),e)}}numToChar(t){let e="";for(;t>=0;){const n=t%26;e=String.fromCharCode(65+n)+e,t=Math.floor(t/26)-1}return e}charToNum(t){let e=0;for(let n=0;n<t.length;n++)e=26*e+(t.charCodeAt(n)-64);return e-1}rangeNumToStr(t,e=!1){const n=this.numToChar(t.s.c),i=t.s.r+1,r=this.numToChar(t.e.c),o=t.e.r+1;return e?`$${n}$${i}:$${r}$${o}`:`${n}${i}:${r}${o}`}cellStrToNum(t){if(!t)return;const e=t.match(/([A-Z]+)(\d+)/i);return e?{c:this.charToNum(e[1].toUpperCase()),r:parseInt(e[2],10)-1}:void 0}cellNumToStr(t){return this.numToChar(t.c)+(t.r+1)}getFillFormula(t,e,n,i,r){return t.replace(/(\$?[A-Z]+)(\$?\d+)/g,(t,o,a)=>{let s=this.charToNum(o.replace("$","")),l=parseInt(a.replace("$",""),10)-1;return o.includes("$")||(s=s-n+r),a.includes("$")||(l=l-e+i),`${o.includes("$")?"$":""}${this.numToChar(s)}${a.includes("$")?"$":""}${l+1}`})}toast(t){let e=this.$.containerDom.querySelector(".sn-toast-container");e||(e=document.createElement("div"),e.classList.add("sn-toast-container"),this.$.containerDom.appendChild(e));const n=document.createElement("div");n.classList.add("toast-item");const i=String(t);n.textContent=this.$.t(i),e.appendChild(n),requestAnimationFrame(()=>{n.classList.add("toast-show")}),setTimeout(()=>{n.classList.add("toast-hide"),setTimeout(()=>{n.parentNode===e&&e.removeChild(n)},300)},3e3)}async downloadImageToBase64(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch image: ${e.status} ${e.statusText}`);const n=await e.blob();return await new Promise((t,e)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.onerror=e,i.readAsDataURL(n)})}catch(t){const e=t instanceof Error?t.message:String(t);return void this.toast(this.$.t("core.utils.utils.toast.imageDownloadFailed",{message:e}))}}modal(t={}){const e=this.$.t("common.notice"),n=this.$.t("common.close"),{titleKey:i="",title:r=e,contentKey:o="",content:a="",bodyKey:s="",body:l="",maxWidth:c="460px",maxHeight:h="",confirmKey:u="",confirmText:d=null,cancelKey:f="",cancelText:p=null,bodyClass:m="",onOpen:g=null,onConfirm:v=null}=t,y=a||l,b=o||s,x=t=>null==t?"":String(t),w=(t,e)=>{const n=x(e);return t?this.$.t(t):n},S=w(i,r),C=x(y),T=b?this.$.t(b):C,$=null!==d||u?w(u,d):"",M=null!==p||f?w(f,p):"";return new Promise(t=>{let e=this.$.containerDom.querySelector(".sn-modal-overlay");e||(e=document.createElement("div"),e.className="sn-modal-overlay",e.innerHTML=`\n                    <div class="sn-modal">\n                        <div class="sn-modal-header">\n                            <h2 class="sn-modal-title"></h2>\n                            <button class="sn-modal-close" aria-label="${n}"></button>\n                        </div>\n                        <div class="sn-modal-body"></div>\n                        <div class="sn-modal-footer">\n                            <button class="sn-modal-btn sn-modal-btn-cancel"></button>\n                            <button class="sn-modal-btn sn-modal-btn-confirm"></button>\n                        </div>\n                    </div>\n                `,this.$.containerDom.appendChild(e));const i=e.querySelector(".sn-modal"),r=e.querySelector(".sn-modal-title"),o=e.querySelector(".sn-modal-body"),a=e.querySelector(".sn-modal-close"),s=e.querySelector(".sn-modal-btn-cancel"),l=e.querySelector(".sn-modal-btn-confirm"),u=a.cloneNode(!0),d=s.cloneNode(!0),f=l.cloneNode(!0);a.replaceWith(u),s.replaceWith(d),l.replaceWith(f),u.setAttribute("aria-label",n),r.textContent=S,o.innerHTML=T,o.className="sn-modal-body"+(m?` ${m}`:""),i.style.maxWidth=c||"",i.style.maxHeight=h||"";const p=e.querySelector(".sn-modal-footer");f.textContent=$||"",d.textContent=M||"",f.style.display=$?"":"none",d.style.display=M?"":"none",p.style.display=$||M?"":"none";const y=()=>{e.classList.remove("active","closing"),r.textContent="",o.innerHTML="",o.className="sn-modal-body",i.style.maxWidth="",i.style.maxHeight="",i.style.transform="",p.style.display=""},b=(n=!1)=>{e.classList.add("closing"),setTimeout(y,200),t(n?{bodyEl:o}:null)};u.onclick=()=>b(!1),d.onclick=()=>b(!1),f.onclick=async()=>{if(v)try{if(!1===await v(o))return}catch(t){return void(t&&this.toast(t))}b(!0)},requestAnimationFrame(()=>{e.classList.add("active"),g&&g(o)})})}cg(){if(gE.ag)return;gE.ag=!0;let t,e,n,i,r=!1,o=null,a="";document.addEventListener("mousedown",s=>{const l=s.target.closest(".sn-modal-header");if(!l||s.target.closest(".sn-modal-close"))return;const c=l.closest(".sn-modal");if(!c)return;r=!0,o=c,t=s.clientX,e=s.clientY,a=c.style.transition,c.style.transition="none";const h=c.style.transform.match(/translate\(([^,]+)px,\s*([^)]+)px\)/);h?(n=parseFloat(h[1]),i=parseFloat(h[2])):(n=0,i=0),s.preventDefault()}),document.addEventListener("mousemove",a=>{if(!r||!o)return;const s=a.clientX-t,l=a.clientY-e;o.style.transform=`translate(${n+s}px, ${i+l}px)`}),document.addEventListener("mouseup",()=>{o&&void 0!==a&&(o.style.transition=a),r=!1,o=null})}}class vE{constructor(t){this.maxStack=50,this.$=t,this.hg=[],this.ug=[],this.dg=null,this.mg=!1,this.pg=0,this.vg=!1}get canUndo(){return this.hg.length>0||!this.mg&&this.dg?.actions?.length>0}get canRedo(){return this.ug.length>0}add(t){if(this.dg)this.dg.actions.push(t);else{const e=this.bg();t.activeCell&&(e.activeCell={r:t.activeCell.r,c:t.activeCell.c}),this.dg={viewInfo:e,actions:[t]},this.mg||this.vg||(this.vg=!0,queueMicrotask(()=>this.gg()))}this.ug=[]}begin(t=""){this.pg>0?this.pg+=1:(this.mg=!0,this.pg=1,this.dg?t&&!this.dg.name&&(this.dg.name=t):this.dg={name:t,viewInfo:this.bg(),actions:[]})}commit(){0!==this.pg&&(this.pg-=1,this.pg>0||(this.mg=!1,this.yg()))}undo(){if(this.dg&&!this.mg&&this.yg(),0===this.hg.length)return!1;const t=this.hg.pop();if(this.$.Event.hasListeners("beforeUndo")&&this.$.Event.emit("beforeUndo",{tx:t}).canceled)return this.hg.push(t),!1;if(!this.wg(t.viewInfo))return this.hg.push(t),!1;for(let e=t.actions.length-1;e>=0;e--)t.actions[e].undo();return this.ug.push(t),this.xg(),this.$.Event.hasListeners("afterUndo")&&this.$.Event.emit("afterUndo",{tx:t}),!0}redo(){if(0===this.ug.length)return!1;const t=this.ug.pop();if(this.$.Event.hasListeners("beforeRedo")&&this.$.Event.emit("beforeRedo",{tx:t}).canceled)return this.ug.push(t),!1;if(!this.wg(t.viewInfo))return this.ug.push(t),!1;for(const e of t.actions)e.redo();return this.hg.push(t),this.xg(),this.$.Event.hasListeners("afterRedo")&&this.$.Event.emit("afterRedo",{tx:t}),!0}clear(){this.hg=[],this.ug=[],this.dg=null,this.mg=!1,this.pg=0,this.vg=!1}gg(){this.vg=!1,this.mg||this.yg()}yg(){this.dg&&0!==this.dg.actions.length?(this.hg.push(this.dg),this.hg.length>this.maxStack&&this.hg.shift(),this.dg=null):this.dg=null}xg(){this.$.DependencyGraph&&"manual"!==this.$.calcMode&&this.$.DependencyGraph.recalculateVolatile(),this.$.ue()}bg(){const t=this.$.activeSheet,e=t.vi;return{sheetName:t.name,c:e?.colArr?.[0]??0,r:e?.rowArr?.[0]??0,activeCell:{r:t.activeCell.r,c:t.activeCell.c}}}wg(t){if(!t?.sheetName)return!0;const e=this.$.getSheet(t.sheetName);if(!e)return!1;this.$.activeSheet.name!==e.name&&(this.$.activeSheet=e);const n=this.$.activeSheet;return n.viewStart={r:t.r,c:t.c},n.activeCell={r:t.activeCell.r,c:t.activeCell.c},n.po=[],!0}}function yE(t){return Array.isArray(t)?0===t.length?[0,0]:Array.isArray(t[0])?[t.length,t[0].length]:[1,t.length]:[1,1]}function bE(t){return Array.isArray(t)&&t.length>0&&Array.isArray(t[0])}function xE(t){return Array.isArray(t)?Array.isArray(t[0])?t:[t]:[[t]]}function wE(t,e,n){const[i,r]=yE(t),o=xE(t);if(i===e&&r===n)return o;if(1!==i&&i!==e)throw new Error(`#VALUE! 无法广播: ${i}行 → ${e}行`);if(1!==r&&r!==n)throw new Error(`#VALUE! 无法广播: ${r}列 → ${n}列`);const a=[];for(let s=0;s<e;s++){const t=[],e=1===i?0:s;for(let i=0;i<n;i++){const n=1===r?0:i;t.push(o[e][n])}a.push(t)}return a}function SE(t,e){if(!Array.isArray(t))return e(t);const n=xE(t).map(t=>t.map(t=>e(t)));return 1===n.length&&1===n[0].length?n[0][0]:n}function CE(t){if("boolean"==typeof t)return t?1:0;if("number"==typeof t)return t;if(null==t||""===t)return 0;const e=Number(t);if(isNaN(e))throw new Error("#VALUE!");return e}const TE=new Set(["RAND","RANDBETWEEN","NOW","TODAY","OFFSET","INDIRECT","INFO","CELL","SUBTOTAL"]);class $E{constructor(t){this.SN=t,this.$g=!1,this.Mg=!1}#u(t){return t instanceof Date?t:"number"==typeof t?u(t):new Date(t)}hasVolatileFunction(t){for(const e of t){if("FUNCTION"===e.type&&TE.has(e.value))return!0;if("ARRAY"===e.type&&Array.isArray(e.value)&&this.hasVolatileFunction(e.value))return!0}return!1}get lastCalcVolatile(){return this.$g}get lastResultIsDate(){return this.Mg}calcFormula(t,e){try{this.currentCell=e,this.Mg=!1;const n=this.tokenize(t);return this.$g=this.hasVolatileFunction(n),this.evaluate(n)}catch(t){t?.message?.includes("循环")&&this.SN.Utils.toast(t?.message);const e=String(t?.message||"").match(/#(?:NULL!|DIV\/0!|VALUE!?|REF!|NAME\?|NUM!|N\/A)/);return new Error(e?e[0]:"#VALUE")}}parseDeps(t){const e=[],n=this.SN.Utils;for(let i=0;i<t.length;i++){const r=t[i];if("CELL_REF"===r.type){const t=r.value.replace(/\$/g,"");if(t.includes(":")){const[i,r]=t.split(":"),o=n.cellStrToNum(i),a=n.cellStrToNum(r);for(let t=o.r;t<=a.r;t++)for(let n=o.c;n<=a.c;n++)e.push({r:t,c:n})}else e.push(n.cellStrToNum(t))}}return e}tokenize(t){const e=[],n=t.length;let i=0,r=null;const o=/[0-9]/,a=/[+\-*/&=<>%^]/,s=/[A-Za-z$]/;for(;i<n;){const l=t[i];if(" "!==l){if("{"===l){i++;const o=[];let a="",s=1,l=!1,c=null;for(;i<n&&s>0;){const e=t[i];if('"'!==e&&"'"!==e||"\\"===t[i-1]||(l?e===c&&(l=!1,c=null):(l=!0,c=e)),!l){if("{"===e)s++;else if("}"===e&&(s--,0===s)){if(a.trim()){const t=this.tokenize(a.trim());o.push(...t)}i++;break}if(","===e&&1===s){if(a.trim()){const t=this.tokenize(a.trim());o.push(...t),o.push({type:"ARRAY_SEPARATOR",value:","})}a="",i++;continue}}a+=e,i++}e.push({type:"ARRAY",value:o}),r="ARRAY";continue}if(o.test(l)){let o=i,a=!1;for(;i<n;){const e=t[i];if(e>="0"&&e<="9")i++;else{if("."!==e||a)break;a=!0,i++}}const s=parseFloat(t.slice(o,i));e.push({type:"NUMBER",value:s}),r="NUMBER";continue}if(a.test(l)){let o=l;if("-"!==o||r&&"OPERATOR"!==r&&"PAREN_OPEN"!==r&&"COMMA"!==r){if(i+1<n){const e=t[i+1];("<"===o&&("="===e||">"===e)||">"===o&&"="===e||"="===o&&"="===e)&&(o+=e,i++)}e.push({type:"OPERATOR",value:o})}else e.push({type:"OPERATOR",value:"NEG"});r="OPERATOR",i++;continue}if(s.test(l)||"'"===l||l>="一"&&l<="龥"){let o="",a=!1,s=null;for("'"===t[i]&&(a=!0,s="'",o+=t[i],i++);i<n;){const e=t[i];if(a)o+=e,e===s&&(i+1<n&&t[i+1]===s?o+=t[++i]:(a=!1,s=null)),i++;else{if(!(e>="A"&&e<="Z"||e>="a"&&e<="z"||e>="0"&&e<="9"||"_"===e||"$"===e||":"===e||"!"===e||"."===e||e>="一"&&e<="龥"))break;o+=e,i++}}const l=o.toUpperCase();if("TRUE"===l||"FALSE"===l){e.push({type:"BOOLEAN",value:"TRUE"===l}),r="BOOLEAN";continue}if(i<n&&"("===t[i]){e.push({type:"FUNCTION",value:l}),r="FUNCTION";continue}const c=[/^'?[^']*'?![A-Z]+[0-9]+$/i,/^'?[^']*'?!\$?[A-Z]+\$?[0-9]+$/i,/^'?[^']*'?!\$?[A-Z]+\$?[0-9]+:\$?[A-Z]+\$?[0-9]+$/i,/^[A-Z]+[0-9]+$/i,/^\$?[A-Z]+\$?[0-9]+$/i,/^\$?[A-Z]+\$?[0-9]+:\$?[A-Z]+\$?[0-9]+$/i];let h=!1;for(const t of c)if(t.test(o)){e.push({type:"CELL_REF",value:o}),r="CELL_REF",h=!0;break}h||(e.push({type:"IDENTIFIER",value:o}),r="IDENTIFIER");continue}if("("!==l&&")"!==l){if('"'===l||"'"===l){const o=l;++i;let a="";for(;i<n;){const e=t[i];if(e===o){if(!(i+1<n&&t[i+1]===o)){i++;break}a+=o,i+=2}else a+=e,i++}e.push({type:"STRING",value:a}),r="STRING";continue}if(","!==l)throw new Error(`#VALUE! Unexpected character: ${l} at position ${i}`);e.push({type:"COMMA",value:","}),r="COMMA",i++}else e.push({type:"PAREN",value:l}),r="("===l?"PAREN_OPEN":"PAREN_CLOSE",i++}else i++}return e}evaluate(t){const e=[],n=[],i={"+":1,"-":1,"*":2,"/":2,"%":2,"^":4,"NEG":3,"&":0,"=":0,"<":0,">":0,"<=":0,">=":0,"<>":0};let r=[];for(let a=0;a<t.length;a++){const o=t[a];switch(o.type){case"NUMBER":case"STRING":n.push(o.value);break;case"ARRAY":const s=[];let l=o.value,c=[];for(let t=0;t<=l.length;t++)if(t===l.length||"ARRAY_SEPARATOR"===l[t].type){if(c.length>0){const t=this.evaluate(c);s.push(t),c=[]}}else c.push(l[t]);n.push([s]);break;case"CELL_REF":n.push(this.#d(o.value));break;case"IDENTIFIER":const h=this.SN.yn?.[o.value];if(!h)throw new Error("#NAME?");n.push(this.#d(h));break;case"FUNCTION":e.push(o),r.push([]);break;case"COMMA":for(;e.length>0&&"("!==e[e.length-1].value;)n.push(this.executeOperator(e.pop().value,n));r[r.length-1].push(n.pop());break;case"OPERATOR":const u="NEG"===o.value;for(;e.length>0&&"OPERATOR"===e[e.length-1].type&&(u?i[e[e.length-1].value]>i[o.value]:i[e[e.length-1].value]>=i[o.value]);)n.push(this.executeOperator(e.pop().value,n));e.push(o);break;case"PAREN":if("("===o.value)e.push(o);else{for(;e.length>0&&"("!==e[e.length-1].value;)n.push(this.executeOperator(e.pop().value,n));if(e.pop(),e.length>0&&"FUNCTION"===e[e.length-1].type){const i=t[a-1];n.length>0&&("PAREN"!==i.type||"("!==i.value)&&r[r.length-1].push(n.pop());const o=e.pop(),s=r.pop();n.push(this.executeFunction(o.value,s))}}}}for(;e.length>0;){const t=e.pop();"OPERATOR"===t.type&&n.push(this.executeOperator(t.value,n))}let o=n[n.length-1]??new Error("#NAME?");if(Array.isArray(o)&&1===o.length&&!Array.isArray(o[0])){const t=o[0];t&&"object"==typeof t&&"calcVal"in t&&(o=t.calcVal)}return o}executeOperator(t,e){if("NEG"===t){let t=e.pop();return t=this.#f(t),SE(t,t=>-CE(t))}if("%"===t){let t=e.pop();return t=this.#f(t),SE(t,t=>CE(t)/100)}let n=e.pop(),i=e.pop();i=this.#f(i),n=this.#f(n);const r={"+":(t,e)=>CE(t)+CE(e),"-":(t,e)=>CE(t)-CE(e),"*":(t,e)=>CE(t)*CE(e),"/":(t,e)=>{const n=CE(e);if(0===n)throw new Error("#DIV/0!");return CE(t)/n},"%":(t,e)=>{const n=CE(e);if(0===n)throw new Error("#DIV/0!");return CE(t)%n},"^":(t,e)=>Math.pow(CE(t),CE(e)),"&":(t,e)=>`${t??""}${e??""}`,"=":(t,e)=>{const n=Number(t),i=Number(e);return isNaN(n)||isNaN(i)||""===t||""===e?t==e:n===i},"<":(t,e)=>{const n=Number(t),i=Number(e);return isNaN(n)||isNaN(i)||""===t||""===e?t<e:n<i},">":(t,e)=>{const n=Number(t),i=Number(e);return isNaN(n)||isNaN(i)||""===t||""===e?t>e:n>i},"<=":(t,e)=>{const n=Number(t),i=Number(e);return isNaN(n)||isNaN(i)||""===t||""===e?t<=e:n<=i},">=":(t,e)=>{const n=Number(t),i=Number(e);return isNaN(n)||isNaN(i)||""===t||""===e?t>=e:n>=i},"<>":(t,e)=>{const n=Number(t),i=Number(e);return isNaN(n)||isNaN(i)||""===t||""===e?t!=e:n!==i}},o=r[t];if(!o)throw new Error("#NAME!");return function(t,e,n){if(bE(t)||Array.isArray(t)&&t.length,bE(e)||Array.isArray(e)&&e.length,!Array.isArray(t)&&!Array.isArray(e))return n(t,e);const[i,r]=function(t,e){const[n,i]=yE(t),[r,o]=yE(e),a=Math.max(n,r),s=Math.max(i,o);return[wE(t,a,s),wE(e,a,s)]}(t,e),o=i.map((t,e)=>t.map((t,i)=>n(t,r[e][i])));return 1===o.length&&1===o[0].length?o[0][0]:o}(i,n,o)}#f(t){return Array.isArray(t)?t.length>0&&t[0]&&"object"==typeof t[0]&&"calcVal"in t[0]&&!Array.isArray(t[0])?t.map(t=>t.calcVal):t.length>0&&Array.isArray(t[0])?t.map(t=>t.map(t=>"object"==typeof t&&null!==t&&"calcVal"in t?t.calcVal:t)):t:t}#d(t){const e=(t=t.replaceAll("$","")).includes("!");let n=this.SN.activeSheet;if(e){const[e,i]=t.split("!");n=this.SN.getSheet(e),t=i}if(!t.includes(":"))return[n.getCell(t)];const i={};return n.eachCells(t,(t,e)=>{i[t]||(i[t]=[]),i[t].push(n.getCell(t,e))}),Object.values(i)}#p(t){return t.flatMap(t=>Array.isArray(t)?t.flat().map(t=>"object"==typeof t&&null!==t?t.calcVal??"":t):t)}#m(t){return t.flatMap(t=>Array.isArray(t)?t.flat().map(t=>"object"==typeof t&&null!==t?"number"==typeof t.calcVal?t.calcVal:null:"number"==typeof t?t:null):["number"==typeof t?t:null])}#g(t){return Array.isArray(t)?1!==t.length||Array.isArray(t[0])?t.map(t=>t.map(t=>"object"==typeof t&&null!==t?t.calcVal:t)):t[0].calcVal:t}executeFunction(t,e){const n=t=>{if(Array.isArray(t)){if(0===t.length)return;return n(t[0])}return t&&"object"==typeof t&&"calcVal"in t?t.calcVal:t},i=()=>{const t=n(this.#g(e[0])),i=Number(t);if(!Number.isFinite(i))throw new Error("#VALUE!");const r=Math.trunc(i),o=r>=100,a=o?r-100:r;if(a<1||a>11)throw new Error("#VALUE!");return{baseCode:a,ignoreManualHidden:o}},r=(t,e,n=[])=>{if(Array.isArray(t))return t.forEach(t=>r(t,e,n)),n;if(t&&"object"==typeof t&&"calcVal"in t){const i=t,r=i.row,o=r?.sheet;return o?.AutoFilter?.oe?.has(r?.rIndex)||e&&r?.hidden||("string"==typeof i.editVal?i.editVal.trim().toUpperCase():"").startsWith("=SUBTOTAL(")||n.push(i.calcVal),n}return n.push(t),n},o=(t,e)=>{const n=e.filter(t=>"number"==typeof t&&Number.isFinite(t));switch(t){case 1:return n.length?n.reduce((t,e)=>t+e,0)/n.length:0;case 2:return n.length;case 3:return e.filter(t=>null!=t&&""!==t).length;case 4:return n.length?Math.max(...n):0;case 5:return n.length?Math.min(...n):0;case 6:return n.length?n.reduce((t,e)=>t*e,1):0;case 7:{if(n.length<=1)return 0;const t=n.reduce((t,e)=>t+e,0)/n.length,e=n.reduce((e,n)=>e+Math.pow(n-t,2),0)/(n.length-1);return Math.sqrt(e)}case 8:{if(!n.length)return 0;const t=n.reduce((t,e)=>t+e,0)/n.length,e=n.reduce((e,n)=>e+Math.pow(n-t,2),0)/n.length;return Math.sqrt(e)}case 9:return n.reduce((t,e)=>t+e,0);case 10:{if(n.length<=1)return 0;const t=n.reduce((t,e)=>t+e,0)/n.length;return n.reduce((e,n)=>e+Math.pow(n-t,2),0)/(n.length-1)}case 11:{if(!n.length)return 0;const t=n.reduce((t,e)=>t+e,0)/n.length;return n.reduce((e,n)=>e+Math.pow(n-t,2),0)/n.length}default:throw new Error("#VALUE!")}},s=t=>t instanceof Error||"string"==typeof t&&t.startsWith("#"),l=t=>{if(t instanceof Error)throw t;if("string"==typeof t&&t.startsWith("#"))throw new Error(t)},c=()=>{const t=n(this.#g(e[0])),i=n(this.#g(e[1])),r=Number(t),o=Number(i);if(!Number.isFinite(r)||!Number.isFinite(o))throw new Error("#VALUE!");const a=Math.trunc(r),s=Math.trunc(o);if(a<1||a>19||s<0||s>7)throw new Error("#VALUE!");return{functionNum:a,ignoreNested:s<=3,ignoreHiddenRows:[1,3,5,7].includes(s),ignoreErrors:[2,3,6,7].includes(s)}},d=(t,e,n=[])=>{if(Array.isArray(t))return t.forEach(t=>d(t,e,n)),n;if(t&&"object"==typeof t&&"calcVal"in t){const i=t,r=i.row,o=r?.sheet,a=!!o?.AutoFilter?.oe?.has(r?.rIndex),c=!!r?.hidden;if(e.ignoreHiddenRows&&(a||c))return n;const h="string"==typeof i.editVal?i.editVal.trim().toUpperCase():"";if(e.ignoreNested&&(h.startsWith("=SUBTOTAL(")||h.startsWith("=AGGREGATE(")))return n;const u=i.calcVal;if(s(u)){if(e.ignoreErrors)return n;l(u)}return n.push(u),n}if(s(t)){if(e.ignoreErrors)return n;l(t)}return n.push(t),n},f=(t,e)=>{if(!t.length||!Number.isFinite(e)||e<0||e>1)throw new Error("#NUM!");if(1===t.length)return t[0];const n=(t.length-1)*e,i=Math.floor(n),r=Math.ceil(n);return i===r?t[i]:t[i]+(t[r]-t[i])*(n-i)},p=(t,e)=>{if(!t.length||!Number.isFinite(e)||e<=0||e>=1)throw new Error("#NUM!");const n=e*(t.length+1);if(n<1||n>t.length)throw new Error("#NUM!");const i=Math.floor(n),r=Math.ceil(n);if(i===r)return t[i-1];const o=t[i-1];return o+(t[r-1]-o)*(n-i)},m=(t,e,n)=>{if(t>=1&&t<=11)return o(t,e);const i=(t=>t.filter(t=>"number"==typeof t&&Number.isFinite(t)).sort((t,e)=>t-e))(e);switch(t){case 12:return(t=>{if(!t.length)return 0;const e=Math.floor(t.length/2);return t.length%2==0?(t[e-1]+t[e])/2:t[e]})(i);case 13:return(t=>{if(!t.length)throw new Error("#N/A");let e=null,n=0,i=null,r=0;const o=()=>{(r>n||r===n&&null!==e&&i<e)&&(e=i,n=r)};if(t.forEach(t=>{t===i?r++:(r>0&&o(),i=t,r=1)}),r>0&&o(),n<=1)throw new Error("#N/A");return e})(i);case 14:case 15:{const e=Number(n),r=Math.trunc(e);if(!Number.isFinite(e)||!Number.isInteger(e)||r<1||r>i.length)throw new Error("#NUM!");return 14===t?i[i.length-r]:i[r-1]}case 16:return f(i,Number(n));case 17:{const t=Number(n),e=Math.trunc(t);if(!Number.isFinite(t)||!Number.isInteger(t)||e<0||e>4)throw new Error("#NUM!");return f(i,e/4)}case 18:return p(i,Number(n));case 19:{const t=Number(n),e=Math.trunc(t);if(!Number.isFinite(t)||!Number.isInteger(t)||e<1||e>3)throw new Error("#NUM!");return p(i,e/4)}default:throw new Error("#VALUE!")}},g=t=>{const e=this.#g(t);return Array.isArray(e)?Array.isArray(e[0])?e.flat():[...e]:[e]},v=t=>String(t).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),y={stack:e,gVal:t=>this.#g(t),gVals:t=>this.#p(t),gNums:t=>this.#m(t),toDate:t=>this.#u(t),execute:(t,n=e)=>this.executeFunction(t,n),currentCell:this.currentCell,SN:this.SN,getFlatValues:g,toMatrixValue:t=>{const e=this.#g(t);return Array.isArray(e)?e.length>0&&Array.isArray(e[0])?e.map(t=>[...t]):[[...e]]:[[e]]},firstCellFromArg:t=>{const e=t=>{if(Array.isArray(t)){for(const n of t){const t=e(n);if(t)return t}return null}return t&&"object"==typeof t&&"row"in t&&"cIndex"in t?t:null};return e(t)},escapeRegex:v,buildCriteriaTester:t=>{if("string"==typeof t){const e=t.trim();if(/[*?]/.test(e)){const t="^"+e.replace(/([.+^=!:${}()|[\]\\])/g,"\\$1").replace(/\*/g,".*").replace(/\?/g,".")+"$",n=new RegExp(t,"i");return t=>n.test(String(t??""))}const n=e.match(/^([<>=!]=?|<>)(.*)$/);if(n){let[,t,e]=n;"<>"===t&&(t="!=");const i=e.trim(),r=Number(i),o=""!==i&&Number.isFinite(r);return e=>{if(o){const n=Number(e);if(!Number.isFinite(n))return!1;switch(t){case">":return n>r;case">=":return n>=r;case"<":return n<r;case"<=":return n<=r;case"=":return n===r;case"!=":return n!==r;default:return!1}}const n=String(e??"");switch(t){case">":return n>i;case">=":return n>=i;case"<":return n<i;case"<=":return n<=i;case"=":return n.toLowerCase()===i.toLowerCase();case"!=":return n.toLowerCase()!==i.toLowerCase();default:return!1}}}return t=>String(t??"").toLowerCase()===e.toLowerCase()}return e=>e==t},ensureInteger:(t,e="#VALUE!")=>{const n=Number(t);if(!Number.isFinite(n)||!Number.isInteger(n))throw new Error(e);return n},getNumericSorted:t=>{let e;return e=Array.isArray(t)?t.some(t=>Array.isArray(t))?t.flat(1/0):t:g(t),e.map(Number).filter(Number.isFinite).sort((t,e)=>t-e)},halfWidthText:t=>String(t).replace(/[\u3000]/g," ").replace(/[\uFF01-\uFF5E]/g,t=>String.fromCharCode(t.charCodeAt(0)-65248)),fullWidthText:t=>String(t).replace(/ /g,"　").replace(/[!-~]/g,t=>String.fromCharCode(t.charCodeAt(0)+65248)),toArrayText:t=>Array.isArray(t)?`{${(Array.isArray(t[0])?t:[t]).map(t=>t.map(t=>"string"==typeof t?`"${t}"`:String(t??"")).join(",")).join(";")}}`:String(t??""),toDelims:t=>Array.isArray(t)?t.map(t=>String(t)):[String(t)],splitByDelims:(t,e,n=0)=>{const i=e.map(v).join("|"),r=1===n?"i":"";return String(t).split(new RegExp(i,r))},isoWeekNum:t=>{const e=new Date(t);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);const n=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},matchIndex:(t,e,n=0,i=1)=>{const r=t.map((t,e)=>e),o=-1===i?[...r].reverse():r;if(2===n){const n="^"+String(e).replace(/([.+^=!:${}()|[\]\\])/g,"\\$1").replace(/\*/g,".*").replace(/\?/g,".")+"$",i=new RegExp(n,"i");return o.find(e=>i.test(String(t[e]??"")))??-1}const a=o.find(n=>t[n]===e);if(void 0!==a)return a;if(0===n)return-1;const s=Number(e),l=Number.isFinite(s);let c=-1;if(-1===n){let n=-1/0;for(let i=0;i<t.length;i++){const r=l?Number(t[i]):t[i];(l&&Number.isFinite(r)&&r<=s&&r>=n||!l&&String(t[i])<=String(e)&&(-1===c||String(t[i])>String(t[c])))&&(n=r,c=i)}}else if(1===n){let n=1/0;for(let i=0;i<t.length;i++){const r=l?Number(t[i]):t[i];(l&&Number.isFinite(r)&&r>=s&&r<=n||!l&&String(t[i])>=String(e)&&(-1===c||String(t[i])<String(t[c])))&&(n=r,c=i)}}return c},percentileInc:f,percentileExc:p},b=function(t){const{stack:e,gVal:n,gVals:i,gNums:r,execute:o,getFlatValues:a,buildCriteriaTester:s,ensureInteger:l,getNumericSorted:c,percentileInc:h,percentileExc:u,toDate:d}=t,f=t=>{const e=[];return i(t).forEach(t=>{const n=(t=>{if(null==t||""===t)return null;if(t instanceof Error)throw t;if("number"==typeof t)return Number.isFinite(t)?t:0;if("boolean"==typeof t)return t?1:0;const e=Number(t);return Number.isFinite(e)?e:0})(t);null!==n&&e.push(n)}),e},p=(t,e)=>{const n=y(t),i=y(e);if(n.length!==i.length)throw new Error("#N/A");const r=[];for(let o=0;o<n.length;o++){const t=Number(n[o]),e=Number(i[o]);Number.isFinite(t)&&Number.isFinite(e)&&r.push([t,e])}return r},m=t=>t.reduce((t,e)=>t+e,0)/t.length,g=t=>{if(t.length<2)throw new Error("#DIV/0!");const e=m(t.map(t=>t[0])),n=m(t.map(t=>t[1]));let i=0,r=0;if(t.forEach(([t,o])=>{i+=(t-e)*(o-n),r+=(t-e)**2}),0===r)throw new Error("#DIV/0!");const o=i/r;return{slope:o,intercept:n-o*e}},v=1e-12,y=t=>{if(Array.isArray(t))return t.flat(1/0);const e=n(t);return Array.isArray(e)?Array.isArray(e[0])?e.flat():[...e]:[e]},b=t=>y(t).map(t=>Number(t)).filter(t=>Number.isFinite(t)),x=t=>{const e=d(t);if(!(e instanceof Date)||Number.isNaN(e.getTime()))throw new Error("#VALUE!");const n=new Date(e.getTime());return n.setHours(0,0,0,0),n},w=(t,e)=>{const n=x(t),i=x(e),r=Math.floor((i.getTime()-n.getTime())/864e5);if(r<=0)throw new Error("#NUM!");return r},S=t=>{const e=void 0===t?0:l(Number(t),"#NUM!");if(e<0||e>4)throw new Error("#NUM!");return 1===e||3===e?365:360},C=(t,e=0)=>void 0===t?Array.from({length:e},(t,e)=>e+1):b(t),T=(t,e)=>{if(Array.isArray(t)){if(Array.isArray(t[0])){const n=t.length,i=t[0].length,r=[];let o=0;for(let t=0;t<n;t++){const t=[];for(let n=0;n<i;n++)t.push(e[o++]);r.push(t)}return r}return[e]}const i=n(t);if(!Array.isArray(i))return e[0];if(Array.isArray(i[0])){const t=i.length,n=i[0].length,r=[];let o=0;for(let i=0;i<t;i++){const t=[];for(let i=0;i<n;i++)t.push(e[o++]);r.push(t)}return r}return[e]},$=(t,e)=>{const n=l(t,"#NUM!"),i=l(e,"#NUM!");if(n<0||i<0||i>n)throw new Error("#NUM!");const r=Math.min(i,n-i);let o=1;for(let a=1;a<=r;a++)o=o*(n-r+a)/a;return o},M=t=>{const e=Number(t);if(!Number.isFinite(e)||e<=0)throw new Error("#NUM!");const n=[676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(e<.5)return Math.log(Math.PI)-Math.log(Math.sin(Math.PI*e))-M(1-e);let i=.9999999999998099;const r=e-1;for(let a=0;a<n.length;a++)i+=n[a]/(r+a+1);const o=r+n.length-.5;return.5*Math.log(2*Math.PI)+(r+.5)*Math.log(o)-o+Math.log(i)},A=t=>Math.exp(-(t**2)/2)/Math.sqrt(2*Math.PI),N=t=>.5*(1+(t=>{const e=Number(t);if(!Number.isFinite(e))throw new Error("#VALUE!");const n=e<0?-1:1,i=Math.abs(e),r=1/(1+.3275911*i);return n*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-(i**2)))})(t/Math.SQRT2)),k=t=>{const e=Number(t);if(!Number.isFinite(e))throw new Error("#VALUE!");if(e<=0||e>=1)throw new Error("#NUM!");const n=[-.007784894002430293,-.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],i=[.007784695709041462,.3224671290700398,2.445134137142996,3.754408661907416],r=(t,e)=>t.reduce((t,n)=>t*e+n,0);if(e<.02425){const t=Math.sqrt(-2*Math.log(e));return r(n,t)/r([...i,1],t)}if(e>.97575){const t=Math.sqrt(-2*Math.log(1-e));return-r(n,t)/r([...i,1],t)}const o=e-.5,a=o*o;return r([-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],a)*o/r([-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572,1],a)},R=(t,e=!1)=>{if(t.length<2)throw new Error("#DIV/0!");if(!e)return g(t);const n=t.reduce((t,[e,n])=>t+e*n,0),i=t.reduce((t,[e])=>t+e*e,0);if(0===i)throw new Error("#DIV/0!");return{slope:n/i,intercept:0}},_=(t,e,n)=>{const i=l(t,"#NUM!"),r=l(e,"#NUM!"),o=Number(n);if(r<0||i<0||i>r||!Number.isFinite(o)||o<0||o>1)throw new Error("#NUM!");return $(r,i)*o**i*(1-o)**(r-i)},I=(t,e,n)=>{const i=l(t,"#NUM!"),r=l(e,"#NUM!"),o=Number(n);if(i<0||r<=0||!Number.isFinite(o)||o<=0||o>1)throw new Error("#NUM!");return $(i+r-1,r-1)*(1-o)**i*o**r},F=t=>{const e=void 0===t?0:l(Number(t),"#NUM!");if(0!==e&&1!==e)throw new Error("#NUM!");return e},E=(t,e,n,i=0,r=0)=>{if(0===e)throw new Error("#DIV/0!");if(Math.abs(t)<v)return-(n+i)/e;const o=(1+t)**e;return-t*(i+n*o)/((1+t*r)*(o-1))},D=(t,e,n,i,r=0,o=0)=>{const a=l(e,"#NUM!"),s=l(i,"#NUM!");if(a<=0||s<1||s>a)throw new Error("#NUM!");const c=E(t,a,n,r,o);if(Math.abs(t)<v)return{pmt:c,ipmt:0,ppmt:c};let h=n;for(let l=1;l<=a;l++){1===o&&(h+=c);const e=-h*t,n=c-e;if(l===s)return{pmt:c,ipmt:e,ppmt:n};h+=n}throw new Error("#NUM!")};return{COUNTBLANK:()=>a(e[0]).filter(t=>""===t||null==t).length,COUNTIFS:()=>{if(e.length<2||e.length%2!=0)throw new Error("#VALUE!");const t=a(e[0]),i=[];for(let o=0;o<e.length;o+=2){const r=a(e[o]);if(r.length!==t.length)throw new Error("#VALUE!");i.push({range:r,test:s(n(e[o+1]))})}let r=0;for(let e=0;e<t.length;e++)i.every(t=>t.test(t.range[e]))&&r++;return r},AVERAGEA:()=>{const t=i(e);let n=0,r=0;return t.forEach(t=>{null!=t&&""!==t&&("number"==typeof t&&Number.isFinite(t)?n+=t:"boolean"==typeof t&&(n+=t?1:0),r++)}),r?n/r:0},AVEDEV:()=>{const t=r(e).filter(t=>Number.isFinite(t));if(!t.length)throw new Error("#DIV/0!");const n=m(t);return t.reduce((t,e)=>t+Math.abs(e-n),0)/t.length},MAXA:()=>{const t=i(e),n=[];return t.forEach(t=>{null!=t&&""!==t&&("number"==typeof t&&Number.isFinite(t)?n.push(t):"boolean"==typeof t?n.push(t?1:0):n.push(0))}),n.length?Math.max(...n):0},MINA:()=>{const t=i(e),n=[];return t.forEach(t=>{null!=t&&""!==t&&("number"==typeof t&&Number.isFinite(t)?n.push(t):"boolean"==typeof t?n.push(t?1:0):n.push(0))}),n.length?Math.min(...n):0},AVERAGEIF:()=>{const t=a(e[0]),i=s(n(e[1])),r=void 0!==e[2]?a(e[2]):t;if(r.length!==t.length)throw new Error("#VALUE!");let o=0,l=0;for(let e=0;e<t.length;e++){if(!i(t[e]))continue;const n=Number(r[e]);Number.isFinite(n)&&(o+=n,l++)}if(!l)throw new Error("#DIV/0!");return o/l},AVERAGEIFS:()=>{if(e.length<3||(e.length-1)%2!=0)throw new Error("#VALUE!");const t=a(e[0]),i=[];for(let l=1;l<e.length;l+=2){const r=a(e[l]);if(r.length!==t.length)throw new Error("#VALUE!");i.push({range:r,test:s(n(e[l+1]))})}let r=0,o=0;for(let e=0;e<t.length;e++){if(!i.every(t=>t.test(t.range[e])))continue;const n=Number(t[e]);Number.isFinite(n)&&(r+=n,o++)}if(!o)throw new Error("#DIV/0!");return r/o},"VAR.S":()=>o("VAR",e),"VAR.P":()=>{const t=r(e).filter(t=>"number"==typeof t&&Number.isFinite(t));if(!t.length)return 0;const n=t.reduce((t,e)=>t+e,0)/t.length;return t.reduce((t,e)=>t+Math.pow(e-n,2),0)/t.length},"STDEV.S":()=>o("STDEV",e),"STDEV.P":()=>{const t=r(e).filter(t=>"number"==typeof t&&Number.isFinite(t));if(!t.length)return 0;const n=t.reduce((t,e)=>t+e,0)/t.length,i=t.reduce((t,e)=>t+Math.pow(e-n,2),0)/t.length;return Math.sqrt(i)},VARA:()=>(t=>{if(t.length<2)throw new Error("#DIV/0!");const e=m(t);return t.reduce((t,n)=>t+(n-e)**2,0)/(t.length-1)})(f(e)),VARPA:()=>(t=>{if(!t.length)throw new Error("#DIV/0!");const e=m(t);return t.reduce((t,n)=>t+(n-e)**2,0)/t.length})(f(e)),STDEVA:()=>Math.sqrt(o("VARA",e)),STDEVPA:()=>Math.sqrt(o("VARPA",e)),SUMIFS:()=>{if(e.length<3||(e.length-1)%2!=0)throw new Error("#VALUE!");const t=a(e[0]),i=[];for(let o=1;o<e.length;o+=2){const r=a(e[o]);if(r.length!==t.length)throw new Error("#VALUE!");i.push({range:r,test:s(n(e[o+1]))})}let r=0;for(let e=0;e<t.length;e++){if(!i.every(t=>t.test(t.range[e])))continue;const n=Number(t[e]);Number.isFinite(n)&&(r+=n)}return r},COT:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||0===t)throw new Error("#DIV/0!");return 1/Math.tan(t)},SEC:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||0===Math.cos(t))throw new Error("#DIV/0!");return 1/Math.cos(t)},CSC:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||0===Math.sin(t))throw new Error("#DIV/0!");return 1/Math.sin(t)},"CEILING.MATH":()=>{const t=Number(n(e[0])),i=void 0!==e[1]?Number(n(e[1])):1,r=Math.abs(i||1),o=void 0!==e[2]?Number(n(e[2])):0;if(!Number.isFinite(t)||!Number.isFinite(r))throw new Error("#VALUE!");return t>=0?Math.ceil(t/r)*r:0===o?-Math.floor(Math.abs(t)/r)*r:-Math.ceil(Math.abs(t)/r)*r},"FLOOR.MATH":()=>{const t=Number(n(e[0])),i=void 0!==e[1]?Number(n(e[1])):1,r=Math.abs(i||1),o=void 0!==e[2]?Number(n(e[2])):0;if(!Number.isFinite(t)||!Number.isFinite(r))throw new Error("#VALUE!");return t>=0?Math.floor(t/r)*r:0===o?-Math.ceil(Math.abs(t)/r)*r:-Math.floor(Math.abs(t)/r)*r},COMBIN:()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!");if(t<0||i<0||i>t)throw new Error("#NUM!");const r=Math.min(i,t-i);let o=1;for(let e=1;e<=r;e++)o=o*(t-r+e)/e;return o},COMBINA:()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!");if(t<0||i<0)throw new Error("#NUM!");return o("COMBIN",[t+i-1,i])},PERMUT:()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!");if(t<0||i<0||i>t)throw new Error("#NUM!");let r=1;for(let e=0;e<i;e++)r*=t-e;return r},PERMUTATIONA:()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!");if(t<0||i<0)throw new Error("#NUM!");return t**i},MULTINOMIAL:()=>{const t=r(e).filter(t=>"number"==typeof t&&Number.isFinite(t));if(!t.length||t.some(t=>t<0||!Number.isInteger(t)))throw new Error("#NUM!");const n=t=>{let e=1;for(let n=2;n<=t;n++)e*=n;return e},i=t.reduce((t,e)=>t+e,0);return n(i)/t.reduce((t,e)=>t*n(e),1)},PERCENTOF:()=>{const t=Number(n(e[0])),i=Number(n(e[1]));if(!Number.isFinite(t)||!Number.isFinite(i))throw new Error("#VALUE!");if(0===i)throw new Error("#DIV/0!");return t/i},DEVSQ:()=>{const t=r(e).filter(t=>Number.isFinite(t));if(!t.length)throw new Error("#DIV/0!");const n=m(t);return t.reduce((t,e)=>t+(e-n)**2,0)},GEOMEAN:()=>{const t=r(e).filter(t=>Number.isFinite(t));if(!t.length)throw new Error("#DIV/0!");if(t.some(t=>t<=0))throw new Error("#NUM!");const n=t.reduce((t,e)=>t+Math.log(e),0);return Math.exp(n/t.length)},HARMEAN:()=>{const t=r(e).filter(t=>Number.isFinite(t));if(!t.length)throw new Error("#DIV/0!");if(t.some(t=>t<=0))throw new Error("#NUM!");const n=t.reduce((t,e)=>t+1/e,0);return t.length/n},PHI:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");return Math.exp(-(t**2)/2)/Math.sqrt(2*Math.PI)},STANDARDIZE:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(!Number.isFinite(t)||!Number.isFinite(i)||!Number.isFinite(r))throw new Error("#VALUE!");if(r<=0)throw new Error("#NUM!");return(t-i)/r},FISHER:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");if(t<=-1||t>=1)throw new Error("#NUM!");return.5*Math.log((1+t)/(1-t))},FISHERINV:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");const i=Math.exp(2*t);return(i-1)/(i+1)},CORREL:()=>(t=>{if(t.length<2)throw new Error("#DIV/0!");const e=m(t.map(t=>t[0])),n=m(t.map(t=>t[1]));let i=0,r=0,o=0;t.forEach(([t,a])=>{const s=t-e,l=a-n;i+=s*l,r+=s*s,o+=l*l});const a=Math.sqrt(r*o);if(0===a)throw new Error("#DIV/0!");return i/a})(p(e[0],e[1])),PEARSON:()=>o("CORREL",e),RSQ:()=>{const t=o("CORREL",e);return t*t},SLOPE:()=>g(p(e[1],e[0])).slope,INTERCEPT:()=>g(p(e[1],e[0])).intercept,COTH:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||0===t)throw new Error("#DIV/0!");return Math.cosh(t)/Math.sinh(t)},CSCH:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||0===Math.sinh(t))throw new Error("#DIV/0!");return 1/Math.sinh(t)},SECH:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");return 1/Math.cosh(t)},BASE:()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!"),r=void 0!==e[2]?l(n(e[2]),"#NUM!"):0;if(t<0||i<2||i>36||r<0)throw new Error("#NUM!");const o=t.toString(i).toUpperCase();return r>o.length?`${"0".repeat(r-o.length)}${o}`:o},DECIMAL:()=>{const t=String(n(e[0])??"").trim(),i=l(n(e[1]),"#NUM!");if(!t||i<2||i>36)throw new Error("#NUM!");const r=parseInt(t,i);if(!Number.isFinite(r))throw new Error("#NUM!");return r},RANK:()=>o("RANK.EQ",e),"RANK.EQ":()=>{const t=Number(n(e[0])),i=c(e[1]),r=void 0!==e[2]?Number(n(e[2])):0;if(!Number.isFinite(t)||!i.length)throw new Error("#N/A");const o=(1===r?[...i]:[...i].reverse()).findIndex(e=>e===t);if(o<0)throw new Error("#N/A");return o+1},MEDIAN:()=>{const t=c(i(e));if(!t.length)return 0;const n=Math.floor(t.length/2);return t.length%2==0?(t[n-1]+t[n])/2:t[n]},LARGE:()=>{const t=c(e[0]).reverse(),i=l(n(e[1]),"#NUM!");if(i<1||i>t.length)throw new Error("#NUM!");return t[i-1]},SMALL:()=>{const t=c(e[0]),i=l(n(e[1]),"#NUM!");if(i<1||i>t.length)throw new Error("#NUM!");return t[i-1]},MODE:()=>o("MODE.SNGL",e),"MODE.SNGL":()=>{const t=c(i(e));if(!t.length)throw new Error("#N/A");const n=new Map;t.forEach(t=>n.set(t,(n.get(t)||0)+1));let r=null,o=0;if(n.forEach((t,e)=>{(t>o||t===o&&null!==r&&e<r)&&(r=e,o=t)}),o<=1)throw new Error("#N/A");return r},PERCENTILE:()=>o("PERCENTILE.INC",e),"PERCENTILE.INC":()=>h(c(e[0]),Number(n(e[1]))),"PERCENTILE.EXC":()=>u(c(e[0]),Number(n(e[1]))),QUARTILE:()=>o("QUARTILE.INC",e),"QUARTILE.INC":()=>{const t=c(e[0]),i=l(n(e[1]),"#NUM!");if(i<0||i>4)throw new Error("#NUM!");return h(t,i/4)},"QUARTILE.EXC":()=>{const t=c(e[0]),i=l(n(e[1]),"#NUM!");if(i<1||i>3)throw new Error("#NUM!");return u(t,i/4)},PERCENTRANK:()=>o("PERCENTRANK.INC",e),"PERCENTRANK.INC":()=>{const t=c(e[0]),i=Number(n(e[1])),r=void 0!==e[2]?l(n(e[2]),"#NUM!"):3;if(!t.length||!Number.isFinite(i))throw new Error("#N/A");if(i<t[0]||i>t[t.length-1])throw new Error("#N/A");if(1===t.length)return 1;let o=0;for(let e=0;e<t.length;e++){if(t[e]===i){o=e/(t.length-1);break}if(t[e]<i&&e+1<t.length&&t[e+1]>i){o=(e+(i-t[e])/(t[e+1]-t[e]))/(t.length-1);break}}const a=10**r;return Math.round(o*a)/a},"PERCENTRANK.EXC":()=>{const t=c(e[0]),i=Number(n(e[1])),r=void 0!==e[2]?l(n(e[2]),"#NUM!"):3;if(!t.length||!Number.isFinite(i))throw new Error("#N/A");if(i<=t[0]||i>=t[t.length-1])throw new Error("#N/A");let o=0;for(let e=0;e<t.length;e++){if(t[e]===i){o=(e+1)/(t.length+1);break}if(t[e]<i&&e+1<t.length&&t[e+1]>i){o=(e+1+(i-t[e])/(t[e+1]-t[e]))/(t.length+1);break}}const a=10**r;return Math.round(o*a)/a},MAXIFS:()=>{if(e.length<3||(e.length-1)%2!=0)throw new Error("#VALUE!");const t=a(e[0]),i=[];for(let o=1;o<e.length;o+=2){const r=a(e[o]);if(r.length!==t.length)throw new Error("#VALUE!");i.push({range:r,test:s(n(e[o+1]))})}const r=[];for(let e=0;e<t.length;e++){if(!i.every(t=>t.test(t.range[e])))continue;const n=Number(t[e]);Number.isFinite(n)&&r.push(n)}return r.length?Math.max(...r):0},MINIFS:()=>{if(e.length<3||(e.length-1)%2!=0)throw new Error("#VALUE!");const t=a(e[0]),i=[];for(let o=1;o<e.length;o+=2){const r=a(e[o]);if(r.length!==t.length)throw new Error("#VALUE!");i.push({range:r,test:s(n(e[o+1]))})}const r=[];for(let e=0;e<t.length;e++){if(!i.every(t=>t.test(t.range[e])))continue;const n=Number(t[e]);Number.isFinite(n)&&r.push(n)}return r.length?Math.min(...r):0},"MODE.MULT":()=>{const t=r(e).filter(t=>Number.isFinite(t));if(!t.length)throw new Error("#N/A");const n=new Map;t.forEach(t=>n.set(t,(n.get(t)||0)+1));let i=0;if(n.forEach(t=>{t>i&&(i=t)}),i<=1)throw new Error("#N/A");return[...n.entries()].filter(([,t])=>t===i).map(([t])=>t).sort((t,e)=>t-e).map(t=>[t])},COVAR:()=>o("COVARIANCE.P",e),"COVARIANCE.P":()=>{const t=p(e[0],e[1]);if(!t.length)throw new Error("#DIV/0!");const n=m(t.map(t=>t[0])),i=m(t.map(t=>t[1]));return t.reduce((t,[e,r])=>t+(e-n)*(r-i),0)/t.length},"COVARIANCE.S":()=>{const t=p(e[0],e[1]);if(t.length<2)throw new Error("#DIV/0!");const n=m(t.map(t=>t[0])),i=m(t.map(t=>t[1]));return t.reduce((t,[e,r])=>t+(e-n)*(r-i),0)/(t.length-1)},DOLLARDE:()=>{const t=Number(n(e[0])),i=l(n(e[1]),"#NUM!");if(!Number.isFinite(t)||i<=0)throw new Error("#NUM!");const r=Math.trunc(t);return r+100*Math.abs(t-r)/i},DOLLARFR:()=>{const t=Number(n(e[0])),i=l(n(e[1]),"#NUM!");if(!Number.isFinite(t)||i<=0)throw new Error("#NUM!");const r=t<0?-1:1,o=Math.abs(t),a=Math.trunc(o);return r*(a+(o-a)*i/100)},EFFECT:()=>{const t=Number(n(e[0])),i=l(n(e[1]),"#NUM!");if(!Number.isFinite(t)||i<1)throw new Error("#NUM!");return(1+t/i)**i-1},NOMINAL:()=>{const t=Number(n(e[0])),i=l(n(e[1]),"#NUM!");if(!Number.isFinite(t)||t<=-1||i<1)throw new Error("#NUM!");return i*((1+t)**(1/i)-1)},PV:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=void 0!==e[3]?Number(n(e[3])):0,a=F(void 0!==e[4]?n(e[4]):0);if(![t,i,r,o].every(Number.isFinite))throw new Error("#VALUE!");if(i<=0)throw new Error("#NUM!");return((t,e,n,i,r=0)=>{if(Math.abs(t)<v)return-(i+n*e);const o=(1+t)**e;return-(i+n*(1+t*r)*(o-1)/t)/o})(t,i,r,o,a)},FV:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=void 0!==e[3]?Number(n(e[3])):0,a=F(void 0!==e[4]?n(e[4]):0);if(![t,i,r,o].every(Number.isFinite))throw new Error("#VALUE!");if(i<=0)throw new Error("#NUM!");return((t,e,n,i,r=0)=>{if(Math.abs(t)<v)return-(i+n*e);const o=(1+t)**e;return-(i*o+n*(1+t*r)*(o-1)/t)})(t,i,r,o,a)},PMT:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=void 0!==e[3]?Number(n(e[3])):0,a=F(void 0!==e[4]?n(e[4]):0);if(![t,i,r,o].every(Number.isFinite))throw new Error("#VALUE!");if(i<=0)throw new Error("#NUM!");return E(t,i,r,o,a)},NPER:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=void 0!==e[3]?Number(n(e[3])):0,a=F(void 0!==e[4]?n(e[4]):0);if(![t,i,r,o].every(Number.isFinite))throw new Error("#VALUE!");return((t,e,n,i=0,r=0)=>{if(Math.abs(t)<v){if(Math.abs(e)<v)throw new Error("#DIV/0!");return-(n+i)/e}const o=e*(1+t*r)/t,a=(o-i)/(n+o);if(!Number.isFinite(a)||a<=0)throw new Error("#NUM!");return Math.log(a)/Math.log(1+t)})(t,i,r,o,a)},RATE:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=void 0!==e[3]?Number(n(e[3])):0,a=F(void 0!==e[4]?n(e[4]):0),s=void 0!==e[5]?Number(n(e[5])):.1;if(![t,i,r,o,s].every(Number.isFinite))throw new Error("#VALUE!");if(t<=0)throw new Error("#NUM!");return((t,e,n,i=0,r=0,o=.1)=>{const a=o=>{if(Math.abs(o)<v)return n+e*t+i;const a=(1+o)**t;return n*a+e*(1+o*r)*(a-1)/o+i};let s=Number.isFinite(o)?o:.1;s<=-.9999&&(s=-.5);for(let l=0;l<100;l++){const t=a(s);if(Math.abs(t)<1e-10)return s;const e=1e-6,n=(a(s+e)-a(s-e))/(2*e);if(!Number.isFinite(n)||Math.abs(n)<1e-12)break;const i=s-t/n;if(!Number.isFinite(i)||i<=-.999999)break;s=i}throw new Error("#NUM!")})(t,i,r,o,a,s)},IPMT:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=Number(n(e[3])),a=void 0!==e[4]?Number(n(e[4])):0,s=F(void 0!==e[5]?n(e[5]):0);if(![t,i,r,o,a].every(Number.isFinite))throw new Error("#VALUE!");return D(t,r,o,i,a,s).ipmt},PPMT:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=Number(n(e[3])),a=void 0!==e[4]?Number(n(e[4])):0,s=F(void 0!==e[5]?n(e[5]):0);if(![t,i,r,o,a].every(Number.isFinite))throw new Error("#VALUE!");return D(t,r,o,i,a,s).ppmt},CUMIPMT:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=l(n(e[3]),"#NUM!"),a=l(n(e[4]),"#NUM!"),s=F(n(e[5]));if(![t,i,r].every(Number.isFinite)||t<=0||i<=0||r<=0)throw new Error("#NUM!");if(o<1||a<o)throw new Error("#NUM!");let c=0;for(let e=o;e<=a;e++)c+=D(t,i,r,e,0,s).ipmt;return c},CUMPRINC:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=l(n(e[3]),"#NUM!"),a=l(n(e[4]),"#NUM!"),s=F(n(e[5]));if(![t,i,r].every(Number.isFinite)||t<=0||i<=0||r<=0)throw new Error("#NUM!");if(o<1||a<o)throw new Error("#NUM!");let c=0;for(let e=o;e<=a;e++)c+=D(t,i,r,e,0,s).ppmt;return c},ISPMT:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=Number(n(e[3]));if(![t,i,r,o].every(Number.isFinite)||r<=0)throw new Error("#NUM!");return o*t*(i/r-1)},NPV:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||t<=-1)throw new Error("#NUM!");return i(e.slice(1)).map(t=>Number(t)).filter(t=>Number.isFinite(t)).reduce((e,n,i)=>e+n/(1+t)**(i+1),0)},IRR:()=>{const t=i([e[0]]).map(t=>Number(t)).filter(t=>Number.isFinite(t)),r=void 0!==e[1]?Number(n(e[1])):.1;if(!t.length||!t.some(t=>t>0)||!t.some(t=>t<0))throw new Error("#NUM!");const o=e=>t.reduce((t,n,i)=>t+n/(1+e)**i,0);let a=Number.isFinite(r)?r:.1;a<=-.9999&&(a=-.5);for(let e=0;e<100;e++){const t=o(a);if(Math.abs(t)<1e-10)return a;const e=1e-6,n=(o(a+e)-o(a-e))/(2*e);if(!Number.isFinite(n)||Math.abs(n)<1e-12)break;const i=a-t/n;if(!Number.isFinite(i)||i<=-.999999)break;a=i}throw new Error("#NUM!")},XNPV:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t)||t<=-1)throw new Error("#NUM!");const i=y(e[1]).map(t=>Number(t)),r=y(e[2]).map(t=>x(t));if(!i.length||i.length!==r.length)throw new Error("#NUM!");const o=r[0].getTime();return i.reduce((e,n,i)=>{if(!Number.isFinite(n))return e;const a=(r[i].getTime()-o)/864e5/365;return e+n/(1+t)**a},0)},XIRR:()=>{const t=y(e[0]).map(t=>Number(t)),i=y(e[1]).map(t=>x(t)),r=void 0!==e[2]?Number(n(e[2])):.1;if(!t.length||t.length!==i.length)throw new Error("#NUM!");if(!t.some(t=>t>0)||!t.some(t=>t<0))throw new Error("#NUM!");const o=i[0].getTime(),a=e=>t.reduce((t,n,r)=>{const a=(i[r].getTime()-o)/864e5/365;return t+n/(1+e)**a},0);let s=Number.isFinite(r)?r:.1;s<=-.9999&&(s=-.5);for(let e=0;e<120;e++){const t=a(s);if(Math.abs(t)<1e-10)return s;const e=1e-6,n=(a(s+e)-a(s-e))/(2*e);if(!Number.isFinite(n)||Math.abs(n)<1e-12)break;const i=s-t/n;if(!Number.isFinite(i)||i<=-.999999)break;s=i}throw new Error("#NUM!")},MIRR:()=>{const t=i([e[0]]).map(t=>Number(t)).filter(t=>Number.isFinite(t)),r=Number(n(e[1])),o=Number(n(e[2]));if(!t.length||!Number.isFinite(r)||!Number.isFinite(o))throw new Error("#VALUE!");if(!t.some(t=>t>0)||!t.some(t=>t<0))throw new Error("#DIV/0!");const a=t.length;let s=0,l=0;if(t.forEach((t,e)=>{t<0&&(s+=t/(1+r)**e),t>0&&(l+=t*(1+o)**(a-1-e))}),0===s||l<=0)throw new Error("#DIV/0!");return(-l/s)**(1/(a-1))-1},FVSCHEDULE:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");return b(e[1]).reduce((t,e)=>t*(1+e),t)},PDURATION:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(![t,i,r].every(Number.isFinite)||t<=0||i<=0||r<=0)throw new Error("#NUM!");return Math.log(r/i)/Math.log(1+t)},RRI:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(![t,i,r].every(Number.isFinite)||t<=0||0===i)throw new Error("#NUM!");if(i>0&&r<0||i<0&&r>0)throw new Error("#NUM!");return(r/i)**(1/t)-1},SLN:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(![t,i,r].every(Number.isFinite)||r<=0)throw new Error("#NUM!");return(t-i)/r},SYD:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=Number(n(e[3]));if(![t,i,r,o].every(Number.isFinite)||r<=0||o<=0||o>r)throw new Error("#NUM!");return(t-i)*(r-o+1)*2/(r*(r+1))},DDB:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=l(n(e[3]),"#NUM!"),a=void 0!==e[4]?Number(n(e[4])):2;if(![t,i,r,a].every(Number.isFinite)||t<0||i<0||r<=0||a<=0||o<1)throw new Error("#NUM!");let s=t,c=0;for(let e=1;e<=o;e++)c=Math.min(s*a/r,s-i),c=Math.max(0,c),s-=c;return c},DB:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=l(n(e[3]),"#NUM!"),a=void 0!==e[4]?l(n(e[4]),"#NUM!"):12;if(![t,i,r].every(Number.isFinite)||t<=0||i<0||r<=0||o<1||a<1||a>12)throw new Error("#NUM!");const s=Math.round(1e3*(1-(i/t)**(1/r)))/1e3;if(1===o)return t*s*a/12;let c=t-t*s*a/12,h=0;const u=Math.floor(r)+1;if(o>u)return 0;for(let e=2;e<=o;e++)h=e===u?c*s*(12-a)/12:c*s,c-=h;return h},VDB:()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=Number(n(e[3])),a=Number(n(e[4])),s=void 0!==e[5]?Number(n(e[5])):2,l=void 0!==e[6]&&!!n(e[6]);if(![t,i,r,o,a,s].every(Number.isFinite)||t<0||i<0||r<=0||s<=0||o<0||a<=o)throw new Error("#NUM!");const c=((t,e,n,i=2,r=!1)=>{const o=Math.ceil(n),a=[];let s=t;for(let l=1;l<=o;l++){if(s<=e+v){a.push(0);continue}const t=s*i/n,o=(s-e)/Math.max(n-l+1,v);let c=r?t:Math.max(t,o);c=Math.max(0,Math.min(c,s-e)),a.push(c),s-=c}return a})(t,i,r,s,l);let h=0;for(let e=0;e<c.length;e++){const t=e,n=e+1,i=Math.max(0,Math.min(a,n)-Math.max(o,t));i>0&&(h+=c[e]*i)}return h},INTRATE:()=>{const t=n(e[0]),i=n(e[1]),r=Number(n(e[2])),o=Number(n(e[3])),a=void 0!==e[4]?n(e[4]):0;if(![r,o].every(Number.isFinite)||r<=0||o<=0)throw new Error("#NUM!");const s=w(t,i);return(o-r)/r*(S(a)/s)},DISC:()=>{const t=n(e[0]),i=n(e[1]),r=Number(n(e[2])),o=Number(n(e[3])),a=void 0!==e[4]?n(e[4]):0;if(![r,o].every(Number.isFinite)||r<=0||o<=0)throw new Error("#NUM!");const s=w(t,i);return(o-r)/o*(S(a)/s)},RECEIVED:()=>{const t=n(e[0]),i=n(e[1]),r=Number(n(e[2])),o=Number(n(e[3])),a=void 0!==e[4]?n(e[4]):0;if(![r,o].every(Number.isFinite)||r<=0||o<=0)throw new Error("#NUM!");const s=1-o*w(t,i)/S(a);if(s<=0)throw new Error("#NUM!");return r/s},GAMMALN:()=>M(n(e[0])),"GAMMALN.PRECISE":()=>o("GAMMALN",e),GAMMA:()=>Math.exp(M(n(e[0]))),"NORM.S.DIST":()=>{const t=Number(n(e[0])),i=void 0===e[1]||!!n(e[1]);if(!Number.isFinite(t))throw new Error("#VALUE!");return i?N(t):A(t)},NORMSDIST:()=>o("NORM.S.DIST",[e[0],!0]),"NORM.S.INV":()=>k(n(e[0])),NORMSINV:()=>o("NORM.S.INV",e),"NORM.DIST":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=!!n(e[3]);if(![t,i,r].every(Number.isFinite))throw new Error("#VALUE!");if(r<=0)throw new Error("#NUM!");const a=(t-i)/r;return o?N(a):A(a)/r},NORMDIST:()=>o("NORM.DIST",[e[0],e[1],e[2],!0]),"NORM.INV":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(![t,i,r].every(Number.isFinite))throw new Error("#VALUE!");if(r<=0)throw new Error("#NUM!");return i+r*k(t)},NORMINV:()=>o("NORM.INV",e),"LOGNORM.DIST":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=!!n(e[3]);if(![t,i,r].every(Number.isFinite))throw new Error("#VALUE!");if(t<=0||r<=0)throw new Error("#NUM!");const a=(Math.log(t)-i)/r;return o?N(a):Math.exp(-(a**2)/2)/(t*r*Math.sqrt(2*Math.PI))},LOGNORMDIST:()=>o("LOGNORM.DIST",[e[0],e[1],e[2],!0]),"LOGNORM.INV":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(![t,i,r].every(Number.isFinite))throw new Error("#VALUE!");if(r<=0)throw new Error("#NUM!");return Math.exp(i+r*k(t))},LOGINV:()=>o("LOGNORM.INV",e),GAUSS:()=>{const t=Number(n(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");return N(t)-.5},"CONFIDENCE.NORM":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2]));if(![t,i,r].every(Number.isFinite)||t<=0||t>=1||i<=0||r<1)throw new Error("#NUM!");return k(1-t/2)*i/Math.sqrt(r)},CONFIDENCE:()=>o("CONFIDENCE.NORM",e),"CONFIDENCE.T":()=>o("CONFIDENCE.NORM",e),"EXPON.DIST":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=!!n(e[2]);if(![t,i].every(Number.isFinite))throw new Error("#VALUE!");if(t<0||i<=0)throw new Error("#NUM!");return r?1-Math.exp(-i*t):i*Math.exp(-i*t)},EXPONDIST:()=>o("EXPON.DIST",e),"POISSON.DIST":()=>{const t=l(n(e[0]),"#NUM!"),i=Number(n(e[1])),r=!!n(e[2]);if(!Number.isFinite(i)||i<=0||t<0)throw new Error("#NUM!");const o=t=>Math.exp(-i+t*Math.log(i)-M(t+1));if(!r)return o(t);let a=0;for(let e=0;e<=t;e++)a+=o(e);return a},POISSON:()=>o("POISSON.DIST",e),"BINOM.DIST":()=>{const t=n(e[0]),i=n(e[1]),r=n(e[2]),o=!!n(e[3]),a=l(t,"#NUM!");if(!o)return _(a,i,r);const s=l(i,"#NUM!");let c=0;for(let e=0;e<=a;e++)c+=_(e,s,r);return c},BINOMDIST:()=>o("BINOM.DIST",e),"BINOM.DIST.RANGE":()=>{const t=l(n(e[0]),"#NUM!"),i=Number(n(e[1])),r=l(n(e[2]),"#NUM!"),o=void 0!==e[3]?l(n(e[3]),"#NUM!"):r;if(!Number.isFinite(i)||i<0||i>1||t<0||r<0||o<r||o>t)throw new Error("#NUM!");let a=0;for(let e=r;e<=o;e++)a+=_(e,t,i);return a},"BINOM.INV":()=>{const t=l(n(e[0]),"#NUM!"),i=Number(n(e[1])),r=Number(n(e[2]));if(!Number.isFinite(i)||i<0||i>1||!Number.isFinite(r)||r<0||r>1||t<0)throw new Error("#NUM!");let o=0;for(let e=0;e<=t;e++)if(o+=_(e,t,i),o>=r)return e;return t},CRITBINOM:()=>o("BINOM.INV",e),"NEGBINOM.DIST":()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!"),r=Number(n(e[2]));if(!n(e[3]))return I(t,i,r);let o=0;for(let e=0;e<=t;e++)o+=I(e,i,r);return o},NEGBINOMDIST:()=>o("NEGBINOM.DIST",[e[0],e[1],e[2],!1]),"HYPGEOM.DIST":()=>{const t=l(n(e[0]),"#NUM!"),i=l(n(e[1]),"#NUM!"),r=l(n(e[2]),"#NUM!"),o=l(n(e[3]),"#NUM!"),a=!!n(e[4]);if(o<=0||i<0||r<0||r>o||t<0||t>i)throw new Error("#NUM!");const s=Math.max(0,i-(o-r)),c=Math.min(i,r),h=t=>t<s||t>c?0:$(r,t)*$(o-r,i-t)/$(o,i);if(!a)return h(t);let u=0;for(let e=s;e<=t;e++)u+=h(e);return u},HYPGEOMDIST:()=>o("HYPGEOM.DIST",[e[0],e[1],e[2],e[3],!1]),"WEIBULL.DIST":()=>{const t=Number(n(e[0])),i=Number(n(e[1])),r=Number(n(e[2])),o=!!n(e[3]);if(![t,i,r].every(Number.isFinite))throw new Error("#VALUE!");if(t<0||i<=0||r<=0)throw new Error("#NUM!");const a=(t/r)**i;if(o)return 1-Math.exp(-a);if(0===t&&i<1)throw new Error("#NUM!");return i/r*(t/r)**(i-1)*Math.exp(-a)},WEIBULL:()=>o("WEIBULL.DIST",e),PROB:()=>{const t=y(e[0]),i=y(e[1]),r=Number(n(e[2])),o=void 0!==e[3]?Number(n(e[3])):r;if(t.length!==i.length||!Number.isFinite(r)||!Number.isFinite(o))throw new Error("#N/A");let a=0,s=0;for(let e=0;e<t.length;e++){const n=Number(i[e]),l=Number(t[e]);if(!Number.isFinite(n)||n<0||n>1)throw new Error("#NUM!");a+=n,Number.isFinite(l)&&l>=Math.min(r,o)&&l<=Math.max(r,o)&&(s+=n)}if(Math.abs(a-1)>1e-7)throw new Error("#NUM!");return s},FREQUENCY:()=>{const t=b(e[0]),n=b(e[1]).sort((t,e)=>t-e),i=Array.from({length:n.length+1},()=>0);return t.forEach(t=>{let e=n.findIndex(e=>t<=e);e<0&&(e=n.length),i[e]++}),i.map(t=>[t])},TRIMMEAN:()=>{const t=r([e[0]]).filter(t=>Number.isFinite(t)).sort((t,e)=>t-e),i=Number(n(e[1]));if(!Number.isFinite(i)||i<0||i>=1)throw new Error("#NUM!");if(!t.length)throw new Error("#DIV/0!");const o=Math.floor(t.length*i/2);if(2*o>=t.length)throw new Error("#NUM!");const a=t.slice(o,t.length-o);return m(a)},SKEW:()=>{const t=r(e).filter(t=>Number.isFinite(t)),n=t.length;if(n<3)throw new Error("#DIV/0!");const i=m(t),o=Math.sqrt(t.reduce((t,e)=>t+(e-i)**2,0)/(n-1));if(0===o)throw new Error("#DIV/0!");const a=t.reduce((t,e)=>t+((e-i)/o)**3,0);return n*a/((n-1)*(n-2))},"SKEW.P":()=>{const t=r(e).filter(t=>Number.isFinite(t)),n=t.length;if(n<1)throw new Error("#DIV/0!");const i=m(t),o=Math.sqrt(t.reduce((t,e)=>t+(e-i)**2,0)/n);if(0===o)throw new Error("#DIV/0!");return t.reduce((t,e)=>t+((e-i)/o)**3,0)/n},KURT:()=>{const t=r(e).filter(t=>Number.isFinite(t)),n=t.length;if(n<4)throw new Error("#DIV/0!");const i=m(t),o=t.reduce((t,e)=>t+(e-i)**2,0)/(n-1);if(0===o)throw new Error("#DIV/0!");const a=o*o,s=t.reduce((t,e)=>t+(e-i)**4,0);return n*(n+1)*s/((n-1)*(n-2)*(n-3)*a)-3*(n-1)**2/((n-2)*(n-3))},STEYX:()=>{const t=p(e[1],e[0]);if(t.length<3)throw new Error("#DIV/0!");const{slope:n,intercept:i}=g(t),r=t.reduce((t,[e,r])=>t+(r-(i+n*e))**2,0);return Math.sqrt(r/(t.length-2))},"FORECAST.LINEAR":()=>{const t=Number(n(e[0])),i=p(e[2],e[1]),{slope:r,intercept:o}=g(i);return o+r*t},FORECAST:()=>o("FORECAST.LINEAR",e),LINEST:()=>{const t=b(e[0]),i=C(e[1],t.length);if(t.length!==i.length||t.length<2)throw new Error("#N/A");const r=i.map((e,n)=>[e,t[n]]).filter(([t,e])=>Number.isFinite(t)&&Number.isFinite(e)),o=void 0===e[2]||!!n(e[2]),a=R(r,!o);return[[a.slope,a.intercept]]},LOGEST:()=>{const t=b(e[0]);if(t.some(t=>t<=0))throw new Error("#NUM!");const i=C(e[1],t.length);if(t.length!==i.length||t.length<2)throw new Error("#N/A");const r=i.map((e,n)=>[e,Math.log(t[n])]).filter(([t,e])=>Number.isFinite(t)&&Number.isFinite(e)),o=void 0===e[2]||!!n(e[2]),a=R(r,!o);return[[Math.exp(a.slope),Math.exp(a.intercept)]]},TREND:()=>{const t=b(e[0]),i=C(e[1],t.length);if(t.length!==i.length||t.length<2)throw new Error("#N/A");const r=i.map((e,n)=>[e,t[n]]).filter(([t,e])=>Number.isFinite(t)&&Number.isFinite(e)),o=void 0===e[3]||!!n(e[3]),a=R(r,!o),s=C(e[2],t.length).map(t=>a.intercept+a.slope*t);return void 0===e[2]?s.map(t=>[t]):T(e[2],s)},GROWTH:()=>{const t=b(e[0]);if(t.some(t=>t<=0))throw new Error("#NUM!");const i=C(e[1],t.length);if(t.length!==i.length||t.length<2)throw new Error("#N/A");const r=i.map((e,n)=>[e,Math.log(t[n])]).filter(([t,e])=>Number.isFinite(t)&&Number.isFinite(e)),o=void 0===e[3]||!!n(e[3]),a=R(r,!o),s=C(e[2],t.length).map(t=>Math.exp(a.intercept+a.slope*t));return void 0===e[2]?s.map(t=>[t]):T(e[2],s)},"Z.TEST":()=>{const t=b(e[0]),i=Number(n(e[1])),r=void 0!==e[2]?Number(n(e[2])):null;if(!t.length||!Number.isFinite(i))throw new Error("#VALUE!");const o=m(t),a=Number.isFinite(r)?r:Math.sqrt(t.reduce((t,e)=>t+(e-o)**2,0)/Math.max(t.length-1,1));if(!Number.isFinite(a)||a<=0)throw new Error("#DIV/0!");const s=(o-i)/(a/Math.sqrt(t.length));return 1-N(s)},ZTEST:()=>o("Z.TEST",e),IMCOSH:()=>{const t=n(e[0]),i=o("IMPRODUCT",[-1,t]),r=o("IMEXP",[t]),a=o("IMEXP",[i]);return o("IMDIV",[o("IMSUM",[r,a]),2])},IMSINH:()=>{const t=n(e[0]),i=o("IMPRODUCT",[-1,t]),r=o("IMEXP",[t]),a=o("IMEXP",[i]);return o("IMDIV",[o("IMSUB",[r,a]),2])},IMTAN:()=>o("IMDIV",[o("IMSIN",[n(e[0])]),o("IMCOS",[n(e[0])])]),IMCOT:()=>o("IMDIV",[o("IMCOS",[n(e[0])]),o("IMSIN",[n(e[0])])]),IMSEC:()=>o("IMDIV",[1,o("IMCOS",[n(e[0])])]),IMCSC:()=>o("IMDIV",[1,o("IMSIN",[n(e[0])])]),IMSECH:()=>o("IMDIV",[1,o("IMCOSH",[n(e[0])])]),IMCSCH:()=>o("IMDIV",[1,o("IMSINH",[n(e[0])])]),STDEVP:()=>o("STDEV.P",e),VARP:()=>o("VAR.P",e)}}(y),x=function(t){const{stack:e,gVal:n,ensureInteger:i,toMatrixValue:r,matchIndex:o,firstCellFromArg:a}=t;return{ROWS:()=>{const t=n(e[0]);return Array.isArray(t)&&Array.isArray(t[0])?t.length:1},COLUMNS:()=>{const t=n(e[0]);return Array.isArray(t)?Array.isArray(t[0])?t[0].length:t.length:1},CHOOSE:()=>{const t=i(n(e[0]),"#VALUE!");if(t<1||t>=e.length)throw new Error("#VALUE!");return n(e[t])},HYPERLINK:()=>{const t=String(n(e[0])??"");return(void 0!==e[1]?n(e[1]):null)??t},XMATCH:()=>{const t=n(e[0]),i=n(e[1]),r=Array.isArray(i)?Array.isArray(i[0])?i.flat():i:[i],a=void 0!==e[2]?Number(n(e[2])):0,s=void 0!==e[3]?Number(n(e[3])):1,l=o(r,t,a,s);if(l<0)throw new Error("#N/A");return l+1},FORMULATEXT:()=>{const t=a(e[0]);if(!t||"string"!=typeof t.editVal||!t.editVal.startsWith("="))throw new Error("#N/A");return t.editVal},TAKE:()=>{const t=r(e[0]),o=void 0!==e[1]?i(n(e[1])):t.length,a=void 0!==e[2]?i(n(e[2])):t[0]?.length||0;if(0===o||0===a)throw new Error("#VALUE!");const s=Math.min(Math.abs(o),t.length),l=o>0?t.slice(0,s):t.slice(t.length-s),c=l.length?Math.min(Math.abs(a),l[0].length):0;return l.map(t=>a>0?t.slice(0,c):t.slice(t.length-c))},DROP:()=>{const t=r(e[0]),o=void 0!==e[1]?i(n(e[1])):0,a=void 0!==e[2]?i(n(e[2])):0,s=Math.max(t.length-Math.min(Math.abs(o),t.length),0),l=o>=0?Math.min(o,t.length):0,c=o>=0?t.length:s,h=t.slice(l,c);if(!h.length)return[[]];const u=h[0].length,d=Math.max(u-Math.min(Math.abs(a),u),0),f=a>=0?Math.min(a,u):0,p=a>=0?u:d,m=h.map(t=>t.slice(f,p));return m.length?m:[[]]},EXPAND:()=>{const t=r(e[0]),o=i(n(e[1])),a=void 0!==e[2]?i(n(e[2])):t[0]?.length||0,s=void 0!==e[3]?n(e[3]):"#N/A";if(o<t.length||a<(t[0]?.length||0))throw new Error("#VALUE!");return Array.from({length:o},(e,n)=>Array.from({length:a},(e,i)=>n<t.length&&i<t[0].length?t[n][i]:s))},TRIMRANGE:()=>{const t=r(e[0]),n=t=>null==t||""===t;let i=0,o=t.length-1,a=0,s=t[0].length-1;for(;i<=o&&t[i].every(n);)i++;for(;o>=i&&t[o].every(n);)o--;const l=e=>{for(let r=i;r<=o;r++)if(!n(t[r][e]))return!1;return!0};for(;a<=s&&l(a);)a++;for(;s>=a&&l(s);)s--;return i>o||a>s?[[""]]:t.slice(i,o+1).map(t=>t.slice(a,s+1))}}}(y),w=function(t){const{stack:e,gVal:n,execute:i,getFlatValues:r,splitByDelims:o,toDelims:a,toArrayText:s,escapeRegex:l,ensureInteger:c,halfWidthText:h,fullWidthText:u,firstCellFromArg:d,currentCell:f,SN:p}=t;return{REPLACEB:()=>i("REPLACE",e),FINDB:()=>i("FIND",e),SEARCHB:()=>i("SEARCH",e),TEXTJOIN:()=>{const t=String(n(e[0])??""),i=!!n(e[1]),o=[];for(let n=2;n<e.length;n++)r(e[n]).forEach(t=>{(!i||""!==t&&null!=t)&&o.push(String(t??""))});return o.join(t)},TEXTBEFORE:()=>{const t=String(n(e[0])??""),i=String(n(e[1])??""),r=void 0!==e[2]?Number(n(e[2])):1,o=void 0!==e[3]?Number(n(e[3])):0,a=void 0!==e[4]&&!!n(e[4]),s=void 0!==e[5]?n(e[5]):null,l=0===r?1:Math.trunc(r);if(""===i)return l>0?"":t;const c=1===o?t.toLowerCase():t,h=1===o?i.toLowerCase():i;let u=-1;if(l>0){let t=0;for(let e=0;e<l&&(u=c.indexOf(h,t),-1!==u);e++)t=u+h.length}else{let t=c.length;for(let e=0;e<Math.abs(l)&&(u=c.lastIndexOf(h,t-1),-1!==u);e++)t=u}if(-1===u){if(null!==s)return s;if(a)return t;throw new Error("#N/A")}return t.substring(0,u)},TEXTAFTER:()=>{const t=String(n(e[0])??""),i=String(n(e[1])??""),r=void 0!==e[2]?Number(n(e[2])):1,o=void 0!==e[3]?Number(n(e[3])):0,a=void 0!==e[4]&&!!n(e[4]),s=void 0!==e[5]?n(e[5]):null,l=0===r?1:Math.trunc(r);if(""===i)return l>0?t:"";const c=1===o?t.toLowerCase():t,h=1===o?i.toLowerCase():i;let u=-1;if(l>0){let t=0;for(let e=0;e<l&&(u=c.indexOf(h,t),-1!==u);e++)t=u+h.length}else{let t=c.length;for(let e=0;e<Math.abs(l)&&(u=c.lastIndexOf(h,t-1),-1!==u);e++)t=u}if(-1===u){if(null!==s)return s;if(a)return"";throw new Error("#N/A")}return t.substring(u+i.length)},TEXTSPLIT:()=>{const t=String(n(e[0])??""),i=n(e[1]),r=void 0!==e[2]?n(e[2]):null,s=void 0!==e[3]&&!!n(e[3]),l=void 0!==e[4]?Number(n(e[4])):0,c=void 0!==e[5]?n(e[5]):"",h=(null==r?[t]:o(t,a(r),l)).map(t=>o(t,a(i),l)).map(t=>s?t.filter(t=>""!==t):t),u=h.reduce((t,e)=>Math.max(t,e.length),0);return h.map(t=>t.length<u?[...t,...Array(u-t.length).fill(c)]:t)},ARRAYTOTEXT:()=>s(n(e[0])),NUMBERVALUE:()=>{const t=String(n(e[0])??"").trim(),i=void 0!==e[1]?String(n(e[1])):".",r=void 0!==e[2]?String(n(e[2])):",";let o=t;r&&(o=o.replace(new RegExp(l(r),"g"),"")),i&&"."!==i&&(o=o.replace(new RegExp(l(i),"g"),"."));const a=Number(o);if(!Number.isFinite(a))throw new Error("#VALUE!");return a},ENCODEURL:()=>encodeURIComponent(String(n(e[0])??"")),UNICHAR:()=>{const t=c(n(e[0]));if(t<1||t>1114111)throw new Error("#VALUE!");return String.fromCodePoint(t)},UNICODE:()=>{const t=String(n(e[0])??"");if(!t)throw new Error("#VALUE!");return t.codePointAt(0)},VALUETOTEXT:()=>String(n(e[0])??""),REGEXTEST:()=>{const t=String(n(e[0])??""),i=String(n(e[1])??""),r=e[2]?String(n(e[2])):"";return new RegExp(i,r).test(t)},REGEXEXTRACT:()=>{const t=String(n(e[0])??""),i=String(n(e[1])??""),r=e[2]?String(n(e[2])):"",o=t.match(new RegExp(i,r));if(!o)throw new Error("#N/A");return o[1]??o[0]},REGEXREPLACE:()=>{const t=String(n(e[0])??""),i=String(n(e[1])??""),r=String(n(e[2])??""),o=e[3]?String(n(e[3])):"g";return t.replace(new RegExp(i,o),r)},ASC:()=>h(n(e[0])),JIS:()=>u(n(e[0])),"ERROR.TYPE":()=>i("ERROR_TYPE",e),ISFORMULA:()=>{const t=d(e[0]);return!(!t||"string"!=typeof t.editVal||!t.editVal.startsWith("="))},SHEET:()=>{if(!e.length){const t=f?.row?.sheet||p.activeSheet,e=p.sheets.findIndex(e=>e.name===t?.name);return e>=0?e+1:1}const t=d(e[0]);if(t?.row?.sheet){const e=p.sheets.findIndex(e=>e.name===t.row.sheet.name);if(e>=0)return e+1}const i=String(n(e[0])??""),r=i.match(/^'?([^']*)'?!/),o=r?r[1]:i,a=p.sheets.findIndex(t=>t.name===o);if(a<0)throw new Error("#N/A");return a+1},SHEETS:()=>e.length?1:p.sheets.length,CELL:()=>{const t=String(n(e[0])??"").toLowerCase(),i=void 0!==e[1]&&d(e[1])||f;if(!i)throw new Error("#VALUE!");switch(t){case"address":return`$${p.Utils.numToChar(i.cIndex)}$${i.row.rIndex+1}`;case"row":return i.row.rIndex+1;case"col":return i.cIndex+1;case"contents":return i.calcVal;case"type":return null==i.calcVal||""===i.calcVal?"b":"string"==typeof i.calcVal?"l":"v";case"filename":return"";default:throw new Error("#VALUE!")}},INFO:()=>{switch(String(n(e[0])??"").toLowerCase()){case"recalc":return"Automatic";case"origin":return"$A$1";case"numfile":return 1;case"release":case"osversion":return"SheetNext";case"system":return"pcdos";default:throw new Error("#N/A")}}}}(y),S=function(t){const{stack:e,gVal:n,toDate:i,execute:r,isoWeekNum:o,ensureInteger:a}=t;return{"CEILING.PRECISE":()=>r("CEILING_PRECISE",e),"ISO.CEILING":()=>r("ISO_CEILING",e),"FLOOR.PRECISE":()=>r("FLOOR_PRECISE",e),"WORKDAY.INTL":()=>r("WORKDAY_INTL",e),DAYS:()=>{const t=i(n(e[0])),r=i(n(e[1]));return Math.floor((t-r)/864e5)},"NETWORKDAYS.INTL":()=>r("NETWORKDAYS_INTL",e),ISOWEEKNUM:()=>o(i(n(e[0]))),BITAND:()=>{const t=BigInt(a(n(e[0]),"#NUM!")),i=BigInt(a(n(e[1]),"#NUM!"));if(t<0n||i<0n)throw new Error("#NUM!");return Number(t&i)},BITOR:()=>{const t=BigInt(a(n(e[0]),"#NUM!")),i=BigInt(a(n(e[1]),"#NUM!"));if(t<0n||i<0n)throw new Error("#NUM!");return Number(t|i)},BITXOR:()=>{const t=BigInt(a(n(e[0]),"#NUM!")),i=BigInt(a(n(e[1]),"#NUM!"));if(t<0n||i<0n)throw new Error("#NUM!");return Number(t^i)},BITLSHIFT:()=>{const t=BigInt(a(n(e[0]),"#NUM!")),i=a(n(e[1]),"#NUM!");if(t<0n)throw new Error("#NUM!");return Number(i>=0?t<<BigInt(i):t>>BigInt(-i))},BITRSHIFT:()=>{const t=BigInt(a(n(e[0]),"#NUM!")),i=a(n(e[1]),"#NUM!");if(t<0n)throw new Error("#NUM!");return Number(i>=0?t>>BigInt(i):t<<BigInt(-i))},"ERF.PRECISE":()=>r("ERF",e),"ERFC.PRECISE":()=>r("ERFC_PRECISE",e)}}(y),C={...b,...x,...w,...S,PI:()=>Math.PI,SUM:()=>this.#m(e).reduce((t,e)=>t+e,0),SUBTOTAL:()=>{if(e.length<2)throw new Error("#VALUE!");const{baseCode:t,ignoreManualHidden:n}=i(),a=r(e.slice(1),n);return o(t,a)},AGGREGATE:()=>{if(e.length<3)throw new Error("#VALUE!");const t=c();if(t.functionNum>=14){if(e.length<4)throw new Error("#VALUE!");const i=d(e[2],t),r=n(this.#g(e[3]));return m(t.functionNum,i,r)}const i=d(e.slice(2),t);return m(t.functionNum,i)},AVERAGE:()=>{const t=this.#m(e);return 0===t.length?0:t.reduce((t,e)=>t+e,0)/t.length},MAX:()=>Math.max(...this.#m(e)),ABS:()=>Math.abs(this.#g(e[0])),ROUND:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=Math.pow(10,n);return Math.round(t*i)/i},SQRT:()=>Math.sqrt(this.#g(e[0])),COUNT:()=>this.#m(e).length,COUNTA:()=>this.#p(e).filter(t=>null!=t&&""!=t).length,VAR:()=>{const t=this.#m(e),n=t.reduce((t,e)=>t+e)/t.length;return t.reduce((t,e)=>t+Math.pow(e-n,2),0)/(t.length-1)},STDEV:()=>{const t=this.#m(e),n=t.reduce((t,e)=>t+e)/t.length;return Math.sqrt(t.reduce((t,e)=>t+Math.pow(e-n,2),0)/(t.length-1))},IF:()=>this.#g(e[0])?this.#g(e[1]):this.#g(e[2]),IFS:()=>{for(let t=0;t+1<e.length;t+=2)if(this.#g(e[t]))return this.#g(e[t+1]);throw new Error("#N/A")},AND:()=>this.#p(e).every(Boolean),NOT:()=>!this.#g(e[0]),SWITCH:()=>{const t=this.#g(e[0]);for(let n=1;n+1<e.length;n+=2)if(this.#g(e[n])===t)return this.#g(e[n+1]);if(e.length%2==0)return this.#g(e[e.length-1]);throw new Error("#N/A")},XOR:()=>this.#p(e).filter(Boolean).length%2==1,CONCATENATE:()=>this.#p(e).join(""),CONCAT:()=>this.#p(e).map(t=>String(t??"")).join(""),LEFT:()=>{const t=String(this.#g(e[0])),n=void 0!==e[1]?this.#g(e[1]):1;return n<0?"":t.slice(0,n)},LEFTB:()=>this.executeFunction("LEFT",e),RIGHT:()=>{const t=String(this.#g(e[0])),n=void 0!==e[1]?this.#g(e[1]):1;return n<0||0===n?"":t.slice(-n)},RIGHTB:()=>this.executeFunction("RIGHT",e),MID:()=>{const t=String(this.#g(e[0])),n=this.#g(e[1]),i=this.#g(e[2]);if(n<1)throw new Error("#VALUE!");if(i<0)throw new Error("#VALUE!");return 0===i?"":t.substring(n-1,n-1+i)},MIDB:()=>this.executeFunction("MID",e),LEN:()=>String(this.#g(e[0])).length,LENB:()=>this.executeFunction("LEN",e),LOWER:()=>String(this.#g(e[0])).toLowerCase(),NOW:()=>(this.Mg=!0,h(new Date)),TODAY:()=>{this.Mg=!0;const t=new Date;return t.setHours(0,0,0,0),h(t)},YEAR:()=>this.#u(this.#g(e[0])).getFullYear(),MONTH:()=>this.#u(this.#g(e[0])).getMonth()+1,DAY:()=>this.#u(this.#g(e[0])).getDate(),HLOOKUP:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=this.#g(e[2])-1,r=this.#g(e[3])??!0;if(!Array.isArray(n)||!Array.isArray(n[0]))throw new Error("#REF!");const o=n[0];let a=-1;if(r){let e=null;a=-1;for(let n=0;n<o.length;n++){const i=o[n];i<=t&&(null===e||i>e)&&(e=i,a=n)}}else a=o.indexOf(t);return-1===a||i>=n.length?null:n[i][a]},SUMIF:()=>{const t=this.#p(e[0]),n=this.#g(e[1]),i=e[2]?this.#m(e[2]):this.#m(e[0]),r=Array.isArray(n)&&Array.isArray(n[0])?n.flat():Array.isArray(n)?n:null;return r?r.map(e=>t.reduce((t,n,r)=>{let o=!1;return o="string"==typeof e?e.startsWith(">=")?n>=parseFloat(e.slice(2)):e.startsWith("<=")?n<=parseFloat(e.slice(2)):e.startsWith("<>")?n!=parseFloat(e.slice(2)):e.startsWith(">")?n>parseFloat(e.slice(1)):e.startsWith("<")?n<parseFloat(e.slice(1)):e.startsWith("=")?n==parseFloat(e.slice(1)):n==e:n==e,o?t+(i[r]||0):t},0)):t.reduce((t,e,r)=>{let o=!1;return o="string"==typeof n?n.startsWith(">=")?e>=parseFloat(n.slice(2)):n.startsWith("<=")?e<=parseFloat(n.slice(2)):n.startsWith("<>")?e!=parseFloat(n.slice(2)):n.startsWith(">")?e>parseFloat(n.slice(1)):n.startsWith("<")?e<parseFloat(n.slice(1)):n.startsWith("=")?e==parseFloat(n.slice(1)):e==n:e==n,o?t+(i[r]||0):t},0)},LOOKUP:()=>{const t=this.#g(e[0]);let n,i,r=this.#g(e[1]),o=e.length>2?this.#g(e[2]):null;if(!Array.isArray(r))throw new Error("#REF!");if(Array.isArray(r[0]))if(1===r.length)n=r[0];else{if(1!==r[0].length){const e=r.map(t=>t[0]);let n=null,i=-1;for(let r=0;r<e.length;r++){const o=e[r];o<=t&&(null===n||o>n)&&(n=o,i=r)}return-1===i?"#N/A":o?(Array.isArray(o[0])?1===o.length?o[0]:o.map(t=>t[o[0].length-1]):o)[i]:r[i][r[0].length-1]}n=r.map(t=>t[0])}else n=r;i=o?Array.isArray(o[0])?1===o.length?o[0]:1===o[0].length?o.map(t=>t[0]):o[0]:o:n;let a=null,s=-1;for(let e=0;e<n.length;e++){const i=n[e];i<=t&&(null===a||i>a)&&(a=i,s=e)}return-1===s?"#N/A":i[s]},XLOOKUP:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=this.#g(e[2]),r=e.length>3?this.#g(e[3]):"#N/A",o=e.length>4?this.#g(e[4]):0,a=e.length>5?this.#g(e[5]):1;if(!Array.isArray(n)||!Array.isArray(i))throw new Error("#REF!");let s=-1;const l=n.flat();if(1===a)switch(o){case 0:s=l.indexOf(t);break;case-1:for(let e=0;e<l.length;e++)if(l[e]===t||l[e]<t&&(e===l.length-1||l[e+1]>t)){s=e;break}break;case 1:for(let e=0;e<l.length;e++)if(l[e]===t||l[e]>t&&(0===e||l[e-1]<t)){s=e;break}}else{const e=[...l].reverse();switch(o){case 0:s=l.lastIndexOf(t);break;case-1:for(let n=e.length-1;n>=0;n--)if(e[n]===t||e[n]<t&&(n===e.length-1||e[n+1]>t)){s=l.length-1-n;break}break;case 1:for(let n=e.length-1;n>=0;n--)if(e[n]===t||e[n]>t&&(0===n||e[n-1]<t)){s=l.length-1-n;break}}}return-1===s?r:i.flat()[s]},INDIRECT:()=>{const t=String(this.#g(e[0]));try{return this.#d(t)}catch{throw new Error("#REF!")}},OFFSET:()=>{const t=e[0],n=this.#g(e[1])||0,i=this.#g(e[2])||0,r=e.length>3?this.#g(e[3]):null,o=e.length>4?this.#g(e[4]):null;let a;if(!Array.isArray(t))throw new Error("#REF!");if(a=Array.isArray(t[0])?t[0][0]:t[0],!a||void 0===a.row)throw new Error("#REF!");const s=a.row.sheet,l=a.row.rIndex+n,c=a.cIndex+i;if(l<0||c<0)throw new Error("#REF!");const h=null!==r?r:1,u=null!==o?o:1;if(h<=0||u<=0)throw new Error("#REF!");if(1===h&&1===u)return[s.getCell(l,c)];const d=[];for(let e=0;e<h;e++){const t=[];for(let n=0;n<u;n++)t.push(s.getCell(l+e,c+n));d.push(t)}return d},INDEX:()=>{const t=this.#g(e[0]),n=this.#g(e[1])||0,i=e.length>2&&this.#g(e[2])||0;if(!Array.isArray(t)){if(n<=1&&i<=1)return t;throw new Error("#REF!")}const r=Array.isArray(t[0])?t:[t],o=r.length,a=r[0].length;if(0===n&&0===i)return r;if(0===n){if(i<1||i>a)throw new Error("#REF!");return r.map(t=>t[i-1])}if(0===i){if(n<1||n>o)throw new Error("#REF!");return r[n-1]}if(n<1||n>o||i<1||i>a)throw new Error("#REF!");return r[n-1][i-1]},MATCH:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=e.length>2?this.#g(e[2]):1,r=Array.isArray(n)?Array.isArray(n[0])?n.flat():n:[n];if(0===i){const e=r.indexOf(t);return-1===e?"#N/A":e+1}if(1===i){let e=-1;for(let n=0;n<r.length&&r[n]<=t;n++)e=n;return-1===e?"#N/A":e+1}{let e=-1;for(let n=0;n<r.length&&r[n]>=t;n++)e=n;return-1===e?"#N/A":e+1}},TRANSPOSE:()=>{const t=this.#g(e[0]);if(!Array.isArray(t))return[[t]];const n=Array.isArray(t[0])?t:[t],i=n.length,r=n[0].length,o=[];for(let e=0;e<r;e++){const t=[];for(let r=0;r<i;r++)t.push(n[r][e]);o.push(t)}return o},FILTER:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=e.length>2?this.#g(e[2]):"#CALC!";if(!Array.isArray(t))throw new Error("#VALUE!");const r=Array.isArray(t[0])?t:[t],o=Array.isArray(n)?Array.isArray(n[0])?n:[n]:[[n]],a=[],s=o.length===r.length&&1===o[0].length,l=1===o.length&&o[0].length===r[0].length;if(s)for(let e=0;e<r.length;e++)o[e][0]&&a.push(r[e]);else{if(!l)throw new Error("#VALUE!");{const t=[];for(let e=0;e<o[0].length;e++)o[0][e]&&t.push(e);for(const e of r)a.push(t.map(t=>e[t]))}}return a.length>0?a:i},UNIQUE:()=>{const t=this.#g(e[0]),n=e.length>1&&this.#g(e[1]),i=e.length>2&&this.#g(e[2]);if(!Array.isArray(t))return[[t]];const r=Array.isArray(t[0])?t:[t];if(n){const t=new Map,e=r[0].length,n=Array(r.length).fill(null).map(()=>[]);for(let i=0;i<e;i++){const e=r.map(t=>t[i]).join("\0"),n=(t.get(e)||0)+1;t.set(e,n)}for(let o=0;o<e;o++){const e=r.map(t=>t[o]).join("\0"),a=t.get(e);if(!i||1===a){if(!i&&t.get(e+"_added"))continue;for(let t=0;t<r.length;t++)n[t].push(r[t][o]);t.set(e+"_added",!0)}}return n[0].length>0?n:[[""]]}{const t=new Map;for(const i of r){const e=i.join("\0");t.set(e,(t.get(e)||0)+1)}const e=[],n=new Set;for(const o of r){const r=o.join("\0"),a=t.get(r);if(!i||1===a){if(!i&&n.has(r))continue;e.push([...o]),n.add(r)}}return e.length>0?e:[[""]]}},SORT:()=>{const t=this.#g(e[0]),n=e.length>1?this.#g(e[1]):1,i=e.length>2?this.#g(e[2]):1,r=e.length>3&&this.#g(e[3]);if(!Array.isArray(t))return[[t]];const o=(Array.isArray(t[0])?t:[t]).map(t=>[...t]);if(r){const t=o[0].map((t,e)=>o.map(t=>t[e]));return t.sort((t,e)=>{const r=t[n-1],o=e[n-1];return r<o?-i:r>o?i:0}),t[0].map((e,n)=>t.map(t=>t[n]))}return o.sort((t,e)=>{const r=t[n-1],o=e[n-1];return r<o?-i:r>o?i:0}),o},SORTBY:()=>{const t=this.#g(e[0]);if(!Array.isArray(t))return[[t]];const n=(Array.isArray(t[0])?t:[t]).map((t,e)=>({row:[...t],index:e}));for(let i=1;i<e.length;i+=2){const t=this.#g(e[i]),r=i+1<e.length?this.#g(e[i+1]):1,o=Array.isArray(t)?Array.isArray(t[0])?t.map(t=>t[0]):t:[t];n.sort((t,e)=>{const n=o[t.index],i=o[e.index];return n<i?-r:n>i?r:0})}return n.map(t=>t.row)},SEQUENCE:()=>{const t=this.#g(e[0]),n=e.length>1?this.#g(e[1]):1,i=e.length>2?this.#g(e[2]):1,r=e.length>3?this.#g(e[3]):1;if(t<=0||n<=0)throw new Error("#VALUE!");const o=[];let a=i;for(let e=0;e<t;e++){const t=[];for(let e=0;e<n;e++)t.push(a),a+=r;o.push(t)}return o},RANDARRAY:()=>{const t=e.length>0?this.#g(e[0]):1,n=e.length>1?this.#g(e[1]):1,i=e.length>2?this.#g(e[2]):0,r=e.length>3?this.#g(e[3]):1,o=e.length>4&&this.#g(e[4]);if(t<=0||n<=0)throw new Error("#VALUE!");const a=[];for(let e=0;e<t;e++){const t=[];for(let e=0;e<n;e++){let e=Math.random()*(r-i)+i;o&&(e=Math.floor(e)),t.push(e)}a.push(t)}return a},CHOOSECOLS:()=>{const t=this.#g(e[0]);if(!Array.isArray(t))throw new Error("#VALUE!");const n=Array.isArray(t[0])?t:[t],i=e.slice(1).map(t=>this.#g(t)),r=[];for(const e of n){const t=[];for(const n of i){const i=n>0?n-1:e.length+n;if(i<0||i>=e.length)throw new Error("#VALUE!");t.push(e[i])}r.push(t)}return r},CHOOSEROWS:()=>{const t=this.#g(e[0]);if(!Array.isArray(t))throw new Error("#VALUE!");const n=Array.isArray(t[0])?t:[t],i=e.slice(1).map(t=>this.#g(t)),r=[];for(const e of i){const t=e>0?e-1:n.length+e;if(t<0||t>=n.length)throw new Error("#VALUE!");r.push([...n[t]])}return r},VSTACK:()=>{const t=[];for(const n of e){const e=this.#g(n),i=Array.isArray(e)?Array.isArray(e[0])?e:[e]:[[e]];t.push(...i)}return t},HSTACK:()=>{const t=e.map(t=>{const e=this.#g(t);return Array.isArray(e)?Array.isArray(e[0])?e:[e]:[[e]]}),n=Math.max(...t.map(t=>t.length)),i=[];for(let e=0;e<n;e++){const n=[];for(const i of t){const t=i[e]||i[i.length-1]||[];n.push(...t)}i.push(n)}return i},WRAPCOLS:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=e.length>2?this.#g(e[2]):"#N/A",r=Array.isArray(t)?t.flat():[t],o=[],a=Math.ceil(r.length/n);for(let e=0;e<n;e++){const t=[];for(let o=0;o<a;o++){const a=o*n+e;t.push(a<r.length?r[a]:i)}o.push(t)}return o},WRAPROWS:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=e.length>2?this.#g(e[2]):"#N/A",r=Array.isArray(t)?t.flat():[t],o=[];for(let e=0;e<r.length;e+=n){const t=r.slice(e,e+n);for(;t.length<n;)t.push(i);o.push(t)}return o},TOCOL:()=>{const t=this.#g(e[0]),n=e.length>1?this.#g(e[1]):0,i=e.length>2&&this.#g(e[2]),r=Array.isArray(t)?Array.isArray(t[0])?t:[t]:[[t]],o=[];if(i)for(let e=0;e<r[0].length;e++)for(let t=0;t<r.length;t++){const i=r[t][e];1===n&&""===i||2===n&&(i instanceof Error||String(i).startsWith("#"))||3===n&&(""===i||i instanceof Error||String(i).startsWith("#"))||o.push([i])}else for(const e of r)for(const t of e)1===n&&""===t||2===n&&(t instanceof Error||String(t).startsWith("#"))||3===n&&(""===t||t instanceof Error||String(t).startsWith("#"))||o.push([t]);return o.length>0?o:[[""]]},TOROW:()=>{const t=this.#g(e[0]),n=e.length>1?this.#g(e[1]):0,i=e.length>2&&this.#g(e[2]),r=Array.isArray(t)?Array.isArray(t[0])?t:[t]:[[t]],o=[];if(i)for(let e=0;e<r[0].length;e++)for(let t=0;t<r.length;t++){const i=r[t][e];1===n&&""===i||2===n&&(i instanceof Error||String(i).startsWith("#"))||3===n&&(""===i||i instanceof Error||String(i).startsWith("#"))||o.push(i)}else for(const e of r)for(const t of e)1===n&&""===t||2===n&&(t instanceof Error||String(t).startsWith("#"))||3===n&&(""===t||t instanceof Error||String(t).startsWith("#"))||o.push(t);return[o.length>0?o:[""]]},VLOOKUP:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=this.#g(e[2])-1,r=this.#g(e[3])??!0;if(!Array.isArray(n)||!Array.isArray(n[0]))throw new Error("#REF!");if(i>=n[0].length)throw new Error("#REF!");const o=n.map(t=>t[0]);let a=-1;if(r){let e=null;for(let n=0;n<o.length;n++){const i=o[n];i<=t&&(null===e||i>e)&&(e=i,a=n)}}else a=o.indexOf(t);return-1===a?"#N/A":n[a][i]},TRIM:()=>String(this.#g(e[0])).replace(/^\s+|\s+$/g,"").replace(/\s+/g," "),MIN:()=>Math.min(...this.#m(e)),POWER:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);return Math.pow(t,n)},ROW:()=>e[0]?.[0]?e[0][0]?.row.rIndex+1:this.currentCell.row.rIndex+1,COLUMN:()=>e[0]?.[0]?e[0][0]?.cIndex+1:this.currentCell.cIndex+1,ADDRESS:()=>{const t=Number(this.#g(e[0])),n=Number(this.#g(e[1])),i=void 0!==e[2]?Number(this.#g(e[2])):1,r=void 0===e[3]||this.#g(e[3]),o=void 0!==e[4]?this.#g(e[4]):null;if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("#VALUE!");const a=Math.trunc(t),s=Math.trunc(n);if(a<1||s<1)throw new Error("#VALUE!");const l=Number.isFinite(i)?Math.trunc(i):1;if(![1,2,3,4].includes(l))throw new Error("#VALUE!");const c=!(!1===r||0===r||"FALSE"===String(r).toUpperCase()),h=this.SN.Utils.numToChar(s-1);let u;if(u=c?`${1===l||3===l?"$":""}${h}${1===l||2===l?"$":""}${a}`:`${1===l||2===l?`R${a}`:`R[${a}]`}${1===l||3===l?`C${s}`:`C[${s}]`}`,null==o||""===o)return u;const d=String(o),f=d.replace(/'/g,"''");return`${/[^A-Za-z0-9_.]/.test(d)?`'${f}'`:f}!${u}`},AREAS:()=>{if(!e.length)throw new Error("#VALUE!");return e.length},UPPER:()=>String(this.#g(e[0])).toUpperCase(),OR:()=>this.#p(e).some(Boolean),ACOS:()=>Math.acos(this.#g(e[0])),ASIN:()=>Math.asin(this.#g(e[0])),ATAN:()=>Math.atan(this.#g(e[0])),ACOT:()=>{const t=Number(this.#g(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");return 0===t?Math.PI/2:Math.atan(1/t)+(t<0?Math.PI:0)},ATAN2:()=>Math.atan2(this.#g(e[0]),this.#g(e[1])),COS:()=>Math.cos(this.#g(e[0])),CEILING:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);return Math.ceil(t/n)*n},ODD:()=>{const t=Math.ceil(this.#g(e[0]));return t%2==0?t+1:t},EVEN:()=>{const t=Math.ceil(this.#g(e[0]));return t%2==0?t:t+1},FLOOR:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);return Math.floor(t/n)*n},LN:()=>Math.log(this.#g(e[0])),SIN:()=>Math.sin(this.#g(e[0])),TAN:()=>Math.tan(this.#g(e[0])),SIGN:()=>{const t=this.#g(e[0]);return t>0?1:t<0?-1:0},GCD:()=>{const t=this.#m(e),n=(t,e)=>0===e?t:n(e,t%e);return t.reduce((t,e)=>n(t,e))},LCM:()=>{const t=this.#m(e),n=(t,e)=>0===e?t:n(e,t%e);return t.reduce((t,e)=>{return i=t,r=e,Math.abs(i*r)/n(i,r);var i,r})},PRODUCT:()=>this.#m(e).reduce((t,e)=>t*e,1),MOD:()=>this.#g(e[0])%this.#g(e[1]),QUOTIENT:()=>Math.floor(this.#g(e[0])/this.#g(e[1])),INT:()=>Math.floor(this.#g(e[0])),MROUND:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);return Math.round(t/n)*n},ROUNDDOWN:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=Math.pow(10,n);return Math.floor(t*i)/i},ROUNDUP:()=>{const t=this.#g(e[0]),n=this.#g(e[1]),i=Math.pow(10,n);return Math.ceil(t*i)/i},TRUNC:()=>{const t=this.#g(e[0]),n=this.#g(e[1])??0,i=Math.pow(10,n);return Math.trunc(t*i)/i},EXP:()=>Math.exp(this.#g(e[0])),LOG:()=>{const t=this.#g(e[0]),n=this.#g(e[1])??10;return Math.log(t)/Math.log(n)},LOG10:()=>Math.log10(this.#g(e[0])),SUMPRODUCT:()=>{let t=e.map(t=>xE(this.#g(t)));if(0===t.length)return 0;let n=1,i=1;for(const e of t){const[t,r]=yE(e);n=Math.max(n,t),i=Math.max(i,r)}t=t.map(t=>wE(t,n,i));let r=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++){let i=1;for(const r of t)i*=CE(r[e][n]);r+=i}return r},SUMSQ:()=>this.#m(e).reduce((t,e)=>t+Math.pow(e,2),0),SUMX2MY2:()=>{if(e.length<2)throw new Error("#VALUE!");const t=this.#m([e[0]]).filter(t=>"number"==typeof t&&Number.isFinite(t)),n=this.#m([e[1]]).filter(t=>"number"==typeof t&&Number.isFinite(t));if(t.length!==n.length)throw new Error("#VALUE!");return t.reduce((t,e,i)=>t+Math.pow(e,2)-Math.pow(n[i],2),0)},SUMX2PY2:()=>{if(e.length<2)throw new Error("#VALUE!");const t=this.#m([e[0]]).filter(t=>"number"==typeof t&&Number.isFinite(t)),n=this.#m([e[1]]).filter(t=>"number"==typeof t&&Number.isFinite(t));if(t.length!==n.length)throw new Error("#VALUE!");return t.reduce((t,e,i)=>t+Math.pow(e,2)+Math.pow(n[i],2),0)},SUMXMY2:()=>{if(e.length<2)throw new Error("#VALUE!");const t=this.#m([e[0]]).filter(t=>"number"==typeof t&&Number.isFinite(t)),n=this.#m([e[1]]).filter(t=>"number"==typeof t&&Number.isFinite(t));if(t.length!==n.length)throw new Error("#VALUE!");return t.reduce((t,e,i)=>t+Math.pow(e-n[i],2),0)},SERIESSUM:()=>{if(e.length<4)throw new Error("#VALUE!");const t=this.#g(e[0]),n=this.#g(e[1]),i=this.#g(e[2]),r=this.#p([e[3]]).map(t=>Number(t)).filter(t=>Number.isFinite(t));if(!r.length)throw new Error("#VALUE!");return r.reduce((e,r,o)=>e+r*Math.pow(t,n+o*i),0)},SQRTPI:()=>Math.sqrt(Math.PI*this.#g(e[0])),DEGREES:()=>this.#g(e[0])*(180/Math.PI),RADIANS:()=>this.#g(e[0])*(Math.PI/180),COSH:()=>Math.cosh(this.#g(e[0])),ACOSH:()=>Math.acosh(this.#g(e[0])),SINH:()=>Math.sinh(this.#g(e[0])),ASINH:()=>Math.asinh(this.#g(e[0])),TANH:()=>Math.tanh(this.#g(e[0])),ATANH:()=>Math.atanh(this.#g(e[0])),ACOTH:()=>{const t=Number(this.#g(e[0]));if(!Number.isFinite(t))throw new Error("#VALUE!");if(Math.abs(t)<=1)throw new Error("#NUM!");return.5*Math.log((t+1)/(t-1))},MDETERM:()=>{const t=this.#g(e[0]);if(!Array.isArray(t)||t.length!==t[0].length)throw new Error("#VALUE!");const n=t=>1===t.length?t[0][0]:t.reduce((e,i,r)=>e+(r%2?-1:1)*i[0]*n(t.slice(1).map(t=>t.slice(1))),0);return n(t)},MINVERSE:()=>{const t=this.#g(e[0]);if(!Array.isArray(t)||t.length!==t[0].length)throw new Error("#VALUE!");const n=t.length,i=Array.from({length:n},(t,e)=>Array.from({length:n},(t,n)=>e===n?1:0)),r=t.map((t,e)=>[...t,...i[e]]);for(let e=0;e<n;e++){let t=r[e][e];if(0===t)throw new Error("#DIV/0!");for(let i=0;i<2*n;i++)r[e][i]/=t;for(let i=0;i<n;i++)if(i!==e){t=r[i][e];for(let o=0;o<2*n;o++)r[i][o]-=t*r[e][o]}}return r.map(t=>t.slice(n))},MMULT:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);if(!Array.isArray(t)||!Array.isArray(n)||t[0].length!==n.length)throw new Error("#VALUE!");return t.map(t=>n[0].map((e,i)=>t.reduce((t,e,r)=>t+e*n[r][i],0)))},FACT:()=>{const t=this.#g(e[0]);if(t<0||!Number.isInteger(t))throw new Error("#NUM!");return 0===t?1:Array.from({length:t},(t,e)=>e+1).reduce((t,e)=>t*e,1)},FACTDOUBLE:()=>{const t=this.#g(e[0]);if(t<0||!Number.isInteger(t))throw new Error("#NUM!");let n=1;for(let e=t;e>0;e-=2)n*=e;return n},RAND:()=>Math.random(),RANDBETWEEN:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);return Math.floor(Math.random()*(n-t+1))+t},ROMAN:()=>{const t=this.#g(e[0]);if(t<=0||t>3999||!Number.isInteger(t))throw new Error("#VALUE!");const n=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];let i="",r=t;for(const[e,o]of n)for(;r>=e;)i+=o,r-=e;return i},ARABIC:()=>{const t=String(this.#g(e[0])??"").toUpperCase().replace(/\s+/g,"");if(!t)throw new Error("#VALUE!");if(!/^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/.test(t))throw new Error("#VALUE!");const n={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3};let i=0;for(let e=0;e<t.length;e++){const r=n[t[e]];i+=r<(n[t[e+1]]||0)?-r:r}return i},CEILING_PRECISE:()=>{const t=this.#g(e[0]),n=Math.abs(this.#g(e[1])||1);return Math.ceil(t/n)*n},ISO_CEILING:()=>{const t=this.#g(e[0]),n=Math.abs(this.#g(e[1])||1);return Math.ceil(t/n)*n},FLOOR_PRECISE:()=>{const t=this.#g(e[0]),n=Math.abs(this.#g(e[1])||1);return Math.floor(t/n)*n},MUNIT:()=>{const t=this.#g(e[0]);if(t<=0||!Number.isInteger(t))throw new Error("#VALUE!");return Array(t).fill(null).map((e,n)=>Array(t).fill(0).map((t,e)=>n===e?1:0))},IFERROR:()=>{try{const t=this.#g(e[0]);return t instanceof Error||"string"==typeof t&&t.startsWith("#")?this.#g(e[1]):t}catch{return this.#g(e[1])}},IFNA:()=>{try{const t=this.#g(e[0]);return"#N/A"===t||t instanceof Error&&"#N/A"===t.message?this.#g(e[1]):t}catch{return this.#g(e[1])}},TRUE:()=>!0,FALSE:()=>!1,DATE:()=>{this.Mg=!0;const t=this.#g(e[0]),n=this.#g(e[1])-1,i=this.#g(e[2]);return h(new Date(t,n,i))},TIME:()=>(this.Mg=!0,(3600*this.#g(e[0])+60*this.#g(e[1])+this.#g(e[2]))/86400),DATEVALUE:()=>{this.Mg=!0;const t=this.#g(e[0]),n=new Date(t);return n.setHours(0,0,0,0),h(n)},TIMEVALUE:()=>{const t=this.#g(e[0]),[n,i,r]=t.split(":").map(Number);return 3600*n+60*i+(r||0)},HOUR:()=>this.#u(this.#g(e[0])).getHours(),MINUTE:()=>this.#u(this.#g(e[0])).getMinutes(),SECOND:()=>this.#u(this.#g(e[0])).getSeconds(),WEEKNUM:()=>{const t=this.#u(this.#g(e[0])),n=new Date(t.getFullYear(),0,1),i=(t-n)/864e5+1;return Math.ceil(i/7)},WEEKDAY:()=>this.#u(this.#g(e[0])).getDay()+1,EDATE:()=>{this.Mg=!0;const t=this.#u(this.#g(e[0])),n=this.#g(e[1]);return t.setMonth(t.getMonth()+n),h(t)},EOMONTH:()=>{this.Mg=!0;const t=this.#u(this.#g(e[0])),n=this.#g(e[1]);return t.setMonth(t.getMonth()+n+1),t.setDate(0),h(t)},WORKDAY:()=>{this.Mg=!0;const t=this.#u(this.#g(e[0]));let n=this.#g(e[1]),i=new Date(t);for(;n>0;){i.setDate(i.getDate()+1);const t=i.getDay();0!==t&&6!==t&&n--}return h(i)},WORKDAY_INTL:()=>{this.Mg=!0;const t=this.#u(this.#g(e[0]));let n=this.#g(e[1]);const i=this.#g(e[2])||"0000011";let r=new Date(t);for(;n>0;)r.setDate(r.getDate()+1),"0"===i[r.getDay()]&&n--;return h(r)},DAYS360:()=>{const t=this.#u(this.#g(e[0])),n=this.#u(this.#g(e[1])),i=Math.min(t.getDate(),30),r=Math.min(n.getDate(),30);return 360*(n.getFullYear()-t.getFullYear())+30*(n.getMonth()-t.getMonth())+(r-i)},NETWORKDAYS:()=>{const t=this.#u(this.#g(e[0])),n=this.#u(this.#g(e[1])),i=e.slice(2).map(t=>this.#u(this.#g(t)));let r=0;for(let e=new Date(t);e<=n;e.setDate(e.getDate()+1)){const t=e.getDay();0===t||6===t||i.some(t=>t.getTime()===e.getTime())||r++}return r},NETWORKDAYS_INTL:()=>{const t=this.#u(this.#g(e[0])),n=this.#u(this.#g(e[1])),i=this.#g(e[2])||"0000011",r=e.slice(3).map(t=>this.#u(this.#g(t)));let o=0;for(let e=new Date(t);e<=n;e.setDate(e.getDate()+1))"0"!==i[e.getDay()]||r.some(t=>t.getTime()===e.getTime())||o++;return o},YEARFRAC:()=>{const t=this.#u(this.#g(e[0])),n=this.#u(this.#g(e[1])),i=t.getFullYear()%4==0&&t.getFullYear()%100!=0||t.getFullYear()%400==0?366:365;return(n-t)/864e5/i},DATEDIF:()=>{const t=this.#u(this.#g(e[0])),n=this.#u(this.#g(e[1])),i=n-t;switch(String(this.#g(e[2])).toUpperCase()){case"Y":return n.getFullYear()-t.getFullYear();case"M":return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth());case"D":return Math.floor(i/864e5);case"YM":return(n.getMonth()-t.getMonth()+12)%12;case"YD":{const e=new Date(t);return e.setFullYear(n.getFullYear()),e>n&&e.setFullYear(n.getFullYear()-1),Math.floor((n-e)/864e5)}case"MD":{let e=n.getDate()-t.getDate();return e<0&&(e+=new Date(n.getFullYear(),n.getMonth(),0).getDate()),e}default:throw new Error("#VALUE! Invalid unit for DATEDIF.")}},CLEAN:()=>String(this.#g(e[0])).replace(/[\x00-\x1F\x7F]/g,""),DOLLAR:()=>{const t=this.#g(e[0]),n=this.#g(e[1])||2;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:n}).format(t)},FIXED:()=>{const t=this.#g(e[0]),n=this.#g(e[1])||2,i=this.#g(e[2])||!1,r=t.toFixed(n);return i?r.replace(/,/g,""):r},TEXT:()=>{let t=this.#g(e[0]);const n=this.#g(e[1]);return t instanceof Date&&(t=u(t)),"number"==typeof t||"string"==typeof t?function(t,e){const n=a(t,e);return"object"==typeof n?n.text:n}(t,n):String(t??"")},VALUE:()=>{const t=this.#g(e[0]),n=parseFloat(t);return isNaN(n)?null:n},PROPER:()=>String(this.#g(e[0])).toLowerCase().replace(/\b\w/g,t=>t.toUpperCase()),CHAR:()=>String.fromCharCode(this.#g(e[0])),CODE:()=>String(this.#g(e[0])).charCodeAt(0),REPLACE:()=>{const t=String(this.#g(e[0])),n=this.#g(e[1])-1,i=this.#g(e[2]),r=String(this.#g(e[3]));return t.slice(0,n)+r+t.slice(n+i)},SUBSTITUTE:()=>{const t=String(this.#g(e[0])),n=String(this.#g(e[1])),i=String(this.#g(e[2])),r=this.#g(e[3])??0;if(0===r)return t.split(n).join(i);let o=0;return t.replace(new RegExp(n,"g"),t=>(o+=1,o===r?i:t))},REPT:()=>String(this.#g(e[0])).repeat(this.#g(e[1])),FIND:()=>{const t=String(this.#g(e[0])),n=String(this.#g(e[1])),i=this.#g(e[2])?this.#g(e[2])-1:0,r=n.indexOf(t,i);return r>=0?r+1:null},SEARCH:()=>{const t=String(this.#g(e[0])),n=String(this.#g(e[1])),i=this.#g(e[2])??1;return n.indexOf(t,i-1)+1||null},EXACT:()=>String(this.#g(e[0]))===String(this.#g(e[1])),T:()=>{const t=this.#g(e[0]);return"string"==typeof t?t:""},ISERROR:()=>{try{return this.#g(e[0]),!1}catch{return!0}},ISERR:()=>{const t=this.executeFunction("ERROR_TYPE",[e[0]]);return 7!==t&&null!==t},ISNA:()=>7===this.executeFunction("ERROR_TYPE",[e[0]]),ERROR_TYPE:()=>{const t={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},n=this.#g(e[0]);if(n instanceof Error)return t[n.message]||null;if("string"==typeof n&&n.startsWith("#"))return t[n]||null;try{return this.#g(e[0]),null}catch(e){return t[e.message]||null}},ISNUMBER:()=>"number"==typeof this.#g(e[0]),ISEVEN:()=>{const t=this.#g(e[0]);return"number"==typeof t&&t%2==0},ISODD:()=>{const t=this.#g(e[0]);return"number"==typeof t&&t%2!=0},N:()=>{const t=this.#g(e[0]);return"number"==typeof t?t:0},ISBLANK:()=>null===this.#g(e[0])||""===this.#g(e[0]),ISLOGICAL:()=>"boolean"==typeof this.#g(e[0]),ISTEXT:()=>"string"==typeof this.#g(e[0]),ISNONTEXT:()=>"string"!=typeof this.#g(e[0])&&null!=this.#g(e[0]),ISREF:()=>Array.isArray(this.#g(e[0])),TYPE:()=>{const t=this.#g(e[0]);return null==t||"number"==typeof t?1:"string"==typeof t?2:"boolean"==typeof t?4:Array.isArray(t)?16:64},NA:()=>{throw new Error("#N/A")},BIN2DEC:()=>{const t=this.#g(e[0]);return parseInt(t,2)},BIN2HEX:()=>parseInt(this.#g(e[0]),2).toString(16).toUpperCase(),BIN2OCT:()=>parseInt(this.#g(e[0]),2).toString(8),DEC2BIN:()=>parseInt(this.#g(e[0]),10).toString(2),DEC2HEX:()=>parseInt(this.#g(e[0]),10).toString(16).toUpperCase(),DEC2OCT:()=>parseInt(this.#g(e[0]),10).toString(8),HEX2BIN:()=>parseInt(this.#g(e[0]),16).toString(2),HEX2DEC:()=>parseInt(this.#g(e[0]),16).toString(10),HEX2OCT:()=>parseInt(this.#g(e[0]),16).toString(8),OCT2BIN:()=>parseInt(this.#g(e[0]),8).toString(2),OCT2DEC:()=>parseInt(this.#g(e[0]),8).toString(10),OCT2HEX:()=>parseInt(this.#g(e[0]),8).toString(16).toUpperCase(),ERF:()=>(t=>{const e=1/(1+.5*Math.abs(t)),n=e*Math.exp(-t*t-1.26551223+e*(1.00002368+e*(.37409196+e*(.09678418+e*(e*(.27886807+e*(e*(1.48851587+e*(.17087277*e-.82215223))-1.13520398))-.18628806)))));return t>=0?1-n:n-1})(this.#g(e[0])),ERFC:()=>{const t=this.#g(e[0]),n=1/(1+.5*Math.abs(t)),i=n*Math.exp(-t*t-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(n*(.27886807+n*(n*(1.48851587+n*(.17087277*n-.82215223))-1.13520398))-.18628806)))));return t>=0?i:2-i},ERFC_PRECISE:()=>{const t=this.#g(e[0]),n=1/(1+.5*Math.abs(t)),i=n*Math.exp(-t*t-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(n*(.27886807+n*(n*(1.48851587+n*(.17087277*n-.82215223))-1.13520398))-.18628806)))));return t>=0?i:2-i},DELTA:()=>this.#g(e[0])===this.#g(e[1])?1:0,GESTEP:()=>this.#g(e[0])>=(this.#g(e[1])||0)?1:0,COMPLEX:()=>{const t=this.#g(e[0]),n=this.#g(e[1]);return`${t}${n>=0?"+":""}${n}${this.#g(e[2])||"i"}`},IMABS:()=>{const t=this.#g(e[0]),[n,i]=t.split(/(?=[+-])/).map(Number);return Math.sqrt(n*n+i*i)},IMAGINARY:()=>{const t=this.#g(e[0]);return parseFloat(t.split(/(?=[+-])/)[1])||0},IMARGUMENT:()=>{const t=this.#g(e[0]),[n,i]=t.split(/(?=[+-])/).map(Number);return Math.atan2(i,n)},IMCONJUGATE:()=>{const t=this.#g(e[0]),[n,i]=t.split(/(?=[+-])/).map(Number);return`${n}${i>=0?"-":"+"}${Math.abs(i)}i`},IMCOS:()=>{const t=this.#g(e[0]),[n,i]=t.split(/(?=[+-])/).map(Number);return`${Math.cos(n)*Math.cosh(i)}${-Math.sin(n)*Math.sinh(i)}i`},IMDIV:()=>{const[t,n]=[this.#g(e[0]),this.#g(e[1])].map(t=>t.split(/(?=[+-])/).map(Number)),[i,r,o,a]=[t[0],t[1],n[0],n[1]],s=o*o+a*a;return`${(i*o+r*a)/s}${(r*o-i*a)/s>=0?"+":""}${(r*o-i*a)/s}i`},IMEXP:()=>{const t=math.complex(this.#g(e[0]));return math.exp(t).toString()},IMLN:()=>{const t=math.complex(this.#g(e[0]));return math.log(t).toString()},IMLOG10:()=>{const t=math.complex(this.#g(e[0]));return math.log10(t).toString()},IMLOG2:()=>{const t=math.complex(this.#g(e[0]));return math.log2(t).toString()},IMREAL:()=>math.complex(this.#g(e[0])).re,IMSIN:()=>{const t=math.complex(this.#g(e[0]));return math.sin(t).toString()},IMSQRT:()=>{const t=math.complex(this.#g(e[0]));return math.sqrt(t).toString()},IMSUB:()=>{const t=math.complex(this.#g(e[0])),n=math.complex(this.#g(e[1]));return math.subtract(t,n).toString()},IMPOWER:()=>{const t=math.complex(this.#g(e[0])),n=this.#g(e[1]);return math.pow(t,n).toString()},IMPRODUCT:()=>this.#p(e).map(t=>math.complex(t)).reduce((t,e)=>math.multiply(t,e),math.complex(1)).toString(),IMSUM:()=>this.#p(e).map(t=>math.complex(t)).reduce((t,e)=>math.add(t,e),math.complex(0)).toString(),"RANK.AVG":()=>{const t=this.#g(e[0]),n=this.#m(e[1]),i=n.filter(e=>e<t).length+1,r=n.filter(e=>e===t).length;return i+(r-1)/2},COUNTIF:()=>{const t=this.#p([e[0]]),n=this.#g(e[1]),i=(()=>{if("number"==typeof n)return t=>t===n;if("string"==typeof n){const t=n.replace(/([.+^=!:${}()|[\]\\])/g,"\\$1").replace(/\*/g,".*").replace(/\?/g,".");if(/[*?]/.test(n)){const e=new RegExp("^"+t+"$","i");return t=>{if(t instanceof Error||"string"==typeof t&&t.startsWith("#"))throw new Error("#REF!");return"string"==typeof t&&e.test(t)}}const e=n.match(/^([<>=!]=?|<>)(.*)$/);if(e){let[,t,n]=e;"<>"===t&&(t="!=");const i=parseFloat(n),r=!isNaN(i);return e=>{if(e instanceof Error||"string"==typeof e&&e.startsWith("#"))throw new Error("#REF!");const o=r?parseFloat(e):String(e);switch(t){case">":return o>i;case">=":return o>=i;case"<":return o<i;case"<=":return o<=i;case"=":return o==n;case"!=":return o!=n;default:return!1}}}return t=>{if(t instanceof Error||"string"==typeof t&&t.startsWith("#"))throw new Error("#REF!");return String(t).toLowerCase()===n.toLowerCase()}}return t=>{if(t instanceof Error||"string"==typeof t&&t.startsWith("#"))throw new Error("#REF!");return t==n}})();let r=0;const o=Array.isArray(t[0])?t:[t];for(const e of o)for(const t of e){if(t instanceof Error||"string"==typeof t&&t.startsWith("#"))throw new Error("#REF!");i(t)&&r++}return r}},T=C[t];if("function"!=typeof T)throw new Error("#NAME?");return T()}}const ME={"[Content_Types].xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Types":{"Default":[{"_$Extension":"rels","_$ContentType":"application/vnd.openxmlformats-package.relationships+xml"},{"_$Extension":"xml","_$ContentType":"application/xml"}],"Override":[{"_$PartName":"/xl/workbook.xml","_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"},{"_$PartName":"/xl/worksheets/sheet1.xml","_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"},{"_$PartName":"/xl/theme/theme1.xml","_$ContentType":"application/vnd.openxmlformats-officedocument.theme+xml"},{"_$PartName":"/xl/styles.xml","_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"},{"_$PartName":"/docProps/core.xml","_$ContentType":"application/vnd.openxmlformats-package.core-properties+xml"},{"_$PartName":"/docProps/app.xml","_$ContentType":"application/vnd.openxmlformats-officedocument.extended-properties+xml"}],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/content-types"}},"Cg":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":[{"_$Id":"rId3","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","_$Target":"docProps/app.xml"},{"_$Id":"rId2","_$Type":"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","_$Target":"docProps/core.xml"},{"_$Id":"rId1","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","_$Target":"xl/workbook.xml"}],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}},"xl/workbook.xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"workbook":{"fileVersion":{"_$appName":"xl","_$lastEdited":"7","_$lowestEdited":"5","_$rupBuild":"28025"},"workbookPr":"","mc:AlternateContent":{"mc:Choice":{"x15ac:absPath":{"_$url":"C:\\Users\\29486\\Desktop\\EEEEE\\","_$xmlns:x15ac":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/ac"},"_$Requires":"x15"},"_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006"},"xr:revisionPtr":{"_$revIDLastSave":"0","_$documentId":"13_ncr:1_{A2D52201-FDF6-42D3-934A-EE0E0EC50B54}","_$xr6:coauthVersionLast":"47","_$xr6:coauthVersionMax":"47","_$xr10:uidLastSave":"{00000000-0000-0000-0000-000000000000}"},"bookViews":{"workbookView":{"_$xWindow":"-98","_$yWindow":"-98","_$windowWidth":"24196","_$windowHeight":"14476","_$xr2:uid":"{00000000-000D-0000-FFFF-FFFF00000000}","_$activeTab":0}},"sheets":{"sheet":[{"_$name":"Sheet1","_$sheetId":"1","_$r:id":"rId1"}]},"calcPr":{"_$calcId":"144525"},"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","_$mc:Ignorable":"x15 xr xr6 xr10 xr2","_$xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main","_$xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","_$xmlns:xr6":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision6","_$xmlns:xr10":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision10","_$xmlns:xr2":"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2"}},"xl/_rels/workbook.xml.rels":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":[{"_$Id":"rId3","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","_$Target":"styles.xml"},{"_$Id":"rId2","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme","_$Target":"theme/theme1.xml"},{"_$Id":"rId1","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","_$Target":"worksheets/sheet1.xml"}],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}},"xl/worksheets/sheet1.xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"worksheet":{"dimension":{"_$ref":"A1:Z200"},"sheetViews":{"sheetView":[{"_$tabSelected":"0","_$workbookViewId":"0"}]},"sheetFormatPr":{"_$defaultColWidth":"9.5","_$defaultRowHeight":"15","_$x14ac:dyDescent":"0.3"},"sheetData":"","phoneticPr":{"_$fontId":"1","_$type":"noConversion"},"pageMargins":{"_$left":"0.7","_$right":"0.7","_$top":"0.75","_$bottom":"0.75","_$header":"0.3","_$footer":"0.3"},"pageSetup":{"_$paperSize":"9","_$orientation":"portrait"},"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","_$mc:Ignorable":"x14ac xr xr2 xr3","_$xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","_$xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","_$xmlns:xr2":"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2","_$xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"}},"xl/theme/theme1.xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"a:theme":{"a:themeElements":{"a:clrScheme":{"a:dk1":{"a:sysClr":{"_$val":"windowText","_$lastClr":"000000"}},"a:lt1":{"a:sysClr":{"_$val":"window","_$lastClr":"FFFFFF"}},"a:dk2":{"a:srgbClr":{"_$val":"44546A"}},"a:lt2":{"a:srgbClr":{"_$val":"E7E6E6"}},"a:accent1":{"a:srgbClr":{"_$val":"4874CB"}},"a:accent2":{"a:srgbClr":{"_$val":"EE822F"}},"a:accent3":{"a:srgbClr":{"_$val":"F2BA02"}},"a:accent4":{"a:srgbClr":{"_$val":"75BD42"}},"a:accent5":{"a:srgbClr":{"_$val":"30C0B4"}},"a:accent6":{"a:srgbClr":{"_$val":"E54C5E"}},"a:hlink":{"a:srgbClr":{"_$val":"0026E5"}},"a:folHlink":{"a:srgbClr":{"_$val":"7E1FAD"}},"_$name":"WPS"},"a:fontScheme":{"a:majorFont":{"a:latin":{"_$typeface":"Calibri Light"},"a:ea":{"_$typeface":""},"a:cs":{"_$typeface":""},"a:font":[{"_$script":"Jpan","_$typeface":"ＭＳ Ｐゴシック"},{"_$script":"Hang","_$typeface":"맑은 고딕"},{"_$script":"Hans","_$typeface":"宋体"},{"_$script":"Hant","_$typeface":"新細明體"},{"_$script":"Arab","_$typeface":"Times New Roman"},{"_$script":"Hebr","_$typeface":"Times New Roman"},{"_$script":"Thai","_$typeface":"Tahoma"},{"_$script":"Ethi","_$typeface":"Nyala"},{"_$script":"Beng","_$typeface":"Vrinda"},{"_$script":"Gujr","_$typeface":"Shruti"},{"_$script":"Khmr","_$typeface":"MoolBoran"},{"_$script":"Knda","_$typeface":"Tunga"},{"_$script":"Guru","_$typeface":"Raavi"},{"_$script":"Cans","_$typeface":"Euphemia"},{"_$script":"Cher","_$typeface":"Plantagenet Cherokee"},{"_$script":"Yiii","_$typeface":"Microsoft Yi Baiti"},{"_$script":"Tibt","_$typeface":"Microsoft Himalaya"},{"_$script":"Thaa","_$typeface":"MV Boli"},{"_$script":"Deva","_$typeface":"Mangal"},{"_$script":"Telu","_$typeface":"Gautami"},{"_$script":"Taml","_$typeface":"Latha"},{"_$script":"Syrc","_$typeface":"Estrangelo Edessa"},{"_$script":"Orya","_$typeface":"Kalinga"},{"_$script":"Mlym","_$typeface":"Kartika"},{"_$script":"Laoo","_$typeface":"DokChampa"},{"_$script":"Sinh","_$typeface":"Iskoola Pota"},{"_$script":"Mong","_$typeface":"Mongolian Baiti"},{"_$script":"Viet","_$typeface":"Times New Roman"},{"_$script":"Uigh","_$typeface":"Microsoft Uighur"},{"_$script":"Geor","_$typeface":"Sylfaen"}]},"a:minorFont":{"a:latin":{"_$typeface":"Calibri"},"a:ea":{"_$typeface":""},"a:cs":{"_$typeface":""},"a:font":[{"_$script":"Jpan","_$typeface":"ＭＳ Ｐゴシック"},{"_$script":"Hang","_$typeface":"맑은 고딕"},{"_$script":"Hans","_$typeface":"宋体"},{"_$script":"Hant","_$typeface":"新細明體"},{"_$script":"Arab","_$typeface":"Arial"},{"_$script":"Hebr","_$typeface":"Arial"},{"_$script":"Thai","_$typeface":"Tahoma"},{"_$script":"Ethi","_$typeface":"Nyala"},{"_$script":"Beng","_$typeface":"Vrinda"},{"_$script":"Gujr","_$typeface":"Shruti"},{"_$script":"Khmr","_$typeface":"DaunPenh"},{"_$script":"Knda","_$typeface":"Tunga"},{"_$script":"Guru","_$typeface":"Raavi"},{"_$script":"Cans","_$typeface":"Euphemia"},{"_$script":"Cher","_$typeface":"Plantagenet Cherokee"},{"_$script":"Yiii","_$typeface":"Microsoft Yi Baiti"},{"_$script":"Tibt","_$typeface":"Microsoft Himalaya"},{"_$script":"Thaa","_$typeface":"MV Boli"},{"_$script":"Deva","_$typeface":"Mangal"},{"_$script":"Telu","_$typeface":"Gautami"},{"_$script":"Taml","_$typeface":"Latha"},{"_$script":"Syrc","_$typeface":"Estrangelo Edessa"},{"_$script":"Orya","_$typeface":"Kalinga"},{"_$script":"Mlym","_$typeface":"Kartika"},{"_$script":"Laoo","_$typeface":"DokChampa"},{"_$script":"Sinh","_$typeface":"Iskoola Pota"},{"_$script":"Mong","_$typeface":"Mongolian Baiti"},{"_$script":"Viet","_$typeface":"Arial"},{"_$script":"Uigh","_$typeface":"Microsoft Uighur"},{"_$script":"Geor","_$typeface":"Sylfaen"}]},"_$name":"WPS"},"a:fmtScheme":{"a:fillStyleLst":{"a:solidFill":{"a:schemeClr":{"_$val":"phClr"}},"a:gradFill":[{"a:gsLst":{"a:gs":[{"a:schemeClr":{"a:lumOff":{"_$val":"17500"},"_$val":"phClr"},"_$pos":"0"},{"a:schemeClr":{"_$val":"phClr"},"_$pos":"100000"}]},"a:lin":{"_$ang":"2700000","_$scaled":"0"}},{"a:gsLst":{"a:gs":[{"a:schemeClr":{"a:hueOff":{"_$val":"-2520000"},"_$val":"phClr"},"_$pos":"0"},{"a:schemeClr":{"_$val":"phClr"},"_$pos":"100000"}]},"a:lin":{"_$ang":"2700000","_$scaled":"0"}}]},"a:lnStyleLst":{"a:ln":[{"a:solidFill":{"a:schemeClr":{"_$val":"phClr"}},"a:prstDash":{"_$val":"solid"},"a:miter":{"_$lim":"800000"},"_$w":"12700","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"},{"a:solidFill":{"a:schemeClr":{"_$val":"phClr"}},"a:prstDash":{"_$val":"solid"},"a:miter":{"_$lim":"800000"},"_$w":"12700","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"},{"a:gradFill":{"a:gsLst":{"a:gs":[{"a:schemeClr":{"a:hueOff":{"_$val":"-4200000"},"_$val":"phClr"},"_$pos":"0"},{"a:schemeClr":{"_$val":"phClr"},"_$pos":"100000"}]},"a:lin":{"_$ang":"2700000","_$scaled":"1"}},"a:prstDash":{"_$val":"solid"},"a:miter":{"_$lim":"800000"},"_$w":"12700","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"}]},"a:effectStyleLst":{"a:effectStyle":[{"a:effectLst":{"a:outerShdw":{"a:schemeClr":{"a:alpha":{"_$val":"60000"},"_$val":"phClr"},"_$blurRad":"101600","_$dist":"50800","_$dir":"5400000","_$algn":"ctr","_$rotWithShape":"0"}}},{"a:effectLst":{"a:reflection":{"_$stA":"50000","_$endA":"300","_$endPos":"40000","_$dist":"25400","_$dir":"5400000","_$sy":"-100000","_$algn":"bl","_$rotWithShape":"0"}}},{"a:effectLst":{"a:outerShdw":{"a:srgbClr":{"a:alpha":{"_$val":"63000"},"_$val":"000000"},"_$blurRad":"57150","_$dist":"19050","_$dir":"5400000","_$algn":"ctr","_$rotWithShape":"0"}}}]},"a:bgFillStyleLst":{"a:solidFill":[{"a:schemeClr":{"_$val":"phClr"}},{"a:schemeClr":{"a:tint":{"_$val":"95000"},"a:satMod":{"_$val":"170000"},"_$val":"phClr"}}],"a:gradFill":{"a:gsLst":{"a:gs":[{"a:schemeClr":{"a:tint":{"_$val":"93000"},"a:satMod":{"_$val":"150000"},"a:shade":{"_$val":"98000"},"a:lumMod":{"_$val":"102000"},"_$val":"phClr"},"_$pos":"0"},{"a:schemeClr":{"a:tint":{"_$val":"98000"},"a:satMod":{"_$val":"130000"},"a:shade":{"_$val":"90000"},"a:lumMod":{"_$val":"103000"},"_$val":"phClr"},"_$pos":"50000"},{"a:schemeClr":{"a:shade":{"_$val":"63000"},"a:satMod":{"_$val":"120000"},"_$val":"phClr"},"_$pos":"100000"}]},"a:lin":{"_$ang":"5400000","_$scaled":"0"},"_$rotWithShape":"1"}},"_$name":"WPS"}},"a:objectDefaults":"","a:extraClrSchemeLst":"","_$xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","_$name":"WPS"}},"xl/styles.xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"styleSheet":{"numFmts":{"numFmt":[],"_$count":"0"},"fonts":{"font":[{"sz":{"_$val":"11"},"color":{"_$theme":"1"},"name":{"_$val":"宋体"},"charset":{"_$val":"134"},"scheme":{"_$val":"minor"}},{"sz":{"_$val":"9"},"name":{"_$val":"宋体"},"charset":{"_$val":"134"},"scheme":{"_$val":"minor"}}],"_$count":"2","_$x14ac:knownFonts":"1"},"fills":{"fill":[{"patternFill":{"_$patternType":"none"}},{"patternFill":{"_$patternType":"gray125"}}],"_$count":"2"},"borders":{"border":[{"left":"","right":"","top":"","bottom":"","diagonal":""}],"_$count":"1"},"cellStyleXfs":{"xf":{"alignment":{"_$vertical":"center"},"_$numFmtId":"0","_$fontId":"0","_$fillId":"0","_$borderId":"0"},"_$count":"1"},"cellXfs":{"xf":[{"alignment":{"_$vertical":"center"},"_$numFmtId":"0","_$fontId":"0","_$fillId":"0","_$borderId":"0","_$xfId":"0"}],"_$count":"1"},"cellStyles":{"cellStyle":{"_$name":"常规","_$xfId":"0","_$builtinId":"0"},"_$count":"1"},"dxfs":{"_$count":"0"},"tableStyles":{"_$count":"0","_$defaultTableStyle":"TableStyleMedium2","_$defaultPivotStyle":"PivotStyleLight16"},"extLst":{"ext":[{"x14:slicerStyles":{"_$defaultSlicerStyle":"SlicerStyleLight1"},"_$uri":"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","_$xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},{"x15:timelineStyles":{"_$defaultTimelineStyle":"TimeSlicerStyleLight1"},"_$uri":"{9260A510-F301-46a8-8635-F512D64BE5F5}","_$xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"}]},"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","_$mc:Ignorable":"x14ac x16r2 xr","_$xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","_$xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","_$xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},"docProps/core.xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"cp:coreProperties":{"dc:creator":"SheetNext Editer","cp:lastModifiedBy":"SheetNext Editer","dcterms:created":{"#text":"2023-05-12T11:15:00Z","_$xsi:type":"dcterms:W3CDTF"},"dcterms:modified":{"#text":"2024-10-08T09:05:37Z","_$xsi:type":"dcterms:W3CDTF"},"_$xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","_$xmlns:dc":"http://purl.org/dc/elements/1.1/","_$xmlns:dcterms":"http://purl.org/dc/terms/","_$xmlns:dcmitype":"http://purl.org/dc/dcmitype/","_$xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"}},"docProps/app.xml":{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Properties":{"Application":"Microsoft Excel","DocSecurity":"0","ScaleCrop":"false","HeadingPairs":{"vt:vector":{"vt:variant":[{"vt:lpstr":"工作表"},{"vt:i4":"1"}],"_$size":"2","_$baseType":"variant"}},"TitlesOfParts":{"vt:vector":{"vt:lpstr":"Sheet1","_$size":"1","_$baseType":"lpstr"}},"LinksUpToDate":"false","SharedDoc":"false","HyperlinksChanged":"false","AppVersion":"16.0300","_$xmlns":"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","_$xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}}},AE=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",NE=new RegExp("^["+AE+"]["+AE+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$");function kE(t,e){const n=[];let i=e.exec(t);for(;i;){const r=[];r.startIndex=e.lastIndex-i[0].length;const o=i.length;for(let t=0;t<o;t++)r.push(i[t]);n.push(r),i=e.exec(t)}return n}const RE=function(t){return!(null==NE.exec(t))},_E={allowBooleanAttributes:!1,unpairedTags:[]};function IE(t){return" "===t||"\t"===t||"\n"===t||"\r"===t}function FE(t,e){const n=e;for(;e<t.length;e++)if("?"==t[e]||" "==t[e]){const i=t.substr(n,e-n);if(e>5&&"xml"===i)return OE("InvalidXml","XML declaration allowed only at the start of the document.",HE(t,e));if("?"==t[e]&&">"==t[e+1]){e++;break}continue}return e}function EE(t,e){if(t.length>e+5&&"-"===t[e+1]&&"-"===t[e+2]){for(e+=3;e<t.length;e++)if("-"===t[e]&&"-"===t[e+1]&&">"===t[e+2]){e+=2;break}}else if(t.length>e+8&&"D"===t[e+1]&&"O"===t[e+2]&&"C"===t[e+3]&&"T"===t[e+4]&&"Y"===t[e+5]&&"P"===t[e+6]&&"E"===t[e+7]){let n=1;for(e+=8;e<t.length;e++)if("<"===t[e])n++;else if(">"===t[e]&&(n--,0===n))break}else if(t.length>e+9&&"["===t[e+1]&&"C"===t[e+2]&&"D"===t[e+3]&&"A"===t[e+4]&&"T"===t[e+5]&&"A"===t[e+6]&&"["===t[e+7])for(e+=8;e<t.length;e++)if("]"===t[e]&&"]"===t[e+1]&&">"===t[e+2]){e+=2;break}return e}function DE(t,e){let n="",i="",r=!1;for(;e<t.length;e++){if('"'===t[e]||"'"===t[e])""===i?i=t[e]:i!==t[e]||(i="");else if(">"===t[e]&&""===i){r=!0;break}n+=t[e]}return""===i&&{value:n,index:e,tagClosed:r}}const LE=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function PE(t,e){const n=kE(t,LE),i={};for(let r=0;r<n.length;r++){if(0===n[r][1].length)return OE("InvalidAttr","Attribute '"+n[r][2]+"' has no space in starting.",UE(n[r]));if(void 0!==n[r][3]&&void 0===n[r][4])return OE("InvalidAttr","Attribute '"+n[r][2]+"' is without value.",UE(n[r]));if(void 0===n[r][3]&&!e.allowBooleanAttributes)return OE("InvalidAttr","boolean attribute '"+n[r][2]+"' is not allowed.",UE(n[r]));const t=n[r][2];if(!BE(t))return OE("InvalidAttr","Attribute '"+t+"' is an invalid name.",UE(n[r]));if(i.hasOwnProperty(t))return OE("InvalidAttr","Attribute '"+t+"' is repeated.",UE(n[r]));i[t]=1}return!0}function zE(t,e){if(";"===t[++e])return-1;if("#"===t[e])return function(t,e){let n=/\d/;for("x"===t[e]&&(e++,n=/[\da-fA-F]/);e<t.length;e++){if(";"===t[e])return e;if(!t[e].match(n))break}return-1}(t,++e);let n=0;for(;e<t.length;e++,n++)if(!(t[e].match(/\w/)&&n<20)){if(";"===t[e])break;return-1}return e}function OE(t,e,n){return{err:{code:t,msg:e,line:n.line||n,col:n.col}}}function BE(t){return RE(t)}function VE(t){return RE(t)}function HE(t,e){const n=t.substring(0,e).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function UE(t){return t.startIndex+t[1].length}const qE={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,n){return t},captureMetaData:!1};let KE;KE="function"!=typeof Symbol?"@@xmlMetadata":Symbol("XML Node Metadata");class WE{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){"__proto__"===t&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t,e){"__proto__"===t.tagname&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child}),void 0!==e&&(this.child[this.child.length-1][KE]={startIndex:e})}static getMetaDataSymbol(){return KE}}class jE{constructor(t){this.suppressValidationErr=!t}readDocType(t,e){const n={};if("O"!==t[e+3]||"C"!==t[e+4]||"T"!==t[e+5]||"Y"!==t[e+6]||"P"!==t[e+7]||"E"!==t[e+8])throw new Error("Invalid Tag instead of DOCTYPE");{e+=9;let i=1,r=!1,o=!1,a="";for(;e<t.length;e++)if("<"!==t[e]||o)if(">"===t[e]){if(o?"-"===t[e-1]&&"-"===t[e-2]&&(o=!1,i--):i--,0===i)break}else"["===t[e]?r=!0:a+=t[e];else{if(r&&XE(t,"!ENTITY",e)){let i,r;e+=7,[i,r,e]=this.readEntityExp(t,e+1,this.suppressValidationErr),-1===r.indexOf("&")&&(n[i]={regx:RegExp(`&${i};`,"g"),val:r})}else if(r&&XE(t,"!ELEMENT",e)){e+=8;const{index:n}=this.readElementExp(t,e+1);e=n}else if(r&&XE(t,"!ATTLIST",e))e+=8;else if(r&&XE(t,"!NOTATION",e)){e+=9;const{index:n}=this.readNotationExp(t,e+1,this.suppressValidationErr);e=n}else{if(!XE(t,"!--",e))throw new Error("Invalid DOCTYPE");o=!0}i++,a=""}if(0!==i)throw new Error("Unclosed DOCTYPE")}return{entities:n,i:e}}readEntityExp(t,e){e=GE(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e])&&'"'!==t[e]&&"'"!==t[e];)n+=t[e],e++;if(YE(n),e=GE(t,e),!this.suppressValidationErr){if("SYSTEM"===t.substring(e,e+6).toUpperCase())throw new Error("External entities are not supported");if("%"===t[e])throw new Error("Parameter entities are not supported")}let i="";return[e,i]=this.readIdentifierVal(t,e,"entity"),[n,i,--e]}readNotationExp(t,e){e=GE(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e]);)n+=t[e],e++;!this.suppressValidationErr&&YE(n),e=GE(t,e);const i=t.substring(e,e+6).toUpperCase();if(!this.suppressValidationErr&&"SYSTEM"!==i&&"PUBLIC"!==i)throw new Error(`Expected SYSTEM or PUBLIC, found "${i}"`);e+=i.length,e=GE(t,e);let r=null,o=null;if("PUBLIC"===i)[e,r]=this.readIdentifierVal(t,e,"publicIdentifier"),'"'!==t[e=GE(t,e)]&&"'"!==t[e]||([e,o]=this.readIdentifierVal(t,e,"systemIdentifier"));else if("SYSTEM"===i&&([e,o]=this.readIdentifierVal(t,e,"systemIdentifier"),!this.suppressValidationErr&&!o))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:n,publicIdentifier:r,systemIdentifier:o,index:--e}}readIdentifierVal(t,e,n){let i="";const r=t[e];if('"'!==r&&"'"!==r)throw new Error(`Expected quoted string, found "${r}"`);for(e++;e<t.length&&t[e]!==r;)i+=t[e],e++;if(t[e]!==r)throw new Error(`Unterminated ${n} value`);return[++e,i]}readElementExp(t,e){e=GE(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e]);)n+=t[e],e++;if(!this.suppressValidationErr&&!RE(n))throw new Error(`Invalid element name: "${n}"`);let i="";if("E"===t[e=GE(t,e)]&&XE(t,"MPTY",e))e+=4;else if("A"===t[e]&&XE(t,"NY",e))e+=2;else if("("===t[e]){for(e++;e<t.length&&")"!==t[e];)i+=t[e],e++;if(")"!==t[e])throw new Error("Unterminated content model")}else if(!this.suppressValidationErr)throw new Error(`Invalid Element Expression, found "${t[e]}"`);return{elementName:n,contentModel:i.trim(),index:e}}readAttlistExp(t,e){e=GE(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e]);)n+=t[e],e++;YE(n),e=GE(t,e);let i="";for(;e<t.length&&!/\s/.test(t[e]);)i+=t[e],e++;if(!YE(i))throw new Error(`Invalid attribute name: "${i}"`);e=GE(t,e);let r="";if("NOTATION"===t.substring(e,e+8).toUpperCase()){if(r="NOTATION","("!==t[e=GE(t,e+=8)])throw new Error(`Expected '(', found "${t[e]}"`);e++;let n=[];for(;e<t.length&&")"!==t[e];){let i="";for(;e<t.length&&"|"!==t[e]&&")"!==t[e];)i+=t[e],e++;if(i=i.trim(),!YE(i))throw new Error(`Invalid notation name: "${i}"`);n.push(i),"|"===t[e]&&(e++,e=GE(t,e))}if(")"!==t[e])throw new Error("Unterminated list of notations");e++,r+=" ("+n.join("|")+")"}else{for(;e<t.length&&!/\s/.test(t[e]);)r+=t[e],e++;const n=["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"];if(!this.suppressValidationErr&&!n.includes(r.toUpperCase()))throw new Error(`Invalid attribute type: "${r}"`)}e=GE(t,e);let o="";return"#REQUIRED"===t.substring(e,e+8).toUpperCase()?(o="#REQUIRED",e+=8):"#IMPLIED"===t.substring(e,e+7).toUpperCase()?(o="#IMPLIED",e+=7):[e,o]=this.readIdentifierVal(t,e,"ATTLIST"),{elementName:n,attributeName:i,attributeType:r,defaultValue:o,index:e}}}const GE=(t,e)=>{for(;e<t.length&&/\s/.test(t[e]);)e++;return e};function XE(t,e,n){for(let i=0;i<e.length;i++)if(e[i]!==t[n+i+1])return!1;return!0}function YE(t){if(RE(t))return t;throw new Error(`Invalid entity name ${t}`)}const ZE=/^[-+]?0x[a-fA-F0-9]+$/,JE=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,QE={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0},tD=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function eD(t){return"function"==typeof t?t:Array.isArray(t)?e=>{for(const n of t){if("string"==typeof n&&e===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}}:()=>!1}class nD{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={"apos":{regex:/&(apos|#39|#x27);/g,val:"'"},"gt":{regex:/&(gt|#62|#x3E);/g,val:">"},"lt":{regex:/&(lt|#60|#x3C);/g,val:"<"},"quot":{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={"space":{regex:/&(nbsp|#160);/g,val:" "},"cent":{regex:/&(cent|#162);/g,val:"¢"},"pound":{regex:/&(pound|#163);/g,val:"£"},"yen":{regex:/&(yen|#165);/g,val:"¥"},"euro":{regex:/&(euro|#8364);/g,val:"€"},"copyright":{regex:/&(copy|#169);/g,val:"©"},"reg":{regex:/&(reg|#174);/g,val:"®"},"inr":{regex:/&(inr|#8377);/g,val:"₹"},"num_dec":{regex:/&#([0-9]{1,7});/g,val:(t,e)=>String.fromCodePoint(Number.parseInt(e,10))},"num_hex":{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,e)=>String.fromCodePoint(Number.parseInt(e,16))}},this.addExternalEntities=iD,this.parseXml=lD,this.parseTextData=rD,this.resolveNameSpace=oD,this.buildAttributesMap=sD,this.isItStopNode=dD,this.replaceEntitiesValue=hD,this.readStopNodeData=mD,this.saveTextToParentTag=uD,this.addChild=cD,this.ignoreAttributesFn=eD(this.options.ignoreAttributes)}}function iD(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const i=e[n];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:t[i]}}}function rD(t,e,n,i,r,o,a){if(void 0!==t&&(this.options.trimValues&&!i&&(t=t.trim()),t.length>0)){a||(t=this.replaceEntitiesValue(t));const i=this.options.tagValueProcessor(e,t,n,r,o);return null==i?t:typeof i!=typeof t||i!==t?i:this.options.trimValues||t.trim()===t?gD(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function oD(t){if(this.options.removeNSPrefix){const e=t.split(":"),n="/"===t.charAt(0)?"/":"";if("xmlns"===e[0])return"";2===e.length&&(t=n+e[1])}return t}const aD=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function sD(t,e,n){if(!0!==this.options.ignoreAttributes&&"string"==typeof t){const n=kE(t,aD),i=n.length,r={};for(let t=0;t<i;t++){const i=this.resolveNameSpace(n[t][1]);if(this.ignoreAttributesFn(i,e))continue;let o=n[t][4],a=this.options.attributeNamePrefix+i;if(i.length)if(this.options.transformAttributeName&&(a=this.options.transformAttributeName(a)),"__proto__"===a&&(a="#__proto__"),void 0!==o){this.options.trimValues&&(o=o.trim()),o=this.replaceEntitiesValue(o);const t=this.options.attributeValueProcessor(i,o,e);r[a]=null==t?o:typeof t!=typeof o||t!==o?t:gD(o,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(r[a]=!0)}if(!Object.keys(r).length)return;if(this.options.attributesGroupName){const t={};return t[this.options.attributesGroupName]=r,t}return r}}const lD=function(t){t=t.replace(/\r\n?/g,"\n");const e=new WE("!xml");let n=e,i="",r="";const o=new jE(this.options.processEntities);for(let a=0;a<t.length;a++)if("<"===t[a])if("/"===t[a+1]){const e=fD(t,">",a,"Closing Tag is not closed.");let o=t.substring(a+2,e).trim();if(this.options.removeNSPrefix){const t=o.indexOf(":");-1!==t&&(o=o.substr(t+1))}this.options.transformTagName&&(o=this.options.transformTagName(o)),n&&(i=this.saveTextToParentTag(i,n,r));const s=r.substring(r.lastIndexOf(".")+1);if(o&&-1!==this.options.unpairedTags.indexOf(o))throw new Error(`Unpaired tag can not be used as closing tag: </${o}>`);let l=0;s&&-1!==this.options.unpairedTags.indexOf(s)?(l=r.lastIndexOf(".",r.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=r.lastIndexOf("."),r=r.substring(0,l),n=this.tagsNodeStack.pop(),i="",a=e}else if("?"===t[a+1]){let e=pD(t,a,!1,"?>");if(!e)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,n,r),this.options.ignoreDeclaration&&"?xml"===e.tagName||this.options.ignorePiTags);else{const t=new WE(e.tagName);t.add(this.options.textNodeName,""),e.tagName!==e.tagExp&&e.attrExpPresent&&(t[":@"]=this.buildAttributesMap(e.tagExp,r,e.tagName)),this.addChild(n,t,r,a)}a=e.closeIndex+1}else if("!--"===t.substr(a+1,3)){const e=fD(t,"--\x3e",a+4,"Comment is not closed.");if(this.options.commentPropName){const o=t.substring(a+4,e-2);i=this.saveTextToParentTag(i,n,r),n.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}a=e}else if("!D"===t.substr(a+1,2)){const e=o.readDocType(t,a);this.docTypeEntities=e.entities,a=e.i}else if("!["===t.substr(a+1,2)){const e=fD(t,"]]>",a,"CDATA is not closed.")-2,o=t.substring(a+9,e);i=this.saveTextToParentTag(i,n,r);let s=this.parseTextData(o,n.tagname,r,!0,!1,!0,!0);null==s&&(s=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]):n.add(this.options.textNodeName,s),a=e+2}else{let o=pD(t,a,this.options.removeNSPrefix),s=o.tagName;const l=o.rawTagName;let c=o.tagExp,h=o.attrExpPresent,u=o.closeIndex;this.options.transformTagName&&(s=this.options.transformTagName(s)),n&&i&&"!xml"!==n.tagname&&(i=this.saveTextToParentTag(i,n,r,!1));const d=n;d&&-1!==this.options.unpairedTags.indexOf(d.tagname)&&(n=this.tagsNodeStack.pop(),r=r.substring(0,r.lastIndexOf("."))),s!==e.tagname&&(r+=r?"."+s:s);const f=a;if(this.isItStopNode(this.options.stopNodes,r,s)){let e="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)"/"===s[s.length-1]?(s=s.substr(0,s.length-1),r=r.substr(0,r.length-1),c=s):c=c.substr(0,c.length-1),a=o.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(s))a=o.closeIndex;else{const n=this.readStopNodeData(t,l,u+1);if(!n)throw new Error(`Unexpected end of ${l}`);a=n.i,e=n.tagContent}const i=new WE(s);s!==c&&h&&(i[":@"]=this.buildAttributesMap(c,r,s)),e&&(e=this.parseTextData(e,s,r,!0,h,!0,!0)),r=r.substr(0,r.lastIndexOf(".")),i.add(this.options.textNodeName,e),this.addChild(n,i,r,f)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===s[s.length-1]?(s=s.substr(0,s.length-1),r=r.substr(0,r.length-1),c=s):c=c.substr(0,c.length-1),this.options.transformTagName&&(s=this.options.transformTagName(s));const t=new WE(s);s!==c&&h&&(t[":@"]=this.buildAttributesMap(c,r,s)),this.addChild(n,t,r,f),r=r.substr(0,r.lastIndexOf("."))}else{const t=new WE(s);this.tagsNodeStack.push(n),s!==c&&h&&(t[":@"]=this.buildAttributesMap(c,r,s)),this.addChild(n,t,r,f),n=t}i="",a=u}}else i+=t[a];return e.child};function cD(t,e,n,i){this.options.captureMetaData||(i=void 0);const r=this.options.updateTag(e.tagname,n,e[":@"]);!1===r||("string"==typeof r?(e.tagname=r,t.addChild(e,i)):t.addChild(e,i))}const hD=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const n=this.docTypeEntities[e];t=t.replace(n.regx,n.val)}for(let e in this.lastEntities){const n=this.lastEntities[e];t=t.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const n=this.htmlEntities[e];t=t.replace(n.regex,n.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function uD(t,e,n,i){return t&&(void 0===i&&(i=0===e.child.length),void 0!==(t=this.parseTextData(t,e.tagname,n,!1,!!e[":@"]&&0!==Object.keys(e[":@"]).length,i))&&""!==t&&e.add(this.options.textNodeName,t),t=""),t}function dD(t,e,n){const i="*."+n;for(const r in t){const n=t[r];if(i===n||e===n)return!0}return!1}function fD(t,e,n,i){const r=t.indexOf(e,n);if(-1===r)throw new Error(i);return r+e.length-1}function pD(t,e,n,i=">"){const r=function(t,e,n=">"){let i,r="";for(let o=e;o<t.length;o++){let e=t[o];if(i)e===i&&(i="");else if('"'===e||"'"===e)i=e;else if(e===n[0]){if(!n[1])return{data:r,index:o};if(t[o+1]===n[1])return{data:r,index:o}}else"\t"===e&&(e=" ");r+=e}}(t,e+1,i);if(!r)return;let o=r.data;const a=r.index,s=o.search(/\s/);let l=o,c=!0;-1!==s&&(l=o.substring(0,s),o=o.substring(s+1).trimStart());const h=l;if(n){const t=l.indexOf(":");-1!==t&&(l=l.substr(t+1),c=l!==r.data.substr(t+1))}return{tagName:l,tagExp:o,closeIndex:a,attrExpPresent:c,rawTagName:h}}function mD(t,e,n){const i=n;let r=1;for(;n<t.length;n++)if("<"===t[n])if("/"===t[n+1]){const o=fD(t,">",n,`${e} is not closed`);if(t.substring(n+2,o).trim()===e&&(r--,0===r))return{tagContent:t.substring(i,n),i:o};n=o}else if("?"===t[n+1])n=fD(t,"?>",n+1,"StopNode is not closed.");else if("!--"===t.substr(n+1,3))n=fD(t,"--\x3e",n+3,"StopNode is not closed.");else if("!["===t.substr(n+1,2))n=fD(t,"]]>",n,"StopNode is not closed.")-2;else{const i=pD(t,n,">");i&&((i&&i.tagName)===e&&"/"!==i.tagExp[i.tagExp.length-1]&&r++,n=i.closeIndex)}}function gD(t,e,n){if(e&&"string"==typeof t){const e=t.trim();return"true"===e||"false"!==e&&function(t,e={}){if(e=Object.assign({},QE,e),!t||"string"!=typeof t)return t;let n=t.trim();if(void 0!==e.skipLike&&e.skipLike.test(n))return t;if("0"===t)return 0;if(e.hex&&ZE.test(n))return function(t){if(parseInt)return parseInt(t,16);if(Number.parseInt)return Number.parseInt(t,16);if(window&&window.parseInt)return window.parseInt(t,16);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}(n);if(-1!==n.search(/.+[eE].+/))return function(t,e,n){if(!n.eNotation)return t;const i=e.match(tD);if(i){let r=i[1]||"";const o=-1===i[3].indexOf("e")?"E":"e",a=i[2],s=r?t[a.length+1]===o:t[a.length]===o;return a.length>1&&s?t:1!==a.length||!i[3].startsWith(`.${o}`)&&i[3][0]!==o?n.leadingZeros&&!s?(e=(i[1]||"")+i[3],Number(e)):t:Number(e)}return t}(t,n,e);{const r=JE.exec(n);if(r){const o=r[1]||"",a=r[2];let s=(i=r[3])&&-1!==i.indexOf(".")?("."===(i=i.replace(/0+$/,""))?i="0":"."===i[0]?i="0"+i:"."===i[i.length-1]&&(i=i.substring(0,i.length-1)),i):i;const l=o?"."===t[a.length+1]:"."===t[a.length];if(!e.leadingZeros&&(a.length>1||1===a.length&&!l))return t;{const i=Number(n),r=String(i);if(0===i)return i;if(-1!==r.search(/[eE]/))return e.eNotation?i:t;if(-1!==n.indexOf("."))return"0"===r||r===s||r===`${o}${s}`?i:t;let l=a?s:n;return a?l===r||o+l===r?i:t:l===r||l===o+r?i:t}}return t}var i}(t,n)}return void 0!==t?t:""}const vD=WE.getMetaDataSymbol();function yD(t,e){return bD(t,e)}function bD(t,e,n){let i;const r={};for(let o=0;o<t.length;o++){const a=t[o],s=xD(a);let l="";if(l=void 0===n?s:n+"."+s,s===e.textNodeName)void 0===i?i=a[s]:i+=""+a[s];else{if(void 0===s)continue;if(a[s]){let t=bD(a[s],e,l);const n=SD(t,e);void 0!==a[vD]&&(t[vD]=a[vD]),a[":@"]?wD(t,a[":@"],l,e):1!==Object.keys(t).length||void 0===t[e.textNodeName]||e.alwaysCreateTextNode?0===Object.keys(t).length&&(e.alwaysCreateTextNode?t[e.textNodeName]="":t=""):t=t[e.textNodeName],void 0!==r[s]&&r.hasOwnProperty(s)?(Array.isArray(r[s])||(r[s]=[r[s]]),r[s].push(t)):e.isArray(s,l,n)?r[s]=[t]:r[s]=t}}}return"string"==typeof i?i.length>0&&(r[e.textNodeName]=i):void 0!==i&&(r[e.textNodeName]=i),r}function xD(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const t=e[n];if(":@"!==t)return t}}function wD(t,e,n,i){if(e){const r=Object.keys(e),o=r.length;for(let a=0;a<o;a++){const o=r[a];i.isArray(o,n+"."+o,!0,!0)?t[o]=[e[o]]:t[o]=e[o]}}}function SD(t,e){const{textNodeName:n}=e,i=Object.keys(t).length;return 0===i||!(1!==i||!t[n]&&"boolean"!=typeof t[n]&&0!==t[n])}class CD{constructor(t){this.externalEntities={},this.options=function(t){return Object.assign({},qE,t)}(t)}parse(t,e){if("string"!=typeof t&&t.toString)t=t.toString();else if("string"!=typeof t)throw new Error("XML data is accepted in String or Bytes[] form.");if(e){!0===e&&(e={});const n=function(t,e){e=Object.assign({},_E,e);const n=[];let i=!1,r=!1;"\ufeff"===t[0]&&(t=t.substr(1));for(let o=0;o<t.length;o++)if("<"===t[o]&&"?"===t[o+1]){if(o+=2,o=FE(t,o),o.err)return o}else{if("<"!==t[o]){if(IE(t[o]))continue;return OE("InvalidChar","char '"+t[o]+"' is not expected.",HE(t,o))}{let a=o;if(o++,"!"===t[o]){o=EE(t,o);continue}{let s=!1;"/"===t[o]&&(s=!0,o++);let l="";for(;o<t.length&&">"!==t[o]&&" "!==t[o]&&"\t"!==t[o]&&"\n"!==t[o]&&"\r"!==t[o];o++)l+=t[o];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),o--),!VE(l)){let e;return e=0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",OE("InvalidTag",e,HE(t,o))}const c=DE(t,o);if(!1===c)return OE("InvalidAttr","Attributes for '"+l+"' have open quote.",HE(t,o));let h=c.value;if(o=c.index,"/"===h[h.length-1]){const n=o-h.length;h=h.substring(0,h.length-1);const r=PE(h,e);if(!0!==r)return OE(r.err.code,r.err.msg,HE(t,n+r.err.line));i=!0}else if(s){if(!c.tagClosed)return OE("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",HE(t,o));if(h.trim().length>0)return OE("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",HE(t,a));if(0===n.length)return OE("InvalidTag","Closing tag '"+l+"' has not been opened.",HE(t,a));{const e=n.pop();if(l!==e.tagName){let n=HE(t,e.tagStartPos);return OE("InvalidTag","Expected closing tag '"+e.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+l+"'.",HE(t,a))}0==n.length&&(r=!0)}}else{const s=PE(h,e);if(!0!==s)return OE(s.err.code,s.err.msg,HE(t,o-h.length+s.err.line));if(!0===r)return OE("InvalidXml","Multiple possible root nodes found.",HE(t,o));-1!==e.unpairedTags.indexOf(l)||n.push({tagName:l,tagStartPos:a}),i=!0}for(o++;o<t.length;o++)if("<"===t[o]){if("!"===t[o+1]){o++,o=EE(t,o);continue}if("?"!==t[o+1])break;if(o=FE(t,++o),o.err)return o}else if("&"===t[o]){const e=zE(t,o);if(-1==e)return OE("InvalidChar","char '&' is not expected.",HE(t,o));o=e}else if(!0===r&&!IE(t[o]))return OE("InvalidXml","Extra text at the end",HE(t,o));"<"===t[o]&&o--}}}return i?1==n.length?OE("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",HE(t,n[0].tagStartPos)):!(n.length>0)||OE("InvalidXml","Invalid '"+JSON.stringify(n.map(t=>t.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):OE("InvalidXml","Start tag expected.",1)}(t,e);if(!0!==n)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const n=new nD(this.options);n.addExternalEntities(this.externalEntities);const i=n.parseXml(t);return this.options.preserveOrder||void 0===i?i:yD(i,this.options)}addEntity(t,e){if(-1!==e.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==t.indexOf("&")||-1!==t.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===e)throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=e}static getMetaDataSymbol(){return WE.getMetaDataSymbol()}}function TD(t,e){let n="";return e.format&&e.indentBy.length>0&&(n="\n"),$D(t,e,"",n)}function $D(t,e,n,i){let r="",o=!1;for(let a=0;a<t.length;a++){const s=t[a],l=MD(s);if(void 0===l)continue;let c="";if(c=0===n.length?l:`${n}.${l}`,l===e.textNodeName){let t=s[l];ND(c,e)||(t=e.tagValueProcessor(l,t),t=kD(t,e)),o&&(r+=i),r+=t,o=!1;continue}if(l===e.cdataPropName){o&&(r+=i),r+=`<![CDATA[${s[l][0][e.textNodeName]}]]>`,o=!1;continue}if(l===e.commentPropName){r+=i+`\x3c!--${s[l][0][e.textNodeName]}--\x3e`,o=!0;continue}if("?"===l[0]){const t=AD(s[":@"],e),n="?xml"===l?"":i;let a=s[l][0][e.textNodeName];a=0!==a.length?" "+a:"",r+=n+`<${l}${a}${t}?>`,o=!0;continue}let h=i;""!==h&&(h+=e.indentBy);const u=i+`<${l}${AD(s[":@"],e)}`,d=$D(s[l],e,c,h);-1!==e.unpairedTags.indexOf(l)?e.suppressUnpairedNode?r+=u+">":r+=u+"/>":d&&0!==d.length||!e.suppressEmptyNode?d&&d.endsWith(">")?r+=u+`>${d}${i}</${l}>`:(r+=u+">",d&&""!==i&&(d.includes("/>")||d.includes("</"))?r+=i+e.indentBy+d+i:r+=d,r+=`</${l}>`):r+=u+"/>",o=!0}return r}function MD(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const i=e[n];if(t.hasOwnProperty(i)&&":@"!==i)return i}}function AD(t,e){let n="";if(t&&!e.ignoreAttributes)for(let i in t){if(!t.hasOwnProperty(i))continue;let r=e.attributeValueProcessor(i,t[i]);r=kD(r,e),!0===r&&e.suppressBooleanAttributes?n+=` ${i.substr(e.attributeNamePrefix.length)}`:n+=` ${i.substr(e.attributeNamePrefix.length)}="${r}"`}return n}function ND(t,e){let n=(t=t.substr(0,t.length-e.textNodeName.length-1)).substr(t.lastIndexOf(".")+1);for(let i in e.stopNodes)if(e.stopNodes[i]===t||e.stopNodes[i]==="*."+n)return!0;return!1}function kD(t,e){if(t&&t.length>0&&e.processEntities)for(let n=0;n<e.entities.length;n++){const i=e.entities[n];t=t.replace(i.regex,i.val)}return t}const RD={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function _D(t){this.options=Object.assign({},RD,t),!0===this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=eD(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=ED),this.processTextOrObjNode=ID,this.options.format?(this.indentate=FD,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function ID(t,e,n,i){const r=this.j2x(t,n+1,i.concat(e));return void 0!==t[this.options.textNodeName]&&1===Object.keys(t).length?this.buildTextValNode(t[this.options.textNodeName],e,r.attrStr,n):this.buildObjectNode(r.val,e,r.attrStr,n)}function FD(t){return this.options.indentBy.repeat(t)}function ED(t){return!(!t.startsWith(this.options.attributeNamePrefix)||t===this.options.textNodeName)&&t.substr(this.attrPrefixLen)}_D.prototype.build=function(t){return this.options.preserveOrder?TD(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0,[]).val)},_D.prototype.j2x=function(t,e,n){let i="",r="";const o=n.join(".");for(let a in t)if(Object.prototype.hasOwnProperty.call(t,a))if(void 0===t[a])this.isAttribute(a)&&(r+="");else if(null===t[a])this.isAttribute(a)||a===this.options.cdataPropName?r+="":"?"===a[0]?r+=this.indentate(e)+"<"+a+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+a+"/"+this.tagEndChar;else if(t[a]instanceof Date)r+=this.buildTextValNode(t[a],a,"",e);else if("object"!=typeof t[a]){const n=this.isAttribute(a);if(n&&!this.ignoreAttributesFn(n,o))i+=this.buildAttrPairStr(n,""+t[a]);else if(!n)if(a===this.options.textNodeName){let e=this.options.tagValueProcessor(a,""+t[a]);r+=this.replaceEntitiesValue(e)}else r+=this.buildTextValNode(t[a],a,"",e)}else if(Array.isArray(t[a])){const i=t[a].length;let o="",s="";for(let l=0;l<i;l++){const i=t[a][l];if(void 0===i);else if(null===i)"?"===a[0]?r+=this.indentate(e)+"<"+a+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+a+"/"+this.tagEndChar;else if("object"==typeof i)if(this.options.oneListGroup){const t=this.j2x(i,e+1,n.concat(a));o+=t.val,this.options.attributesGroupName&&i.hasOwnProperty(this.options.attributesGroupName)&&(s+=t.attrStr)}else o+=this.processTextOrObjNode(i,a,e,n);else if(this.options.oneListGroup){let t=this.options.tagValueProcessor(a,i);t=this.replaceEntitiesValue(t),o+=t}else o+=this.buildTextValNode(i,a,"",e)}this.options.oneListGroup&&(o=this.buildObjectNode(o,a,s,e)),r+=o}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName){const e=Object.keys(t[a]),n=e.length;for(let r=0;r<n;r++)i+=this.buildAttrPairStr(e[r],""+t[a][e[r]])}else r+=this.processTextOrObjNode(t[a],a,e,n);return{attrStr:i,val:r}},_D.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&"true"===e?" "+t:" "+t+'="'+e+'"'},_D.prototype.buildObjectNode=function(t,e,n,i){if(""===t)return"?"===e[0]?this.indentate(i)+"<"+e+n+"?"+this.tagEndChar:this.indentate(i)+"<"+e+n+this.closeTag(e)+this.tagEndChar;{let r="</"+e+this.tagEndChar,o="";return"?"===e[0]&&(o="?",r=""),!n&&""!==n||-1!==t.indexOf("<")?!1!==this.options.commentPropName&&e===this.options.commentPropName&&0===o.length?this.indentate(i)+`\x3c!--${t}--\x3e`+this.newLine:this.indentate(i)+"<"+e+n+o+this.tagEndChar+t+this.indentate(i)+r:this.indentate(i)+"<"+e+n+o+">"+t+r}},_D.prototype.closeTag=function(t){let e="";return-1!==this.options.unpairedTags.indexOf(t)?this.options.suppressUnpairedNode||(e="/"):e=this.options.suppressEmptyNode?"/":`></${t}`,e},_D.prototype.buildTextValNode=function(t,e,n,i){if(!1!==this.options.cdataPropName&&e===this.options.cdataPropName)return this.indentate(i)+`<![CDATA[${t}]]>`+this.newLine;if(!1!==this.options.commentPropName&&e===this.options.commentPropName)return this.indentate(i)+`\x3c!--${t}--\x3e`+this.newLine;if("?"===e[0])return this.indentate(i)+"<"+e+n+"?"+this.tagEndChar;{let r=this.options.tagValueProcessor(e,t);return r=this.replaceEntitiesValue(r),""===r?this.indentate(i)+"<"+e+n+this.closeTag(e)+this.tagEndChar:this.indentate(i)+"<"+e+n+">"+r+"</"+e+this.tagEndChar}},_D.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const n=this.options.entities[e];t=t.replace(n.regex,n.val)}return t};class DD{static parser=new CD({attributeNamePrefix:"_$",ignoreAttributes:!1,parseAttributeValue:!1,trimValues:!1,parseTagValue:!1,isArray:(t,e,n,i)=>["worksheet.sheetData.row","workbook.sheets.sheet","worksheet.cols.col","worksheet.sheetViews.sheetView","worksheet.mergeCells.mergeCell","worksheet.hyperlinks.hyperlink","worksheet.dataValidations.dataValidation","worksheet.AutoFilter.filterColumn","worksheet.tableParts.tablePart","styleSheet.numFmts.numFmt","Relationships.Relationship","sst.si","table.tableColumns.tableColumn","workbook.pivotCaches.pivotCache","pivotCacheDefinition.cacheFields.cacheField","pivotCacheDefinition.cacheFields.cacheField.sharedItems.s","pivotCacheDefinition.cacheFields.cacheField.sharedItems.n","pivotCacheDefinition.cacheFields.cacheField.sharedItems.d","pivotCacheDefinition.cacheFields.cacheField.sharedItems.b","pivotCacheDefinition.cacheFields.cacheField.sharedItems.m","pivotCacheRecords.r","pivotCacheRecords.r.x","pivotCacheRecords.r.n","pivotCacheRecords.r.s","pivotCacheRecords.r.d","pivotCacheRecords.r.b","pivotCacheRecords.r.m","pivotTableDefinition.pivotFields.pivotField","pivotTableDefinition.pivotFields.pivotField.items.item","pivotTableDefinition.rowFields.field","pivotTableDefinition.colFields.field","pivotTableDefinition.dataFields.dataField","pivotTableDefinition.pageFields.pageField","pivotTableDefinition.formats.format"].includes(e)});static builder=new _D({attributeNamePrefix:"_$",ignoreAttributes:!1,suppressEmptyNode:!0});constructor(t,e){this.SN=t,this.Utils=t.Utils,this.obj=e??JSON.parse(JSON.stringify(ME)),this.sharedStringsObj={},this.objTp=ME,this.Sg=[]}getRelsByTarget(t,e=!1){const n=t.split("/").filter(t=>".."!==t).join("/"),i=n.split("/").pop(),r=n.replace(`/${i}`,""),o=`${n.startsWith("xl/")?"":"xl/"}${r}/_rels/${i}.rels`;let a=this.obj[o];return!a&&e&&(a=this.obj[o]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":[],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}}),a?.Relationships?.Relationship}getWsRelsFileTarget(t,e){const n=this.relationship.find(e=>e._$Id===t);if(!n)return null;const i=n._$Target,r=this.getRelsByTarget(i);if(!r)return null;const o=r.find(t=>t._$Id===e);return o?`xl/${o._$Target.replace(/\.\.\//g,"")}`:null}get sst(){return this.obj["xl/sharedStrings.xml"]||(this.obj["xl/sharedStrings.xml"]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"sst":{"si":[],"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$count":"0","_$uniqueCount":"0"}},this.override.push({"_$PartName":"/xl/sharedStrings.xml","_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),this.relationship.push({"_$Id":this.Rg(),"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","_$Target":"sharedStrings.xml"})),this.obj["xl/sharedStrings.xml"].sst}get styleSheet(){return this.obj["xl/styles.xml"].styleSheet}resetStyle(){this.obj["xl/styles.xml"]=JSON.parse(JSON.stringify(this.objTp["xl/styles.xml"]))}get override(){return this.obj["[Content_Types].xml"].Types.Override}get relationship(){return this.obj["xl/_rels/workbook.xml.rels"].Relationships.Relationship}get clrScheme(){return this.obj?.["xl/theme/theme1.xml"]?.["a:theme"]?.["a:themeElements"]?.["a:clrScheme"]}get sheets(){return this.obj["xl/workbook.xml"].workbook.sheets.sheet}get clrSchemeTp(){return this.objTp["xl/theme/theme1.xml"]["a:theme"]["a:themeElements"]["a:clrScheme"]}addSheet(t,e){const n=Math.max(...this.sheets.map(t=>Number(t._$sheetId)))+1,i=this.Ag(),r=this.Rg(),o={"_$name":t,"_$sheetId":n,"_$r:id":r};return e.hidden&&(o._$state="hidden"),this.sheets.push(o),this.relationship.push({"_$Id":r,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","_$Target":i.replace("xl/","")}),this.override.push({"_$PartName":"/"+i,"_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"}),this.obj[i]=JSON.parse(JSON.stringify(this.objTp["xl/worksheets/sheet1.xml"]))}dt(t){const n=this.obj["xl/styles.xml"].styleSheet,i=n.cellXfs.xf[t],r=i._$fontId,o=i._$borderId,a=i._$fillId,s=i._$numFmtId,l=n.fonts?.font?.[r]||{},c=i.alignment,h=n.borders?.border?.[o]||{},u=n.fills?.fill?.[a]||{},d=u.patternFill,f=u.gradientFill,p=d?"pattern":f?"gradient":null,m={};m.y={font:l,alignment:c,border:h,fill:u};const g={};let v=!1;""===l.b&&(g.bold=!0,v=!0),""===l.i&&(g.italic=!0,v=!0),""===l.strike&&(g.strike=!0,v=!0),""===l.outline&&(g.outline=!0,v=!0);const y=l.name?._$val;y&&(g.name=y,v=!0);const b=l.charset?._$val;b&&(g.charset=b,v=!0);const x=l.sz?._$val;if(x){const t=Number(x);g.size=Number.isFinite(t)?t:x,v=!0}const w=l.color,S=k(w,this.SN);S&&(g.color=S,v=!0),void 0!==w?._$theme?(g.colorTheme=w._$theme,void 0!==w._$tint&&(g.colorTint=w._$tint),v=!0):void 0!==w?._$indexed?(g.colorIndexed=w._$indexed,v=!0):void 0!==w?._$auto&&(g.colorAuto=w._$auto,v=!0),void 0!==l.u&&(g.underline="object"==typeof l.u?l.u._$val:"single",v=!0);const C=l.vertAlign?._$val;if(C&&(g.vertAlign=C,v=!0),v&&(m.font=g),s){let t=e[s];if(!t&&n.numFmts?.numFmt){const e=n.numFmts.numFmt;for(let n=0,i=e.length;n<i;n++)if(e[n]._$numFmtId==s){t=e[n]._$formatCode;break}}t&&(m.numFmt=-1!==t.indexOf("\\")?t.replaceAll("\\",""):t)}if(c){const t={};let e=!1;const n=c._$horizontal;n&&(t.horizontal=n,e=!0);const i=c._$vertical;i&&(t.vertical=i,e=!0),"1"===c._$wrapText&&(t.wrapText=!0,e=!0),"1"===c._$shrinkToFit&&(t.shrinkToFit=!0,e=!0);const r=c._$indent;if(r){const n=Number(r);t.indent=Number.isFinite(n)?n:r,e=!0}const o=c._$textRotation;o&&(t.textRotation=parseInt(o),e=!0),e&&(m.alignment=t)}const T={};let $=!1;const M=["bottom","top","left","right"];for(let e=0;e<4;e++){const t=M[e],n=h[t];if(n){const e=k(n.color,this.SN),i=n._$style;(e||i)&&(T[t]={},e&&(T[t].color=e),i&&(T[t].style=i),$=!0)}}const A=h.diagonal,N="1"===h._$diagonalDown,R="1"===h._$diagonalUp,_=N||R;if(A&&(A._$style||A.color||_)){const t={},e=k(A.color,this.SN);e&&(t.color=e),A._$style&&(t.style=A._$style),T.diagonal=t,!N&&_||(T.diagonalDown=!0),R&&(T.diagonalUp=!0),$=!0}if($&&(m.border=T),p){const t={type:p};let e=!1;if("pattern"===p){const n=d._$patternType;n&&(t.pattern=n,"none"!==n&&(e=!0));const i=k(d.fgColor,this.SN);i&&(t.fgColor=i,e=!0);const r=k(d.bgColor,this.SN);r&&(t.bgColor=r,e=!0)}else if("gradient"===p){e=!0;const n=f._$type;n&&(t.gradientType=n);const i=f._$degree;if(i){const e=Number(i);t.degree=Number.isFinite(e)?e:i}const r=f._$left;if(r){const e=Number(r);t.left=Number.isFinite(e)?e:r}const o=f._$right;if(o){const e=Number(o);t.right=Number.isFinite(e)?e:o}const a=f._$top;if(a){const e=Number(a);t.top=Number.isFinite(e)?e:a}const s=f._$bottom;if(s){const e=Number(s);t.bottom=Number.isFinite(e)?e:s}const l=f.stop;if(l){t.stops=[];for(let e=0,n=l.length;e<n;e++){const n=l[e],i=k(n.color,this.SN);if(i||n._$position){const e={};if(n._$position){const t=Number(n._$position);e.position=Number.isFinite(t)?t:n._$position}i&&(e.color=i),t.stops.push(e)}}}}e&&(m.fill=t)}const I=i.protection;if(I){const t={};void 0!==I._$locked&&(t.locked="0"!==I._$locked),void 0!==I._$hidden&&(t.hidden="1"===I._$hidden),Object.keys(t).length>0&&(m.protection=t)}return this.Sg[t]=m}Oe(t){const e=this.obj["xl/styles.xml"].styleSheet,n=e.dxfs?.dxf;if(!n)return null;const i=(Array.isArray(n)?n:[n])[t];if(!i)return null;const r={},o=t=>{if(null==t)return!1;if(""===t)return!0;if("object"==typeof t){const e=t._$val;if(null==e||""===e)return!0;const n=String(e).toLowerCase();return"0"!==n&&"false"!==n&&"none"!==n&&"off"!==n}const e=String(t).toLowerCase();return"0"!==e&&"false"!==e&&"none"!==e&&"off"!==e};if(i.font){const t=i.font,e={};let n=!1;o(t.b)&&(e.bold=!0,n=!0),o(t.i)&&(e.italic=!0,n=!0),o(t.strike)&&(e.strike=!0,n=!0);const a=k(t.color,this.SN);a&&(e.color=a,n=!0),void 0!==t.u&&o(t.u)&&(e.underline="object"==typeof t.u?t.u._$val:"single",n=!0),n&&(r.font=e)}if(i.fill){const t=i.fill.patternFill;if(t){const e={type:"pattern"},n=t._$patternType;n&&(e.pattern=n);const i=k(t.bgColor,this.SN);i&&(e.fgColor=i);const o=k(t.fgColor,this.SN);o&&!i&&(e.fgColor=o),r.fill=e}}if(i.border){const t=i.border,e={};let n=!1;const o=["bottom","top","left","right"];for(const i of o){const r=t[i];if(r){const t=k(r.color,this.SN),o=r._$style;(t||o)&&(e[i]={},t&&(e[i].color=t),o&&(e[i].style=o),n=!0)}}const a=t.diagonal,s="1"===t._$diagonalDown,l="1"===t._$diagonalUp,c=s||l;if(a&&(a._$style||a.color||c)){const t={},i=k(a.color,this.SN);i&&(t.color=i),a._$style&&(t.style=a._$style),e.diagonal=t,!s&&c||(e.diagonalDown=!0),l&&(e.diagonalUp=!0),n=!0}n&&(r.border=e)}return r}eo(t){const e=this.relationship.find(e=>e._$Id==t);return e?this.obj[`xl/${e._$Target.replace("/xl/","")}`].worksheet:null}lo(t){const e=this.relationship.find(e=>e._$Id==t);return e?e._$Target.split("/").pop():null}it(t){if(!t)return null;const e={};let n=!1;""===t.b&&(e.bold=!0,n=!0),""===t.i&&(e.italic=!0,n=!0),""===t.strike&&(e.strike=!0,n=!0),void 0!==t.u&&(e.underline="object"==typeof t.u?t.u._$val:"single",n=!0);const i=t.sz?._$val;if(i){const t=Number(i);e.size=Number.isFinite(t)?t:i,n=!0}const r=k(t.color,this.SN);r&&(e.color=r,n=!0);const o=t.rFont?._$val;o&&(e.name=o,n=!0);const a=t.charset?._$val;a&&(e.charset=a,n=!0);const s=t.vertAlign?._$val;return s&&(e.vertAlign=s,n=!0),n?e:null}nt(t){const e=this.obj["xl/sharedStrings.xml"]?.sst?.si?.[t];let n="",i=null;if("string"==typeof e.t)n=e.t;else if(e.r){const t=Array.isArray(e.r)?e.r:[e.r],r=[];let o=!1;for(const e of t){const t="string"==typeof e.t?e.t:e.t?.["#text"]??"",n=this.it(e.rPr);n&&(o=!0),r.push({text:t,font:n||{}})}n=r.map(t=>t.text).join(""),o&&(i=r)}else n=e.t?.["#text"]??e?.t??"";if("string"!=typeof n)return{text:"",richText:null};if(n=n.replaceAll("&#10;","\n"),i)for(const r of i)r.text=r.text.replaceAll("&#10;","\n");return{text:n,richText:i}}resolveHyperlinkById(t){const e=this.relationship.find(e=>e._$Id==t);if(!e)return null;const n=this.obj[`xl/worksheets/_rels/${e._$Target.split("/").pop()}.rels`];if(!n?.Relationships?.Relationship)return null;const i={};return(Array.isArray(n.Relationships.Relationship)?n.Relationships.Relationship:[n.Relationships.Relationship]).forEach(t=>{i[t._$Id]=t}),i}Rg(){const t=this.relationship.map(t=>parseInt(t._$Id.match(/\d+/)[0]));return`rId${Math.max(...t)+1}`}Ag(){const t=Object.keys(this.obj);let e=0;return t.forEach(t=>{const n=t.match(/^xl\/worksheets\/sheet(\d+)\.xml$/);if(n){const t=parseInt(n[1],10);t>e&&(e=t)}}),`xl/worksheets/sheet${e+1}.xml`}}function LD(t){t&&(t.style.left="",t.style.right="",t.style.top="",t.style.bottom="",t.style.marginTop="",t.style.marginBottom="")}function PD(t){if(!t)return;const e=t.getBoundingClientRect(),n=window.innerWidth,i=window.innerHeight;e.right>n-10&&(t.style.left="auto",t.style.right="0"),e.bottom>i-10&&(t.style.top="auto",t.style.bottom="100%",t.style.marginTop="0",t.style.marginBottom="5px")}const zD=new WeakSet,OD=new WeakMap;let BD=null,VD=null;const HD=new WeakSet;function UD(t){clearTimeout(VD);const e=t.currentTarget,n=e.getAttribute("title")||e.getAttribute("data-title");n&&(e.hasAttribute("title")&&(e.setAttribute("data-title",n),e.removeAttribute("title")),BD.querySelector(".sn-tooltip-content").textContent=n,BD.classList.add("show"),function(t){const e=t.getBoundingClientRect(),n=BD.getBoundingClientRect();let i,r;switch(t.getAttribute("data-placement")||"top"){case"top":default:i=e.top-n.height-8,r=e.left+(e.width-n.width)/2,BD.setAttribute("data-placement","top");break;case"bottom":i=e.bottom+8,r=e.left+(e.width-n.width)/2,BD.setAttribute("data-placement","bottom");break;case"left":i=e.top+(e.height-n.height)/2,r=e.left-n.width-8,BD.setAttribute("data-placement","left");break;case"right":i=e.top+(e.height-n.height)/2,r=e.right+8,BD.setAttribute("data-placement","right")}r<5?r=5:r+n.width>window.innerWidth-5&&(r=window.innerWidth-n.width-5),i<5&&(i=e.bottom+8,BD.setAttribute("data-placement","bottom")),BD.style.top=`${i+window.scrollY}px`,BD.style.left=`${r+window.scrollX}px`}(e))}function qD(t){VD=setTimeout(()=>{BD.classList.remove("show")},100)}function KD(t){t.querySelectorAll(".sn-tooltip").forEach(t=>{t.dataset.tooltipBound||(t.addEventListener("mouseenter",UD),t.addEventListener("mouseleave",qD),t.dataset.tooltipBound="true")})}const WD={common:["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"],standard:["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]};function jD(t,e,n){let i=t,r=e;return i<n.minX&&(i=n.minX),r<n.minY&&(r=n.minY),i>n.maxX&&(i=n.maxX),r>n.maxY&&(r=n.maxY),{x:i,y:r}}class GD{constructor(t){this.SN=t,this.bindings=new Map}register(t,e,n){this.bindings.set(t,{element:e,getter:n})}unregister(t){this.bindings.delete(t)}unregisterAll(t){t.forEach(t=>this.bindings.delete(t))}notify(t,e){const n=this.bindings.get(t);n?.element&&(n.element.checked=!!e)}getState(t){return"function"==typeof t?!!t(this.SN):!!t}has(t){return this.bindings.has(t)}clear(){this.bindings.clear()}}class XD{constructor(t,e={}){this.rn=e,this.SN=t,this.kg=!1,this.StateSync=new GD(t),this.Tg=!0,this.Ng=!0,this.Fg=!1,this._g=!0,this.Eg=!0,this.Ig=!0,this.zg=!1,this.Dg=!1,this.Lg=null,this.Og=!1,this.Pg=null,this.Kv=null,this.Vg="pro",this.Bg="pro",this.Hg=!1,this.Ug=null,this.Kg=!1,this.Wg=!1,this.myModal=null,this.toast=null,this.chatWindowOffsetX=0,this.chatWindowOffsetY=0,this.jg=null,this.qg=null,this.Gg=null,this.Xg=null,this.Yg=null,this.menuConfig=function(t,e={}){const n=t.t("layout.menuRightMinimalToolbar"),i=`\n        <label class="sn-menu-minimal-toggle" title="${t.t("layout.menuRightMinimalToolbarTitle")}">\n            <input class="sn-menu-minimal-toggle-input" type="checkbox" data-role="menu-minimal-toolbar-toggle">\n            <span class="sn-menu-minimal-toggle-text">${n}</span>\n        </label>\n    `;let r=i;return"function"==typeof e.menuRight&&(r=e.menuRight(i)),{right:{html:r}}}(t,e),this.J(t.containerDom)}get isSmallWindow(){return this.SN.containerDom.offsetWidth<900}get toolbarMode(){return this.Vg}get isToolbarModeLocked(){return this.Hg}get minimalToolbarTextEnabled(){return this.Wg}get showMenuBar(){return this.Tg}set showMenuBar(t){this.Tg=t,this.snHead.style.display=t?"flex":"none",this.updateCanvasSize()}get showToolbar(){return this.Ng}set showToolbar(t){this.Ng=t,this.snTools.style.display=t?"flex":"none",this.updateCanvasSize()}get showAIChat(){return this.Fg}set showAIChat(t){this.Fg=t,this.StateSync.notify("showAIChat",t),t?(this.snChat.style.display="block",this.isSmallWindow&&(this.showAIChatWindow=!0)):this.snChat.style.display="none",this.updateCanvasSize()}get showFormulaBar(){return this._g}set showFormulaBar(t){this._g=t,this.StateSync.notify("showFormulaBar",t),this.snFormulaBar.style.display=t?"grid":"none",this.updateCanvasSize()}get showSheetTabBar(){return this.Eg}set showSheetTabBar(t){this.Eg=t,this.StateSync.notify("showSheetTabBar",t),this.snSheetTabBar.style.display=t?"":"none",this.updateCanvasSize()}get showStats(){return this.Ig}set showStats(t){this.Ig=t,this.StateSync.notify("showStats",t),this.SN.containerDom.querySelectorAll(".sn-stat-item").forEach(e=>{e.style.display=t?"":"none"})}get showAIChatWindow(){return this.zg}set showAIChatWindow(t){!t&&this.isSmallWindow&&this.Fg&&(this.showAIChat=!1),this.zg=t,t?(this.snChat.classList.add("sn-chat-window"),this.snChat.style.transform=`translate(${this.chatWindowOffsetX}px, ${this.chatWindowOffsetY}px)`):(this.snChat.classList.remove("sn-chat-window"),this.snChat.style.transform="none"),this.updateCanvasSize()}get showPivotPanel(){return this.Dg}set showPivotPanel(t){const e=this.Lg;this.Dg=t,t?this.snPivotPanel.style.display="flex":(this.snPivotPanel.style.display="none",this.Lg=null);const n=t?this.Lg:e;n&&this.Jg(n),this.updateCanvasSize()}openPivotPanel(t){this.Og=!1,this.Lg=t,this.Zg(t),this.showPivotPanel=!0}togglePivotPanel(t){return this.Dg&&this.Lg===t?(this.Og=!0,this.showPivotPanel=!1,!1):(this.openPivotPanel(t),!0)}autoOpenPivotPanel(t){this.Og||this.Dg&&this.Lg===t||(this.Lg=t,this.Zg(t),this.showPivotPanel=!0)}closePivotPanel(){this.Dg&&(this.showPivotPanel=!1)}refreshActiveButtons(){this.eg&&function(t,e){if(!t||!e?.SN)return;const n=t.querySelector(".sn-tools");n&&n.querySelectorAll('[data-active-getter="true"]').forEach(t=>{const n=t.dataset.field;if(!n)return;const i=function(t,e){for(const n of t)for(const t of n.groups||[])for(const n of t.items||[]){if(n.id===e&&"function"==typeof n.active)return n;if("stack"===n.type&&n.items){const t=n.items.find(t=>t.id===e&&"function"==typeof t.active);if(t)return t}if("row"===n.type&&n.items){const t=n.items.find(t=>t.id===e&&"function"==typeof t.active);if(t)return t}}return null}(e.config,n);if(i&&"function"==typeof i.active){const n=!!i.active(e.SN);t.classList.toggle("sn-btn-selected",n)}})}(this.SN.containerDom,this.eg)}refreshToolbar(){const t=this.SN.activeSheet;if(!t)return;const{r:e,c:n}=t.activeCell,i=t.getCell(e,n);oF(this.SN.containerDom,i,this.eg?.menuConfig),this.refreshActiveButtons();const r=this.SN.containerDom.querySelector(".sn-tools-panel.active");this.Qg(r),aF(this.SN.containerDom,this.eg),this.ty()}Qg(t){if(!t||!this.eg)return;const e=t.querySelectorAll('input[type="checkbox"]'),n=this.eg.config;e.forEach(t=>{const e=t.dataset.field;for(const i of n)for(const n of i.groups||[])for(const i of n.items||[]){const n=this.ey(i,e);if(n)return"function"==typeof n.checked&&(t.checked=!!n.checked(this.SN)),void("function"==typeof n.disabled?t.disabled=!!n.disabled(this.SN):void 0!==n.disabled&&(t.disabled=!!n.disabled))}})}ey(t,e){if("checkbox"===t.type&&t.id===e)return t;if(("stack"===t.type||"row"===t.type)&&Array.isArray(t.items))for(const n of t.items){const t=this.ey(n,e);if(t)return t}return null}toggleMinimalToolbar(t){const e=!!t;e||!this.Hg?(this.Bg=e?"minimal":"pro",this.ny(this.Bg),this.iy()):this.iy()}toggleMinimalToolbarText(t){this.oy(t),this.iy(),this.ty()}oy(t){const e=!!t;this.Wg=e,this.SN.containerDom.classList.toggle("sn-toolbar-minimal-text",e)}ly(t=this.SN.containerDom.offsetWidth){const e=t<1400;this.Hg=e;const n=e?"minimal":this.Bg;this.ny(n),this.iy()}ny(t){const e="minimal"===t?"minimal":"pro";this.Vg!==e?(this.Vg=e,this.SN.containerDom.classList.toggle("sn-toolbar-minimal","minimal"===e),this.ty(),requestAnimationFrame(()=>this.updateCanvasSize())):this.ty()}iy(){this.hy();const t=this.SN.containerDom.querySelector(".sn-tools-panel.active");t&&this.eg&&(this.Qg(t),aF(this.SN.containerDom,this.eg))}hy(){const t=this.SN.containerDom.querySelector('.sn-menu-minimal-toggle input[data-role="menu-minimal-toolbar-toggle"]');if(!t)return;const e="minimal"===this.Vg;t.checked=e,t.disabled=this.Hg&&e}uy(){const t=this.SN.containerDom.querySelector('.sn-menu-minimal-toggle input[data-role="menu-minimal-toolbar-toggle"]');t&&t.addEventListener("change",()=>{this.toggleMinimalToolbar(t.checked)})}my(){if(this.Kg)return;this.Kg=!0;const t=this.SN.containerDom.querySelector(".sn-menu-list");t&&(t.addEventListener("click",e=>{const n=e.target.closest(".sn-tab-overflow-menu li[data-panel]");if(!n)return;const i=n.dataset.panel,r=t.querySelector('.sn-menu-tab[data-panel="'+i+'"]');r&&this.py(r)}),this.SN.containerDom.addEventListener("mousedown",t=>{const e=t.target.closest(".sn-toolbar-more");if(!e||!this.SN.containerDom.contains(e))return;if(t.target.closest(".sn-toolbar-overflow-menu"))return;t.preventDefault(),t.stopPropagation();const n=e.classList.contains("active");if(this.SN.containerDom.querySelectorAll(".sn-toolbar-more.active").forEach(t=>t.classList.remove("active")),!n){const t=e.querySelector(".sn-toolbar-overflow-menu");if(t){const n=e.getBoundingClientRect(),i=this.SN.containerDom.getBoundingClientRect();t.style.top=n.bottom+10+"px",t.style.right=document.documentElement.clientWidth-i.right+8+"px",t.style.left=""}e.classList.add("active")}}),window.addEventListener("mousedown",t=>{this.SN.containerDom.querySelectorAll(".sn-toolbar-more.active").forEach(e=>{e.contains(t.target)||e.classList.remove("active")})}))}ty(){null!==this.Ug&&cancelAnimationFrame(this.Ug),this.Ug=requestAnimationFrame(()=>{this.Ug=null,this.vy()})}vy(){if("minimal"!==this.Vg)return this.by(),void this.gy();this.yy(),this.wy()}xy(t){let e=t.querySelector(".sn-tab-overflow");if(e)return e;e=document.createElement("div"),e.className="sn-dropdown sn-tab-overflow";const n=document.createElement("div");n.className="sn-dropdown-toggle sn-no-icon";const i=document.createElement("span");i.textContent="更多";const r=document.createElement("i");r.className="sn-arrow",n.appendChild(i),n.appendChild(r);const o=document.createElement("ul");return o.className="sn-dropdown-menu sn-tab-overflow-menu",e.appendChild(n),e.appendChild(o),t.appendChild(e),e}by(){const t=this.SN.containerDom.querySelector(".sn-menu-list");if(!t)return;t.querySelectorAll('.sn-menu-tab[data-minimal-overflow-hidden="true"]').forEach(t=>{const e=t.classList.contains("sn-contextual-tab")&&t.dataset.contextType!==(this.Pg||"");t.style.display=e?"none":"",delete t.dataset.minimalOverflowHidden});const e=t.querySelector(".sn-tab-overflow");if(!e)return;const n=e.querySelector(".sn-tab-overflow-menu");n&&(n.innerHTML=""),e.style.display="none"}yy(){const t=this.SN.containerDom.querySelector(".sn-menu-list");if(!t)return;this.by();const e=Array.from(t.querySelectorAll(".sn-menu-tab")).filter(t=>"none"!==getComputedStyle(t).display);if(!e.length)return;const n=this.xy(t);n.style.display="flex";const i=n.querySelector(".sn-tab-overflow-menu");i.innerHTML="";const r=new Map(e.map((t,e)=>[t,e])),o=t.querySelector(".sn-menu-tab.active"),a=Math.max(0,t.clientWidth-n.offsetWidth-6);let s=0;const l=[];let c=[];if(e.forEach(t=>{const e=t.offsetWidth;s+e<=a?(l.push(t),s+=e):c.push(t)}),o&&c.includes(o)){c=c.filter(t=>t!==o);const t=[...l].reverse().find(t=>t!==o);t&&(l.splice(l.indexOf(t),1),c.unshift(t)),l.push(o)}c.sort((t,e)=>(r.get(t)||0)-(r.get(e)||0)),c.forEach(t=>{t.style.display="none",t.dataset.minimalOverflowHidden="true";const e=document.createElement("li");e.dataset.panel=t.dataset.panel||"",e.textContent=(t.textContent||"").trim(),t.classList.contains("active")&&e.classList.add("active"),i.appendChild(e)}),c.length||(n.style.display="none")}$y(t){let e=Array.from(t.children).find(t=>t.classList?.contains("sn-toolbar-more"));if(e)return e;e=document.createElement("div"),e.className="sn-tools-item small sn-toolbar-more";const n=document.createElement("div");n.className="sn-toolbar-more-toggle",n.innerHTML=cn("zk");const i=document.createElement("div");return i.className="sn-toolbar-overflow-menu",e.appendChild(n),e.appendChild(i),t.appendChild(e),e}My(t){const e=Array.from(t.children).find(t=>t.classList?.contains("sn-toolbar-more"));if(!e)return;const n=e.querySelector(".sn-toolbar-overflow-menu"),i=Array.from(n.children).filter(t=>t.classList?.contains("sn-tools-group"));i.sort((t,e)=>Number(t.dataset.minimalOrder||0)-Number(e.dataset.minimalOrder||0)),i.forEach(n=>t.insertBefore(n,e)),n.innerHTML="",e.classList.remove("active"),e.style.display="none"}gy(){this.SN.containerDom.querySelectorAll(".sn-tools-panel").forEach(t=>this.My(t))}wy(){const t=this.SN.containerDom.querySelector(".sn-tools-panel.active");if(!t)return;this.eg&&this.eg.renderPanelIfNeeded(t)&&this.initColorComponents(t),this.My(t);const e=Array.from(t.children).filter(t=>t.classList?.contains("sn-tools-group"));if(!e.length)return;e.forEach((t,e)=>{t.dataset.minimalOrder||(t.dataset.minimalOrder=String(e))});const n=this.$y(t),i=n.querySelector(".sn-toolbar-overflow-menu");i.innerHTML="",n.style.display="flex";const r=Math.max(0,t.clientWidth-n.offsetWidth-6);let o=0;const a=[];if(e.forEach((t,e)=>{const n=t.offsetWidth;0===e||o+n<=r?o+=n:a.push(t)}),!a.length)return n.classList.remove("active"),void(n.style.display="none");a.forEach(t=>i.appendChild(t))}Zg(t){const e=t.cache;if(!e||!e.fields.length)return void this.SN.Utils.toast(this.SN.t("core.layout.layout.toast.msg001"));const n=this.snPivotPanel;this.SN.namespace,n.querySelector(".sn-pivot-fields-list").innerHTML=e.fields.map((t,e)=>`\n            <div class="sn-pivot-field-item" data-index="${e}" draggable="true">\n                <label class="sn-pivot-field-label">\n                    <input type="checkbox" data-index="${e}">\n                    <span class="sn-pivot-field-text">${t.name}</span>\n                </label>\n            </div>\n        `).join(""),n.querySelectorAll(".sn-pivot-zone-list").forEach(t=>{t.innerHTML=""}),this.Cy(t),this.Sy(t)}Cy(t){const e=this.snPivotPanel,n=t.cache,i=e=>t.pivotFields[e]?.name||n.fields[e]?.name||this.SN.t("core.layout.layout.pivotPanel.fieldFallback",{idx:e});e.querySelector('.sn-pivot-zone[data-zone="row"] .sn-pivot-zone-list').innerHTML=t.rowFields.map(t=>this.Ry(t,i(t))).join(""),e.querySelector('.sn-pivot-zone[data-zone="column"] .sn-pivot-zone-list').innerHTML=t.colFields.map(t=>this.Ry(t,i(t))).join(""),e.querySelector('.sn-pivot-zone[data-zone="value"] .sn-pivot-zone-list').innerHTML=t.dataFields.map((t,e)=>{const n=t.name||i(t.fld);return this.Ry(t.fld,n,t.subtotal,e)}).join(""),e.querySelector('.sn-pivot-zone[data-zone="filter"] .sn-pivot-zone-list').innerHTML=t.pageFields.map(t=>this.Ry(t,i(t))).join("");const r=new Set([...t.rowFields,...t.colFields,...t.dataFields.map(t=>t.fld),...t.pageFields]);e.querySelectorAll('.sn-pivot-field-item input[type="checkbox"]').forEach(t=>{t.checked=r.has(Number(t.dataset.index))})}Ry(t,e,n="",i=""){const r=(t,e)=>this.SN.t(t,e);return`\n            <div class="sn-pivot-zone-item" data-index="${t}" data-subtotal="${n}" data-df-index="${i}" draggable="true">\n                <span class="sn-pivot-zone-item-name">${e}</span>\n                <div class="sn-pivot-zone-item-actions">\n                    <button class="sn-pivot-zone-item-action sn-pivot-zone-item-remove" title="${r("core.layout.layout.pivotPanel.remove")}">✕</button>\n                    <button class="sn-pivot-zone-item-action sn-pivot-zone-item-settings" title="${r("core.layout.layout.pivotPanel.fieldSettings")}">⚙</button>\n                </div>\n            </div>\n        `}Sy(t){const e=this.snPivotPanel,n=this.SN;e.querySelector('[data-action="close"]').onclick=()=>{this.Og=!0,this.showPivotPanel=!1};const i=e.querySelector(".sn-pivot-search-input");i.oninput=()=>{const t=i.value.toLowerCase();e.querySelectorAll(".sn-pivot-field-item").forEach(e=>{const n=e.querySelector("label").textContent.toLowerCase();e.style.display=n.includes(t)?"":"none"})},e.querySelectorAll('.sn-pivot-field-item input[type="checkbox"]').forEach(e=>{e.onchange=()=>{const n=Number(e.dataset.index);if(e.checked){const e=this.Ay(t,n);this.ky(t,e,n,"sum")}else this.Ty(t,n);this.Cy(t),this.Ny(t)}}),e.querySelectorAll(".sn-pivot-zone-list").forEach(e=>{e.onclick=n=>{const i=n.target.closest(".sn-pivot-zone-item");if(!i)return;const r=e.closest(".sn-pivot-zone").dataset.zone,o=Number(i.dataset.index),a=""!==i.dataset.dfIndex?Number(i.dataset.dfIndex):null;n.target.closest(".sn-pivot-zone-item-settings")?this.Fy(t,r,o,a):n.target.closest(".sn-pivot-zone-item-remove")&&(this._y(t,r,o,a),this.Cy(t),this.Ny(t))}}),e.querySelector(".sn-pivot-update-btn").onclick=()=>{t.calculate(),t.render(),n.Utils.toast(n.t("core.layout.layout.toast.msg002"))};const r=e.querySelector(".sn-pivot-delay-update input");this.Ey=r.checked,r.onchange=()=>{this.Ey=r.checked},this.Iy(t)}Iy(t){const e=this.snPivotPanel;let n=null;e.querySelectorAll(".sn-pivot-field-item").forEach(t=>{t.ondragstart=e=>{const i=Number(t.dataset.index),r=t.querySelector("label").textContent;n={type:"field",index:i,name:r,sourceZone:null},t.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",i)},t.ondragend=()=>{t.classList.remove("dragging"),n=null}}),e.querySelectorAll(".sn-pivot-zone").forEach(e=>{const i=e.dataset.zone,r=e.querySelector(".sn-pivot-zone-list");r.ondragstart=t=>{const e=t.target.closest(".sn-pivot-zone-item");if(!e)return;const r=Number(e.dataset.index),o=e.querySelector(".sn-pivot-zone-item-name").textContent,a=e.dataset.subtotal||"",s=""!==e.dataset.dfIndex?Number(e.dataset.dfIndex):null;n={type:"zone-item",index:r,name:o,subtotal:a,dfIndex:s,sourceZone:i},e.classList.add("dragging"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",r)},r.ondragend=t=>{const e=t.target.closest(".sn-pivot-zone-item");e&&e.classList.remove("dragging"),n=null},e.ondragover=t=>{t.preventDefault(),t.dataTransfer.dropEffect="move",e.classList.add("drag-over")},e.ondragleave=t=>{e.contains(t.relatedTarget)||e.classList.remove("drag-over")},e.ondrop=o=>{if(o.preventDefault(),e.classList.remove("drag-over"),!n)return;const a=i,{index:s,sourceZone:l,subtotal:c,dfIndex:h}=n,u=this.zy(r,o);if(l===a)if("value"===a){if("number"==typeof h&&!Number.isNaN(h)){const e=u>h?u-1:u;t.moveDataField(h,e)}}else this.Dy(t,a,s,u);else l&&this._y(t,l,s,h),this.ky(t,a,s,c,u);this.Cy(t),this.Ny(t),n=null}});const i=e.querySelector(".sn-pivot-fields-list");i&&(i.ondragover=t=>{t.preventDefault(),t.dataTransfer.dropEffect="move",i.classList.add("drag-over")},i.ondragleave=t=>{i.contains(t.relatedTarget)||i.classList.remove("drag-over")},i.ondrop=e=>{if(e.preventDefault(),i.classList.remove("drag-over"),!n||"zone-item"!==n.type||!n.sourceZone)return;const{index:r,sourceZone:o,dfIndex:a}=n;this._y(t,o,r,a),this.Cy(t),this.Ny(t),n=null})}Fy(t,e,n,i){if("value"!==e)this.Ly(t,n);else{if("number"!=typeof i||Number.isNaN(i))return;this.Oy(t,i)}}Ly(t,e){const n=this.SN,i=t.pivotFields[e];if(!i)return;const r=t.cache?.fields?.[e],o=r?.name||i.name||`Field${e}`,a=i.name||o,s=!1===i.defaultSubtotal?"none":"auto",l=!1===i.subtotalTop?"bottom":"top",c=i.sortType||"manual",h=!1!==i.showDropDowns,u=!0===i.showAll,d=!0===i.repeatItemLabels,f=!0===i.insertBlankRow,p=t.compact?"compact":t.outline?"outline":"tabular";n.Utils.modal({titleKey:"core.layout.layout.modal.m001.title",title:"Field Settings",maxWidth:"480px",content:`\n                <div class="sn-pivot-settings">\n                    <div class="sn-pivot-settings-row">\n                        <label>Source Name</label>\n                        <div class="sn-pivot-settings-static">${o}</div>\n                    </div>\n                    <div class="sn-pivot-settings-row">\n                        <label>Custom Name</label>\n                        <input type="text" data-field="pivot-custom-name" value="${a}">\n                    </div>\n                    <div class="sn-pivot-settings-tabs">\n                        <button type="button" class="sn-pivot-settings-tab active" data-tab="summary">Subtotal & Filter</button>\n                        <button type="button" class="sn-pivot-settings-tab" data-tab="layout">Layout & Print</button>\n                    </div>\n                    <div class="sn-pivot-settings-panel active" data-panel="summary">\n                        <div class="sn-pivot-settings-section">\n                            <div class="sn-pivot-settings-section-title">Subtotal</div>\n                            <label class="sn-pivot-settings-option">\n                                <input type="radio" name="pivot-subtotal" value="auto"${"auto"===s?" checked":""}>\n                                <span>Automatic</span>\n                            </label>\n                            <label class="sn-pivot-settings-option">\n                                <input type="radio" name="pivot-subtotal" value="none"${"none"===s?" checked":""}>\n                                <span>None</span>\n                            </label>\n                            <div class="sn-pivot-settings-row">\n                                <label>Position</label>\n                                <select data-field="pivot-subtotal-position">\n                                    <option value="top"${"top"===l?" selected":""}>Top</option>\n                                    <option value="bottom"${"bottom"===l?" selected":""}>Bottom</option>\n                                </select>\n                            </div>\n                        </div>\n                        <div class="sn-pivot-settings-section">\n                            <div class="sn-pivot-settings-section-title">Filter</div>\n                            <label class="sn-pivot-settings-option">\n                                <input type="checkbox" data-field="pivot-show-dropdowns"${h?" checked":""}>\n                                <span>Show Filter Button</span>\n                            </label>\n                            <label class="sn-pivot-settings-option">\n                                <input type="checkbox" data-field="pivot-show-all"${u?" checked":""}>\n                                <span>Include New Items</span>\n                            </label>\n                            <div class="sn-pivot-settings-row">\n                                <label>Sort</label>\n                                <select data-field="pivot-sort-type">\n                                    <option value="manual"${"manual"===c?" selected":""}>Manual</option>\n                                    <option value="ascending"${"ascending"===c?" selected":""}>Ascending</option>\n                                    <option value="descending"${"descending"===c?" selected":""}>Descending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="sn-pivot-settings-panel" data-panel="layout">\n                        <div class="sn-pivot-settings-section">\n                            <div class="sn-pivot-settings-section-title">Layout</div>\n                            <label class="sn-pivot-settings-option">\n                                <input type="radio" name="pivot-layout" value="compact"${"compact"===p?" checked":""}>\n                                <span>Compact Form</span>\n                            </label>\n                            <label class="sn-pivot-settings-option">\n                                <input type="radio" name="pivot-layout" value="outline"${"outline"===p?" checked":""}>\n                                <span>Outline Form</span>\n                            </label>\n                            <label class="sn-pivot-settings-option">\n                                <input type="radio" name="pivot-layout" value="tabular"${"tabular"===p?" checked":""}>\n                                <span>Tabular Form</span>\n                            </label>\n                        </div>\n                        <div class="sn-pivot-settings-section">\n                            <div class="sn-pivot-settings-section-title">Print</div>\n                            <label class="sn-pivot-settings-option">\n                                <input type="checkbox" data-field="pivot-repeat-labels"${d?" checked":""}>\n                                <span>Repeat All Item Labels</span>\n                            </label>\n                            <label class="sn-pivot-settings-option">\n                                <input type="checkbox" data-field="pivot-insert-blank"${f?" checked":""}>\n                                <span>Insert Blank Line After Each Item</span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            `,confirmKey:"core.layout.layout.modal.m001.confirm",confirmText:"OK",cancelKey:"core.layout.layout.modal.m001.cancel",cancelText:"Cancel",onOpen:t=>{const e=t.querySelectorAll(".sn-pivot-settings-tab"),n=t.querySelectorAll(".sn-pivot-settings-panel"),i=t.querySelector('[data-field="pivot-subtotal-position"]'),r=t.querySelectorAll('input[name="pivot-subtotal"]'),o=()=>{const e=t.querySelector('input[name="pivot-subtotal"]:checked')?.value||"auto";i&&(i.disabled="none"===e)};r.forEach(t=>{t.onchange=o}),o(),e.forEach(t=>{t.onclick=()=>{const i=t.dataset.tab;e.forEach(e=>e.classList.toggle("active",e===t)),n.forEach(t=>{t.classList.toggle("active",t.dataset.panel===i)})}})},onConfirm:e=>{const n=e.querySelector('[data-field="pivot-custom-name"]'),r=e.querySelector('input[name="pivot-subtotal"]:checked')?.value||"auto",a=e.querySelector('[data-field="pivot-subtotal-position"]')?.value||"top",s=e.querySelector('[data-field="pivot-sort-type"]')?.value||"manual",l=e.querySelector('[data-field="pivot-show-dropdowns"]')?.checked??!0,c=e.querySelector('[data-field="pivot-show-all"]')?.checked??!1,h=e.querySelector('[data-field="pivot-repeat-labels"]')?.checked??!1,u=e.querySelector('[data-field="pivot-insert-blank"]')?.checked??!1,d=e.querySelector('input[name="pivot-layout"]:checked')?.value||p,f=n?.value?.trim()||o;switch(i.name=f,i.defaultSubtotal="none"!==r,i.subtotalTop="top"===a,i.sortType=s,i.showDropDowns=l,i.showAll=c,i.repeatItemLabels=h,i.insertBlankRow=u,d){case"compact":t.compact=!0,t.compactData=!0,t.outline=!0,t.outlineData=!0;break;case"outline":t.compact=!1,t.compactData=!1,t.outline=!0,t.outlineData=!0;break;case"tabular":t.compact=!1,t.compactData=!1,t.outline=!1,t.outlineData=!1}t.cs=!0,t.calculate(),t.render(),this.Cy(t)}})}Oy(t,e){const n=this.SN,i=t.dataFields[e];if(!i)return;const r=i.fld,o=t.cache?.fields?.[r],a=t.pivotFields[r],s=o?.name||a?.name||`Field${r}`,l=i.name||i.getDefaultName(s,n),c=Object.entries($n.SUBTOTAL_MAP).map(([t,e])=>`<option value="${t}"${i.subtotal===t?" selected":""}>${n.t(e.labelKey)}</option>`).join(""),h=Object.entries($n.SHOW_DATA_AS_MAP).map(([t,e])=>`<option value="${t}"${i.showDataAs===t?" selected":""}>${n.t(e.labelKey)}</option>`).join(""),u=Array.from(new Set([...t.rowFields,...t.colFields,...i.baseField>=0?[i.baseField]:[]])),d=['<option value="-1">(None)</option>',...u.map(e=>{const n=t.pivotFields[e]?.name||t.cache?.fields?.[e]?.name||`Field${e}`;return`<option value="${e}"${i.baseField===e?" selected":""}>${n}</option>`})].join("");n.Utils.modal({titleKey:"core.layout.layout.modal.m002.title",title:"Value Field Settings",maxWidth:"480px",content:`\n                <div class="sn-pivot-settings">\n                    <div class="sn-pivot-settings-row">\n                        <label>Source Name</label>\n                        <div class="sn-pivot-settings-static">${s}</div>\n                    </div>\n                    <div class="sn-pivot-settings-row">\n                        <label>Custom Name</label>\n                        <input type="text" data-field="pivot-value-name" value="${l}">\n                    </div>\n                    <div class="sn-pivot-settings-tabs">\n                        <button type="button" class="sn-pivot-settings-tab active" data-tab="summary">Summarize Values By</button>\n                        <button type="button" class="sn-pivot-settings-tab" data-tab="showas">Show Values As</button>\n                    </div>\n                    <div class="sn-pivot-settings-panel active" data-panel="summary">\n                        <div class="sn-pivot-settings-section">\n                            <div class="sn-pivot-settings-section-title">Summarize Values By</div>\n                            <select data-field="pivot-value-subtotal">${c}</select>\n                        </div>\n                    </div>\n                    <div class="sn-pivot-settings-panel" data-panel="showas">\n                        <div class="sn-pivot-settings-section">\n                            <div class="sn-pivot-settings-section-title">Show Values As</div>\n                            <div class="sn-pivot-settings-row">\n                                <label>Show Values As</label>\n                                <select data-field="pivot-value-showas">${h}</select>\n                            </div>\n                            <div class="sn-pivot-settings-row">\n                                <label>Base Field</label>\n                                <select data-field="pivot-value-base-field">${d}</select>\n                            </div>\n                            <div class="sn-pivot-settings-row">\n                                <label>Base Item</label>\n                                <select data-field="pivot-value-base-item"></select>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `,confirmKey:"core.layout.layout.modal.m002.confirm",confirmText:"OK",cancelKey:"core.layout.layout.modal.m002.cancel",cancelText:"Cancel",onOpen:e=>{const n=e.querySelectorAll(".sn-pivot-settings-tab"),r=e.querySelectorAll(".sn-pivot-settings-panel"),o=e.querySelector('[data-field="pivot-value-showas"]'),a=e.querySelector('[data-field="pivot-value-base-field"]'),s=e.querySelector('[data-field="pivot-value-base-item"]'),l=()=>{const e=(e=>{if(null==e||e<0)return[];const n=t.pivotFields[e];return n?n.items.map((n,i)=>({index:i,text:t.Oi(e,n.x)||""})):[]})(Number(a.value)),n=e.map(t=>{const e=i.baseItem===t.index?" selected":"";return`<option value="${t.index}"${e}>${t.text||"(Blank)"}</option>`}).join(""),r=[`<option value="-1"${-1===i.baseItem?" selected":""}>(Previous item)</option>`,`<option value="-2"${-2===i.baseItem?" selected":""}>(Next item)</option>`].join("");if(s.innerHTML=r+n,!e.length){const t=i.baseItem>=0?" selected":"";s.innerHTML+=`<option value="0"${t}>(None)</option>`}},c=()=>{const t=o.value,e=!["normal","percentOfTotal","percentOfRow","percentOfCol"].includes(t);a.disabled=!e,s.disabled=!e,e?(Number(a.value)<0&&u.length>0&&(a.value=String(u[0])),l()):(a.value="-1",s.innerHTML='<option value="0">(None)</option>')};n.forEach(t=>{t.onclick=()=>{const e=t.dataset.tab;n.forEach(e=>e.classList.toggle("active",e===t)),r.forEach(t=>{t.classList.toggle("active",t.dataset.panel===e)})}}),o.onchange=c,a.onchange=l,c()},onConfirm:e=>{const r=e.querySelector('[data-field="pivot-value-name"]'),o=e.querySelector('[data-field="pivot-value-subtotal"]')?.value||i.subtotal,a=e.querySelector('[data-field="pivot-value-showas"]')?.value||i.showDataAs,l=Number(e.querySelector('[data-field="pivot-value-base-field"]')?.value??-1),c=Number(e.querySelector('[data-field="pivot-value-base-item"]')?.value??0);i.subtotal=o,i.showDataAs=a,["normal","percentOfTotal","percentOfRow","percentOfCol"].includes(a)?(i.baseField=-1,i.baseItem=0):(i.baseField=l,i.baseItem=c);const h=r?.value?.trim();i.name=h||i.getDefaultName(s,n),t.cs=!0,t.calculate(),t.render(),this.Cy(t)}})}ky(t,e,n,i="sum",r=-1){if(t.cache.fields[n])switch(e){case"row":t.rowFields.includes(n)||t.addRowField(n,r);break;case"column":t.colFields.includes(n)||t.addColField(n,r);break;case"value":t.addDataField(n,i||"sum",null,r);break;case"filter":t.pageFields.includes(n)||(-1===r||r>=t.pageFields.length?t.addPageField(n):(t.addPageField(n),this.Dy(t,"filter",n,r)))}}_y(t,e,n,i=null){switch(e){case"row":t.removeRowField(n);break;case"column":t.removeColField(n);break;case"value":if("number"!=typeof i||Number.isNaN(i)){const e=t.dataFields.findIndex(t=>t.fld===n);-1!==e&&t.removeDataField(e)}else t.removeDataField(i);break;case"filter":t.removePageField(n)}}Dy(t,e,n,i=-1){let r=null;switch(e){case"row":r=t.rowFields;break;case"column":r=t.colFields;break;case"filter":r=t.pageFields;break;default:return}const o=r.indexOf(n);if(-1===o)return;let a=i;(a<0||a>r.length)&&(a=r.length),a>o&&(a-=1),a!==o&&(r.splice(o,1),r.splice(a,0,n),t.cs=!0)}Ay(t,e){const n=t.cache?.fields?.[e],i=n?.sharedItems;if(i){const t=!0===i.containsNumber,e=!0===i.containsString,n=!0===i.containsDate;if(t&&!e&&!n)return"value"}return"row"}zy(t,e){const n=Array.from(t.querySelectorAll(".sn-pivot-zone-item"));if(0===n.length)return 0;const i=e.target.closest(".sn-pivot-zone-item");if(!i)return n.length;const r=i.getBoundingClientRect(),o=n.indexOf(i);return e.clientY<r.top+r.height/2?o:o+1}Ty(t,e){for(this._y(t,"row",e),this._y(t,"column",e);t.dataFields.some(t=>t.fld===e);)this._y(t,"value",e);this._y(t,"filter",e)}Ny(t){this.Ey||(t.calculate(),t.render())}Py=0;scrollSheetTabs(t){const e=this.SN.containerDom.querySelector(".sn-sheet-list"),n=this.SN.containerDom.querySelector(".sn-sheet-scroll");if(!e||!n)return;const i=Math.min(0,e.clientWidth-n.scrollWidth);this.Py+=-100*t,this.Py=Math.max(i,Math.min(0,this.Py)),n.style.transform=`translateX(${this.Py}px)`}Pg=null;updateContextualToolbar(t){const e=t?.type||null,n=t?.autoSwitch||!1;this.Kv=t?.data||null;const i=this.SN.containerDom.querySelector(".sn-menu-list");if(i){if(this.Pg===e&&!n)return"table"===e&&t?.data?this.Vy(t.data):"pivotTable"===e&&t?.data&&this.By(t.data),void this.ty();if(this.Pg=e,i.querySelectorAll(".sn-contextual-tab").forEach(t=>{t.style.display="none"}),e)i.querySelectorAll(`.sn-contextual-tab[data-context-type="${e}"]`).forEach((t,e)=>{t.style.display="",n&&0===e&&this.py(t)}),"table"===e&&t.data?this.Vy(t.data):"pivotTable"===e&&t.data&&this.By(t.data);else{const t=i.querySelector(".sn-menu-tab.active");if(t?.classList.contains("sn-contextual-tab")){t.classList.remove("active");const e=i.querySelector('.sn-menu-tab[data-panel="start"]');e&&this.py(e)}this.refreshToolbar()}this.ty()}}py(t){const e=t.parentElement,n=this.SN.containerDom.querySelector(".sn-tools"),i=t.dataset.panel;e.querySelectorAll(".sn-menu-tab").forEach(t=>t.classList.remove("active")),t.classList.add("active"),n.querySelectorAll(".sn-tools-panel").forEach(t=>t.classList.remove("active"));const r=n.querySelector(`.sn-tools-panel[data-panel="${i}"]`);r&&(this.eg&&this.eg.renderPanelIfNeeded(r)&&this.initColorComponents(r),r.classList.add("active"),"table"===this.Pg&&this.Kv?this.Vy(this.Kv):"pivotTable"===this.Pg&&this.Kv&&this.By(this.Kv)),this.refreshToolbar(),this.ty()}Vy(t){const e=this.SN.containerDom.querySelector(".sn-tools");if(!e)return;const n=e.querySelector('[data-field="tableName"]');n&&(n.value=t.displayName||t.name||"");const i={"tableHeaderRow":!0===t.showHeaderRow,"tableTotalsRow":!0===t.showTotalsRow,"tableRowStripes":t.showRowStripes,"tableColStripes":t.showColumnStripes,"tableFirstColumn":t.showFirstColumn,"tableLastColumn":t.showLastColumn,"tableAutoFilter":!0===t.autoFilterEnabled};for(const[r,o]of Object.entries(i)){const t=e.querySelector(`[data-field="${r}"]`);t&&(t.checked=o)}}Jg(t){if(!t)return;const e=this.SN.containerDom.querySelector(".sn-tools");if(!e)return;const n=e.querySelector('[data-field="pivotFieldList"]');if(n){const e=this.Dg&&this.Lg===t;n.classList.toggle("sn-btn-selected",e)}const i=e.querySelector('[data-field="pivotDrillButtons"]');i&&i.classList.toggle("sn-btn-selected",!1!==t.showDrill);const r=e.querySelector('[data-field="pivotFieldHeaders"]');if(r){const e=!1!==t.showRowHeaders&&!1!==t.showColHeaders;r.classList.toggle("sn-btn-selected",e)}}By(t){const e=this.SN.containerDom.querySelector(".sn-tools");if(!e)return;const n=e.querySelector('[data-field="pivotTableName"]');n&&(n.value=t.name||"");const i={"pivotRowHeaders":!1!==t.showRowHeaders,"pivotColHeaders":!1!==t.showColHeaders,"pivotRowStripes":!0===t.showRowStripes,"pivotColStripes":!0===t.showColStripes};for(const[r,o]of Object.entries(i)){const t=e.querySelector(`[data-field="${r}"]`);t&&(t.checked=o)}this.Jg(t)}J(t){var e;this.kg||(function(){let t=document.querySelector('meta[name="viewport"]');t||(t=document.createElement("meta"),t.name="viewport",document.head.appendChild(t)),t.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"}(),this.Hy(t),this.Uy(),this.Ky(),function(t){if(zD.has(t))return;zD.add(t);const e=t=>{t&&!t.classList.contains("closing")&&(t.classList.add("closing"),setTimeout(()=>{t.classList.remove("active","closing")},200))},n=t=>{if(!t||t.classList.contains("closing"))return;t.classList.add("closing");const e=setTimeout(()=>{t.classList.remove("active","closing"),OD.delete(t)},150);OD.set(t,e)};t.addEventListener("mousedown",n=>{if(n.target.closest(".sn-combobox"))return;const i=n.target.closest(".sn-dropdown-toggle");if(!i||!t.contains(i))return;const r=i.closest(".sn-item-disabled");if(r&&t.contains(r))return;n.preventDefault();const o=i.closest(".sn-dropdown"),a=o?.querySelector(".sn-dropdown-menu");if(!o||!a)return;const s=o.classList.contains("active"),l="true"===o.dataset.keepOpen;s?l||e(o):((n,i)=>{t.querySelectorAll(".sn-dropdown.active").forEach(t=>{t!==n&&e(t)}),LD(i),n.classList.add("active"),PD(i)})(o,a)},!0),t.addEventListener("click",n=>{if(n.target.closest(".sn-combobox"))return;const i=n.target.closest(".sn-dropdown-menu li");if(!i||!t.contains(i))return;const r=i.closest(".sn-item-disabled");if(r&&t.contains(r))return n.preventDefault(),void n.stopPropagation();if(i.classList.contains("sn-has-submenu"))return;if(i.classList.contains("sn-dropdown-divider"))return;i.closest(".sn-dropdown-submenu"),n.stopPropagation();const o=i.closest(".sn-dropdown");o&&"true"!==o.dataset.keepOpen&&e(o)}),t.addEventListener("mouseenter",e=>{const i=e.target.closest(".sn-has-submenu");if(!i||!t.contains(i))return;const r=i.querySelector(":scope > .sn-dropdown-submenu");if(!r)return;OD.has(r)&&(clearTimeout(OD.get(r)),OD.delete(r),r.classList.remove("closing"));const o=i.parentElement;o?.querySelectorAll(":scope > li > .sn-dropdown-submenu.active").forEach(t=>{t!==r&&n(t)}),function(t){t&&(t.style.left="",t.style.right="",t.style.top="",t.style.bottom="")}(r),r.classList.add("active"),function(t){if(!t)return;const e=t.getBoundingClientRect(),n=window.innerWidth,i=window.innerHeight;if(e.right>n-10&&(t.style.left="auto",t.style.right="100%"),e.bottom>i-10){const n=e.bottom-i+10;t.style.top=`-${n}px`}}(r)},!0),t.addEventListener("mouseleave",e=>{const i=e.target.closest(".sn-has-submenu");if(!i||!t.contains(i))return;const r=e.relatedTarget;if(r&&i.contains(r))return;const o=i.querySelector(":scope > .sn-dropdown-submenu");o&&n(o)},!0);let i=0,r=0,o=!1;document.addEventListener("touchstart",e=>{e.target.closest(".sn-dropdown-menu")&&t.contains(e.target)&&(i=e.touches[0].clientY,r=e.touches[0].clientX,o=!1)},{passive:!0}),document.addEventListener("touchmove",e=>{if(e.target.closest(".sn-dropdown-menu")&&t.contains(e.target)){const t=Math.abs(e.touches[0].clientY-i),n=Math.abs(e.touches[0].clientX-r);(t>10||n>10)&&(o=!0)}},{passive:!0});const a=n=>{if("touchend"===n.type&&o)return void(o=!1);if(n.target.closest(".sn-combobox")&&t.contains(n.target.closest(".sn-combobox")))return;const i=n.target.closest(".sn-dropdown-menu"),r=n.target.closest(".sn-dropdown-toggle");if(i&&t.contains(i)){const t=i.closest(".sn-dropdown");t?.dataset.keepOpen}else r&&t.contains(r)||t.querySelectorAll(".sn-dropdown.active").forEach(e)};window.addEventListener("click",a),window.addEventListener("touchend",a),window.addEventListener("resize",()=>{t.querySelectorAll(".sn-dropdown.active .sn-dropdown-menu").forEach(t=>{LD(t),PD(t)})});const s=n=>{if(n.classList.contains("active"))return;t.querySelectorAll(".sn-dropdown.active").forEach(t=>{t!==n&&e(t)});const i=n.querySelector(".sn-dropdown-menu");LD(i),n.classList.add("active"),PD(i)},l=t=>{const e=t.querySelector(".sn-dropdown-menu");e&&(e.querySelectorAll(".sn-dropdown-divider").forEach(t=>t.style.display=""),e.querySelectorAll("li:not(.sn-dropdown-divider)").forEach(t=>t.style.display=""))};t.addEventListener("mousedown",e=>{const n=e.target.closest(".sn-combobox-main");if(!n)return;const i=n.closest(".sn-combobox");if(!i||!t.contains(i))return;if(i.classList.contains("sn-item-disabled"))return;const r=i.querySelector(".sn-combobox-input");if(e.target===r)return e.stopPropagation(),l(i),void s(i);e.preventDefault(),e.stopPropagation(),l(i),s(i),r&&(r.focus(),r.setSelectionRange(r.value.length,r.value.length))}),t.addEventListener("mousedown",n=>{const i=n.target.closest(".sn-combobox-arrow");if(!i)return;const r=i.closest(".sn-combobox");r&&t.contains(r)&&(r.classList.contains("sn-item-disabled")||(n.preventDefault(),n.stopPropagation(),l(r),r.classList.contains("active")?e(r):s(r)))}),t.addEventListener("input",e=>{const n=e.target.closest(".sn-combobox-input");if(!n)return;const i=n.closest(".sn-combobox");i&&t.contains(i)&&(i.classList.contains("sn-item-disabled")||(s(i),((t,e)=>{const n=t.querySelector(".sn-dropdown-menu");if(!n)return;const i=e.toLowerCase().trim(),r=n.querySelectorAll("li:not(.sn-dropdown-divider)"),o=n.querySelectorAll(".sn-dropdown-divider");i?(o.forEach(t=>t.style.display="none"),r.forEach(t=>{t.style.display=t.textContent.toLowerCase().includes(i)?"":"none"})):l(t)})(i,n.value)))}),t.addEventListener("click",n=>{const i=n.target.closest(".sn-combobox");if(!i||!t.contains(i))return;if(i.classList.contains("sn-item-disabled"))return;const r=n.target.closest(".sn-dropdown-menu li");if(!r||r.classList.contains("sn-dropdown-divider"))return;n.stopPropagation();const o=i.querySelector(".sn-combobox-input");if(o){const t=r.querySelector("span")?.textContent||r.textContent;o.value=t.trim()}l(i),e(i)}),t.addEventListener("keydown",n=>{const i=n.target.closest(".sn-combobox-input");if(!i)return;const r=i.closest(".sn-combobox");if(r&&t.contains(r)&&!r.classList.contains("sn-item-disabled"))if("Enter"===n.key){n.preventDefault();const t=r.querySelector(".sn-dropdown-menu"),e=t?.querySelector('li:not(.sn-dropdown-divider):not([style*="display: none"])');e&&e.click()}else"Escape"===n.key&&(e(r),i.blur())})}(this.SN.containerDom),e=this.SN.containerDom,HD.has(e)||(HD.add(e),BD||(BD=document.createElement("div"),BD.className="sn-tooltip-container",BD.innerHTML='<div class="sn-tooltip-arrow"></div><div class="sn-tooltip-content"></div>',BD.setAttribute("data-placement","top"),BD.style.top="-9999px",BD.style.left="-9999px",document.body.appendChild(BD)),setTimeout(()=>{KD(e),function(t){const e=new MutationObserver(()=>{KD(t)});t&&e.observe(t,{childList:!0,subtree:!0})}(e)},0)),this.kg=!0)}Hy(t){const e=this.SN.namespace,n=this.menuConfig.right.html,i="function"==typeof this.rn.menuList?this.rn.menuList:null,{html:r,toolbarBuilder:o}=function(t,e,n=null,i=null){const r=(t,e="")=>{const i=n.t(t);return i===t&&e?e:i},o=new QI(t,n,i),a=o.buildPanelsOnly(),s=o.config,l=r("layout.zoomAverage"),c=r("layout.zoomCount"),h=r("layout.zoomSum"),u=s.map((t,e)=>{const i=!0===t.contextual,o=i?' style="display:none"':"",a=i?` data-context-type="${t.contextType||""}"`:"",s=t.labelKey?r(t.labelKey):n.t(t.text||t.key);return`<span class="sn-menu-tab${1===e?" active":""}${i?" sn-contextual-tab":""}" data-panel="${t.key}"${a}${o}>${s}</span>`}).join("");return{html:`\n            <main class="sn-main">\n                <header class="sn-menu">\n                    <div class="sn-menu-left">\n                        <span class="sn-menu-logo">${cn("sn_brandLogo")}</span>\n                        <span class="sn-file-name">${r("workbook.defaultName")}</span>\n                    </div>\n                    <div class="sn-menu-list">${u}</div>\n                    <div class="sn-menu-right">\n                        ${e}\n                    </div>\n                </header>\n                <div class="sn-tools">${a}</div>\n                <div class="sn-op">\n                    <div class="sn-chat">\n                        <div class="sn-chat-input">\n                            <div class="sn-chat-head d-flex justify-content-between align-items-center">\n                                &#x1F916; ${r("ai.panel.title","SheetNext AI")}\n                                <span onclick="${t}.Layout.showAIChatWindow=!${t}.Layout.showAIChatWindow" class="sn-svg-btn">${cn("xiaochuangbofang")}</span>\n                            </div>\n                            <div class="upImgList"></div>\n                            <textarea autocomplete="off" class="sn-prompt-input" rows="3" placeholder="${r("ai.panel.inputPlaceholder","Describe what to do with the sheet...")}"></textarea>\n                            <div class="input-btns">\n                                <button class="AI-btn sn-tooltip" onclick="${t}.AI.clearChat()" title="${r("ai.panel.resetContext","Reset Context")}">\n                                    ${cn("clear","sn-f16")}\n                                </button>\n                                <button class="AI-btn sn-tooltip" onclick="${t}.containerDom.querySelector('.sn-file-input').click()" title="${r("ai.panel.uploadImage","Upload Image")}">\n                                    ${cn("tupian1","fj-ico")}\n                                </button>\n                                <input type="file" class="sn-file-input" accept="image/*" style="display: none;" multiple onchange="${t}.AI.handleFileChange(event)">\n                                <button class="sn-send-btn" onclick="${t}.AI.conversation(${t}.containerDom.querySelector('.sn-prompt-input').value)">\n                                    ${cn("ai_send")}\n                                </button>\n                            </div>\n                        </div>\n                        <div class="sn-chat-info">\n                            <div class="dryd chat-system" onclick="${t}.containerDom.querySelector('.sn-upload').click()">\n                                <span style="font-size:20px;line-height:1;display:inline-flex;">${cn("ai_quickImport")}</span>\n                                <span>${r("ai.panel.quickImport")}</span>\n                            </div>\n                            <div class="chat-system sn-chat-examples">\n                                <div class="sn-chat-examples-header">\n                                    <span class="sn-chat-examples-title">&#x1F4A1; ${r("ai.panel.examplesTitle")}</span>\n                                </div>\n                                <ul>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item1")}</li>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item2")}</li>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item3")}</li>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item4")}</li>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item5")}</li>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item6")}</li>\n                                    <li onclick="${t}.AI.chatInput(this.innerText);">${r("ai.panel.examples.item7")}</li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="sn-content">\n                        <div class="sn-input">\n                            <span class="sn-ai-btn sn-text-center" onclick="${t}.Layout.showAIChat=!${t}.Layout.showAIChat">&#x1F916;</span>\n                            <div class="sn-area-box">\n                                <input type="text" class="sn-area-input" value="A1">\n                                <span class="sn-area-arrow"></span>\n                                <div class="sn-area-dropdown"></div>\n                            </div>\n                            <div class="formulaBarBox">\n                                <div class="sn-color-999 sn-text-center op-btns">\n                                    <span class="sn-cur sn-op-cancel">${cn("cuowu")}</span>&nbsp;\n                                    <span class="sn-cur sn-op-confirm">${cn("queding")}</span>&nbsp;\n                                    <span class="sn-cur sn-op-fun" onclick="${t}.Action.openFormulaDialog('all')">${cn("gongshi1")}</span>\n                                </div>\n                                <textarea autocomplete="off" rows="1" class="sn-formula-bar" placeholder=""></textarea>\n                            </div>\n                        </div>\n                        <div class="sn-analysis">\n                            <div class="sn-canvas">\n                                <div class="sn-loading-div">\n                                    <div class="spinner-border sn-text-primary" role="status">\n                                        <span class="visually-hidden">Loading...</span>\n                                    </div>\n                                    <div class="f14 sn-color-999">Loading editor...</div>\n                                </div>\n                                <canvas class="sn-show-layer" width="0" height="0"></canvas>\n                                <div class="sn-middle-layer">\n                                    <div class="sn-drawings-con"></div>\n                                </div>\n                                <canvas class="sn-handle-layer"></canvas>\n                                <div class="sn-top-layer">\n                                    <div class="sn-slicers-con"></div>\n                                    <div class="sn-roll-y"><div></div></div>\n                                    <div class="sn-roll-x"><div></div></div>\n                                    <div class="sn-input-editor" contenteditable="true" tabindex="0" style="z-index: -1; opacity: 0; pointer-events: none;"></div>\n                                </div>\n                            </div>\n                            <div class="sn-sheets">\n                                <div class="sn-sheet-left">\n                                    <span class="sn-sheets-btn" onclick="${t}.Layout.scrollSheetTabs(-1)" title="Scroll Left">${cn("arrow-left")}</span>\n                                    <span class="sn-sheets-btn" onclick="${t}.Layout.scrollSheetTabs(1)" title="Scroll Right">${cn("arrow-right")}</span>\n                                    <span class="sn-sheets-btn" onmousedown="${t}.activeSheet = ${t}.addSheet();" ontouchstart="${t}.activeSheet = ${t}.addSheet();" title="New Sheet">${cn("plus")}</span>\n                                    <div class="sn-dropdown sn-sheet-dropdown">\n                                        <span class="sn-sheets-btn sn-dropdown-toggle sn-no-icon" onmousedown="${t}.Action.moreSheet(this)" ontouchstart="${t}.Action.moreSheet(this)" title="All Sheets">${cn("gengduo")}</span>\n                                        <ul class="sn-dropdown-menu sn-sheet-menu"></ul>\n                                    </div>\n                                </div>\n                                <div class="sn-sheet-list">\n                                    <div class="sn-sheet-scroll">\n                                        <button class="sheet-sel">Sheet1</button>\n                                    </div>\n                                </div>\n                                <div class="sn-sheet-right">\n                                    <span class="sn-stat-item" data-stat="avg" title="${l}">${l}: -</span>\n                                    <span class="sn-stat-item" data-stat="count" title="${c}">${c}: -</span>\n                                    <span class="sn-stat-item" data-stat="sum" title="${h}">${h}: -</span>\n                                    <div class="sn-dropdown">\n                                        <span class="sn-sheets-btn sn-dropdown-toggle">${cn("dangqianhangliegaoliang")}</span>\n                                        <ul class="sn-dropdown-menu sn-highlight-menu">${o.buildHighlightMenuHTML()}</ul>\n                                    </div>\n                                    <span class="sn-sheets-btn" onclick="${t}.Action.fullScreen()" title="Full Screen">${cn("fullscreen")}</span>\n                                    <div class="sn-zoom-ctrl">\n                                        <span class="sn-sheets-btn" title="Zoom Out">${cn("minus")}</span>\n                                        <span class="sn-zoom-val">100%</span>\n                                        <span class="sn-sheets-btn" title="Zoom In">${cn("plus")}</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="sn-pivot-panel">\n                        <div class="sn-pivot-header">\n                            <span class="sn-pivot-title">PivotTable Fields</span>\n                            <div class="sn-pivot-header-btns">\n                                <button class="sn-pivot-header-btn" data-action="settings" title="Settings">⚙</button>\n                                <button class="sn-pivot-header-btn" data-action="close" title="Close">✕</button>\n                            </div>\n                        </div>\n                        <div class="sn-pivot-search">\n                            <input type="text" class="sn-pivot-search-input" placeholder="Search fields...">\n                        </div>\n                        <div class="sn-pivot-fields">\n                            <div class="sn-pivot-fields-header">Choose fields to add to the report:</div>\n                            <div class="sn-pivot-fields-list"></div>\n                        </div>\n                        <div class="sn-pivot-drop-hint">Drag fields between these areas:</div>\n                        <div class="sn-pivot-drop-zones">\n                            <div class="sn-pivot-zone" data-zone="filter">\n                                <div class="sn-pivot-zone-header">Filter</div>\n                                <div class="sn-pivot-zone-list"></div>\n                            </div>\n                            <div class="sn-pivot-zone" data-zone="column">\n                                <div class="sn-pivot-zone-header">Columns</div>\n                                <div class="sn-pivot-zone-list"></div>\n                            </div>\n                            <div class="sn-pivot-zone" data-zone="row">\n                                <div class="sn-pivot-zone-header">Rows</div>\n                                <div class="sn-pivot-zone-list"></div>\n                            </div>\n                            <div class="sn-pivot-zone" data-zone="value">\n                                <div class="sn-pivot-zone-header">Values</div>\n                                <div class="sn-pivot-zone-list"></div>\n                            </div>\n                        </div>\n                        <div class="sn-pivot-footer">\n                            <label class="sn-pivot-delay-update">\n                                <input type="checkbox">\n                                <span>Defer Layout Update</span>\n                            </label>\n                            <button class="sn-pivot-update-btn">Update</button>\n                        </div>\n                    </div>\n                </div>\n            </main>\n            <input type="file" accept=".xlsx,.csv,.json" class="sn-upload" hidden="hidden" />\n        `,toolbarBuilder:o}}(e,n,this.SN,i);this.eg=o,o.setSN(this.SN),t.insertAdjacentHTML("afterbegin",r)}Uy(){this.snHead=this.SN.containerDom.querySelector(".sn-menu"),this.snTools=this.SN.containerDom.querySelector(".sn-tools"),this.snFormulaBar=this.SN.containerDom.querySelector(".sn-input"),this.snSheetTabBar=this.SN.containerDom.querySelector(".sn-sheets"),this.snChat=this.SN.containerDom.querySelector(".sn-chat"),this.snMain=this.SN.containerDom.querySelector(".sn-main"),this.snOp=this.SN.containerDom.querySelector(".sn-op"),this.snCanvas=this.SN.containerDom.querySelector(".sn-canvas"),this.snPivotPanel=this.SN.containerDom.querySelector(".sn-pivot-panel")}Ky(){this.initResizeObserver(),this.initDragEvents(),this.initColorComponents(),this.SN.Action?.initToolbarDefaults&&this.SN.Action.initToolbarDefaults(),this.initEventListeners(),this.removeLoading(),function(t,e,n){const i=t.querySelector(".sn-tools"),r=t.querySelector(".sn-menu-list");if(!i||!r)return;const o=t=>{const e=t.target.closest(".sn-item-disabled");e&&i.contains(e)&&(t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation())};i.addEventListener("mousedown",o,!0),i.addEventListener("click",o,!0),i.addEventListener("dblclick",o,!0),r.addEventListener("click",o=>{const a=o.target.closest(".sn-menu-tab");if(!a)return;const s=a.dataset.panel;r.querySelectorAll(".sn-menu-tab").forEach(t=>t.classList.remove("active")),a.classList.add("active"),i.querySelectorAll(".sn-tools-panel").forEach(t=>t.classList.remove("active"));const l=i.querySelector(`.sn-tools-panel[data-panel="${s}"]`);l&&(e&&e.renderPanelIfNeeded(l)&&n&&n(l),l.classList.add("active"),(t=>{if(!e?.SN)return;const n=t.querySelectorAll('input[type="checkbox"]'),i=e.config;n.forEach(t=>{const n=t.dataset.field,r=function(t,e){for(const n of t)for(const t of n.groups||[])for(const n of t.items||[]){if("checkbox"===n.type&&n.id===e)return n;if("stack"===n.type&&n.items){const t=n.items.find(t=>"checkbox"===t.type&&t.id===e);if(t)return t}if("row"===n.type&&n.items){const t=n.items.find(t=>"checkbox"===t.type&&t.id===e);if(t)return t}}return null}(i,n);r&&("function"==typeof r.checked&&(t.checked=!!r.checked(e.SN)),"function"==typeof r.disabled?t.disabled=!!r.disabled(e.SN):void 0!==r.disabled&&(t.disabled=!!r.disabled))})})(l),aF(t,e),e?.SN?.Layout?.refreshToolbar?.(),e?.SN?.Layout?.ty?.())}),e&&i.addEventListener("mousedown",t=>{if(t.target.closest(".sn-item-disabled"))return;const n=t.target.closest(".sn-dropdown-toggle");if(!n)return;const i=n.closest(".sn-dropdown");if(!i)return;const r=i.querySelector(".sn-dropdown-menu[data-lazy-menu]");r&&!r.dataset.lazyLoaded&&(r.innerHTML=e.buildMenuHTML(r.dataset.lazyMenu),r.dataset.lazyLoaded="true")},!0),function(t,e){t.addEventListener("mousedown",t=>{const n=t.target.closest(".sn-combobox");if(!n)return;if(n.classList.contains("sn-item-disabled"))return;const i=n.querySelector(".sn-combobox-input"),r=n.querySelector(".sn-dropdown-menu");if(!i||!r)return;const o=i.value.trim(),a=e.__sheetNextInstance.t("toolbar.numFmt.custom");r.querySelectorAll("li").forEach(t=>{t.classList.remove("sn-selected");const e=t.dataset.value||t.textContent.trim();(e===o||o===a&&e.startsWith(a))&&t.classList.add("sn-selected")})},!0),t.addEventListener("click",t=>{const e=t.target.closest(".sn-combobox .sn-dropdown-menu > li");if(!e||e.classList.contains("sn-dropdown-divider"))return;const n=e.closest(".sn-combobox");if(!n||n.classList.contains("sn-item-disabled"))return;const i=n?.querySelector(".sn-combobox-input");if(i){if("fontName"===n.dataset.menu){const t=e.dataset.value||e.querySelector("span")?.textContent?.trim();i.style.fontFamily=t}n.querySelector(".sn-dropdown-menu").querySelectorAll("li").forEach(t=>t.classList.remove("sn-selected")),e.classList.add("sn-selected")}},!0)}(i,t)}(this.SN.containerDom,this.eg,t=>{this.initColorComponents(t)}),this.uy(),this.my(),this.ly(this.SN.containerDom.offsetWidth),this.ty()}}Object.assign(XD.prototype,{initResizeObserver:function(){"undefined"!=typeof ResizeObserver&&(this.qg=new ResizeObserver(t=>{this.throttleResize()}),this.qg.observe(this.SN.containerDom))},throttleResize:function(){this.Gg&&clearTimeout(this.Gg),this.Gg=setTimeout(()=>{this.handleAllResize(),this.Gg=null},100)},handleAllResize:function(){const t=this.SN.containerDom.offsetWidth,e=this.SN.containerDom.offsetHeight,n=this.isSmallWindow;this.Xg===t&&this.Yg===e||(this.Xg=t,this.Yg=e),this.jg!==n&&(this.jg=n,n&&this.Fg&&!this.zg&&(this.showAIChat=!1)),this.ly?.(t),this.ty?.(),this.updateCanvasSize()},updateCanvasSize:function(){this.SN.Canvas?.viewResize(),this.SN.Canvas?.r()},initDragEvents:function(){const t=this.snChat.querySelector(".sn-chat-head");t&&t.addEventListener("mousedown",t=>{if(!this.showAIChatWindow)return;const e=t.target?.closest?t.target:t.target?.parentElement;if(!e)return;if(e.closest(".sn-svg-btn"))return;const n=t.clientX,i=t.clientY,r=function(t,e,n){const i=e.left-t.left,r=e.top-t.top;return{minX:-i,minY:-r,maxX:t.width-n.width-i,maxY:t.height-n.height-r,opOffsetX:i,opOffsetY:r}}(this.snMain.getBoundingClientRect(),this.snOp.getBoundingClientRect(),this.snChat.getBoundingClientRect()),o=t=>{let e=t.clientX-n,o=t.clientY-i;const a=jD(this.chatWindowOffsetX+e,this.chatWindowOffsetY+o,r);this.snChat.style.transform=`translate(${a.x}px, ${a.y}px)`},a=t=>{this.chatWindowOffsetX+=t.clientX-n,this.chatWindowOffsetY+=t.clientY-i;const e=jD(this.chatWindowOffsetX,this.chatWindowOffsetY,r);this.chatWindowOffsetX=e.x,this.chatWindowOffsetY=e.y,window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",a)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",a)})},initEventListeners:function(){const t=this.SN.containerDom.querySelector(".sn-prompt-input");t&&t.addEventListener("paste",t=>{const e=t.clipboardData||window.clipboardData;e&&this.SN.AI.Wy(e)});const e=this.SN.containerDom.querySelector(".sn-upload");e&&e.addEventListener("change",async t=>{this.SN.IO.import(t.target.files[0])});const n=this.SN.containerDom.querySelector(".sn-zoom-ctrl");if(n){const t=this.SN,e=n.querySelector('[data-icon="minus"]')?.closest(".sn-sheets-btn"),i=n.querySelector('[data-icon="plus"]')?.closest(".sn-sheets-btn"),r=n.querySelector(".sn-zoom-val");e?.addEventListener("click",()=>t.activeSheet?.zoomOut()),i?.addEventListener("click",()=>t.activeSheet?.zoomIn()),r?.addEventListener("click",()=>t.Action.zoomCustom())}},initColorComponents:function(t){const e=function(t){const e=t.t("color.noColor"),n=t.t("color.themeColors"),i=t.t("color.standardColors"),r=t.t("color.moreColors");let o=`\n        <div class="sn-color-section">\n            <div class="sn-color-no-btn">${e}</div>\n        </div>\n        <div class="sn-color-section">\n            <div class="sn-color-label">${n}</div>\n            <div class="sn-color-grid">`;return WD.common.forEach(t=>{o+=`<div class="sn-color-item" data-color="${t}" style="background:${t}"></div>`}),o+=`</div>\n        </div>\n        <div class="sn-color-section">\n            <div class="sn-color-label">${i}</div>\n            <div class="sn-color-grid">`,WD.standard.forEach(t=>{o+=`<div class="sn-color-item" data-color="${t}" style="background:${t}"></div>`}),o+=`</div>\n        </div>\n        <div class="sn-color-section sn-color-more">\n            <div class="sn-color-label">${r}</div>\n            <input type="color" class="sn-color-input" value="#336699">\n        </div>`,o}(this.SN);this.SN.ns,(t||this.SN.containerDom).querySelectorAll(".sn-color-select").forEach(t=>{if(t.dataset.colorInit)return;t.innerHTML=e,t.dataset.colorInit="true";const n=t.querySelector(".sn-color-input");if(n){const e=t.getAttribute("onclick")||"";let i=null;e.includes("fontColorBtn")?i=t=>{t.stopPropagation(),this.SN.Action.fontColorChange(t)}:e.includes("fillColorBtn")?i=t=>{t.stopPropagation(),this.SN.Action.fillColorChange(t)}:e.includes("borderColorBtn")&&(i=t=>{t.stopPropagation(),this.SN.Action.borderColorChange(t)}),i&&n.addEventListener("input",i),n.addEventListener("click",t=>t.stopPropagation())}})},removeLoading:function(){const t=()=>{const t=this.SN.containerDom.querySelector(".sn-loading-div");t&&t.remove()};"complete"===document.readyState?t():window.addEventListener("load",t)}});const YD={insertRows(t,e,n=1){t.addRows(e,n)},insertCols(t,e,n=1){t.addCols(e,n)},deleteRows(t,e,n=1){t.delRows(e,n)},deleteCols(t,e,n=1){t.delCols(e,n)},hideRows(t,e,n){for(let i=e;i<=n;i++)t.getRow(i).hidden=!0},hideCols(t,e,n){for(let i=e;i<=n;i++)t.getCol(i).hidden=!0},unhideRows(t,e,n){for(let i=e;i<=n;i++)t.getRow(i).hidden=!1},unhideCols(t,e,n){for(let i=e;i<=n;i++)t.getCol(i).hidden=!1},unhideAllRows(t){t.rows.forEach(t=>{t?.hidden&&(t.hidden=!1)})},unhideAllCols(t){t.cols.forEach(t=>{t?.hidden&&(t.hidden=!1)})},setRowsHeight(t,e,n,i){for(let r=e;r<=n;r++)t.getRow(r).height=i},setColsWidth(t,e,n,i){for(let r=e;r<=n;r++)t.getCol(r).width=i},autoFitRowsHeight(t,e,n){const i=document.createElement("canvas").getContext("2d"),r=[],o=new Map,a=new Map,s=new Map,l=t=>{const e=t.size||11,n=t.name||"微软雅黑",i=t.bold?"bold":"",r=t.italic?"italic":"",a=`${n}|${e}|${i}|${r}`;let s=o.get(a);return s||(s=`${i?"bold ":""}${r?"italic ":""}${e}pt ${n}`,o.set(a,s)),{key:a,str:s,size:e}},c=(t,e,n)=>{const r=`${t}|${n}`;if(a.has(r))return a.get(r);i.font=e;const o=i.measureText(n).width;return a.set(r,o),o};for(let h=e;h<=n;h++){const e=t.rows[h];if(!e||!e.cells?.length)continue;let n=t.defaultRowHeight,i=!1;if(e.cells.forEach((e,r)=>{if(!e)return;const o=e.showVal;if(!o)return;i=!0;const a=e.style?.font||{},{key:h,str:u,size:d}=l(a),f=s.has(r)?s.get(r):t.cols[r]?.Nt??t.defaultColWidth;s.set(r,f);const p=String(o).split("\n");let m=0;for(const t of p){const e=c(h,u,t);m+=Math.max(1,Math.ceil(e/Math.max(1,f-8)))*(1.5*d)}n=Math.max(n,m+6)}),!i)continue;const o=Math.round(n);o!==e.Mt&&(r.push({row:e,newHeight:o,oldHeight:e.Mt}),e.Mt=o)}r.length>0&&t.SN.UndoRedo.add({undo:()=>r.forEach(({row:t,oldHeight:e})=>t.Mt=e),redo:()=>r.forEach(({row:t,newHeight:e})=>t.Mt=e)})},autoFitColsWidth(t,e,n){const i=document.createElement("canvas").getContext("2d"),r=[],o=new Map,a=new Map,s=new Map,l=(t,e,n)=>{const r=`${t}|${n}`;if(a.has(r))return a.get(r);i.font=e;const o=i.measureText(n).width;return a.set(r,o),o};t.rows.forEach(t=>{t&&t.cells?.length&&t.cells.forEach((t,i)=>{if(!t||i<e||i>n)return;const r=t.showVal;if(!r)return;const a=t.style?.font||{},{key:c,str:h}=(t=>{const e=t.size||11,n=t.name||"微软雅黑",i=t.bold?"bold":"",r=t.italic?"italic":"",a=`${n}|${e}|${i}|${r}`;let s=o.get(a);return s||(s=`${i?"bold ":""}${r?"italic ":""}${e}pt ${n}`,o.set(a,s)),{key:a,str:s}})(a),u=String(r).split("\n");let d=s.get(i)||0;for(const e of u){const t=l(c,h,e)+16;t>d&&(d=t)}d>0&&s.set(i,d)})}),s.forEach((e,n)=>{const i=t.getCol(n),o=Math.min(Math.round(e),500);o!==i.Nt&&(r.push({col:i,newWidth:o,oldWidth:i.Nt}),i.Nt=o)}),r.length>0&&t.SN.UndoRedo.add({undo:()=>r.forEach(({col:t,oldWidth:e})=>t.Nt=e),redo:()=>r.forEach(({col:t,newWidth:e})=>t.Nt=e)})}};function ZD(t){const e=t.activeSheet.activeAreas;return e[e.length-1]}function JD(t){const e=t.activeSheet.activeAreas;return Array.isArray(e)&&e.length>0?e:[{s:t.activeSheet.activeCell,e:t.activeSheet.activeCell}]}function QD(t,e){const n=e.every(e=>0===e?.s?.r&&e?.e?.r===t.rowCount-1),i=e.some(e=>0!==e?.s?.c||e?.e?.c!==t.colCount-1);return n&&i?"col":"row"}function tL(t){return new Promise((e,n)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=n,i.readAsDataURL(t)})}function eL(t,e){const{s:n,e:i}=t,r=0===n.c&&i.c===e.colCount-1,o=0===n.r&&i.r===e.rowCount-1,a=[],s=[];if(r)for(let l=n.r;l<=i.r;l++)a.push(l);if(o)for(let l=n.c;l<=i.c;l++)s.push(l);return{isFullRow:r,isFullCol:o,rows:a,cols:s}}const nL=[{key:"tab",labelKey:"action.format.content.textToColumns.delimiter.tab",value:"\t"},{key:"semicolon",labelKey:"action.format.content.textToColumns.delimiter.semicolon",value:";"},{key:"comma",labelKey:"action.format.content.textToColumns.delimiter.comma",value:","},{key:"space",labelKey:"action.format.content.textToColumns.delimiter.space",value:" "}];function iL(t){return t?.s&&t?.e?{s:{r:Math.min(t.s.r,t.e.r),c:Math.min(t.s.c,t.e.c)},e:{r:Math.max(t.s.r,t.e.r),c:Math.max(t.s.c,t.e.c)}}:null}function rL(t,e){const n=(t,n)=>e.t(t,n);return`\n        <div class="sn-text-to-columns-dialog">\n            <div class="sn-form-group">\n                <label>${n("action.format.content.textToColumns.delimiter.label")}</label>\n                <div class="sn-text-to-columns-delimiters">\n                    ${nL.map((t,e)=>`\n                        <label class="sn-delimiter-item">\n                            <input type="checkbox" data-field="delimiter" data-key="${t.key}"${2===e?" checked":""}>\n                            <span>${n(t.labelKey)}</span>\n                        </label>\n                    `).join("")}\n                    <label class="sn-delimiter-item">\n                        <input type="checkbox" data-field="delimiter" data-key="other">\n                        <span>${n("action.format.content.textToColumns.delimiter.other")}</span>\n                    </label>\n                    <input class="sn-text-to-columns-other-input" type="text" data-field="other-delimiter" maxlength="1" placeholder="${n("action.format.content.textToColumns.otherPlaceholder")}">\n                </div>\n            </div>\n            <div class="sn-form-group sn-form-group-toggle">\n                <label class="sn-inline-toggle">\n                    <input type="checkbox" data-field="merge-consecutive">\n                    <span>${n("action.format.content.textToColumns.mergeConsecutive")}</span>\n                </label>\n            </div>\n            <div class="sn-form-group">\n                <label>${n("action.format.content.textToColumns.textQualifierLabel")}</label>\n                <select data-field="text-qualifier">\n                    <option value="&quot;">${n("action.format.content.textToColumns.textQualifier.doubleQuote")}</option>\n                    <option value="'">${n("action.format.content.textToColumns.textQualifier.singleQuote")}</option>\n                    <option value="none">${n("action.format.content.textToColumns.textQualifier.none")}</option>\n                </select>\n            </div>\n            <div class="sn-form-group">\n                <label>${n("action.format.content.textToColumns.destinationLabel")}</label>\n                <input type="text" data-field="destination" value="${t}" placeholder="${n("action.format.content.textToColumns.destinationPlaceholder")}">\n            </div>\n        </div>\n    `}const oL={column:"bar_clustered",bar:"barh_clustered",line:"line_basic",pie:"pie_basic",doughnut:"pie_doughnut",area:"area_basic",scatter:"scatter_basic",radar:"radar_basic",histogram:"histogram_basic"},aL=new Set(["bar","histogram","line","area","pie","scatter","radar","stock","sunburst","treemap","funnel","waterfall","combo"]),sL={line:"action.insert.content.sparkline.type.line",column:"action.insert.content.sparkline.type.column",win_loss:"action.insert.content.sparkline.type.winLoss"},lL={horizontal:{width:160,height:90},vertical:{width:90,height:160}};function cL(t){return`\n        <div class="sn-chart-modal">\n            <div class="sn-chart-tabs">${t.map(t=>`<span class="sn-chart-tab" data-category="${t.key}">${t.text}</span>`).join("")}</div>\n            <div class="sn-chart-panels">${t.map(t=>{const e=t.items.map(e=>`<div class="sn-chart-item" data-category="${t.key}" data-item="${e.key}" title="${e.text}">\n                <div class="sn-chart-preview">${wI(e.key)}</div>\n                <div class="sn-chart-item-label">${e.text}</div>\n            </div>`).join("");return`<div class="sn-chart-panel" data-category="${t.key}">${e}</div>`}).join("")}</div>\n        </div>\n    `}function hL(t){const e=String(t||"").trim().toLowerCase();return e?"stacked"===e||"winloss"===e||"win-loss"===e||"win_loss"===e?"win_loss":"column"===e||"line"===e?e:"line":"line"}function uL(t){const e=hL(t);return"win_loss"===e?"stacked":e}function dL(t,e){const n=Number(t);return Number.isFinite(n)?n:e}function fL(t){return t.includes(" ")?`'${t}'`:t}function pL(t,e,n){return`${fL(t.name)}!${t.Utils.cellNumToStr({r:e,c:n})}`}function mL(t,e,n,i,r){return`${fL(t.name)}!${t.Utils.cellNumToStr({r:e,c:n})}:${t.Utils.cellNumToStr({r:i,c:r})}`}function gL(t,e=0){return Array.isArray(t)?t.map((t,n)=>"number"==typeof t?t:"string"==typeof t?dL(t,e):Array.isArray(t)?dL(t.length>1?t[1]:t[0],e):t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"value")?dL(t.value,e):e):[]}function vL(t,e,n=0,i=null){const r=gL(e[n]?.data);return(t||[]).map((t,e)=>({name:String(t??(i?i.t("action.insert.content.chart.defaultItem",{index:e+1}):`Item ${e+1}`)),value:r[e]??0}))}function yL(t,e){const n=e.map(t=>String(t).toLowerCase());return t.find(t=>{const e=String(t?.name??"").toLowerCase();return n.some(t=>e.includes(t))})||null}function bL(t,e,n,i){const r=vL(e,n,0),o="treemap"===i?{top:40,left:"center",data:e}:{show:!1};return{title:{text:t.label},tooltip:{trigger:"item"},legend:o,series:[{name:t.label,type:i,data:r}]}}const xL="SN_WORKBOOK",wL=4718592;function SL(t){return t<1024?t+" B":t<1048576?(t/1024).toFixed(1)+" KB":(t/1024/1024).toFixed(2)+" MB"}const CL=new Map,TL=new Map;function $L(t){t.size>1e3&&Array.from(t.keys()).slice(0,Math.floor(500)).forEach(e=>t.delete(e))}function ML(t){if(!t)return"";if(TL.has(t))return TL.get(t);let e=t;if(9===t.length&&t.startsWith("#")){const n=parseInt(t.slice(1,3),16)/255;e=`rgba(${parseInt(t.slice(3,5),16)},${parseInt(t.slice(5,7),16)},${parseInt(t.slice(7,9),16)},${n.toFixed(2)})`}return TL.set(t,e),e}function AL(t){try{const e=JSON.stringify({font:t.font,fill:t.fill,border:t.border,alignment:t.alignment});if(CL.has(e))return CL.get(e);$L(CL);const n=[];if(t.fill?.fgColor&&n.push(`background-color:${ML(t.fill.fgColor)}`),t.font?.color&&n.push(`color:${ML(t.font.color)}`),t.font){const e=t.font,i=e.italic?"italic":"normal",r=e.bold?"bold":"normal",o=e.size?`${Number(e.size).toFixed(2)}pt`:"11.00pt",a=e.name||"Arial";if(n.push(`font:${i} ${r} ${o} ${a}`),e.underline||e.strike){const t=[];e.underline&&t.push("underline"),e.strike&&t.push("line-through"),n.push(`text-decoration:${t.join(" ")}`)}}const i=t.alignment?.wrapText;if(n.push("white-space:"+(i?"normal":"nowrap")),t.alignment?.vertical){const e="center"===t.alignment.vertical?"middle":"bottom"===t.alignment.vertical?"bottom":"top";n.push(`vertical-align:${e}`)}if(t.alignment?.horizontal){const e="center"===t.alignment.horizontal?"center":"right"===t.alignment.horizontal?"right":"left";n.push(`text-align:${e}`)}if(t.border){const e=t.border;["top","right","bottom","left"].forEach(t=>{if(e[t]){const i=e[t].style||"thin",r=ML(e[t].color)||"#000",o="medium"===i?"1.5pt":"thick"===i?"2.25pt":"0.75pt";n.push(`border-${t}:${o} solid ${r}`)}})}n.push("mso-number-format:General");const r=n.join(";\n");return CL.set(e,r),r}catch(t){return""}}const NL=new Map;function kL(t){try{if(NL.has(t))return NL.get(t);$L(NL);const e=document.createElement("div");e.style.cssText="position:absolute;left:-9999px;top:-9999px;visibility:hidden;",document.body.appendChild(e),e.innerHTML=t;const n=e.querySelector("table");if(!n)return document.body.removeChild(e),NL.set(t,null),null;const i={data:[],styles:[],merges:[]},r=n.querySelectorAll("tr");let o=0;return r.forEach(t=>{const e=t.querySelectorAll("td, th");if(0===e.length)return;let n=0;e.forEach(t=>{const e=t.textContent||"",r=function(t){try{const e=window.getComputedStyle(t),n={},i={};("bold"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(i.bold=!0),"italic"===e.fontStyle&&(i.italic=!0);const r=e.textDecoration||"";if(r.includes("underline")&&(i.underline="single"),r.includes("line-through")&&(i.strike=!0),e.fontSize){const t=parseFloat(e.fontSize);t&&(i.size=Math.round(.75*t))}const o=e.color;o&&"rgb(0, 0, 0)"!==o&&"rgba(0, 0, 0, 0)"!==o&&(i.color=RL(o)),e.fontFamily&&(i.name=e.fontFamily.replace(/["']/g,"").split(",")[0].trim()),Object.keys(i).length>0&&(n.font=i);const a=e.backgroundColor;a&&"rgba(0, 0, 0, 0)"!==a&&"transparent"!==a&&(n.fill={type:"pattern",pattern:"solid",fgColor:RL(a)});const s={};["top","right","bottom","left"].forEach(t=>{const n=e[`border${t.charAt(0).toUpperCase()+t.slice(1)}Style`];if(n&&"none"!==n){const n=e[`border${t.charAt(0).toUpperCase()+t.slice(1)}Color`],i=e[`border${t.charAt(0).toUpperCase()+t.slice(1)}Width`];s[t]={style:parseFloat(i)>1.5?"medium":"thin",color:RL(n)}}}),Object.keys(s).length>0&&(n.border=s);const l={},c=e.textAlign;c&&"start"!==c&&"left"!==c&&(l.horizontal=c);const h=e.verticalAlign;h&&"baseline"!==h&&(l.vertical="middle"===h?"center":h);const u=e.whiteSpace;return"normal"!==u&&"pre-wrap"!==u||(l.wrapText=!0),Object.keys(l).length>0&&(n.alignment=l),n}catch(t){return{}}}(t),a=parseInt(t.getAttribute("rowspan")||t.getAttribute("rowSpan"))||1,s=parseInt(t.getAttribute("colspan")||t.getAttribute("colSpan"))||1;(a>1||s>1)&&i.merges.push({s:{r:o,c:n},e:{r:o+a-1,c:n+s-1}});for(let l=0;l<a;l++)for(let t=0;t<s;t++){const a=o+l,s=n+t;for(;i.data.length<=a;)i.data.push([]),i.styles.push([]);i.data[a][s]=0===l&&0===t?e:"",i.styles[a][s]=r}n+=s}),o++}),document.body.removeChild(e),NL.set(t,i),i}catch(t){return document.querySelectorAll('div[style*="position:absolute"][style*="left:-9999px"]').forEach(t=>{t.parentNode&&document.body.removeChild(t)}),null}}function RL(t){if(!t||"transparent"===t)return null;const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return e?"#"+((1<<24)+(parseInt(e[1])<<16)+(parseInt(e[2])<<8)+parseInt(e[3])).toString(16).slice(1).toUpperCase():t.startsWith("#")?t:null}function _L(t){return"string"!=typeof t?t:t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function IL(t,e){try{const n=function(t,e){try{const n=new Map,i=new Map;let r=1;for(let s=e.s.r;s<=e.e.r;s++)for(let o=e.s.c;o<=e.e.c;o++){const e=t.getCell(s,o);if(e.isMerged&&e.master&&(e.master.r!==s||e.master.c!==o))continue;const a=AL(e);n.has(a)||n.set(a,"sjs"+r++),i.set(`${s}-${o}`,{value:_L(e.showVal??""),className:n.get(a),cell:e})}const o=[];n.forEach((t,e)=>{o.push(`.${t}{\n${e}\n}`)});const a=[];for(let s=e.s.r;s<=e.e.r;s++){const n=[];for(let r=e.s.c;r<=e.e.c;r++){const e=i.get(`${s}-${r}`);if(!e)continue;const o=e.cell;let a=1,l=1;if(o.isMerged&&o.master&&o.master.r===s&&o.master.c===r){const e=t.merges.find(t=>t.s.r===s&&t.s.c===r);e&&(a=e.e.c-e.s.c+1,l=e.e.r-e.s.r+1)}const c=a>1?` colSpan=${a}`:"",h=l>1?` rowSpan=${l}`:"";n.push(`<td${h}${c} class="${e.className}">${e.value}</td>`)}n.length>0?a.push(`<tr>${n.join("")}</tr>`):a.push("<tr></tr>")}return`<html>\n<head>\n<style>\n${o.join("\n")}\n</style>\n</head>\n<body>\n<table gc-sjs-clipboard="true" style="min-width:1px;min-height:1px;">${a.join("")}</table>\n</body>\n</html>`}catch(t){return"<table></table>"}}(t,e),i=function(t,e){try{const n=[];for(let i=e.s.r;i<=e.e.r;i++){const r=[];for(let n=e.s.c;n<=e.e.c;n++)r.push(t.getCell(i,n).editVal??"");n.push(r.join("\t"))}return n.join("\r\n")}catch(t){return""}}(t,e),r=new ClipboardItem({"text/html":new Blob([n],{type:"text/html"}),"text/plain":new Blob([i],{type:"text/plain"})});navigator.clipboard.write([r]).catch(t=>{navigator.clipboard.writeText(i)})}catch(t){}}const FL=[{labelKey:"action.condFormat.content.preset.lightRedText",fill:"#FFC7CE",font:"#9C0006"},{labelKey:"action.condFormat.content.preset.yellowText",fill:"#FFEB9C",font:"#9C6500"},{labelKey:"action.condFormat.content.preset.greenText",fill:"#C6EFCE",font:"#006100"},{labelKey:"action.condFormat.content.preset.lightRed",fill:"#FFC7CE",font:null},{labelKey:"action.condFormat.content.preset.yellow",fill:"#FFEB9C",font:null},{labelKey:"action.condFormat.content.preset.green",fill:"#C6EFCE",font:null}],EL={greaterThan:"action.condFormat.content.operator.greaterThan",lessThan:"action.condFormat.content.operator.lessThan",between:"action.condFormat.content.operator.between",equal:"action.condFormat.content.operator.equal",notEqual:"action.condFormat.content.operator.notEqual",greaterThanOrEqual:"action.condFormat.content.operator.greaterThanOrEqual",lessThanOrEqual:"action.condFormat.content.operator.lessThanOrEqual"},DL={today:"action.condFormat.content.timePeriod.today",yesterday:"action.condFormat.content.timePeriod.yesterday",tomorrow:"action.condFormat.content.timePeriod.tomorrow",last7Days:"action.condFormat.content.timePeriod.last7Days",lastWeek:"action.condFormat.content.timePeriod.lastWeek",thisWeek:"action.condFormat.content.timePeriod.thisWeek",nextWeek:"action.condFormat.content.timePeriod.nextWeek",lastMonth:"action.condFormat.content.timePeriod.lastMonth",thisMonth:"action.condFormat.content.timePeriod.thisMonth",nextMonth:"action.condFormat.content.timePeriod.nextMonth"};function LL(t){return FL.map(e=>({...e,label:t.t(e.labelKey)}))}async function PL(t,e){const n=this.SN,i="between"===e,r=function(t,e){const n=EL[e];return n?t.t(n):e}(n,e),o=LL(n),a=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${n.t("action.condFormat.content.cellIs.description",{title:r})}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <input type="text" class="sn-cf-form-input" data-field="cf-value1" placeholder="${n.t("action.condFormat.content.cellIs.value1Placeholder")}">\n                ${i?`<span>${n.t("action.condFormat.content.cellIs.and")}</span><input type="text" class="sn-cf-form-input" data-field="cf-value2" placeholder="${n.t("action.condFormat.content.cellIs.value2Placeholder")}">`:""}\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${n.t("action.condFormat.content.setTo")}</span>\n                <select class="sn-cf-form-select" data-field="cf-preset">\n                    ${o.map((t,e)=>`<option value="${e}">${t.label}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${n.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview">AaBbCc</div>\n            </div>\n        </div>\n    `,s=await n.Utils.modal({titleKey:"action.condFormat.modal.m001.title",title:n.t("action.condFormat.content.modalTitle",{title:r}),content:a,confirmKey:"action.condFormat.modal.m001.confirm",confirmText:n.t("action.condFormat.modal.m001.confirm"),cancelKey:"action.condFormat.modal.m001.cancel",cancelText:n.t("action.condFormat.modal.m001.cancel"),onOpen:t=>{const e=t.querySelector('[data-field="cf-preset"]'),n=t.querySelector('[data-field="cf-preview"]'),i=()=>{const t=o[e.value];n.style.background=t.fill,n.style.color=t.font||"#000"};e.addEventListener("change",i),i()}});if(!s)throw"cancel";const l=s.bodyEl,c=l.querySelector('[data-field="cf-value1"]')?.value?.trim(),h=l.querySelector('[data-field="cf-value2"]')?.value?.trim(),u=l.querySelector('[data-field="cf-preset"]')?.value||0,d=o[u];if(!c)throw n.Utils.toast(n.t("action.condFormat.toast.msg002")),"cancel";n.activeSheet.CF.add({rangeRef:t,type:"cellIs",operator:e,formula1:tP(c),formula2:i?tP(h):null,dxf:{fill:{fgColor:d.fill},font:d.font?{color:d.font}:null}}),n.ue()}async function zL(t,e){const n=this.SN,i=LL(n),r=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${n.t("action.condFormat.content.containsText.description")}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <input type="text" class="sn-cf-form-input" data-field="cf-text" placeholder="${n.t("action.condFormat.content.containsText.placeholder")}">\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${n.t("action.condFormat.content.setTo")}</span>\n                <select class="sn-cf-form-select" data-field="cf-preset">\n                    ${i.map((t,e)=>`<option value="${e}">${t.label}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${n.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview">AaBbCc</div>\n            </div>\n        </div>\n    `,o=await n.Utils.modal({titleKey:"action.condFormat.modal.m002.title",title:n.t("action.condFormat.content.modalTitle",{title:n.t("action.condFormat.content.title.containsText")}),content:r,confirmKey:"action.condFormat.modal.m002.confirm",confirmText:n.t("action.condFormat.modal.m002.confirm"),cancelKey:"action.condFormat.modal.m002.cancel",cancelText:n.t("action.condFormat.modal.m002.cancel"),onOpen:t=>{const e=t.querySelector('[data-field="cf-preset"]'),n=t.querySelector('[data-field="cf-preview"]'),r=()=>{const t=i[e.value];n.style.background=t.fill,n.style.color=t.font||"#000"};e.addEventListener("change",r),r()}});if(!o)throw"cancel";const a=o.bodyEl,s=a.querySelector('[data-field="cf-text"]')?.value?.trim(),l=i[a.querySelector('[data-field="cf-preset"]').value];if(!s)throw n.Utils.toast(n.t("action.condFormat.toast.msg003")),"cancel";n.activeSheet.CF.add({rangeRef:t,type:"containsText",text:s,dxf:{fill:{fgColor:l.fill},font:l.font?{color:l.font}:null}}),n.ue()}async function OL(t){const e=this.SN,n=function(t){return Object.entries(DL).map(([e,n])=>[e,t.t(n)])}(e),i=LL(e),r=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.timePeriod.description")}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <select class="sn-cf-form-select" data-field="cf-period" style="width:100%">\n                    ${n.map(([t,e])=>`<option value="${t}">${e}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.setTo")}</span>\n                <select class="sn-cf-form-select" data-field="cf-preset">\n                    ${i.map((t,e)=>`<option value="${e}">${t.label}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${e.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview">AaBbCc</div>\n            </div>\n        </div>\n    `,o=await e.Utils.modal({titleKey:"action.condFormat.modal.m003.title",title:e.t("action.condFormat.content.modalTitle",{title:e.t("action.condFormat.content.title.timePeriod")}),content:r,confirmKey:"action.condFormat.modal.m003.confirm",confirmText:e.t("action.condFormat.modal.m003.confirm"),cancelKey:"action.condFormat.modal.m003.cancel",cancelText:e.t("action.condFormat.modal.m003.cancel"),onOpen:t=>{const e=t.querySelector('[data-field="cf-preset"]'),n=t.querySelector('[data-field="cf-preview"]'),r=()=>{const t=i[e.value];n.style.background=t.fill,n.style.color=t.font||"#000"};e.addEventListener("change",r),r()}});if(!o)throw"cancel";const a=o.bodyEl,s=a.querySelector('[data-field="cf-period"]').value,l=i[a.querySelector('[data-field="cf-preset"]').value];e.activeSheet.CF.add({rangeRef:t,type:"timePeriod",timePeriod:s,dxf:{fill:{fgColor:l.fill},font:l.font?{color:l.font}:null}}),e.ue()}async function BL(t){const e=this.SN,n=LL(e),i=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.duplicate.description")}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <select class="sn-cf-form-select" data-field="cf-duptype" style="width:100%">\n                    <option value="duplicateValues">${e.t("action.condFormat.content.duplicate.duplicateValues")}</option>\n                    <option value="uniqueValues">${e.t("action.condFormat.content.duplicate.uniqueValues")}</option>\n                </select>\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.setTo")}</span>\n                <select class="sn-cf-form-select" data-field="cf-preset">\n                    ${n.map((t,e)=>`<option value="${e}">${t.label}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${e.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview">AaBbCc</div>\n            </div>\n        </div>\n    `,r=await e.Utils.modal({titleKey:"action.condFormat.modal.m004.title",title:e.t("action.condFormat.content.modalTitle",{title:e.t("action.condFormat.content.title.duplicate")}),content:i,confirmKey:"action.condFormat.modal.m004.confirm",confirmText:e.t("action.condFormat.modal.m004.confirm"),cancelKey:"action.condFormat.modal.m004.cancel",cancelText:e.t("action.condFormat.modal.m004.cancel"),onOpen:t=>{const e=t.querySelector('[data-field="cf-preset"]'),i=t.querySelector('[data-field="cf-preview"]'),r=()=>{const t=n[e.value];i.style.background=t.fill,i.style.color=t.font||"#000"};e.addEventListener("change",r),r()}});if(!r)throw"cancel";const o=r.bodyEl,a=o.querySelector('[data-field="cf-duptype"]').value,s=n[o.querySelector('[data-field="cf-preset"]').value];e.activeSheet.CF.add({rangeRef:t,type:a,dxf:{fill:{fgColor:s.fill},font:s.font?{color:s.font}:null}}),e.ue()}async function VL(t,e){const n=this.SN,i=e.includes("bottom"),r=e.includes("Percent"),o=LL(n),a=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${n.t("action.condFormat.content.top10.descriptionPrefix",{target:n.t(i?"action.condFormat.content.top10.min":"action.condFormat.content.top10.max")})}</span>\n                <input type="number" class="sn-cf-form-input" data-field="cf-rank" value="10" min="1" max="1000" style="width:60px">\n                <span>${r?"%":n.t("action.condFormat.content.top10.items")}</span>\n                <span>${n.t("action.condFormat.content.top10.setFormat")}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${n.t("action.condFormat.content.setTo")}</span>\n                <select class="sn-cf-form-select" data-field="cf-preset">\n                    ${o.map((t,e)=>`<option value="${e}">${t.label}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${n.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview">AaBbCc</div>\n            </div>\n        </div>\n    `,s=i?r?"action.condFormat.modal.m005.titleBottomPercent":"action.condFormat.modal.m005.titleBottomItems":r?"action.condFormat.modal.m005.titleTopPercent":"action.condFormat.modal.m005.titleTopItems",l=await n.Utils.modal({titleKey:s,title:n.t(s),content:a,confirmKey:"action.condFormat.modal.m005.confirm",cancelKey:"action.condFormat.modal.m005.cancel",onOpen:t=>{const e=t.querySelector('[data-field="cf-preset"]'),n=t.querySelector('[data-field="cf-preview"]'),i=()=>{const t=o[e.value];n.style.background=t.fill,n.style.color=t.font||"#000"};e.addEventListener("change",i),i()}});if(!l)throw"cancel";const c=l.bodyEl,h=parseInt(c.querySelector('[data-field="cf-rank"]').value)||10,u=o[c.querySelector('[data-field="cf-preset"]').value];n.activeSheet.CF.add({rangeRef:t,type:"top10",rank:h,percent:r,bottom:i,dxf:{fill:{fgColor:u.fill},font:u.font?{color:u.font}:null}}),n.ue()}async function HL(t){const e=this.SN,n=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.dataBar.fillType")}</span>\n                <select class="sn-cf-form-select" data-field="cf-bartype">\n                    <option value="gradient">${e.t("action.condFormat.content.dataBar.gradient")}</option>\n                    <option value="solid">${e.t("action.condFormat.content.dataBar.solid")}</option>\n                </select>\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.dataBar.barColor")}</span>\n                <input type="color" data-field="cf-barcolor" value="#638EC6">\n            </div>\n            <div class="sn-cf-form-row">\n                <label><input type="checkbox" data-field="cf-showvalue" checked> ${e.t("action.condFormat.content.dataBar.showValue")}</label>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${e.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview" style="position:relative;overflow:hidden;">\n                    <div data-field="cf-bar-preview" style="position:absolute;left:0;top:0;height:100%;width:70%;opacity:0.8"></div>\n                    <span style="position:relative">75</span>\n                </div>\n            </div>\n        </div>\n    `,i=await e.Utils.modal({titleKey:"action.condFormat.modal.m006.title",title:e.t("action.condFormat.content.modalTitle",{title:e.t("action.condFormat.content.title.dataBar")}),content:n,confirmKey:"action.condFormat.modal.m006.confirm",confirmText:e.t("action.condFormat.modal.m006.confirm"),cancelKey:"action.condFormat.modal.m006.cancel",cancelText:e.t("action.condFormat.modal.m006.cancel")});if(!i)throw"cancel";const r=i.bodyEl,o=r.querySelector('[data-field="cf-bartype"]').value,a=r.querySelector('[data-field="cf-barcolor"]').value,s=r.querySelector('[data-field="cf-showvalue"]').checked;XL.call(this,t,"gradient"===o,a,s)}async function UL(t){const e=this.SN,n=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.colorScale.type")}</span>\n                <select class="sn-cf-form-select" data-field="cf-scaletype">\n                    <option value="2">${e.t("action.condFormat.content.colorScale.twoColors")}</option>\n                    <option value="3">${e.t("action.condFormat.content.colorScale.threeColors")}</option>\n                </select>\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.colorScale.minColor")}</span>\n                <input type="color" data-field="cf-color-min" value="#F8696B">\n            </div>\n            <div class="sn-cf-form-row" data-field="cf-mid-row" style="display:none">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.colorScale.midColor")}</span>\n                <input type="color" data-field="cf-color-mid" value="#FFEB84">\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.colorScale.maxColor")}</span>\n                <input type="color" data-field="cf-color-max" value="#63BE7B">\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${e.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview" style="height:24px"></div>\n            </div>\n        </div>\n    `,i=await e.Utils.modal({titleKey:"action.condFormat.modal.m007.title",title:e.t("action.condFormat.content.modalTitle",{title:e.t("action.condFormat.content.title.colorScale")}),content:n,confirmKey:"action.condFormat.modal.m007.confirm",confirmText:e.t("action.condFormat.modal.m007.confirm"),cancelKey:"action.condFormat.modal.m007.cancel",cancelText:e.t("action.condFormat.modal.m007.cancel")});if(!i)throw"cancel";const r=i.bodyEl,o=r.querySelector('[data-field="cf-scaletype"]').value,a=r.querySelector('[data-field="cf-color-min"]').value,s=r.querySelector('[data-field="cf-color-mid"]').value,l=r.querySelector('[data-field="cf-color-max"]').value,c="3"===o?[a,s,l]:[a,l];YL.call(this,t,c)}async function qL(t){const e=this.SN,n=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.iconSet.style")}</span>\n                <select class="sn-cf-form-select" data-field="cf-iconset" style="width:100%">\n                    ${["3Arrows","3ArrowsGray","3Triangles","4Arrows","4ArrowsGray","5Arrows","5ArrowsGray","3TrafficLights1","3TrafficLights2","4TrafficLights","3Signs","4RedToBlack","3Symbols","3Symbols2","3Flags","3Stars","4Rating","5Rating","5Quarters","5Boxes"].map(t=>`<option value="${t}">${t}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-form-row">\n                <label><input type="checkbox" data-field="cf-reverse"> ${e.t("action.condFormat.content.iconSet.reverse")}</label>\n            </div>\n            <div class="sn-cf-form-row">\n                <label><input type="checkbox" data-field="cf-showvalue" checked> ${e.t("action.condFormat.content.iconSet.showValue")}</label>\n            </div>\n        </div>\n    `,i=await e.Utils.modal({titleKey:"action.condFormat.modal.m008.title",title:e.t("action.condFormat.content.modalTitle",{title:e.t("action.condFormat.content.title.iconSet")}),content:n,confirmKey:"action.condFormat.modal.m008.confirm",confirmText:e.t("action.condFormat.modal.m008.confirm"),cancelKey:"action.condFormat.modal.m008.cancel",cancelText:e.t("action.condFormat.modal.m008.cancel")});if(!i)throw"cancel";const r=i.bodyEl,o=r.querySelector('[data-field="cf-iconset"]').value,a=r.querySelector('[data-field="cf-reverse"]').checked,s=r.querySelector('[data-field="cf-showvalue"]').checked;ZL.call(this,t,o,a,s)}async function KL(t){const e=this.SN,n=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.newRule.selectType")}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <select class="sn-cf-form-select" data-field="cf-ruletype" style="width:100%">\n                    <option value="cellIs">${e.t("action.condFormat.content.newRule.cellIs")}</option>\n                    <option value="containsText">${e.t("action.condFormat.content.newRule.containsText")}</option>\n                    <option value="top10">${e.t("action.condFormat.content.newRule.top10")}</option>\n                    <option value="aboveAverage">${e.t("action.condFormat.content.newRule.aboveAverage")}</option>\n                    <option value="duplicateValues">${e.t("action.condFormat.content.newRule.duplicateValues")}</option>\n                    <option value="dataBar">${e.t("action.condFormat.content.newRule.dataBar")}</option>\n                    <option value="colorScale">${e.t("action.condFormat.content.newRule.colorScale")}</option>\n                    <option value="iconSet">${e.t("action.condFormat.content.newRule.iconSet")}</option>\n                    <option value="expression">${e.t("action.condFormat.content.newRule.expression")}</option>\n                </select>\n            </div>\n        </div>\n    `,i=await e.Utils.modal({titleKey:"action.condFormat.modal.m009.title",title:e.t("action.condFormat.modal.m009.title"),content:n,confirmKey:"action.condFormat.modal.m009.confirm",confirmText:e.t("action.condFormat.modal.m009.confirm"),cancelKey:"action.condFormat.modal.m009.cancel",cancelText:e.t("action.condFormat.modal.m009.cancel")});if(!i)throw"cancel";switch(i.bodyEl.querySelector('[data-field="cf-ruletype"]').value){case"cellIs":await PL.call(this,t,"greaterThan");break;case"containsText":await zL.call(this,t,"containsText");break;case"top10":await VL.call(this,t,"top");break;case"aboveAverage":GL.call(this,t,"above");break;case"duplicateValues":await BL.call(this,t);break;case"dataBar":await HL.call(this,t);break;case"colorScale":await UL.call(this,t);break;case"iconSet":await qL.call(this,t);break;case"expression":await WL.call(this,t)}}async function WL(t){const e=this.SN,n=LL(e),i=`\n        <div class="sn-cf-form">\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.expression.description")}</span>\n            </div>\n            <div class="sn-cf-form-row">\n                <input type="text" class="sn-cf-form-input" data-field="cf-formula" placeholder="=A1>100">\n            </div>\n            <div class="sn-cf-form-row">\n                <span class="sn-cf-form-label">${e.t("action.condFormat.content.setTo")}</span>\n                <select class="sn-cf-form-select" data-field="cf-preset">\n                    ${n.map((t,e)=>`<option value="${e}">${t.label}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-cf-preview-box">\n                <span class="sn-cf-preview-label">${e.t("action.condFormat.content.preview")}</span>\n                <div class="sn-cf-preview-cell" data-field="cf-preview">AaBbCc</div>\n            </div>\n        </div>\n    `,r=await e.Utils.modal({titleKey:"action.condFormat.modal.m010.title",title:e.t("action.condFormat.content.modalTitle",{title:e.t("action.condFormat.content.title.expression")}),content:i,confirmKey:"action.condFormat.modal.m010.confirm",confirmText:e.t("action.condFormat.modal.m010.confirm"),cancelKey:"action.condFormat.modal.m010.cancel",cancelText:e.t("action.condFormat.modal.m010.cancel")});if(!r)throw"cancel";const o=r.bodyEl,a=o.querySelector('[data-field="cf-formula"]')?.value?.trim(),s=n[o.querySelector('[data-field="cf-preset"]').value];if(!a)throw e.Utils.toast(e.t("action.condFormat.toast.msg004")),"cancel";e.activeSheet.CF.add({rangeRef:t,type:"expression",formula:a,dxf:{fill:{fgColor:s.fill},font:s.font?{color:s.font}:null}}),e.ue()}async function jL(){const t=this.SN,e=t.activeSheet.CF,n=e.getAll();if(0===n.length)return void t.Utils.toast(t.t("action.condFormat.toast.msg005"));const i=`\n        <div class="sn-cf-rule-list">\n            ${n.map((e,n)=>`\n                <div class="sn-cf-rule-item" data-index="${n}" data-sqref="${e.sqref}" data-priority="${e.priority}">\n                    <div class="sn-cf-rule-info">\n                        <div class="sn-cf-rule-type">${(e=>{const n={cellIs:"action.condFormat.content.ruleType.cellIs",colorScale:"action.condFormat.content.ruleType.colorScale",dataBar:"action.condFormat.content.ruleType.dataBar",iconSet:"action.condFormat.content.ruleType.iconSet",containsText:"action.condFormat.content.ruleType.containsText",duplicateValues:"action.condFormat.content.ruleType.duplicateValues",uniqueValues:"action.condFormat.content.ruleType.uniqueValues",top10:"action.condFormat.content.ruleType.top10",aboveAverage:"action.condFormat.content.ruleType.aboveAverage",timePeriod:"action.condFormat.content.ruleType.timePeriod",expression:"action.condFormat.content.ruleType.expression"}[e.type];return n?t.t(n):e.type})(e)}</div>\n                        <div class="sn-cf-rule-range">${t.t("action.condFormat.content.manage.appliesTo",{sqref:e.sqref})}</div>\n                    </div>\n                    <div class="sn-cf-rule-actions">\n                        <button class="sn-cf-rule-btn danger" data-action="delete">${t.t("action.condFormat.content.manage.delete")}</button>\n                    </div>\n                </div>\n            `).join("")}\n        </div>\n    `;await t.Utils.modal({titleKey:"action.condFormat.modal.m011.title",title:t.t("action.condFormat.modal.m011.title"),content:i,maxWidth:"400px",confirmKey:"action.condFormat.modal.m011.confirm",confirmText:t.t("action.condFormat.modal.m011.confirm"),onOpen:n=>{n.addEventListener("click",n=>{const i=n.target.closest('[data-action="delete"]');if(i){const n=i.closest(".sn-cf-rule-item"),r=parseInt(n.dataset.priority),o=e.rules.findIndex(t=>t.priority===r);-1!==o&&(e.remove(o),n.remove(),t.ue())}})}})}function GL(t,e){const n=this.SN,i=FL["above"===e?2:0];n.activeSheet.CF.add({rangeRef:t,type:"aboveAverage",aboveAverage:"above"===e,dxf:{fill:{fgColor:i.fill},font:i.font?{color:i.font}:null}}),n.ue()}function XL(t,e,n,i=!0){const r=this.SN;r.activeSheet.CF.add({rangeRef:t,type:"dataBar",color:n,gradient:e,showValue:i,minCfvo:{type:"min"},maxCfvo:{type:"max"}}),r.ue()}function YL(t,e){const n=this.SN,i=n.activeSheet.CF,r=2===e.length?[{type:"min"},{type:"max"}]:[{type:"min"},{type:"percentile",val:50},{type:"max"}];i.add({rangeRef:t,type:"colorScale",cfvos:r,colors:e}),n.ue()}function ZL(t,e,n=!1,i=!0){const r=this.SN,o=r.activeSheet.CF,a=e.startsWith("5")?5:e.startsWith("4")?4:3,s=[];for(let l=0;l<a;l++)s.push({type:"percent",val:Math.round(l/a*100)});o.add({rangeRef:t,type:"iconSet",iconSet:e,cfvos:s,reverse:n,showValue:i}),r.ue()}function JL(t){const e=this.SN;e.activeSheet.CF.removeAll(t),e.ue(),e.Utils.toast(e.t("action.condFormat.toast.msg006"))}function QL(){const t=this.SN,e=t.activeSheet.CF,n=e.getAll();[...new Set(n.map(t=>t.sqref))].forEach(t=>e.removeAll(t)),t.ue(),t.Utils.toast(t.t("action.condFormat.toast.msg007"))}function tP(t){if(!t)return null;const e=parseFloat(t);return isNaN(e)?t:e}function eP(t,e,n){const i=t.map(t=>`<option value="${t.key}"${t.key===e?" selected":""}>${n.t(t.labelKey)}</option>`).join("");return`\n        <div class="sn-formula-dialog">\n            <div class="sn-formula-row">\n                <label>${n.t("action.formula.content.searchLabel")}</label>\n                <input type="text" class="sn-formula-search-input" placeholder="${n.t("action.formula.content.searchPlaceholder")}">\n            </div>\n            <div class="sn-formula-row">\n                <label>${n.t("action.formula.content.categoryLabel")}</label>\n                <select class="sn-formula-category-select">${i}</select>\n            </div>\n            <div class="sn-formula-row sn-formula-row-list">\n                <label>${n.t("action.formula.content.functionLabel")}</label>\n                <div class="sn-formula-list"></div>\n            </div>\n            <div class="sn-formula-detail">\n                <div class="sn-formula-detail-title"></div>\n                <div class="sn-formula-detail-desc"></div>\n                <div class="sn-formula-detail-meta"></div>\n            </div>\n        </div>\n    `}function nP(t,e,n){const i=t.querySelector(".sn-formula-detail-title"),r=t.querySelector(".sn-formula-detail-desc"),o=t.querySelector(".sn-formula-detail-meta");if(!e)return i.textContent="",r.textContent="",void(o.textContent="");i.textContent=`${e.name}(...)`,r.textContent=/[\u4e00-\u9fff]/.test(e.desc||"")?n.t("action.formula.content.noDescription"):e.desc||"",o.textContent=[e.categoryLabelKey&&`${n.t("action.formula.content.detail.category")}: ${n.t(e.categoryLabelKey)}`,e.version&&`${n.t("action.formula.content.detail.version")}: ${e.version}`].filter(Boolean).join(" · ")}function iP(t,e,n){return t.length?t.map((t,i)=>{const r=t.comment??t.Comment??"",o=t.scope||"workbook";return`\n            <tr class="sn-nm-row${t.name===e||!e&&0===i?" active":""}" data-name="${t.name}">\n                <td class="sn-nm-cell-name">${t.name}</td>\n                <td class="sn-nm-cell-value" title="${t.value||""}">${t.value||""}</td>\n                <td class="sn-nm-cell-ref" title="${t.ref||""}">${t.ref||""}</td>\n                <td class="sn-nm-cell-scope">${function(t,e){return"workbook"===t?e("action.nameManager.content.scope.workbook"):t}(o,n)}</td>\n                <td class="sn-nm-cell-comment" title="${r}">${r}</td>\n            </tr>\n        `}).join(""):`<tr><td colspan="5" class="sn-nm-empty">${n("action.nameManager.content.empty")}</td></tr>`}function rP(t,e,n){const i=`\n        <option value="all" selected>${n("action.nameManager.content.scope.all")}</option>\n        <option value="workbook">${n("action.nameManager.content.scope.workbook")}</option>\n    `,r=iP(t,t[0]?.name||"",n);return`\n        <div class="sn-name-manager">\n            <div class="sn-nm-toolbar">\n                <button class="sn-nm-btn sn-nm-btn-new">${n("action.nameManager.content.button.new")}</button>\n                <button class="sn-nm-btn sn-nm-btn-edit" disabled>${n("action.nameManager.content.button.edit")}</button>\n                <button class="sn-nm-btn sn-nm-btn-delete" disabled>${n("action.nameManager.content.button.delete")}</button>\n                <div class="sn-nm-filter">\n                    <label>${n("action.nameManager.content.filterLabel")}</label>\n                    <select class="sn-nm-filter-select">${i}</select>\n                </div>\n            </div>\n            <div class="sn-nm-table-wrap">\n                <table class="sn-nm-table">\n                    <thead>\n                        <tr>\n                            <th style="width:120px">${n("action.nameManager.content.column.name")}</th>\n                            <th style="width:100px">${n("action.nameManager.content.column.value")}</th>\n                            <th style="width:140px">${n("action.nameManager.content.column.ref")}</th>\n                            <th style="width:80px">${n("action.nameManager.content.column.scope")}</th>\n                            <th>${n("action.nameManager.content.column.comment")}</th>\n                        </tr>\n                    </thead>\n                    <tbody>${r}</tbody>\n                </table>\n            </div>\n            <div class="sn-nm-footer">\n                <label>${n("action.nameManager.content.refLabel")}</label>\n                <input type="text" class="sn-nm-ref-input" readonly>\n            </div>\n        </div>\n    `}function oP(t,e,n){const{name:i="",scope:r="workbook",comment:o="",ref:a=""}=t,s=[`<option value="workbook"${"workbook"===r?" selected":""}>${n("action.nameManager.content.scope.workbook")}</option>`,...e.map(t=>`<option value="${t.name}"${r===t.name?" selected":""}>${t.name}</option>`)].join("");return`\n        <div class="sn-define-name">\n            <div class="sn-dn-row">\n                <label>${n("action.nameManager.content.form.nameLabel")}</label>\n                <input type="text" class="sn-dn-name" value="${i}" placeholder="${n("action.nameManager.content.form.namePlaceholder")}">\n            </div>\n            <div class="sn-dn-row">\n                <label>${n("action.nameManager.content.form.scopeLabel")}</label>\n                <select class="sn-dn-scope">${s}</select>\n            </div>\n            <div class="sn-dn-row">\n                <label>${n("action.nameManager.content.form.commentLabel")}</label>\n                <input type="text" class="sn-dn-comment" value="${o}" placeholder="${n("action.nameManager.content.form.commentPlaceholder")}">\n            </div>\n            <div class="sn-dn-row">\n                <label>${n("action.nameManager.content.form.refLabel")}</label>\n                <input type="text" class="sn-dn-ref" value="${a}" placeholder="${n("action.nameManager.content.form.refPlaceholder")}">\n            </div>\n        </div>\n    `}function aP(){const t=this.SN.yn||{};return Object.entries(t).map(([t,e])=>({name:t,ref:e,value:"",scope:"workbook",comment:""}))}function sP(t){return t.og||(t.og={precedents:[],dependents:[]}),t.og}function lP(t){if(!t||!t.startsWith("="))return[];const e=[];return(t.match(/(?<![!'"])\$?[A-Z]+\$?\d+(?::\$?[A-Z]+\$?\d+)?/gi)||[]).forEach(t=>{t.includes("!")||t.replace(/\$/g,"").split(":").forEach(t=>{const n=t.match(/^([A-Z]+)(\d+)$/i);if(n){const t=n[1].toUpperCase().split("").reduce((t,e)=>26*t+e.charCodeAt(0)-64,0)-1,i=parseInt(n[2],10)-1;e.some(e=>e.r===i&&e.c===t)||e.push({r:i,c:t})}})}),e}const cP=[{name:"星期",values:["周一","周二","周三","周四","周五","周六","周日"]},{name:"月份",values:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},{name:"优先级",values:["高","中","低"]},{name:"季度",values:["第一季度","第二季度","第三季度","第四季度"]}];class hP{constructor(t){this.SN=t,this.overlay=null,this.sortLevels=[],this.options={hasHeader:!1,caseSensitive:!1},this.range=null,this.columns=[],this.customLists=[...cP]}mn(t,e){return this.SN.t(t,e)}show(){const t=this.SN.activeSheet;this.range=this.jy(t),this.range?t.areaHaveMerge(this.range)?this.SN.Utils.toast(this.SN.t("components.sortDialog.toast.msg002")):(this.qy(),0===this.sortLevels.length&&(this.sortLevels=[{column:this.range.s.c,sortBy:"value",order:"asc",customOrder:null}]),this.Gy(),this.Sp()):this.SN.Utils.toast(this.SN.t("components.sortDialog.toast.msg001"))}jy(t){const e=t.activeAreas;if(e.length>0){const t=e[e.length-1];if(t.e.r>t.s.r||t.e.c>t.s.c)return t}return this.fe(t)}fe(t){const e=t.activeCell;let n=e.r,i=e.r,r=e.c,o=e.c;const a=(e,n)=>{const i=t.getCell(e,n);return void 0!==i.editVal&&null!==i.editVal&&""!==i.editVal};for(;n>0&&a(n-1,e.c);)n--;for(;i<t.rowCount-1&&a(i+1,e.c);)i++;for(;r>0&&a(e.r,r-1);)r--;for(;o<t.colCount-1&&a(e.r,o+1);)o++;return n===i&&r===o?null:{s:{r:n,c:r},e:{r:i,c:o}}}qy(){const t=this.SN.activeSheet;this.columns=[];for(let e=this.range.s.c;e<=this.range.e.c;e++){const n=t.getCell(this.range.s.r,e),i=n.showVal??n.editVal??"",r=this.SN.Utils.numToChar(e);this.columns.push({index:e,letter:r,name:this.options.hasHeader&&i?String(i):this.mn("components.sortDialog.content.columnFallback",{colLetter:r})})}}Gy(){if(this.overlay)return void this.Xy();const t=document.createElement("div");t.className="sn-modal-overlay sn-sort-dialog-overlay",t.innerHTML=`\n            <div class="sn-modal sn-sort-dialog">\n                <div class="sn-modal-header">\n                    <h3 class="sn-modal-title">${this.mn("components.sortDialog.content.title")}</h3>\n                    <button class="sn-modal-close" title="${this.mn("components.sortDialog.content.close")}"></button>\n                </div>\n                <div class="sn-modal-body">\n                    <div class="sn-sort-toolbar">\n                        <button class="sn-sort-btn" data-action="add">\n                            ${cn("sort_add")}\n                            ${this.mn("components.sortDialog.content.toolbar.add")}\n                        </button>\n                        <button class="sn-sort-btn" data-action="delete" disabled>\n                            ${cn("sort_remove")}\n                            ${this.mn("components.sortDialog.content.toolbar.delete")}\n                        </button>\n                        <button class="sn-sort-btn" data-action="copy" disabled>\n                            ${cn("sort_copy")}\n                            ${this.mn("components.sortDialog.content.toolbar.copy")}\n                        </button>\n                        <div class="sn-sort-toolbar-divider"></div>\n                        <button class="sn-sort-btn" data-action="moveUp" disabled>\n                            ${cn("sort_moveUp")}\n                        </button>\n                        <button class="sn-sort-btn" data-action="moveDown" disabled>\n                            ${cn("sort_moveDown")}\n                        </button>\n                    </div>\n                    <div class="sn-sort-levels-header">\n                        <span class="sn-sort-col-select"></span>\n                        <span class="sn-sort-col-column">${this.mn("components.sortDialog.content.header.column")}</span>\n                        <span class="sn-sort-col-sortby">${this.mn("components.sortDialog.content.header.sortBy")}</span>\n                        <span class="sn-sort-col-order">${this.mn("components.sortDialog.content.header.order")}</span>\n                    </div>\n                    <div class="sn-sort-levels"></div>\n                    <div class="sn-sort-options">\n                        <label class="sn-sort-option">\n                            <input type="checkbox" class="sn-sort-has-header" ${this.options.hasHeader?"checked":""}>\n                            <span>${this.mn("components.sortDialog.content.options.hasHeader")}</span>\n                        </label>\n                        <label class="sn-sort-option">\n                            <input type="checkbox" class="sn-sort-case-sensitive" ${this.options.caseSensitive?"checked":""}>\n                            <span>${this.mn("components.sortDialog.content.options.caseSensitive")}</span>\n                        </label>\n                    </div>\n                </div>\n                <div class="sn-modal-footer">\n                    <button class="sn-modal-btn sn-modal-btn-cancel">${this.mn("components.sortDialog.content.cancel")}</button>\n                    <button class="sn-modal-btn sn-modal-btn-confirm">${this.mn("components.sortDialog.content.confirm")}</button>\n                </div>\n            </div>\n        `,document.body.appendChild(t),this.overlay=t,this.Sb(),this.Xy()}Sb(){const t=this.overlay;t.querySelector(".sn-modal-close").addEventListener("click",()=>this.hide()),t.querySelector(".sn-modal-btn-cancel").addEventListener("click",()=>this.hide()),t.querySelector(".sn-modal-btn-confirm").addEventListener("click",()=>this.Nb()),t.querySelectorAll(".sn-sort-btn").forEach(t=>{t.addEventListener("click",()=>{this.Yy(t.dataset.action)})}),t.querySelector(".sn-sort-has-header").addEventListener("change",t=>{this.options.hasHeader=t.target.checked,this.qy(),this.Xy()}),t.querySelector(".sn-sort-case-sensitive").addEventListener("change",t=>{this.options.caseSensitive=t.target.checked}),t.addEventListener("click",e=>{e.target===t&&this.hide()}),this.Jy=e=>{if("Escape"===e.key){const e=t.querySelector(".sn-sort-custom-list-popup.active");e?e.classList.remove("active"):this.hide()}},document.addEventListener("keydown",this.Jy)}Xy(){const t=this.overlay.querySelector(".sn-sort-levels");t.innerHTML=this.sortLevels.map((t,e)=>this.Zy(t,e)).join(""),t.querySelectorAll(".sn-sort-level").forEach((t,e)=>{t.addEventListener("click",t=>{"SELECT"===t.target.tagName||"BUTTON"===t.target.tagName||t.target.closest(".sn-sort-custom-list-popup")||this.Qy(e)}),t.querySelector(".sn-sort-column-select").addEventListener("change",t=>{this.sortLevels[e].column=parseInt(t.target.value)}),t.querySelector(".sn-sort-sortby-select").addEventListener("change",n=>{this.sortLevels[e].sortBy=n.target.value,this.tw(t,e)}),t.querySelector(".sn-sort-order-select").addEventListener("change",n=>{const i=n.target.value;"custom"===i?this.ew(t,e):(this.sortLevels[e].order=i,this.sortLevels[e].customOrder=null)});const n=t.querySelector(".sn-sort-edit-custom");n&&n.addEventListener("click",n=>{n.stopPropagation(),this.ew(t,e)})}),this.nw()}Zy(t,e){const n=e===this.selectedIndex;return`\n            <div class="sn-sort-level ${n?"selected":""}" data-index="${e}">\n                <span class="sn-sort-col-select">\n                    <input type="radio" name="sn-sort-select" ${n?"checked":""}>\n                </span>\n                <span class="sn-sort-col-column">\n                    <span class="sn-sort-level-prefix">${0===e?this.mn("components.sortDialog.content.level.primary"):1===e?this.mn("components.sortDialog.content.level.secondary"):this.mn("components.sortDialog.content.level.nth",{index:e+1})}</span>\n                    <select class="sn-sort-column-select">${this.columns.map(e=>`<option value="${e.index}" ${e.index===t.column?"selected":""}>${e.name}</option>`).join("")}</select>\n                </span>\n                <span class="sn-sort-col-sortby">\n                    <select class="sn-sort-sortby-select">\n            <option value="value" ${"value"===t.sortBy?"selected":""}>${this.mn("components.sortDialog.content.sortBy.value")}</option>\n            <option value="cellColor" ${"cellColor"===t.sortBy?"selected":""}>${this.mn("components.sortDialog.content.sortBy.cellColor")}</option>\n            <option value="fontColor" ${"fontColor"===t.sortBy?"selected":""}>${this.mn("components.sortDialog.content.sortBy.fontColor")}</option>\n        </select>\n                </span>\n                <span class="sn-sort-col-order">\n                    <select class="sn-sort-order-select">${this.iw(t)}</select>\n                    ${t.customOrder&&t.customOrder.length>0?`<button class="sn-sort-edit-custom" title="${this.mn("components.sortDialog.content.customList.editTitle")}">...</button>`:""}\n                </span>\n            </div>\n        `}iw(t){const{sortBy:e,order:n,customOrder:i}=t;if("value"===e){const t=Array.isArray(i)&&i.length>0,e=t?i.slice(0,3).join(", "):"",r=t?this.mn("components.sortDialog.content.order.customPrefix",{preview:`${e}${i.length>3?"...":""}`}):this.mn("components.sortDialog.content.order.customList");return`\n                <option value="asc" ${"asc"!==n||t?"":"selected"}>${this.mn("components.sortDialog.content.order.asc")}</option>\n                <option value="desc" ${"desc"!==n||t?"":"selected"}>${this.mn("components.sortDialog.content.order.desc")}</option>\n                <option value="custom" ${t?"selected":""}>${r}</option>\n            `}return`\n                <option value="top" ${"top"===n?"selected":""}>${this.mn("components.sortDialog.content.order.top")}</option>\n                <option value="bottom" ${"bottom"===n?"selected":""}>${this.mn("components.sortDialog.content.order.bottom")}</option>\n            `}tw(t,e){const n=this.sortLevels[e],i=t.querySelector(".sn-sort-order-select");i.innerHTML=this.iw({...n,customOrder:null}),"value"===n.sortBy?(i.value="asc",n.order="asc"):(i.value="top",n.order="top"),n.customOrder=null;const r=t.querySelector(".sn-sort-edit-custom");r&&r.remove()}ew(t,e){const n=this.overlay.querySelector(".sn-sort-custom-list-popup");n&&n.remove();const i=this.sortLevels[e],r=i.customOrder||[],o=t.querySelector(".sn-sort-col-order").getBoundingClientRect(),a=document.createElement("div");a.className="sn-sort-custom-list-popup active",a.innerHTML=`\n            <div class="sn-sort-custom-list-header">\n                <span>${this.mn("components.sortDialog.content.customList.title")}</span>\n                <button class="sn-sort-custom-list-close">×</button>\n            </div>\n            <div class="sn-sort-custom-list-presets">\n                <label>${this.mn("components.sortDialog.content.customList.presetLabel")}</label>\n                <select class="sn-sort-preset-select">\n                    <option value="">${this.mn("components.sortDialog.content.customList.selectPreset")}</option>\n                    ${this.customLists.map((t,e)=>`<option value="${e}">${t.name}: ${t.values.slice(0,3).join(", ")}...</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-sort-custom-list-input">\n                <label>${this.mn("components.sortDialog.content.customList.customOrderLabel")}</label>\n                <textarea class="sn-sort-custom-textarea" rows="6" placeholder="${this.mn("components.sortDialog.content.customList.placeholder")}">${r.join("\n")}</textarea>\n            </div>\n            <div class="sn-sort-custom-list-footer">\n                <button class="sn-sort-btn sn-sort-custom-cancel">${this.mn("components.sortDialog.content.customList.cancel")}</button>\n                <button class="sn-sort-btn sn-sort-custom-apply">${this.mn("components.sortDialog.content.customList.apply")}</button>\n            </div>\n        `,this.overlay.appendChild(a);let s=o.left,l=o.bottom+4;s+300>window.innerWidth-10&&(s=window.innerWidth-300-10),l+320>window.innerHeight&&(l=o.top-320-4),a.style.left=`${s}px`,a.style.top=`${l}px`;const c=()=>{if(a.remove(),!i.customOrder||0===i.customOrder.length){const e=t.querySelector(".sn-sort-order-select");e&&(e.value="asc",i.order="asc")}};a.querySelector(".sn-sort-custom-list-close").addEventListener("click",c),a.querySelector(".sn-sort-preset-select").addEventListener("change",t=>{const e=parseInt(t.target.value);!isNaN(e)&&this.customLists[e]&&(a.querySelector(".sn-sort-custom-textarea").value=this.customLists[e].values.join("\n"))}),a.querySelector(".sn-sort-custom-cancel").addEventListener("click",c),a.querySelector(".sn-sort-custom-apply").addEventListener("click",()=>{const t=a.querySelector(".sn-sort-custom-textarea").value.trim().split("\n").map(t=>t.trim()).filter(t=>t);0===t.length?(i.customOrder=null,i.order="asc"):(i.customOrder=t,i.order="custom"),a.remove(),this.Xy()}),a.addEventListener("click",t=>t.stopPropagation()),a.addEventListener("mousedown",t=>t.stopPropagation())}Qy(t){this.selectedIndex=t,this.Xy()}Yy(t){switch(t){case"add":this.rw();break;case"delete":this.sw();break;case"copy":this.ow();break;case"moveUp":this.aw(-1);break;case"moveDown":this.aw(1)}}rw(){const t=new Set(this.sortLevels.map(t=>t.column));let e=this.range.s.c;for(let n=this.range.s.c;n<=this.range.e.c;n++)if(!t.has(n)){e=n;break}this.sortLevels.push({column:e,sortBy:"value",order:"asc",customOrder:null}),this.selectedIndex=this.sortLevels.length-1,this.Xy()}sw(){this.sortLevels.length<=1||void 0!==this.selectedIndex&&(this.sortLevels.splice(this.selectedIndex,1),this.selectedIndex>=this.sortLevels.length&&(this.selectedIndex=this.sortLevels.length-1),this.Xy())}ow(){if(void 0===this.selectedIndex)return;const t=this.sortLevels[this.selectedIndex],e={...t,customOrder:t.customOrder?[...t.customOrder]:null};this.sortLevels.splice(this.selectedIndex+1,0,e),this.selectedIndex=this.selectedIndex+1,this.Xy()}aw(t){if(void 0===this.selectedIndex)return;const e=this.selectedIndex+t;if(e<0||e>=this.sortLevels.length)return;const n=this.sortLevels[this.selectedIndex];this.sortLevels[this.selectedIndex]=this.sortLevels[e],this.sortLevels[e]=n,this.selectedIndex=e,this.Xy()}nw(){const t=void 0!==this.selectedIndex,e=this.sortLevels.length>1,n=t&&this.selectedIndex>0,i=t&&this.selectedIndex<this.sortLevels.length-1,r=this.overlay.querySelector(".sn-sort-toolbar");r.querySelector('[data-action="delete"]').disabled=!t||!e,r.querySelector('[data-action="copy"]').disabled=!t,r.querySelector('[data-action="moveUp"]').disabled=!n,r.querySelector('[data-action="moveDown"]').disabled=!i}Nb(){const t=this.SN.activeSheet,e=this.sortLevels.map(t=>({col:t.column,order:"desc"===t.order||"bottom"===t.order?"desc":"asc",sortBy:t.sortBy,customOrder:t.customOrder}));Tt(t,this.range,e,(this.options.hasHeader,this.options.caseSensitive))&&(this.SN.ue(),this.hide())}Sp(){this.selectedIndex=0,this.Xy();const t=this.overlay.querySelector(".sn-modal");t&&(t.style.transform=""),requestAnimationFrame(()=>{this.overlay.classList.add("active")})}hide(){this.overlay&&(this.overlay.classList.add("closing"),setTimeout(()=>{this.overlay.classList.remove("active","closing")},200),this.Jy&&document.removeEventListener("keydown",this.Jy))}destroy(){this.hide(),this.overlay&&(this.overlay.remove(),this.overlay=null)}}let uP=null;function dP(t){const e=t.Table?.getTableAt?.(t.activeCell.r,t.activeCell.c);if(e?.autoFilterEnabled){const n=t.AutoFilter.getTableScopeId(e.id);if(t.AutoFilter.isScopeEnabled(n))return{scopeId:n,table:e}}return{scopeId:null,table:null}}class fP{constructor(t){this.SN=t,this.overlay=null,this.activeTab="find",this.findResults=[],this.currentIndex=-1,this.lastSearchText="",this.options={matchCase:!1,matchCell:!1,searchIn:"values",searchBy:"rows",searchScope:"sheet"}}show(t="find"){this.activeTab=t,this.Gy(),this.Sp()}Gy(){this.overlay&&(this.Jy&&(document.removeEventListener("keydown",this.Jy),this.Jy=null),this.overlay.remove(),this.overlay=null);const t=document.createElement("div");t.className="sn-modal-overlay sn-find-dialog-overlay";const e=`\n            <div class="sn-modal sn-find-dialog">\n                <div class="sn-modal-header">\n                    <div class="sn-find-tabs">\n                        <button class="sn-find-tab active" data-tab="find">${this.mn("findReplace.tab.find","Find")}</button>\n                        <button class="sn-find-tab" data-tab="replace">${this.mn("findReplace.tab.replace","Replace")}</button>\n                        <button class="sn-find-tab" data-tab="goto">${this.mn("findReplace.tab.goto","Go To")}</button>\n                    </div>\n                    <button class="sn-modal-close" title="${this.mn("findReplace.close","Close")}"></button>\n                </div>\n                <div class="sn-modal-body">\n                    \x3c!-- 查找面板 --\x3e\n                    <div class="sn-find-panel active" data-panel="find">\n                        ${this.lw()}\n                    </div>\n                    \x3c!-- 替换面板 --\x3e\n                    <div class="sn-find-panel" data-panel="replace">\n                        ${this.cw()}\n                    </div>\n                    \x3c!-- 定位面板 --\x3e\n                    <div class="sn-find-panel" data-panel="goto">\n                        ${this.hw()}\n                    </div>\n                </div>\n            </div>\n        `;t.innerHTML=e,document.body.appendChild(t),this.overlay=t,this.Sb(),this.uw(this.activeTab)}lw(){return`\n            <div class="sn-find-form">\n                <div class="sn-find-row">\n                    <label>${this.mn("findReplace.findWhat","Find what:")}</label>\n                    <input type="text" class="sn-find-input" data-field="find-text" placeholder="${this.mn("findReplace.placeholder.searchText","Enter search text")}">\n                </div>\n                <div class="sn-find-options">\n                    <details class="sn-find-options-toggle">\n                        <summary>${this.mn("findReplace.options","Options")}</summary>\n                        <div class="sn-find-options-content">\n                            <div class="sn-find-options-row">\n                                <label class="sn-find-checkbox">\n                                    <input type="checkbox" data-field="find-match-case">\n                                    <span>${this.mn("findReplace.matchCase","Match case")}</span>\n                                </label>\n                                <label class="sn-find-checkbox">\n                                    <input type="checkbox" data-field="find-match-cell">\n                                    <span>${this.mn("findReplace.matchEntireCell","Match entire cell contents")}</span>\n                                </label>\n                            </div>\n                            <div class="sn-find-options-row">\n                                <label>${this.mn("findReplace.within","Within:")}</label>\n                                <select data-field="find-scope">\n                                    <option value="sheet">${this.mn("findReplace.scope.sheet","Sheet")}</option>\n                                    <option value="workbook">${this.mn("findReplace.scope.workbook","Workbook")}</option>\n                                </select>\n                                <label>${this.mn("findReplace.search","Search:")}</label>\n                                <select data-field="find-by">\n                                    <option value="rows">${this.mn("findReplace.searchBy.rows","By Rows")}</option>\n                                    <option value="columns">${this.mn("findReplace.searchBy.columns","By Columns")}</option>\n                                </select>\n                            </div>\n                            <div class="sn-find-options-row">\n                                <label>${this.mn("findReplace.lookIn","Look in:")}</label>\n                                <select data-field="find-in">\n                                    <option value="values">${this.mn("findReplace.lookInValues","Values")}</option>\n                                    <option value="formulas">${this.mn("findReplace.lookInFormulas","Formulas")}</option>\n                                </select>\n                            </div>\n                        </div>\n                    </details>\n                </div>\n                <div class="sn-find-status" data-field="find-status"></div>\n            </div>\n            <div class="sn-find-actions">\n                <button class="sn-modal-btn" data-field="find-all">${this.mn("findReplace.findAll","Find All")}</button>\n                <button class="sn-modal-btn sn-modal-btn-confirm" data-field="find-next">${this.mn("findReplace.findNext","Find Next")}</button>\n            </div>\n            <div class="sn-find-results" data-field="find-results"></div>\n        `}cw(){return`\n            <div class="sn-find-form">\n                <div class="sn-find-row">\n                    <label>${this.mn("findReplace.findWhat","Find what:")}</label>\n                    <input type="text" class="sn-find-input" data-field="replace-find" placeholder="${this.mn("findReplace.placeholder.searchText","Enter search text")}">\n                </div>\n                <div class="sn-find-row">\n                    <label>${this.mn("findReplace.replaceWith","Replace with:")}</label>\n                    <input type="text" class="sn-find-input" data-field="replace-with" placeholder="${this.mn("findReplace.placeholder.replaceText","Enter replacement text")}">\n                </div>\n                <div class="sn-find-options">\n                    <details class="sn-find-options-toggle">\n                        <summary>${this.mn("findReplace.options","Options")}</summary>\n                        <div class="sn-find-options-content">\n                            <div class="sn-find-options-row">\n                                <label class="sn-find-checkbox">\n                                    <input type="checkbox" data-field="replace-match-case">\n                                    <span>${this.mn("findReplace.matchCase","Match case")}</span>\n                                </label>\n                                <label class="sn-find-checkbox">\n                                    <input type="checkbox" data-field="replace-match-cell">\n                                    <span>${this.mn("findReplace.matchEntireCell","Match entire cell contents")}</span>\n                                </label>\n                            </div>\n                            <div class="sn-find-options-row">\n                                <label>${this.mn("findReplace.within","Within:")}</label>\n                                <select data-field="replace-scope">\n                                    <option value="sheet">${this.mn("findReplace.scope.sheet","Sheet")}</option>\n                                    <option value="workbook">${this.mn("findReplace.scope.workbook","Workbook")}</option>\n                                </select>\n                                <label>${this.mn("findReplace.lookIn","Look in:")}</label>\n                                <select data-field="replace-in">\n                                    <option value="values">${this.mn("findReplace.lookInValues","Values")}</option>\n                                    <option value="formulas">${this.mn("findReplace.lookInFormulas","Formulas")}</option>\n                                </select>\n                            </div>\n                        </div>\n                    </details>\n                </div>\n                <div class="sn-find-status" data-field="replace-status"></div>\n            </div>\n            <div class="sn-find-actions">\n                <button class="sn-modal-btn" data-field="replace-all">${this.mn("findReplace.replaceAll","Replace All")}</button>\n                <button class="sn-modal-btn" data-field="replace-one">${this.mn("findReplace.tab.replace","Replace")}</button>\n                <button class="sn-modal-btn sn-modal-btn-confirm" data-field="replace-find-next">${this.mn("findReplace.findNext","Find Next")}</button>\n            </div>\n        `}hw(){return`\n            <div class="sn-find-form">\n                <div class="sn-find-row">\n                    <label>${this.mn("findReplace.reference","Reference:")}</label>\n                    <input type="text" class="sn-find-input" data-field="goto-ref" placeholder="${this.mn("findReplace.referencePlaceholder","e.g. A1, A1:B10, Sheet2!A1")}">\n                </div>\n                <div class="sn-goto-special">\n                    <div class="sn-goto-special-title">${this.mn("findReplace.gotoSpecialTitle","Go To Special:")}</div>\n                    <div class="sn-goto-special-grid">\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="comments">\n                            <span>${this.mn("findReplace.special.comments","Comments")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="formulas">\n                            <span>${this.mn("findReplace.special.formulas","Formulas")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="constants">\n                            <span>${this.mn("findReplace.special.constants","Constants")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="blanks">\n                            <span>${this.mn("findReplace.special.blanks","Blanks")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="errors">\n                            <span>${this.mn("findReplace.special.errors","Errors")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="differences">\n                            <span>${this.mn("findReplace.special.rowDifferences","Row Differences")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="colDifferences">\n                            <span>${this.mn("findReplace.special.columnDifferences","Column Differences")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="precedents">\n                            <span>${this.mn("findReplace.special.precedents","Precedents")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="dependents">\n                            <span>${this.mn("findReplace.special.dependents","Dependents")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="lastCell">\n                            <span>${this.mn("findReplace.special.lastCell","Last Cell")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="visible">\n                            <span>${this.mn("findReplace.special.visibleCells","Visible Cells")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="conditional">\n                            <span>${this.mn("findReplace.special.conditionalFormats","Conditional Formats")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="validation">\n                            <span>${this.mn("findReplace.special.dataValidation","Data Validation")}</span>\n                        </label>\n                        <label class="sn-goto-option">\n                            <input type="radio" name="goto-special" value="merged">\n                            <span>${this.mn("findReplace.special.mergedCells","Merged Cells")}</span>\n                        </label>\n                    </div>\n                </div>\n            </div>\n            <div class="sn-find-actions">\n                <button class="sn-modal-btn" data-field="goto-special-btn">${this.mn("findReplace.gotoSpecial","Go To Special")}</button>\n                <button class="sn-modal-btn sn-modal-btn-confirm" data-field="goto-btn">${this.mn("findReplace.tab.goto","Go To")}</button>\n            </div>\n        `}Sb(){const t=this.overlay;t.querySelector(".sn-modal-close").addEventListener("click",()=>this.hide()),t.querySelectorAll(".sn-find-tab").forEach(t=>{t.addEventListener("click",()=>{this.uw(t.dataset.tab)})}),t.querySelector('[data-field="find-next"]')?.addEventListener("click",()=>this.dw()),t.querySelector('[data-field="find-all"]')?.addEventListener("click",()=>this.mw()),t.querySelector('[data-field="find-text"]')?.addEventListener("keydown",t=>{"Enter"===t.key&&this.dw()}),t.querySelector('[data-field="replace-find-next"]')?.addEventListener("click",()=>this.pw()),t.querySelector('[data-field="replace-one"]')?.addEventListener("click",()=>this.bw()),t.querySelector('[data-field="replace-all"]')?.addEventListener("click",()=>this.gw()),t.querySelector('[data-field="replace-find"]')?.addEventListener("keydown",t=>{"Enter"===t.key&&this.pw()}),t.querySelector('[data-field="goto-btn"]')?.addEventListener("click",()=>this.yw()),t.querySelector('[data-field="goto-special-btn"]')?.addEventListener("click",()=>this.ww()),t.querySelector('[data-field="goto-ref"]')?.addEventListener("keydown",t=>{"Enter"===t.key&&this.yw()}),this.Jy=t=>{"Escape"===t.key&&this.hide()},document.addEventListener("keydown",this.Jy)}uw(t){this.activeTab=t;const e=this.overlay;e.querySelectorAll(".sn-find-tab").forEach(e=>{e.classList.toggle("active",e.dataset.tab===t)}),e.querySelectorAll(".sn-find-panel").forEach(e=>{e.classList.toggle("active",e.dataset.panel===t)}),setTimeout(()=>{const t=e.querySelector('.sn-find-panel.active input[type="text"]');t&&t.focus()},50)}xw(t="find"){const e=this.overlay;return{matchCase:e.querySelector(`[data-field="${t}-match-case"]`)?.checked||!1,matchCell:e.querySelector(`[data-field="${t}-match-cell"]`)?.checked||!1,searchIn:e.querySelector(`[data-field="${t}-in"]`)?.value||"values",searchBy:e.querySelector(`[data-field="${t}-by"]`)?.value||"rows",searchScope:e.querySelector(`[data-field="${t}-scope"]`)?.value||"sheet"}}dw(){const t=this.overlay.querySelector('[data-field="find-text"]').value;if(!t)return void this.$w("find","findReplace.status.enterSearchText","Please enter search text");const e=this.xw("find");t===this.lastSearchText&&0!==this.findResults.length||(this.Mw(t,e),this.lastSearchText=t),0!==this.findResults.length?(this.currentIndex=(this.currentIndex+1)%this.findResults.length,this.Cw(this.findResults[this.currentIndex]),this.$w("find","findReplace.status.progress","{current} / {total}",{current:this.currentIndex+1,total:this.findResults.length})):this.$w("find","findReplace.status.notFound",'"{text}" not found',{text:t})}mw(){const t=this.overlay.querySelector('[data-field="find-text"]').value;if(!t)return void this.$w("find","findReplace.status.enterSearchText","Please enter search text");const e=this.xw("find");if(this.Mw(t,e),this.lastSearchText=t,0===this.findResults.length)return this.$w("find","findReplace.status.notFound",'"{text}" not found',{text:t}),void this.Sw([]);this.$w("find","findReplace.status.foundCount","Found {count} cells",{count:this.findResults.length}),this.Sw(this.findResults)}Mw(t,e){this.findResults=[],this.currentIndex=-1;const n="workbook"===e.searchScope?this.SN.sheets:[this.SN.activeSheet],i=e.matchCase?t:t.toLowerCase();for(const r of n)if(r.initialized||r.J(),"rows"===e.searchBy)for(let t=0;t<r.rowCount;t++)for(let n=0;n<r.colCount;n++)this.Rw(r,t,n,i,e);else for(let t=0;t<r.colCount;t++)for(let n=0;n<r.rowCount;n++)this.Rw(r,n,t,i,e)}Rw(t,e,n,i,r){const o=t.getCell(e,n);if(!o)return;let a="formulas"===r.searchIn&&o.isFormula?o.editVal:String(o.showVal??o.editVal??"");r.matchCase||(a=a.toLowerCase());let s=!1;s=r.matchCell?a===i:a.includes(i),s&&this.findResults.push({sheet:t,sheetName:t.name,r:e,c:n,value:String(o.showVal??o.editVal??""),ref:`${this.SN.Utils.numToChar(n)}${e+1}`})}Cw(t){t.sheet!==this.SN.activeSheet&&(this.SN.activeSheet=t.sheet);const e=this.SN.activeSheet;e.activeCell={r:t.r,c:t.c},e.activeAreas=[{s:{r:t.r,c:t.c},e:{r:t.r,c:t.c}}],e.vi.rowArr[0]=Math.max(0,t.r-2),e.vi.colArr[0]=Math.max(0,t.c-1),this.SN.ue()}Sw(t){const e=this.overlay.querySelector('[data-field="find-results"]');if(e){if(0===t.length)return e.innerHTML="",void e.classList.remove("has-results");e.classList.add("has-results"),e.innerHTML=`\n            <div class="sn-find-results-header">\n                <span>${this.mn("findReplace.result.sheet","Sheet")}</span>\n                <span>${this.mn("findReplace.result.cell","Cell")}</span>\n                <span>${this.mn("findReplace.result.value","Value")}</span>\n            </div>\n            <div class="sn-find-results-list">\n                ${t.map((t,e)=>`\n                    <div class="sn-find-result-item" data-index="${e}">\n                        <span>${t.sheetName}</span>\n                        <span>${t.ref}</span>\n                        <span title="${this.Db(t.value)}">${this.Db(t.value)}</span>\n                    </div>\n                `).join("")}\n            </div>\n        `,e.querySelectorAll(".sn-find-result-item").forEach(t=>{t.addEventListener("click",()=>{const n=parseInt(t.dataset.index);this.currentIndex=n,this.Cw(this.findResults[n]),e.querySelectorAll(".sn-find-result-item").forEach(e=>e.classList.toggle("active",e===t))})})}}pw(){const t=this.overlay.querySelector('[data-field="replace-find"]').value;if(!t)return void this.$w("replace","findReplace.status.enterSearchText","Please enter search text");const e=this.xw("replace");t===this.lastSearchText&&0!==this.findResults.length||(this.Mw(t,e),this.lastSearchText=t),0!==this.findResults.length?(this.currentIndex=(this.currentIndex+1)%this.findResults.length,this.Cw(this.findResults[this.currentIndex]),this.$w("replace","findReplace.status.progress","{current} / {total}",{current:this.currentIndex+1,total:this.findResults.length})):this.$w("replace","findReplace.status.notFound",'"{text}" not found',{text:t})}bw(){if(0===this.findResults.length||this.currentIndex<0)return void this.pw();const t=this.overlay.querySelector('[data-field="replace-with"]').value,e=this.findResults[this.currentIndex],n=this.overlay.querySelector('[data-field="replace-find"]').value,i=this.xw("replace");if(this.Aw(e,n,t,i),this.findResults.splice(this.currentIndex,1),0===this.findResults.length)return this.$w("replace","findReplace.status.replaceCompleted","Replace completed"),this.currentIndex=-1,void this.SN.ue();this.currentIndex>=this.findResults.length&&(this.currentIndex=0),this.Cw(this.findResults[this.currentIndex]),this.$w("replace","findReplace.status.progress","{current} / {total}",{current:this.currentIndex+1,total:this.findResults.length})}gw(){const t=this.overlay.querySelector('[data-field="replace-find"]').value,e=this.overlay.querySelector('[data-field="replace-with"]').value;if(!t)return void this.$w("replace","findReplace.status.enterSearchText","Please enter search text");const n=this.xw("replace");if(this.Mw(t,n),0===this.findResults.length)return void this.$w("replace","findReplace.status.notFound",'"{text}" not found',{text:t});const i=this.findResults.length;for(const r of this.findResults)this.Aw(r,t,e,n);this.findResults=[],this.currentIndex=-1,this.lastSearchText="",this.SN.ue(),this.$w("replace","findReplace.status.replacedCount","Replaced {count} occurrence(s)",{count:i})}Aw(t,e,n,i){const r=t.sheet.getCell(t.r,t.c);if(!r)return;let o=String(r.editVal??"");if(i.matchCell)o=n;else if(i.matchCase)o=o.split(e).join(n);else{const t=new RegExp(this.kw(e),"gi");o=o.replace(t,n)}r.editVal=o,r.U=void 0,r.H=void 0}yw(){const t=this.overlay.querySelector('[data-field="goto-ref"]').value.trim();if(t)try{const e=this.Tw(t);if(e.sheetName&&e.sheetName!==this.SN.activeSheet.name){const t=this.SN.getSheet(e.sheetName);if(!t)return void this.SN.Utils.toast(this.mn("findReplace.toast.sheetNotFound",'Worksheet "{name}" not found',{name:e.sheetName}));this.SN.activeSheet=t}const n=this.SN.activeSheet;e.range?(n.activeCell={r:e.range.s.r,c:e.range.s.c},n.activeAreas=[e.range],n.vi.rowArr[0]=Math.max(0,e.range.s.r-2),n.vi.colArr[0]=Math.max(0,e.range.s.c-1)):(n.activeCell={r:e.r,c:e.c},n.activeAreas=[{s:{r:e.r,c:e.c},e:{r:e.r,c:e.c}}],n.vi.rowArr[0]=Math.max(0,e.r-2),n.vi.colArr[0]=Math.max(0,e.c-1)),this.SN.ue(),this.hide()}catch(t){this.SN.Utils.toast(this.mn("findReplace.toast.invalidReference","Invalid reference format"))}else this.SN.Utils.toast(this.mn("findReplace.toast.enterReference","Please enter a reference"))}ww(){const t=this.overlay.querySelector('input[name="goto-special"]:checked');if(!t)return void this.SN.Utils.toast(this.mn("findReplace.toast.selectGoToCondition","Please select a go-to condition"));const e=t.value,n=this.SN.activeSheet,i=[],r=n.activeAreas,o=r.length>0&&(r[0].e.r>r[0].s.r||r[0].e.c>r[0].s.c)?r[0]:{s:{r:0,c:0},e:{r:n.rowCount-1,c:n.colCount-1}};for(let a=o.s.r;a<=o.e.r;a++)for(let t=o.s.c;t<=o.e.c;t++)this.Nw(n,a,t,e)&&i.push({r:a,c:t});0!==i.length?(n.activeCell=i[0],n.activeAreas=i.map(t=>({s:{r:t.r,c:t.c},e:{r:t.r,c:t.c}})),this.SN.ue(),this.SN.Utils.toast(this.mn("findReplace.toast.selectedCount","Selected {count} cells",{count:i.length})),this.hide()):this.SN.Utils.toast(this.mn("findReplace.toast.noMatchingCells","No matching cells found"))}Nw(t,e,n,i){const r=t.getCell(e,n);switch(i){case"formulas":return r.isFormula;case"constants":return!r.isFormula&&void 0!==r.editVal&&null!==r.editVal&&""!==r.editVal;case"blanks":return void 0===r.editVal||null===r.editVal||""===r.editVal;case"errors":return r.isFormula&&String(r.calcVal).startsWith("#");case"comments":return r.Comment&&r.Comment.length>0;case"conditional":return t.CF?.rules?.some(i=>i.sqref?.split(" ").some(i=>{const r=t.rangeStrToNum(i);return e>=r.s.r&&e<=r.e.r&&n>=r.s.c&&n<=r.e.c}));case"validation":return void 0!==r.dataValidation;case"merged":return t.merges?.some(t=>e>=t.s.r&&e<=t.e.r&&n>=t.s.c&&n<=t.e.c);case"lastCell":case"precedents":case"dependents":case"differences":case"colDifferences":default:return!1;case"visible":return!t.rows[e]?.hidden&&!t.cols[n]?.hidden}}Tw(t){let e=null,n=t;if(t.includes("!")){const i=t.split("!");e=i[0].replace(/^'|'$/g,""),n=i[1]}if(n.includes(":")){const[t,i]=n.split(":");return{sheetName:e,range:{s:this.Fw(t),e:this.Fw(i)}}}const i=this.Fw(n);return{sheetName:e,r:i.r,c:i.c}}Fw(t){const e=t.match(/^([A-Za-z]+)(\d+)$/);if(!e)throw new Error(this.mn("findReplace.error.invalidCellReference","Invalid cell reference"));const n=this.SN.Utils.charToNum(e[1].toUpperCase());return{r:parseInt(e[2])-1,c:n}}$w(t,e,n,i={}){const r=this.overlay.querySelector(`[data-field="${t}-status"]`);r&&(r.textContent=this.mn(e,n,i))}mn(t,e,n={}){return this.SN.t(t,n)}Db(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}kw(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}Xy(){}Sp(){const t=this.overlay.querySelector(".sn-modal");t&&(t.style.transform=""),requestAnimationFrame(()=>{this.overlay.classList.add("active");const t=this.overlay.querySelector('.sn-find-panel.active input[type="text"]');t&&(t.focus(),t.select())})}hide(){this.overlay&&(this.overlay.classList.add("closing"),setTimeout(()=>{this.overlay.classList.remove("active","closing")},200),this.Jy&&(document.removeEventListener("keydown",this.Jy),this.Jy=null))}destroy(){this.hide(),this.overlay&&(this.overlay.remove(),this.overlay=null)}}let pP=null;function mP(t){return t?.s&&t?.e?{s:{r:Math.min(t.s.r,t.e.r),c:Math.min(t.s.c,t.e.c)},e:{r:Math.max(t.s.r,t.e.r),c:Math.max(t.s.c,t.e.c)}}:null}function gP(t,e,n,i=!0){for(let r=i?e.s.r+1:e.s.r;r<=e.e.r;r++){const e=t.getCell(r,n).calcVal;if(""!==e&&null!=e&&"number"==typeof e&&Number.isFinite(e))return!0}return!1}function vP(t){return[{key:"sum",text:t.t("dataTools.function.sum")},{key:"count",text:t.t("dataTools.function.count")},{key:"countNums",text:t.t("dataTools.function.countNums")},{key:"average",text:t.t("dataTools.function.average")},{key:"max",text:t.t("dataTools.function.max")},{key:"min",text:t.t("dataTools.function.min")},{key:"product",text:t.t("dataTools.function.product")},{key:"stdev",text:t.t("dataTools.function.stdev")},{key:"stdevp",text:t.t("dataTools.function.stdevp")},{key:"var",text:t.t("dataTools.function.var")},{key:"varp",text:t.t("dataTools.function.varp")}]}const yP=[{key:"any",labelKey:"dataValidation.type.any"},{key:"whole",labelKey:"dataValidation.type.whole"},{key:"decimal",labelKey:"dataValidation.type.decimal"},{key:"list",labelKey:"dataValidation.type.list"},{key:"date",labelKey:"dataValidation.type.date"},{key:"time",labelKey:"dataValidation.type.time"},{key:"textLength",labelKey:"dataValidation.type.textLength"},{key:"custom",labelKey:"dataValidation.type.custom"}],bP=[{key:"between",labelKey:"dataValidation.operator.between"},{key:"notBetween",labelKey:"dataValidation.operator.notBetween"},{key:"equal",labelKey:"dataValidation.operator.equal"},{key:"notEqual",labelKey:"dataValidation.operator.notEqual"},{key:"greaterThan",labelKey:"dataValidation.operator.greaterThan"},{key:"lessThan",labelKey:"dataValidation.operator.lessThan"},{key:"greaterThanOrEqual",labelKey:"dataValidation.operator.greaterThanOrEqual"},{key:"lessThanOrEqual",labelKey:"dataValidation.operator.lessThanOrEqual"}];function xP(t,e,n={}){const i=vP(e),r=n.function??"sum",o=n.groupBy??t[0]?.col??0,a=!1!==n.summaryBelowData,s=t.map(t=>`<option value="${t.col}"${t.col===o?" selected":""}>${t.title}</option>`).join(""),l=t.map(t=>{const e=n.defaultTargets?.includes(t.col)?" checked":"";return`\n                <label>\n                    <input type="checkbox" data-field="subtotal-target" value="${t.col}"${e}>\n                    <span>${t.title}</span>\n                </label>\n            `}).join("");return`\n        <div class="sn-subtotal-dialog">\n            <div class="sn-form-group">\n                <label>${e.t("dataTools.subtotal.groupField")}</label>\n                <select data-field="subtotal-group">${s}</select>\n            </div>\n            <div class="sn-form-group">\n                <label>${e.t("dataTools.subtotal.function")}</label>\n                <select data-field="subtotal-function">\n                    ${i.map(t=>`<option value="${t.key}"${t.key===r?" selected":""}>${t.text}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-form-group">\n                <label>${e.t("dataTools.subtotal.addTo")}</label>\n                <div class="sn-subtotal-targets">${l}</div>\n            </div>\n            <div class="sn-form-group">\n                <label>\n                    <input type="checkbox" data-field="subtotal-has-headers" checked>\n                    <span>${e.t("dataTools.subtotal.hasHeaders")}</span>\n                </label>\n                <label>\n                    <input type="checkbox" data-field="subtotal-replace" checked>\n                    <span>${e.t("dataTools.subtotal.replaceExisting")}</span>\n                </label>\n                <label>\n                    <input type="checkbox" data-field="subtotal-summary-below"${a?" checked":""}>\n                    <span>${e.t("dataTools.subtotal.summaryBelow")}</span>\n                </label>\n                <label>\n                    <input type="checkbox" data-field="subtotal-grand-total" checked>\n                    <span>${e.t("dataTools.subtotal.grandTotal")}</span>\n                </label>\n            </div>\n        </div>\n    `}function wP(t){const e=t.querySelector('[data-field="subtotal-group"]'),n=Number(e?.value);t.querySelectorAll('[data-field="subtotal-target"]').forEach(t=>{const e=Number(t.value)===n;t.disabled=e,e&&(t.checked=!1)})}function SP(t,e,n){const i=vP(n);return`\n        <div class="sn-consolidate-dialog">\n            <div class="sn-form-group">\n                <label>${n.t("dataTools.consolidate.function")}</label>\n                <select data-field="consolidate-function">\n                    ${i.map(t=>`<option value="${t.key}"${"sum"===t.key?" selected":""}>${t.text}</option>`).join("")}\n                </select>\n            </div>\n            <div class="sn-form-group">\n                <label>${n.t("dataTools.consolidate.sourceRanges")}</label>\n                <textarea data-field="consolidate-ranges" rows="6" placeholder="A1:C10&#10;E1:G10">${t}</textarea>\n            </div>\n            <div class="sn-form-group">\n                <label>${n.t("dataTools.consolidate.destination")}</label>\n                <input type="text" data-field="consolidate-destination" value="${e}" placeholder="${n.t("dataTools.consolidate.destinationPlaceholder")}">\n            </div>\n            <div class="sn-form-group sn-form-group-toggle">\n                <label class="sn-inline-toggle">\n                    <input type="checkbox" data-field="consolidate-skip-blanks" checked>\n                    <span>${n.t("dataTools.consolidate.skipBlanks")}</span>\n                </label>\n            </div>\n        </div>\n    `}function CP(t,e){const n=t?.type||"any",i=t?.operator||"between",r=Array.isArray(t?.formula1)?t.formula1.join(","):"",o=Array.isArray(t?.formula1)||null==t?.formula1?"":String(t.formula1),a=null!=t?.formula2?String(t.formula2):"";return`\n        <div class="sn-data-validation-dialog">\n            <div class="sn-data-validation-grid">\n                <div class="sn-form-group">\n                    <label>${e.t("dataValidation.allow")}</label>\n                    <select data-field="dv-type">\n                        ${yP.map(t=>`<option value="${t.key}"${t.key===n?" selected":""}>${e.t(t.labelKey)}</option>`).join("")}\n                    </select>\n                </div>\n                <div class="sn-form-group" data-role="dv-operator-group">\n                    <label>${e.t("dataValidation.data")}</label>\n                    <select data-field="dv-operator">\n                        ${bP.map(t=>`<option value="${t.key}"${t.key===i?" selected":""}>${e.t(t.labelKey)}</option>`).join("")}\n                    </select>\n                </div>\n            </div>\n            <div class="sn-form-group" data-role="dv-list-source-group">\n                <label>${e.t("dataValidation.listSource")}</label>\n                <input type="text" data-field="dv-list-source" value="${r}" placeholder="${e.t("dataValidation.listSourcePlaceholder")}">\n            </div>\n            <div class="sn-data-validation-grid">\n                <div class="sn-form-group" data-role="dv-formula1-group">\n                    <label data-role="dv-formula1-label">${e.t("dataValidation.formula1.default")}</label>\n                    <input type="text" data-field="dv-formula1" value="${o}">\n                </div>\n                <div class="sn-form-group" data-role="dv-formula2-group">\n                    <label data-role="dv-formula2-label">${e.t("dataValidation.formula2.default")}</label>\n                    <input type="text" data-field="dv-formula2" value="${a}">\n                </div>\n            </div>\n            <label class="sn-data-validation-toggle">\n                <input type="checkbox" data-field="dv-allow-blank"${!1!==t?.allowBlank?" checked":""}>\n                <span>${e.t("dataValidation.allowBlank")}</span>\n            </label>\n            <label class="sn-data-validation-toggle" data-role="dv-dropdown-group">\n                <input type="checkbox" data-field="dv-show-dropdown"${!1!==t?.showDropDown?" checked":""}>\n                <span>${e.t("dataValidation.inCellDropdown")}</span>\n            </label>\n            <label class="sn-data-validation-toggle">\n                <input type="checkbox" data-field="dv-show-input"${!1!==t?.showInputMessage?" checked":""}>\n                <span>${e.t("dataValidation.showInputPrompt")}</span>\n            </label>\n            <div class="sn-form-group sn-data-validation-fields" data-role="dv-input-settings">\n                <input type="text" data-field="dv-prompt-title" value="${t?.promptTitle??""}" placeholder="${e.t("dataValidation.promptTitlePlaceholder")}">\n                <textarea data-field="dv-prompt" rows="2" placeholder="${e.t("dataValidation.promptContentPlaceholder")}">${t?.prompt??""}</textarea>\n            </div>\n            <label class="sn-data-validation-toggle">\n                <input type="checkbox" data-field="dv-show-error"${!1!==t?.showErrorMessage?" checked":""}>\n                <span>${e.t("dataValidation.showErrorAlert")}</span>\n            </label>\n            <div class="sn-form-group sn-data-validation-fields" data-role="dv-error-settings">\n                <select data-field="dv-error-style">\n                    <option value="stop"${"stop"===(t?.errorStyle||"stop")?" selected":""}>${e.t("dataValidation.errorStyle.stop")}</option>\n                    <option value="warning"${"warning"===t?.errorStyle?" selected":""}>${e.t("dataValidation.errorStyle.warning")}</option>\n                    <option value="information"${"information"===t?.errorStyle?" selected":""}>${e.t("dataValidation.errorStyle.information")}</option>\n                </select>\n                <input type="text" data-field="dv-error-title" value="${t?.errorTitle??""}" placeholder="${e.t("dataValidation.errorTitlePlaceholder")}">\n                <textarea data-field="dv-error" rows="2" placeholder="${e.t("dataValidation.errorContentPlaceholder")}">${t?.error??""}</textarea>\n            </div>\n        </div>\n    `}function TP(t,e){const n=t.querySelector('[data-field="dv-type"]')?.value||"any",i=t.querySelector('[data-field="dv-operator"]')?.value||"between",r=t.querySelector('[data-role="dv-operator-group"]'),o=t.querySelector('[data-role="dv-list-source-group"]'),a=t.querySelector('[data-role="dv-formula1-group"]'),s=t.querySelector('[data-role="dv-formula2-group"]'),l=t.querySelector('[data-role="dv-dropdown-group"]'),c=t.querySelector('[data-role="dv-input-settings"]'),h=t.querySelector('[data-role="dv-error-settings"]'),u=t.querySelector('[data-field="dv-show-input"]'),d=t.querySelector('[data-field="dv-show-error"]'),f=t.querySelector('[data-role="dv-formula1-label"]'),p=t.querySelector('[data-role="dv-formula2-label"]'),m=["whole","decimal","textLength","date","time"].includes(n),g="list"===n,v="custom"===n,y=m||v,b=m&&["between","notBetween"].includes(i);r&&(r.style.display=m?"":"none"),o&&(o.style.display=g?"":"none"),a&&(a.style.display=y?"":"none"),s&&(s.style.display=b?"":"none"),l&&(l.style.display=g?"":"none"),c&&(c.style.display=!1===u?.checked?"none":""),h&&(h.style.display=!1===d?.checked?"none":""),f&&p&&("date"===n?(f.textContent=e.t("dataValidation.formula1.date"),p.textContent=e.t("dataValidation.formula2.date")):"time"===n?(f.textContent=e.t("dataValidation.formula1.time"),p.textContent=e.t("dataValidation.formula2.time")):"textLength"===n?(f.textContent=e.t("dataValidation.formula1.textLength"),p.textContent=e.t("dataValidation.formula2.textLength")):v?(f.textContent=e.t("dataValidation.formula1.custom"),p.textContent=e.t("dataValidation.formula2.custom")):(f.textContent=e.t("dataValidation.formula1.default"),p.textContent=e.t("dataValidation.formula2.default")))}function $P(t){const e=t.activeSheet;if(!e.PivotTable||0===e.PivotTable.size)return t.Utils.toast(t.t("pivot.toast.noPivotInSheet")),null;const n=e.activeAreas[e.activeAreas.length-1];if(n)for(const i of e.PivotTable.getAll()){const t=i.location?.ref;if(t){const e=IP(t);if(e&&n.s.r>=e.s.r&&n.s.r<=e.e.r&&n.s.c>=e.s.c&&n.s.c<=e.e.c)return i}}return e.PivotTable.getAll()[0]}function MP(t){if(!t||!1===t.showPageFields||!t.pageFields||0===t.pageFields.length)return 0;const e=Math.max(1,Number(t.reportFilterFieldsPerRow)||1);return"horizontal"===t.reportFilterLayout?Math.ceil(t.pageFields.length/e):t.pageFields.length}function AP(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function NP(t){const e=String(t||"").trim();return e?/^[A-Za-z_][A-Za-z0-9_]*$/.test(e)?e:`'${e.replace(/'/g,"''")}'`:""}function kP(t){let e=Number(t)+1,n="";for(;e>0;){const t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-1)/26)}return n}function RP(t,e,n={r:2,c:0}){const i=String(e||"").trim();if(!i)return{...n};let r=null;try{r=t.Utils.cellStrToNum(i)}catch(t){r=null}if(!r||!Number.isFinite(r.r)||!Number.isFinite(r.c)){const e=FP(i);if(!e)throw t.t("pivot.errors.invalidTargetCell");r=e}return{r:Math.max(0,Number(r.r)||0),c:Math.max(0,Number(r.c)||0)}}function _P(t,e,n=null){return t?.pivotFields?.[e]?.name||t?.cache?.fields?.[e]?.name||n.t("pivot.field.fallbackName",{index:e+1})}function IP(t){const e=t.split(":"),n=FP(e[0]),i=e.length>1?FP(e[1]):n;return n&&i?{s:n,e:i}:null}function FP(t){const e=t.replace(/\$/g,"").match(/^([A-Z]+)(\d+)$/i);if(!e)return null;const n=e[1].toUpperCase(),i=parseInt(e[2],10)-1;let r=0;for(let o=0;o<n.length;o++)r=26*r+(n.charCodeAt(o)-64);return r-=1,{r:i,c:r}}function EP(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function DP(){const t=this.SN,e=t.activeSheet,n=e.protection,i=(e,n={})=>t.t(e,n),r=[{key:"selectLockedCells",labelKey:"action.protection.content.sheet.options.selectLockedCells",default:!0},{key:"selectUnlockedCells",labelKey:"action.protection.content.sheet.options.selectUnlockedCells",default:!0},{key:"formatCells",labelKey:"action.protection.content.sheet.options.formatCells",default:!1},{key:"formatColumns",labelKey:"action.protection.content.sheet.options.formatColumns",default:!1},{key:"formatRows",labelKey:"action.protection.content.sheet.options.formatRows",default:!1},{key:"insertColumns",labelKey:"action.protection.content.sheet.options.insertColumns",default:!1},{key:"insertRows",labelKey:"action.protection.content.sheet.options.insertRows",default:!1},{key:"insertHyperlinks",labelKey:"action.protection.content.sheet.options.insertHyperlinks",default:!1},{key:"deleteColumns",labelKey:"action.protection.content.sheet.options.deleteColumns",default:!1},{key:"deleteRows",labelKey:"action.protection.content.sheet.options.deleteRows",default:!1},{key:"sort",labelKey:"action.protection.content.sheet.options.sort",default:!1},{key:"autoFilter",labelKey:"action.protection.content.sheet.options.autoFilter",default:!1},{key:"pivotTables",labelKey:"action.protection.content.sheet.options.pivotTables",default:!1},{key:"objects",labelKey:"action.protection.content.sheet.options.objects",default:!1}].map(t=>{const e=n[t.key]??t.default;return`\n            <label class="sn-protect-option">\n                <input type="checkbox" data-key="${t.key}" ${e?"checked":""}>\n                <span>${i(t.labelKey)}</span>\n            </label>\n        `}).join(""),o=`\n        <div class="sn-protect-sheet">\n            <div class="sn-protect-row">\n                <label>${i("action.protection.content.sheet.passwordLabel")}</label>\n                <input type="password" class="sn-protect-password" placeholder="${i("action.protection.content.sheet.passwordPlaceholder")}">\n            </div>\n            <div class="sn-protect-label">${i("action.protection.content.sheet.allowAllUsers")}</div>\n            <div class="sn-protect-options">\n                ${r}\n            </div>\n        </div>\n    `;t.Utils.modal({titleKey:"action.protection.modal.m001.title",title:i("action.protection.modal.m001.title"),content:o,maxWidth:"400px",confirmKey:"action.protection.modal.m001.confirm",confirmText:i("action.protection.modal.m001.confirm"),cancelKey:"action.protection.modal.m001.cancel",cancelText:i("action.protection.modal.m001.cancel"),onConfirm:n=>{const i={password:n.querySelector(".sn-protect-password").value};n.querySelectorAll(".sn-protect-option input").forEach(t=>{const e=t.dataset.key;i[e]=t.checked}),e.protection.enable(i),t.ue(),t.Layout?.refreshActiveButtons?.(),t.Utils.toast(t.t("action.protection.toast.msg001"))}})}function LP(){const t=this.SN,e=t.activeSheet.protection,n=(e,n={})=>t.t(e,n);if(!e.enabled)return t.Utils.toast(t.t("action.protection.toast.msg003"));const i=e.getOptions();if(i?.passwordHash||i?.hashValue){const i=`\n            <div class="sn-protect-sheet">\n                <div class="sn-protect-row">\n                    <label>${n("action.protection.content.unprotect.passwordLabel")}</label>\n                    <input type="password" class="sn-unprotect-password" placeholder="${n("action.protection.content.unprotect.passwordPlaceholder")}">\n                </div>\n            </div>\n        `;t.Utils.modal({titleKey:"action.protection.modal.m003.title",title:n("action.protection.modal.m003.title"),content:i,maxWidth:"320px",confirmKey:"action.protection.modal.m003.confirm",confirmText:n("action.protection.modal.m003.confirm"),cancelKey:"action.protection.modal.m003.cancel",cancelText:n("action.protection.modal.m003.cancel"),onOpen:t=>{t.querySelector(".sn-unprotect-password").focus()},onConfirm:n=>{const i=n.querySelector(".sn-unprotect-password").value,r=e.disable(i);if(!r.ok)throw r.message;t.ue(),t.Layout?.refreshActiveButtons?.(),t.Utils.toast(t.t("action.protection.toast.msg004"))}})}else e.disable(),t.ue(),t.Layout?.refreshActiveButtons?.(),t.Utils.toast(t.t("action.protection.toast.msg004"))}class PP{constructor(t){this.SN=t}}Object.assign(PP.prototype,{hidRows:function(){const t=ZD(this.SN),e=this.SN.activeSheet;YD.hideRows(e,t.s.r,t.e.r),this.SN.ht({type:"row",action:"hide",sheet:e,startRow:t.s.r,endRow:t.e.r}),this.SN.containerDom.querySelector(".sn-row-rc").style.display="none",this.SN.ue()},delRows:function(){const t=ZD(this.SN);YD.deleteRows(this.SN.activeSheet,t.s.r,t.e.r-t.s.r+1),this.SN.containerDom.querySelector(".sn-row-rc").style.display="none",this.SN.ue()},addRows:function(t,e){if("INPUT"==t.target.tagName)return;const n=ZD(this.SN),i="top"==e?n.s.r:n.e.r+1,r=Number(t.target.querySelector("input").value);YD.insertRows(this.SN.activeSheet,i,r),this.SN.containerDom.querySelector(".sn-row-rc").style.display="none",this.SN.ue()},delCols:function(){const t=ZD(this.SN);YD.deleteCols(this.SN.activeSheet,t.s.c,t.e.c-t.s.c+1),this.SN.containerDom.querySelector(".sn-col-rc").style.display="none",this.SN.ue()},hidCols:function(){const t=ZD(this.SN),e=this.SN.activeSheet;YD.hideCols(e,t.s.c,t.e.c),this.SN.ht({type:"col",action:"hide",sheet:e,startCol:t.s.c,endCol:t.e.c}),this.SN.containerDom.querySelector(".sn-col-rc").style.display="none",this.SN.ue()},addCols:function(t,e){if("INPUT"==t.target.tagName)return;const n=ZD(this.SN),i="left"==e?n.s.c:n.e.c+1,r=Number(t.target.querySelector("input").value);YD.insertCols(this.SN.activeSheet,i,r),this.SN.containerDom.querySelector(".sn-col-rc").style.display="none",this.SN.ue()},insertRowDialog:async function(){const t=this.SN,e=t.activeSheet,n=ZD(t),i=(e,n={})=>t.t(e,n);try{const r=await t.Utils.modal({titleKey:"action.rowCol.modal.m001.title",title:i("action.rowCol.modal.m001.title"),content:`\n                <div style="display:flex;flex-direction:column;gap:12px;min-width:240px;">\n                    <div>\n                        <label style="display:block;margin-bottom:4px;font-size:13px;">${i("action.rowCol.content.insert.countLabel")}</label>\n                        <input type="number" data-field="insert-row-count" value="${n.e.r-n.s.r+1}" min="1" max="1000"\n                            style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;">\n                    </div>\n                    <div>\n                        <label style="display:block;margin-bottom:4px;font-size:13px;">${i("action.rowCol.content.insert.positionLabel")}</label>\n                        <select data-field="insert-row-pos" style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;">\n                            <option value="above">${i("action.rowCol.content.insertRow.positionAbove")}</option>\n                            <option value="below">${i("action.rowCol.content.insertRow.positionBelow")}</option>\n                        </select>\n                    </div>\n                </div>\n            `,confirmKey:"action.rowCol.modal.m001.confirm",confirmText:i("action.rowCol.modal.m001.confirm"),cancelKey:"action.rowCol.modal.m001.cancel",cancelText:i("action.rowCol.modal.m001.cancel")}),o=parseInt(r.bodyEl.querySelector('[data-field="insert-row-count"]').value)||1,a=r.bodyEl.querySelector('[data-field="insert-row-pos"]').value;YD.insertRows(e,"above"===a?n.s.r:n.e.r+1,o),t.ue()}catch(t){}},insertColDialog:async function(){const t=this.SN,e=t.activeSheet,n=ZD(t),i=(e,n={})=>t.t(e,n);try{const r=await t.Utils.modal({titleKey:"action.rowCol.modal.m002.title",title:i("action.rowCol.modal.m002.title"),content:`\n                <div style="display:flex;flex-direction:column;gap:12px;min-width:240px;">\n                    <div>\n                        <label style="display:block;margin-bottom:4px;font-size:13px;">${i("action.rowCol.content.insert.countLabel")}</label>\n                        <input type="number" data-field="insert-col-count" value="${n.e.c-n.s.c+1}" min="1" max="100"\n                            style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;">\n                    </div>\n                    <div>\n                        <label style="display:block;margin-bottom:4px;font-size:13px;">${i("action.rowCol.content.insert.positionLabel")}</label>\n                        <select data-field="insert-col-pos" style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;">\n                            <option value="left">${i("action.rowCol.content.insertCol.positionLeft")}</option>\n                            <option value="right">${i("action.rowCol.content.insertCol.positionRight")}</option>\n                        </select>\n                    </div>\n                </div>\n            `,confirmKey:"action.rowCol.modal.m002.confirm",confirmText:i("action.rowCol.modal.m002.confirm"),cancelKey:"action.rowCol.modal.m002.cancel",cancelText:i("action.rowCol.modal.m002.cancel")}),o=parseInt(r.bodyEl.querySelector('[data-field="insert-col-count"]').value)||1,a=r.bodyEl.querySelector('[data-field="insert-col-pos"]').value;YD.insertCols(e,"left"===a?n.s.c:n.e.c+1,o),t.ue()}catch(t){}},deleteRowAction:function(){const t=ZD(this.SN);YD.deleteRows(this.SN.activeSheet,t.s.r,t.e.r-t.s.r+1),this.SN.ue()},deleteColAction:function(){const t=ZD(this.SN);YD.deleteCols(this.SN.activeSheet,t.s.c,t.e.c-t.s.c+1),this.SN.ue()},hideRowAction:function(){const t=this.SN.activeSheet,e=ZD(this.SN);YD.hideRows(t,e.s.r,e.e.r),this.SN.ue()},hideColAction:function(){const t=this.SN.activeSheet,e=ZD(this.SN);YD.hideCols(t,e.s.c,e.e.c),this.SN.ue()},unhideRowAction:function(){const t=this.SN.activeSheet,e=ZD(this.SN);YD.unhideRows(t,e.s.r,e.e.r),this.SN.ue()},unhideColAction:function(){const t=this.SN.activeSheet,e=ZD(this.SN);YD.unhideCols(t,e.s.c,e.e.c),this.SN.ue()},unhideAllRowsAction:function(){const t=this.SN.activeSheet;YD.unhideAllRows(t),this.SN.ue()},unhideAllColsAction:function(){const t=this.SN.activeSheet;YD.unhideAllCols(t),this.SN.ue()},applyRowColInsertByPos:function(t,e){t?.stopPropagation?.();const n=t?.target?.closest(".sn-rowcol-insert-item");if(!n)return;const i=n.querySelector('[data-field="rowcol-insert-count"]');if(!i)return;const r="left"===e||"right"===e,o=ZD(this.SN),a=this.SN.activeSheet;let s=Math.round(Number(i.value));if(!Number.isFinite(s)||s<1){const t=o.e.r-o.s.r+1,e=o.e.c-o.s.c+1;s=r?e:t}if(s=Math.min(Math.max(s,1),1e4),r){const t="left"===e?o.s.c:o.e.c+1;YD.insertCols(a,t,s)}else{const t="above"===e?o.s.r:o.e.r+1;YD.insertRows(a,t,s)}this.SN.ue(),function(t){const e=t?.target?.closest(".sn-dropdown");e&&(e.classList.add("closing"),setTimeout(()=>{e.classList.remove("active","closing")},200))}(t)},setRowHeightDialog:async function(){const t=this.SN,e=t.activeSheet,n=ZD(t),i=e.getRow(n.s.r).height,r=(e,n={})=>t.t(e,n);try{const o=await t.Utils.modal({titleKey:"action.rowCol.modal.m003.title",title:r("action.rowCol.modal.m003.title"),maxWidth:"400px",content:`\n                <div style="min-width:200px;">\n                    <label style="display:block;margin-bottom:4px;font-size:13px;">${r("action.rowCol.content.rowHeight.label")}</label>\n                    <input type="number" data-field="row-height" value="${i}" min="1" max="500"\n                        style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;">\n                </div>\n            `,confirmKey:"action.rowCol.modal.m003.confirm",confirmText:r("action.rowCol.modal.m003.confirm"),cancelKey:"action.rowCol.modal.m003.cancel",cancelText:r("action.rowCol.modal.m003.cancel")}),a=parseInt(o.bodyEl.querySelector('[data-field="row-height"]').value)||i;YD.setRowsHeight(e,n.s.r,n.e.r,a),t.ue()}catch(t){}},setColWidthDialog:async function(){const t=this.SN,e=t.activeSheet,n=ZD(t),i=e.getCol(n.s.c).width,r=(e,n={})=>t.t(e,n);try{const o=await t.Utils.modal({titleKey:"action.rowCol.modal.m004.title",title:r("action.rowCol.modal.m004.title"),maxWidth:"400px",content:`\n                <div style="min-width:200px;">\n                    <label style="display:block;margin-bottom:4px;font-size:13px;">${r("action.rowCol.content.colWidth.label")}</label>\n                    <input type="number" data-field="col-width" value="${i}" min="1" max="1000"\n                        style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;">\n                </div>\n            `,confirmKey:"action.rowCol.modal.m004.confirm",confirmText:r("action.rowCol.modal.m004.confirm"),cancelKey:"action.rowCol.modal.m004.cancel",cancelText:r("action.rowCol.modal.m004.cancel")}),a=parseInt(o.bodyEl.querySelector('[data-field="col-width"]').value)||i;YD.setColsWidth(e,n.s.c,n.e.c,a),t.ue()}catch(t){}},setDefaultRowHeightDialog:async function(){const t=this.SN,e=t.activeSheet,n=e.defaultRowHeight,i=(e,n={})=>t.t(e,n);try{const r=await t.Utils.modal({titleKey:"action.rowCol.modal.m005.title",title:i("action.rowCol.modal.m005.title"),maxWidth:"400px",content:`\n                <div style="min-width:200px;">\n                    <label style="display:block;margin-bottom:4px;font-size:13px;">${i("action.rowCol.content.defaultRowHeight.label")}</label>\n                    <input type="number" data-field="default-row-height" value="${n}" min="1" max="500"\n                        style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;">\n                </div>\n            `,confirmKey:"action.rowCol.modal.m005.confirm",confirmText:i("action.rowCol.modal.m005.confirm"),cancelKey:"action.rowCol.modal.m005.cancel",cancelText:i("action.rowCol.modal.m005.cancel")}),o=parseInt(r.bodyEl.querySelector('[data-field="default-row-height"]').value)||n;if(o===n)return;e.defaultRowHeight=o,t.ue()}catch(t){}},setDefaultColWidthDialog:async function(){const t=this.SN,e=t.activeSheet,n=e.defaultColWidth,i=(e,n={})=>t.t(e,n);try{const r=await t.Utils.modal({titleKey:"action.rowCol.modal.m006.title",title:i("action.rowCol.modal.m006.title"),maxWidth:"400px",content:`\n                <div style="min-width:200px;">\n                    <label style="display:block;margin-bottom:4px;font-size:13px;">${i("action.rowCol.content.defaultColWidth.label")}</label>\n                    <input type="number" data-field="default-col-width" value="${n}" min="1" max="1000"\n                        style="width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;">\n                </div>\n            `,confirmKey:"action.rowCol.modal.m006.confirm",confirmText:i("action.rowCol.modal.m006.confirm"),cancelKey:"action.rowCol.modal.m006.cancel",cancelText:i("action.rowCol.modal.m006.cancel")}),o=parseInt(r.bodyEl.querySelector('[data-field="default-col-width"]').value)||n;if(o===n)return;e.defaultColWidth=o,t.ue()}catch(t){}},autoFitRowHeight:function(){const t=this.SN.activeSheet,e=ZD(this.SN);YD.autoFitRowsHeight(t,e.s.r,e.e.r),this.SN.ue()},autoFitColWidth:function(){const t=this.SN.activeSheet,e=ZD(this.SN);YD.autoFitColsWidth(t,e.s.c,e.e.c),this.SN.ue()},groupRows:function(){const t=this.SN,e=t.activeSheet,n=JD(t),i=t.Utils,r=QD(e,n),o="col"===r?e.groupCols(n):e.groupRows(n);if(o?.canceled)return;const a=o?.changedCount||0,s="col"===r?o?.colCount||0:o?.rowCount||0,l=o?.limitedCount||0,c="col"===r?t.t("action.rowCol.unit.col"):t.t("action.rowCol.unit.row");0!==s?0!==a?(t.ue(),l>0?i.toast(t.t("action.rowCol.toast.group.completedWithLimited",{changedCount:a,unitLabel:c,limitedCount:l})):i.toast(t.t("action.rowCol.toast.group.completed",{changedCount:a,unitLabel:c}))):i.toast(t.t("action.rowCol.toast.group.maxLevelReached",{unitLabel:c})):i.toast(t.t("action.rowCol.toast.group.selectTarget",{unitLabel:c}))},ungroupRows:function(){const t=this.SN,e=t.activeSheet,n=JD(t),i=t.Utils,r=QD(e,n),o="col"===r?e.ungroupCols(n):e.ungroupRows(n);if(o?.canceled)return;const a=o?.changedCount||0,s="col"===r?o?.colCount||0:o?.rowCount||0,l="col"===r?t.t("action.rowCol.unit.col"):t.t("action.rowCol.unit.row");0!==s?0!==a?(t.ue(),i.toast(t.t("action.rowCol.toast.ungroup.completed",{changedCount:a,unitLabel:l}))):i.toast(t.t("action.rowCol.toast.ungroup.noGroup",{unitLabel:l})):i.toast(t.t("action.rowCol.toast.ungroup.selectTarget",{unitLabel:l}))}}),Object.assign(PP.prototype,{decimalPlaces:function(t){const e=this.SN.activeSheet;e.eachCells(e.activeAreas,(n,i)=>{const r=e.getCell(n,i);"number"==r.type&&(r.numFmt=function(t,e){t||(t="0");const n=t.indexOf(".");if("add"===e){if(-1===n)return t+".0";const e=t.slice(0,n+1),i=t.slice(n+1),r=i.search(/[^0#?]/);return-1===r?e+i+"0":e+i.slice(0,r)+"0"+i.slice(r)}{if(-1===n)return t;const e=t.slice(0,n+1),i=t.slice(n+1),r=i.search(/[^0#?]/),o=-1===r?i:i.slice(0,r),a=-1===r?"":i.slice(r);return o.length<=1?t.slice(0,n)+a:e+o.slice(0,-1)+a}}(r.numFmt,t))}),this.SN.ht({type:"format",action:"decimalPlaces",sheet:e,areas:e.activeAreas,formatType:t}),this.SN.ue()},areasNumFmt:function(t){const e=this.SN.activeSheet,n=e.activeAreas,i=new Set,r=new Set;n.forEach(t=>{"string"==typeof t&&(t=e.rangeStrToNum(t));const n=eL(t,e);n.isFullRow&&!n.isFullCol?n.rows.forEach(t=>i.add(t)):n.isFullCol&&!n.isFullRow&&n.cols.forEach(t=>r.add(t))}),i.forEach(n=>{e.getRow(n).numFmt=t}),r.forEach(n=>{e.getCol(n).numFmt=t}),e.eachCells(n,(n,i,r)=>{const o=eL({s:r.s,e:r.e},e);if(o.isFullRow&&!o.isFullCol||o.isFullCol&&!o.isFullRow)return;const a=e.getCell(n,i);"@"==t&&(a.type="string"),""==t&&(a.type=void 0),a.numFmt=t}),this.SN.ht({type:"format",action:"areasNumFmt",sheet:e,areas:n,fmtStr:t}),this.SN.ue()},customNumFmtDialog:function(){const t=(t,e)=>this.SN.t(t,e),e=this.SN.activeSheet,{r:n,c:i}=e.activeCell,r=e.getCell(n,i),o=r.numFmt||"",s="number"==typeof r.calcVal?r.calcVal:1234.567,l=(t,e)=>{if(!t)return String(e);try{const n=a(e,t);return n?.text??String(e)}catch{return String(e)}},c=`\n        <div class="sn-numfmt-dialog">\n            <div class="sn-numfmt-row">\n                <label>${t("action.format.content.customNumFmt.currentLabel")}</label>\n                <code class="sn-numfmt-current">${o||t("action.format.content.customNumFmt.none")}</code>\n            </div>\n            <div class="sn-numfmt-row">\n                <label>${t("action.format.content.customNumFmt.inputLabel")}</label>\n                <input type="text" class="sn-numfmt-input" value="${o}" placeholder="${t("action.format.content.customNumFmt.inputPlaceholder")}">\n            </div>\n            <div class="sn-numfmt-row">\n                <label>${t("action.format.content.customNumFmt.previewLabel")}</label>\n                <span class="sn-numfmt-preview">${l(o,s)}</span>\n            </div>\n            <details class="sn-numfmt-help" open>\n                <summary>${t("action.format.content.customNumFmt.placeholdersTitle")}</summary>\n                <div class="sn-numfmt-placeholders">\n                    <div><code>0</code> ${t("action.format.content.customNumFmt.placeholder.zero")}</div>\n                    <div><code>#</code> ${t("action.format.content.customNumFmt.placeholder.hash")}</div>\n                    <div><code>?</code> ${t("action.format.content.customNumFmt.placeholder.question")}</div>\n                    <div><code>.</code> ${t("action.format.content.customNumFmt.placeholder.dot")}</div>\n                    <div><code>,</code> ${t("action.format.content.customNumFmt.placeholder.comma")}</div>\n                    <div><code>%</code> ${t("action.format.content.customNumFmt.placeholder.percent")}</div>\n                    <div><code>@</code> ${t("action.format.content.customNumFmt.placeholder.at")}</div>\n                    <div><code>yyyy</code> ${t("action.format.content.customNumFmt.placeholder.year")}</div>\n                    <div><code>m/mm</code> ${t("action.format.content.customNumFmt.placeholder.month")}</div>\n                    <div><code>d/dd</code> ${t("action.format.content.customNumFmt.placeholder.day")}</div>\n                    <div><code>h:mm:ss</code> ${t("action.format.content.customNumFmt.placeholder.time")}</div>\n                    <div><code>[Red]</code> ${t("action.format.content.customNumFmt.placeholder.red")}</div>\n                </div>\n            </details>\n            <div class="sn-numfmt-quick">\n                <label>${t("action.format.content.customNumFmt.quickLabel")}</label>\n                <div class="sn-numfmt-tags">\n                    ${[{fmt:"#,##0",descKey:"action.format.content.customNumFmt.quick.integer"},{fmt:"0.00",descKey:"action.format.content.customNumFmt.quick.decimal2"},{fmt:"0.00%",descKey:"action.format.content.customNumFmt.quick.percent"},{fmt:"¥#,##0.00",descKey:"action.format.content.customNumFmt.quick.currency"},{fmt:"yyyy/m/d",descKey:"action.format.content.customNumFmt.quick.date"},{fmt:"h:mm:ss",descKey:"action.format.content.customNumFmt.quick.time"}].map(e=>`<span class="sn-numfmt-tag" data-fmt="${e.fmt}" title="${t(e.descKey)}">${e.fmt}</span>`).join("")}\n                </div>\n            </div>\n        </div>\n    `;this.SN.Utils.modal({titleKey:"action.format.modal.m002.title",title:t("action.format.modal.m002.title"),maxWidth:"420px",content:c,confirmKey:"action.format.modal.m002.confirm",confirmText:t("action.format.modal.m002.confirm"),cancelKey:"action.format.modal.m002.cancel",cancelText:t("action.format.modal.m002.cancel"),onOpen:t=>{const e=t.querySelector(".sn-numfmt-input"),n=t.querySelector(".sn-numfmt-preview"),i=t.querySelectorAll(".sn-numfmt-tag");e.addEventListener("input",()=>{n.textContent=l(e.value,s)}),i.forEach(t=>{t.addEventListener("click",()=>{e.value=t.dataset.fmt,n.textContent=l(e.value,s),e.focus()})}),e.focus(),e.select()},onConfirm:t=>{const e=t.querySelector(".sn-numfmt-input").value;this.areasNumFmt(e)}})},clearAreaFormat:function(t="all"){const e=this.SN.activeSheet,n=e.activeAreas,i=new Set,r=new Set;n.forEach(t=>{"string"==typeof t&&(t=e.rangeStrToNum(t));const n=eL(t,e);n.isFullRow&&!n.isFullCol?n.rows.forEach(t=>i.add(t)):n.isFullCol&&!n.isFullRow&&n.cols.forEach(t=>r.add(t))}),i.forEach(n=>{const i=e.getRow(n);"style"!==t&&"all"!==t||(i.style=null),"border"===t&&(i.border=null)}),r.forEach(n=>{const i=e.getCol(n);"style"!==t&&"all"!==t||(i.style=null),"border"===t&&(i.border=null)}),e.eachCells(n,(n,i,r)=>{const o=eL({s:r.s,e:r.e},e);if(o.isFullRow&&!o.isFullCol||o.isFullCol&&!o.isFullRow)return;const a=e.getCell(n,i);"style"==t?a.style={}:"value"==t?a.editVal="":("border"==t||(a.style={},a.editVal=""),a.border=null)}),this.SN.ht({type:"format",action:"clearAreaFormat",sheet:e,areas:n,clearType:t}),this.SN.ue()},textToNumber:function(){const t=this.SN.activeSheet;t.eachCells(t.activeAreas,(e,n)=>{const i=t.getCell(e,n),r=i.calcVal;"string"!=typeof r||""===r||isNaN(Number(r))||(i.editVal=Number(r))}),this.SN.ht({type:"format",action:"textToNumber",sheet:t,areas:t.activeAreas}),this.SN.ue()},numberToText:function(){const t=this.SN.activeSheet;t.eachCells(t.activeAreas,(e,n)=>{const i=t.getCell(e,n);"number"==typeof i.calcVal&&(i.numFmt="@")}),this.SN.ht({type:"format",action:"numberToText",sheet:t,areas:t.activeAreas}),this.SN.ue()},toLowercase:function(){const t=this.SN.activeSheet;t.eachCells(t.activeAreas,(e,n)=>{const i=t.getCell(e,n),r=i.B;"string"!=typeof r||r.startsWith("=")||(i.editVal=r.toLowerCase())}),this.SN.ht({type:"format",action:"toLowercase",sheet:t,areas:t.activeAreas}),this.SN.ue()},toUppercase:function(){const t=this.SN.activeSheet;t.eachCells(t.activeAreas,(e,n)=>{const i=t.getCell(e,n),r=i.B;"string"!=typeof r||r.startsWith("=")||(i.editVal=r.toUpperCase())}),this.SN.ht({type:"format",action:"toUppercase",sheet:t,areas:t.activeAreas}),this.SN.ue()},trimSpaces:function(){const t=this.SN.activeSheet;t.eachCells(t.activeAreas,(e,n)=>{const i=t.getCell(e,n),r=i.B;"string"!=typeof r||r.startsWith("=")||(i.editVal=r.trim().replace(/\s+/g," "))}),this.SN.ht({type:"format",action:"trimSpaces",sheet:t,areas:t.activeAreas}),this.SN.ue()},textToColumns:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=iL(e.activeAreas?.[0]);if(!i)return void n.toast(t.t("action.format.toast.msg003"));if(i.s.c!==i.e.c)return void n.toast(t.t("action.format.toast.msg004"));if(e.areaHaveMerge(i))return void n.toast(t.t("action.format.toast.msg005"));const r=n.cellNumToStr(i.s);n.modal({titleKey:"action.format.modal.m001.title",title:t.t("action.format.modal.m001.title"),content:rL(r,t),maxWidth:"520px",confirmKey:"action.format.modal.m001.confirm",confirmText:t.t("action.format.modal.m001.confirm"),cancelKey:"action.format.modal.m001.cancel",cancelText:t.t("action.format.modal.m001.cancel"),onOpen:t=>{const e=t.querySelector('[data-field="other-delimiter"]'),n=t.querySelector('[data-key="other"]');e?.addEventListener("input",()=>{e.value&&(n.checked=!0)}),t.querySelector('[data-field="destination"]')?.focus()},onConfirm:r=>{const o=function(t,e,n){const i=Array.from(t.querySelectorAll('[data-field="delimiter"]:checked')).map(t=>t.dataset.key),r=nL.filter(t=>i.includes(t.key)).map(t=>t.value);if(i.includes("other")){const i=t.querySelector('[data-field="other-delimiter"]'),o=i?.value??"";if(!o)return e.toast(n.t("action.format.toast.msg001")),null;r.push(o[0])}return 0===r.length?(e.toast(n.t("action.format.toast.msg002")),null):r}(r,n,t);if(!o)return!1;const a=r.querySelector('[data-field="destination"]'),s=a?.value?.replace(/\$/g,"").trim(),l=n.cellStrToNum(s);if(!l||l.r<0||l.c<0)return n.toast(t.t("action.format.toast.a1")),!1;const c=r.querySelector('[data-field="text-qualifier"]')?.value??'"',h=!0===r.querySelector('[data-field="merge-consecutive"]')?.checked;let u;try{u=e.textToColumns(i,{delimiters:o,destination:l,textQualifier:c,treatConsecutiveDelimitersAsOne:h})}catch(e){return n.toast(e?.message||t.t("action.format.toast.textToColumnsFailed")),!1}return u?.success?(this.SN.ue(),n.toast(t.t("action.format.toast.textToColumnsDone",{rowCount:u.rowCount,columnCount:u.columnCount})),!0):(u?.canceled||n.toast(t.t("action.format.toast.msg007")),!1)}})},flashFill:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=iL(e.activeAreas?.[0]);if(!i)return void n.toast(t.t("action.format.toast.msg008"));if(i.s.c!==i.e.c)return void n.toast(t.t("action.format.toast.msg009"));if(e.areaHaveMerge(i))return void n.toast(t.t("action.format.toast.msg010"));let r;try{r=e.flashFill(i)}catch(e){return void n.toast(e?.message||t.t("action.format.toast.flashFillFailed"))}r?.success?(this.SN.ue(),r.filledCount>0?n.toast(t.t("action.format.toast.flashFillDone",{filledCount:r.filledCount})):n.toast(t.t("action.format.toast.msg012"))):r?.canceled||n.toast(t.t("action.format.toast.msg011"))}}),Object.assign(PP.prototype,{fillColorBtn:function(t){const e=t.target,n=e.classList;if(n.contains("sn-color-item")){const t=e.dataset.color;OI(this.SN,"fill",t),this.areasStyle("fill",{fgColor:t})}else n.contains("sn-color-no-btn")&&(OI(this.SN,"fill",""),this.areasStyle("fill",{}))},fillColorChange:function(t){const e=t.target.value;OI(this.SN,"fill",e),this.areasStyle("fill",{fgColor:e})},borderColorBtn:function(t){const e=t.target,n=e.classList;n.contains("sn-color-item")?(this.SN.activeSheet.areasBorder("all",{color:e.dataset.color}),this.SN.ue()):n.contains("sn-color-no-btn")&&(this.SN.activeSheet.areasBorder("all",{color:null}),this.SN.ue())},borderColorChange:function(t){this.SN.activeSheet.areasBorder("all",{color:t.target.value}),this.SN.ue()},fontColorBtn:function(t){const e=t.target,n=e.classList;if(n.contains("sn-color-item")){const t=e.dataset.color;OI(this.SN,"font",t),this.areasStyle("font",{color:t})}else n.contains("sn-color-no-btn")&&(OI(this.SN,"font",""),this.areasStyle("font",{color:null}))},fontColorChange:function(t){const e=t.target.value;OI(this.SN,"font",e),this.areasStyle("font",{color:e})},applyFontColor:function(){const t=BI(this.SN,"font");t?this.areasStyle("font",{color:t}):this.areasStyle("font",{color:null})},applyFillColor:function(){const t=BI(this.SN,"fill");t?this.areasStyle("fill",{fgColor:t}):this.areasStyle("fill",{})},applyBorderPreset:function(t){zI(this.SN);const e=t||this.SN.toolbarDefaults.border||"all",n=HI[e]||HI.all,i=void 0!==n.style?n.style:this.SN.toolbarDefaults.borderStyle||"thin";this.SN.toolbarDefaults.border=e,VI(this.SN,e),this.SN.activeSheet.areasBorder(n.area,i?{style:i}:null),this.SN.ue()},applyBorderStyle:function(t){zI(this.SN),this.SN.toolbarDefaults.borderStyle=t,this.SN.activeSheet.areasBorder("all",{style:t}),this.SN.ue()},initToolbarDefaults:function(){zI(this.SN),VI(this.SN,this.SN.toolbarDefaults.border)},areasStyle:UI,fontInversion:function(t,e){if(this.SN.Canvas?.inputEditing){const e=this.SN.Canvas;if(!this.SN.activeSheet.getCell(e.currentCell.r,e.currentCell.c).isFormula)return _I(e.input,t,!0),void(e.formulaBar.value=e.input.innerText)}const n=this.SN.activeSheet,i=n.activeAreas;let r=null,o=i[0];"string"==typeof o&&(o=n.rangeStrToNum(o));const{isFullRow:a,isFullCol:s}=EI(o,n);if(a&&!s){const i=n.getRow(o.s.r);r="underline"===t?i.font[t]===e?"":e:!i.font[t]}else if(s&&!a){const i=n.getCol(o.s.c);r="underline"===t?i.font[t]===e?"":e:!i.font[t]}else{const i=n.getCell(o.s.r,o.s.c);r="underline"===t?i.font[t]===e?"":e:!i.font[t]}const l=new Set,c=new Set;i.forEach(t=>{"string"==typeof t&&(t=n.rangeStrToNum(t));const e=EI(t,n);e.isFullRow&&!e.isFullCol?e.rows.forEach(t=>l.add(t)):e.isFullCol&&!e.isFullRow&&e.cols.forEach(t=>c.add(t))}),l.forEach(e=>{n.getRow(e).font={[t]:r}}),c.forEach(e=>{n.getCol(e).font={[t]:r}}),n.eachCells(i,(e,i,o)=>{const a=EI({s:o.s,e:o.e},n);a.isFullRow&&!a.isFullCol||a.isFullCol&&!a.isFullRow||(n.getCell(e,i).font={[t]:r})}),this.SN.ue()},toggleWrapText:function(){const t=this.SN.activeSheet,e=t.activeAreas;let n=null,i=e[0];"string"==typeof i&&(i=t.rangeStrToNum(i));const{isFullRow:r,isFullCol:o}=EI(i,t);n=r&&!o?!t.getRow(i.s.r).alignment?.wrapText:o&&!r?!t.getCol(i.s.c).alignment?.wrapText:!t.getCell(i.s.r,i.s.c).alignment?.wrapText;const a=new Set,s=new Set;e.forEach(e=>{"string"==typeof e&&(e=t.rangeStrToNum(e));const n=EI(e,t);n.isFullRow&&!n.isFullCol?n.rows.forEach(t=>a.add(t)):n.isFullCol&&!n.isFullRow&&n.cols.forEach(t=>s.add(t))}),a.forEach(e=>{t.getRow(e).alignment={wrapText:n}}),s.forEach(e=>{t.getCol(e).alignment={wrapText:n}}),t.eachCells(e,(e,i,r)=>{const o=EI({s:r.s,e:r.e},t);o.isFullRow&&!o.isFullCol||o.isFullCol&&!o.isFullRow||(t.getCell(e,i).alignment={wrapText:n})}),this.SN.ue()},changeFontSize:function(t=!0){const e=this.SN.activeSheet,n=e.getCell(e.activeCell.r,e.activeCell.c);if(this.SN.Canvas?.inputEditing&&!n.isFormula){const e=this.SN.Canvas,i=NI(e.input,n.font).size||11;let r=qI.findIndex(t=>t>=i);return r=-1===r?t?qI.length-1:qI.length-2:t?Math.min(r+1,qI.length-1):Math.max(r-1,0),_I(e.input,"size",qI[r]),void(e.formulaBar.value=e.input.innerText)}const i=n.style?.font?.size||11;let r=qI.findIndex(t=>t>=i);r=-1===r?t?qI.length-1:qI.length-2:t?Math.min(r+1,qI.length-1):Math.max(r-1,0),this.areasStyle("font",{size:qI[r]})},changeIndent:function(t){const e=this.SN.activeSheet,n=e.activeAreas,i=new Set,r=new Set;n.forEach(t=>{"string"==typeof t&&(t=e.rangeStrToNum(t));const n=EI(t,e);n.isFullRow&&!n.isFullCol?n.rows.forEach(t=>i.add(t)):n.isFullCol&&!n.isFullRow&&n.cols.forEach(t=>r.add(t))}),i.forEach(n=>{const i=e.getRow(n),r=parseInt(i.alignment?.indent)||0,o=Math.max(0,Math.min(250,r+t));i.alignment={indent:o||void 0}}),r.forEach(n=>{const i=e.getCol(n),r=parseInt(i.alignment?.indent)||0,o=Math.max(0,Math.min(250,r+t));i.alignment={indent:o||void 0}}),e.eachCells(n,(n,i,r)=>{const o=EI({s:r.s,e:r.e},e);if(o.isFullRow&&!o.isFullCol||o.isFullCol&&!o.isFullRow)return;const a=e.getCell(n,i),s=parseInt(a.alignment?.indent)||0,l=Math.max(0,Math.min(250,s+t));a.alignment={indent:l||void 0}}),this.SN.ue()},setTextRotation:function(t){const e=KI[t]??(parseInt(t)||0),n=this.SN.activeSheet,i=n.activeAreas,r=new Set,o=new Set;i.forEach(t=>{"string"==typeof t&&(t=n.rangeStrToNum(t));const e=EI(t,n);e.isFullRow&&!e.isFullCol?e.rows.forEach(t=>r.add(t)):e.isFullCol&&!e.isFullRow&&e.cols.forEach(t=>o.add(t))}),r.forEach(t=>{n.getRow(t).alignment={textRotation:e||void 0}}),o.forEach(t=>{n.getCol(t).alignment={textRotation:e||void 0}}),n.eachCells(i,(t,i,r)=>{const o=EI({s:r.s,e:r.e},n);o.isFullRow&&!o.isFullCol||o.isFullCol&&!o.isFullRow||(n.getCell(t,i).alignment={textRotation:e||void 0})}),this.SN.ue()},applyCellStyle:function(t){let e=null;for(const i of Object.values(FI))if(e=i.find(e=>e.name===t),e)break;if(!e)return;const n=this.SN.activeSheet;e.font&&UI.call(this,"font",e.font),e.fill&&UI.call(this,"fill",e.fill),e.border&&n.areasBorder(e.border.area||"all",{style:e.border.style||"thin",color:e.border.color}),e.border2&&n.areasBorder(e.border2.area||"all",{style:e.border2.style||"thin",color:e.border2.color}),e.numFmt&&n.eachCells(n.activeAreas,(t,i)=>{n.getCell(t,i).numFmt=e.numFmt}),this.SN.ue()}}),Object.assign(PP.prototype,{insertImages:async function(){if(!window.showOpenFilePicker)return void this.SN.Utils.toast(this.SN.t("action.insert.content.imagePickerNotSupported"));const t=await window.showOpenFilePicker({types:[{description:this.SN.t("action.insert.content.imageFileDescription"),accept:{"image/*":[".png",".jpg",".jpeg",".gif",".bmp",".webp",".svg"]}}],multiple:!0}),e=this.SN.activeSheet;let n=0,i=0;for(let r=0;r<t.length;r++){const o=t[r],a=await o.getFile(),s=await tL(a);e.Drawing.addImage(s,{offsetX:n,offsetY:i}),n+=20,i+=20}this.SN.ue()},insertAreaScreenshot:async function(){const t=this.SN.activeSheet,e=t.activeAreas[t.activeAreas.length-1];if(!e)return;let n=0,i=0;for(let h=e.s.c;h<=e.e.c;h++){const e=t.getCol(h);e.hidden||(n+=e.width)}for(let h=e.s.r;h<=e.e.r;h++){const e=t.getRow(h);e.hidden||(i+=e.height)}if(n<=0||i<=0)return this.SN.Utils.toast(this.SN.t("action.insert.toast.msg001"));const r=t.indexWidth,o=t.headHeight,a=this.SN.Utils.cellNumToStr(e.s),s=await this.SN.Canvas.captureScreenshot(a,"topleft",{width:n+r,height:i+o,compress:!1,hideSelectionFrame:!0}),l=new Image;l.src=s,await new Promise(t=>{l.onload=t});const c=document.createElement("canvas");c.width=Math.round(2*n),c.height=Math.round(2*i),c.getContext("2d").drawImage(l,Math.round(2*r),Math.round(2*o),c.width,c.height,0,0,c.width,c.height),t.Drawing.addImage(c.toDataURL("image/png"),{width:n,height:i}),this.SN.ue()},insertChart:function(t){const e=this.SN.activeSheet,n=e.activeAreas;if(!n||0===n.length)return this.SN.Utils.toast(this.SN.t("chart.toast.selectRange"));const i=n[n.length-1];let r=[];for(let u=i.s.r;u<=i.e.r;u++){const t=[];for(let n=i.s.c;n<=i.e.c;n++){const i=e.getCell(u,n);t.push(i.showVal||"")}r.push(t)}if(0===r.length)return this.SN.Utils.toast(this.SN.t("chart.toast.rangeEmpty"));const o=r.length-1>(r[0]?.length||1)-1;if(o){const t=r[0].length,e=r.length,n=[];for(let i=0;i<t;i++){const t=[];for(let n=0;n<e;n++)t.push(r[n][i]??"");n.push(t)}r=n}const a=r[0].slice(1),s=function(t,e){if(!e)return null;const n=String(e).trim();if(!n)return null;const i=n.toLowerCase(),r=function(t,e){const n="string"==typeof e?e.trim():"";if(!n)return"";for(const i of R_){if(i.key===n||t.t(i.labelKey)===n)return i.key;for(const e of i.items)if(e.key===n||t.t(e.labelKey)===n)return e.key}return""}(t,n),o=oL[i]||r||n;let a=o,s="";if(o.includes("_")){const t=o.split("_");a=t.shift(),s=t.join("_")}s||(s={bar:"clustered",barh:"clustered",histogram:"basic",line:"basic",area:"basic",pie:"basic",scatter:"basic",radar:"basic"}[a]||"");let l="vertical",c=a;"barh"===a&&(c="bar",l="horizontal");const h=s.includes("stacked")||s.includes("percent"),u=s.includes("percent"),d=s.includes("marker"),f=s.includes("smooth"),p=s.includes("doughnut"),m=s.includes("bubble"),g=s.includes("filled"),v=s.includes("line")||f,y=R_.find(t=>t.key===a),b=y?t.t(y.labelKey):n,x=function(t,e,n=""){const i=function(t){for(const e of R_){const n=e.items.find(e=>e.key===t);if(n)return{...n,category:e}}return null}(e);return i?t.t(i.labelKey):n||e||""}(t,o,b||n);return{key:o,base:c,baseKey:a,variant:s,label:x,orientation:l,stacked:h,percent:u,markers:d,smooth:f,doughnut:p,radarFilled:g,bubble:m,lineLike:v,supported:aL.has(c)}}(this.SN,t||this.SN.chartSelection?.item);if(!s)return this.SN.Utils.toast(this.SN.t("chart.toast.noType"));if(!s.supported)return this.SN.Utils.toast(this.SN.t("chart.toast.unsupportedType",{label:s.label}));const l=[];for(let u=1;u<r.length;u++){const t=r[u][0],e=r[u].slice(1).map(t=>{const e=parseFloat(t);return isNaN(e)?0:e});l.push({name:t,data:e})}const c=function(t,e,n,i){if(!e||!e.supported)return null;const r={title:{text:e.label||e.key},tooltip:{trigger:"pie"===e.base?"item":"axis"},legend:{data:"pie"===e.base?n:i.map(t=>t.name)}};if("stock"===e.base)return function(t,e,n,i){const r=yL(i,["开盘","open"]),o=yL(i,["收盘","close"]),a=yL(i,["最高","high"]),s=yL(i,["最低","low"]),l=yL(i,["成交量","volume","vol"]),c=i.filter(t=>![r,o,a,s,l].includes(t)),[h,u,d,f]=c,p=r?.data??h?.data??[],m=a?.data??u?.data??[],g=s?.data??d?.data??[],v=o?.data??f?.data??p,y=l?.data??[],b=(n||[]).map((t,e)=>[dL(p[e],0),dL(v[e],0),dL(g[e],0),dL(m[e],0)]),x={title:{text:e.label},tooltip:{trigger:"axis"},legend:{data:[]},xAxis:{type:"category",data:n},yAxis:{type:"value"},series:[{name:e.label,type:"candlestick",data:b}]};return y&&y.length&&x.series.push({name:t.t("action.insert.content.chart.volume"),type:"bar",data:gL(y)}),x}(t,e,n,i);if("sunburst"===e.base)return bL(e,n,i,"sunburst");if("treemap"===e.base)return bL(e,n,i,"treemap");if("funnel"===e.base)return function(t,e,n,i){const r=vL(n,i,0,t);return{title:{text:e.label},tooltip:{trigger:"item"},legend:{show:!1},series:[{name:e.label,type:"funnel",sort:"descending",data:r}]}}(t,e,n,i);if("waterfall"===e.base)return function(t,e,n,i){const r=gL(i[0]?.data);let o=0;const a=[],s=r.map(t=>{const e=o;return o+=t,a.push(e),t}),l=i[0]?.name||e.label;return{title:{text:e.label},tooltip:{trigger:"axis"},legend:{top:40,left:"center",data:[l]},xAxis:{type:"category",data:n},yAxis:{type:"value"},series:[{name:t.t("action.insert.content.chart.assist"),type:"bar",stack:"total",itemStyle:{color:"transparent"},data:a},{name:l,type:"bar",stack:"total",itemStyle:{color:t=>(s[t.dataIndex]??0)>=0?"#70AD47":"#ED7D31"},data:s}]}}(t,e,n,i);if("histogram"===e.base)return function(t,e,n){const i=gL(n[0]?.data),r=n[0]?.name||t.label;return{title:{text:t.label},tooltip:{trigger:"axis"},legend:{show:!1},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:[{name:r,type:"bar",data:i,barGap:"0%",barCategoryGap:"0%"}]}}(e,n,i);if("combo"===e.base)return function(t,e,n){const i={title:{text:t.label},tooltip:{trigger:"axis"},legend:{data:n.map(t=>t.name)},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:[]};if(!n.length)return i;const r=n[0],o=n[1];if(r&&i.series.push({name:r.name,type:"bar",data:r.data}),o){const e={name:o.name,type:"line",data:o.data};t.variant.includes("area")&&(e.areaStyle={}),i.series.push(e)}else t.variant.includes("area")&&(i.series[0].type="line",i.series[0].areaStyle={});return i}(e,n,i);if("pie"===e.base){r.legend.data=n;const o=n.map((t,e)=>({name:t,value:i[0]?.data[e]||0}));return r.series=[{name:i[0]?.name||t.t("action.insert.content.chart.defaultSeries"),type:"pie",radius:e.doughnut?["40%","70%"]:"60%",data:o,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:!1}}],r}if("radar"===e.base)return r.radar={indicator:n.map(t=>({name:t}))},r.series=i.map(t=>({name:t.name,type:"radar",data:[{value:t.data,name:t.name}],symbolSize:e.markers?6:0})),e.radarFilled&&(r.series=r.series.map(t=>({...t,areaStyle:{}}))),r;if("scatter"===e.base)return r.xAxis={type:"value"},r.yAxis={type:"value"},r.series=function(t,e,n){const i=e.map((t,e)=>dL(t,e+1)),r=t.lineLike?"line":"scatter",o=!t.lineLike||t.markers,a=t=>t.map((t,e)=>[i[e]??e+1,t]);return n.map(e=>{if(t.bubble&&"scatter"===r){const t=(t=>t.map((t,e)=>{const n=i[e]??e+1;if(Array.isArray(t)){const e=dL(t[1]??t[0],0);return[n,e,dL(t.length>2?t[2]:e,e)]}const r=dL(t,0);return[n,r,r]}))(e.data),n=(t=>{const e=t.map(t=>dL(t[2]??t[1]??t[0],0)),n=Math.min(...e),i=Math.max(...e);if(!Number.isFinite(n)||!Number.isFinite(i)||i===n){const t=18;return{min:n,max:i,symbolSize:()=>t}}return{min:n,max:i,symbolSize:t=>6+(dL(Array.isArray(t)?t[2]??t[1]??t[0]:t,n)-n)/(i-n)*24}})(t);return{name:e.name,type:"scatter",data:t,smooth:!1,showSymbol:!0,symbolSize:n.symbolSize,__bubble:!0,__bubbleMin:n.min,__bubbleMax:n.max}}return{name:e.name,type:r,data:a(e.data),smooth:t.smooth,showSymbol:o}})}(e,n,i),r.tooltip.trigger=e.lineLike?"axis":"item",r;const o=e.percent,a=o?function(t){if(!t.length)return[];const e=t[0].data.length,n=new Array(e).fill(0);return t.forEach(t=>{t.data.forEach((t,e)=>{n[e]+=t})}),t.map(t=>({name:t.name,data:t.data.map((t,e)=>{const i=n[e];return i?Math.round(t/i*1e4)/100:0})}))}(i):i,s={type:"value",max:o?100:void 0,axisLabel:o?{formatter:"{value}%"}:void 0};return"horizontal"===e.orientation?(r.xAxis=s,r.yAxis={type:"category",data:n}):(r.xAxis={type:"category",data:n},r.yAxis=s),r.series=a.map(t=>{const n={name:t.name,type:"bar"===e.base?"bar":"line",data:t.data};return e.stacked&&(n.stack="total"),"area"===e.base&&(n.areaStyle={}),"bar"!==e.base&&(n.showSymbol=e.markers,n.smooth=e.smooth),n}),r}(this.SN,s,a,l);if(!c)return this.SN.Utils.toast(this.SN.t("chart.toast.unsupportedType",{label:s.label}));s.percent&&(c.__percent=!0);const h=function(t,e,n){if(n){const n=mL(t,e.s.r+1,e.s.c,e.e.r,e.s.c),i=[];for(let r=e.s.c+1;r<=e.e.c;r++)i.push({name:pL(t,e.s.r,r),data:mL(t,e.s.r+1,r,e.e.r,r)});return{categories:n,series:i}}const i=mL(t,e.s.r,e.s.c+1,e.s.r,e.e.c),r=[];for(let o=e.s.r+1;o<=e.e.r;o++)r.push({name:pL(t,o,e.s.c),data:mL(t,o,e.s.c+1,o,e.e.c)});return{categories:i,series:r}}(e,i,o);return c.__excelRef=h,["sunburst","treemap","funnel","waterfall","histogram","stock","combo","pie","radar","scatter"].includes(s.base)||("category"===c.xAxis?.type&&(c.xAxis.data=h.categories),"category"===c.yAxis?.type&&(c.yAxis.data=h.categories),c.series?.forEach((t,e)=>{h.series[e]&&(t.name=h.series[e].name,t.data=h.series[e].data)}),c.legend?.data&&(c.legend.data=h.series.map(t=>t.name))),["sunburst","treemap","funnel","waterfall","histogram"].includes(s.base)&&(c.__chartType=s.base,c.__excelHidden=h.series.map((t,e)=>e>0),"waterfall"===s.base?c.__waterfall={categories:h.categories,values:h.series?.[0]?.data||"",seriesName:l[0]?.name||s.label}:"histogram"===s.base&&(c.__histogram={intervalClosed:"r"})),e.Drawing.addChart(c),this.SN.ue(),!0},openChartModal:async function(t,e){const n=I_(this.SN),i=n.find(e=>e.key===t)||n[0];try{await this.SN.Utils.modal({titleKey:"chart.modal.title",title:"Insert Chart",content:cL(n),maxWidth:"580px",confirmKey:"chart.modal.confirm",confirmText:"Insert",cancelKey:"common.cancel",cancelText:"Cancel",onOpen:t=>{!function(t,e,n){const i=t.querySelector(".sn-chart-modal");if(!i)return;const r=Array.from(i.querySelectorAll(".sn-chart-tab")),o=Array.from(i.querySelectorAll(".sn-chart-panel")),a=t=>{t&&(i.querySelectorAll(".sn-chart-item.selected").forEach(t=>t.classList.remove("selected")),t.classList.add("selected"),i.dataset.selectedCategory=t.dataset.category||"",i.dataset.selectedItem=t.dataset.item||"")},s=t=>{const e=t||R_[0]?.key;r.forEach(t=>t.classList.toggle("active",t.dataset.category===e)),o.forEach(t=>t.classList.toggle("active",t.dataset.category===e)),i.dataset.selectedCategory=e;const n=i.querySelector(`.sn-chart-panel[data-category="${e}"]`);n?.querySelector(".sn-chart-item.selected")||a(n?.querySelector(".sn-chart-item"))};if(s(e?.key),n){const t=i.querySelector(`.sn-chart-item[data-item="${n}"]`);t&&(s(t.dataset.category),a(t))}i.addEventListener("click",t=>{const e=t.target.closest(".sn-chart-tab");if(e)return void s(e.dataset.category);const n=t.target.closest(".sn-chart-item");n&&a(n)})}(t,i,e)},onConfirm:t=>{const e=t.querySelector(".sn-chart-modal");if(!e)return;const n=e.dataset.selectedItem||"";n&&this.insertChart(n)}})}catch(t){}},insertComment:async function(){const t=this.SN.activeSheet,e=t.activeCell,n=this.SN.Utils.cellNumToStr(e),i=t.Comment.get(n),r=i?"action.insert.modal.m001.titleEdit":"action.insert.modal.m001.titleInsert",o=await this.SN.Utils.modal({titleKey:r,title:this.SN.t(r),maxWidth:"400px",content:`\n            <div style="margin-bottom: 10px;">\n                <label style="display: block; margin-bottom: 5px;">Cell: ${n}</label>\n            </div>\n            <div style="margin-bottom: 10px;">\n                <label style="display: block; margin-bottom: 5px;">Note:</label>\n                <textarea data-field="comment-text" style="width: 100%;border:1px solid #ccc; height: 80px; resize: none; padding: 8px; box-sizing: border-box;">${i?.text||""}</textarea>\n            </div>\n        `,confirmKey:"action.insert.modal.m001.confirm",confirmText:"OK",cancelKey:"action.insert.modal.m001.cancel",cancelText:"Cancel"});if(!o)return;const a=o.bodyEl.querySelector('[data-field="comment-text"]'),s=a?.value?.trim();s?(i?i.text=s:t.Comment.add({cellRef:n,text:s}),this.SN.ue()):i&&(t.Comment.remove(n),this.SN.ue())},insertHyperlink:async function(){const t=this.SN.activeSheet,e=t.activeCell,n=t.getCell(e.r,e.c),i=n.hyperlink,r=n.editVal||"",o=this.SN.sheets.map(t=>t.name),a=o.map(t=>`<option value="${t}">${t}</option>`).join("");let s=o[0]||"",l="A1";if(i?.location){const t=i.location.match(/^(.+?)!(.+)$/);t&&(s=t[1].replace(/^'|'$/g,""),l=t[2])}const c=!i||i.target,h=this.SN,u=(t,e={})=>h.t(t,e),d=i?"action.insert.modal.m004.titleEdit":"action.insert.modal.m004.titleInsert",f=i?"action.insert.modal.m004.cancelRemove":"action.insert.modal.m004.cancel";try{await h.Utils.modal({titleKey:d,title:h.t(d),content:`\n                <style>\n                    .sn-hyperlink-form { display: flex; flex-direction: column; gap: 12px; min-width: 320px; }\n                    .sn-hyperlink-form label { display: block; font-size: 13px; color: #333; margin-bottom: 4px; }\n                    .sn-hyperlink-form input, .sn-hyperlink-form select {\n                        width: 100%; height: 32px; padding: 0 8px; border: 1px solid #d0d0d0;\n                        border-radius: 4px; font-size: 13px; box-sizing: border-box;\n                    }\n                    .sn-hyperlink-form input:focus, .sn-hyperlink-form select:focus {\n                        outline: none; border-color: #4f7cf6; box-shadow: 0 0 0 2px rgba(79,124,246,0.15);\n                    }\n                    .sn-hyperlink-row { display: flex; gap: 8px; }\n                    .sn-hyperlink-row > div { flex: 1; }\n                </style>\n                <div class="sn-hyperlink-form">\n                    <div>\n                        <label>${u("action.insert.modal.m004.label.displayText")}</label>\n                        <input type="text" data-field="link-text" placeholder="${u("action.insert.modal.m004.placeholder.displayText")}" value="${r}">\n                    </div>\n                    <div>\n                        <label>${u("action.insert.modal.m004.label.linkType")}</label>\n                        <select data-field="link-type">\n                            <option value="external" ${c?"selected":""}>${u("action.insert.modal.m004.option.external")}</option>\n                            <option value="internal" ${c?"":"selected"}>${u("action.insert.modal.m004.option.internal")}</option>\n                        </select>\n                    </div>\n                    <div data-field="link-external" style="display:${c?"block":"none"}">\n                        <label>${u("action.insert.modal.m004.label.address")}</label>\n                        <input type="text" data-field="link-target" placeholder="${u("action.insert.modal.m004.placeholder.address")}" value="${i?.target||""}">\n                    </div>\n                    <div data-field="link-internal" style="display:${c?"none":"block"}">\n                        <label>${u("action.insert.modal.m004.label.targetLocation")}</label>\n                        <div class="sn-hyperlink-row">\n                            <div>\n                                <select data-field="link-sheet">${a}</select>\n                            </div>\n                            <div>\n                                <input type="text" data-field="link-cell" placeholder="${u("action.insert.modal.m004.placeholder.cell")}" value="${l}">\n                            </div>\n                        </div>\n                    </div>\n                    <div>\n                        <label>${u("action.insert.modal.m004.label.screenTip")}</label>\n                        <input type="text" data-field="link-tooltip" placeholder="${u("action.insert.modal.m004.placeholder.screenTip")}" value="${i?.tooltip||""}">\n                    </div>\n                </div>\n            `,confirmKey:"action.insert.modal.m004.confirm",confirmText:"OK",maxWidth:"400px",cancelKey:f,cancelText:h.t(f),onOpen(t){t.querySelector('[data-field="link-sheet"]').value=s;const e=t.querySelector('[data-field="link-type"]'),n=t.querySelector('[data-field="link-external"]'),i=t.querySelector('[data-field="link-internal"]');e.onchange=()=>{n.style.display="external"===e.value?"block":"none",i.style.display="internal"===e.value?"block":"none"}},onConfirm(t){const e=t.querySelector('[data-field="link-type"]').value,i=t.querySelector('[data-field="link-text"]').value.trim(),r=t.querySelector('[data-field="link-tooltip"]').value.trim(),o=t.querySelector('[data-field="link-target"]').value.trim(),a=t.querySelector('[data-field="link-sheet"]').value,s=t.querySelector('[data-field="link-cell"]').value.trim().toUpperCase()||"A1";if("external"===e&&!o)return h.Utils.toast(h.t("action.insert.toast.pleaseEnterALinkAddress")),!1;const l={};"external"===e?l.target=o:l.location=a.includes(" ")?`'${a}'!${s}`:`${a}!${s}`,r&&(l.tooltip=r),n.hyperlink=l,n.editVal=i||o||l.location,h.ue()}})}catch(t){}},insertTextBox:function(t="horizontal"){const e=this.SN.activeSheet,n=function(t){return"vertical"===t?"vertical":"horizontal"}(t),i=lL[n]||lL.horizontal,r="vertical"===n?"r":"l",o=e.activeCell||{r:0,c:0};return!!e.Drawing.addShape("rect",{isTextBox:!0,startCell:{r:o.r,c:o.c},width:i.width,height:i.height,shapeText:this.SN.t("action.insert.content.textBox.defaultText"),shapeStyle:{fill:"#FFFFFF",stroke:"#7F7F7F",strokeWidth:.75,textColor:"#000000",fontSize:11,textAlign:r,textDirection:n,startArrow:"none",endArrow:"none"}})&&(this.SN.ue(),!0)},insertSparkline:function(t){const e=this.SN,n=e.activeSheet,i=n.activeAreas;if(!i||0===i.length)return e.Utils.toast(e.t("action.insert.toast.msg002")),!1;if(!n.Sparkline)return e.Utils.toast(e.t("action.insert.toast.msg003")),!1;const r=i[i.length-1],o=mL(n,r.s.r,r.s.c,r.e.r,r.e.c),a=n.activeCell,s=uL(t);return n.Sparkline.add({r:a.r,c:a.c,formula:o,type:s}),e.ue(),!0},openSparklineDialog:async function(t){const e=this.SN,n=e.activeSheet,i=n.activeAreas,r=i&&i.length?i[i.length-1]:null,o=r?`${n.name}!${e.Utils.rangeNumToStr(r)}`:"",a=n.Utils.cellNumToStr(n.activeCell),s=hL(t),l=Object.entries(sL).map(([t,n])=>`<option value="${t}" ${t===s?"selected":""}>${e.t(n)}</option>`).join("");try{await e.Utils.modal({titleKey:"action.insert.modal.m003.title",title:e.t("action.insert.modal.m003.title"),maxWidth:"420px",content:`\n                <div style="display:flex;flex-direction:column;gap:12px;">\n                    <div>\n                        <div style="margin-bottom:6px;font-size:13px;color:#333;">${e.t("action.insert.content.sparkline.rangeLabel")}</div>\n                        <input type="text" data-field="sparkline-range" value="${o}" style="width:100%;" />\n                    </div>\n                    <div>\n                        <div style="margin-bottom:6px;font-size:13px;color:#333;">${e.t("action.insert.content.sparkline.locationLabel")}</div>\n                        <input type="text" data-field="sparkline-location" value="${a}" style="width:100%;" />\n                    </div>\n                    <div>\n                        <div style="margin-bottom:6px;font-size:13px;color:#333;">${e.t("action.insert.content.sparkline.typeLabel")}</div>\n                        <select data-field="sparkline-type" style="width:100%;">${l}</select>\n                    </div>\n                </div>\n            `,confirmKey:"action.insert.modal.m003.confirm",confirmText:e.t("action.insert.modal.m003.confirm"),cancelKey:"action.insert.modal.m003.cancel",cancelText:e.t("action.insert.modal.m003.cancel"),onConfirm:t=>{const i=t.querySelector('[data-field="sparkline-range"]').value.trim(),r=t.querySelector('[data-field="sparkline-location"]').value.trim(),o=t.querySelector('[data-field="sparkline-type"]').value,{formula:a}=function(t,e,n){const i=String(n||"").trim();if(!i)throw t.t("action.insert.content.sparkline.rangeRequired");let r=e,o=i;if(i.includes("!")){const[e,n]=i.split("!"),a=e.replace(/^'|'$/g,""),s=t.getSheet(a);if(!s)throw t.t("action.insert.content.sparkline.sheetNotFound",{name:a});r=s,o=n}let a=null;try{a=r.rangeStrToNum(o)}catch(e){throw t.t("action.insert.content.sparkline.rangeInvalid")}if(!a)throw t.t("action.insert.content.sparkline.rangeInvalid");return{sourceSheet:r,rangeObj:a,formula:mL(r,a.s.r,a.s.c,a.e.r,a.e.c)}}(e,n,i),{targetSheet:s,cellObj:l}=function(t,e,n){const i=String(n||"").trim();if(!i)throw t.t("action.insert.content.sparkline.locationRequired");let r=e,o=i;if(i.includes("!")){const[e,n]=i.split("!"),a=e.replace(/^'|'$/g,""),s=t.getSheet(a);if(!s)throw t.t("action.insert.content.sparkline.sheetNotFound",{name:a});r=s,o=n}if(o.includes(":"))throw t.t("action.insert.content.sparkline.locationSingleCell");const a=r.Utils.cellStrToNum(o);if(!a)throw t.t("action.insert.content.sparkline.locationInvalid");return{targetSheet:r,cellObj:a}}(e,n,r);if(!s.Sparkline)throw e.t("action.insert.content.sparkline.moduleNotReady");s.Sparkline.add({r:l.r,c:l.c,formula:a,type:uL(o)}),e.activeSheet=s,e.ue()}})}catch(t){}}}),Object.assign(PP.prototype,{fullScreen:function(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},moreSheet:function(t){let e="";const n=this.SN.namespace;this.SN.sheets.forEach(t=>{t.name!==this.SN.activeSheet.name?t.hidden||(e+=`<li onmousedown="${n}.activeSheet=${n}.getSheet('${t.name}')" ontouchstart="${n}.activeSheet=${n}.getSheet('${t.name}')">${t.name}</li>`):e+=`<li class="sn-text-primary" data-ds="true">${t.name}</li>`}),t.nextElementSibling.innerHTML=e},rename:function(){const t=this.SN.t("workbook.renamePrompt"),e=prompt(t,this.SN.workbookName);e&&(this.SN.workbookName=e)},newWorkbook:function(){this.SN.IO.setData({version:"2.0",workbookName:this.SN.t("workbook.defaultName"),activeSheet:"Sheet1",styleTable:{fonts:[],fills:[],borders:[],aligns:[]},sheets:[{name:"Sheet1",rows:[]}]})},confirmNewWorkbook:function(){const t=this.SN;t.Utils.modal({titleKey:"workbook.modal.newWorkbook.title",title:t.t("workbook.modal.newWorkbook.title"),contentKey:"workbook.modal.newWorkbook.content",content:t.t("workbook.modal.newWorkbook.content"),confirmKey:"common.ok",confirmText:t.t("common.ok"),cancelKey:"common.cancel",cancelText:t.t("common.cancel"),maxWidth:"400px"}).then(t=>{t&&this.newWorkbook()})},importFromUrl:function(){const t=t=>this.SN.t(t),e=`\n        <input type="text" class="sn-url-input" placeholder="${t("workbook.importFromUrl.placeholder")}" style="width:100%;margin:2px 0 8px">\n        <div style="color:#999;font-size:12px;">${t("workbook.importFromUrl.hint")}</div>\n    `;this.SN.Utils.modal({titleKey:"workbook.importFromUrl.title",title:t("workbook.importFromUrl.title"),content:e,confirmKey:"workbook.importFromUrl.confirm",confirmText:t("workbook.importFromUrl.confirm"),cancelKey:"common.cancel",cancelText:t("common.cancel"),maxWidth:"400px",onConfirm:()=>{const e=this.SN.containerDom.querySelector(".sn-url-input")?.value?.trim();return e?(this.SN.IO.importFromUrl(e),!0):Promise.reject(t("workbook.importFromUrl.errors.urlRequired"))}})},showProperties:function(){const t=this.SN,e=t.properties,n=(e,n={})=>t.t(e,n),i=t=>{if(!t)return"";const e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),o=e.getHours(),a=e.getMinutes();return`${n}/${i}/${r} ${o}:${String(a).padStart(2,"0")}`},r=e.fileSize?n("action.workbook.properties.fileSize",{size:(e.fileSize/1024).toFixed(1)}):n("action.workbook.properties.notAvailable"),o="width:100%;padding:4px 6px;border:none;border-bottom:1px solid #ddd;box-sizing:border-box;background:transparent;color:#0066cc;font-size:13px;outline:none;",a="width:100%;padding:4px 6px;border:none;box-sizing:border-box;background:transparent;color:#666;font-size:13px;",s="display:flex;align-items:flex-start;margin-bottom:6px;min-height:24px;",l="width:100px;flex-shrink:0;color:#666;font-size:13px;padding-top:4px;",c="font-weight:bold;color:#666;font-size:13px;margin:16px 0 10px;",h="display:flex;align-items:center;margin-bottom:8px;",u="width:32px;height:32px;border-radius:50%;background:#e0e0e0;display:flex;align-items:center;justify-content:center;margin-right:10px;font-size:14px;color:#666;flex-shrink:0;",d=`\n        <div class="sn-scrollbar" style="max-height:480px;overflow-y:auto;padding:0 8px;">\n            <div style="${c}">${n("action.workbook.properties.section.properties")}</div>\n\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.size")}</label>\n                <span style="${a}">${r}</span>\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.title")}</label>\n                <input type="text" data-prop="title" value="${e.title||""}" placeholder="${n("action.workbook.properties.placeholder.title")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.keywords")}</label>\n                <input type="text" data-prop="keywords" value="${e.keywords||""}" placeholder="${n("action.workbook.properties.placeholder.keywords")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.description")}</label>\n                <input type="text" data-prop="description" value="${e.description||""}" placeholder="${n("action.workbook.properties.placeholder.description")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.template")}</label>\n                <span style="${a}">${e.template||""}</span>\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.status")}</label>\n                <input type="text" data-prop="contentStatus" value="${e.contentStatus||""}" placeholder="${n("action.workbook.properties.placeholder.status")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.category")}</label>\n                <input type="text" data-prop="category" value="${e.category||""}" placeholder="${n("action.workbook.properties.placeholder.category")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.subject")}</label>\n                <input type="text" data-prop="subject" value="${e.subject||""}" placeholder="${n("action.workbook.properties.placeholder.subject")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.hyperlinkBase")}</label>\n                <input type="text" data-prop="hyperlinkBase" value="${e.hyperlinkBase||""}" placeholder="${n("action.workbook.properties.placeholder.hyperlinkBase")}" style="${o}">\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.company")}</label>\n                <input type="text" data-prop="company" value="${e.company||""}" placeholder="${n("action.workbook.properties.placeholder.company")}" style="${o}">\n            </div>\n\n            <div style="${c}">${n("action.workbook.properties.section.dates")}</div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.lastModified")}</label>\n                <span style="${a}">${i(e.modified)}</span>\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.created")}</label>\n                <span style="${a}">${i(e.created)}</span>\n            </div>\n            <div style="${s}">\n                <label style="${l}">${n("action.workbook.properties.label.lastPrinted")}</label>\n                <span style="${a}">${i(e.lastPrinted)||""}</span>\n            </div>\n\n            <div style="${c}">${n("action.workbook.properties.section.people")}</div>\n            <div style="${h}">\n                <label style="${l}">${n("action.workbook.properties.label.manager")}</label>\n                <div style="flex:1;display:flex;align-items:center;">\n                    <div style="${u}">${n("action.workbook.properties.avatar.manager")}</div>\n                    <input type="text" data-prop="manager" value="${e.manager||""}" placeholder="${n("action.workbook.properties.placeholder.manager")}" style="${o}flex:1;">\n                </div>\n            </div>\n            <div style="${h}">\n                <label style="${l}">${n("action.workbook.properties.label.author")}</label>\n                <div style="flex:1;display:flex;align-items:center;">\n                    <div style="${u}">${(e.creator||n("action.workbook.properties.avatar.authorFallback"))[0].toUpperCase()}</div>\n                    <input type="text" data-prop="creator" value="${e.creator||""}" placeholder="${n("action.workbook.properties.placeholder.author")}" style="${o}flex:1;">\n                </div>\n            </div>\n            <div style="${h}">\n                <label style="${l}">${n("action.workbook.properties.label.lastModifiedBy")}</label>\n                <div style="flex:1;display:flex;align-items:center;">\n                    <div style="${u}">${(e.lastModifiedBy||n("action.workbook.properties.avatar.userFallback"))[0].toUpperCase()}</div>\n                    <span style="${a}">${e.lastModifiedBy||""}</span>\n                </div>\n            </div>\n        </div>\n    `;t.Utils.modal({titleKey:"action.workbook.modal.m003.title",title:n("action.workbook.modal.m003.title"),content:d,maxWidth:"420px",confirmKey:"action.workbook.modal.m003.confirm",confirmText:n("action.workbook.modal.m003.confirm"),cancelKey:"action.workbook.modal.m003.cancel",cancelText:n("action.workbook.modal.m003.cancel"),onConfirm:n=>(n.querySelectorAll("[data-prop]").forEach(t=>{const n=t.dataset.prop,i=t.value.trim();e[n]=i}),t.Utils.toast(t.t("action.workbook.toast.propertiesSaved")),!0)})}}),Object.assign(PP.prototype,{zoomCustom:function(){const t=this.SN,e=`\n        <div class="sn-zoom-dialog sn-numfmt-dialog">\n            <div class="sn-zoom-row sn-numfmt-row">\n                <label>Zoom Scale</label>\n                <input type="number" class="sn-zoom-input" min="10" max="400" value="${Math.round(100*(t.activeSheet?.zoom??1))}">\n                <span class="sn-zoom-suffix">%</span>\n            </div>\n        </div>\n    `;t.Utils.modal({titleKey:"action.view.modal.m001.title",title:"Custom Zoom",maxWidth:"300px",content:e,confirmKey:"action.view.modal.m001.confirm",confirmText:"Apply",cancelKey:"action.view.modal.m001.cancel",cancelText:"Cancel",onOpen:t=>{const e=t.querySelector(".sn-zoom-input");e&&(e.focus(),e.select(),e.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),t.closest(".sn-modal")?.querySelector(".sn-modal-btn-confirm")?.click())}))},onConfirm:e=>{const n=e.querySelector(".sn-zoom-input"),i=Number(n?.value);if(!Number.isFinite(i))return t.Utils.toast(t.t("action.view.toast.pleaseEnterANumberBetween")),!1;const r=Math.min(400,Math.max(10,Math.round(i)));return t.activeSheet&&(t.activeSheet.zoom=r/100),!0}})},freezeRows:function(t){const e=this.SN.activeSheet,n=e.vi?.rowArr?.[0]??0;e.yo=n,e.frozenRows=n+t,this.SN.ue()},freezeCols:function(t){const e=this.SN.activeSheet,n=e.vi?.colArr?.[0]??0;e.wo=n,e.frozenCols=n+t,this.SN.ue()},freezeRowsAndCols:function(t,e){const n=this.SN.activeSheet,i=n.vi?.rowArr?.[0]??0,r=n.vi?.colArr?.[0]??0;n.yo=i,n.wo=r,n.frozenRows=i+t,n.frozenCols=r+e,this.SN.ue()},freezeAtActiveCell:function(){const t=this.SN.activeSheet,e=t.activeAreas[t.activeAreas.length-1],n=e.s.r,i=e.s.c;if(0===n&&0===i)return void this.SN.Utils.toast(this.SN.t("action.view.toast.msg002"));const r=t.vi?.rowArr?.[0]??0,o=t.vi?.colArr?.[0]??0;t.yo=r,t.wo=o,t.frozenRows=n,t.frozenCols=i,this.SN.ue()},freezeToCurrentRow:function(){const t=this.SN.activeSheet,e=t.activeAreas[t.activeAreas.length-1].s.r;if(0===e)return void this.SN.Utils.toast(this.SN.t("action.view.toast.msg003"));const n=t.vi?.rowArr?.[0]??0;t.yo=n,t.frozenRows=e,this.SN.ue()},freezeToCurrentCol:function(){const t=this.SN.activeSheet,e=t.activeAreas[t.activeAreas.length-1].s.c;if(0===e)return void this.SN.Utils.toast(this.SN.t("action.view.toast.msg004"));const n=t.vi?.colArr?.[0]??0;t.wo=n,t.frozenCols=e,this.SN.ue()},unfreeze:function(){const t=this.SN.activeSheet;t.yo=0,t.wo=0,t.frozenCols=0,t.frozenRows=0,this.SN.ue()}}),Object.assign(PP.prototype,{saveToLocal:async function(){const t=this.SN;try{const e=await t.IO.getData(),n=JSON.stringify(e),i=2*n.length,r=function(t){if(!t)return"";const e=(new TextEncoder).encode(t);let n="";for(let i=0;i<e.length;i+=2){const t=e[i],r=e[i+1]||0;n+=String.fromCharCode(t<<8|r)}return e.length+"|"+n}(n),o=2*r.length,a=(100*(1-o/i)).toFixed(1);if(o>wL)return t.Utils.toast(t.t("action.storage.toast.saveTooLarge",{originalSize:SL(i),compressedSize:SL(o),limitSize:SL(wL)}));const s=function(){let t=0;for(const e in localStorage)localStorage.hasOwnProperty(e)&&(t+=2*localStorage[e].length);return t}(),l=localStorage.getItem(xL),c=5242880-s+(l?2*l.length:0);if(o>c)return t.Utils.toast(t.t("action.storage.toast.saveInsufficientSpace",{compressedSize:SL(o),available:SL(c)}));const h=JSON.stringify({v:2,t:Date.now(),n:t.workbookName,d:r});localStorage.setItem(xL,h),t.Utils.toast(t.t("action.storage.toast.saveSuccess",{ratio:a,compressedSize:SL(o)}))}catch(e){"QuotaExceededError"===e.name?t.Utils.toast(t.t("action.storage.toast.msg001")):t.Utils.toast(t.t("action.storage.toast.saveFailed",{message:e.message}))}},loadFromLocal:async function(){const t=this.SN;try{const e=localStorage.getItem(xL);if(!e)return t.Utils.toast(t.t("action.storage.toast.msg002"));const n=JSON.parse(e);if(!n.d)return t.Utils.toast(t.t("action.storage.toast.msg003"));const i=new Date(n.t).toLocaleString(),r=n.n||"未命名";await t.Utils.modal({titleKey:"action.storage.modal.restore.title",title:t.t("action.storage.modal.restore.title"),content:t.t("action.storage.modal.restore.content",{name:r,time:i}),confirmKey:"common.ok",confirmText:t.t("common.ok"),cancelKey:"common.cancel",cancelText:t.t("common.cancel")});const o=function(t){if(!t)return"";try{const e=t.indexOf("|");if(-1===e)return null;const n=parseInt(t.substring(0,e),10),i=t.substring(e+1),r=new Uint8Array(n);for(let t=0,o=0;t<i.length&&o<n;t++){const e=i.charCodeAt(t);r[o++]=e>>8,o<n&&(r[o++]=255&e)}return(new TextDecoder).decode(r)}catch(t){return null}}(n.d);if(!o)return t.Utils.toast(t.t("action.storage.toast.msg004"));const a=JSON.parse(o);t.IO.setData(a)&&t.Utils.toast(t.t("action.storage.toast.msg005"))}catch(e){if("cancel"===e?.message)return;t.Utils.toast(t.t("action.storage.toast.restoreFailed",{message:e.message}))}},hasLocalData:function(){return!!localStorage.getItem(xL)},clearLocalData:function(){const t=this.SN;localStorage.removeItem(xL),t.Utils.toast(t.t("action.storage.toast.msg006"))}}),Object.assign(PP.prototype,{copy:function(){const t=this.SN.activeSheet,e=t.activeAreas[t.activeAreas.length-1];return t.copy(e,!1),IL(t,e),!0},cut:function(){const t=this.SN.activeSheet,e=t.activeAreas[t.activeAreas.length-1];return t.cut(e),IL(t,e),!0},paste:async function(t="all"){const e=this.SN.activeSheet,n=e.activeCell;if(e.hasClipboardData()){const i={mode:t,operation:rt.NONE,skipBlanks:!1,transpose:"transpose"===t},r=e.paste({r:n.r,c:n.c},i);return r&&(this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),this.SN.Canvas.r()),r}try{const i=await async function(){try{const t=await navigator.clipboard.read();for(const e of t){if(e.types.includes("text/html")){const t=await e.getType("text/html"),n=kL(await t.text());if(n)return li(n)}if(e.types.includes("text/plain")){const t=await e.getType("text/plain");return ci(await t.text())}}}catch(t){try{return ci(await navigator.clipboard.readText())}catch(t){}}return null}();if(i){const r={mode:t,operation:rt.NONE,skipBlanks:!1,transpose:"transpose"===t,externalData:i},o=e.paste({r:n.r,c:n.c},r);return o&&(this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),this.SN.Canvas.r()),o}}catch(t){}return!1},clearClipboard:function(){this.SN.activeSheet.clearClipboard()},handlePasteEvent:function(t){const e=this.SN.activeSheet,n=e.activeCell,i=t.clipboardData||window.clipboardData,r=i.getData("text/html");if(r){const t=kL(r);if(t&&t.data&&t.data.length>0){const i=li(t);return e.paste({r:n.r,c:n.c},{mode:it.ALL,externalData:i})&&(this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),this.SN.Canvas.r()),!0}}const o=i.items;if(o)for(let s=0;s<o.length;s++)if(-1!==o[s].type.indexOf("image")){const t=o[s].getAsFile(),i=new FileReader;return i.onload=t=>{const i=t.target.result;e.Drawing.addImage(i,{startCell:{r:n.r,c:n.c}}),this.SN.Canvas.r()},i.readAsDataURL(t),!0}const a=i.getData("text/plain");if(a){const t=ci(a);return e.paste({r:n.r,c:n.c},{mode:it.ALL,externalData:t})&&(this.SN.DependencyGraph&&"manual"!==this.SN.calcMode&&this.SN.DependencyGraph.recalculateVolatile(),this.SN.Canvas.r()),!0}return!1}}),Object.assign(PP.prototype,{condFormat:async function(t,e,n){const i=this.SN,r=i.activeSheet.activeAreas;if(!r||0===r.length)return void i.Utils.toast(i.t("action.condFormat.toast.msg001"));const o=i.Utils.rangeNumToStr(r[r.length-1]);try{switch(t){case"cellIs":await PL.call(this,o,e);break;case"containsText":await zL.call(this,o,"containsText");break;case"timePeriod":await OL.call(this,o);break;case"duplicateValues":await BL.call(this,o);break;case"top10":await VL.call(this,o,e);break;case"aboveAverage":GL.call(this,o,e);break;case"dataBar":"custom"===e?await HL.call(this,o):XL.call(this,o,"gradient"===e,n);break;case"colorScale":"custom"===e?await UL.call(this,o):YL.call(this,o,e);break;case"iconSet":"custom"===e?await qL.call(this,o):ZL.call(this,o,e);break;case"newRule":await KL.call(this,o);break;case"clearSelection":JL.call(this,o);break;case"clearSheet":QL.call(this);break;case"manage":await jL.call(this)}}catch(t){}}}),Object.assign(PP.prototype,{openFormulaDialog:function(t="all"){const e=x_.getDialogCategories(),n=new Set(e.map(t=>t.key)).has(t)?t:"all";this.SN.Utils.modal({titleKey:"action.formula.modal.m001.title",title:"Insert Function",maxWidth:"420px",confirmKey:"action.formula.modal.m001.confirm",confirmText:"Insert",cancelKey:"action.formula.modal.m001.cancel",cancelText:"Cancel",content:eP(e,n,this.SN),onOpen:t=>{t.classList.add("sn-modal-body-formula");const e=t.querySelector(".sn-formula-category-select"),i=t.querySelector(".sn-formula-search-input"),r=t.querySelector(".sn-formula-list"),o=t.closest(".sn-modal-overlay"),a=o?.querySelector(".sn-modal-btn-confirm");let s=n,l="";const c=()=>{const e=x_.search(i.value,s),n=l&&e.some(t=>t.name===l)?l:e[0]?.name||"";!function(t,e,n,i){e.length?t.innerHTML=e.map(t=>`<div class="sn-formula-item${t.name===n?" active":""}" data-name="${t.name}">${t.name}</div>`).join(""):t.innerHTML=`<div class="sn-formula-empty">${i.t("action.formula.content.empty")}</div>`}(r,e,n,this.SN),l=n,nP(t,x_.getFormula(l),this.SN)};e.addEventListener("change",()=>{s=e.value,l="",c()}),r.addEventListener("click",e=>{const n=e.target.closest(".sn-formula-item");n&&(r.querySelectorAll(".sn-formula-item").forEach(t=>t.classList.remove("active")),n.classList.add("active"),l=n.dataset.name||"",nP(t,x_.getFormula(l),this.SN))}),r.addEventListener("dblclick",t=>{const e=t.target.closest(".sn-formula-item");e&&a&&(l=e.dataset.name||"",a.click())}),i.addEventListener("input",()=>{l="",c()}),c()},onConfirm:t=>{const e=t?.querySelector(".sn-formula-item.active");return e?(this.insertFunction(e.dataset.name),!0):(this.SN.Utils.toast(this.SN.t("action.formula.toast.pleaseSelectAFunction")),!1)}})},insertFunction:function(t){if(!t)return void this.openFormulaDialog("all");const e=x_.getFormula(t),n=e?.name||String(t).toUpperCase();x_.addRecent(n);const i=this.SN.Canvas?.formulaBar;if(!i)return;let r=i.value||"";r.trim().startsWith("=")||(r=r.trim()?"="+r:"=");const o=`${n}(`;i.value=r+o;const a=i.value.length;this.SN.Canvas?.input&&(this.SN.Canvas.input.innerText=i.value),i.focus(),i.setSelectionRange?.(a,a)}}),Object.assign(PP.prototype,{nameManager:function(){const t=(t,e)=>this.SN.t(t,e),e=aP.call(this);this.SN.Utils.modal({titleKey:"action.nameManager.modal.m001.title",title:t("action.nameManager.modal.m001.title"),maxWidth:"640px",confirmKey:"action.nameManager.modal.m001.confirm",confirmText:t("action.nameManager.modal.m001.confirm"),content:rP(e,0,t),onOpen:n=>{n.classList.add("sn-modal-body-nm");const i=n.querySelector(".sn-nm-table tbody"),r=n.querySelector(".sn-nm-ref-input"),o=n.querySelector(".sn-nm-btn-new"),a=n.querySelector(".sn-nm-btn-edit"),s=n.querySelector(".sn-nm-btn-delete"),l=n.querySelector(".sn-nm-filter-select");let c=e[0]?.name||"",h=l?.value||"all";const u=()=>{const t=e.find(t=>t.name===c);r.value=t?.ref||"",a.disabled=!c,s.disabled=!c},d=()=>{const n=aP.call(this);e.length=0,e.push(...n);const r=function(t,e){return"all"===e?t:t.filter(t=>t.scope===e)}(n,h);r.some(t=>t.name===c)||(c=r[0]?.name||""),i.innerHTML=iP(r,c,t),u()};i.addEventListener("click",t=>{const e=t.target.closest(".sn-nm-row");e&&(i.querySelectorAll(".sn-nm-row").forEach(t=>t.classList.remove("active")),e.classList.add("active"),c=e.dataset.name,u())}),o.addEventListener("click",()=>{this.defineName(()=>d())}),a.addEventListener("click",()=>{if(!c)return;const t=e.find(t=>t.name===c);t&&this.defineName(()=>d(),t)}),s.addEventListener("click",()=>{if(!c)return;const e=c,n=this.SN.yn[e];this.SN.Utils.modal({titleKey:"action.nameManager.content.deleteConfirmTitle",title:t("action.nameManager.content.deleteConfirmTitle"),content:t("action.nameManager.content.deleteConfirmBody",{name:e}),confirmKey:"action.nameManager.content.deleteConfirmButton",confirmText:t("action.nameManager.content.deleteConfirmButton"),cancelKey:"action.nameManager.modal.m001.cancel",cancelText:t("action.nameManager.modal.m001.cancel"),onConfirm:()=>(delete this.SN.yn[e],this.SN.UndoRedo.add({undo:()=>{this.SN.yn[e]=n},redo:()=>{delete this.SN.yn[e]}}),c="",d(),!0)})}),l.addEventListener("change",()=>{h=l.value||"all",d()}),u()},onConfirm:()=>!0})},defineName:function(t,e=null){const n=(t,e)=>this.SN.t(t,e),i=!!e,r=this.SN.activeSheet,o=r.activeAreas[0]||{s:r.activeCell,e:r.activeCell},a=this.SN.Utils.rangeNumToStr(o),s=function(t,e){return`${t}!${e.split(":").map(t=>{const e=t.match(/^([A-Z]+)(\d+)$/i);return e?`$${e[1].toUpperCase()}$${e[2]}`:t}).join(":")}`}(r.name,a),l=e||{ref:s},c=i?"action.nameManager.modal.m002.titleEdit":"action.nameManager.modal.m002.titleCreate";this.SN.Utils.modal({titleKey:c,title:n(c),maxWidth:"400px",content:oP(l,this.SN.sheets,n),confirmKey:"action.nameManager.modal.m002.confirm",confirmText:n("action.nameManager.modal.m002.confirm"),cancelKey:"action.nameManager.modal.m002.cancel",cancelText:n("action.nameManager.modal.m002.cancel"),onOpen:t=>{t.classList.add("sn-modal-body-dn");const e=t.querySelector(".sn-dn-name");i?(e.readOnly=!0,e.style.background="#f5f5f5"):e.focus()},onConfirm:r=>{const o=r.querySelector(".sn-dn-name"),a=r.querySelector(".sn-dn-ref"),s=o.value.trim(),l=a.value.trim();if(!s)return this.SN.Utils.toast(n("action.nameManager.toast.msg001")),o.focus(),!1;if(!/^[A-Za-z_\\][A-Za-z0-9_.\\]*$/.test(s))return this.SN.Utils.toast(n("action.nameManager.toast.msg002")),o.focus(),!1;if(!l)return this.SN.Utils.toast(n("action.nameManager.toast.msg003")),a.focus(),!1;if(!i&&this.SN.yn[s])return this.SN.Utils.toast(n("action.nameManager.toast.msg004")),o.focus(),!1;const c=i?e.ref:null;return this.SN.yn[s]=l,i?this.SN.UndoRedo.add({undo:()=>{this.SN.yn[s]=c},redo:()=>{this.SN.yn[s]=l}}):this.SN.UndoRedo.add({undo:()=>{delete this.SN.yn[s]},redo:()=>{this.SN.yn[s]=l}}),t?.(),!0}})},useInFormula:function(){const t=(t,e)=>this.SN.t(t,e),e=aP.call(this);e.length?this.SN.Utils.modal({titleKey:"action.nameManager.modal.m003.title",title:t("action.nameManager.modal.m003.title"),maxWidth:"320px",content:`\n            <div class="sn-use-formula">\n                <div class="sn-uf-list">\n                    ${e.map((t,e)=>`\n                        <div class="sn-uf-item${0===e?" active":""}" data-name="${t.name}">\n                            <span class="sn-uf-name">${t.name}</span>\n                            <span class="sn-uf-ref">${t.ref}</span>\n                        </div>\n                    `).join("")}\n                </div>\n            </div>\n        `,confirmKey:"action.nameManager.modal.m003.confirm",confirmText:t("action.nameManager.modal.m003.confirm"),cancelKey:"action.nameManager.modal.m003.cancel",cancelText:t("action.nameManager.modal.m003.cancel"),onOpen:t=>{const e=t.querySelector(".sn-uf-list");e.addEventListener("click",t=>{const n=t.target.closest(".sn-uf-item");n&&(e.querySelectorAll(".sn-uf-item").forEach(t=>t.classList.remove("active")),n.classList.add("active"))}),e.addEventListener("dblclick",e=>{if(!e.target.closest(".sn-uf-item"))return;const n=t.closest(".sn-modal-overlay");n?.querySelector(".sn-modal-btn-confirm")?.click()})},onConfirm:t=>{const e=t.querySelector(".sn-uf-item.active");return!!e&&(this.insertFunction(e.dataset.name),!0)}}):this.SN.Utils.toast(t("action.nameManager.toast.msg005"))}}),Object.assign(PP.prototype,{tracePrecedents:function(){const t=this.SN.activeSheet,{r:e,c:n}=t.activeCell,i=t.getCell(e,n);if(!i?.editVal?.startsWith("="))return void this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.msg001"));const r=lP(i.editVal);if(0===r.length)return void this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.msg002"));const o=sP(t);r.forEach(t=>{o.precedents.some(i=>i.from.r===t.r&&i.from.c===t.c&&i.to.r===e&&i.to.c===n)||o.precedents.push({from:t,to:{r:e,c:n}})}),this.SN.ue()},traceDependents:function(){const t=this.SN.activeSheet,{r:e,c:n}=t.activeCell;this.SN.Utils.numToChar(n);const i=sP(t),r=[];t.rows.forEach((t,i)=>{t.cells.forEach((t,o)=>{t?.editVal?.startsWith("=")&&(i===e&&o===n||lP(t.editVal).some(t=>t.r===e&&t.c===n)&&r.push({r:i,c:o}))})}),0!==r.length?(r.forEach(t=>{i.dependents.some(i=>i.from.r===e&&i.from.c===n&&i.to.r===t.r&&i.to.c===t.c)||i.dependents.push({from:{r:e,c:n},to:t})}),this.SN.ue()):this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.msg003"))},removeArrows:function(t="all"){const e=sP(this.SN.activeSheet);"precedents"!==t&&"all"!==t||(e.precedents=[]),"dependents"!==t&&"all"!==t||(e.dependents=[]),this.SN.ue()},showFormulas:function(){const t=this.SN.activeSheet;t.showFormulas=!t.showFormulas,this.SN.Utils.toast(t.showFormulas?this.SN.t("action.formulaAudit.toast.showFormulas"):this.SN.t("action.formulaAudit.toast.showCalculatedValues")),this.SN.ue()},errorCheck:function(){const t=(t,e)=>this.SN.t(t,e),e=this.SN.activeSheet,n=[],i=["#REF!","#NAME?","#VALUE!","#DIV/0!","#NULL!","#NUM!","#N/A","#CALC!"];if(e.rows.forEach((t,e)=>{t.cells.forEach((t,r)=>{if(!t)return;const o=t.calcVal;"string"==typeof o&&i.includes(o)&&n.push({ref:this.SN.Utils.numToChar(r)+(e+1),r:e,c:r,error:o,formula:t.editVal||""})})}),0===n.length)return void this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.msg004"));const r=n.map((t,e)=>`\n        <div class="sn-error-item${0===e?" active":""}" data-r="${t.r}" data-c="${t.c}">\n            <span class="sn-error-ref">${t.ref}</span>\n            <span class="sn-error-type">${t.error}</span>\n            <span class="sn-error-formula" title="${t.formula}">${t.formula}</span>\n        </div>\n    `).join("");this.SN.Utils.modal({titleKey:"action.formulaAudit.modal.m001.title",title:t("action.formulaAudit.modal.m001.title"),maxWidth:"400px",content:`\n            <div class="sn-error-check">\n                <div class="sn-error-summary">${t("action.formulaAudit.content.errorSummary",{count:n.length})}</div>\n                <div class="sn-error-list">${r}</div>\n            </div>\n        `,confirmKey:"action.formulaAudit.modal.m001.confirm",confirmText:t("action.formulaAudit.modal.m001.confirm"),onOpen:t=>{const n=t.querySelector(".sn-error-list");n.addEventListener("click",t=>{const i=t.target.closest(".sn-error-item");if(!i)return;n.querySelectorAll(".sn-error-item").forEach(t=>t.classList.remove("active")),i.classList.add("active");const r=parseInt(i.dataset.r,10),o=parseInt(i.dataset.c,10);e.activeCell={r,c:o},e.activeAreas=[{s:{r,c:o},e:{r,c:o}}],this.SN.ue()})},onConfirm:()=>!0})},evaluateFormula:function(){const t=(t,e)=>this.SN.t(t,e),e=this.SN.activeSheet,{r:n,c:i}=e.activeCell,r=e.getCell(n,i);if(!r?.editVal?.startsWith("="))return void this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.msg001"));const o=r.editVal,a=lP(o);let s=[],l=o;a.forEach(t=>{const n=e.getCell(t.r,t.c),i=this.SN.Utils.numToChar(t.c)+(t.r+1),r=n?.calcVal??0;s.push({ref:i,value:r});const o=new RegExp(`\\$?${i.replace(/\$/g,"\\$?")}`,"gi");l=l.replace(o,r)});const c=s.length>0?s.map(t=>`\n        <div class="sn-eval-step">\n            <span class="sn-eval-ref">${t.ref}</span>\n            <span class="sn-eval-arrow">→</span>\n            <span class="sn-eval-val">${t.value}</span>\n        </div>\n    `).join(""):`<div class="sn-eval-empty">${t("action.formulaAudit.content.evaluate.noReferences")}</div>`;this.SN.Utils.modal({titleKey:"action.formulaAudit.modal.m002.title",title:t("action.formulaAudit.modal.m002.title"),maxWidth:"360px",content:`\n            <div class="sn-formula-eval">\n                <div class="sn-eval-row">\n                    <label>${t("action.formulaAudit.content.evaluate.formulaLabel")}</label>\n                    <span class="sn-eval-formula">${o}</span>\n                </div>\n                <div class="sn-eval-row">\n                    <label>${t("action.formulaAudit.content.evaluate.referenceReplaceLabel")}</label>\n                </div>\n                <div class="sn-eval-steps">${c}</div>\n                <div class="sn-eval-row">\n                    <label>${t("action.formulaAudit.content.evaluate.replacedLabel")}</label>\n                    <span class="sn-eval-replaced">${l}</span>\n                </div>\n                <div class="sn-eval-row sn-eval-result-row">\n                    <label>${t("action.formulaAudit.content.evaluate.resultLabel")}</label>\n                    <span class="sn-eval-result">${r.calcVal}</span>\n                </div>\n            </div>\n        `,confirmKey:"action.formulaAudit.modal.m002.confirm",confirmText:t("action.formulaAudit.modal.m002.confirm"),onConfirm:()=>!0})},calculateNow:function(){const t=performance.now();this.SN.sheets.forEach(t=>{t.rows.forEach(t=>{t.cells.forEach(t=>{t?.editVal?.startsWith("=")&&(t.H=null)})})}),this.SN.ue();const e=(performance.now()-t).toFixed(1);this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.recalculatedWorkbook",{elapsed:e}))},calculateSheet:function(){const t=performance.now();this.SN.activeSheet.rows.forEach(t=>{t.cells.forEach(t=>{t?.editVal?.startsWith("=")&&(t.H=null)})}),this.SN.ue();const e=(performance.now()-t).toFixed(1);this.SN.Utils.toast(this.SN.t("action.formulaAudit.toast.recalculatedSheet",{elapsed:e}))},setCalcMode:function(t){this.SN.calcMode=t,this.SN.Utils.toast("manual"===t?this.SN.t("action.formulaAudit.toast.switchToManual"):this.SN.t("action.formulaAudit.toast.switchToAuto"))}}),Object.assign(PP.prototype,{toggleAutoFilter:function(){const t=this.SN.activeSheet,e=t.AutoFilter,{scopeId:n,table:i}=dP(t);i?i.autoFilterEnabled=!e.isScopeEnabled(n):e.enabled?e.clear():e.setRange()},clearFilter:function(){const t=this.SN.activeSheet,e=t.AutoFilter,{scopeId:n}=dP(t);n&&e.isScopeEnabled(n)?e.clearAllFilters(n):e.enabled?e.clearAllFilters():this.SN.Utils.toast(this.SN.t("action.filter.toast.msg001"))},reapplyFilter:function(){const t=this.SN.activeSheet,e=t.AutoFilter,{scopeId:n}=dP(t);n&&e.isScopeEnabled(n)?(e.he(n),this.SN.Utils.toast(this.SN.t("action.filter.toast.msg002"))):e.enabled?(e.he(),this.SN.Utils.toast(this.SN.t("action.filter.toast.msg002"))):this.SN.Utils.toast(this.SN.t("action.filter.toast.msg001"))},sortAsc:function(){const t=this.SN.activeSheet,e=t.activeAreas;if(0===e.length)return this.SN.Utils.toast(this.SN.t("action.filter.toast.msg003"));const n=e[e.length-1],i=t.activeCell.c;t.rangeSort([{col:i,order:"asc"}],n)&&this.SN.ue()},sortDesc:function(){const t=this.SN.activeSheet,e=t.activeAreas;if(0===e.length)return this.SN.Utils.toast(this.SN.t("action.filter.toast.msg003"));const n=e[e.length-1],i=t.activeCell.c;t.rangeSort([{col:i,order:"desc"}],n)&&this.SN.ue()},customSort:function(){uP||(uP=new hP(this.SN)),uP.show()}}),Object.assign(PP.prototype,{subtotal:function(){const t=this.SN,e=this.SN.activeSheet,n=this.SN.Utils,i=function(t){return mP(t.activeAreas?.[0])||{s:{...t.activeCell},e:{...t.activeCell}}}(e);if(e.areaHaveMerge(i))return void n.toast(t.t("dataTools.subtotal.errors.mergedCells"));const r=function(t,e,n,i=!0){const r=[],o=e.s.r;for(let a=e.s.c;a<=e.e.c;a++){const s=t.Utils.numToChar(a),l=i?String(t.getCell(o,a).showVal??"").trim():"",c=l?`${l} (${s})`:`${n.t("dataTools.columnFallback")} ${s}`;r.push({col:a,ref:s,title:c,isNumeric:gP(t,e,a,i)})}return r}(e,i,t,!0);if(r.length<2)return void n.toast(t.t("dataTools.subtotal.errors.minColumns"));const o=r.filter(t=>t.isNumeric&&t.col!==r[0].col).map(t=>t.col);0===o.length&&r.forEach(t=>{t.col!==r[0].col&&o.push(t.col)}),n.modal({titleKey:"dataTools.subtotal.title",title:"Subtotal",content:xP(r,t,{groupBy:r[0].col,function:"sum",defaultTargets:o,summaryBelowData:!1!==e.outlinePr?.summaryBelow}),maxWidth:"520px",confirmKey:"common.ok",confirmText:"OK",cancelKey:"common.cancel",cancelText:"Cancel",onOpen:t=>{const e=t.querySelector('[data-field="subtotal-group"]');wP(t),e?.addEventListener("change",()=>wP(t))},onConfirm:r=>{const o=Number(r.querySelector('[data-field="subtotal-group"]')?.value),a=r.querySelector('[data-field="subtotal-function"]')?.value||"sum",s=function(t){return Array.from(t.querySelectorAll('[data-field="subtotal-target"]:checked')).map(t=>Number(t.value)).filter(t=>Number.isInteger(t)&&t>=0)}(r),l=!1!==r.querySelector('[data-field="subtotal-has-headers"]')?.checked,c=!1!==r.querySelector('[data-field="subtotal-replace"]')?.checked,h=!1!==r.querySelector('[data-field="subtotal-summary-below"]')?.checked,u=!1!==r.querySelector('[data-field="subtotal-grand-total"]')?.checked;if(!Number.isInteger(o))return n.toast(t.t("dataTools.subtotal.errors.groupFieldRequired")),!1;if(!s.length)return n.toast(t.t("dataTools.subtotal.errors.subtotalColumnRequired")),!1;let d;try{d=e.subtotal(i,{groupBy:o,function:a,subtotalColumns:s,hasHeaders:l,replaceExisting:c,summaryBelowData:h,withGrandTotal:u})}catch(e){return n.toast(e?.message||t.t("dataTools.subtotal.errors.executeFailed")),!1}if(!d?.success)return!1;this.SN.ue();const f=null!=d.grandTotalRow?t.t("dataTools.subtotal.completed.grandTotalSuffix"):"";return n.toast(t.t("dataTools.subtotal.completed.message",{groupCount:d.groupCount,insertedRows:d.insertedSubtotalRows,grandTotal:f})),!0}})},consolidate:function(){const t=this.SN,e=this.SN.activeSheet,n=this.SN.Utils,i=(e.activeAreas||[]).map(t=>e.Utils.rangeNumToStr(mP(t))).filter(Boolean).join("\n")||e.Utils.rangeNumToStr({s:e.activeCell,e:e.activeCell}),r=e.Utils.cellNumToStr(e.activeCell);n.modal({titleKey:"dataTools.consolidate.title",title:"Consolidate",maxWidth:"520px",content:SP(i,r,t),confirmKey:"common.ok",confirmText:"OK",cancelKey:"common.cancel",cancelText:"Cancel",onConfirm:i=>{const r=i.querySelector('[data-field="consolidate-function"]')?.value||"sum",o=i.querySelector('[data-field="consolidate-ranges"]')?.value,a=i.querySelector('[data-field="consolidate-destination"]')?.value?.trim(),s=!1!==i.querySelector('[data-field="consolidate-skip-blanks"]')?.checked;let l,c;try{l=function(t,e,n){const i=String(e??"").split(/[\n,;]+/).map(t=>t.trim()).filter(Boolean);if(0===i.length)return[];const r=[];return i.forEach(e=>{const i=t.rangeStrToNum(e);if(!i?.s||!i?.e)throw new Error(n.t("dataTools.consolidate.invalidRange",{range:e}));r.push(e)}),r}(e,o,t)}catch(e){return n.toast(e?.message||t.t("dataTools.consolidate.errors.invalidSourceRange")),!1}if(!l.length)return n.toast(t.t("dataTools.consolidate.errors.sourceRequired")),!1;try{c=e.consolidate(l,{function:r,destination:a,skipBlanks:s})}catch(e){return n.toast(e?.message||t.t("dataTools.consolidate.errors.executeFailed")),!1}return!!c?.success&&(this.SN.ue(),n.toast(t.t("dataTools.consolidate.completed",{count:c.writtenCount})),!0)}})},dataValidationDialog:function(){const t=this.SN.activeSheet,e=this.SN,n=this.SN.Utils,i=function(t){const e=t.activeCell;return t.getCell(e.r,e.c).dataValidation||null}(t);n.modal({titleKey:"dataValidation.title",title:e.t("dataValidation.title"),maxWidth:"520px",content:CP(i,e),confirmKey:"common.ok",confirmText:e.t("common.ok"),cancelKey:"common.cancel",cancelText:e.t("common.cancel"),onOpen:t=>{const n=t.querySelector('[data-field="dv-type"]'),i=t.querySelector('[data-field="dv-operator"]'),r=t.querySelector('[data-field="dv-show-input"]'),o=t.querySelector('[data-field="dv-show-error"]');TP(t,e),n?.addEventListener("change",()=>TP(t,e)),i?.addEventListener("change",()=>TP(t,e)),r?.addEventListener("change",()=>TP(t,e)),o?.addEventListener("change",()=>TP(t,e))},onConfirm:i=>{let r=null;try{r=function(t,e){const n=t.querySelector('[data-field="dv-type"]')?.value||"any";if("any"===n)return null;const i={type:n,allowBlank:!1!==t.querySelector('[data-field="dv-allow-blank"]')?.checked,showInputMessage:!1!==t.querySelector('[data-field="dv-show-input"]')?.checked,showErrorMessage:!1!==t.querySelector('[data-field="dv-show-error"]')?.checked,promptTitle:t.querySelector('[data-field="dv-prompt-title"]')?.value?.trim()||"",prompt:t.querySelector('[data-field="dv-prompt"]')?.value?.trim()||"",errorStyle:t.querySelector('[data-field="dv-error-style"]')?.value||"stop",errorTitle:t.querySelector('[data-field="dv-error-title"]')?.value?.trim()||"",error:t.querySelector('[data-field="dv-error"]')?.value?.trim()||""};if("list"===n){const n=(t.querySelector('[data-field="dv-list-source"]')?.value||"").split(/[,\n，;；]/).map(t=>t.trim()).filter(Boolean);if(!n.length)throw new Error(e.t("dataValidation.errors.listSourceRequired"));return i.formula1=n,i.showDropDown=!1!==t.querySelector('[data-field="dv-show-dropdown"]')?.checked,i}if("custom"===n){const n=t.querySelector('[data-field="dv-formula1"]')?.value?.trim()||"";if(!n)throw new Error(e.t("dataValidation.errors.customFormulaRequired"));return i.formula1=n,i}if(["whole","decimal","textLength","date","time"].includes(n)){const n=t.querySelector('[data-field="dv-operator"]')?.value||"between",r=t.querySelector('[data-field="dv-formula1"]')?.value?.trim()||"",o=t.querySelector('[data-field="dv-formula2"]')?.value?.trim()||"";if(!r)throw new Error(e.t("dataValidation.errors.conditionRequired"));if(i.operator=n,i.formula1=r,["between","notBetween"].includes(n)){if(!o)throw new Error(e.t("dataValidation.errors.rangeConditionRequired"));i.formula2=o}}return i}(i,e)}catch(t){return n.toast(t?.message||e.t("dataValidation.errors.invalidConfig")),!1}const o=t.activeAreas?.length?t.activeAreas:[{s:t.activeCell,e:t.activeCell}];let a;try{a=r?t.setDataValidation(o,r):t.clearDataValidation(o)}catch(t){return n.toast(t?.message||e.t("dataValidation.errors.setFailed")),!1}if(!a?.success)return!1;this.SN.ue();const s=r?e.t("dataValidation.action.set"):e.t("dataValidation.action.clear");return n.toast(e.t("dataValidation.toast.completed",{action:s,count:a.cellCount})),!0}})},clearDataValidation:function(){const t=this.SN.activeSheet,e=this.SN.Utils,n=t.activeAreas?.length?t.activeAreas:[{s:t.activeCell,e:t.activeCell}];let i;try{i=t.clearDataValidation(n)}catch(t){return void e.toast(t?.message||this.SN.t("dataValidation.errors.clearFailed"))}i?.success&&(this.SN.ue(),e.toast(this.SN.t("dataValidation.toast.cleared",{count:i.cellCount})))}}),Object.assign(PP.prototype,{openFindDialog:function(t="find"){pP||(pP=new fP(this.SN)),pP.show(t)}}),Object.assign(PP.prototype,{printPreview:function(){this.SN.Print.preview()},exportPdf:async function(){await this.SN.Print.print()},pageBreakPreview:async function(){this.SN.Print.toggleShowPageBreaks(!0),await this.SN.Print.preview({pageBreakPreview:!0})},toggleShowPageBreaks:function(t){this.SN.Print.toggleShowPageBreaks(!!t)},insertPageBreak:function(){const t=this.SN.Print.insertPageBreak();t?t.row||t.col?this.SN.Utils.toast(this.SN.t("action.print.toast.pageBreakInserted")):this.SN.Utils.toast(this.SN.t("action.print.toast.aPageBreakAlreadyExists")):this.SN.Utils.toast(this.SN.t("action.print.toast.pleaseSelectAValidCell"))},togglePrintGridlines:function(t){this.SN.Print.toggleGridlines(!!t)},togglePrintHeadings:function(t){this.SN.Print.toggleHeadings(!!t)},setPageMarginsPreset:function(t){const e={normal:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},narrow:{left:.25,right:.25,top:.25,bottom:.25,header:.2,footer:.2},wide:{left:1,right:1,top:1,bottom:1,header:.3,footer:.3}},n=e[t]||e.normal;this.SN.Print.setPageMargins(n),this.SN.Utils.toast(this.SN.t("action.print.toast.marginsUpdated"))},setPageMarginsDialog:async function(){const t=this.SN,e=t.Print.ensureSettings(t.activeSheet).pageMargins||{},n=`\n        <div class="sn-form-row">\n            <label>Top</label>\n            <input type="number" step="0.01" data-field="pm-top" value="${e.top??.75}">\n        </div>\n        <div class="sn-form-row">\n            <label>Bottom</label>\n            <input type="number" step="0.01" data-field="pm-bottom" value="${e.bottom??.75}">\n        </div>\n        <div class="sn-form-row">\n            <label>Left</label>\n            <input type="number" step="0.01" data-field="pm-left" value="${e.left??.7}">\n        </div>\n        <div class="sn-form-row">\n            <label>Right</label>\n            <input type="number" step="0.01" data-field="pm-right" value="${e.right??.7}">\n        </div>\n        <div class="sn-form-row">\n            <label>Header</label>\n            <input type="number" step="0.01" data-field="pm-header" value="${e.header??.3}">\n        </div>\n        <div class="sn-form-row">\n            <label>Footer</label>\n            <input type="number" step="0.01" data-field="pm-footer" value="${e.footer??.3}">\n        </div>\n        <div class="sn-form-tip">Unit: inch</div>\n    `;await t.Utils.modal({titleKey:"action.print.modal.m001.title",title:"Margins",content:n,confirmKey:"action.print.modal.m001.confirm",confirmText:"OK",cancelKey:"action.print.modal.m001.cancel",cancelText:"Cancel",onConfirm:n=>{const i=(t,e)=>function(t,e){const n=Number(t);return Number.isFinite(n)&&n>=0?n:e}(n.querySelector(`[data-field="${t}"]`)?.value,e),r={top:i("pm-top",e.top??.75),bottom:i("pm-bottom",e.bottom??.75),left:i("pm-left",e.left??.7),right:i("pm-right",e.right??.7),header:i("pm-header",e.header??.3),footer:i("pm-footer",e.footer??.3)};return t.Print.setPageMargins(r),!0}})},setPageOrientation:function(t){this.SN.Print.setPageSetup({orientation:t})},setPaperSize:function(t){this.SN.Print.setPageSetup({paperName:t})},setPrintScale:function(t){this.SN.Print.setPageSetup({scale:t,fitToWidth:0,fitToHeight:0})},setPrintScaleDialog:async function(){const t=this.SN,e=t.Print.ensureSettings(t.activeSheet),n=`\n        <div class="sn-form-row">\n            <label>Scale</label>\n            <input type="number" step="1" data-field="print-scale" value="${e.pageSetup?.scale??100}">\n        </div>\n        <div class="sn-form-tip">Range: 10-400</div>\n    `;await t.Utils.modal({titleKey:"action.print.modal.m002.title",title:"Print Scale",content:n,confirmKey:"action.print.modal.m002.confirm",confirmText:"OK",cancelKey:"action.print.modal.m002.cancel",cancelText:"Cancel",onConfirm:e=>{const n=Number(e.querySelector('[data-field="print-scale"]')?.value);return!Number.isFinite(n)||n<10||n>400?(t.Utils.toast(t.t("action.print.toast.pleaseEnterANumberBetween")),!1):(t.Print.setPageSetup({scale:n,fitToWidth:0,fitToHeight:0}),!0)}})},setPrintAreaFromSelection:function(){const t=this.SN.activeSheet,e=t?.activeAreas?.[t.activeAreas.length-1];if(!e)return this.SN.Utils.toast(this.SN.t("action.print.toast.pleaseSelectAPrintArea"));this.SN.Print.setPrintArea(e),this.SN.Utils.toast(this.SN.t("action.print.toast.printAreaSet"))},clearPrintArea:function(){this.SN.Print.clearPrintArea(),this.SN.Utils.toast(this.SN.t("action.print.toast.printAreaCleared"))},setPrintTitles:async function(){const t=this.SN,e=t.Print.ensureSettings(t.activeSheet).printTitles||{},n=`\n        <div class="sn-form-row">\n            <label>Rows to Repeat</label>\n            <input type="text" data-field="print-rows" placeholder="e.g. 1:1" value="${EP(e.rows??"")}">\n        </div>\n        <div class="sn-form-row">\n            <label>Columns to Repeat</label>\n            <input type="text" data-field="print-cols" placeholder="e.g. A:A" value="${EP(e.cols??"")}">\n        </div>\n    `;await t.Utils.modal({titleKey:"action.print.modal.m003.title",title:"Print Titles",content:n,confirmKey:"action.print.modal.m003.confirm",confirmText:"OK",cancelKey:"action.print.modal.m003.cancel",cancelText:"Cancel",onConfirm:e=>{const n=e.querySelector('[data-field="print-rows"]')?.value?.trim(),i=e.querySelector('[data-field="print-cols"]')?.value?.trim();return t.Print.setPrintTitles({rows:n||null,cols:i||null}),!0}})},setPageBackground:async function(){const t=this.SN,e=t.Print.ensureSettings(t.activeSheet),n=`\n        <div class="sn-form-row">\n            <label>Background Image URL</label>\n            <input type="text" data-field="print-bg" placeholder="https://..." value="${EP(e.pageBackground?.url??"")}">\n        </div>\n        <div class="sn-form-tip">Background applies to preview and print</div>\n    `;await t.Utils.modal({titleKey:"action.print.modal.m004.title",title:"Background Image",content:n,confirmKey:"action.print.modal.m004.confirm",confirmText:"OK",cancelKey:"action.print.modal.m004.cancel",cancelText:"Cancel",onConfirm:e=>{const n=e.querySelector('[data-field="print-bg"]')?.value?.trim();return t.Print.setSettings({pageBackground:n?{url:n}:null}),!0}})},setHeaderFooter:async function(){const t=this.SN,e=t.Print.ensureSettings(t.activeSheet).headerFooter||{},n=`\n        <div class="sn-form-row">\n            <label>Header</label>\n            <input type="text" data-field="print-header" value="${EP(e.header??"")}">\n        </div>\n        <div class="sn-form-row">\n            <label>Footer</label>\n            <input type="text" data-field="print-footer" value="${EP(e.footer??"")}">\n        </div>\n        <div class="sn-form-tip">Header/Footer applies to preview and print</div>\n    `;await t.Utils.modal({titleKey:"action.print.modal.m005.title",title:"Header/Footer",content:n,confirmKey:"action.print.modal.m005.confirm",confirmText:"OK",cancelKey:"action.print.modal.m005.cancel",cancelText:"Cancel",onConfirm:e=>{const n=e.querySelector('[data-field="print-header"]')?.value??"",i=e.querySelector('[data-field="print-footer"]')?.value??"";return t.Print.setSettings({headerFooter:{header:n,footer:i}}),!0}})}}),Object.assign(PP.prototype,{createPivotTable:function(){const t=this.SN,e=t.activeSheet,n=e.activeAreas[e.activeAreas.length-1],i=t.Utils.rangeNumToStr(n,!0),r=(e,n={})=>t.t(e,n);t.Utils.modal({titleKey:"pivot.create.title",title:r("pivot.create.title"),maxWidth:"420px",content:`\n            <div style="display:flex;flex-direction:column;gap:14px;">\n                <div>\n                    <div style="margin-bottom:6px;font-size:13px;color:#333;">${r("pivot.create.sourceRange")}</div>\n                    <input type="text" data-field="pt-source" value="${e.name}!${i}" style="width:100%;" />\n                </div>\n                <div>\n                    <div style="margin-bottom:6px;font-size:13px;color:#333;">${r("pivot.create.placement")}</div>\n                    <div style="display:flex;flex-direction:column;gap:8px;">\n                        <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">\n                            <input type="radio" name="pt-location" value="newSheet" checked />\n                            <span style="font-size:13px;">${r("pivot.create.newSheet")}</span>\n                        </label>\n                        <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">\n                            <input type="radio" name="pt-location" value="existingSheet" />\n                            <span style="font-size:13px;">${r("pivot.create.existingSheet")}</span>\n                        </label>\n                    </div>\n                </div>\n                <div data-field="pt-target-group" style="display:none;">\n                    <div style="margin-bottom:6px;font-size:13px;color:#333;">${r("pivot.common.targetCell")}</div>\n                    <input type="text" data-field="pt-target" value="A3" style="width:100%;" />\n                </div>\n            </div>\n        `,confirmKey:"common.ok",confirmText:r("common.ok"),cancelKey:"common.cancel",cancelText:r("common.cancel"),onOpen:t=>{const e=t.querySelectorAll('input[name="pt-location"]'),n=t.querySelector('[data-field="pt-target-group"]');e.forEach(t=>{t.onchange=()=>{n.style.display="existingSheet"===t.value&&t.checked?"block":"none"}})},onConfirm:n=>{const i=n.querySelector('[data-field="pt-source"]').value.trim(),o=n.querySelector('input[name="pt-location"]:checked').value,a=n.querySelector('[data-field="pt-target"]').value.trim();if(!i)throw r("pivot.errors.sourceRangeRequired");let s=e,l=i;if(i.includes("!")){const[e,n]=i.split("!"),o=e.replace(/^'|'$/g,"");if(s=t.getSheet(o),!s)throw r("pivot.errors.worksheetNotExists",{name:o});l=n}const c=s.rangeStrToNum(l);if(c.e.r-c.s.r<1)throw r("pivot.errors.sourceRangeMinRows");let h=null,u={r:2,c:0};"existingSheet"===o&&(h=e,a&&(u=t.Utils.cellStrToNum(a)));try{const e=zn(t,{sourceSheet:s,sourceRangeRef:c,targetSheet:h,cellRef:u}),n=h||t.sheets[t.sheets.length-1];n.activeCell={r:u.r,c:u.c},n.activeAreas=[{s:{...u},e:{...u}}],n.viewStart={r:Math.max(0,u.r-2),c:Math.max(0,u.c-1)},t.activeSheet=n,t._w=e}catch(t){throw r("pivot.errors.createFailed",{reason:t?.message||t})}}}).then(()=>{const e=t._w;delete t._w,e&&(t.Layout?.updateContextualToolbar({type:"pivotTable",data:e,autoSwitch:!0}),setTimeout(()=>{t.Layout.openPivotPanel(e)},250))}).catch(()=>{delete t._w})},refreshPivotTable:function(){const t=this.SN,e=t.activeSheet,n=(e,n={})=>t.t(e,n);if(!e.PivotTable||0===e.PivotTable.size)return void t.Utils.toast(n("pivot.toast.noPivotInSheet"));const i=e.PivotTable.getAll()[0];i&&(i.refresh(),t.Utils.toast(n("pivot.toast.refreshed")))},openPivotTableOptions:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n),i="horizontal"===e.reportFilterLayout?"horizontal":"vertical",r=Math.max(1,Number(e.reportFilterFieldsPerRow)||1),o=Number.isFinite(e.compactIndent)?e.compactIndent:1,a=!1!==e.showRowHeaders&&!1!==e.showColHeaders;t.Utils.modal({titleKey:"pivot.options.title",title:n("pivot.options.title"),maxWidth:"500px",confirmKey:"common.ok",confirmText:n("common.ok"),cancelKey:"common.cancel",cancelText:n("common.cancel"),content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.options.name")}</label>\n                    <input type="text" data-field="pivot-name" value="${e.name||""}">\n                </div>\n                <div class="sn-pivot-settings-tabs">\n                    <button type="button" class="sn-pivot-settings-tab active" data-tab="print">${n("pivot.options.tab.print")}</button>\n                    <button type="button" class="sn-pivot-settings-tab" data-tab="layout">${n("pivot.options.tab.layout")}</button>\n                    <button type="button" class="sn-pivot-settings-tab" data-tab="data">${n("pivot.options.tab.data")}</button>\n                    <button type="button" class="sn-pivot-settings-tab" data-tab="totals">${n("pivot.options.tab.totals")}</button>\n                    <button type="button" class="sn-pivot-settings-tab" data-tab="display">${n("pivot.options.tab.display")}</button>\n                    <button type="button" class="sn-pivot-settings-tab" data-tab="calc">${n("pivot.options.tab.calc")}</button>\n                </div>\n                <div class="sn-pivot-settings-panel active" data-panel="print">\n                    <div class="sn-pivot-settings-section">\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-print-drill" ${!1!==e.printDrillButtons?"checked":""}>\n                            ${n("pivot.options.print.drillButtons")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-print-repeat" ${e.printRepeatRowLabels?"checked":""}>\n                            ${n("pivot.options.print.repeatLabels")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-print-titles" ${e.printTitles?"checked":""}>\n                            ${n("pivot.options.print.setTitles")}\n                        </label>\n                    </div>\n                </div>\n                <div class="sn-pivot-settings-panel" data-panel="layout">\n                    <div class="sn-pivot-settings-section">\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-merge-labels" ${e.mergeLabelCells?"checked":""}>\n                            ${n("pivot.options.layout.mergeLabels")}\n                        </label>\n                        <div class="sn-pivot-settings-option">\n                            <span>${n("pivot.options.layout.compactIndent")}</span>\n                            <input type="number" data-field="pt-compact-indent" min="0" max="20" value="${o}" style="width:72px;">\n                            <span>${n("pivot.options.layout.characters")}</span>\n                        </div>\n                    </div>\n                    <div class="sn-pivot-settings-section">\n                        <div class="sn-pivot-settings-section-title">${n("pivot.options.layout.reportFilterLayout")}</div>\n                        <label class="sn-pivot-settings-option">\n                            <input type="radio" name="pt-filter-layout" value="vertical" ${"vertical"===i?"checked":""}>\n                            ${n("pivot.options.layout.vertical")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="radio" name="pt-filter-layout" value="horizontal" ${"horizontal"===i?"checked":""}>\n                            ${n("pivot.options.layout.horizontal")}\n                        </label>\n                        <div class="sn-pivot-settings-option">\n                            <span>${n("pivot.options.layout.fieldsPerRow")}</span>\n                            <input type="number" data-field="pt-filter-fields-per-row" min="1" max="10" value="${r}" style="width:72px;">\n                        </div>\n                    </div>\n                    <div class="sn-pivot-settings-section">\n                        <div class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-error-display" ${e.errorValueEnabled?"checked":""}>\n                            <span>${n("pivot.options.layout.errorValue")}</span>\n                            <input type="text" data-field="pt-error-text" value="${e.errorValueText??""}" style="width:120px;">\n                        </div>\n                        <div class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-empty-display" ${e.emptyValueEnabled?"checked":""}>\n                            <span>${n("pivot.options.layout.emptyValue")}</span>\n                            <input type="text" data-field="pt-empty-text" value="${e.emptyValueText??""}" style="width:120px;">\n                        </div>\n                    </div>\n                </div>\n                <div class="sn-pivot-settings-panel" data-panel="data">\n                    <div class="sn-pivot-settings-section">\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-enable-edit" ${e.enableValueCellEditing?"checked":""}>\n                            ${n("pivot.options.data.enableEditing")}\n                        </label>\n                    </div>\n                </div>\n                <div class="sn-pivot-settings-panel" data-panel="totals">\n                    <div class="sn-pivot-settings-section">\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-show-col-totals" ${!1!==e.colGrandTotals?"checked":""}>\n                            ${n("pivot.options.totals.showCol")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-show-row-totals" ${!1!==e.rowGrandTotals?"checked":""}>\n                            ${n("pivot.options.totals.showRow")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-multiple-filters" ${!1!==e.multipleFieldFilters?"checked":""}>\n                            ${n("pivot.options.totals.multiFilter")}\n                        </label>\n                    </div>\n                </div>\n                <div class="sn-pivot-settings-panel" data-panel="display">\n                    <div class="sn-pivot-settings-section">\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-show-drill" ${!1!==e.showDrill?"checked":""}>\n                            ${n("pivot.options.display.drillButtons")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-show-tooltips" ${!1!==e.showContextTips?"checked":""}>\n                            ${n("pivot.options.display.contextTips")}\n                        </label>\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-show-field-headers" ${a?"checked":""}>\n                            ${n("pivot.options.display.fieldHeaders")}\n                        </label>\n                    </div>\n                </div>\n                <div class="sn-pivot-settings-panel" data-panel="calc">\n                    <div class="sn-pivot-settings-section">\n                        <label class="sn-pivot-settings-option">\n                            <input type="checkbox" data-field="pt-include-calc" ${!1!==e.includeCalculatedItemsInTotals?"checked":""}>\n                            ${n("pivot.options.calc.includeCalculated")}\n                        </label>\n                    </div>\n                </div>\n            </div>\n        `,onOpen:t=>{const e=t.querySelectorAll(".sn-pivot-settings-tab"),n=t.querySelectorAll(".sn-pivot-settings-panel");e.forEach(t=>{t.onclick=()=>{const i=t.dataset.tab;e.forEach(e=>e.classList.toggle("active",e===t)),n.forEach(t=>{t.classList.toggle("active",t.dataset.panel===i)})}});const i=t.querySelector('[data-field="pt-error-display"]'),r=t.querySelector('[data-field="pt-error-text"]'),o=t.querySelector('[data-field="pt-empty-display"]'),a=t.querySelector('[data-field="pt-empty-text"]'),s=t.querySelectorAll('input[name="pt-filter-layout"]'),l=t.querySelector('[data-field="pt-filter-fields-per-row"]'),c=()=>{r&&(r.disabled=!i?.checked)},h=()=>{a&&(a.disabled=!o?.checked)},u=()=>{const e=t.querySelector('input[name="pt-filter-layout"]:checked')?.value;l&&(l.disabled="horizontal"!==e)};i?.addEventListener("change",c),o?.addEventListener("change",h),s.forEach(t=>{t.addEventListener("change",u)}),c(),h(),u()},onConfirm:i=>{const r=i.querySelector('[data-field="pivot-name"]'),o=r?.value?.trim();if(!o)return t.Utils.toast(n("pivot.toast.invalidName")),!1;e.name=o,e.printDrillButtons=!!i.querySelector('[data-field="pt-print-drill"]')?.checked,e.printRepeatRowLabels=!!i.querySelector('[data-field="pt-print-repeat"]')?.checked,e.printTitles=!!i.querySelector('[data-field="pt-print-titles"]')?.checked,e.mergeLabelCells=!!i.querySelector('[data-field="pt-merge-labels"]')?.checked,e.enableValueCellEditing=!!i.querySelector('[data-field="pt-enable-edit"]')?.checked,e.showContextTips=!!i.querySelector('[data-field="pt-show-tooltips"]')?.checked,e.includeCalculatedItemsInTotals=!!i.querySelector('[data-field="pt-include-calc"]')?.checked;const a=Number(i.querySelector('[data-field="pt-compact-indent"]')?.value);e.compactIndent=Number.isFinite(a)?Math.max(0,Math.min(20,a)):1;const s=i.querySelector('input[name="pt-filter-layout"]:checked')?.value||"vertical";e.reportFilterLayout="horizontal"===s?"horizontal":"vertical";const l=Number(i.querySelector('[data-field="pt-filter-fields-per-row"]')?.value);e.reportFilterFieldsPerRow=Math.max(1,Math.min(10,Number.isFinite(l)?l:1)),e.errorValueEnabled=!!i.querySelector('[data-field="pt-error-display"]')?.checked,e.errorValueText=i.querySelector('[data-field="pt-error-text"]')?.value??"",e.emptyValueEnabled=!!i.querySelector('[data-field="pt-empty-display"]')?.checked,e.emptyValueText=i.querySelector('[data-field="pt-empty-text"]')?.value??"",e.colGrandTotals=!!i.querySelector('[data-field="pt-show-col-totals"]')?.checked,e.rowGrandTotals=!!i.querySelector('[data-field="pt-show-row-totals"]')?.checked,e.multipleFieldFilters=!!i.querySelector('[data-field="pt-multiple-filters"]')?.checked,e.showDrill=!!i.querySelector('[data-field="pt-show-drill"]')?.checked;const c=!!i.querySelector('[data-field="pt-show-field-headers"]')?.checked;return e.showRowHeaders=c,e.showColHeaders=c,e.pivotFields?.length&&e.pivotFields.forEach(t=>{c?!1===t.showDropDowns&&(t.showDropDowns=!0):t.showDropDowns=!1}),e.refresh(),t.Layout?.updateContextualToolbar({type:"pivotTable",data:e}),!0}})},showPivotReportFilterPages:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n);if(!e.pageFields||0===e.pageFields.length)return void t.Utils.toast(n("pivot.reportFilter.toast.addFieldFirst"));const i=e.pageFields.map(n=>`<option value="${n}">${AP(_P(e,n,t))}</option>`).join("");t.Utils.modal({titleKey:"pivot.reportFilter.modal.title",title:n("pivot.reportFilter.modal.title"),maxWidth:"440px",confirmKey:"pivot.common.create",confirmText:n("pivot.common.create"),cancelKey:"common.cancel",cancelText:n("common.cancel"),content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.reportFilter.modal.filterField")}</label>\n                    <select data-field="pt-report-filter-field">${i}</select>\n                </div>\n                <label class="sn-pivot-settings-option">\n                    <input type="checkbox" data-field="pt-visible-only" checked>\n                    ${n("pivot.reportFilter.modal.visibleOnly")}\n                </label>\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.reportFilter.modal.sheetPrefix")}</label>\n                    <input type="text" data-field="pt-sheet-prefix" value="${AP(`${e.name}_`)}">\n                </div>\n            </div>\n        `,onConfirm:i=>{const r=Number(i.querySelector('[data-field="pt-report-filter-field"]')?.value),o=!!i.querySelector('[data-field="pt-visible-only"]')?.checked,a=(i.querySelector('[data-field="pt-sheet-prefix"]')?.value??"").trim()||`${e.name}_`;if(!Number.isFinite(r))return t.Utils.toast(n("pivot.reportFilter.toast.invalidField")),!1;const s=e.pivotFields[r];if(!s?.items?.length)return t.Utils.toast(n("pivot.reportFilter.toast.noItemsInField")),!1;const l=s.items.filter(t=>void 0!==t?.x&&(!o||"1"!==t.h));if(0===l.length)return t.Utils.toast(n("pivot.reportFilter.toast.noItemsToGenerate")),!1;let c=0,h=null;const u=FP(e.location?.ref?.split(":")[0]||"A3")||{r:2,c:0};if(l.forEach((i,o)=>{const s=e.Oi(r,i.x)||n("pivot.reportFilter.itemFallback",{index:o+1}),l=function(t,e){const n=function(t,e="PivotPage"){return(String(t??"").replace(/[:\/\*\?\[\]]/g," ").replace(/\s+/g," ").trim()||e).slice(0,31)}(e,t.t("pivot.reportFilter.defaultSheetBase"));let i=n,r=2;for(;t.getSheet(i);){const t=`_${r}`;i=`${n.slice(0,Math.max(1,31-t.length))}${t}`,r+=1}return i}(t,`${a}${s}`),d=t.addSheet(l);if(!d||!d.PivotTable)return;const f=e.cloneToSheet(d,{name:e.name,cellRef:u,render:!1});if(!f)return;const p=f.pivotFields[r];p?.items?.length&&p.items.forEach(t=>{void 0!==t.x&&(t.h=t.x===i.x?void 0:"1")}),f.cs=!0,f.calculate(),f.render(),h||(h=f),c+=1}),0===c)return t.Utils.toast(n("pivot.reportFilter.toast.createFailed")),!1;if(h){const e=FP(h.location?.ref?.split(":")[0]||"A3")||{r:2,c:0};t.activeSheet=h.sheet,h.sheet.activeCell={...e},h.sheet.activeAreas=[{s:{...e},e:{...e}}],h.sheet.viewStart={r:Math.max(0,e.r-2),c:Math.max(0,e.c-1)},t.Layout?.updateContextualToolbar({type:"pivotTable",data:h,autoSwitch:!0})}return t.Utils.toast(n("pivot.reportFilter.toast.createdCount",{count:c})),!0}})},renamePivotTable:function(t){const e=this.SN,n=$P(e);if(!n)return;const i=(t,n={})=>e.t(t,n);t&&t.trim()?(n.name=t.trim(),e.Utils.toast(i("pivot.toast.renamed"))):e.Utils.toast(i("pivot.toast.invalidName"))},pivotFieldSettings:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n),i=function(t,e){const n=e?.activeCell;if(!n||!t?.location?.ref)return null;const i=FP(t.location.ref.split(":")[0]);if(!i)return null;const r=n.r,o=n.c,a=e?.getCell?.(r,o),s=a?.Hs?.fields;if(Array.isArray(s)&&s.length>0)return s[0];const l=t.rowFields.length>0?t.compact?1:t.rowFields.length:1,c=o-i.c;if(t.rowFields.length>0&&c>=0&&c<l){if(t.compact){const e=t.getRowToggleInfo(r,i.c);return e&&void 0!==t.rowFields[e.level]?t.rowFields[e.level]:t.rowFields[0]}return t.rowFields[c]}const h=i.r+MP(t);if(t.colFields.length>0&&r>=h&&r<h+t.colFields.length){const e=r-h;if(void 0!==t.colFields[e])return t.colFields[e]}return t.rowFields.length>0?t.rowFields[0]:t.colFields.length>0?t.colFields[0]:null}(e,t.activeSheet);if(null==i)return void t.Utils.toast(n("pivot.toast.noFieldToConfigure"));const r=e.pivotFields[i];if(!r)return void t.Utils.toast(n("pivot.toast.noFieldToConfigure"));const o=e.cache?.fields?.[i],a=o?.name||r.name||n("pivot.field.fallbackName",{index:i+1}),s=r.name||a,l=!0===r.showAll,c=!0===r.subtotalTop;t.Utils.modal({titleKey:"pivot.fieldSettings.title",title:n("pivot.fieldSettings.title"),maxWidth:"480px",content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.fieldSettings.sourceName")}</label>\n                    <div class="sn-pivot-settings-static">${a}</div>\n                </div>\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.fieldSettings.customName")}</label>\n                    <input type="text" data-field="pivot-custom-name" value="${s}">\n                </div>\n                <div class="sn-pivot-settings-section">\n                    <div class="sn-pivot-settings-section-title">${n("pivot.fieldSettings.layout")}</div>\n                    <label class="sn-pivot-settings-option">\n                        <input type="checkbox" data-field="pivot-show-all"${l?" checked":""}>\n                        <span>${n("pivot.fieldSettings.showNoDataItems")}</span>\n                    </label>\n                    <label class="sn-pivot-settings-option">\n                        <input type="checkbox" data-field="pivot-subtotal-top"${c?" checked":""}>\n                        <span>${n("pivot.fieldSettings.subtotalAtTop")}</span>\n                    </label>\n                </div>\n            </div>\n        `,confirmKey:"common.ok",confirmText:n("common.ok"),cancelKey:"common.cancel",cancelText:n("common.cancel"),onConfirm:n=>{const i=n.querySelector('[data-field="pivot-custom-name"]'),o=n.querySelector('[data-field="pivot-show-all"]')?.checked??!1,s=n.querySelector('[data-field="pivot-subtotal-top"]')?.checked??!1,l=i?.value?.trim()||a;r.name=l,r.showAll=o,r.subtotalTop=s,e.refresh(),t.Layout?.updateContextualToolbar({type:"pivotTable",data:e})}})},changePivotDataSource:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n),i=t.getSheet(e.cache?.sourceSheet)||e.sheet,r=e.cache?.sourceRef||(o=e.cache?.sourceRange,o?.s&&o?.e?`${kP(o.s.c)}${o.s.r+1}:${kP(o.e.c)}${o.e.r+1}`:"")||"";var o;const a=r?`${NP(i.name)}!${r}`:`${NP(i.name)}!A1`;t.Utils.modal({titleKey:"pivot.changeSource.modal.title",title:n("pivot.changeSource.modal.title"),maxWidth:"460px",confirmKey:"pivot.common.apply",confirmText:n("pivot.common.apply"),cancelKey:"common.cancel",cancelText:n("common.cancel"),content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.changeSource.modal.sourceRange")}</label>\n                    <input type="text" data-field="pt-source" value="${AP(a)}" placeholder="${n("pivot.changeSource.modal.sourcePlaceholder")}">\n                </div>\n                <div class="sn-pivot-settings-static">${n("pivot.changeSource.modal.sourceTip")}</div>\n            </div>\n        `,onConfirm:r=>{const o=r.querySelector('[data-field="pt-source"]')?.value?.trim()||"";let a=null;try{a=function(t,e,n){const i=String(n||"").trim();if(!i)throw t.t("pivot.errors.sourceRangeRequired");let r=e||t.activeSheet,o=i;const a=i.lastIndexOf("!");if(a>-1){const e=i.slice(0,a).trim();o=i.slice(a+1).trim();const n=e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1).replace(/''/g,"'"):e;if(r=t.getSheet(n),!r)throw t.t("pivot.errors.sheetNotExists",{name:n})}if(!r)throw t.t("pivot.errors.resolveSourceSheetFailed");if(!o)throw t.t("pivot.errors.sourceRangeRequired");let s=null;try{s=r.rangeStrToNum(o)}catch(e){throw t.t("pivot.errors.invalidSourceRange")}if(!s?.s||!s?.e)throw t.t("pivot.errors.invalidSourceRange");return{sheet:r,rangeRef:o,rangeObj:s}}(t,i,o)}catch(e){return t.Utils.toast(String(e)),!1}if(a.rangeObj.e.r-a.rangeObj.s.r<1)return t.Utils.toast(n("pivot.errors.sourceRangeMinRows")),!1;try{if(!e.changeDataSource(a.sheet,a.rangeObj))return t.Utils.toast(n("pivot.changeSource.toast.updateFailed")),!1}catch(e){return t.Utils.toast(e?.message||n("pivot.changeSource.toast.updateFailed")),!1}return t.Layout?.updateContextualToolbar({type:"pivotTable",data:e}),t.Utils.toast(n("pivot.changeSource.toast.updated")),!0}})},clearPivotTable:function(t="all"){const e=this.SN,n=$P(e);if(!n)return;const i=(t,n={})=>e.t(t,n);"filters"===t?(n.pivotFields.forEach((t,e)=>{n.clearFieldFilter(e)}),n.refresh(),e.Utils.toast(i("pivot.toast.filtersCleared"))):(n.remove(),e.Layout?.updateContextualToolbar(null),e.Utils.toast(i("pivot.toast.cleared")))},movePivotTable:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n),i=e.location?.ref?.split(":")[0]||"A3",r=t.sheets.map(t=>{const n=t.name===e.sheet?.name?" selected":"";return`<option value="${AP(t.name)}"${n}>${AP(t.name)}</option>`}).join("");t.Utils.modal({titleKey:"pivot.move.modal.title",title:n("pivot.move.modal.title"),maxWidth:"420px",confirmKey:"pivot.common.move",confirmText:n("pivot.common.move"),cancelKey:"common.cancel",cancelText:n("common.cancel"),content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.common.targetSheet")}</label>\n                    <select data-field="pt-target-sheet">${r}</select>\n                </div>\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.common.targetCell")}</label>\n                    <input type="text" data-field="pt-target-cell" value="${AP(i)}" placeholder="${n("pivot.common.targetCellPlaceholder")}">\n                </div>\n            </div>\n        `,onConfirm:i=>{const r=i.querySelector('[data-field="pt-target-sheet"]')?.value,o=t.getSheet(r);if(!o)return t.Utils.toast(n("pivot.errors.targetSheetNotExists")),!1;let a=null;try{a=RP(t,i.querySelector('[data-field="pt-target-cell"]')?.value,{r:2,c:0})}catch(e){return t.Utils.toast(String(e)),!1}return e.moveTo(o,a)?(t.activeSheet=o,o.activeCell={...a},o.activeAreas=[{s:{...a},e:{...a}}],o.viewStart={r:Math.max(0,a.r-2),c:Math.max(0,a.c-1)},t.Layout?.updateContextualToolbar({type:"pivotTable",data:e,autoSwitch:!0}),t.Utils.toast(n("pivot.move.toast.moved")),!0):(t.Utils.toast(n("pivot.move.toast.failed")),!1)}})},insertPivotChart:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n),i=IP(e.location?.ref||"");if(!i)return void t.Utils.toast(n("pivot.chart.toast.invalidRange"));const r=new Map;I_(t).forEach(t=>{t.items.forEach(t=>r.set(t.key,t.text))});const o=["bar_clustered","line_basic","pie_basic","barh_clustered"].map(t=>`<option value="${t}">${r.get(t)||t}</option>`).join("");t.Utils.modal({titleKey:"pivot.chart.modal.title",title:n("pivot.chart.modal.title"),maxWidth:"420px",confirmKey:"chart.modal.confirm",confirmText:n("chart.modal.confirm"),cancelKey:"common.cancel",cancelText:n("common.cancel"),content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-row">\n                    <label>${n("pivot.chart.modal.chartType")}</label>\n                    <select data-field="pt-chart-type">\n                        ${o}\n                    </select>\n                </div>\n                <label class="sn-pivot-settings-option">\n                    <input type="checkbox" data-field="pt-chart-include-total" checked>\n                    ${n("pivot.chart.modal.includeTotals")}\n                </label>\n            </div>\n        `,onConfirm:r=>{const o=r.querySelector('[data-field="pt-chart-type"]')?.value||"bar_clustered",a=!!r.querySelector('[data-field="pt-chart-include-total"]')?.checked,s={s:{r:i.s.r+MP(e),c:i.s.c},e:{r:i.e.r,c:i.e.c}};if(a||(e.rowGrandTotals&&s.e.r>s.s.r&&(s.e.r-=1),e.colGrandTotals&&s.e.c>s.s.c&&(s.e.c-=1)),s.e.r-s.s.r<1||s.e.c-s.s.c<1)return t.Utils.toast(n("pivot.chart.toast.areaTooSmall")),!1;const l=t.activeSheet,c=l?.activeCell?{...l.activeCell}:null,h=l?.activeAreas?l.activeAreas.map(t=>({s:{...t.s},e:{...t.e}})):null;t.activeSheet=e.sheet,e.sheet.activeCell={...s.s},e.sheet.activeAreas=[{s:{...s.s},e:{...s.e}}];const u=this.insertChart(o);return l&&c&&h?(t.activeSheet=l,l.activeCell=c,l.activeAreas=h):t.activeSheet=e.sheet,!1!==u&&(t.Utils.toast(n("pivot.chart.toast.inserted")),!0)}})},recommendPivotTable:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n),i=t.getSheet(e.cache?.sourceSheet)||e.sheet,r=(o=e.cache?.sourceRange,(o?.s&&o?.e?{s:{r:o.s.r,c:o.s.c},e:{r:o.e.r,c:o.e.c}}:null)||IP(e.cache?.sourceRef||""));var o;if(!i||!r)return void t.Utils.toast(n("pivot.recommend.toast.invalidSource"));const a=function(t,e,n){const i=t?.fields||[];if(0===i.length)return[];const r=(t,e={})=>n.t(t,e),o=[],a=[];i.forEach((t,e)=>{const n=t?.sharedItems;!0===n?.containsNumber&&!0!==n?.containsString?o.push(e):a.push(e)}),0===a.length&&a.push(o[0]??0);const s=a[0]??0,l=a.find(t=>t!==s),c=o.find(t=>t!==s),h=o.find(t=>t!==s&&t!==c),u=[],d=new Set,f=t=>{const e=JSON.stringify({rows:t.rows||[],cols:t.cols||[],values:(t.values||[]).map(t=>`${t.field}:${t.subtotal||"sum"}`)});d.has(e)||(d.add(e),u.push(t))};return void 0!==c&&f({title:r("pivot.recommendation.title.summaryBy",{value:_P(e,c,n),dimension:_P(e,s,n)}),description:r("pivot.recommendation.desc.summaryBy",{dimension:_P(e,s,n),value:_P(e,c,n)}),rows:[s],cols:[],filters:[],values:[{field:c,subtotal:"sum"}]}),void 0!==c&&void 0!==l&&f({title:r("pivot.recommendation.title.crossSummary",{row:_P(e,s,n),column:_P(e,l,n)}),description:r("pivot.recommendation.desc.crossSummary",{row:_P(e,s,n),column:_P(e,l,n),value:_P(e,c,n)}),rows:[s],cols:[l],filters:[],values:[{field:c,subtotal:"sum"}]}),void 0!==c&&void 0!==h&&f({title:r("pivot.recommendation.title.dualMetric",{dimension:_P(e,s,n)}),description:r("pivot.recommendation.desc.dualMetric",{dimension:_P(e,s,n),value1:_P(e,c,n),value2:_P(e,h,n)}),rows:[s],cols:[],filters:[],values:[{field:c,subtotal:"sum"},{field:h,subtotal:"sum"}]}),f({title:r("pivot.recommendation.title.itemCount",{dimension:_P(e,s,n)}),description:r("pivot.recommendation.desc.itemCount",{dimension:_P(e,s,n)}),rows:[s],cols:[],filters:[],values:[{field:s,subtotal:"count"}]}),u}(e.cache,e,t);if(0===a.length)return void t.Utils.toast(n("pivot.recommend.toast.noRecommendation"));const s=a.map((t,e)=>`\n            <label class="sn-pivot-settings-option" style="display:block;">\n                <input type="radio" name="pt-recommend" value="${e}" ${0===e?"checked":""}>\n                <span>${AP(t.title)}</span>\n                <div class="sn-pivot-settings-static">${AP(t.description)}</div>\n            </label>\n        `).join(""),l=t.sheets.map(e=>{const n=e.name===t.activeSheet?.name?" selected":"";return`<option value="${AP(e.name)}"${n}>${AP(e.name)}</option>`}).join("");t.Utils.modal({titleKey:"pivot.recommend.modal.title",title:n("pivot.recommend.modal.title"),maxWidth:"520px",confirmKey:"pivot.common.create",confirmText:n("pivot.common.create"),cancelKey:"common.cancel",cancelText:n("common.cancel"),content:`\n            <div class="sn-pivot-settings">\n                <div class="sn-pivot-settings-section">\n                    <div class="sn-pivot-settings-section-title">${n("pivot.recommend.modal.layouts")}</div>\n                    ${s}\n                </div>\n                <div class="sn-pivot-settings-section">\n                    <div class="sn-pivot-settings-section-title">${n("pivot.recommend.modal.destination")}</div>\n                    <label class="sn-pivot-settings-option">\n                        <input type="radio" name="pt-recommend-location" value="newSheet" checked>\n                        ${n("pivot.create.newSheet")}\n                    </label>\n                    <label class="sn-pivot-settings-option">\n                        <input type="radio" name="pt-recommend-location" value="existingSheet">\n                        ${n("pivot.create.existingSheet")}\n                    </label>\n                    <div data-field="pt-recommend-target" style="display:none;">\n                        <div class="sn-pivot-settings-row">\n                            <label>${n("pivot.common.targetSheet")}</label>\n                            <select data-field="pt-target-sheet">${l}</select>\n                        </div>\n                        <div class="sn-pivot-settings-row">\n                            <label>${n("pivot.common.targetCell")}</label>\n                            <input type="text" data-field="pt-target-cell" value="A3" placeholder="${n("pivot.common.targetCellPlaceholder")}">\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `,onOpen:t=>{const e=t.querySelectorAll('input[name="pt-recommend-location"]'),n=t.querySelector('[data-field="pt-recommend-target"]');e.forEach(e=>{e.addEventListener("change",()=>{const e=t.querySelector('input[name="pt-recommend-location"]:checked')?.value;n.style.display="existingSheet"===e?"":"none"})})},onConfirm:e=>{const o=Number(e.querySelector('input[name="pt-recommend"]:checked')?.value??0),s=a[o];if(!s)return t.Utils.toast(n("pivot.recommend.toast.selectLayout")),!1;let l=null,c={r:2,c:0};if("existingSheet"===(e.querySelector('input[name="pt-recommend-location"]:checked')?.value||"newSheet")){if(l=t.getSheet(e.querySelector('[data-field="pt-target-sheet"]')?.value),!l)return t.Utils.toast(n("pivot.errors.targetSheetNotExists")),!1;try{c=RP(t,e.querySelector('[data-field="pt-target-cell"]')?.value,c)}catch(e){return t.Utils.toast(String(e)),!1}}let h=null;try{h=zn(t,{sourceSheet:i,sourceRangeRef:r,targetSheet:l,cellRef:c}),function(t,e){if(t&&e&&((e.rows||[]).forEach((e,n)=>{t.addRowField(e,n)}),(e.cols||[]).forEach((e,n)=>{t.addColField(e,n)}),(e.filters||[]).forEach(e=>{t.addPageField(e)}),(e.values||[]).forEach((e,n)=>{const i=e?.subtotal||"sum";t.addDataField(e.field,i,e.name||null,n)}),0===t.dataFields.length&&t.pivotFields.length>0)){const n=e.rows?.[0]??0;t.addDataField(n,"count")}}(h,s),h.calculate(),h.render()}catch(e){return t.Utils.toast(e?.message||n("pivot.recommend.toast.createFailed")),!1}if(h?.sheet){const e=FP(h.location?.ref?.split(":")[0]||"A3")||{r:2,c:0};t.activeSheet=h.sheet,h.sheet.activeCell={...e},h.sheet.activeAreas=[{s:{...e},e:{...e}}],h.sheet.viewStart={r:Math.max(0,e.r-2),c:Math.max(0,e.c-1)},t.Layout?.updateContextualToolbar({type:"pivotTable",data:h,autoSwitch:!0}),setTimeout(()=>t.Layout?.openPivotPanel?.(h),200)}return t.Utils.toast(n("pivot.recommend.toast.created")),!0}})},insertPivotSlicer:function(){const t=this.SN,e=t.activeSheet,n=$P(t);if(!n)return;const i=(e,n={})=>t.t(e,n),r=(n.pivotFields||[]).map((t,e)=>{const n=t?.name??i("pivot.field.fallbackName",{index:e+1});return`\n        <div class="sn-slicer-col-item">\n            <label>\n                <input type="checkbox" class="sn-slicer-col-check" data-col="${e}" data-name="${n}">\n                <span>${n}</span>\n            </label>\n        </div>\n    `}).join(""),o=`\n        <div class="sn-insert-slicer-dialog">\n            <div class="sn-form-group">\n                <label>${i("pivot.slicer.modal.selectFields")}</label>\n                <div class="sn-slicer-columns">\n                    ${r}\n                </div>\n            </div>\n        </div>\n    `;t.Utils.modal({titleKey:"pivot.slicer.modal.title",title:i("pivot.slicer.modal.title"),body:o,maxWidth:"320px",confirmKey:"common.ok",confirmText:i("common.ok"),cancelKey:"common.cancel",cancelText:i("common.cancel"),onConfirm:r=>{const o=r.querySelectorAll(".sn-slicer-col-check:checked");if(0===o.length)return t.Utils.toast(i("pivot.slicer.toast.selectAtLeastOne")),!1;const a=Array.from(o).map(t=>parseInt(t.dataset.col,10));return function(t,e,n,i=[]){const r=n.location?.ref||"A1",o=e.rangeStrToNum(r),a={r:o?.s?.r??e.activeCell.r,c:(o?.e?.c??e.activeCell.c)+2},{width:s,height:l}=mn(e),c=gn(e,l),h=[];i.forEach((t,i)=>{const r=n.pivotFields?.[t],o=r?.name??`Field ${t+1}`,u={r:a.r+i*c,c:a.c},d=e.Slicer.add({sourceType:"pivot",sourceSheet:e.name,sourceName:n.name,fieldIndex:t,fieldName:o,caption:o,startCell:u,width:s,height:l});d&&h.push(d)}),t.Canvas?.r&&t.Canvas.r()}(t,e,n,a),!0}})},togglePivotFieldList:function(){const t=this.SN,e=$P(t);e&&(t.Layout?.togglePivotPanel?t.Layout.togglePivotPanel(e):t.Layout.openPivotPanel(e))},togglePivotDrillButtons:function(){const t=this.SN,e=$P(t);e&&(e.showDrill=!e.showDrill,e.refresh(),t.Layout?.updateContextualToolbar({type:"pivotTable",data:e}))},togglePivotFieldHeaders:function(){const t=this.SN,e=$P(t);if(!e)return;const n=!(!1!==e.showRowHeaders&&!1!==e.showColHeaders);e.showRowHeaders=n,e.showColHeaders=n,e.pivotFields?.length&&e.pivotFields.forEach(t=>{n?!1===t.showDropDowns&&(t.showDropDowns=!0):t.showDropDowns=!1}),e.refresh(),t.Layout?.updateContextualToolbar({type:"pivotTable",data:e})},expandPivotField:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n);if(!e.showDrill)return void t.Utils.toast(n("pivot.toast.drillDisabled"));const i=t.activeSheet?.activeCell;if(!i)return;const r=e.getRowToggleInfo(i.r,i.c);r&&r.hasChildren?e.isRowCollapsed(r.level,r.values)&&(e.toggleRowCollapsed(r.level,r.values),e.render()):t.Utils.toast(n("pivot.toast.cannotExpandCell"))},collapsePivotField:function(){const t=this.SN,e=$P(t);if(!e)return;const n=(e,n={})=>t.t(e,n);if(!e.showDrill)return void t.Utils.toast(n("pivot.toast.drillDisabled"));const i=t.activeSheet?.activeCell;if(!i)return;const r=e.getRowToggleInfo(i.r,i.c);r&&r.hasChildren?e.isRowCollapsed(r.level,r.values)||(e.toggleRowCollapsed(r.level,r.values),e.render()):t.Utils.toast(n("pivot.toast.cannotCollapseCell"))},setPivotSubtotals:function(t){const e=this.SN,n=$P(e);n&&(n.pivotFields.forEach(e=>{"none"===t?(e.defaultSubtotal=!1,e.subtotalTop=!1):"bottom"===t?(e.defaultSubtotal=!0,e.subtotalTop=!1):"top"===t&&(e.defaultSubtotal=!0,e.subtotalTop=!0)}),n.refresh(),e.Utils.toast(((t,n={})=>e.t(t,n))("pivot.toast.subtotalsUpdated")))},setPivotGrandTotals:function(t){const e=this.SN,n=$P(e);if(n){switch(t){case"none":n.rowGrandTotals=!1,n.colGrandTotals=!1;break;case"both":n.rowGrandTotals=!0,n.colGrandTotals=!0;break;case"rows":n.rowGrandTotals=!0,n.colGrandTotals=!1;break;case"cols":n.rowGrandTotals=!1,n.colGrandTotals=!0}n.refresh(),e.Utils.toast(((t,n={})=>e.t(t,n))("pivot.toast.grandTotalsUpdated"))}},setPivotLayout:function(t){const e=this.SN,n=$P(e);if(n){switch(t){case"compact":n.compact=!0,n.compactData=!0,n.outline=!0,n.outlineData=!0;break;case"outline":n.compact=!1,n.compactData=!1,n.outline=!0,n.outlineData=!0;break;case"tabular":n.compact=!1,n.compactData=!1,n.outline=!1,n.outlineData=!1}n.refresh(),e.Utils.toast(((t,n={})=>e.t(t,n))("pivot.toast.layoutUpdated"))}},setPivotRepeatLabels:function(t){const e=this.SN,n=$P(e);n&&(n.pivotFields.forEach(e=>{e.repeatItemLabels=t}),n.refresh(),e.Utils.toast(((t,n={})=>e.t(t,n))(t?"pivot.toast.repeatLabelsEnabled":"pivot.toast.repeatLabelsDisabled")))},setPivotBlankRows:function(t){const e=this.SN,n=$P(e);n&&(n.pivotFields.forEach(e=>{e.insertBlankRow=t}),n.refresh(),e.Utils.toast(((t,n={})=>e.t(t,n))(t?"pivot.toast.blankRowsInserted":"pivot.toast.blankRowsRemoved")))},togglePivotOption:function(t){const e=this.SN,n=$P(e);if(n){switch(t){case"rowHeaders":n.showRowHeaders=!n.showRowHeaders;break;case"colHeaders":n.showColHeaders=!n.showColHeaders;break;case"rowStripes":n.showRowStripes=!n.showRowStripes;break;case"colStripes":n.showColStripes=!n.showColStripes}n.refresh(),e.Layout?.updateContextualToolbar({type:"pivotTable",data:n})}}}),Object.assign(PP.prototype,{createTable:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=(e,n={})=>t.t(e,n),r=e.activeAreas[0];if(!r)return void n.toast(t.t("action.table.toast.pleaseSelectARangeFirst"));const o=n.rangeNumToStr(r,!0),a=`\n        <div class="sn-table-dialog">\n            <div class="sn-form-group">\n                <label>${i("action.table.content.sourceRangeLabel")}</label>\n                <input type="text" class="sn-table-ref" value="${o}" placeholder="${i("action.table.content.sourceRangePlaceholder")}">\n            </div>\n            <div class="sn-form-group">\n                <label>\n                    <input type="checkbox" class="sn-table-has-header" checked>\n                    ${i("action.table.content.hasHeader")}\n                </label>\n            </div>\n        </div>\n    `;n.modal({titleKey:"action.table.modal.m001.title",title:i("action.table.modal.m001.title"),body:a,maxWidth:"360px",confirmKey:"action.table.modal.m001.confirm",confirmText:i("action.table.modal.m001.confirm"),cancelKey:"action.table.modal.m001.cancel",cancelText:i("action.table.modal.m001.cancel"),onConfirm:i=>{const r=i.querySelector(".sn-table-ref"),o=i.querySelector(".sn-table-has-header"),a=r.value.trim();if(!a)return n.toast(t.t("action.table.toast.pleaseEnterAValidRange")),!1;try{const i=e.rangeStrToNum(a);for(const o of e.Table.getAll()){const e=o.range;if(e&&!(i.e.r<e.s.r||i.s.r>e.e.r||i.e.c<e.s.c||i.s.c>e.e.c))return n.toast(t.t("action.table.toast.theSelectedRangeOverlapsAn")),!1}const r=e.Table.createFromSelection(i,{styleId:"TableStyleMedium2",showHeaderRow:o.checked,showRowStripes:!0,autoFilterEnabled:!0});return this.SN.Canvas.r(),this.SN.Layout?.updateContextualToolbar({type:"table",data:r,autoSwitch:!0}),!0}catch(e){return n.toast(e.message||t.t("action.table.toast.createFailed")),!1}}})},formatAsTable:function(t){const e=this.SN,n=e.activeSheet,i=e.Utils,r=(t,n={})=>e.t(t,n),{r:o,c:a}=n.activeCell,s=n.Table.getTableAt(o,a);if(s)return s.styleId=t,void this.SN.Canvas.r();const l=n.activeAreas[0];if(!l)return void i.toast(e.t("action.table.toast.pleaseSelectARangeFirst"));const c=i.rangeNumToStr(l,!0),h=`\n        <div class="sn-table-dialog">\n            <div class="sn-form-group">\n                <label>${r("action.table.content.sourceRangeLabel")}</label>\n                <input type="text" class="sn-table-ref" value="${c}" placeholder="${r("action.table.content.sourceRangePlaceholder")}">\n            </div>\n            <div class="sn-form-group">\n                <label>\n                    <input type="checkbox" class="sn-table-has-header" checked>\n                    ${r("action.table.content.hasHeader")}\n                </label>\n            </div>\n        </div>\n    `;i.modal({titleKey:"action.table.modal.m002.title",title:r("action.table.modal.m002.title"),body:h,maxWidth:"360px",confirmKey:"action.table.modal.m002.confirm",confirmText:r("action.table.modal.m002.confirm"),cancelKey:"action.table.modal.m002.cancel",cancelText:r("action.table.modal.m002.cancel"),onConfirm:r=>{const o=r.querySelector(".sn-table-ref"),a=r.querySelector(".sn-table-has-header"),s=o.value.trim();if(!s)return i.toast(e.t("action.table.toast.pleaseEnterAValidRange")),!1;try{const r=n.rangeStrToNum(s);for(const t of n.Table.getAll()){const n=t.range;if(n&&!(r.e.r<n.s.r||r.s.r>n.e.r||r.e.c<n.s.c||r.s.c>n.e.c))return i.toast(e.t("action.table.toast.theSelectedRangeOverlapsAn")),!1}const o=n.Table.createFromSelection(r,{styleId:t,showHeaderRow:a.checked,showRowStripes:!0,autoFilterEnabled:!0});return this.SN.Canvas.r(),this.SN.Layout?.updateContextualToolbar({type:"table",data:o,autoSwitch:!0}),!0}catch(t){return i.toast(t.message||e.t("action.table.toast.createFailed")),!1}}})},convertTableToRange:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=(e,n={})=>t.t(e,n),{r,c:o}=e.activeCell,a=e.Table.getTableAt(r,o);a?n.modal({titleKey:"action.table.modal.m003.title",title:i("action.table.modal.m003.title"),body:`<p>${i("action.table.content.convertToRangeBody")}</p>`,confirmKey:"action.table.modal.m003.confirm",confirmText:i("action.table.modal.m003.confirm"),cancelKey:"action.table.modal.m003.cancel",cancelText:i("action.table.modal.m003.cancel"),onConfirm:()=>(a.convertToRange(),this.SN.Canvas.r(),this.SN.Layout?.updateContextualToolbar(null),n.toast(t.t("action.table.toast.msg005")),!0)}):n.toast(t.t("action.table.toast.msg004"))},resizeTable:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=(e,n={})=>t.t(e,n),{r,c:o}=e.activeCell,a=e.Table.getTableAt(r,o);if(!a)return void n.toast(t.t("action.table.toast.msg004"));const s=a.ref;n.modal({titleKey:"action.table.modal.m004.title",title:i("action.table.modal.m004.title"),maxWidth:"400px",body:`\n            <div class="sn-form-group">\n                <label>${i("action.table.content.resizeRangeLabel")}</label>\n                <input type="text" class="sn-table-resize-ref" value="${s}" placeholder="${i("action.table.content.resizeRangePlaceholder")}">\n            </div>\n        `,confirmKey:"action.table.modal.m004.confirm",confirmText:i("action.table.modal.m004.confirm"),cancelKey:"action.table.modal.m004.cancel",cancelText:i("action.table.modal.m004.cancel"),onConfirm:e=>{const i=e.querySelector(".sn-table-resize-ref").value.trim();if(!i)return n.toast(t.t("action.table.toast.msg006")),!1;try{return a.resize(i),this.SN.Canvas.r(),n.toast(t.t("action.table.toast.msg007")),!0}catch(e){return n.toast(e.message||t.t("action.table.toast.resizeFailed")),!1}}})},changeTableStyle:function(t){const e=this.SN,n=e.activeSheet,i=e.Utils,r=(t,n={})=>e.t(t,n),o=(()=>{const{r:t,c:e}=n.activeCell||{},i=Number.isInteger(t)&&Number.isInteger(e)?n.Table.getTableAt(t,e):null;if(i)return i;const r=this.SN.Layout;if("table"!==r?.Pg)return null;const o=r.Kv;return o&&o.sheet===n?n.Table.get(o.id)||o:null})();if(!o)return void i.toast(e.t("action.table.toast.msg004"));if(t)return o.styleId=t,void this.SN.Canvas.r();let a=o.styleId;i.modal({titleKey:"action.table.modal.m005.title",title:r("action.table.modal.m005.title"),body:`\n            <div class="sn-table-styles-grid">\n                ${(()=>[...W.light,...W.medium,...W.dark].map(t=>{const e=j(t,this.SN);return`\n                <div class="sn-table-style-item ${t===o.styleId?"selected":""}" data-style="${t}" title="${t}">\n                    <div class="sn-table-style-preview">\n                        <div class="sn-table-style-row header" style="background:${e.header};border-color:${e.border}"></div>\n                        <div class="sn-table-style-row" style="background:${e.stripe1};border-color:${e.border}"></div>\n                        <div class="sn-table-style-row stripe" style="background:${e.stripe2};border-color:${e.border}"></div>\n                    </div>\n                </div>\n            `}).join(""))()}\n            </div>\n        `,confirmKey:"action.table.modal.m005.confirm",confirmText:r("action.table.modal.m005.confirm"),cancelKey:"action.table.modal.m005.cancel",cancelText:r("action.table.modal.m005.cancel"),bodyClass:"sn-table-style-picker-body",onConfirm:()=>(o.styleId=a,this.SN.Canvas.r(),!0),onOpen:t=>{const e=t.querySelectorAll(".sn-table-style-item");e.forEach(t=>{t.addEventListener("click",()=>{e.forEach(t=>t.classList.remove("selected")),t.classList.add("selected"),a=t.dataset.style})})}})},toggleTableOption:function(t){const e=this.SN,n=e.activeSheet,i=e.Utils,{r,c:o}=n.activeCell,a=n.Table.getTableAt(r,o);if(a){switch(t){case"headerRow":a.showHeaderRow=!a.showHeaderRow;break;case"totalsRow":a.showTotalsRow=!a.showTotalsRow;break;case"firstColumn":a.showFirstColumn=!a.showFirstColumn;break;case"lastColumn":a.showLastColumn=!a.showLastColumn;break;case"rowStripes":a.showRowStripes=!a.showRowStripes;break;case"columnStripes":a.showColumnStripes=!a.showColumnStripes;break;case"autoFilter":a.autoFilterEnabled=!a.autoFilterEnabled}this.SN.Canvas.r()}else i.toast(e.t("action.table.toast.msg004"))},renameTable:function(t){const e=this.SN,n=e.activeSheet,i=e.Utils,r=(t,n={})=>e.t(t,n),{r:o,c:a}=n.activeCell,s=n.Table.getTableAt(o,a);if(s)if(t)try{s.name=t,this.SN.Canvas.r()}catch(t){i.toast(t.message||e.t("action.table.toast.renameFailed"))}else i.modal({titleKey:"action.table.modal.m006.title",title:r("action.table.modal.m006.title"),body:`\n            <div class="sn-form-group">\n                <label>${r("action.table.content.renameLabel")}</label>\n                <input type="text" class="sn-table-name-input" value="${s.displayName||s.name}" placeholder="${r("action.table.content.renamePlaceholder")}">\n            </div>\n        `,confirmKey:"action.table.modal.m006.confirm",confirmText:r("action.table.modal.m006.confirm"),cancelKey:"action.table.modal.m006.cancel",cancelText:r("action.table.modal.m006.cancel"),onConfirm:t=>{const n=t.querySelector(".sn-table-name-input").value.trim();if(!n)return i.toast(e.t("action.table.toast.msg008")),!1;try{return s.name=n,this.SN.Canvas.r(),i.toast(e.t("action.table.toast.msg009")),!0}catch(t){return i.toast(t.message||e.t("action.table.toast.renameFailed")),!1}}});else i.toast(e.t("action.table.toast.msg004"))},deleteTable:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=(e,n={})=>t.t(e,n),{r,c:o}=e.activeCell,a=e.Table.getTableAt(r,o);a?n.modal({titleKey:"action.table.modal.m007.title",title:i("action.table.modal.m007.title"),body:`<p>${i("action.table.content.deleteTableBody")}</p>`,confirmKey:"action.table.modal.m007.confirm",confirmText:i("action.table.modal.m007.confirm"),cancelKey:"action.table.modal.m007.cancel",cancelText:i("action.table.modal.m007.cancel"),onConfirm:()=>(a.convertToRange(),this.SN.Canvas.r(),this.SN.Layout?.updateContextualToolbar(null),n.toast(t.t("action.table.toast.msg010")),!0)}):n.toast(t.t("action.table.toast.msg004"))},clearTableStyle:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,{r:i,c:r}=e.activeCell,o=e.Table.getTableAt(i,r);o?(o.styleId=null,this.SN.Canvas.r()):n.toast(t.t("action.table.toast.msg004"))},insertTableTotalsFunction:function(t){const e=this.SN,n=e.activeSheet,i=e.Utils,{r,c:o}=n.activeCell,a=n.Table.getTableAt(r,o);if(!a)return void i.toast(e.t("action.table.toast.msg004"));const s=o-a.range.s.c;try{a.setTotalsFunction(s,t),this.SN.Canvas.r()}catch(t){i.toast(t.message||e.t("action.table.toast.setTotalsFunctionFailed"))}},removeDuplicates:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=(e,n={})=>t.t(e,n),r=e.activeAreas[0];if(!r)return void n.toast(t.t("action.table.toast.msg011"));const o=r.s.c,a=r.e.c,s=r.s.r,l=[];for(let u=o;u<=a;u++){const t=e.getCell(s,u).v??n.numToChar(u);l.push({index:u-o,col:u,name:String(t)})}const c=l.map(t=>`\n        <div class="sn-duplicate-col-item">\n            <label>\n                <input type="checkbox" class="sn-duplicate-col-check" data-col="${t.col}" checked>\n                <span>${t.name}</span>\n            </label>\n        </div>\n    `).join(""),h=`\n        <div class="sn-remove-duplicates-dialog">\n            <div class="sn-form-group">\n                <label>\n                    <input type="checkbox" class="sn-has-header" checked>\n                    ${i("action.table.content.removeDuplicates.hasHeader")}\n                </label>\n            </div>\n            <div class="sn-form-group">\n                <label>${i("action.table.content.removeDuplicates.selectColumns")}</label>\n                <div class="sn-duplicate-actions">\n                    <button type="button" class="sn-btn-link sn-select-all">${i("action.table.content.removeDuplicates.selectAll")}</button>\n                    <button type="button" class="sn-btn-link sn-deselect-all">${i("action.table.content.removeDuplicates.deselectAll")}</button>\n                </div>\n                <div class="sn-duplicate-columns">\n                    ${c}\n                </div>\n            </div>\n        </div>\n    `;n.modal({titleKey:"action.table.modal.m008.title",title:i("action.table.modal.m008.title"),body:h,maxWidth:"360px",confirmKey:"action.table.modal.m008.confirm",confirmText:i("action.table.modal.m008.confirm"),cancelKey:"action.table.modal.m008.cancel",cancelText:i("action.table.modal.m008.cancel"),onOpen:t=>{const e=t.querySelector(".sn-select-all"),n=t.querySelector(".sn-deselect-all"),i=t.querySelectorAll(".sn-duplicate-col-check");e?.addEventListener("click",()=>{i.forEach(t=>t.checked=!0)}),n?.addEventListener("click",()=>{i.forEach(t=>t.checked=!1)})},onConfirm:i=>{const o=i.querySelector(".sn-has-header").checked,a=i.querySelectorAll(".sn-duplicate-col-check:checked");if(0===a.length)return n.toast(t.t("action.table.toast.msg012")),!1;const s=Array.from(a).map(t=>parseInt(t.dataset.col)),l=o?r.s.r+1:r.s.r,c=r.e.r,h=[];for(let t=l;t<=c;t++){const n=s.map(n=>e.getCell(t,n).v??"").join("\\u0000");h.push({row:t,key:n})}const u=new Set,d=[];for(const t of h)u.has(t.key)?d.push(t.row):u.add(t.key);if(0===d.length)return n.toast(t.t("action.table.toast.msg013")),!0;d.sort((t,e)=>e-t);for(const t of d)e.deleteRow(t,1);return this.SN.Canvas.r(),n.toast(t.t("action.table.toast.removeDuplicatesDone",{duplicateCount:d.length,uniqueCount:h.length-d.length})),!0}})},insertSlicer:function(){const t=this.SN,e=t.activeSheet,n=t.Utils,i=(e,n={})=>t.t(e,n),{r,c:o}=e.activeCell,a=e.Table.getTableAt(r,o);if(!a)return void n.toast(t.t("action.table.toast.msg014"));const s=a.columns.map((t,e)=>`\n        <div class="sn-slicer-col-item">\n            <label>\n                <input type="checkbox" class="sn-slicer-col-check" data-col="${e}" data-name="${t.name}">\n                <span>${t.name}</span>\n            </label>\n        </div>\n    `).join(""),l=`\n        <div class="sn-insert-slicer-dialog">\n            <div class="sn-form-group">\n                <label>${i("action.table.content.insertSlicer.selectFields")}</label>\n                <div class="sn-slicer-columns">\n                    ${s}\n                </div>\n            </div>\n        </div>\n    `;n.modal({titleKey:"action.table.modal.m009.title",title:i("action.table.modal.m009.title"),body:l,maxWidth:"320px",confirmKey:"action.table.modal.m009.confirm",confirmText:i("action.table.modal.m009.confirm"),cancelKey:"action.table.modal.m009.cancel",cancelText:i("action.table.modal.m009.cancel"),onConfirm:i=>{const r=i.querySelectorAll(".sn-slicer-col-check:checked");if(0===r.length)return n.toast(t.t("action.table.toast.msg015")),!1;const o=Array.from(r).map(t=>({index:parseInt(t.dataset.col,10),name:t.dataset.name}));return function(t,e,n,i=[]){const r={r:n.range?.s?.r??e.activeCell.r,c:(n.range?.e?.c??e.activeCell.c)+2},{width:o,height:a}=mn(e),s=gn(e,a),l=[];i.forEach((t,i)=>{const c={r:r.r+i*s,c:r.c},h=e.Slicer.add({sourceType:"table",sourceSheet:e.name,sourceName:n.name,sourceId:n.id,fieldIndex:t.index,fieldName:t.name,caption:t.name,startCell:c,width:o,height:a});h&&l.push(h)}),t.Canvas?.r&&t.Canvas.r()}(this.SN,e,a,o),!0}})}}),Object.assign(PP.prototype,{protectSheet:function(){return this.SN.activeSheet.protection.enabled?LP.call(this):DP.call(this)},unprotectSheet:function(){return LP.call(this)},configProtection:DP,cancelProtection:LP,configCellProtection:function(){const t=this.SN,e=t.activeSheet;if(!e)return;const n=(e,n={})=>t.t(e,n),i=()=>{const{r:t,c:n}=e.activeCell||{};return e.activeAreas?.length?e.activeAreas:void 0===t||void 0===n?[]:[{s:{r:t,c:n},e:{r:t,c:n}}]},r=i();let o=!1,a=!1,s=!1,l=!1;r.forEach(t=>{const n="string"==typeof t?e.rangeStrToNum(t):t;e.eachCells(n,(t,n)=>{const i=e.getCell(t,n),r=!1!==i.protection.locked,c=!!i.protection.hidden;r?o=!0:a=!0,c?s=!0:l=!0})});const c=o&&a,h=s&&l,u=s&&!l,d=`\n        <div class="sn-protect-sheet sn-cell-protect">\n            <div class="sn-protect-row">\n                <label class="sn-protect-option">\n                    <input type="checkbox" class="sn-cell-protect-lock" ${o&&!a?"checked":""}>\n                    <span>${n("action.protection.content.cell.locked")}</span>\n                </label>\n                <div class="sn-protect-label">${n("action.protection.content.cell.lockedDesc")}</div>\n            </div>\n            <div class="sn-protect-row">\n                <label class="sn-protect-option">\n                    <input type="checkbox" class="sn-cell-protect-hide" ${u?"checked":""}>\n                    <span>${n("action.protection.content.cell.hiddenFormula")}</span>\n                </label>\n                <div class="sn-protect-label">${n("action.protection.content.cell.hiddenFormulaDesc")}</div>\n            </div>\n            <div class="sn-protect-label">${n("action.protection.content.cell.tip")}</div>\n        </div>\n    `;t.Utils.modal({titleKey:"action.protection.modal.m002.title",title:n("action.protection.modal.m002.title"),content:d,maxWidth:"360px",confirmKey:"action.protection.modal.m002.confirm",confirmText:n("action.protection.modal.m002.confirm"),cancelKey:"action.protection.modal.m002.cancel",cancelText:n("action.protection.modal.m002.cancel"),onOpen:t=>{const e=t.querySelector(".sn-cell-protect-lock"),n=t.querySelector(".sn-cell-protect-hide");e&&(e.indeterminate=c),n&&(n.indeterminate=h)},onConfirm:n=>{const r=n.querySelector(".sn-cell-protect-lock"),o=n.querySelector(".sn-cell-protect-hide"),a={};if(r&&!r.indeterminate&&(a.locked=r.checked),o&&!o.indeterminate&&(a.hidden=o.checked),0===Object.keys(a).length)return;const s=i();s.length&&(e.protection.setCellProtection(s,a),t.ue(),t.Layout?.refreshActiveButtons?.(),t.Utils.toast(t.t("action.protection.toast.msg002")))}})},setPermission:function(t,e){const n=this.SN;n.Utils.toast(n.t("action.protection.toast.permissionUpdated",{type:t,value:e}))},resetPermissions:function(){const t=this.SN;t.activeSheet.protection.disable(),t.ue(),t.Layout?.refreshActiveButtons?.(),t.Utils.toast(t.t("action.protection.toast.msg005"))}});const zP=96,OP={A4:{name:"A4",paperSize:9,widthIn:8.27,heightIn:11.69},Letter:{name:"Letter",paperSize:1,widthIn:8.5,heightIn:11}},BP={9:"A4",1:"Letter"},VP={left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3};function HP(t,e){const n=Number(t);return Number.isFinite(n)?n:e}function UP(t,e){const n=Number.parseInt(t,10);return Number.isFinite(n)?n:e}function qP(t,e=!1){return!0===t||"1"===t||1===t||"true"===t||!1!==t&&"0"!==t&&0!==t&&"false"!==t&&e}function KP(t){return t?Array.isArray(t)?t:[t]:[]}function WP(t){const e=HP(t,100);return Math.min(400,Math.max(10,Math.round(e)))}function jP(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}class GP{constructor(t){this.SN=t}createDefaultSettings(){const t=OP.A4;return{pageSetup:{paperSize:t.paperSize,paperName:t.name,orientation:"portrait",scale:100,fitToWidth:0,fitToHeight:0},pageMargins:{...VP},printOptions:{gridlines:!1,headings:!1},printArea:null,printTitles:{rows:null,cols:null},headerFooter:{header:"",footer:""},pageBreaks:{rowBreaks:[],colBreaks:[]},pageBackground:null}}ensureSettings(t=this.SN.activeSheet){return t?(t.printSettings||(t.printSettings=this.createDefaultSettings()),t.printSettings):null}initSheetPrintSettings(t){const e=this.readSettingsFromXml(t?.S,t);return t.printSettings=e,"boolean"!=typeof t.showPageBreaks&&(t.showPageBreaks=!1),e}readSettingsFromXml(t,e=null){const n=this.createDefaultSettings();if(!t)return n;const i=t.pageMargins||{};n.pageMargins={left:HP(i._$left,n.pageMargins.left),right:HP(i._$right,n.pageMargins.right),top:HP(i._$top,n.pageMargins.top),bottom:HP(i._$bottom,n.pageMargins.bottom),header:HP(i._$header,n.pageMargins.header),footer:HP(i._$footer,n.pageMargins.footer)};const r=t.pageSetup||{},o=UP(r._$paperSize,n.pageSetup.paperSize),a=BP[o]||n.pageSetup.paperName;n.pageSetup.paperSize=o,n.pageSetup.paperName=a,n.pageSetup.orientation="landscape"===r._$orientation?"landscape":"portrait";const s=UP(r._$scale,n.pageSetup.scale);n.pageSetup.scale=WP(s),n.pageSetup.fitToWidth=UP(r._$fitToWidth,n.pageSetup.fitToWidth),n.pageSetup.fitToHeight=UP(r._$fitToHeight,n.pageSetup.fitToHeight);const l=t.printOptions||{};n.printOptions.gridlines=qP(l._$gridLines??l._$gridlines,n.printOptions.gridlines),n.printOptions.headings=qP(l._$headings,n.printOptions.headings);const c=t.headerFooter||{};n.headerFooter.header=c.oddHeader||"",n.headerFooter.footer=c.oddFooter||"";const h=KP(t.rowBreaks?.brk).map(t=>UP(t?._$id,null)).filter(t=>Number.isFinite(t)).map(t=>t+1),u=KP(t.colBreaks?.brk).map(t=>UP(t?._$id,null)).filter(t=>Number.isFinite(t)).map(t=>t+1);if(n.pageBreaks={rowBreaks:h,colBreaks:u},e){const t=this.Ew(e);t.printArea&&(n.printArea=t.printArea),(t.printTitles.rows||t.printTitles.cols)&&(n.printTitles=t.printTitles)}return n}applySettingsToWorksheet(t,e){const n=this.ensureSettings(t);if(!n||!e)return;const i=n.pageMargins||VP;e.pageMargins={"_$left":String(i.left??VP.left),"_$right":String(i.right??VP.right),"_$top":String(i.top??VP.top),"_$bottom":String(i.bottom??VP.bottom),"_$header":String(i.header??VP.header),"_$footer":String(i.footer??VP.footer)};const r=n.pageSetup||{};e.pageSetup=e.pageSetup||{},e.pageSetup._$paperSize=String(r.paperSize||OP.A4.paperSize),e.pageSetup._$orientation="landscape"===r.orientation?"landscape":"portrait",r.scale?e.pageSetup._$scale=String(WP(r.scale)):e.pageSetup._$scale&&delete e.pageSetup._$scale,r.fitToWidth?e.pageSetup._$fitToWidth=String(r.fitToWidth):e.pageSetup._$fitToWidth&&delete e.pageSetup._$fitToWidth,r.fitToHeight?e.pageSetup._$fitToHeight=String(r.fitToHeight):e.pageSetup._$fitToHeight&&delete e.pageSetup._$fitToHeight;const o=n.printOptions||{};o.gridlines||o.headings?(e.printOptions=e.printOptions||{},o.gridlines?e.printOptions._$gridLines="1":e.printOptions._$gridLines&&delete e.printOptions._$gridLines,o.headings?e.printOptions._$headings="1":e.printOptions._$headings&&delete e.printOptions._$headings):e.printOptions&&delete e.printOptions;const a=n.headerFooter||{};a.header||a.footer?(e.headerFooter=e.headerFooter||{},a.header?e.headerFooter.oddHeader=a.header:e.headerFooter.oddHeader&&delete e.headerFooter.oddHeader,a.footer?e.headerFooter.oddFooter=a.footer:e.headerFooter.oddFooter&&delete e.headerFooter.oddFooter):e.headerFooter&&delete e.headerFooter;const s=n.pageBreaks?.rowBreaks||[],l=n.pageBreaks?.colBreaks||[];s.length>0?e.rowBreaks={"_$count":String(s.length),"_$manualBreakCount":String(s.length),brk:s.map(t=>Math.max(0,UP(t,0)-1)).filter(t=>Number.isFinite(t)).map(t=>({"_$id":String(t),"_$man":"1"}))}:e.rowBreaks&&delete e.rowBreaks,l.length>0?e.colBreaks={"_$count":String(l.length),"_$manualBreakCount":String(l.length),brk:l.map(t=>Math.max(0,UP(t,0)-1)).filter(t=>Number.isFinite(t)).map(t=>({"_$id":String(t),"_$man":"1"}))}:e.colBreaks&&delete e.colBreaks}getSettings(t=this.SN.activeSheet){const e=this.ensureSettings(t);return e?(n=e,JSON.parse(JSON.stringify(n))):null;var n}setSettings(t,e=this.SN.activeSheet){const n=this.ensureSettings(e);return n&&t?(t.pageSetup&&Object.assign(n.pageSetup,t.pageSetup),t.pageMargins&&Object.assign(n.pageMargins,t.pageMargins),t.printOptions&&Object.assign(n.printOptions,t.printOptions),t.printTitles&&(n.printTitles=this.Iw(t.printTitles,e,n.printTitles)),t.headerFooter&&Object.assign(n.headerFooter,t.headerFooter),t.pageBreaks&&Object.assign(n.pageBreaks,t.pageBreaks),void 0!==t.pageBackground&&(n.pageBackground=t.pageBackground),void 0!==t.printArea&&(n.printArea=this.normalizeRange(t.printArea,e)),n):n}setPageMargins(t,e=this.SN.activeSheet){return this.setSettings({pageMargins:t},e)}setPageSetup(t,e=this.SN.activeSheet){const n=this.ensureSettings(e);if(!n)return n;if(t.paperName){const e=OP[t.paperName]||OP.A4;n.pageSetup.paperName=e.name,n.pageSetup.paperSize=e.paperSize}return t.paperSize&&BP[t.paperSize]&&(n.pageSetup.paperSize=t.paperSize,n.pageSetup.paperName=BP[t.paperSize]),t.orientation&&(n.pageSetup.orientation="landscape"===t.orientation?"landscape":"portrait"),void 0!==t.scale&&(n.pageSetup.scale=WP(t.scale)),void 0!==t.fitToWidth&&(n.pageSetup.fitToWidth=UP(t.fitToWidth,0)),void 0!==t.fitToHeight&&(n.pageSetup.fitToHeight=UP(t.fitToHeight,0)),n}setPrintOptions(t,e=this.SN.activeSheet){return this.setSettings({printOptions:t},e)}setPrintArea(t,e=this.SN.activeSheet){const n=this.ensureSettings(e);return n?(n.printArea=this.normalizeRange(t,e),n.printArea):null}clearPrintArea(t=this.SN.activeSheet){const e=this.ensureSettings(t);e&&(e.printArea=null)}setPrintTitles(t,e=this.SN.activeSheet){const n=this.ensureSettings(e);n&&(n.printTitles=this.Iw(t,e,n.printTitles))}toggleGridlines(t,e=this.SN.activeSheet){const n=this.ensureSettings(e);n&&(n.printOptions.gridlines=!!t)}toggleHeadings(t,e=this.SN.activeSheet){const n=this.ensureSettings(e);n&&(n.printOptions.headings=!!t)}toggleShowPageBreaks(t,e=this.SN.activeSheet){e&&(e.showPageBreaks=!!t,e===this.SN.activeSheet&&this.SN.ue())}insertPageBreak(t=null,e=this.SN.activeSheet){const n=this.ensureSettings(e);if(!n||!e)return null;const i=t||e.activeCell;if(!i||!Number.isFinite(i.r)||!Number.isFinite(i.c))return null;const r=n.pageBreaks?.rowBreaks||(n.pageBreaks.rowBreaks=[]),o=n.pageBreaks?.colBreaks||(n.pageBreaks.colBreaks=[]);let a=!1,s=!1;return i.r>0&&!r.includes(i.r)&&(r.push(i.r),r.sort((t,e)=>t-e),a=!0),i.c>0&&!o.includes(i.c)&&(o.push(i.c),o.sort((t,e)=>t-e),s=!0),{row:a,col:s}}getPageBreakGuides(t=this.SN.activeSheet){const e=this.ensureSettings(t);if(!e||!t)return null;const n=this.buildLayout(t,e),i=n.range;if(!i)return null;const r=new Set((e.pageBreaks?.rowBreaks||[]).map(t=>UP(t,null)).filter(t=>Number.isFinite(t)).filter(t=>t>i.s.r&&t<=i.e.r)),o=new Set((e.pageBreaks?.colBreaks||[]).map(t=>UP(t,null)).filter(t=>Number.isFinite(t)).filter(t=>t>i.s.c&&t<=i.e.c)),a=new Set(r),s=new Set(o);return n.rowSegments.forEach((t,e)=>{e>0&&t&&Number.isFinite(t.s)&&t.s>i.s.r&&t.s<=i.e.r&&a.add(t.s)}),n.colSegments.forEach((t,e)=>{e>0&&t&&Number.isFinite(t.s)&&t.s>i.s.c&&t.s<=i.e.c&&s.add(t.s)}),{range:i,rowBreaks:[...a].sort((t,e)=>t-e).map(t=>({index:t,manual:r.has(t)})),colBreaks:[...s].sort((t,e)=>t-e).map(t=>({index:t,manual:o.has(t)}))}}async preview(t={}){const e=t.sheet||this.SN.activeSheet;if(!e)return;e.J();const n=this.ensureSettings(e),i=this.buildLayout(e,n,t),r=await this.renderPages(e,n,i),o=this.buildPreviewHtml(r,i);await this.SN.Utils.modal({titleKey:"core.print.print.modal.m001.title",title:"Print Preview",content:o,maxWidth:"96vw",maxHeight:"90vh",confirmKey:"core.print.print.modal.m001.confirm",confirmText:"Print",cancelKey:"core.print.print.modal.m001.cancel",cancelText:"Close",bodyClass:"sn-print-preview",onOpen:t=>this.bindPreviewEvents(t,r,i),onConfirm:()=>this.print({sheet:e,settings:n,layout:i,pages:r})})}async print(t={}){const e=t.sheet||this.SN.activeSheet;if(!e)return;e.J();const n=t.settings||this.ensureSettings(e),i=t.layout||this.buildLayout(e,n,t),r=t.pages||await this.renderPages(e,n,i);if(!r.length)return void this.SN.Utils.toast(this.SN.t("core.print.print.toast.nothingToPrint"));const o=this.buildPrintHtml(r,i),a=document.createElement("iframe");a.style.position="fixed",a.style.right="0",a.style.bottom="0",a.style.width="0",a.style.height="0",a.style.border="0",a.onload=()=>{const t=a.contentWindow;t&&(t.focus(),t.print(),setTimeout(()=>a.remove(),1e3))},a.srcdoc=o,this.SN.containerDom.appendChild(a)}buildLayout(t,e,n={}){const i=this.getPaperDefinition(e),r=this.getMarginPixels(e.pageMargins),o={width:Math.max(0,i.widthPx-r.left-r.right),height:Math.max(0,i.heightPx-r.top-r.bottom)},a=this.zw(t,e,o),s=o.width/a,l=o.height/a,c=this.getPrintRange(t,e),h=this.Dw(t,e,c),u=this.Lw(c,h),d={width:Math.max(1,s-h.colsSize),height:Math.max(1,l-h.rowsSize)};let f=[],p=[];return u?(f=this.buildSegments(u.s.r,u.e.r,e=>this.getRowSize(t,e),d.height,e.pageBreaks?.rowBreaks||[]),p=this.buildSegments(u.s.c,u.e.c,e=>this.getColSize(t,e),d.width,e.pageBreaks?.colBreaks||[])):(f=[null],p=[null]),f.length||(f=[null]),p.length||(p=[null]),{paper:i,margins:r,printable:o,scale:a,range:c,bodyRange:u,rowSegments:f,colSegments:p,repeatTitles:h,pageBreakPreview:!!n.pageBreakPreview,settings:e}}getPaperDefinition(t){const e=t?.pageSetup||{},n=e.paperName||BP[e.paperSize]||"A4",i=OP[n]||OP.A4;let r=i.widthIn,o=i.heightIn;return"landscape"===e.orientation&&([r,o]=[o,r]),{name:i.name,paperSize:i.paperSize,widthIn:r,heightIn:o,widthPx:Math.round(r*zP),heightPx:Math.round(o*zP)}}getMarginPixels(t=VP){return{left:Math.round((t.left??VP.left)*zP),right:Math.round((t.right??VP.right)*zP),top:Math.round((t.top??VP.top)*zP),bottom:Math.round((t.bottom??VP.bottom)*zP)}}getPrintRange(t,e){const n=e?.printArea;return this.normalizeRange(n,t)||this.getUsedRange(t)}normalizeRange(t,e){return t&&e?"string"==typeof t?e.rangeStrToNum(t):t.s&&t.e?t:null:null}getUsedRange(t){let e=1/0,n=1/0,i=-1,r=-1;return t.rows.forEach((t,o)=>{t&&t.cells.forEach((t,a)=>{t&&t.$t&&(e=Math.min(e,o),n=Math.min(n,a),i=Math.max(i,o),r=Math.max(r,a))})}),i<0||r<0?{s:{r:0,c:0},e:{r:0,c:0}}:{s:{r:e,c:n},e:{r:i,c:r}}}buildSegments(t,e,n,i,r=[]){if(!Number.isFinite(t)||!Number.isFinite(e)||t>e)return[];const o=[],a=Math.max(1,HP(i,1)),s=new Set((r||[]).map(t=>UP(t,null)).filter(n=>Number.isFinite(n)&&n>t&&n<=e));let l=t,c=0;for(let h=t;h<=e;h++){s.has(h)&&h>l&&(o.push({s:l,e:h-1}),l=h,c=0);const t=Math.max(0,n(h));c+t>a&&h>l&&(o.push({s:l,e:h-1}),l=h,c=0),c+=t}return l<=e&&o.push({s:l,e}),o}getRowSize(t,e){const n=t.rows[e];return n&&n.hidden?0:n?n.height:t.defaultRowHeight}getColSize(t,e){const n=t.cols[e];return n&&n.hidden?0:n?n.width:t.defaultColWidth}getRangeSize(t,e,n){let i=0,r=0;for(let o=e.s.c;o<=e.e.c;o++)i+=this.getColSize(t,o);for(let o=e.s.r;o<=e.e.r;o++)r+=this.getRowSize(t,o);return n&&(i+=t.vo??t.indexWidth,r+=t.bo??t.headHeight),{width:i,height:r}}buildCellAddress(t,e){const n=this.SN.Utils.cellNumToStr(e),i=t.name||"";return i?/[\\s!]/.test(i)?`'${i}'!${n}`:`${i}!${n}`:n}async renderPages(t,e,n){const i=[],r=e.printOptions?.headings,o=n.rowSegments?.length?n.rowSegments:[null],a=n.colSegments?.length?n.colSegments:[null];for(const s of o)for(const o of a){const a=this.Ow(n,s,o),l=this.getRangeSize(t,a,r),c=await this.captureRange(t,a,l.width,l.height,e);i.push({range:a,rowSeg:s,colSeg:o,width:l.width,height:l.height,dataUrl:c})}return i}async captureRange(t,e,n,i,r){const o=t.showGridLines,a=t.showRowColHeaders;t.showGridLines=!!r.printOptions?.gridlines,t.showRowColHeaders=!!r.printOptions?.headings;try{const r=Math.max(1,Math.round(n||1)),o=Math.max(1,Math.round(i||1)),a=this.buildCellAddress(t,e.s);return await this.SN.Canvas.captureScreenshot(a,"topleft",{width:r,height:o,compress:!1,hideSelectionFrame:!0})}finally{t.showGridLines=o,t.showRowColHeaders=a}}zw(t,e,n){const i=e.pageSetup||{};let r=(i.scale??100)/100;const o=Math.max(0,UP(i.fitToWidth,0)),a=Math.max(0,UP(i.fitToHeight,0));if(o<=0&&a<=0)return Math.max(.1,Math.min(4,r||1));const s=this.getPrintRange(t,e),l=this.getRangeSize(t,s,!!e.printOptions?.headings),c=o>0?n.width*o/Math.max(1,l.width):1/0,h=a>0?n.height*a/Math.max(1,l.height):1/0,u=Math.min(c,h);return Number.isFinite(u)&&u>0&&(r=u),Math.max(.1,Math.min(4,r||1))}Dw(t,e,n){const i=this.Pw(e.printTitles?.rows),r=this.Vw(e.printTitles?.cols);let o=null,a=null;if(i){const t={s:Math.max(n.s.r,i.s),e:Math.min(n.e.r,i.e)};t.s<=t.e&&t.s===n.s.r&&(o=t)}if(r){const t={s:Math.max(n.s.c,r.s),e:Math.min(n.e.c,r.e)};t.s<=t.e&&t.s===n.s.c&&(a=t)}let s=0,l=0;if(o)for(let c=o.s;c<=o.e;c++)s+=this.getRowSize(t,c);if(a)for(let c=a.s;c<=a.e;c++)l+=this.getColSize(t,c);return{rows:o,cols:a,rowsSize:s,colsSize:l}}Lw(t,e){const n=e.rows?e.rows.e+1:t.s.r,i=e.cols?e.cols.e+1:t.s.c;return n>t.e.r||i>t.e.c?null:{s:{r:n,c:i},e:{r:t.e.r,c:t.e.c}}}Ow(t,e,n){const i=t.repeatTitles?.rows||null,r=t.repeatTitles?.cols||null,o=e||i||{s:t.range.s.r,e:t.range.e.r},a=n||r||{s:t.range.s.c,e:t.range.e.c};return{s:{r:i?i.s:o.s,c:r?r.s:a.s},e:{r:o.e,c:a.e}}}Iw(t,e,n={rows:null,cols:null}){const i=t||{},r=Object.prototype.hasOwnProperty.call(i,"rows"),o=Object.prototype.hasOwnProperty.call(i,"cols"),a=this.Bw(i.rows,e),s=this.Hw(i.cols,e);return{rows:r?null==i.rows||""===i.rows?null:a??n?.rows??null:n?.rows??null,cols:o?null==i.cols||""===i.cols?null:s??n?.cols??null:n?.cols??null}}Bw(t,e){if(null==t)return null;if(Array.isArray(t)){const e=t.map(t=>UP(t,null)).filter(t=>Number.isFinite(t));return e.length?`${Math.min(...e)+1}:${Math.max(...e)+1}`:null}if("object"==typeof t&&Number.isFinite(t.s)&&Number.isFinite(t.e))return`${Math.min(t.s,t.e)+1}:${Math.max(t.s,t.e)+1}`;if("string"!=typeof t)return null;const n=t.trim();if(!n)return null;const i=this.Uw(n,e?.name).replace(/\$/g,"").replace(/\s+/g,"");if(!/^\d+:\d+$/.test(i))return null;const[r,o]=i.split(":"),a=Math.max(1,UP(r,1)),s=Math.max(1,UP(o,a));return`${Math.min(a,s)}:${Math.max(a,s)}`}Hw(t,e){if(null==t)return null;if(Array.isArray(t)){const e=t.map(t=>UP(t,null)).filter(t=>Number.isFinite(t));if(!e.length)return null;const n=Math.min(...e),i=Math.max(...e);return`${this.SN.Utils.numToChar(n)}:${this.SN.Utils.numToChar(i)}`}if("object"==typeof t&&Number.isFinite(t.s)&&Number.isFinite(t.e)){const e=Math.min(t.s,t.e),n=Math.max(t.s,t.e);return`${this.SN.Utils.numToChar(e)}:${this.SN.Utils.numToChar(n)}`}if("string"!=typeof t)return null;const n=t.trim();if(!n)return null;const i=this.Uw(n,e?.name).replace(/\$/g,"").replace(/\s+/g,"").toUpperCase();if(!/^[A-Z]+:[A-Z]+$/.test(i))return null;const[r,o]=i.split(":"),a=this.SN.Utils.charToNum(r),s=this.SN.Utils.charToNum(o);return`${this.SN.Utils.numToChar(Math.min(a,s))}:${this.SN.Utils.numToChar(Math.max(a,s))}`}Pw(t){if(!t||"string"!=typeof t)return null;const e=t.trim().match(/^(\d+):(\d+)$/);if(!e)return null;const n=Math.max(0,UP(e[1],1)-1),i=Math.max(0,UP(e[2],1)-1);return{s:Math.min(n,i),e:Math.max(n,i)}}Vw(t){if(!t||"string"!=typeof t)return null;const e=t.trim().toUpperCase().match(/^([A-Z]+):([A-Z]+)$/);if(!e)return null;const n=this.SN.Utils.charToNum(e[1]),i=this.SN.Utils.charToNum(e[2]);return{s:Math.min(n,i),e:Math.max(n,i)}}Ew(t){const e={printArea:null,printTitles:{rows:null,cols:null}},n=this.Kw();if(!n.length||!t)return e;const i=this.SN.sheets.indexOf(t),r=n.find(e=>"_xlnm.Print_Area"===e?._$name&&this.Ww(e,t,i));if(r?.["#text"]){const n=this.jw(r["#text"]).map(e=>this.Uw(e,t.name)).find(t=>!!t);if(n){const i=this.normalizeRange(n,t);e.printArea=i||n}}const o=n.find(e=>"_xlnm.Print_Titles"===e?._$name&&this.Ww(e,t,i));return o?.["#text"]&&this.jw(o["#text"]).map(e=>this.Uw(e,t.name)).filter(Boolean).forEach(n=>{const i=this.Bw(n,t),r=this.Hw(n,t);i&&(e.printTitles.rows=i),r&&(e.printTitles.cols=r)}),e}Kw(){const t=this.SN.Xml?.obj?.["xl/workbook.xml"]?.workbook?.definedNames?.definedName;return t?Array.isArray(t)?t:[t]:[]}Ww(t,e,n){if(!t||!e)return!1;if(void 0!==t._$localSheetId)return UP(t._$localSheetId,-1)===n;const i=t["#text"];return!("string"!=typeof i||!i.includes("!"))&&this.jw(i).some(t=>this.qw(t).sheetName===e.name)}jw(t){if(!t||"string"!=typeof t)return[];const e=[];let n="",i=!1;for(let r=0;r<t.length;r++){const o=t[r];if("'"!==o)","!==o||i?n+=o:(n.trim()&&e.push(n.trim()),n="");else{if(i&&"'"===t[r+1]){n+="''",r+=1;continue}i=!i,n+=o}}return n.trim()&&e.push(n.trim()),e}qw(t){const e=String(t||"").trim(),n=e.match(/^('(?:[^']|'')+'|[^'!]+)!(.+)$/);if(!n)return{sheetName:null,ref:e};const i=n[1];return{sheetName:i.startsWith("'")?i.slice(1,-1).replace(/''/g,"'"):i,ref:n[2]}}Uw(t,e=null){const n=this.qw(t);return n.sheetName&&e&&n.sheetName!==e?"":n.ref}Gw(t,e={}){const n=String(t??"");if(!n)return"";const i=new Date,r=e.dateText??i.toLocaleDateString(),o=e.timeText??i.toLocaleTimeString(),a=e.pageNumber??"",s=e.totalPages??"",l=e.sheetName??"";return n.replace(/&&/g,"\0").replace(/&[LCR]/gi,"").replace(/&P/gi,String(a)).replace(/&N/gi,String(s)).replace(/&A/gi,String(l)).replace(/&D/gi,String(r)).replace(/&T/gi,String(o)).replace(/&[FZG]/gi,"").replace(/&\"[^\"]*\"/g,"").replace(/&K[0-9A-Fa-f]{1,8}/g,"").replace(/&\d+/g,"").replace(/&[BIESUXYOH]/gi,"").replace(/&[+-]/g,"").replace(/\u0000/g,"&").trim()}Xw(t,e=!0){const n=t.pageBackground?.url;if(!n||"string"!=typeof n)return"";const i=n.trim();return i?/^\s*javascript:/i.test(i)?"":`background-image:url("${e?jP(i).replace(/"/g,"&quot;").replace(/'/g,"&#39;"):i.replace(/["\\]/g,"\\$&")}");background-repeat:no-repeat;background-position:center center;background-size:cover;`:""}Yw(t,e,n,i={}){const r=this.Gw(t.headerFooter?.header??"",i),o=this.Gw(t.headerFooter?.footer??"",i),a=jP(r).replace(/\n/g,"<br>"),s=jP(o).replace(/\n/g,"<br>"),l=Math.round((t.pageMargins?.header??.3)*zP),c=Math.round((t.pageMargins?.footer??.3)*zP),h=`left:${e.left}px;right:${e.right}px;max-width:${n.widthPx-e.left-e.right}px;`;return{header:a?`<div class="sn-print-page-header" style="${h}top:${Math.max(4,l-12)}px;">${a}</div>`:"",footer:s?`<div class="sn-print-page-footer" style="${h}bottom:${Math.max(4,c-12)}px;">${s}</div>`:""}}buildPreviewHtml(t,e){return t.length?`\n            <div class="sn-print-preview-sidebar">${t.map((t,e)=>`<div class="sn-print-thumb" data-index="${e}">\n                <div class="sn-print-thumb-label">Page ${e+1}</div>\n                <img src="${t.dataUrl}" alt="page-${e+1}">\n            </div>`).join("")}</div>\n            <div class="sn-print-preview-main">${this.buildPreviewPageHtml(t[0],e,0,t.length)}</div>\n        `:'<div class="sn-print-preview-empty">Nothing to print</div>'}buildPreviewPageHtml(t,e,n=0,i=1){const{paper:r,margins:o,scale:a,settings:s}=e,l=Math.round(t.width*a),c=Math.round(t.height*a),h=this.Xw(s,!0),u=this.Yw(s,o,r,{pageNumber:n+1,totalPages:i,sheetName:this.SN.activeSheet?.name||""}),d=e.pageBreakPreview?`<div class="sn-print-page-range">Page ${n+1} · ${this.SN.Utils.rangeNumToStr(t.range)}</div>`:"";return`\n            <div class="sn-print-page" style="width:${r.widthPx}px;height:${r.heightPx}px;padding:${o.top}px ${o.right}px ${o.bottom}px ${o.left}px;${h}">\n                ${u.header}\n                ${d}\n                <img class="sn-print-page-image" src="${t.dataUrl}" style="width:${l}px;height:${c}px;" alt="print-page">\n                ${u.footer}\n            </div>\n        `}bindPreviewEvents(t,e,n){if(!e.length)return;const i=t.querySelector(".sn-print-preview-main"),r=Array.from(t.querySelectorAll(".sn-print-thumb")),o=t=>{const o=e[t];i.innerHTML=this.buildPreviewPageHtml(o,n,t,e.length),r.forEach((e,n)=>e.classList.toggle("active",n===t))};r.forEach((t,e)=>{t.addEventListener("click",()=>o(e))}),o(0)}buildPrintHtml(t,e){const{paper:n,margins:i,scale:r,settings:o}=e,a=`${n.name} ${n.widthIn>n.heightIn?"landscape":"portrait"}`,s=Math.round((o.pageMargins?.header??.3)*zP),l=Math.round((o.pageMargins?.footer??.3)*zP);return`<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<style>\n            @page { size: ${a}; margin: 0; }\n            body { margin: 0; padding: 0; }\n            .page {\n                position: relative;\n                width: ${n.widthPx}px;\n                height: ${n.heightPx}px;\n                padding: ${i.top}px ${i.right}px ${i.bottom}px ${i.left}px;\n                box-sizing: border-box;\n                page-break-after: always;\n                ${this.Xw(o,!1)}\n            }\n            .page img { display: block; }\n            .page .sn-print-page-header,\n            .page .sn-print-page-footer {\n                position: absolute;\n                left: ${i.left}px;\n                right: ${i.right}px;\n                color: #6b7280;\n                font-size: 12px;\n                white-space: pre-wrap;\n                pointer-events: none;\n            }\n            .page .sn-print-page-header { top: ${Math.max(4,s-12)}px; }\n            .page .sn-print-page-footer { bottom: ${Math.max(4,l-12)}px; }\n        </style>\n</head>\n<body>${t.map((e,a)=>{const s=Math.round(e.width*r),l=Math.round(e.height*r),c=this.Yw(o,i,n,{pageNumber:a+1,totalPages:t.length,sheetName:this.SN.activeSheet?.name||""});return`\n                <div class="page">\n                    ${c.header}\n                    <img src="${e.dataUrl}" style="width:${s}px;height:${l}px;">\n                    ${c.footer}\n                </div>\n            `}).join("")}</body>\n</html>`}}const XP=[{type:"function",function:{name:"View",description:"Capture the sheet view for a specified area and return a 1600x1000 image.",parameters:{type:"object",properties:{sheetName:{type:"string",description:"Sheet name. Uses active sheet if omitted."},cellRef:{type:"string",description:"Cell reference, for example A1."},csType:{type:"string",enum:["topleft","center"],description:"topleft uses the cell as top-left (default); center uses the cell as center."}},required:["cellRef"]}}},{type:"function",function:{name:"Query",description:"Query detailed table data with custom JS logic.",parameters:{type:"object",properties:{code:{type:"string",description:"JS query code. The value of the last expression is returned."}},required:["code"]}}},{type:"function",function:{name:"Edit",description:"Run JS code to edit the workbook. Avoid infinite loops and crash-prone logic.",parameters:{type:"object",properties:{code:{type:"string",description:"JS code used for editing operations."}},required:["code"]}}},{type:"function",function:{name:"Ask",description:"Ask the user a question or request confirmation.",parameters:{type:"object",properties:{question:{type:"string",description:"Question text."},options:{type:"array",items:{type:"string"},description:"Optional selectable answers."}},required:["question"]}}}];class YP{#v;#y;#b;#x;#w=[];#S=0;#C=[];#T="";#$="";#M=15;#A=[];#N=null;#k=null;#R=0;#_=3;#I={};#F=null;constructor(t,e){this.#v=t,this.#y=t.Utils,this.#b=e.AI_URL,this.#x=e.AI_TOKEN,this.#F=document.createElement("div"),this.#E()}#D(t){if(!this.#I[t]){const e={sendBtn:".sn-send-btn",promptInput:".sn-prompt-input",chatInfo:".sn-chat-info",upImgList:".upImgList"};this.#I[t]=this.#v.containerDom.querySelector(e[t])}return this.#I[t]}#L(t,e=""){return this.#v.t(t)}chatInput(t){this.#v.Layout.showAIChat=!0;const e=this.#D("promptInput");e.value=t,e.focus()}listenRequestStatus(t){return"function"!=typeof t?()=>{}:(this.#A.push(t),()=>{const e=this.#A.indexOf(t);e>-1&&this.#A.splice(e,1)})}#P(t){this.#A.forEach(e=>{try{e(t)}catch(t){}})}async conversation(t,e=!0){if(!t?.trim())return;if(!this.#v.License.isActivated&&this.#R>=this.#_)return void this.#y.toast(this.#L("ai.runtime.roundLimit","Unlicensed version allows up to 3 AI rounds per session."));this.#D("sendBtn").disabled=!0,this.#k=new AbortController;const n=this.#z();e&&this.#O("user",t,n),this.#D("promptInput").value="";const i=this.#B();this.#D("chatInfo").insertAdjacentHTML("afterbegin",i);const r=this.#v.containerDom.querySelector(`[data-chat-num="${this.#S}"]`),o={container:r,body:r.querySelector(".ai-body"),status:r.querySelector(".ai-status"),clock:r.querySelector(".chat-clock")};r.querySelector(".ai-abort-btn").onclick=()=>this.#V(o);const a=Date.now(),s=setInterval(()=>{const t=Math.floor((Date.now()-a)/1e3);o.clock.innerText=String(t)},1e3);this.#w.push({role:"user",content:t});try{await this.#H(o,n)}catch(t){if("AbortError"===t.name){const t=this.#L("ai.runtime.pausedPrompt","Task paused. Anything to add?");o.body.insertAdjacentHTML("afterbegin",`<div class="ai-response-content"><span class="abort-text">${this.#U(t)}</span></div>`),this.#q(o,null,"paused")}else o.body.insertAdjacentHTML("afterbegin",`<div class="ai-response-content"><span class="error-text">❌ ${this.#U(t.message||String(t))}</span></div>`),this.#q(o,null,"error")}finally{clearInterval(s),this.#D("sendBtn").disabled=!1,this.#k=null,this.#R++}}async#H(t,e){let n=0;const i={searchCount:0};for(;n<this.#M;){n++;const r=document.createElement("div");r.className="ai-response-content",t.body.insertBefore(r,t.body.firstChild);const o=this.#K(e),a=await this.#W(o,t,r);if(!a.tool_calls?.length){const e=this.#j(a.content);return this.#w.push({role:"assistant",content:e}),e?r.innerHTML=this.#G(e):r.remove(),void this.#q(t,i)}const s=this.#j(a.content);s?r.innerHTML=this.#G(s):r.remove(),this.#w.push({role:"assistant",content:s||null,tool_calls:a.tool_calls}),(await this.#X(a.tool_calls,t,i)).forEach(t=>this.#w.push(t))}this.#q(t,i)}async#X(t,e,n){const i=[];for(const r of t){const o=r.function.name,a=this.#Y(r),s=this.#Z(e,o,a,r.id);let l;try{l=await this.#J(o,a,e,n)}catch(t){l={success:!1,error:t.message}}this.#Q(e,s,l),l.Jw?(i.push({role:"tool",tool_call_id:r.id,content:JSON.stringify({success:!0})}),i.push({role:"user",content:[{type:"text",text:`[View tool call_id:${r.id} capture result]`},{type:"image_url",image_url:{url:l.image}}]})):i.push({role:"tool",tool_call_id:r.id,content:JSON.stringify(l)})}return i}#Y(t){const e=t?.function?.arguments;if(!e)return{};if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){return{Zw:!0,raw:String(e),error:t.message}}}async#J(t,e,n,i){if(e?.Zw)return{success:!1,error:`${this.#L("ai.runtime.toolArgParseFailed","Tool argument parse failed")}: ${e.error}`,raw:e.raw};switch(t){case"View":return await this.#tt(e);case"Query":return this.#et(e);case"Edit":return this.#nt(e);case"Ask":return await this.#it(e,n);default:return{error:`${this.#L("ai.runtime.unknownTool","Unknown tool")}: ${t}`}}}async#tt(t){try{const{sheetName:e,cellRef:n,csType:i="topleft"}=t,r=e?`'${e}'!${n}`:n;return{Jw:!0,image:await this.#v.Canvas.captureScreenshot(r,i)}}catch(t){return{success:!1,error:t.message}}}#et(t){try{const e=new Function(`return (${t.code})`)(),n=JSON.stringify(e);return n&&n.length>8e3?{success:!0,data:n.substring(0,5e3),warning:this.#L("ai.runtime.dataTruncated","Data truncated")}:{success:!0,data:e}}catch(t){return{success:!1,error:t.message}}}#nt(t){try{return new Function(t.code)(),this.#v.ue(),{success:!0}}catch(t){return{success:!1,error:t.message}}}async#it(t,e){return new Promise(n=>{this.#N=n,this.#rt(t.question,t.options,e)})}#B(){const t=this.#L("ai.runtime.running","SheetNext AI is processing..."),e=this.#L("ai.runtime.timeLabel","Time");return`<div class="chat-msg ai-chat-msg" data-chat-num="${++this.#S}">\n            <div class="ai-chat-container">\n                <div class="ai-status">\n                    <span class="status-dot">●</span>\n                    <span class="status-text">${this.#U(t)}</span>\n                    <div class="chat-time">${this.#U(e)} : <span class="chat-clock">0</span> s<span class="ai-abort-btn">${cn("zanting")}</span></div>\n                </div>\n                <div class="ai-body"></div>\n            </div>\n        </div>`}#Z(t,e,n,i){if(i){const r=t.body.querySelector(`[data-call-id="${i}"]`);if(r){const t="Edit"===e||"Query"===e?n.code:"";if(t){const e=r.querySelector(".tool-detail");e&&(e.innerHTML=`<pre class="tool-code">${this.#U(t)}</pre>`)}const i=r.querySelector(".tool-desc");if(i){const t={View:this.#L("ai.runtime.tools.view","View Snapshot"),Query:this.#L("ai.runtime.tools.query","Query Data"),Edit:this.#L("ai.runtime.tools.edit","Apply Edits"),WebSearch:`${this.#L("ai.runtime.tools.search","Search")}: ${n.query||""}`,Ask:n.question||this.#L("ai.runtime.tools.ask","Ask User")};i.innerHTML=this.#U(t[e]).replace(/\n/g,"<br>")}return r.dataset.toolId}}const r={View:this.#L("ai.runtime.tools.view","View Snapshot"),Query:this.#L("ai.runtime.tools.query","Query Data"),Edit:this.#L("ai.runtime.tools.edit","Apply Edits"),WebSearch:`${this.#L("ai.runtime.tools.search","Search")}: ${n.query||""}`,Ask:n.question||this.#L("ai.runtime.tools.ask","Ask User")},o=`tool_${Date.now()}_${Math.random().toString(36).slice(2,6)}`,a="Edit"===e||"Query"===e?n.code:"",s="Edit"===e||"Query"===e||"Ask"===e,l=`<div class="tool-item tool-${e.toLowerCase()}" data-tool="${e}" data-tool-id="${o}"${i?` data-call-id="${i}"`:""}>\n            <div class="tool-header">\n                <span class="tool-status loading">●</span>\n                <span class="tool-name">${e}</span>\n                <span class="tool-desc">${this.#U(r[e]).replace(/\n/g,"<br>")}</span>\n                ${s?`<span class="tool-toggle" onclick="this.closest('.tool-item').classList.toggle('expanded')">${cn("zk")}</span>`:""}\n            </div>\n            <div class="tool-detail">${a?`<pre class="tool-code">${this.#U(a)}</pre>`:""}</div>\n        </div>`;return t.body.insertAdjacentHTML("afterbegin",l),o}#Q(t,e,n){const i=t.body.querySelector(`[data-tool-id="${e}"]`),r=i?.querySelector(".tool-status");r&&(r.classList.remove("loading"),r.textContent=!1!==n.success?"✓":"✗",r.classList.add(!1!==n.success?"success":"error"))}#rt(t,e,n){const i=n.body.querySelector('[data-tool="Ask"]');if(!i)return;const r=i.querySelector(".tool-detail");if(!r)return;let o="";e?.length&&(o=e.map((t,e)=>`<button class="ask-option" data-index="${e}">${this.#U(t)}</button>`).join(""));const a=this.#L("ai.runtime.askPlaceholder","Or enter a custom answer..."),s=this.#L("ai.runtime.send","Send");r.innerHTML=`<div class="ai-ask-dialog">\n            <div class="ask-options">${o}</div>\n            <div class="ask-input-wrap">\n                <input type="text" class="ask-input" placeholder="${this.#U(a)}">\n                <button class="ask-submit">${this.#U(s)}</button>\n            </div>\n        </div>`,i.classList.add("expanded"),r.querySelectorAll(".ask-option").forEach(t=>{t.addEventListener("click",()=>{const n=e[parseInt(t.dataset.index)];this.#ot(n,r)})});const l=r.querySelector(".ask-input");r.querySelector(".ask-submit").addEventListener("click",()=>{l.value.trim()&&this.#ot(l.value.trim(),r)}),l.addEventListener("keydown",t=>{"Enter"===t.key&&l.value.trim()&&this.#ot(l.value.trim(),r)}),l.focus()}#ot(t,e){e.innerHTML=`<div class="ask-answered">✓ ${this.#U(t)}</div>`,this.#N&&(this.#N({success:!0,answer:t}),this.#N=null)}#q(t,e,n="done"){const i=t.clock?t.clock.innerText:"0";if(t.status){t.status.classList.remove("done","paused","error"),t.status.classList.add(n);const e=t.status.querySelector(".status-text");e&&(e.textContent="error"===n?this.#L("ai.runtime.error","Error"):"paused"===n?this.#L("ai.runtime.paused","Paused"):this.#L("ai.runtime.doneIn","Done in {seconds} s").replace("{seconds}",i));const r=t.status.querySelector(".status-dot");r&&(r.textContent="error"===n?"✗":"paused"===n?"⏸":"✓")}t.clock&&("done"===n?t.clock.parentElement.remove():t.clock.parentElement.innerHTML=i+" s")}#V(t){this.#k&&(this.#k.abort(),this.#k=null)}#K(t=[]){const e=[{role:"system",content:this.#$?.replace("{{DOC}}",this.#T)},...this.#w];if(t.length>0){const n=[{type:"text",text:"User uploaded attachments:"}];t.forEach(t=>n.push({type:"image_url",image_url:{url:t}})),e.push({role:"user",content:n})}const n=this.#v.activeSheet,i=this.#v.sheets.slice(0,5).map(t=>t.name).join("、"),r=n.vi,o=this.#y,a=`${o.cellNumToStr({r:r.rowsIndex?.[0]||0,c:r.colsIndex?.[0]||0})}:${o.cellNumToStr({r:r.rowsIndex?.[r.rowsIndex.length-1]||0,c:r.colsIndex?.[r.colsIndex.length-1]||0})}`,s=o.cellNumToStr(n.activeCell||{r:0,c:0});let l=`[System snapshot] ${this.#v.sheets.length} sheet(s) (${i}${this.#v.sheets.length>5?" etc.":""}), active sheet: ${n.name}, user visible range: ${a}, cursor: ${s}, visible area ${r.hasContent?"contains data":"is blank, possibly an empty sheet, no view capture needed"}.`;return e.push({role:"system",content:l}),e}async#W(t,e,n){if(!this.#b?.trim())throw new Error(this.#L("ai.runtime.aiUrlNotConfigured","AI_URL is not configured"));const i={"Content-Type":"application/json"};this.#x&&(i.Authorization=`Bearer ${this.#x}`);const r=await fetch(this.#b,{method:"POST",headers:i,body:JSON.stringify({messages:t,tools:XP}),signal:this.#k?.signal});if(this.#P(r.status),!r.ok){const t=await r.text().catch(()=>"");throw new Error(t||`HTTP ${r.status}`)}return await this.#at(r,e,n)}async#at(t,e,n){const i=t.body.getReader(),r=new TextDecoder;let o="";const a={content:"",tool_calls:[],usage:null};let s="";const l=[];let c=0,h=!1;const u=(t=!1)=>{if(!n||!h)return;const e=Date.now();!t&&e-c<80||(c=e,h=!1,n.innerHTML=this.#G(this.#j(s)))};try{for(;;){const{done:t,value:n}=await i.read();o+=r.decode(n||new Uint8Array,{stream:!t});const c=o.replace(/\r/g,"").split("\n");o=t?"":c.pop()||"";for(const i of c){if(!i.startsWith("data: "))continue;const t=i.slice(6).trim();if(!t||"[DONE]"===t)continue;let n;try{n=JSON.parse(t)}catch{continue}if(n.error)throw new Error(n.error.message||n.error);if("text"===n.type&&n.delta)s+=n.delta,a.content=s,h=!0,u();else{if(u(!0),"tool_call_complete"===n.type&&n.tool_call){const t=n.tool_call,e=Number.isInteger(t.index)?t.index:l.length;l[e]={id:t.id||l[e]?.id||`call_${e}`,type:t.type||"function",function:{name:t.function?.name||l[e]?.function?.name||"",arguments:"string"==typeof t.function?.arguments?t.function.arguments:t.function?.arguments?JSON.stringify(t.function.arguments):""}};continue}if("tool_call"===n.type&&n.tool_call){const t=n.tool_call,i=Number.isInteger(t.index)?t.index:l.length;l[i]||(l[i]={id:t.id||`call_${i}`,type:"function",function:{name:"",arguments:""}}),t.id&&(l[i].id=t.id),t.function?.name&&!l[i].function.name?(l[i].function.name=t.function.name,u(!0),this.#Z(e,t.function.name,{},l[i].id)):t.function?.name&&(l[i].function.name=t.function.name),t.function?.arguments&&(l[i].function.arguments+="string"==typeof t.function.arguments?t.function.arguments:JSON.stringify(t.function.arguments));continue}if("usage"===n.type&&n.usage)a.usage=n.usage;else if("web_search"===n.type)if("in_progress"===n.status||"searching"===n.status)e.body.querySelector('[data-tool="WebSearch"]')||this.#Z(e,"WebSearch",{query:this.#L("ai.runtime.webSearching","web searching...")});else if("completed"===n.status){const t=e.body.querySelector('[data-tool="WebSearch"]'),n=t?.querySelector(".tool-status");n&&(n.classList.remove("loading"),n.textContent="✓",n.classList.add("success"))}}}if(t)break}}finally{u(!0)}return a.tool_calls=l.filter(Boolean),a.content=this.#j(s),a}#z(){const t=[];if(this.#C.length>0){const e=this.#D("upImgList");e.querySelectorAll(".preview-img").forEach(e=>t.push(e.src)),e.innerHTML="",this.#C=[]}return t}#O(t,e,n){let i="";if("SN"===t)i=`<div class="chat-msg"><div class="info-op"><div class="info-box">${e}</div></div></div>`;else if("user"===t){const t=this.#v.namespace,r=n?.length?`<div class="chat-attachments">${n.map(e=>`<img src="${e}" class="chat-attach-img" onclick="${t}.AI._previewImage(this)">`).join("")}</div>`:"";i=`<div class="chat-msg"><div class="info-op sn-text-end"><div class="info-box info-box-my sn-text-start">${this.#U(e)}${r}</div></div></div>`}this.#D("chatInfo").insertAdjacentHTML("afterbegin",i)}#U(t){return"string"!=typeof t&&(t=String(t)),this.#F.textContent=t,this.#F.innerHTML}#j(t){return t?t.replace(/<think>[\s\S]*?<\/think>/gi,"").trim():""}#G(t){if(!t)return"";const e=[];let n=this.#U(t);n=n.replace(/```(\w*)\n?([\s\S]*?)```/g,(t,n,i)=>{const r=`__SN_CODE_BLOCK_${e.length}__`;return e.push(`<pre class="md-code-block"><code>${i}</code></pre>`),r});const i=this.#st(n);return n=i.text,n=n.replace(/^### (.+)$/gm,'<h4 class="md-h4">$1</h4>'),n=n.replace(/^## (.+)$/gm,'<h3 class="md-h3">$1</h3>'),n=n.replace(/^# (.+)$/gm,'<h2 class="md-h2">$1</h2>'),n=this.#lt(n),n=n.replace(/^[*-]\s+(.+)$/gm,'<li class="md-li">$1</li>'),n=n.replace(/^\d+\.\s+(.+)$/gm,'<li class="md-li-num">$1</li>'),n=this.#ct(n),n=n.replace(/\n/g,"<br>"),n=n.replace(/(<li class="md-li">.*?<\/li>)(<br>)?/g,"$1"),n=n.replace(/((?:<li class="md-li">.*?<\/li>)+)/g,'<ul class="md-ul">$1</ul>'),n=n.replace(/(<li class="md-li-num">.*?<\/li>)(<br>)?/g,"$1"),n=n.replace(/((?:<li class="md-li-num">.*?<\/li>)+)/g,'<ol class="md-ol">$1</ol>'),n=n.replace(/(<hr class="md-hr">)(<br>)?/g,"$1"),n=this.#ht(n,i.tables,"__SN_TABLE_"),n=this.#ht(n,e,"__SN_CODE_BLOCK_"),n=n.replace(/(<br>){2,}/g,'<div class="md-br"></div>'),n}#lt(t){return t.replace(/^\s*(?:(?:-\s*){3,}|(?:\*\s*){3,}|(?:_\s*){3,})\s*$/gm,'<hr class="md-hr">')}#ct(t){let e=t;return e=e.replace(/`([^`]+)`/g,'<code class="md-code-inline">$1</code>'),e=e.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),e=e.replace(/(?<!\*)\*([^*]+)\*(?!\*)/g,"<em>$1</em>"),e=e.replace(/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),e}#st(t){const e=t.split("\n"),n=[],i=[];let r=0;for(;r<e.length;){const t=e[r],o=e[r+1];if(!this.#ut(t,o)){n.push(t),r++;continue}const a=[t,o];for(r+=2;r<e.length&&this.#dt(e[r]);)a.push(e[r]),r++;const s=`__SN_TABLE_${i.length}__`;i.push(this.#ft(a)),n.push(s)}return{text:n.join("\n"),tables:i}}#ut(t,e){if(!t||!e)return!1;const n=this.#pt(t),i=this.#pt(e);return!(n.length<2||i.length!==n.length)&&i.every(t=>/^:?-{3,}:?$/.test(t))}#dt(t){return!!(t&&t.trim()&&t.includes("|"))&&this.#pt(t).length>=2}#pt(t){if(!t||!t.includes("|"))return[];const e=t.trim();return e&&"|"!==e?e.replace(/^\|/,"").replace(/\|$/,"").split("|").map(t=>t.trim()):[]}#mt(t){return/^:-+:$/.test(t)?"md-ta-center":/^-+:$/.test(t)?"md-ta-right":/^:-+$/.test(t)?"md-ta-left":""}#ft(t){const e=this.#pt(t[0]),n=this.#pt(t[1]).map(t=>this.#mt(t)),i=(t,e,i)=>{const r="th"===t?"md-th":"md-td",o=n[i];return`<${t} class="${o?`${r} ${o}`:r}">${this.#ct(e||"")}</${t}>`},r=`<thead><tr>${e.map((t,e)=>i("th",t,e)).join("")}</tr></thead>`,o=t.slice(2).map(t=>this.#pt(t)).filter(t=>t.length>0).map(t=>{const n=t.slice(0,e.length);for(;n.length<e.length;)n.push("");return`<tr>${n.map((t,e)=>i("td",t,e)).join("")}</tr>`}).join("");return`<div class="md-table-wrap"><table class="md-table">${r}${o?`<tbody>${o}</tbody>`:""}</table></div>`}#ht(t,e,n){if(!e?.length)return t;let i=t;return e.forEach((t,e)=>{i=i.replace(`${n}${e}__`,t)}),i}clearChat(){this.#y.modal({titleKey:"ai.panel.resetContext",title:this.#L("ai.panel.resetContext","Reset Context"),contentKey:"ai.runtime.clearChatConfirm",content:this.#L("ai.runtime.clearChatConfirm","Clear all chat history?"),confirmKey:"ai.runtime.confirm",confirmText:this.#L("ai.runtime.confirm","Confirm"),cancelKey:"ai.runtime.cancel",cancelText:this.#L("ai.runtime.cancel","Cancel"),onConfirm:()=>{this.#w.length=0,this.#v.containerDom.querySelectorAll(".sn-chat-info > div").forEach(t=>{t.className.includes("chat-system")||t.remove()})}})}async#E(){try{this.#T="# appoint\n    All indexes start at 0\n    CellNum : {r:num,c:num}\n    CellStr : A1\n    CellRef : {r:num,c:num} | A1\n    RangeNum : {s:{r:num,c:num},e:{r:num,c:num} }\n    RangeStr : A1:C3 | A:B | 1:2\n    RangeRef : RangeNum | RangeStr\n    DrawingOptions : {startCell?:CellRef, width?:num, height?:num, offsetX?:num, offsetY?:num, anchorType?}\n\n# {{namespace}}\n- class\n    Utils\n    IO\n    UndoRedo\n- props\n    sheets:Sheet[]\n    properties:Object\n- get/set\n    activeSheet:Sheet\n    workbookName:str\n- methods\n    addSheet(sheetName?):Sheet\n    delSheet(name)\n    getSheet(sheetName):Sheet|null\n\n## UndoRedo\n- methods\n    undo():bool\n    redo():bool\n\n## Utils\n- methods\n    numToChar(num):str 0 => A\n    charToNum(name):num A => 0\n    rangeNumToStr(RangeNum, absolute?:bool)\n    cellStrToNum(cellStr)\n    cellNumToStr(CellNum)\n\n## IO\n- methods\n    import(file:File):Promise<void> auto detect xlsx/csv/json\n    importFromUrl(fileUrl):Promise<void>\n    export(XLSX|CSV|JSON|HTML)\n    exportAllImage()\n    getData():Promise<SNObj>\n    setData(SNObj)\n\n## Sheet\n- class\n    Comment\n    AutoFilter\n    Table\n    Drawing\n    Sparkline\n    CF\n    Slicer\n    PivotTable\n- props\n    merges:RangeNum[]\n    rows:Row[]\n    cols:Col[]\n    showGridLines:bool\n    showRowColHeaders:bool\n    protection:Object same as Excel sheetProtection permissions (15 incl. sheet), e.g. {sort?:bool, insertRows?:bool, ...}\n- get/set\n    activeCell:CellNum\n    activeAreas:RangeNum[]\n    zoom:num,0.1-4\n    viewStart:CellNum\n    defaultColWidth:num,px\n    defaultRowHeight:num,px\n    indexWidth:num,px\n    headHeight:num,px\n    frozenCols:num\n    frozenRows:num\n    hidden:bool\n    name:str\n- get\n    rowCount:num\n    colCount:num\n- methods\n    rangeStrToNum(RangeStr):RangeNum\n    getRow(r:num):Row\n    getCol(c:num):Col\n    getCell(r:num|str, c?:num):Cell\n        e.g. getCell(\"A1\") or getCell(0,0)\n    eachCells(RangeRef|RangeRef[], callback:(r,c,area:RangeNum)=>void, options?:{reverse?:bool,sparse?:bool})\n    showAllHidRows()\n    showAllHidCols()\n    rangeSort(sortKeys:{col:str|num,order,customOrder?:Array}[], RangeRef?)\n        e.g. rangeSort([{col:'A',order:'asc'}],'A2:D'+sheet.rowCount)\n    insertTable(arr:(ICellConfig|str|number)[][], startCell:CellRef, ops?:{align?:str,border?:bool,width?:num,height?:num}):RangeNum\n        interface ICellConfig {\n            v?: str;\n            w?: num; Col width(px), Can be set in the first Row\n            h?: num; Row height(px), Can be set in the first Col\n            b?: bool; Bold\n            s?: num; Size\n            fg?: str; Background color\n            a?: l | r | c; text align: left/right/center\n            c?: str; Text color\n            mr?: num; Merge right, extra cells to merge (excluding itself)\n            mb?: num; Merge bottom\n            // For mr/mb merges, add the same number of \"\" placeholders to keep the 2D array rectangular.\n            // e.g. { mr: 2 }, \"\", \"\"\n        }\n        // Generate a simple meeting record template\n        const t = [\n            [{ v: \"Meeting Minutes\", s: 16, mr: 3, fg: \"#eee\", h: 45, b: true }, { w: 160 }, \"\", { w: 160 }],\n            [\"Time\", \"\", \"Location\", \"\"],\n            [\"Host\", \"\", \"Recorder\", \"\"],\n            [\"Expected\", \"\", \"Present\", \"\"],\n            [\"Absent Members\", { mr: 2 }, \"\", \"\"],\n            [\"Topic\", { mr: 2 }, \"\", \"\"],\n            [{ v: \"Content\", h: 280 }, { mr: 2 }, \"\", \"\"],\n            [{ v: \"Remarks\", h: 80 }, { mr: 2 }, \"\", \"\"]\n        ]; // Must be a rectangular matrix, mr:2 = Three cells merged\n        {{namespace}}.activeSheet.insertTable(t, \"A1\", { border: true, align: \"center\", height: 30, width: 100 });\n    unMergeCells(CellRef)\n    mergeCells(RangeRef)\n    For multiple simultaneous calls, traverse in reverse to avoid index confusion：\n        addRows(startR,num)\n        addCols(startC,num)\n        delRows(startR,num)\n        delCols(startC,num)\n\n### Drawing\n- methods\n    addChart(chartOption:Object, DrawingOptions?):DrawingItem chartOption: same as ECharts option\n        e.g.\n        {{namespace}}.activeSheet.Drawing.addChart({\n            title: {text: 'Sales trend chart'},\n            legend: {\n                data: `${sheet.name}!B3` // or ['Sales volume']\n            },\n            xAxis: {\n                type: 'category',\n                data: `${sheet.name}!C2:E2` // or ['Jan', 'Feb', 'Mar']\n            },\n            yAxis: { type: 'value' },\n            series: [{\n                name: 'Sales volume',\n                type: 'line',\n                data: `${sheet.name}!C3:E3` // or [820, 932, 901]\n            }]\n        }, {startCell: 'B2'});\n    addImage(imageBase64:str, DrawingOptions?):DrawingItem\n    addShape(shapeType:str, DrawingOptions?):DrawingItem\n        options extends: {isTextBox?:bool, shapeText?:str, shapeStyle?:Object, arrows?:str}\n    remove(id)\n    get(id):DrawingItem|null\n    getAll():DrawingItem[]\n\n#### DrawingItem\n- props\n    id:str\n    anchorType:twoCell|oneCell|absolute\n    shapeType:str ,Excel shape type enum, e.g. rect|ellipse|line...\n    isConnector:bool\n    isTextBox:bool\n    shapeStyle:obj,textDirection:horizontal|vertical\n    shapeText:str\n- get/set\n    imageBase64:str\n    startCell:CellNum\n    offsetX:num\n    offsetY:num\n    rotation:num\n    width:num\n    height:num\n    chartOption:obj\n- get\n    type:chart|image|shape\n    imageSuffix:str|null\n- methods\n    updIndex(up|down|top|bottom)\n\n### Comment\n- methods\n    add({cellRef, author?:str, text?:str, visible?:bool, width?:num, height?:num}):CommentItem\n    get(cellRef):CommentItem|null\n    remove(cellRef):bool\n    getAll():CommentItem[]\n\n#### CommentItem\n- props\n    cellRef:str\n    author:str\n    text:str\n    visible:bool\n    width:num\n    height:num\n\n### CF\n- methods\n    add({rangeRef:RangeStr, type:cellIs|colorScale|dataBar|iconSet|top10|aboveAverage|duplicateValues|containsText|expression|timePeriod|containsBlanks|containsErrors, operator?:between|notBetween|equal|notEqual|greaterThan|greaterThanOrEqual|lessThan|lessThanOrEqual, formula1?:str|num, formula2?:str|num, dxf?:Object, cfvos?:{type:min|max|num|percent|percentile|formula,val?:str|num}[], colors?:str[]}):CFRule\n        e.g.\n        const cf = {{namespace}}.activeSheet.CF;\n        // cellIs: highlight cells > 90\n        cf.add({rangeRef:'A1:A20', type:'cellIs', operator:'greaterThan', formula1:90, dxf:{font:{color:'#FF0000'}, fill:{fgColor:'#FFCCCC'}}});\n        // colorScale: 2-color gradient\n        cf.add({rangeRef:'B1:B20', type:'colorScale', cfvos:[{type:'min'},{type:'max'}], colors:['#FFFFFF','#FF0000']});\n    remove(index:num):bool\n    get(index:num):CFRule|null\n    getAll():CFRule[]\n\n#### CFRule\n    All config params from add() are readable/writable on the rule\n\n### Sparkline\n- methods\n    add({cellRef:CellRef, formula:str, type?:line|column|stacked, colors?:{series?:str,negative?:str,axis?:str,markers?:str,first?:str,last?:str,high?:str,low?:str}}):SparklineItem|null\n        e.g. type: line(default)|column|stacked\n        const sp = {{namespace}}.activeSheet.Sparkline;\n        sp.add({cellRef:'D1', formula:'A1:C1', type:'column', colors:{series:'#376092', negative:'#D00000', high:'#00B050', low:'#FF6600'}});\n    remove(cellRef):bool\n    get(cellRef):SparklineItem|null\n    getAll():SparklineItem[]\n\n#### SparklineItem\n- props\n    r:num\n    c:num\n    formula:str\n- get/set\n    type:line|column|stacked\n    colors:Object\n- methods\n    getData():num|null[]\n\n### Table\n- methods\n    getAll():TableItem[]\n    get(id:str):TableItem|null\n    add({rangeRef?:RangeStr, name?:str, displayName?:str, styleId?:str, showHeaderRow?:bool, showTotalsRow?:bool, showRowStripes?:bool, autoFilterEnabled?:bool}):TableItem\n        e.g.\n        const table = {{namespace}}.activeSheet.Table;\n        table.add({rangeRef:'A1:D10', name:'Sales', showHeaderRow:true, showRowStripes:true});\n    remove(id:str):bool\n\n#### TableItem\n- props\n    id:str\n    showHeaderRow:bool\n    showRowStripes:bool\n- get/set\n    name:str\n    styleId:str|null\n    showTotalsRow:bool\n    autoFilterEnabled:bool\n    ref:str|null\n- get\n    headerRowIndex:num\n    dataStartRow:num\n    dataEndRow:num\n    totalsRowIndex:num\n- methods\n    contains(row:num, col:num):bool\n    getColumn(colIndex:num):Object|null\n    getColumnIndexByName(name:str):num\n    resize(newRef:RangeRef)\n    setTotalsFunction(colIndex:num, funcType:str|null) funcType: sum|average|count|countNums|max|min|stdDev|var|null\n    convertToRange()\n\n### PivotTable\n- methods\n    add({sourceSheet:Sheet, sourceRangeRef:RangeRef, cellRef?:CellRef, name?:str}):PivotTableItem\n        e.g. fieldIndex = source column index (0-based), matches pivotFields order\n        const sheet = {{namespace}}.activeSheet;\n        const pt = sheet.PivotTable.add({sourceSheet:sheet, sourceRangeRef:'A1:D100', cellRef:'F1', name:'SalesPivot'});\n        pt.addRowField(0);          // Category as row\n        pt.addColField(1);          // Region as column\n        pt.addDataField(3, 'sum');  // Amount as data, sum aggregation\n        pt.setFieldSort(0, 'asc');\n        pt.refresh();\n    remove(name:str):bool\n    get(name:str):PivotTableItem|null\n    getAll():PivotTableItem[]\n    refreshAll()\n\n#### PivotTableItem\n- props\n    name:str\n    location:Object\n    pivotFields:PivotField[]\n    rowFields:num[]\n    colFields:num[]\n    dataFields:PivotDataField[]\n    pageFields:num[]\n    rowGrandTotals:bool\n    colGrandTotals:bool\n    dataCaption:str\n    grandTotalCaption:str\n    pivotTableStyleName:str\n- methods\n    addRowField(fieldIndex:num, position?:num):bool\n    removeRowField(fieldIndex:num):bool\n    addColField(fieldIndex:num, position?:num):bool\n    removeColField(fieldIndex:num):bool\n    addDataField(fieldIndex:num, subtotal?:str, name?:str|null, position?:num):bool subtotal: sum|average|count|countNums|max|min|stdDev|var\n    removeDataField(dataFieldIndex:num):bool\n    addPageField(fieldIndex:num):bool\n    removePageField(fieldIndex:num):bool\n    moveField(fieldIndex:num, fromArea:str, toArea:str, position?:num) area: row|col|data|page\n    setDataFieldSubtotal(dataFieldIndex:num, subtotal:str) subtotal: sum|average|count|countNums|max|min|stdDev|var\n    setDataFieldShowAs(dataFieldIndex:num, showDataAs:str, baseField?:num, baseItem?:num)\n    setItemHidden(fieldIndex:num, itemIndex:num, hidden:bool):bool\n    clearFieldFilter(fieldIndex:num):bool\n    setFieldSort(fieldIndex:num, sortType:str):bool sortType: asc|desc|manual\n    refresh()\n\n### Slicer\n- methods\n    add({sourceType?:str, sourceName:str, fieldIndex:num, startCell?:CellRef, fieldName?:str}):SlicerItem\n    remove(id:str)\n    get(id:str):SlicerItem|null\n    getAll():SlicerItem[]\n\n#### SlicerItem\n- props\n    id:str\n    name:str\n    caption:str\n    sourceName:str|null\n    fieldIndex:num\n    fieldName:str\n    multiSelect:bool\n- methods\n    toggleSelection(key:str, multi?:bool)\n    clearSelection(apply?:bool)\n    applyFilter()\n\n### AutoFilter\n- get/set\n    ref:str|null\n    sortState:{colIndex:num,order:asc|desc}|null\n- get\n    enabled:bool\n    headerRow:num\n    hasActiveFilters:bool\n- methods\n    getColumnFilter(colIndex:num, scopeId?:str|null):Object|null\n    setRange(range:RangeNum, scopeId?:str)\n    getColumnValues(colIndex:num, scopeId?:str):{value:any,text:str,count:num,isEmpty:bool}[]\n    setColumnFilter(colIndex:num, filter:Object, scopeId?:str)\n        filter: {type:values, values:[...]} | {type:custom, filters:[{operator, value}], and:bool}\n        operators: equal|notEqual|greaterThan|greaterThanOrEqual|lessThan|lessThanOrEqual|beginsWith|endsWith|contains|notContains\n    clearColumnFilter(colIndex:num, scopeId?:str)\n    clearAllFilters(scopeId?:str)\n    clear(scopeId?:str)\n    hasFilter(colIndex:num, scopeId?:str)\n    setSortState(colIndex:num, order:asc|desc, scopeId?:str)\n    isRowFilteredHidden(rowIndex:num):bool\n\n### Row\n- props\n    rIndex:num\n    cells:Cell[]\n- get/set\n    height:num\n    hidden:bool\n    outlineLevel:num\n    collapsed:bool\n    numFmt\n    font\n    alignment\n    border\n    fill\n\n### Col\n- props\n    cIndex:num\n- get/set\n    width:num\n    hidden:bool\n    outlineLevel:num\n    collapsed:bool\n    numFmt\n    font\n    alignment\n    border\n    fill\n- get\n    cells:Cell[]\n\n#### Cell\n- props\n    isMerged:bool\n    master:CellNum|null If merged, points to the master cell.\n- get/set\n    editVal:str\n    richText:{text:str, font?}[]|null\n    hyperlink:{target?, location?, tooltip?}\n    dataValidation:{                                                                                                                                                            \n        type:list|whole|decimal|textLength|date|time|custom,                                                                                                        \n        operator?:between|notBetween|equal|notEqual|greaterThan|greaterThanOrEqual|lessThan|lessThanOrEqual,                                                      \n        formula1?:str|num|str[],                                                                                                                                                  \n        formula2?:str|num,                                                                                                                                                        \n        allowBlank?:bool,                                                                                                                                                         \n        showDropDown?:bool,                                                                                                             \n        showInputMessage?:bool,                                                                                                                                                   \n        promptTitle?:str,                                                                                                                                                         \n        prompt?:str,                                                                                                                                                              \n        showErrorMessage?:bool,\n        errorTitle?:str,\n        error?:str,\n        errorStyle?:str\n    }|null,If type is list, formula1 must be a string array.\n    protection:{locked:bool,hidden:bool}\n    numFmt/font/alignment/border/fill: same as exceljs, but color uses \"#RRGGBB\" instead of {argb}\n    e.g.\n        cell.font = { bold: true, color: \"#FF0000\" }\n        cell.border = { top: { style: \"thin\", color: \"#000000\" } }\n        cell.fill = { fgColor: \"#FFFF00\" }\n- get\n    showVal:str\n    calcVal:str|num\n    validData:bool\n    isFormula:bool\n".replaceAll("{{namespace}}",this.#v.namespace),this.#$="You are the SN spreadsheet editor AI assistant. Fulfill user spreadsheet operation requests through tool calls.\r\n\r\n## Tool Examples\r\n\r\n### Query\r\n```javascript\r\n// Get the formula of A1 in Sheet2\r\n{{namespace}}.getSheet('Sheet2').getCell('A1').editVal\r\n```\r\n\r\n### Edit\r\n```javascript\r\n// Highlight cells in column A where value > 100\r\n{{namespace}}.activeSheet.CF.add({\r\n  rangeRef: 'A:A',\r\n  type: 'cellIs',\r\n  operator: 'greaterThan',\r\n  formula1: '100',\r\n  dxf: { fill: { fgColor: '#FFFF00' } }\r\n})\r\n```\r\n\r\n## API Reference\r\n\r\n{{DOC}}\r\n\r\n## Working Principles\r\n\r\n- Complex tasks can be broken into multiple sequential tool calls\r\n- Briefly explain what you are doing when calling tools\r\n- Understand before acting; use Query or View to gather information when needed\r\n- Use Ask to clarify with the user only when truly necessary\r\n- Generated content should be inserted in blank areas or new sheets to avoid overwriting existing data\r\n- Always reply in the same language the user uses\r\n- Keep responses concise, a few sentences at most; emojis are welcome\r\n- Refer to view screenshots as \"view\" in conversation\r\n\r\n## Code Conventions\r\n\r\n- Use {{namespace}} to access the editor (already injected into the execution environment)\r\n- No comments in code; keep output token-efficient\r\n".replaceAll("{{namespace}}",this.#v.namespace)}catch(t){}}#gt(t){if(this.#C.length>=4)return this.#y.toast(this.#L("ai.runtime.maxImages","You can upload up to 4 images.")),!1;this.#C.push(t);const e=new FileReader;return e.onload=e=>{const n=this.#v.namespace,i=document.createElement("div");i.classList.add("img-container"),i.innerHTML=`\n                <img src="${e.target.result}" class="preview-img" onclick="${n}.AI._previewImage(this)" />\n                <button class="remove-btn">×</button>\n            `,this.#D("upImgList").appendChild(i),i.querySelector(".remove-btn").addEventListener("click",()=>{i.remove(),this.#C=this.#C.filter(e=>e!==t)})},e.readAsDataURL(t),!0}Wy(t){const e=t.items;for(let n=0;n<e.length;n++)if(-1!==e[n].type.indexOf("image")){const t=e[n].getAsFile();if(t&&this.#gt(t))return!0}return!1}handleFileChange(t){this.Qw(t)}Qw(t){const e=t.target.files,n=4-this.#C.length;if(e.length>n)return this.#y.toast(this.#L("ai.runtime.maxImages","You can upload up to 4 images."));for(let i=0;i<e.length&&this.#C.length<4;i++)this.#gt(e[i]);t.target.value=""}nx(t){const e=document.createElement("div");e.classList.add("full-img-container"),e.innerHTML=`\n            <img src="${t.src}" class="full-img" />\n            <button class="close-full-img">×</button>\n        `,document.body.appendChild(e),e.querySelector(".full-img").classList.add("fade-in"),e.querySelector(".close-full-img").addEventListener("click",()=>e.remove())}async screenshot(t=[]){const e=[];for(const n of t)try{const t=await this.#v.Canvas.captureScreenshot(n);t&&e.push({type:"image_url",image_url:{url:t}})}catch(t){e.push({type:"text",text:`Capture failed: ${n}`})}e.length>0&&this.#w.push({role:"system",content:e})}sendInfo(t){let e;try{e="string"==typeof t?t:JSON.stringify(t)}catch(n){e=String(t)}e.length>8e3&&(e=e.substring(0,8e3)+"...(truncated)"),this.#w.push({role:"system",content:`Query result: ${e}`})}}class ZP{#vt=!1;#yt=!1;#bt=null;#xt=null;#wt=!1;constructor(t,e){this.sheetNext=t,this.publicKey="ISuSucIeA0p8Lftf0YHGogmXqDFvLtEFE46XsoB1R9s=",e?this.activate(e):this.#St()}get isActivated(){return this.#vt}get isServiceActive(){return this.#yt}async activate(t){try{if(!t||"string"!=typeof t)throw new Error("License Key 格式错误");const e=t.split(".");if(2!==e.length)throw new Error("License Key 格式无效");const n=this.base64Decode(e[0]),i=e[1],r=JSON.parse(n);if(!(await this.verifySignature(n,i)))throw new Error("License Key 签名验证失败");if(!this.ix(r))throw new Error("License 域名验证失败");this.#bt=r,this.#vt=!0;const o=new Date(r.serviceExpireDate).getTime();this.#yt=!isNaN(o)&&Date.now()<=o,this.#yt||this.#St()}catch(t){this.#St()}}ix(t){if(!t||"object"!=typeof t)return!1;if(!t.domains||!Array.isArray(t.domains))return!1;const e=window.location.hostname;return t.domains.some(t=>{if(t.startsWith("*.")){const n=t.slice(2);return e.endsWith(n)}return e===t})}async verifySignature(t,e){try{const n=Uint8Array.from(atob(this.publicKey),t=>t.charCodeAt(0)),i=new Uint8Array([48,42,48,5,6,3,43,101,112,3,33,0]),r=new Uint8Array(i.length+n.length);r.set(i),r.set(n,i.length);const o=await crypto.subtle.importKey("spki",r,{name:"Ed25519"},!1,["verify"]),a=Uint8Array.from(atob(e),t=>t.charCodeAt(0)),s=(new TextEncoder).encode(t);return await crypto.subtle.verify("Ed25519",o,a,s)}catch(t){return!1}}base64Decode(t){return decodeURIComponent(atob(t).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))}getInfo(){return this.#vt&&this.#bt?{domains:this.#bt.domains,serviceExpireDate:this.#bt.serviceExpireDate,daysLeft:Math.ceil((new Date(this.#bt.serviceExpireDate)-Date.now())/864e5),isServiceActive:this.#yt}:null}tg(t,e,n,i){if(!this.#wt)return;if(this.#xt||this.#Ct(),!this.#xt)return;const r=15*i;t.drawImage(this.#xt,e-this.#xt.width-r,n-this.#xt.height-r)}#St(){this.#wt=!0,this.#Tt()}#Ct(){const t=window.devicePixelRatio||1,e=document.createElement("canvas"),n=this.#$t(),i=e.getContext("2d");i.font=14*t+"px Arial";const r=i.measureText(n);e.width=Math.ceil(r.width+20*t),e.height=Math.ceil(26*t),i.font=14*t+"px Arial",i.textBaseline="middle",i.fillStyle="rgba(128, 128, 128, 0.6)",i.fillText(n,10*t,e.height/2),this.#xt=e}#$t(){const t=(this.sheetNext.I18n?.locale||"en-US").startsWith("zh")?[27426,36814,20351,29992,32,83,104,101,101,116,78,101,120,116,32,65292,19968,27454,32,65,73,32,39537,21160,30340,34920,26684,25511,20214,65281,20135,21697,21160,24577,35831,35775,38382,65306,115,104,101,101,116,110,101,120,116,46,99,111,109]:[87,101,108,99,111,109,101,32,116,111,32,83,104,101,101,116,78,101,120,116,44,32,97,110,32,65,73,45,112,111,119,101,114,101,100,32,115,112,114,101,97,100,115,104,101,101,116,32,99,111,110,116,114,111,108,33,32,86,105,115,105,116,32,115,104,101,101,116,110,101,120,116,46,99,111,109,32,102,111,114,32,117,112,100,97,116,101,115,46];return String.fromCharCode(...t)}#Tt(){setInterval(()=>{this.#wt&&(this.#xt||this.#Ct())},3e3+Math.floor(2e3*Math.random()))}}class JP{constructor(t){this.SN=t,this.dependents=new Map,this.dependencies=new Map,this.volatileCells=new Set,this.batchMode=!1,this.batchUpdates=new Set,this.calculatingStack=[]}cellKey(t,e,n){return`${t}!R${e}C${n}`}parseKey(t){const e=t.match(/^(.+)!R(\d+)C(\d+)$/);if(!e)throw new Error(`Invalid cell key: ${t}`);return{sheetName:e[1],r:parseInt(e[2]),c:parseInt(e[3])}}registerVolatile(t,e,n){const i=this.cellKey(t,e,n);this.volatileCells.add(i)}unregisterVolatile(t,e,n){const i=this.cellKey(t,e,n);this.volatileCells.delete(i)}isVolatile(t,e,n){const i=this.cellKey(t,e,n);return this.volatileCells.has(i)}recalculateVolatile(){if(0===this.volatileCells.size)return;const t=new Set;for(const n of this.volatileCells){t.add(n);const e=this.getAffectedCells(n);for(const n of e)t.add(n)}const e=this.topologicalSort(t);for(const n of e)try{const{sheetName:t,r:e,c:i}=this.parseKey(n),r=this.SN.getSheet(t);if(r){const t=r.getCell(e,i);t&&(t.H=void 0,t.U=void 0,t.K=void 0,t.calcVal)}}catch(t){}}get volatileCount(){return this.volatileCells.size}addDependency(t,e){this.dependencies.has(t)||this.dependencies.set(t,new Set),this.dependencies.get(t).add(e),this.dependents.has(e)||this.dependents.set(e,new Set),this.dependents.get(e).add(t)}removeDependency(t,e=null){if(e)this.dependencies.get(t)?.delete(e),this.dependents.get(e)?.delete(t);else{const e=this.dependencies.get(t);if(e){for(const n of e)this.dependents.get(n)?.delete(t);this.dependencies.delete(t)}}}updateDependencies(t){const e=t.row.sheet.name,n=this.cellKey(e,t.row.rIndex,t.cIndex);if(this.removeDependency(n),t.isFormula)try{const i=t.editVal.substring(1),r=this.SN.Formula.tokenize(i),o=this.SN.Formula.parseDeps(r);for(const t of o){let i=e,o=t.r,a=t.c;for(const t of r)if("CELL_REF"===t.type&&t.value.includes("!")){const[e,n]=t.value.split("!"),r=e.replace(/^'|'$/g,""),s=this.SN.Utils.cellStrToNum(n);if(s.r===o&&s.c===a){i=r;break}}const s=this.cellKey(i,o,a);this.addDependency(n,s)}}catch(t){}}getAffectedCells(t){const e=new Set,n=[t],i=new Set;for(;n.length>0;){const t=n.shift();if(i.has(t))continue;i.add(t);const r=this.dependents.get(t);if(r)for(const i of r)e.add(i),n.push(i)}return e}topologicalSort(t){const e=[],n=new Set,i=new Set,r=o=>{if(i.has(o))throw new Error(`检测到循环引用: ${o}`);if(n.has(o))return;i.add(o);const a=this.dependencies.get(o);if(a)for(const e of a)t.has(e)&&r(e);i.delete(o),n.add(o),e.push(o)};for(const o of t)if(!n.has(o))try{r(o)}catch(t){}return e}detectCycle(t,e){if(t===e)return!0;const n=new Set,i=[e];for(;i.length>0;){const e=i.shift();if(e===t)return!0;if(n.has(e))continue;n.add(e);const r=this.dependents.get(e);if(r)for(const t of r)i.push(t)}return!1}startBatch(){this.batchMode=!0,this.batchUpdates.clear()}endBatch(){if(this.batchMode=!1,0===this.batchUpdates.size)return;const t=this.topologicalSort(this.batchUpdates);for(const e of t){const{sheetName:t,r:n,c:i}=this.parseKey(e),r=this.SN.getSheet(t);if(r){const t=r.getCell(n,i);t.H=void 0,t.U=void 0,t.calcVal}}this.batchUpdates.clear()}notifyChange(t,e,n){const i=this.cellKey(t,e,n),r=this.getAffectedCells(i);if(0!==r.size)if(this.batchMode)for(const o of r)this.batchUpdates.add(o);else{const t=this.topologicalSort(r);for(const e of t){const{sheetName:t,r:n,c:i}=this.parseKey(e),r=this.SN.getSheet(t);if(r){const t=r.getCell(n,i);t.H=void 0,t.U=void 0,t.calcVal}}}}rebuildForSheet(t){const e=t.name,n=[];for(const i of this.dependencies.keys())i.startsWith(`${e}!`)&&n.push(i);for(const i of n)this.removeDependency(i);for(let i=0;i<t.rowCount;i++){const e=t.rows[i];if(e)for(let t=0;t<e.cells.length;t++){const n=e.cells[t];n&&n.isFormula&&this.updateDependencies(n)}}}rebuildAll(){this.dependencies.clear(),this.dependents.clear();for(const t of this.SN.sheets)t.initialized||t.J(),this.rebuildForSheet(t)}getDependencies(t,e,n){const i=this.cellKey(t,e,n),r=this.dependencies.get(i);return r?Array.from(r).map(t=>this.parseKey(t)):[]}getDependents(t,e,n){const i=this.cellKey(t,e,n),r=this.dependents.get(i);return r?Array.from(r).map(t=>this.parseKey(t)):[]}clear(){this.dependencies.clear(),this.dependents.clear(),this.volatileCells.clear(),this.batchUpdates.clear()}getStats(){return{totalDependencies:this.dependencies.size,totalDependents:this.dependents.size,volatileCells:this.volatileCells.size,batchMode:this.batchMode,batchUpdatesCount:this.batchUpdates.size}}}function QP(t){if(null===t)return"null";if(void 0===t)return"undefined";if(t instanceof Date)return`date:${t.toISOString()}`;const e=typeof t;if("number"===e)return Number.isNaN(t)?"number:NaN":Number.isFinite(t)?`number:${t}`:"number:"+(t>0?"Infinity":"-Infinity");if("string"===e)return`string:${JSON.stringify(t)}`;if("boolean"===e)return`boolean:${t}`;if("object"!==e)return`${e}:${String(t)}`;if(Array.isArray(t))return`array:[${t.map(t=>QP(t)).join(",")}]`;const n=Object.keys(t).sort().map(e=>`${JSON.stringify(e)}:${QP(t[e])}`).join(",");return`object:{${n}}`}class tz{constructor(t){this.items=[],this.map=new Map,this.hashFn=t||this.ox}add(t){if(null==t)return null;const e=this.hashFn(t);if(this.map.has(e))return this.map.get(e);const n=this.items.length;return this.items.push(t),this.map.set(e,n),n}ox(t){return QP(t)}getAll(){return this.items}}function ez(t,e){const n=["v","vt","f","cv","cvt","s","fo","fi","b","a","fmt"];for(const i of n)if(t[i]!==e[i])return!1;if(t.link||e.link){if(!t.link||!e.link)return!1;if(t.link.t!==e.link.t||t.link.l!==e.link.l)return!1}return QP(t.dv)===QP(e.dv)&&QP(t.p)===QP(e.p)&&QP(t.rt)===QP(e.rt)}var nz,iz="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},rz={exports:{}},oz=(nz||(nz=1,function(t){!function(){function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){a(i.response,e,n)},i.onerror=function(){},i.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof iz&&iz.global===iz?iz:void 0,o=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(t,o,a){var s=r.URL||r.webkitURL,l=document.createElement("a");o=o||t.name||"download",l.download=o,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?i(l):n(l.href)?e(t,o,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,o){if(r=r||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,o),r);else if(n(t))e(t,r,o);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){i(a)})}}:function(t,n,i,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var s="application/octet-stream"===t.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||o)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var t=h.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=t:location=t,a=null},h.readAsDataURL(t)}else{var u=r.URL||r.webkitURL,d=u.createObjectURL(t);a?a.location=d:location.href=d,a=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});r.saveAs=a.saveAs=a,t.exports=a}()}(rz)),rz.exports);const az="__sn_json_type",sz="__sn_json_value";function lz(t){return!!t&&"object"==typeof t&&!Array.isArray(t)}function cz(t){if(void 0!==t)return JSON.parse(JSON.stringify(t))}function hz(t,e=0){const n=Number.parseInt(t,10);return Number.isFinite(n)?n:e}function uz(t,e=null){const n=Number(t);return Number.isFinite(n)?n:e}function dz(t,e={r:0,c:0}){return lz(t)?{r:Math.max(0,hz(t.r,e.r)),c:Math.max(0,hz(t.c,e.c))}:{r:e.r,c:e.c}}function fz(t){if(!t?.s||!t?.e)return null;const e=Math.max(0,hz(t.s.r,0)),n=Math.max(0,hz(t.s.c,0)),i=Math.max(0,hz(t.e.r,e)),r=Math.max(0,hz(t.e.c,n));return{s:{r:Math.min(e,i),c:Math.min(n,r)},e:{r:Math.max(e,i),c:Math.max(n,r)}}}function pz(t){const e=Number(t);return Number.isFinite(e)?Math.min(4,Math.max(.1,e)):1}function mz(t,e=null){if(t instanceof Date)return{value:t.toISOString(),type:["date","time","dateTime"].includes(e)?e:"dateTime"};if("number"==typeof t){if(Number.isNaN(t))return{value:null,type:"nan"};if(!Number.isFinite(t))return{value:null,type:t>0?"inf":"-inf"}}return{value:t,type:null}}function gz(t,e){if(!e)return t;if("nan"===e)return Number.NaN;if("inf"===e)return Number.POSITIVE_INFINITY;if("-inf"===e)return Number.NEGATIVE_INFINITY;if("date"===e||"time"===e||"dateTime"===e){if(!t)return null;const e=new Date(t);return Number.isNaN(e.getTime())?null:e}return t}function vz(t){return t instanceof Date?new Date(t.getTime()):Array.isArray(t)||lz(t)?cz(t):t}function yz(t){if(t instanceof Date)return{[az]:"date",[sz]:t.toISOString()};if("number"==typeof t)return Number.isNaN(t)?{[az]:"nan",[sz]:null}:Number.isFinite(t)?t:{[az]:t>0?"inf":"-inf",[sz]:null};if(Array.isArray(t))return t.map(t=>yz(t));if(lz(t)){const e={};return Object.keys(t).forEach(n=>{e[n]=yz(t[n])}),e}return t}function bz(t){if(Array.isArray(t))return t.map(t=>bz(t));if(lz(t)&&Object.prototype.hasOwnProperty.call(t,az)){const e=t[az],n=t[sz];if("date"===e){const t=new Date(n);return Number.isNaN(t.getTime())?null:t}return"nan"===e?Number.NaN:"inf"===e?Number.POSITIVE_INFINITY:"-inf"===e?Number.NEGATIVE_INFINITY:n}if(lz(t)){const e={};return Object.keys(t).forEach(n=>{e[n]=bz(t[n])}),e}return t}function xz(t,e){let n=null;return n=void 0!==t?.s&&e?.styles?.[t.s]?cz(e.styles[t.s]):{},void 0!==t?.fo&&e?.fonts?.[t.fo]&&(n.font=cz(e.fonts[t.fo])),void 0!==t?.fi&&e?.fills?.[t.fi]&&(n.fill=cz(e.fills[t.fi])),void 0!==t?.b&&e?.borders?.[t.b]&&(n.border=cz(e.borders[t.b])),void 0!==t?.a&&e?.aligns?.[t.a]&&(n.alignment=cz(e.aligns[t.a])),null!=t?.fmt&&(n.numFmt=t.fmt),t?.p&&(n.protection=cz(t.p)),n&&0!==Object.keys(n).length?n:null}function wz(t,e){t.isMerged=!1,t.master=null,t.U=void 0,t.K=void 0,t.j=null,t.q=null,t.G=null,t.Y=!1,e.hasFormula?(t.B=e.formula,t.H=void 0!==e.calcValue?vz(e.calcValue):void 0,e.calcType&&["date","time","dateTime"].includes(e.calcType)?t.P=e.calcType:t.P=void 0):e.hasValue?(t.B=vz(e.value),t.H=void 0,e.valueType&&["date","time","dateTime"].includes(e.valueType)?t.P=e.valueType:"boolean"==typeof e.value?t.P="boolean":"string"==typeof e.value?t.P="string":t.P=void 0):(t.B="",t.H=void 0,t.P=void 0),e.richText?(t.W=cz(e.richText),null!==t.B&&void 0!==t.B&&""!==t.B||!Array.isArray(e.richText)||(t.B=e.richText.map(t=>t?.text??"").join(""),"string"==typeof t.B&&(t.P="string"))):t.W=null,t.O=e.style?cz(e.style):{},t.F=e.link?{...e.link}:null,t._=e.dataValidation?cz(e.dataValidation):null}function Sz(t){return t.CF?.getAll?t.CF.getAll().map(t=>({...cz(t.li||{}),type:t.type,priority:t.priority,sqref:t.sqref,stopIfTrue:!!t.stopIfTrue,dxf:t.dxf?cz(t.dxf):null})):[]}function Cz(t){const e={type:t.type,startCell:cz(t.startCell),offsetX:t.offsetX,offsetY:t.offsetY,width:t.width,height:t.height,anchorType:t.anchorType,rotation:t.rotation};return"twoCell"===t.anchorType&&t._n&&(e.endCell=cz(t._n),e.endOffsetX=t.En??0,e.endOffsetY=t.In??0),"chart"===t.type?e.chartOption=cz(t.chartOption):"image"===t.type?e.imageBase64=t.imageBase64:"shape"!==t.type&&"connector"!==t.type||(e.shapeType=t.shapeType,e.shapeStyle=cz(t.shapeStyle),e.shapeText=t.shapeText,e.isTextBox=!!t.isTextBox),e}function Tz(t){const e=t.Drawing;return{...t.toJSON(),sourceId:t.sourceId??null,drawing:e?{startCell:cz(e.startCell),offsetX:e.offsetX,offsetY:e.offsetY,width:e.width,height:e.height,anchorType:e.anchorType,rotation:e.rotation,endCell:e._n?cz(e._n):null,endOffsetX:e.En??0,endOffsetY:e.In??0}:null}}function $z(t){return t?.getEnabledScopes?t.getEnabledScopes().map(e=>({scopeId:e.scopeId,ownerType:e.ownerType,ownerId:e.ownerId,range:cz(e.range),xml:t.buildXml(e.scopeId)})).filter(t=>!!t.xml):[]}async function Mz(){const t=this.$,e=new tz,n=new tz,i=new tz,r=new tz,o=new tz,a=new tz,s=new tz,l={version:"2.0",workbookName:t.workbookName,activeSheet:t.activeSheet?.name||null,calcMode:"manual"===t.calcMode?"manual":"auto",readOnly:!!t.readOnly,properties:cz(t.properties||{}),definedNames:cz(t.yn||{}),styleTable:{fonts:[],fills:[],borders:[],aligns:[],styles:[]},sizeTable:{rowHeights:[],colWidths:[]},sheets:[]};for(const c of t.sheets){c.J();const t={name:c.name,hidden:!!c.hidden,showGridLines:!1!==c.showGridLines,showRowColHeaders:!1!==c.showRowColHeaders,showPageBreaks:!!c.showPageBreaks,outlinePr:cz(c.outlinePr||{}),frozenCols:hz(c.frozenCols,0),frozenRows:hz(c.frozenRows,0),freezeStartRow:hz(c.yo,0),freezeStartCol:hz(c.wo,0),defaultColWidth:hz(c.defaultColWidth,72),defaultRowHeight:hz(c.defaultRowHeight,21),zoom:pz(c.zoom),activeCell:cz(dz(c.activeCell,{r:0,c:0})),viewStart:cz(dz(c.viewStart,{r:0,c:0})),printSettings:c.printSettings?cz(c.printSettings):null,rowCount:c.rows.length,colCount:c.cols.length,cols:[],rows:[],merges:[],drawings:[]},h=c.protection?.getOptions?.();h&&(t.sheetProtection=cz(h)),c.cols.forEach(e=>{if(!e?.$t)return;const n={cIndex:e.cIndex,w:s.add(e.Nt)};e.St&&(n.hidden=!0),e.kt>0&&(n.ol=e.kt),e.Tt&&(n.cl=!0),e.xt&&(n.s=o.add(e.xt)),t.cols.push(n)}),c.rows.forEach(s=>{if(!s?.$t)return;const l={rIndex:s.rIndex,h:a.add(s.Mt),cells:[]};s.St&&(l.hidden=!0),s.kt>0&&(l.ol=s.kt),s.Tt&&(l.cl=!0),s.wt&&(l.s=o.add(s.wt));const c=[];s.cells.forEach(t=>{if(!t?.$t)return;const a={c:t.cIndex};if("string"==typeof t.B&&t.B.startsWith("=")){if(a.f=t.B,void 0!==t.H){const e=mz(t.H,t.type);a.cv=e.value,e.type&&(a.cvt=e.type)}}else if(void 0!==t.B&&null!==t.B&&""!==t.B){const e=mz(t.B,t.P);a.v=e.value,e.type&&(a.vt=e.type)}t.O&&Object.keys(t.O).length>0&&(a.s=o.add(t.O),t.O.font&&(a.fo=e.add(t.O.font)),t.O.fill&&(a.fi=n.add(t.O.fill)),t.O.border&&(a.b=i.add(t.O.border)),t.O.alignment&&(a.a=r.add(t.O.alignment)),t.O.numFmt&&(a.fmt=t.O.numFmt),t.O.protection&&(a.p=cz(t.O.protection))),t.hyperlink&&(a.link={t:t.hyperlink.target??null,l:t.hyperlink.location??null},t.hyperlink.tooltip&&(a.link.tt=t.hyperlink.tooltip)),t._&&(a.dv=cz(t._)),t.richText&&(a.rt=cz(t.richText)),c.push(a)});for(let t=0;t<c.length;t++){const e=c[t];let n=e.c;for(let i=t+1;i<c.length;i++){const t=c[i];if(t.c!==n+1||!ez(e,t))break;n=t.c}n>e.c&&(e.e=n,t+=n-e.c),l.cells.push(e)}(l.cells.length>0||l.hidden||void 0!==l.ol||l.cl||void 0!==l.s)&&t.rows.push(l)}),c.merges.forEach(e=>{const n=fz(e);n&&t.merges.push(n)});const u=c.Drawing?.getAll?.()||[],d=u.filter(t=>t?.zn).map(t=>t.zn.catch(()=>null));d.length>0&&await Promise.all(d),u.filter(t=>t&&"slicer"!==t.type).forEach(e=>t.drawings.push(Cz(e))),c.Sparkline?.groups?.length>0&&(t.sparklines=c.Sparkline.groups.map(t=>{const e=c.Sparkline.getAll().filter(e=>e.group.id===t.id);return{type:t.type,displayEmptyCellsAs:t.displayEmptyCellsAs,colors:cz(t.colors),lineWeight:t.lineWeight,manualMax:t.manualMax,manualMin:t.manualMin,dateAxis:t.dateAxis,markers:t.markers,high:t.high,low:t.low,first:t.first,last:t.last,negative:t.negative,instances:e.map(t=>({r:t.r,c:t.c,formula:t.formula}))}})),c.Comment?.map?.size>0&&(t.comments=c.Comment.getAll().map(t=>({cellRef:t.cellRef,author:t.author,text:t.text,visible:t.visible,width:t.width,height:t.height,marginLeft:t.marginLeft,marginTop:t.marginTop}))),c.Table?.size>0&&(t.tables=cz(c.Table.toJSON()));const f=$z(c.AutoFilter);f.length>0&&(t.autoFilters=f);const p=Sz(c);p.length>0&&(t.cfRules=p),c.PivotTable?.size>0&&(t.pivotTables=c.PivotTable.getAll().map(t=>({name:t.name,cacheId:t.cacheId,xml:t.toXml()?.pivotTableDefinition||null})).filter(t=>!!t.xml)),c.Slicer?.size>0&&(t.slicers=c.Slicer.getAll().map(t=>Tz(t))),l.sheets.push(t)}return l.styleTable.fonts=e.getAll(),l.styleTable.fills=n.getAll(),l.styleTable.borders=i.getAll(),l.styleTable.aligns=r.getAll(),l.styleTable.styles=o.getAll(),l.sizeTable.rowHeights=a.getAll(),l.sizeTable.colWidths=s.getAll(),t.Mr?.size>0&&(l.pivotCaches=Array.from(t.Mr.values()).map(t=>function(t){return{cacheId:t.cacheId,sourceType:t.sourceType,sourceRef:t.sourceRef,sourceSheet:t.sourceSheet,sourceRange:cz(t.sourceRange),fields:yz(t.fields||[]),records:yz(t.records||[]),recordCount:Number(t.recordCount||0),refreshedBy:t.refreshedBy||"",refreshedDate:t.refreshedDate??null,createdVersion:Number(t.createdVersion||7),refreshedVersion:Number(t.refreshedVersion||8),refreshOnLoad:!!t.refreshOnLoad}}(t))),t.zi?.size>0&&(l.slicerCaches=Array.from(t.zi.values()).map(t=>function(t){const e=Array.isArray(t.items)?t.items:[];return{cacheId:t.cacheId,sourceType:t.sourceType,sourceSheet:t.sourceSheet,sourceName:t.sourceName,sourceId:t.sourceId??null,fieldIndex:t.fieldIndex,fieldName:t.fieldName,items:yz(e)}}(t))),l}function Az(t){const e=this.$;try{if(!t||"2.0"!==t.version||!Array.isArray(t.sheets)||0===t.sheets.length)return e.Utils.toast(e.t("core.iO.jsonIO.toast.son")),!1;const n={fonts:Array.isArray(t.styleTable?.fonts)?t.styleTable.fonts:[],fills:Array.isArray(t.styleTable?.fills)?t.styleTable.fills:[],borders:Array.isArray(t.styleTable?.borders)?t.styleTable.borders:[],aligns:Array.isArray(t.styleTable?.aligns)?t.styleTable.aligns:[],styles:Array.isArray(t.styleTable?.styles)?t.styleTable.styles:[]},i={rowHeights:Array.isArray(t.sizeTable?.rowHeights)?t.sizeTable.rowHeights:[],colWidths:Array.isArray(t.sizeTable?.colWidths)?t.sizeTable.colWidths:[]};if("string"==typeof t.workbookName&&t.workbookName.trim()){e.lx=t.workbookName.trim();const n=e.containerDom?.querySelector?.(".sn-file-name");n&&(n.textContent=e.lx)}e.calcMode="manual"===t.calcMode?"manual":"auto",e.readOnly=!!t.readOnly,e.properties=lz(t.properties)?cz(t.properties):{},e.yn=lz(t.definedNames)?cz(t.definedNames):{},e.et={},e.Mr=new Map,e.zi=new Map,e.so=[],e.oo=new Map,e.sheets=[];const r=[],o=[],a=[];t.sheets.forEach((t,s)=>{const l=`Sheet${s+1}`,c="string"==typeof t?.name&&t.name.trim()?t.name.trim():l;let h=e.addSheet(c);if(h||c===l||(h=e.addSheet(l)),!h)return;!function(t){t.rows=[],t.cols=[],t.merges=[],t.vi={rowArr:[0],colArr:[0]},t.views=[{pane:{}}],t.po=[],t.mo={keep:!1,area:null},t.bt=new Set,t.yt=new Set,t.Rt=0,t.Ft=void 0,t.Ct=void 0,t.wn=0,t.protection=new St(t),t.Comment=new T(t),t.AutoFilter=new N(t),t.Table=new et(t),t.Drawing=new Ce(t),t.Sparkline=new Me(t),t.CF=new Ze(t),t.Slicer=new pn(t),t.PivotTable=new In(t)}(h),h.St=!!t.hidden,h.showGridLines=!1!==t.showGridLines,h.showRowColHeaders=!1!==t.showRowColHeaders,h.showPageBreaks=!!t.showPageBreaks,h.outlinePr={applyStyles:!1,summaryBelow:!0,summaryRight:!0,showOutlineSymbols:!0,...t.outlinePr||{}};const u=uz(t.defaultColWidth,null);u&&u>0&&(h.defaultColWidth=Math.round(u));const d=uz(t.defaultRowHeight,null);d&&d>0&&(h.defaultRowHeight=Math.round(d)),h.io=Math.max(0,hz(t.frozenCols,0)),h.ro=Math.max(0,hz(t.frozenRows,0)),h.yo=Math.max(0,hz(t.freezeStartRow,0)),h.wo=Math.max(0,hz(t.freezeStartCol,0)),h.no=pz(t.zoom);const f=dz(t.activeCell,{r:0,c:0}),p=dz(t.viewStart,{r:0,c:0});h.co=f,h.vi={rowArr:[p.r],colArr:[p.c]},t.printSettings?h.printSettings=cz(t.printSettings):h.printSettings=e.Print?.createDefaultSettings?.()||null;const{rowCount:m,colCount:g}=function(t){let e=Math.max(hz(t?.rowCount,200),1),n=Math.max(hz(t?.colCount,32),1);(Array.isArray(t?.rows)?t.rows:[]).forEach(t=>{const i=Math.max(0,hz(t?.rIndex,0));e=Math.max(e,i+1),Array.isArray(t?.cells)&&t.cells.forEach(t=>{const e=Math.max(0,hz(t?.c,0)),i=Math.max(e,hz(t?.e,e));n=Math.max(n,i+1)})}),(Array.isArray(t?.cols)?t.cols:[]).forEach(t=>{const e=Math.max(0,hz(t?.cIndex,0));n=Math.max(n,e+1)}),(Array.isArray(t?.merges)?t.merges:[]).forEach(t=>{const i=fz(t);i&&(e=Math.max(e,i.e.r+1),n=Math.max(n,i.e.c+1))});const i=dz(t?.activeCell,{r:0,c:0}),r=dz(t?.viewStart,{r:0,c:0});return e=Math.max(e,i.r+1,r.r+1),n=Math.max(n,i.c+1,r.c+1),e=Math.max(e,hz(t?.frozenRows,0)),n=Math.max(n,hz(t?.frozenCols,0)),e=Math.max(e,hz(t?.freezeStartRow,0)+1),n=Math.max(n,hz(t?.freezeStartCol,0)+1),{rowCount:e,colCount:n}}(t);!function(t,e,n){const i=Math.max(1,e),r=Math.max(1,n);t.getRow(i-1),t.getCol(r-1)}(h,m,g),Array.isArray(t.cols)&&t.cols.forEach(t=>{const e=Math.max(0,hz(t?.cIndex,0)),r=h.getCol(e),o=uz(void 0!==t?.w?i.colWidths[t.w]:void 0,null);o&&o>0&&(r.Nt=Math.round(o)),void 0!==t?.hidden&&(r.St=!!t.hidden),void 0!==t?.ol&&(r.kt=Math.max(0,hz(t.ol,0))),void 0!==t?.cl&&(r.Tt=!!t.cl),void 0!==t?.s&&n.styles[t.s]&&(r.xt=cz(n.styles[t.s]))}),Array.isArray(t.rows)&&t.rows.forEach(t=>{const e=Math.max(0,hz(t?.rIndex,0)),r=h.getRow(e),o=uz(void 0!==t?.h?i.rowHeights[t.h]:void 0,null);o&&o>0&&(r.Mt=Math.round(o)),void 0!==t?.hidden&&(r.St=!!t.hidden),void 0!==t?.ol&&(r.kt=Math.max(0,hz(t.ol,0))),void 0!==t?.cl&&(r.Tt=!!t.cl),void 0!==t?.s&&n.styles[t.s]&&(r.wt=cz(n.styles[t.s])),Array.isArray(t?.cells)&&t.cells.forEach(t=>{const i=Math.max(0,hz(t?.c,0)),r=Math.max(i,hz(t?.e,i)),o=function(t,e){const n=function(t){if("string"!=typeof t)return null;const e=t.trim();return e?e.startsWith("=")?e:`=${e}`:null}(t?.f);return{hasFormula:!!n,formula:n,hasValue:Object.prototype.hasOwnProperty.call(t||{},"v")||Object.prototype.hasOwnProperty.call(t||{},"vt"),value:gz(t?.v,t?.vt),valueType:t?.vt??null,calcValue:gz(t?.cv,t?.cvt),calcType:t?.cvt??null,style:xz(t,e),link:t?.link?{target:t.link.t??null,location:t.link.l??null,tooltip:t.link.tt??null}:null,dataValidation:t?.dv?cz(t.dv):null,richText:Array.isArray(t?.rt)?cz(t.rt):null}}(t,n);for(let n=i;n<=r;n++)wz(h.getCell(e,n),o)})}),h.merges=[],Array.isArray(t.merges)&&t.merges.forEach(t=>{const e=fz(t);e&&(h.merges.push(e),h.eachCells(e,(t,n)=>{const i=h.getCell(t,n);i.isMerged=!0,i.master={r:e.s.r,c:e.s.c}}))}),Array.isArray(t.drawings)&&t.drawings.forEach(t=>function(t,e){if(!e?.type)return;if("slicer"===e.type)return;const n="connector"===e.type?"shape":e.type,i={type:n,startCell:dz(e.startCell,{r:0,c:0}),offsetX:uz(e.offsetX,0)??0,offsetY:uz(e.offsetY,0)??0,width:uz(e.width,null),height:uz(e.height,null),anchorType:e.anchorType||"twoCell",rotation:uz(e.rotation,0)??0};"chart"===n?i.chartOption=cz(e.chartOption):"image"===n?i.imageBase64=e.imageBase64:"shape"===n&&(i.shapeType=e.shapeType,i.shapeStyle=cz(e.shapeStyle),i.shapeText=e.shapeText,i.isTextBox=!!e.isTextBox);const r=t.Drawing.Wn(i);r&&"twoCell"===r.anchorType&&e.endCell&&(r._n=dz(e.endCell,r.startCell),r.En=uz(e.endOffsetX,0)??0,r.In=uz(e.endOffsetY,0)??0,r.Sn=null)}(h,t)),Array.isArray(t.sparklines)&&h.Sparkline&&(h.Sparkline.groups=[],h.Sparkline.map=new Map,t.sparklines.forEach(t=>{const e={id:h.Sparkline.groups.length,type:t.type||"line",displayEmptyCellsAs:t.displayEmptyCellsAs||"gap",colors:t.colors||{series:"#376092",negative:"#D00000",axis:"#000000",markers:"#D00000",first:"#D00000",last:"#D00000",high:"#D00000",low:"#D00000"},lineWeight:t.lineWeight??.75,manualMax:t.manualMax??null,manualMin:t.manualMin??null,dateAxis:t.dateAxis??!1,markers:t.markers??!1,high:t.high??!1,low:t.low??!1,first:t.first??!1,last:t.last??!1,negative:t.negative??!1};h.Sparkline.groups.push(e),(Array.isArray(t.instances)?t.instances:[]).forEach(t=>{const n=Math.max(0,hz(t?.r,0)),i=Math.max(0,hz(t?.c,0)),r=`${n}:${i}`,o={key:r,r:n,c:i,sqref:h.SN.Utils.cellNumToStr({r:n,c:i}),formula:t?.formula||"",group:e,ti:null,ei:null};h.Sparkline.map.set(r,o)})})),Array.isArray(t.comments)&&h.Comment&&t.comments.forEach(t=>{t?.cellRef&&h.Comment.add({cellRef:t.cellRef,author:t.author,text:t.text,visible:!!t.visible,width:uz(t.width,144)??144,height:uz(t.height,72)??72,marginLeft:uz(t.marginLeft,107)??107,marginTop:uz(t.marginTop,7)??7})}),Array.isArray(t.tables)&&h.Table&&h.Table.fromJSON(cz(t.tables)),Array.isArray(t.cfRules)&&h.CF&&function(t,e){t.CF&&(t.CF.rules=[],t.CF.clearAllCache(),Array.isArray(e)&&e.forEach(e=>{if(!e)return;const n=cz(e),i=n.sqref;i&&t.CF.add({...n,rangeRef:i})}))}(h,t.cfRules),t.sheetProtection&&h.protection.enable(cz(t.sheetProtection)),Array.isArray(t.autoFilters)&&r.push({sheet:h,scopes:cz(t.autoFilters)}),Array.isArray(t.pivotTables)&&o.push({sheet:h,pivotTables:cz(t.pivotTables)}),Array.isArray(t.slicers)&&a.push({sheet:h,slicers:cz(t.slicers)})}),function(t,e){t.Mr=new Map,Array.isArray(e)&&e.forEach(e=>{if(!e)return;const n=hz(e.cacheId,null),i=new Mn(t,{cacheId:n??e.cacheId,sourceType:e.sourceType||"worksheet",sourceRef:e.sourceRef??null,sourceSheet:e.sourceSheet??null,sourceRange:cz(e.sourceRange),refreshedBy:e.refreshedBy||"",refreshedDate:e.refreshedDate??null,createdVersion:hz(e.createdVersion,7),refreshedVersion:hz(e.refreshedVersion,8),refreshOnLoad:!!e.refreshOnLoad});i.fields=bz(e.fields||[]),i.records=bz(e.records||[]),i.recordCount=hz(e.recordCount,i.records.length),"function"==typeof i.Rr&&i.Rr(),t.Mr.set(i.cacheId,i)})}(e,t.pivotCaches),function(t,e){t.zi=new Map,Array.isArray(e)&&e.forEach(e=>{if(!e)return;const n=hz(e.cacheId,null),i=new nn(t,{cacheId:n??e.cacheId,sourceType:e.sourceType||"table",sourceSheet:e.sourceSheet??null,sourceName:e.sourceName??null,sourceId:e.sourceId??null,fieldIndex:hz(e.fieldIndex,0),fieldName:e.fieldName||""}),r=bz(e.items||[]);Array.isArray(r)&&r.length>0?(i.items=r,i._i=new Map(r.map(t=>[t.key,t])),i.Ii=!1,i.Ei=1):(i.items=[],i._i=new Map,i.Ii=!0),t.zi.set(i.cacheId,i)})}(e,t.slicerCaches),function(t,e){e.forEach(({sheet:e,pivotTables:n})=>{Array.isArray(n)&&e.PivotTable&&n.forEach(n=>{const i=n?.xml;if(!i)return;const r=hz(n.cacheId,null),o=t.Mr?.get(r??n.cacheId)||t.Mr?.get(n.cacheId);if(!o)return;const a=_n.fromXml(e,i,o);a.Wr=o,e.PivotTable.yr(a)})})}(e,o),function(t){t.forEach(({sheet:t,scopes:e})=>{Array.isArray(e)&&0!==e.length&&e.forEach(e=>{const n=e?.xml;if(!n)return;const i=e.scopeId??null,r=fz(e.range);t.AutoFilter.parseScope(i,n,{range:r,ownerType:e.ownerType,ownerId:e.ownerId,restoreHiddenRowsFromSheet:!1}),t.AutoFilter.hasActiveFiltersInScope(i)&&t.AutoFilter.he(i,{silent:!0,emitEvents:!1,recordChange:!1,recalculate:!1})})})}(r),function(t,e){e.forEach(({sheet:e,slicers:n})=>{Array.isArray(n)&&0!==n.length&&n.forEach(n=>{if(!n)return;const i=hz(n.cacheId,null)??n.cacheId??null;if(null!==i&&!t.zi.has(i)){const r=new nn(t,{cacheId:i,sourceType:n.sourceType||"table",sourceSheet:n.sourceSheet||e.name,sourceName:n.sourceName??null,sourceId:n.sourceId??null,fieldIndex:hz(n.fieldIndex,0),fieldName:n.fieldName||""});t.zi.set(r.cacheId,r)}const r=n.drawing||{},o=e.Drawing.Wn({type:"slicer",startCell:dz(r.startCell,{r:0,c:0}),offsetX:uz(r.offsetX,0)??0,offsetY:uz(r.offsetY,0)??0,width:uz(r.width,180)??180,height:uz(r.height,220)??220,anchorType:r.anchorType||"oneCell",rotation:uz(r.rotation,0)??0});o&&"twoCell"===o.anchorType&&r.endCell&&(o._n=dz(r.endCell,o.startCell),o.En=uz(r.endOffsetX,0)??0,o.In=uz(r.endOffsetY,0)??0,o.Sn=null);const a=new hn(e,{...cz(n),cacheId:i,selectedKeys:Array.isArray(n.selectedKeys)?n.selectedKeys:[],drawing:o});void 0!==n.sourceId&&(a.sourceId=n.sourceId),e.Slicer.yr(a),a.selectedKeys?.size>0&&a.applyFilter()})})}(e,a),e.sheets.forEach(t=>{t?.PivotTable&&0!==t.PivotTable.size&&t.PivotTable.getAll().forEach(t=>{0===t.rowFields.length&&0===t.colFields.length&&0===t.dataFields.length&&0===t.pageFields.length||(t.cs=!0,t.calculate(),t.render({silent:!0}))})});const s=("string"==typeof t.activeSheet?e.getSheet(t.activeSheet):null)||e.sheets.find(t=>!t.hidden)||e.sheets[0]||null;return!!s&&(e.activeSheet=s,s.To&&s.To(),e.DependencyGraph&&(e.DependencyGraph.clear(),e.DependencyGraph.rebuildAll(),"manual"!==e.calcMode&&e.DependencyGraph.recalculateVolatile()),e.UndoRedo?.clear?.(),!0)}catch(t){return e.Utils.toast(e.t("core.iO.jsonIO.toast.loadFailed",{message:t.message})),!1}}var Nz,kz={};function Rz(){if(Nz)return kz;Nz=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return kz.encode=function(e,n){for(var i,r,o,a,s,l,c,h="",u=0;u<e.length;)a=(i=e.charCodeAt(u++))>>2,s=(3&i)<<4|(r=e.charCodeAt(u++))>>4,l=(15&r)<<2|(o=e.charCodeAt(u++))>>6,c=63&o,isNaN(r)?l=c=64:isNaN(o)&&(c=64),h=h+t.charAt(a)+t.charAt(s)+t.charAt(l)+t.charAt(c);return h},kz.decode=function(e,n){var i,r,o,a,s,l,c="",h=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)i=t.indexOf(e.charAt(h++))<<2|(a=t.indexOf(e.charAt(h++)))>>4,r=(15&a)<<4|(s=t.indexOf(e.charAt(h++)))>>2,o=(3&s)<<6|(l=t.indexOf(e.charAt(h++))),c+=String.fromCharCode(i),64!=s&&(c+=String.fromCharCode(r)),64!=l&&(c+=String.fromCharCode(o));return c},kz}var _z,Iz={};function Fz(){if(_z)return Iz;if(_z=1,Iz.base64=!0,Iz.array=!0,Iz.string=!0,Iz.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,Iz.nodebuffer="undefined"!=typeof Buffer,Iz.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)Iz.blob=!1;else{var t=new ArrayBuffer(0);try{Iz.blob=0===new Blob([t],{type:"application/zip"}).size}catch(n){try{var e=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);e.append(t),Iz.blob=0===e.getBlob("application/zip").size}catch(t){Iz.blob=!1}}}return Iz}var Ez,Dz={},Lz={},Pz={},zz={};function Oz(){return Ez||(Ez=1,function(t){var e="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)n(i,r)&&(t[r]=i[r])}}return t},t.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),r);else for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){var e,n,i,r,o,a;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(a=new Uint8Array(i),r=0,e=0,n=t.length;e<n;e++)o=t[e],a.set(o,r),r+=o.length;return a}},r={arraySet:function(t,e,n,i,r){for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))},t.setTyped(e)}(zz)),zz}var Bz,Vz,Hz,Uz,qz,Kz,Wz,jz,Gz={},Xz={},Yz={};function Zz(){return Hz||(Hz=1,Vz=function(t,e,n,i){for(var r=65535&t,o=t>>>16&65535,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(r=r+e[i++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16}),Vz}function Jz(){if(qz)return Uz;qz=1;var t=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();return Uz=function(e,n,i,r){var o=t,a=r+i;e^=-1;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^n[s])];return-1^e},Uz}function Qz(){return Wz?Kz:(Wz=1,Kz={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}var tO,eO,nO,iO,rO={};function oO(){if(tO)return rO;tO=1;var t=Oz(),e=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(t){e=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){n=!1}for(var i=new t.Buf8(256),r=0;r<256;r++)i[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;function o(i,r){if(r<65534&&(i.subarray&&n||!i.subarray&&e))return String.fromCharCode.apply(null,t.shrinkBuf(i,r));for(var o="",a=0;a<r;a++)o+=String.fromCharCode(i[a]);return o}return i[254]=i[254]=1,rO.string2buf=function(e){var n,i,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(n=new t.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),i<128?n[a++]=i:i<2048?(n[a++]=192|i>>>6,n[a++]=128|63&i):i<65536?(n[a++]=224|i>>>12,n[a++]=128|i>>>6&63,n[a++]=128|63&i):(n[a++]=240|i>>>18,n[a++]=128|i>>>12&63,n[a++]=128|i>>>6&63,n[a++]=128|63&i);return n},rO.buf2binstring=function(t){return o(t,t.length)},rO.binstring2buf=function(e){for(var n=new t.Buf8(e.length),i=0,r=n.length;i<r;i++)n[i]=e.charCodeAt(i);return n},rO.buf2string=function(t,e){var n,r,a,s,l=e||t.length,c=new Array(2*l);for(r=0,n=0;n<l;)if((a=t[n++])<128)c[r++]=a;else if((s=i[a])>4)c[r++]=65533,n+=s-1;else{for(a&=2===s?31:3===s?15:7;s>1&&n<l;)a=a<<6|63&t[n++],s--;s>1?c[r++]=65533:a<65536?c[r++]=a:(a-=65536,c[r++]=55296|a>>10&1023,c[r++]=56320|1023&a)}return o(c,r)},rO.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+i[t[n]]>e?n:e},rO}function aO(){return nO?eO:(nO=1,eO=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0})}var sO,lO,cO,hO,uO,dO,fO,pO,mO,gO,vO,yO,bO,xO,wO={},SO={};function CO(){return fO?dO:(fO=1,dO={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function TO(){return xO||(xO=1,Lz.STORE={magic:"\0\0",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},Lz.DEFLATE=function(){if(bO)return Pz;bO=1;var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,e=function(){if(yO)return vO;yO=1;var t=Oz().assign,e=function(){if(iO)return Gz;iO=1;var t=function(){if(jz)return Xz;jz=1;var t,e=Oz(),n=function(){if(Bz)return Yz;Bz=1;var t=Oz();function e(t){for(var e=t.length;--e>=0;)t[e]=0}var n=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],i=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],o=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],a=new Array(576);e(a);var s=new Array(60);e(s);var l=new Array(512);e(l);var c=new Array(256);e(c);var h=new Array(29);e(h);var u,d,f,p=new Array(30);function m(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function g(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function v(t){return t<256?l[t]:l[256+(t>>>7)]}function y(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function b(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,y(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function x(t,e,n){b(t,n[2*e],n[2*e+1])}function w(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function S(t,e,n){var i,r,o=new Array(16),a=0;for(i=1;i<=15;i++)o[i]=a=a+n[i-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=w(o[s]++,s))}}function C(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function T(t){t.bi_valid>8?y(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function $(t,e,n,i){var r=2*e,o=2*n;return t[r]<t[o]||t[r]===t[o]&&i[e]<=i[n]}function M(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&$(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!$(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function A(t,e,r){var o,a,s,l,u=0;if(0!==t.last_lit)do{o=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],a=t.pending_buf[t.l_buf+u],u++,0===o?x(t,a,e):(x(t,(s=c[a])+256+1,e),0!==(l=n[s])&&b(t,a-=h[s],l),x(t,s=v(--o),r),0!==(l=i[s])&&b(t,o-=p[s],l))}while(u<t.last_lit);x(t,256,e)}function N(t,e){var n,i,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<l;n++)0!==o[2*n]?(t.heap[++t.heap_len]=c=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=c,n=t.heap_len>>1;n>=1;n--)M(t,o,n);r=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],M(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,o[2*r]=o[2*n]+o[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,o[2*n+1]=o[2*i+1]=r,t.heap[1]=r++,M(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,r,o,a,s,l=e.dyn_tree,c=e.max_code,h=e.stat_desc.static_tree,u=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(o=0;o<=15;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(o=l[2*l[2*(i=t.heap[n])+1]+1]+1)>p&&(o=p,m++),l[2*i+1]=o,i>c||(t.bl_count[o]++,a=0,i>=f&&(a=d[i-f]),s=l[2*i],t.opt_len+=s*(o+a),u&&(t.static_len+=s*(h[2*i+1]+a)));if(0!==m){do{for(o=p-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(i=t.bl_count[o];0!==i;)(r=t.heap[--n])>c||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),i--)}}(t,e),S(o,c,t.bl_count)}function k(t,e,n){var i,r,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=e[2*(i+1)+1],++s<l&&r===a||(s<c?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))}function R(t,e,n){var i,r,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),i=0;i<=n;i++)if(r=a,a=e[2*(i+1)+1],!(++s<l&&r===a)){if(s<c)do{x(t,r,t.bl_tree)}while(0!==--s);else 0!==r?(r!==o&&(x(t,r,t.bl_tree),s--),x(t,16,t.bl_tree),b(t,s-3,2)):s<=10?(x(t,17,t.bl_tree),b(t,s-3,3)):(x(t,18,t.bl_tree),b(t,s-11,7));s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}}e(p);var _=!1;function I(e,n,i,r){b(e,0+(r?1:0),3),function(e,n,i){T(e),y(e,i),y(e,~i),t.arraySet(e.pending_buf,e.window,n,i,e.pending),e.pending+=i}(e,n,i)}return Yz.hx=function(t){_||(function(){var t,e,o,g,v,y=new Array(16);for(o=0,g=0;g<28;g++)for(h[g]=o,t=0;t<1<<n[g];t++)c[o++]=g;for(c[o-1]=g,v=0,g=0;g<16;g++)for(p[g]=v,t=0;t<1<<i[g];t++)l[v++]=g;for(v>>=7;g<30;g++)for(p[g]=v<<7,t=0;t<1<<i[g]-7;t++)l[256+v++]=g;for(e=0;e<=15;e++)y[e]=0;for(t=0;t<=143;)a[2*t+1]=8,t++,y[8]++;for(;t<=255;)a[2*t+1]=9,t++,y[9]++;for(;t<=279;)a[2*t+1]=7,t++,y[7]++;for(;t<=287;)a[2*t+1]=8,t++,y[8]++;for(S(a,287,y),t=0;t<30;t++)s[2*t+1]=5,s[2*t]=w(t,5);u=new m(a,n,257,286,15),d=new m(s,i,0,30,15),f=new m(new Array(0),r,0,19,7)}(),_=!0),t.l_desc=new g(t.dyn_ltree,u),t.d_desc=new g(t.dyn_dtree,d),t.bl_desc=new g(t.bl_tree,f),t.bi_buf=0,t.bi_valid=0,C(t)},Yz.ux=I,Yz.mx=function(t,e,n,i){var r,l,c=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),N(t,t.l_desc),N(t,t.d_desc),c=function(t){var e;for(k(t,t.dyn_ltree,t.l_desc.max_code),k(t,t.dyn_dtree,t.d_desc.max_code),N(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*o[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(l=t.static_len+3+7>>>3)<=r&&(r=l)):r=l=n+5,n+4<=r&&-1!==e?I(t,e,n,i):4===t.strategy||l===r?(b(t,2+(i?1:0),3),A(t,a,s)):(b(t,4+(i?1:0),3),function(t,e,n,i){var r;for(b(t,e-257,5),b(t,n-1,5),b(t,i-4,4),r=0;r<i;r++)b(t,t.bl_tree[2*o[r]+1],3);R(t,t.dyn_ltree,e-1),R(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),A(t,t.dyn_ltree,t.dyn_dtree)),C(t),i&&T(t)},Yz.vx=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(c[n]+256+1)]++,t.dyn_dtree[2*v(e)]++),t.last_lit===t.lit_bufsize-1},Yz.bx=function(t){b(t,2,3),x(t,256,a),function(t){16===t.bi_valid?(y(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)},Yz}(),i=Zz(),r=Jz(),o=Qz(),a=-2,s=258,l=262,c=103,h=113,u=666;function d(t,e){return t.msg=o[e],e}function f(t){return(t<<1)-(t>4?9:0)}function p(t){for(var e=t.length;--e>=0;)t[e]=0}function m(t){var n=t.state,i=n.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(e.arraySet(t.output,n.pending_buf,n.pending_out,i,t.next_out),t.next_out+=i,n.pending_out+=i,t.total_out+=i,t.avail_out-=i,n.pending-=i,0===n.pending&&(n.pending_out=0))}function g(t,e){n.mx(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,m(t.strm)}function v(t,e){t.pending_buf[t.pending++]=e}function y(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function b(t,n,o,a){var s=t.avail_in;return s>a&&(s=a),0===s?0:(t.avail_in-=s,e.arraySet(n,t.input,t.next_in,s,o),1===t.state.wrap?t.adler=i(t.adler,n,s,o):2===t.state.wrap&&(t.adler=r(t.adler,n,s,o)),t.next_in+=s,t.total_in+=s,s)}function x(t,e){var n,i,r=t.max_chain_length,o=t.strstart,a=t.prev_length,c=t.nice_match,h=t.strstart>t.w_size-l?t.strstart-(t.w_size-l):0,u=t.window,d=t.w_mask,f=t.prev,p=t.strstart+s,m=u[o+a-1],g=u[o+a];t.prev_length>=t.good_match&&(r>>=2),c>t.lookahead&&(c=t.lookahead);do{if(u[(n=e)+a]===g&&u[n+a-1]===m&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<p);if(i=s-(p-o),o=p-s,i>a){if(t.match_start=e,a=i,i>=c)break;m=u[o+a-1],g=u[o+a]}}}while((e=f[e&d])>h&&0!==--r);return a<=t.lookahead?a:t.lookahead}function w(t){var n,i,r,o,a,s=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-l)){e.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,n=i=t.hash_size;do{r=t.head[--n],t.head[n]=r>=s?r-s:0}while(--i);n=i=s;do{r=t.prev[--n],t.prev[n]=r>=s?r-s:0}while(--i);o+=s}if(0===t.strm.avail_in)break;if(i=b(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=i,t.lookahead+t.insert>=3)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+3-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<l&&0!==t.strm.avail_in)}function S(t,e){for(var i,r;;){if(t.lookahead<l){if(w(t),t.lookahead<l&&0===e)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-l&&(t.match_length=x(t,i)),t.match_length>=3)if(r=n.vx(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=n.vx(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}function C(t,e){for(var i,r,o;;){if(t.lookahead<l){if(w(t),t.lookahead<l&&0===e)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-l&&(t.match_length=x(t,i),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){o=t.strstart+t.lookahead-3,r=n.vx(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=o&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(g(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=n.vx(t,0,t.window[t.strstart-1]))&&g(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=n.vx(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}function T(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}function $(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(1146),this.dyn_dtree=new e.Buf16(122),this.bl_tree=new e.Buf16(78),p(this.dyn_ltree),p(this.dyn_dtree),p(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(16),this.heap=new e.Buf16(573),p(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(573),p(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function M(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:h,t.adler=2===e.wrap?0:1,e.last_flush=0,n.hx(e),0):d(t,a)}function A(e){var n,i=M(e);return 0===i&&((n=e.state).window_size=2*n.w_size,p(n.head),n.max_lazy_match=t[n.level].max_lazy,n.good_match=t[n.level].good_length,n.nice_match=t[n.level].nice_length,n.max_chain_length=t[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),i}function N(t,n,i,r,o,s){if(!t)return a;var l=1;if(-1===n&&(n=6),r<0?(l=0,r=-r):r>15&&(l=2,r-=16),o<1||o>9||8!==i||r<8||r>15||n<0||n>9||s<0||s>4)return d(t,a);8===r&&(r=9);var c=new $;return t.state=c,c.strm=t,c.wrap=l,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=o+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new e.Buf8(2*c.w_size),c.head=new e.Buf16(c.hash_size),c.prev=new e.Buf16(c.w_size),c.lit_bufsize=1<<o+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new e.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=n,c.strategy=s,c.method=i,A(t)}return t=[new T(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(w(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,g(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-l&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(g(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(g(t,!1),t.strm.avail_out),1)}),new T(4,4,8,4,S),new T(4,5,16,8,S),new T(4,6,32,32,S),new T(4,4,16,16,C),new T(8,16,32,32,C),new T(8,16,128,128,C),new T(8,32,128,256,C),new T(32,128,258,1024,C),new T(32,258,258,4096,C)],Xz.deflateInit=function(t,e){return N(t,e,8,15,8,0)},Xz.deflateInit2=N,Xz.deflateReset=A,Xz.deflateResetKeep=M,Xz.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?a:(t.state.gzhead=e,0):a},Xz.deflate=function(e,i){var o,l,b,x;if(!e||!e.state||i>5||i<0)return e?d(e,a):a;if(l=e.state,!e.output||!e.input&&0!==e.avail_in||l.status===u&&4!==i)return d(e,0===e.avail_out?-5:a);if(l.strm=e,o=l.last_flush,l.last_flush=i,42===l.status)if(2===l.wrap)e.adler=0,v(l,31),v(l,139),v(l,8),l.gzhead?(v(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),v(l,255&l.gzhead.time),v(l,l.gzhead.time>>8&255),v(l,l.gzhead.time>>16&255),v(l,l.gzhead.time>>24&255),v(l,9===l.level?2:l.strategy>=2||l.level<2?4:0),v(l,255&l.gzhead.os),l.gzhead.extra&&l.gzhead.extra.length&&(v(l,255&l.gzhead.extra.length),v(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(e.adler=r(e.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=69):(v(l,0),v(l,0),v(l,0),v(l,0),v(l,0),v(l,9===l.level?2:l.strategy>=2||l.level<2?4:0),v(l,3),l.status=h);else{var S=8+(l.w_bits-8<<4)<<8;S|=(l.strategy>=2||l.level<2?0:l.level<6?1:6===l.level?2:3)<<6,0!==l.strstart&&(S|=32),S+=31-S%31,l.status=h,y(l,S),0!==l.strstart&&(y(l,e.adler>>>16),y(l,65535&e.adler)),e.adler=1}if(69===l.status)if(l.gzhead.extra){for(b=l.pending;l.gzindex<(65535&l.gzhead.extra.length)&&(l.pending!==l.pending_buf_size||(l.gzhead.hcrc&&l.pending>b&&(e.adler=r(e.adler,l.pending_buf,l.pending-b,b)),m(e),b=l.pending,l.pending!==l.pending_buf_size));)v(l,255&l.gzhead.extra[l.gzindex]),l.gzindex++;l.gzhead.hcrc&&l.pending>b&&(e.adler=r(e.adler,l.pending_buf,l.pending-b,b)),l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=73)}else l.status=73;if(73===l.status)if(l.gzhead.name){b=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>b&&(e.adler=r(e.adler,l.pending_buf,l.pending-b,b)),m(e),b=l.pending,l.pending===l.pending_buf_size)){x=1;break}x=l.gzindex<l.gzhead.name.length?255&l.gzhead.name.charCodeAt(l.gzindex++):0,v(l,x)}while(0!==x);l.gzhead.hcrc&&l.pending>b&&(e.adler=r(e.adler,l.pending_buf,l.pending-b,b)),0===x&&(l.gzindex=0,l.status=91)}else l.status=91;if(91===l.status)if(l.gzhead.comment){b=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>b&&(e.adler=r(e.adler,l.pending_buf,l.pending-b,b)),m(e),b=l.pending,l.pending===l.pending_buf_size)){x=1;break}x=l.gzindex<l.gzhead.comment.length?255&l.gzhead.comment.charCodeAt(l.gzindex++):0,v(l,x)}while(0!==x);l.gzhead.hcrc&&l.pending>b&&(e.adler=r(e.adler,l.pending_buf,l.pending-b,b)),0===x&&(l.status=c)}else l.status=c;if(l.status===c&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&m(e),l.pending+2<=l.pending_buf_size&&(v(l,255&e.adler),v(l,e.adler>>8&255),e.adler=0,l.status=h)):l.status=h),0!==l.pending){if(m(e),0===e.avail_out)return l.last_flush=-1,0}else if(0===e.avail_in&&f(i)<=f(o)&&4!==i)return d(e,-5);if(l.status===u&&0!==e.avail_in)return d(e,-5);if(0!==e.avail_in||0!==l.lookahead||0!==i&&l.status!==u){var C=2===l.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(w(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,i=n.vx(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}(l,i):3===l.strategy?function(t,e){for(var i,r,o,a,l=t.window;;){if(t.lookahead<=s){if(w(t),t.lookahead<=s&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=l[o=t.strstart-1])===l[++o]&&r===l[++o]&&r===l[++o]){a=t.strstart+s;do{}while(r===l[++o]&&r===l[++o]&&r===l[++o]&&r===l[++o]&&r===l[++o]&&r===l[++o]&&r===l[++o]&&r===l[++o]&&o<a);t.match_length=s-(a-o),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=n.vx(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=n.vx(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}(l,i):t[l.level].func(l,i);if(3!==C&&4!==C||(l.status=u),1===C||3===C)return 0===e.avail_out&&(l.last_flush=-1),0;if(2===C&&(1===i?n.bx(l):5!==i&&(n.ux(l,0,0,!1),3===i&&(p(l.head),0===l.lookahead&&(l.strstart=0,l.block_start=0,l.insert=0))),m(e),0===e.avail_out))return l.last_flush=-1,0}return 4!==i?0:l.wrap<=0?1:(2===l.wrap?(v(l,255&e.adler),v(l,e.adler>>8&255),v(l,e.adler>>16&255),v(l,e.adler>>24&255),v(l,255&e.total_in),v(l,e.total_in>>8&255),v(l,e.total_in>>16&255),v(l,e.total_in>>24&255)):(y(l,e.adler>>>16),y(l,65535&e.adler)),m(e),l.wrap>0&&(l.wrap=-l.wrap),0!==l.pending?0:1)},Xz.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&e!==c&&e!==h&&e!==u?d(t,a):(t.state=null,e===h?d(t,-3):0):a},Xz.deflateSetDictionary=function(t,n){var r,o,s,l,c,h,u,d,f=n.length;if(!t||!t.state)return a;if(2===(l=(r=t.state).wrap)||1===l&&42!==r.status||r.lookahead)return a;for(1===l&&(t.adler=i(t.adler,n,f,0)),r.wrap=0,f>=r.w_size&&(0===l&&(p(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new e.Buf8(r.w_size),e.arraySet(d,n,f-r.w_size,r.w_size,0),n=d,f=r.w_size),c=t.avail_in,h=t.next_in,u=t.input,t.avail_in=f,t.next_in=0,t.input=n,w(r);r.lookahead>=3;){o=r.strstart,s=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+3-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++}while(--s);r.strstart=o,r.lookahead=2,w(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=h,t.input=u,t.avail_in=c,r.wrap=l,0},Xz.deflateInfo="pako deflate (from Nodeca project)",Xz}(),e=Oz(),n=oO(),i=Qz(),r=aO(),o=Object.prototype.toString;function a(s){if(!(this instanceof a))return new a(s);this.options=e.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},s||{});var l=this.options;l.raw&&l.windowBits>0?l.windowBits=-l.windowBits:l.gzip&&l.windowBits>0&&l.windowBits<16&&(l.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var c=t.deflateInit2(this.strm,l.level,l.method,l.windowBits,l.memLevel,l.strategy);if(0!==c)throw new Error(i[c]);if(l.header&&t.deflateSetHeader(this.strm,l.header),l.dictionary){var h;if(h="string"==typeof l.dictionary?n.string2buf(l.dictionary):"[object ArrayBuffer]"===o.call(l.dictionary)?new Uint8Array(l.dictionary):l.dictionary,0!==(c=t.deflateSetDictionary(this.strm,h)))throw new Error(i[c]);this.gx=!0}}function s(t,e){var n=new a(e);if(n.push(t,!0),n.err)throw n.msg||i[n.err];return n.result}return a.prototype.push=function(i,r){var a,s,l=this.strm,c=this.options.chunkSize;if(this.ended)return!1;s=r===~~r?r:!0===r?4:0,"string"==typeof i?l.input=n.string2buf(i):"[object ArrayBuffer]"===o.call(i)?l.input=new Uint8Array(i):l.input=i,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new e.Buf8(c),l.next_out=0,l.avail_out=c),1!==(a=t.deflate(l,s))&&0!==a)return this.onEnd(a),this.ended=!0,!1;0!==l.avail_out&&(0!==l.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(n.buf2binstring(e.shrinkBuf(l.output,l.next_out))):this.onData(e.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||0===l.avail_out)&&1!==a);return 4===s?(a=t.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,0===a):2!==s||(this.onEnd(0),l.avail_out=0,!0)},a.prototype.onData=function(t){this.chunks.push(t)},a.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},Gz.Deflate=a,Gz.deflate=s,Gz.deflateRaw=function(t,e){return(e=e||{}).raw=!0,s(t,e)},Gz.gzip=function(t,e){return(e=e||{}).gzip=!0,s(t,e)},Gz}(),n={};return t(n,e,function(){if(gO)return wO;gO=1;var t=function(){if(uO)return SO;uO=1;var t=Oz(),e=Zz(),n=Jz(),i=(lO||(lO=1,sO=function(t,e){var n,i,r,o,a,s,l,c,h,u,d,f,p,m,g,v,y,b,x,w,S,C,T,$,M;n=t.state,i=t.next_in,$=t.input,r=i+(t.avail_in-5),o=t.next_out,M=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=n.dmax,c=n.wsize,h=n.whave,u=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{p<15&&(f+=$[i++]<<p,p+=8,f+=$[i++]<<p,p+=8),b=m[f&v];e:for(;;){if(f>>>=x=b>>>24,p-=x,0==(x=b>>>16&255))M[o++]=65535&b;else{if(!(16&x)){if(64&x){if(32&x){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}b=m[(65535&b)+(f&(1<<x)-1)];continue e}for(w=65535&b,(x&=15)&&(p<x&&(f+=$[i++]<<p,p+=8),w+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=$[i++]<<p,p+=8,f+=$[i++]<<p,p+=8),b=g[f&y];;){if(f>>>=x=b>>>24,p-=x,16&(x=b>>>16&255)){if(S=65535&b,p<(x&=15)&&(f+=$[i++]<<p,(p+=8)<x&&(f+=$[i++]<<p,p+=8)),(S+=f&(1<<x)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=x,p-=x,S>(x=o-a)){if((x=S-x)>h&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(C=0,T=d,0===u){if(C+=c-x,x<w){w-=x;do{M[o++]=d[C++]}while(--x);C=o-S,T=M}}else if(u<x){if(C+=c+u-x,(x-=u)<w){w-=x;do{M[o++]=d[C++]}while(--x);if(C=0,u<w){w-=x=u;do{M[o++]=d[C++]}while(--x);C=o-S,T=M}}}else if(C+=u-x,x<w){w-=x;do{M[o++]=d[C++]}while(--x);C=o-S,T=M}for(;w>2;)M[o++]=T[C++],M[o++]=T[C++],M[o++]=T[C++],w-=3;w&&(M[o++]=T[C++],w>1&&(M[o++]=T[C++]))}else{C=o-S;do{M[o++]=M[C++],M[o++]=M[C++],M[o++]=M[C++],w-=3}while(w>2);w&&(M[o++]=M[C++],w>1&&(M[o++]=M[C++]))}break}if(64&x){t.msg="invalid distance code",n.mode=30;break t}b=g[(65535&b)+(f&(1<<x)-1)]}}break}}while(i<r&&o<s);i-=w=p>>3,f&=(1<<(p-=w<<3))-1,t.next_in=i,t.next_out=o,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=o<s?s-o+257:257-(o-s),n.hold=f,n.bits=p}),sO),r=function(){if(hO)return cO;hO=1;var t=Oz(),e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],r=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return cO=function(o,a,s,l,c,h,u,d){var f,p,m,g,v,y,b,x,w,S=d.bits,C=0,T=0,$=0,M=0,A=0,N=0,k=0,R=0,_=0,I=0,F=null,E=0,D=new t.Buf16(16),L=new t.Buf16(16),P=null,z=0;for(C=0;C<=15;C++)D[C]=0;for(T=0;T<l;T++)D[a[s+T]]++;for(A=S,M=15;M>=1&&0===D[M];M--);if(A>M&&(A=M),0===M)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for($=1;$<M&&0===D[$];$++);for(A<$&&(A=$),R=1,C=1;C<=15;C++)if(R<<=1,(R-=D[C])<0)return-1;if(R>0&&(0===o||1!==M))return-1;for(L[1]=0,C=1;C<15;C++)L[C+1]=L[C]+D[C];for(T=0;T<l;T++)0!==a[s+T]&&(u[L[a[s+T]]++]=T);if(0===o?(F=P=u,y=19):1===o?(F=e,E-=257,P=n,z-=257,y=256):(F=i,P=r,y=-1),I=0,T=0,C=$,v=h,N=A,k=0,m=-1,g=(_=1<<A)-1,1===o&&_>852||2===o&&_>592)return 1;for(;;){b=C-k,u[T]<y?(x=0,w=u[T]):u[T]>y?(x=P[z+u[T]],w=F[E+u[T]]):(x=96,w=0),f=1<<C-k,$=p=1<<N;do{c[v+(I>>k)+(p-=f)]=b<<24|x<<16|w}while(0!==p);for(f=1<<C-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,T++,0===--D[C]){if(C===M)break;C=a[s+u[T]]}if(C>A&&(I&g)!==m){for(0===k&&(k=A),v+=$,R=1<<(N=C-k);N+k<M&&!((R-=D[N+k])<=0);)N++,R<<=1;if(_+=1<<N,1===o&&_>852||2===o&&_>592)return 1;c[m=I&g]=A<<24|N<<16|v-h}}return 0!==I&&(c[v+I]=C-k<<24|64<<16),d.bits=A,0},cO}(),o=-2,a=12,s=30;function l(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new t.Buf16(320),this.work=new t.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var n;return e&&e.state?(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new t.Buf32(852),n.distcode=n.distdyn=new t.Buf32(592),n.sane=1,n.back=-1,0):o}function u(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,h(t)):o}function d(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?o:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,u(t))):o}function f(t,e){var n,i;return t?(i=new c,t.state=i,i.window=null,0!==(n=d(t,e))&&(t.state=null),n):o}var p,m,g=!0;function v(e){if(g){var n;for(p=new t.Buf32(512),m=new t.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(r(1,e.lens,0,288,p,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;r(2,e.lens,0,32,m,0,e.work,{bits:5}),g=!1}e.lencode=p,e.lenbits=9,e.distcode=m,e.distbits=5}function y(e,n,i,r){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new t.Buf8(a.wsize)),r>=a.wsize?(t.arraySet(a.window,n,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),t.arraySet(a.window,n,i-r,o,a.wnext),(r-=o)?(t.arraySet(a.window,n,i-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}return SO.inflateReset=u,SO.inflateReset2=d,SO.inflateResetKeep=h,SO.inflateInit=function(t){return f(t,15)},SO.inflateInit2=f,SO.inflate=function(c,h){var u,d,f,p,m,g,b,x,w,S,C,T,$,M,A,N,k,R,_,I,F,E,D,L,P=0,z=new t.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return o;(u=c.state).mode===a&&(u.mode=13),m=c.next_out,f=c.output,b=c.avail_out,p=c.next_in,d=c.input,g=c.avail_in,x=u.hold,w=u.bits,S=g,C=b,E=0;t:for(;;)switch(u.mode){case 1:if(0===u.wrap){u.mode=13;break}for(;w<16;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(2&u.wrap&&35615===x){u.check=0,z[0]=255&x,z[1]=x>>>8&255,u.check=n(u.check,z,2,0),x=0,w=0,u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&x)<<8)+(x>>8))%31){c.msg="incorrect header check",u.mode=s;break}if(8!=(15&x)){c.msg="unknown compression method",u.mode=s;break}if(w-=4,F=8+(15&(x>>>=4)),0===u.wbits)u.wbits=F;else if(F>u.wbits){c.msg="invalid window size",u.mode=s;break}u.dmax=1<<F,c.adler=u.check=1,u.mode=512&x?10:a,x=0,w=0;break;case 2:for(;w<16;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(u.flags=x,8!=(255&u.flags)){c.msg="unknown compression method",u.mode=s;break}if(57344&u.flags){c.msg="unknown header flags set",u.mode=s;break}u.head&&(u.head.text=x>>8&1),512&u.flags&&(z[0]=255&x,z[1]=x>>>8&255,u.check=n(u.check,z,2,0)),x=0,w=0,u.mode=3;case 3:for(;w<32;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}u.head&&(u.head.time=x),512&u.flags&&(z[0]=255&x,z[1]=x>>>8&255,z[2]=x>>>16&255,z[3]=x>>>24&255,u.check=n(u.check,z,4,0)),x=0,w=0,u.mode=4;case 4:for(;w<16;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}u.head&&(u.head.xflags=255&x,u.head.os=x>>8),512&u.flags&&(z[0]=255&x,z[1]=x>>>8&255,u.check=n(u.check,z,2,0)),x=0,w=0,u.mode=5;case 5:if(1024&u.flags){for(;w<16;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}u.length=x,u.head&&(u.head.extra_len=x),512&u.flags&&(z[0]=255&x,z[1]=x>>>8&255,u.check=n(u.check,z,2,0)),x=0,w=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&((T=u.length)>g&&(T=g),T&&(u.head&&(F=u.head.extra_len-u.length,u.head.extra||(u.head.extra=new Array(u.head.extra_len)),t.arraySet(u.head.extra,d,p,T,F)),512&u.flags&&(u.check=n(u.check,d,T,p)),g-=T,p+=T,u.length-=T),u.length))break t;u.length=0,u.mode=7;case 7:if(2048&u.flags){if(0===g)break t;T=0;do{F=d[p+T++],u.head&&F&&u.length<65536&&(u.head.name+=String.fromCharCode(F))}while(F&&T<g);if(512&u.flags&&(u.check=n(u.check,d,T,p)),g-=T,p+=T,F)break t}else u.head&&(u.head.name=null);u.length=0,u.mode=8;case 8:if(4096&u.flags){if(0===g)break t;T=0;do{F=d[p+T++],u.head&&F&&u.length<65536&&(u.head.comment+=String.fromCharCode(F))}while(F&&T<g);if(512&u.flags&&(u.check=n(u.check,d,T,p)),g-=T,p+=T,F)break t}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;w<16;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(x!==(65535&u.check)){c.msg="header crc mismatch",u.mode=s;break}x=0,w=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0),c.adler=u.check=0,u.mode=a;break;case 10:for(;w<32;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}c.adler=u.check=l(x),x=0,w=0,u.mode=11;case 11:if(0===u.havedict)return c.next_out=m,c.avail_out=b,c.next_in=p,c.avail_in=g,u.hold=x,u.bits=w,2;c.adler=u.check=1,u.mode=a;case a:if(5===h||6===h)break t;case 13:if(u.last){x>>>=7&w,w-=7&w,u.mode=27;break}for(;w<3;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}switch(u.last=1&x,w-=1,3&(x>>>=1)){case 0:u.mode=14;break;case 1:if(v(u),u.mode=20,6===h){x>>>=2,w-=2;break t}break;case 2:u.mode=17;break;case 3:c.msg="invalid block type",u.mode=s}x>>>=2,w-=2;break;case 14:for(x>>>=7&w,w-=7&w;w<32;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if((65535&x)!=(x>>>16^65535)){c.msg="invalid stored block lengths",u.mode=s;break}if(u.length=65535&x,x=0,w=0,u.mode=15,6===h)break t;case 15:u.mode=16;case 16:if(T=u.length){if(T>g&&(T=g),T>b&&(T=b),0===T)break t;t.arraySet(f,d,p,T,m),g-=T,p+=T,b-=T,m+=T,u.length-=T;break}u.mode=a;break;case 17:for(;w<14;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(u.nlen=257+(31&x),x>>>=5,w-=5,u.ndist=1+(31&x),x>>>=5,w-=5,u.ncode=4+(15&x),x>>>=4,w-=4,u.nlen>286||u.ndist>30){c.msg="too many length or distance symbols",u.mode=s;break}u.have=0,u.mode=18;case 18:for(;u.have<u.ncode;){for(;w<3;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}u.lens[O[u.have++]]=7&x,x>>>=3,w-=3}for(;u.have<19;)u.lens[O[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,D={bits:u.lenbits},E=r(0,u.lens,0,19,u.lencode,0,u.work,D),u.lenbits=D.bits,E){c.msg="invalid code lengths set",u.mode=s;break}u.have=0,u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;N=(P=u.lencode[x&(1<<u.lenbits)-1])>>>16&255,k=65535&P,!((A=P>>>24)<=w);){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(k<16)x>>>=A,w-=A,u.lens[u.have++]=k;else{if(16===k){for(L=A+2;w<L;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(x>>>=A,w-=A,0===u.have){c.msg="invalid bit length repeat",u.mode=s;break}F=u.lens[u.have-1],T=3+(3&x),x>>>=2,w-=2}else if(17===k){for(L=A+3;w<L;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}w-=A,F=0,T=3+(7&(x>>>=A)),x>>>=3,w-=3}else{for(L=A+7;w<L;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}w-=A,F=0,T=11+(127&(x>>>=A)),x>>>=7,w-=7}if(u.have+T>u.nlen+u.ndist){c.msg="invalid bit length repeat",u.mode=s;break}for(;T--;)u.lens[u.have++]=F}}if(u.mode===s)break;if(0===u.lens[256]){c.msg="invalid code -- missing end-of-block",u.mode=s;break}if(u.lenbits=9,D={bits:u.lenbits},E=r(1,u.lens,0,u.nlen,u.lencode,0,u.work,D),u.lenbits=D.bits,E){c.msg="invalid literal/lengths set",u.mode=s;break}if(u.distbits=6,u.distcode=u.distdyn,D={bits:u.distbits},E=r(2,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,D),u.distbits=D.bits,E){c.msg="invalid distances set",u.mode=s;break}if(u.mode=20,6===h)break t;case 20:u.mode=21;case 21:if(g>=6&&b>=258){c.next_out=m,c.avail_out=b,c.next_in=p,c.avail_in=g,u.hold=x,u.bits=w,i(c,C),m=c.next_out,f=c.output,b=c.avail_out,p=c.next_in,d=c.input,g=c.avail_in,x=u.hold,w=u.bits,u.mode===a&&(u.back=-1);break}for(u.back=0;N=(P=u.lencode[x&(1<<u.lenbits)-1])>>>16&255,k=65535&P,!((A=P>>>24)<=w);){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(N&&!(240&N)){for(R=A,_=N,I=k;N=(P=u.lencode[I+((x&(1<<R+_)-1)>>R)])>>>16&255,k=65535&P,!(R+(A=P>>>24)<=w);){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}x>>>=R,w-=R,u.back+=R}if(x>>>=A,w-=A,u.back+=A,u.length=k,0===N){u.mode=26;break}if(32&N){u.back=-1,u.mode=a;break}if(64&N){c.msg="invalid literal/length code",u.mode=s;break}u.extra=15&N,u.mode=22;case 22:if(u.extra){for(L=u.extra;w<L;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}u.length+=x&(1<<u.extra)-1,x>>>=u.extra,w-=u.extra,u.back+=u.extra}u.was=u.length,u.mode=23;case 23:for(;N=(P=u.distcode[x&(1<<u.distbits)-1])>>>16&255,k=65535&P,!((A=P>>>24)<=w);){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(!(240&N)){for(R=A,_=N,I=k;N=(P=u.distcode[I+((x&(1<<R+_)-1)>>R)])>>>16&255,k=65535&P,!(R+(A=P>>>24)<=w);){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}x>>>=R,w-=R,u.back+=R}if(x>>>=A,w-=A,u.back+=A,64&N){c.msg="invalid distance code",u.mode=s;break}u.offset=k,u.extra=15&N,u.mode=24;case 24:if(u.extra){for(L=u.extra;w<L;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}u.offset+=x&(1<<u.extra)-1,x>>>=u.extra,w-=u.extra,u.back+=u.extra}if(u.offset>u.dmax){c.msg="invalid distance too far back",u.mode=s;break}u.mode=25;case 25:if(0===b)break t;if(T=C-b,u.offset>T){if((T=u.offset-T)>u.whave&&u.sane){c.msg="invalid distance too far back",u.mode=s;break}T>u.wnext?(T-=u.wnext,$=u.wsize-T):$=u.wnext-T,T>u.length&&(T=u.length),M=u.window}else M=f,$=m-u.offset,T=u.length;T>b&&(T=b),b-=T,u.length-=T;do{f[m++]=M[$++]}while(--T);0===u.length&&(u.mode=21);break;case 26:if(0===b)break t;f[m++]=u.length,b--,u.mode=21;break;case 27:if(u.wrap){for(;w<32;){if(0===g)break t;g--,x|=d[p++]<<w,w+=8}if(C-=b,c.total_out+=C,u.total+=C,C&&(c.adler=u.check=u.flags?n(u.check,f,C,m-C):e(u.check,f,C,m-C)),C=b,(u.flags?x:l(x))!==u.check){c.msg="incorrect data check",u.mode=s;break}x=0,w=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;w<32;){if(0===g)break t;g--,x+=d[p++]<<w,w+=8}if(x!==(4294967295&u.total)){c.msg="incorrect length check",u.mode=s;break}x=0,w=0}u.mode=29;case 29:E=1;break t;case s:E=-3;break t;case 31:return-4;default:return o}return c.next_out=m,c.avail_out=b,c.next_in=p,c.avail_in=g,u.hold=x,u.bits=w,(u.wsize||C!==c.avail_out&&u.mode<s&&(u.mode<27||4!==h))&&y(c,c.output,c.next_out,C-c.avail_out),S-=c.avail_in,C-=c.avail_out,c.total_in+=S,c.total_out+=C,u.total+=C,u.wrap&&C&&(c.adler=u.check=u.flags?n(u.check,f,C,c.next_out-C):e(u.check,f,C,c.next_out-C)),c.data_type=u.bits+(u.last?64:0)+(u.mode===a?128:0)+(20===u.mode||15===u.mode?256:0),(0===S&&0===C||4===h)&&0===E&&(E=-5),E},SO.inflateEnd=function(t){if(!t||!t.state)return o;var e=t.state;return e.window&&(e.window=null),t.state=null,0},SO.inflateGetHeader=function(t,e){var n;return t&&t.state&&2&(n=t.state).wrap?(n.head=e,e.done=!1,0):o},SO.inflateSetDictionary=function(t,n){var i,r=n.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?o:11===i.mode&&e(1,n,r,0)!==i.check?-3:y(t,n,r,r)?(i.mode=31,-4):(i.havedict=1,0):o},SO.inflateInfo="pako inflate (from Nodeca project)",SO}(),e=Oz(),n=oO(),i=CO(),r=Qz(),o=aO(),a=mO?pO:(mO=1,pO=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}),s=Object.prototype.toString;function l(c){if(!(this instanceof l))return new l(c);this.options=e.assign({chunkSize:16384,windowBits:0,to:""},c||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,0===h.windowBits&&(h.windowBits=-15)),!(h.windowBits>=0&&h.windowBits<16)||c&&c.windowBits||(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(15&h.windowBits||(h.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var u=t.inflateInit2(this.strm,h.windowBits);if(u!==i.Z_OK)throw new Error(r[u]);if(this.header=new a,t.inflateGetHeader(this.strm,this.header),h.dictionary&&("string"==typeof h.dictionary?h.dictionary=n.string2buf(h.dictionary):"[object ArrayBuffer]"===s.call(h.dictionary)&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(u=t.inflateSetDictionary(this.strm,h.dictionary))!==i.Z_OK))throw new Error(r[u])}function c(t,e){var n=new l(e);if(n.push(t,!0),n.err)throw n.msg||r[n.err];return n.result}return l.prototype.push=function(r,o){var a,l,c,h,u,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;l=o===~~o?o:!0===o?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof r?d.input=n.binstring2buf(r):"[object ArrayBuffer]"===s.call(r)?d.input=new Uint8Array(r):d.input=r,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new e.Buf8(f),d.next_out=0,d.avail_out=f),(a=t.inflate(d,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&p&&(a=t.inflateSetDictionary(this.strm,p)),a===i.Z_BUF_ERROR&&!0===m&&(a=i.Z_OK,m=!1),a!==i.Z_STREAM_END&&a!==i.Z_OK)return this.onEnd(a),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&a!==i.Z_STREAM_END&&(0!==d.avail_in||l!==i.Z_FINISH&&l!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(c=n.utf8border(d.output,d.next_out),h=d.next_out-c,u=n.buf2string(d.output,c),d.next_out=h,d.avail_out=f-h,h&&e.arraySet(d.output,d.output,c,h,0),this.onData(u)):this.onData(e.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&a!==i.Z_STREAM_END);return a===i.Z_STREAM_END&&(l=i.Z_FINISH),l===i.Z_FINISH?(a=t.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===i.Z_OK):l!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),d.avail_out=0,!0)},l.prototype.onData=function(t){this.chunks.push(t)},l.prototype.onEnd=function(t){t===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},wO.Inflate=l,wO.inflate=c,wO.inflateRaw=function(t,e){return(e=e||{}).raw=!0,c(t,e)},wO.ungzip=c,wO}(),CO()),vO=n}();return Pz.uncompressInputType=t?"uint8array":"array",Pz.compressInputType=t?"uint8array":"array",Pz.magic="\b\0",Pz.compress=function(t,n){return e.deflateRaw(t,{level:n.level||-1})},Pz.uncompress=function(t){return e.inflateRaw(t)},Pz}()),Lz}var $O,MO,AO,NO,kO={exports:{}};function RO(){return $O||($O=1,kO.exports=function(t,e){return new Buffer(t,e)},kO.exports.test=function(t){return Buffer.isBuffer(t)}),kO.exports}function _O(){return MO||(MO=1,function(t){var e=Fz(),n=TO(),i=RO();function r(t){return t}function o(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}function a(e){var n=65536,r=[],o=e.length,a=t.getTypeOf(e),s=0,l=!0;try{switch(a){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,i(0))}}catch(t){l=!1}if(!l){for(var c="",h=0;h<e.length;h++)c+=String.fromCharCode(e[h]);return c}for(;s<o&&n>1;)try{"array"===a||"nodebuffer"===a?r.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+n,o)))):r.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+n,o)))),s+=n}catch(t){n=Math.floor(n/2)}return r.join("")}function s(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}t.string2binary=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n));return e},t.arrayBuffer2Blob=function(e,n){t.checkSupport("blob"),n=n||"application/zip";try{return new Blob([e],{type:n})}catch(t){try{var i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return i.append(e),i.getBlob(n)}catch(t){throw new Error("Bug : can't construct the Blob.")}}},t.applyFromCharCode=a;var l={};l.string={"string":r,"array":function(t){return o(t,new Array(t.length))},"arraybuffer":function(t){return l.string.uint8array(t).buffer},"uint8array":function(t){return o(t,new Uint8Array(t.length))},"nodebuffer":function(t){return o(t,i(t.length))}},l.array={"string":a,"array":r,"arraybuffer":function(t){return new Uint8Array(t).buffer},"uint8array":function(t){return new Uint8Array(t)},"nodebuffer":function(t){return i(t)}},l.arraybuffer={"string":function(t){return a(new Uint8Array(t))},"array":function(t){return s(new Uint8Array(t),new Array(t.byteLength))},"arraybuffer":r,"uint8array":function(t){return new Uint8Array(t)},"nodebuffer":function(t){return i(new Uint8Array(t))}},l.uint8array={"string":a,"array":function(t){return s(t,new Array(t.length))},"arraybuffer":function(t){return t.buffer},"uint8array":r,"nodebuffer":function(t){return i(t)}},l.nodebuffer={"string":a,"array":function(t){return s(t,new Array(t.length))},"arraybuffer":function(t){return l.nodebuffer.uint8array(t).buffer},"uint8array":function(t){return s(t,new Uint8Array(t.length))},"nodebuffer":r},t.transformTo=function(e,n){if(n||(n=""),!e)return n;t.checkSupport(e);var i=t.getTypeOf(n);return l[i][e](n)},t.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":e.nodebuffer&&i.test(t)?"nodebuffer":e.uint8array&&t instanceof Uint8Array?"uint8array":e.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(t){if(!e[t.toLowerCase()])throw new Error(t+" is not supported by this browser")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(t){var e,n,i="";for(n=0;n<(t||"").length;n++)i+="\\x"+((e=t.charCodeAt(n))<16?"0":"")+e.toString(16).toUpperCase();return i},t.findCompression=function(t){for(var e in n)if(n.hasOwnProperty(e)&&n[e].magic===t)return n[e];return null},t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.extend=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===n[e]&&(n[e]=arguments[t][e]);return n}}(Dz)),Dz}var IO,FO={};function EO(){return IO||(IO=1,FO.LOCAL_FILE_HEADER="PK",FO.CENTRAL_FILE_HEADER="PK",FO.CENTRAL_DIRECTORY_END="PK",FO.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",FO.ZIP64_CENTRAL_DIRECTORY_END="PK",FO.DATA_DESCRIPTOR="PK\b"),FO}var DO,LO,PO,zO={};function OO(){return DO||(DO=1,zO.base64=!1,zO.binary=!1,zO.dir=!1,zO.createFolders=!1,zO.date=null,zO.compression=null,zO.compressionOptions=null,zO.comment=null,zO.unixPermissions=null,zO.dosPermissions=null),zO}function BO(){if(PO)return LO;function t(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}return PO=1,t.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},LO=t}var VO,HO,UO,qO,KO,WO,jO,GO,XO,YO,ZO,JO,QO,tB,eB,nB,iB,rB,oB,aB,sB,lB,cB,hB={};function uB(){if(VO)return hB;VO=1;for(var t=_O(),e=Fz(),n=RO(),i=new Array(256),r=0;r<256;r++)i[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;i[254]=i[254]=1;var o=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+i[t[n]]>e?n:e},a=function(e){var n,r,o,a,s=e.length,l=new Array(2*s);for(r=0,n=0;n<s;)if((o=e[n++])<128)l[r++]=o;else if((a=i[o])>4)l[r++]=65533,n+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&n<s;)o=o<<6|63&e[n++],a--;a>1?l[r++]=65533:o<65536?l[r++]=o:(o-=65536,l[r++]=55296|o>>10&1023,l[r++]=56320|1023&o)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),t.applyFromCharCode(l)};return hB.utf8encode=function(t){return e.nodebuffer?n(t,"utf-8"):function(t){var n,i,r,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(n=e.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;a<l;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),i<128?n[a++]=i:i<2048?(n[a++]=192|i>>>6,n[a++]=128|63&i):i<65536?(n[a++]=224|i>>>12,n[a++]=128|i>>>6&63,n[a++]=128|63&i):(n[a++]=240|i>>>18,n[a++]=128|i>>>12&63,n[a++]=128|i>>>6&63,n[a++]=128|63&i);return n}(t)},hB.utf8decode=function(n){if(e.nodebuffer)return t.transformTo("nodebuffer",n).toString("utf-8");for(var i=[],r=0,s=(n=t.transformTo(e.uint8array?"uint8array":"array",n)).length;r<s;){var l=o(n,Math.min(r+65536,s));e.uint8array?i.push(a(n.subarray(r,l))):i.push(a(n.slice(r,l))),r=l}return i.join("")},hB}function dB(){if(jO)return WO;jO=1;var t=Fz(),e=_O(),n=function(){if(NO)return AO;NO=1;var t=_O(),e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];return AO=function(n,i){if(void 0===n||!n.length)return 0;var r="string"!==t.getTypeOf(n);void 0===i&&(i=0);var o=0;i^=-1;for(var a=0,s=n.length;a<s;a++)o=r?n[a]:n.charCodeAt(a),i=i>>>8^e[255&(i^o)];return-1^i},AO}(),i=EO(),r=OO(),o=Rz(),a=TO(),s=BO(),l=RO(),c=uB(),h=function(){if(UO)return HO;UO=1;var t=_O(),e=function(){this.data=[]};return e.prototype={append:function(e){e=t.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},HO=e}(),u=function(){if(KO)return qO;KO=1;var t=_O(),e=function(t){this.data=new Uint8Array(t),this.index=0};return e.prototype={append:function(e){0!==e.length&&(e=t.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},qO=e}(),d=function(t){if(t.Ln instanceof s&&(t.Ln=t.Ln.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===e.getTypeOf(t.Ln))){var n=t.Ln;t.Ln=new Uint8Array(n.length),0!==n.length&&t.Ln.set(n,0)}return t.Ln},f=function(n){var i=d(n);return"string"===e.getTypeOf(i)?!n.options.binary&&t.nodebuffer?l(i,"utf-8"):n.asBinary():i},p=function(t){var n=d(this);return null==n?"":(this.options.base64&&(n=o.decode(n)),n=t&&this.options.binary?C.utf8decode(n):e.transformTo("string",n),t||this.options.binary||(n=e.transformTo("string",C.utf8encode(n))),n)},m=function(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this.Ln=e,this.options=n,this.yx={dir:n.dir,date:n.date}};m.prototype={asText:function(){return p.call(this,!0)},asBinary:function(){return p.call(this,!1)},asNodeBuffer:function(){var t=f(this);return e.transformTo("nodebuffer",t)},asUint8Array:function(){var t=f(this);return e.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var g=function(t,e){var n,i="";for(n=0;n<e;n++)i+=String.fromCharCode(255&t),t>>>=8;return i},v=function(t,n,i){var o,a=e.getTypeOf(n);if("string"==typeof(i=function(t){return!0!==(t=t||{}).base64||null!==t.binary&&void 0!==t.binary||(t.binary=!0),(t=e.extend(t,r)).date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t}(i)).unixPermissions&&(i.unixPermissions=parseInt(i.unixPermissions,8)),i.unixPermissions&&16384&i.unixPermissions&&(i.dir=!0),i.dosPermissions&&16&i.dosPermissions&&(i.dir=!0),i.dir&&(t=b(t)),i.createFolders&&(o=y(t))&&x.call(this,o,!0),i.dir||null==n)i.base64=!1,i.binary=!1,n=null,a=null;else if("string"===a)i.binary&&!i.base64&&!0!==i.optimizedBinaryString&&(n=e.string2binary(n));else{if(i.base64=!1,i.binary=!0,!(a||n instanceof s))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===a&&(n=e.transformTo("uint8array",n))}var l=new m(t,n,i);return this.files[t]=l,l},y=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},b=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},x=function(t,e){return e=void 0!==e&&e,t=b(t),this.files[t]||v.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},w=function(t,i,r){var o,l=new s;return t.Ln instanceof s?(l.uncompressedSize=t.Ln.uncompressedSize,l.crc32=t.Ln.crc32,0===l.uncompressedSize||t.dir?(i=a.STORE,l.compressedContent="",l.crc32=0):t.Ln.compressionMethod===i.magic?l.compressedContent=t.Ln.getCompressedContent():(o=t.Ln.getContent(),l.compressedContent=i.compress(e.transformTo(i.compressInputType,o),r))):((o=f(t))&&0!==o.length&&!t.dir||(i=a.STORE,o=""),l.uncompressedSize=o.length,l.crc32=n(o),l.compressedContent=i.compress(e.transformTo(i.compressInputType,o),r)),l.compressedSize=l.compressedContent.length,l.compressionMethod=i.magic,l},S=function(t,r,o,a,s,l){o.compressedContent;var h,u,d,f,p=l!==c.utf8encode,m=e.transformTo("string",l(r.name)),v=e.transformTo("string",c.utf8encode(r.name)),y=r.comment||"",b=e.transformTo("string",l(y)),x=e.transformTo("string",c.utf8encode(y)),w=v.length!==r.name.length,S=x.length!==y.length,C=r.options,T="",$="",M="";d=r.yx.dir!==r.dir?r.dir:C.dir,f=r.yx.date!==r.date?r.date:C.date;var A=0,N=0;d&&(A|=16),"UNIX"===s?(N=798,A|=function(t,e){var n=t;return t||(n=e?16893:33204),(65535&n)<<16}(r.unixPermissions,d)):(N=20,A|=63&(r.dosPermissions||0)),h=f.getHours(),h<<=6,h|=f.getMinutes(),h<<=5,h|=f.getSeconds()/2,u=f.getFullYear()-1980,u<<=4,u|=f.getMonth()+1,u<<=5,u|=f.getDate(),w&&($=g(1,1)+g(n(m),4)+v,T+="up"+g($.length,2)+$),S&&(M=g(1,1)+g(this.crc32(b),4)+x,T+="uc"+g(M.length,2)+M);var k="";return k+="\n\0",k+=p||!w&&!S?"\0\0":"\0\b",k+=o.compressionMethod,k+=g(h,2),k+=g(u,2),k+=g(o.crc32,4),k+=g(o.compressedSize,4),k+=g(o.uncompressedSize,4),k+=g(m.length,2),k+=g(T.length,2),{fileRecord:i.LOCAL_FILE_HEADER+k+m+T,dirRecord:i.CENTRAL_FILE_HEADER+g(N,2)+k+g(b.length,2)+"\0\0\0\0"+g(A,4)+g(a,4)+m+T+b,compressedObject:o}},C={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var n,i,r,o,a=[];for(n in this.files)r=this.files[n],o=new m(r.name,r.Ln,e.extend(r.options)),i=n.slice(this.root.length,n.length),n.slice(0,this.root.length)===this.root&&t(i,o)&&a.push(o);return a},file:function(t,n,i){if(1===arguments.length){if(e.isRegExp(t)){var r=t;return this.filter(function(t,e){return!e.dir&&r.test(t)})}return this.filter(function(e,n){return!n.dir&&e===t})[0]||null}return t=this.root+t,v.call(this,t,n,i),this},folder:function(t){if(!t)return this;if(e.isRegExp(t))return this.filter(function(e,n){return n.dir&&t.test(e)});var n=this.root+t,i=x.call(this,n),r=this.clone();return r.root=i.name,r},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter(function(e,n){return n.name.slice(0,t.length)===t}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(t){t=e.extend(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode}),e.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var n,r,s,l=[],d=0,f=0,p=e.transformTo("string",t.encodeFileName(t.comment||this.comment||""));for(var m in this.files){var v=this.files[m],y=v.options.compression||t.compression.toUpperCase(),b=a[y];if(!b)throw new Error(y+" is not a valid compression method !");var x=v.options.compressionOptions||t.compressionOptions||{},C=w.call(this,v,b,x),T=S.call(this,m,v,C,d,t.platform,t.encodeFileName);d+=T.fileRecord.length+C.compressedSize,f+=T.dirRecord.length,l.push(T)}s=i.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(l.length,2)+g(l.length,2)+g(f,4)+g(d,4)+g(p.length,2)+p;var $=t.type.toLowerCase();for(n="uint8array"===$||"arraybuffer"===$||"blob"===$||"nodebuffer"===$?new u(d+f+s.length):new h(d+f+s.length),r=0;r<l.length;r++)n.append(l[r].fileRecord),n.append(l[r].compressedObject.compressedContent);for(r=0;r<l.length;r++)n.append(l[r].dirRecord);n.append(s);var M=n.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return e.transformTo(t.type.toLowerCase(),M);case"blob":return e.arrayBuffer2Blob(e.transformTo("arraybuffer",M),t.mimeType);case"base64":return t.base64?o.encode(M):M;default:return M}},crc32:function(t,e){return n(t,e)},utf8encode:function(t){return e.transformTo("string",c.utf8encode(t))},utf8decode:function(t){return c.utf8decode(t)}};return WO=C}function fB(){if(XO)return GO;XO=1;var t=_O();function e(t){this.data=null,this.length=0,this.index=0,this.zero=0}return e.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(e){return t.transformTo("string",this.readData(e))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},GO=e}function pB(){if(ZO)return YO;ZO=1;var t=fB(),e=_O();function n(t,n){this.data=t,n||(this.data=e.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}return n.prototype=new t,n.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},n.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},YO=n}function mB(){if(QO)return JO;QO=1;var t=fB();function e(t){if(t){this.data=t,this.length=this.data.length,this.index=0,this.zero=0;for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}}return e.prototype=new t,e.prototype.byteAt=function(t){return this.data[this.zero+t]},e.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===i&&this.data[o+3]===r)return o-this.zero;return-1},e.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},JO=e}function gB(){if(eB)return tB;eB=1;var t=mB();function e(t){t&&(this.data=t,this.length=this.data.length,this.index=0,this.zero=0)}return e.prototype=new t,e.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},tB=e}var vB,yB,bB,xB={},wB=function(){if(bB)return yB;bB=1;var t=Rz();function e(t,n){if(!(this instanceof e))return new e(t,n);this.files=Object.create(null),this.comment=null,this.root="",t&&this.load(t,n),this.clone=function(){var t=new e;for(var n in this)"function"!=typeof this[n]&&(t[n]=this[n]);return t}}return e.prototype=dB(),e.prototype.load=function(){if(cB)return lB;cB=1;var t=Rz(),e=uB(),n=_O(),i=function(){if(sB)return aB;sB=1;var t=pB(),e=function(){if(iB)return nB;iB=1;var t=gB();function e(t){this.data=t,this.length=this.data.length,this.index=0,this.zero=0}return e.prototype=new t,e.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},nB=e}(),n=gB(),i=mB(),r=_O(),o=EO(),a=function(){if(oB)return rB;oB=1;var t=pB(),e=_O(),n=BO(),i=dB(),r=Fz();function o(t,e){this.options=t,this.loadOptions=e}return o.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},prepareCompressedContent:function(t,e,n){return function(){var i=t.index;t.setIndex(e);var r=t.readData(n);return t.setIndex(i),r}},prepareContent:function(t,n,i,r,o){return function(){var t=e.transformTo(r.uncompressInputType,this.getCompressedContent()),n=r.uncompress(t);if(n.length!==o)throw new Error("Bug : uncompressed data size mismatch");return n}},readLocalPart:function(t){var r,o;if(t.skip(22),this.fileNameLength=t.readInt(2),o=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(o),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(r=e.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+e.pretty(this.compressionMethod)+" unknown (inner file : "+e.transformTo("string",this.fileName)+")");if(this.decompressed=new n,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,r),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,r,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=e.transformTo("string",this.decompressed.getContent()),i.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readData(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(n){if(this.extraFields[1]){var i=new t(this.extraFields[1].value);this.uncompressedSize===e.MAX_VALUE_32BITS&&(this.uncompressedSize=i.readInt(8)),this.compressedSize===e.MAX_VALUE_32BITS&&(this.compressedSize=i.readInt(8)),this.localHeaderOffset===e.MAX_VALUE_32BITS&&(this.localHeaderOffset=i.readInt(8)),this.diskNumberStart===e.MAX_VALUE_32BITS&&(this.diskNumberStart=i.readInt(4))}},readExtraFields:function(t){var e,n,i,r=t.index;for(this.extraFields=this.extraFields||{};t.index<r+this.extraFieldsLength;)e=t.readInt(2),n=t.readInt(2),i=t.readString(n),this.extraFields[e]={id:e,length:n,value:i}},handleUTF8:function(){var t=r.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=i.utf8decode(this.fileName),this.fileCommentStr=i.utf8decode(this.fileComment);else{var n=this.findExtraFieldUnicodePath();if(null!==n)this.fileNameStr=n;else{var o=e.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(o)}var a=this.findExtraFieldUnicodeComment();if(null!==a)this.fileCommentStr=a;else{var s=e.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var n=new t(e.value);return 1!==n.readInt(1)||i.crc32(this.fileName)!==n.readInt(4)?null:i.utf8decode(n.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var n=new t(e.value);return 1!==n.readInt(1)||i.crc32(this.fileComment)!==n.readInt(4)?null:i.utf8decode(n.readString(e.length-5))}return null}},rB=o}(),s=Fz();function l(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}return dB(),l.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+r.pretty(e)+", expected "+r.pretty(t)+")")},isSignature:function(t,e){var n=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=s.uint8array?"uint8array":"array",n=r.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===o.CENTRAL_FILE_HEADER;)(t=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip : can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=e-n;if(i>0)this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(o){var a=r.getTypeOf(o);if(r.checkSupport(a),"string"!==a||s.uint8array)if("nodebuffer"===a)this.reader=new e(o);else if(s.uint8array)this.reader=new n(r.transformTo("uint8array",o));else{if(!s.array)throw new Error("Unexpected error: unsupported type '"+a+"'");this.reader=new i(r.transformTo("array",o))}else this.reader=new t(o,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},aB=l}();return lB=function(r,o){var a,s,l,c;for((o=n.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:e.utf8decode})).base64&&(r=t.decode(r)),a=(s=new i(r,o)).files,l=0;l<a.length;l++)c=a[l],this.file(c.fileNameStr,c.decompressed,{binary:!0,optimizedBinaryString:!0,date:c.date,dir:c.dir,comment:c.fileCommentStr.length?c.fileCommentStr:null,unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions,createFolders:o.createFolders});return s.zipComment.length&&(this.comment=s.zipComment),this},lB}(),e.support=Fz(),e.defaults=OO(),e.utils=function(){if(vB)return xB;vB=1;var t=_O();return xB.string2binary=function(e){return t.string2binary(e)},xB.string2Uint8Array=function(e){return t.transformTo("uint8array",e)},xB.uint8Array2String=function(e){return t.transformTo("string",e)},xB.string2Blob=function(e){var n=t.transformTo("arraybuffer",e);return t.arrayBuffer2Blob(n)},xB.arrayBuffer2Blob=function(e){return t.arrayBuffer2Blob(e)},xB.transformTo=function(e,n){return t.transformTo(e,n)},xB.getTypeOf=function(e){return t.getTypeOf(e)},xB.checkSupport=function(e){return t.checkSupport(e)},xB.MAX_VALUE_16BITS=t.MAX_VALUE_16BITS,xB.MAX_VALUE_32BITS=t.MAX_VALUE_32BITS,xB.pretty=function(e){return t.pretty(e)},xB.findCompression=function(e){return t.findCompression(e)},xB.isRegExp=function(e){return t.isRegExp(e)},xB}(),e.base64={encode:function(e){return t.encode(e)},decode:function(e){return t.decode(e)}},e.compressions=TO(),yB=e}();const SB=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(wB),CB="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",TB="http://schemas.openxmlformats.org/spreadsheetml/2006/main",$B="http://schemas.openxmlformats.org/markup-compatibility/2006",MB="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",AB="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",NB="http://schemas.microsoft.com/office/spreadsheetml/2016/revision10",kB="http://schemas.microsoft.com/office/drawing/2010/slicer";function RB(t){return t?Array.isArray(t)?t:[t]:[]}function _B(t,e=0){const n=Number(t);return Number.isFinite(n)?n:e}function IB(t,e,n){const i=t.obj["[Content_Types].xml"]?.Types?.Override;i&&(i.some(t=>t._$PartName===e)||i.push({"_$PartName":e,"_$ContentType":n}))}function FB(t){let e=0;return RB(t).forEach(t=>{const n=String(t?._$Id||"").match(/^rId(\d+)$/);if(!n)return;const i=Number(n[1]);i>e&&(e=i)}),e+1}function EB(t){const e={"_$id":String(t.cacheId),"_$type":t.sourceType,"_$sheet":t.sourceSheet??"","_$name":t.sourceName??"","_$fieldIndex":String(t.fieldIndex??0),"_$fieldName":t.fieldName??""},n=function(t){const e=t.getItems({force:!0}).map(t=>({"_$key":t.key,"_$value":null===t.value||void 0===t.value?"":String(t.value),"_$text":t.text??""}));return e.length>0?{"sn:item":e}:void 0}(t);return n&&(e["sn:items"]=n),e}function DB(t,e=0){const n=Number(t);return Number.isFinite(n)?n:e}function LB(){if("undefined"!=typeof crypto&&crypto.randomUUID)return crypto.randomUUID().toUpperCase();const t=()=>Math.floor(65536*(1+Math.random())).toString(16).padStart(4,"0").toUpperCase();return`${t()}${t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`}function PB(t,e){const n=String(e||"").replace(/[{}]/g,"").toUpperCase().split("-").slice(1).join("-")||"0000-0000-0000-000000000000";return`{${Number(t).toString(16).padStart(8,"0").toUpperCase()}-${n}}`}function zB(t,e){return{"c:ext":{"_$uri":"{C3380CC4-5D6E-409C-BE32-E72D297353CC}","_$xmlns:c16":"http://schemas.microsoft.com/office/drawing/2014/chart","c16:uniqueId":{"_$val":PB(t,e)}}}}function OB(t){if(!(!0===t?.showSymbol||"number"==typeof t?.symbolSize&&t.symbolSize>0&&!1!==t?.showSymbol))return{"c:marker":{"c:symbol":{"_$val":"none"}}};const e="number"==typeof t?.symbolSize&&t.symbolSize>0?t.symbolSize:7.5;return{"c:marker":{"c:symbol":{"_$val":"circle"},"c:size":{"_$val":Math.max(2,Math.round(72*e/96))}}}}function BB(t){const e=DB(t?.lineStyle?.width,2);return{"c:spPr":{"a:ln":{"_$w":Math.max(1,Math.round(9525*e))}}}}function VB(t){const e=!0===t?.label?.show,n={"c:showLegendKey":{"_$val":"0"},"c:showVal":{"_$val":"0"},"c:showCatName":{"_$val":"0"},"c:showSerName":{"_$val":"0"},"c:showPercent":{"_$val":"0"},"c:showBubbleSize":{"_$val":"0"}};return n["c:showVal"]={"_$val":e?"1":"0"},{"c:dLbls":n}}function HB(t){return t?.__lineLike?t?.smooth?!1===t?.showSymbol?"smooth":"smoothMarker":!1===t?.showSymbol?"line":"lineMarker":"marker"}function UB(t){if(!1===t?.showSymbol)return{"c:marker":{"c:symbol":{"_$val":"none"}}};const e="number"==typeof t?.symbolSize&&t.symbolSize>0?t.symbolSize:7.5;return{"c:marker":{"c:symbol":{"_$val":"circle"},"c:size":{"_$val":Math.max(2,Math.round(72*e/96))}}}}function qB(t,e){if("marker"===t)return{"c:spPr":{"a:ln":{"a:noFill":""}}};const n=DB(e?.lineStyle?.width,2);return{"c:spPr":{"a:ln":{"_$w":Math.max(1,Math.round(9525*n))}}}}function KB(t){return Array.isArray(t)?t.map(t=>"number"==typeof t?t:"string"==typeof t?DB(t,0):Array.isArray(t)?DB(t.length>1?t[1]:t[0],0):t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"value")?DB(t.value,0):0):[]}function WB(t){if(!t)return!1;const e=t?.axisLabel?.formatter;if("string"==typeof e&&e.includes("%"))return!0;const n=t?.max;return 100===n||"100"===n}function jB(t,e,n,i,r=!1){return{"c:barDir":{"_$val":i},"c:grouping":{"_$val":n?r?"percentStacked":"stacked":"clustered"},"c:varyColors":{"_$val":"0"},"c:ser":[],"c:dLbls":{"c:showLegendKey":{"_$val":"0"},"c:showVal":{"_$val":"0"},"c:showCatName":{"_$val":"0"},"c:showSerName":{"_$val":"0"},"c:showPercent":{"_$val":"0"},"c:showBubbleSize":{"_$val":"0"}},"c:gapWidth":{"_$val":"150"},"c:overlap":{"_$val":n?"100":"-27"},"c:axId":[{"_$val":t},{"_$val":e}]}}function GB(t,e,n){const i=n||{};return{"c:axId":{"_$val":t},"c:scaling":{"c:orientation":{"_$val":"minMax"}},"c:delete":{"_$val":"0"},"c:axPos":{"_$val":"b"},"c:numFmt":{"_$formatCode":"General","_$sourceLinked":"1"},"c:majorTickMark":{"_$val":"none"},"c:minorTickMark":{"_$val":"none"},"c:tickLblPos":{"_$val":"nextTo"},"c:spPr":{"a:noFill":"","a:ln":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"15000"},"a:lumOff":{"_$val":"85000"},"_$val":"tx1"}},"a:round":"","_$w":"9525","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"},"a:effectLst":""},"c:txPr":{"a:bodyPr":{"_$rot":"-60000000","_$spcFirstLastPara":"1","_$vertOverflow":"ellipsis","_$vert":"horz","_$wrap":"square","_$anchor":"ctr","_$anchorCtr":"1"},"a:lstStyle":"","a:p":{"a:pPr":{"a:defRPr":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"65000"},"a:lumOff":{"_$val":"35000"},"_$val":"tx1"}},"a:latin":{"_$typeface":"+mn-lt"},"a:ea":{"_$typeface":"+mn-ea"},"a:cs":{"_$typeface":"+mn-cs"},"_$sz":Math.round(75*(i.axisLabel?.fontSize??14)),"_$b":"0","_$i":"0","_$u":"none","_$strike":"noStrike","_$kern":"1200","_$baseline":"0"}},"a:endParaRPr":{"_$lang":"zh-CN"}}},"c:crossAx":{"_$val":e},"c:crosses":{"_$val":!1===i.boundaryGap?"min":"autoZero"},"c:auto":{"_$val":"1"},"c:lblAlgn":{"_$val":"ctr"},"c:lblOffset":{"_$val":"100"},"c:noMultiLvlLbl":{"_$val":"0"}}}function XB(t,e,n,i="General"){const r=n||{};return{"c:axId":{"_$val":e},"c:scaling":{"c:orientation":{"_$val":"minMax"}},"c:delete":{"_$val":"0"},"c:axPos":{"_$val":"l"},"c:majorGridlines":{"c:spPr":{"a:ln":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"15000"},"a:lumOff":{"_$val":"85000"},"_$val":"tx1"}},"a:round":"","_$w":"9525","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"},"a:effectLst":""}},"c:numFmt":{"_$formatCode":i||"General","_$sourceLinked":"1"},"c:majorTickMark":{"_$val":"none"},"c:minorTickMark":{"_$val":"none"},"c:tickLblPos":{"_$val":"nextTo"},"c:spPr":{"a:noFill":"","a:ln":{"a:noFill":""},"a:effectLst":""},"c:txPr":{"a:bodyPr":{"_$rot":"-60000000","_$spcFirstLastPara":"1","_$vertOverflow":"ellipsis","_$vert":"horz","_$wrap":"square","_$anchor":"ctr","_$anchorCtr":"1"},"a:lstStyle":"","a:p":{"a:pPr":{"a:defRPr":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"65000"},"a:lumOff":{"_$val":"35000"},"_$val":"tx1"}},"a:latin":{"_$typeface":"+mn-lt"},"a:ea":{"_$typeface":"+mn-ea"},"a:cs":{"_$typeface":"+mn-cs"},"_$sz":Math.round(75*(r.axisLabel?.fontSize??14)),"_$b":"0","_$i":"0","_$u":"none","_$strike":"noStrike","_$kern":"1200","_$baseline":"0"}},"a:endParaRPr":{"_$lang":"zh-CN"}}},"c:crossAx":{"_$val":t},"c:crosses":{"_$val":!1===r.boundaryGap?"min":"autoZero"},"c:crossBetween":{"_$val":"between"}}}function YB(t,e,n,i){return{"c:axId":{"_$val":t},"c:scaling":{"c:orientation":{"_$val":"minMax"}},"c:delete":{"_$val":"0"},"c:axPos":{"_$val":i},"c:majorGridlines":{"c:spPr":{"a:ln":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"15000"},"a:lumOff":{"_$val":"85000"},"_$val":"tx1"}},"a:round":"","_$w":"9525","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"},"a:effectLst":""}},"c:numFmt":{"_$formatCode":"General","_$sourceLinked":"1"},"c:majorTickMark":{"_$val":"none"},"c:minorTickMark":{"_$val":"none"},"c:tickLblPos":{"_$val":"nextTo"},"c:spPr":{"a:noFill":"","a:ln":{"a:noFill":""},"a:effectLst":""},"c:txPr":{"a:bodyPr":{"_$rot":"0","_$spcFirstLastPara":"1","_$vertOverflow":"ellipsis","_$vert":"horz","_$wrap":"square","_$anchor":"ctr","_$anchorCtr":"1"},"a:lstStyle":"","a:p":{"a:pPr":{"a:defRPr":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"65000"},"a:lumOff":{"_$val":"35000"},"_$val":"tx1"}},"a:latin":{"_$typeface":"+mn-lt"},"a:ea":{"_$typeface":"+mn-ea"},"a:cs":{"_$typeface":"+mn-cs"},"_$sz":Math.round(75*(n?.axisLabel?.fontSize??14)),"_$b":"0","_$i":"0","_$u":"none","_$strike":"noStrike","_$kern":"1200","_$baseline":"0"}},"a:endParaRPr":{"_$lang":"zh-CN"}}},"c:crossAx":{"_$val":e},"c:crosses":{"_$val":!1===n?.boundaryGap?"min":"autoZero"},"c:crossBetween":{"_$val":"between"}}}function ZB(t,e){if(null==t)return"str"==e?{"c:strLit":{"c:ptCount":{"_$val":0}}}:{"c:numLit":{"c:formatCode":"General","c:ptCount":{"_$val":0}}};if(ve(t)){const n={};return n["c:"+("str"==e?"strRef":"numRef")]={"c:f":t},n}if(Array.isArray(t)){const n="c:"+("str"==e?"strLit":"numLit");if(0===t.length)return"str"==e?{[n]:{"c:ptCount":{"_$val":0}}}:{[n]:{"c:formatCode":"General","c:ptCount":{"_$val":0}}};const i="str"==e?{"c:ptCount":{"_$val":t.length},"c:pt":t.map((t,e)=>({"_$idx":e,"c:v":null==t?"":String(t)}))}:{"c:formatCode":"General","c:ptCount":{"_$val":t.length},"c:pt":t.map((t,e)=>({"_$idx":e,"c:v":null==t?"":String(t)}))};return{[n]:i}}return{"c:v":String(t)}}function JB(t,e){return e.map(e=>{if("string"==typeof e&&e.includes("!")&&ve(e))try{const n=e.match(/^(?:'((?:[^']|'')+)'|([^'!]+))!(.+)$/);if(n){const i=(n[1]??n[2]??"").replace(/''/g,"'"),r=n[3].replace(/\$/g,"");return r.includes(":")?e:t.getSheet(i).getCell(r).calcVal}}catch(t){}return e})}function QB(t,e){return{"c:date1904":{"_$val":"0"},"c:lang":{"_$val":"zh-CN"},"c:roundedCorners":{"_$val":"0"},"mc:AlternateContent":{"mc:Choice":{"c14:style":{"_$val":"102"},"_$Requires":"c14","_$xmlns:c14":"http://schemas.microsoft.com/office/drawing/2007/8/2/chart"},"mc:Fallback":{"c:style":{"_$val":"2"}},"_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006"},"c:chart":{"c:title":{"c:tx":{"c:rich":{"a:bodyPr":{"_$rot":"0","_$spcFirstLastPara":"1","_$vertOverflow":"ellipsis","_$vert":"horz","_$wrap":"square","_$anchor":"ctr","_$anchorCtr":"1"},"a:lstStyle":"","a:p":{"a:pPr":{"a:defRPr":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"65000"},"a:lumOff":{"_$val":"35000"},"_$val":"tx1"}},"a:latin":{"_$typeface":"+mn-lt"},"a:ea":{"_$typeface":"+mn-ea"},"a:cs":{"_$typeface":"+mn-cs"},"_$sz":"1400","_$b":"0","_$i":"0","_$u":"none","_$strike":"noStrike","_$kern":"1200","_$spc":"0","_$baseline":"0"}},"a:r":[{"a:rPr":{"_$lang":"zh-CN","_$altLang":"en-US"},"a:t":t.chartOption?.title?.text??""}]}}},"c:overlay":{"_$val":"0"},"c:spPr":{"a:noFill":"","a:ln":{"a:noFill":""},"a:effectLst":""}},"c:autoTitleDeleted":{"_$val":"0"},"c:plotArea":e,"c:legend":{"c:legendPos":{"_$val":null!=t.chartOption?.legend?.bottom?"b":"t"},"c:overlay":{"_$val":"0"},"c:spPr":{"a:noFill":"","a:ln":{"a:noFill":""},"a:effectLst":""},"c:txPr":{"a:bodyPr":{"_$rot":"0","_$spcFirstLastPara":"1","_$vertOverflow":"ellipsis","_$vert":"horz","_$wrap":"square","_$anchor":"ctr","_$anchorCtr":"1"},"a:lstStyle":"","a:p":{"a:pPr":{"a:defRPr":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"65000"},"a:lumOff":{"_$val":"35000"},"_$val":"tx1"}},"a:latin":{"_$typeface":"+mn-lt"},"a:ea":{"_$typeface":"+mn-ea"},"a:cs":{"_$typeface":"+mn-cs"},"_$sz":Math.round(75*(t.chartOption?.legend?.textStyle?.fontSize??14)),"_$b":"0","_$i":"0","_$u":"none","_$strike":"noStrike","_$kern":"1200","_$baseline":"0"}},"a:endParaRPr":{"_$lang":"zh-CN"}}}},"c:plotVisOnly":{"_$val":"1"},"c:dispBlanksAs":{"_$val":"gap"},"c:showDLblsOverMax":{"_$val":"0"}},"c:spPr":{"a:solidFill":{"a:schemeClr":{"_$val":"bg1"}},"a:ln":{"a:solidFill":{"a:schemeClr":{"a:lumMod":{"_$val":"15000"},"a:lumOff":{"_$val":"85000"},"_$val":"tx1"}},"a:round":"","_$w":"9525","_$cap":"flat","_$cmpd":"sng","_$algn":"ctr"},"a:effectLst":""},"c:txPr":{"a:bodyPr":"","a:lstStyle":"","a:p":{"a:pPr":{"a:defRPr":""},"a:endParaRPr":{"_$lang":"zh-CN"}}},"c:printSettings":{"c:headerFooter":"","c:pageMargins":{"_$b":"0.75","_$l":"0.7","_$r":"0.7","_$t":"0.75","_$header":"0.3","_$footer":"0.3"},"c:pageSetup":""},"_$xmlns:c":"http://schemas.openxmlformats.org/drawingml/2006/chart","_$xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$xmlns:c16r2":"http://schemas.microsoft.com/office/drawing/2015/06/chart"}}const tV=Object.fromEntries(Object.entries({sunburst:'<cs:chartStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" id="381"><cs:axisTitle><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:axisTitle><cs:categoryAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:categoryAxis><cs:chartArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="bg1"/></a:solidFill><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="1000"/></cs:chartArea><cs:dataLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="lt1"/></cs:fontRef><cs:defRPr sz="900"/></cs:dataLabel><cs:dataLabelCallout><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="25000"/><a:lumOff val="75000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/><cs:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="clip" horzOverflow="clip" vert="horz" wrap="square" lIns="36576" tIns="18288" rIns="36576" bIns="18288" anchor="ctr" anchorCtr="1"><a:spAutoFit/></cs:bodyPr></cs:dataLabelCallout><cs:dataPoint><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="19050"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPoint><cs:dataPoint3D><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint3D><cs:dataPointLine><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointLine><cs:dataPointMarker><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPointMarker><cs:dataPointMarkerLayout symbol="circle" size="5"/><cs:dataPointWireframe><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointWireframe><cs:dataTable><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:dataTable><cs:downBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:downBar><cs:dropLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:dropLine><cs:errorBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:errorBar><cs:floor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:floor><cs:gridlineMajor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMajor><cs:gridlineMinor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMinor><cs:hiLoLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="75000"/><a:lumOff val="25000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:hiLoLine><cs:leaderLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:leaderLine><cs:legend><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:legend><cs:plotArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea><cs:plotArea3D mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea3D><cs:seriesAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:seriesAxis><cs:seriesLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat"><a:solidFill><a:srgbClr val="D9D9D9"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:seriesLine><cs:title><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="1400"/></cs:title><cs:trendline><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="19050" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="sysDash"/></a:ln></cs:spPr></cs:trendline><cs:trendlineLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:trendlineLabel><cs:upBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:upBar><cs:valueAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:valueAxis><cs:wall><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:wall></cs:chartStyle>',treemap:'<cs:chartStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" id="410"><cs:axisTitle><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="bg1"><a:lumMod val="65000"/></a:schemeClr></a:solidFill><a:ln w="19050"><a:solidFill><a:schemeClr val="bg1"/></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:axisTitle><cs:categoryAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:categoryAxis><cs:chartArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="bg1"/></a:solidFill><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="1000"/></cs:chartArea><cs:dataLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="lt1"/></cs:fontRef><cs:defRPr sz="900"/></cs:dataLabel><cs:dataLabelCallout><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="25000"/><a:lumOff val="75000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/><cs:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="clip" horzOverflow="clip" vert="horz" wrap="square" lIns="36576" tIns="18288" rIns="36576" bIns="18288" anchor="ctr" anchorCtr="1"><a:spAutoFit/></cs:bodyPr></cs:dataLabelCallout><cs:dataPoint><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="19050"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPoint><cs:dataPoint3D><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint3D><cs:dataPointLine><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointLine><cs:dataPointMarker><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPointMarker><cs:dataPointMarkerLayout symbol="circle" size="5"/><cs:dataPointWireframe><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointWireframe><cs:dataTable><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:dataTable><cs:downBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:downBar><cs:dropLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:dropLine><cs:errorBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:errorBar><cs:floor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:floor><cs:gridlineMajor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMajor><cs:gridlineMinor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMinor><cs:hiLoLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="75000"/><a:lumOff val="25000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:hiLoLine><cs:leaderLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:leaderLine><cs:legend><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:legend><cs:plotArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea><cs:plotArea3D mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea3D><cs:seriesAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:seriesAxis><cs:seriesLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat"><a:solidFill><a:srgbClr val="D9D9D9"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:seriesLine><cs:title><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="1400"/></cs:title><cs:trendline><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="19050" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="sysDash"/></a:ln></cs:spPr></cs:trendline><cs:trendlineLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:trendlineLabel><cs:upBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:upBar><cs:valueAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:valueAxis><cs:wall><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:wall></cs:chartStyle>',histogram:'<cs:chartStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" id="366"><cs:axisTitle><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:axisTitle><cs:categoryAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:categoryAxis><cs:chartArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="bg1"/></a:solidFill><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="1000"/></cs:chartArea><cs:dataLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:dataLabel><cs:dataLabelCallout><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="25000"/><a:lumOff val="75000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/><cs:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="clip" horzOverflow="clip" vert="horz" wrap="square" lIns="36576" tIns="18288" rIns="36576" bIns="18288" anchor="ctr" anchorCtr="1"><a:spAutoFit/></cs:bodyPr></cs:dataLabelCallout><cs:dataPoint><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint><cs:dataPoint3D><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint3D><cs:dataPointLine><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointLine><cs:dataPointMarker><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPointMarker><cs:dataPointMarkerLayout symbol="circle" size="5"/><cs:dataPointWireframe><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointWireframe><cs:dataTable><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:dataTable><cs:downBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:downBar><cs:dropLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:dropLine><cs:errorBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:errorBar><cs:floor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:floor><cs:gridlineMajor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMajor><cs:gridlineMinor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMinor><cs:hiLoLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="75000"/><a:lumOff val="25000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:hiLoLine><cs:leaderLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:leaderLine><cs:legend><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:legend><cs:plotArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea><cs:plotArea3D mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea3D><cs:seriesAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:seriesAxis><cs:seriesLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat"><a:solidFill><a:srgbClr val="D9D9D9"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:seriesLine><cs:title><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="1400"/></cs:title><cs:trendline><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="19050" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="sysDash"/></a:ln></cs:spPr></cs:trendline><cs:trendlineLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:trendlineLabel><cs:upBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:upBar><cs:valueAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:valueAxis><cs:wall><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:wall></cs:chartStyle>',funnel:'<cs:chartStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" id="419"><cs:axisTitle><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:axisTitle><cs:categoryAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:categoryAxis><cs:chartArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="bg1"/></a:solidFill><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="1000"/></cs:chartArea><cs:dataLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:dataLabel><cs:dataLabelCallout><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="25000"/><a:lumOff val="75000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/><cs:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="clip" horzOverflow="clip" vert="horz" wrap="square" lIns="36576" tIns="18288" rIns="36576" bIns="18288" anchor="ctr" anchorCtr="1"><a:spAutoFit/></cs:bodyPr></cs:dataLabelCallout><cs:dataPoint><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint><cs:dataPoint3D><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint3D><cs:dataPointLine><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointLine><cs:dataPointMarker><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPointMarker><cs:dataPointMarkerLayout symbol="circle" size="5"/><cs:dataPointWireframe><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointWireframe><cs:dataTable><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:dataTable><cs:downBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:downBar><cs:dropLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:dropLine><cs:errorBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:errorBar><cs:floor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:floor><cs:gridlineMajor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMajor><cs:gridlineMinor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMinor><cs:hiLoLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="75000"/><a:lumOff val="25000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:hiLoLine><cs:leaderLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:leaderLine><cs:legend><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:legend><cs:plotArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea><cs:plotArea3D mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea3D><cs:seriesAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:seriesAxis><cs:seriesLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat"><a:solidFill><a:srgbClr val="D9D9D9"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:seriesLine><cs:title><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="1400"/></cs:title><cs:trendline><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="19050" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="sysDash"/></a:ln></cs:spPr></cs:trendline><cs:trendlineLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:trendlineLabel><cs:upBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:upBar><cs:valueAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:valueAxis><cs:wall><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:wall></cs:chartStyle>',waterfall:'<cs:chartStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" id="395"><cs:axisTitle><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:axisTitle><cs:categoryAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:categoryAxis><cs:chartArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="bg1"/></a:solidFill><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="1000"/></cs:chartArea><cs:dataLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:dataLabel><cs:dataLabelCallout><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="25000"/><a:lumOff val="75000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/><cs:bodyPr rot="0" spcFirstLastPara="1" vertOverflow="clip" horzOverflow="clip" vert="horz" wrap="square" lIns="36576" tIns="18288" rIns="36576" bIns="18288" anchor="ctr" anchorCtr="1"><a:spAutoFit/></cs:bodyPr></cs:dataLabelCallout><cs:dataPoint><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint><cs:dataPoint3D><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill></cs:spPr></cs:dataPoint3D><cs:dataPointLine><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointLine><cs:dataPointMarker><cs:lnRef idx="0"/><cs:fillRef idx="0"><cs:styleClr val="auto"/></cs:fillRef><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="lt1"/></a:solidFill></a:ln></cs:spPr></cs:dataPointMarker><cs:dataPointMarkerLayout symbol="circle" size="5"/><cs:dataPointWireframe><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="28575" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointWireframe><cs:dataTable><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:dataTable><cs:downBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="dk1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:downBar><cs:dropLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:dropLine><cs:errorBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:errorBar><cs:floor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:floor><cs:gridlineMajor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMajor><cs:gridlineMinor><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMinor><cs:hiLoLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="75000"/><a:lumOff val="25000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:hiLoLine><cs:leaderLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="35000"/><a:lumOff val="65000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:leaderLine><cs:legend><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:legend><cs:plotArea mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea><cs:plotArea3D mods="allowNoFillOverride allowNoLineOverride"><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:plotArea3D><cs:seriesAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz="900"/></cs:seriesAxis><cs:seriesLine><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="9525" cap="flat"><a:solidFill><a:srgbClr val="D9D9D9"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:seriesLine><cs:title><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="1400"/></cs:title><cs:trendline><cs:lnRef idx="0"><cs:styleClr val="auto"/></cs:lnRef><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef><cs:spPr><a:ln w="19050" cap="rnd"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="sysDash"/></a:ln></cs:spPr></cs:trendline><cs:trendlineLabel><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:trendlineLabel><cs:upBar><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="dk1"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val="lt1"/></a:solidFill><a:ln w="9525"><a:solidFill><a:schemeClr val="tx1"><a:lumMod val="15000"/><a:lumOff val="85000"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:upBar><cs:valueAxis><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"><a:lumMod val="65000"/><a:lumOff val="35000"/></a:schemeClr></cs:fontRef><cs:defRPr sz="900"/></cs:valueAxis><cs:wall><cs:lnRef idx="0"/><cs:fillRef idx="0"/><cs:effectRef idx="0"/><cs:fontRef idx="minor"><a:schemeClr val="tx1"/></cs:fontRef></cs:wall></cs:chartStyle>'}).map(([t,e])=>[t,DD.parser.parse(e)])),eV=DD.parser.parse('<cs:colorStyle xmlns:cs="http://schemas.microsoft.com/office/drawing/2012/chartStyle" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" meth="cycle" id="10"><a:schemeClr val="accent1"/><a:schemeClr val="accent2"/><a:schemeClr val="accent3"/><a:schemeClr val="accent4"/><a:schemeClr val="accent5"/><a:schemeClr val="accent6"/><cs:variation/><cs:variation><a:lumMod val="60000"/></cs:variation><cs:variation><a:lumMod val="80000"/><a:lumOff val="20000"/></cs:variation><cs:variation><a:lumMod val="80000"/></cs:variation><cs:variation><a:lumMod val="60000"/><a:lumOff val="40000"/></cs:variation><cs:variation><a:lumMod val="50000"/></cs:variation><cs:variation><a:lumMod val="70000"/><a:lumOff val="30000"/></cs:variation><cs:variation><a:lumMod val="70000"/></cs:variation><cs:variation><a:lumMod val="50000"/><a:lumOff val="50000"/></cs:variation></cs:colorStyle>');function nV(t,e){if("string"!=typeof e)return"";if(!e.includes("!"))return e;const[n,i]=e.split("!"),r=n.replaceAll("'",""),o=t.getSheet(r);if(!o)return"";const a=i.replaceAll("$","");if(a.includes(":")){const t=a.split(":")[0];return o.getCell(t).calcVal}return o.getCell(a).calcVal}function iV(t){return{"_$pos":"t","_$align":"ctr","_$overlay":"0","cx:tx":{"cx:txData":{"cx:v":t}},"cx:txPr":{"a:bodyPr":{"_$spcFirstLastPara":"1","_$vertOverflow":"ellipsis","_$horzOverflow":"overflow","_$wrap":"square","_$lIns":"0","_$tIns":"0","_$rIns":"0","_$bIns":"0","_$anchor":"ctr","_$anchorCtr":"1"},"a:lstStyle":"","a:p":{"a:pPr":{"_$algn":"ctr","_$rtl":"0","a:defRPr":""},"a:r":[{"a:rPr":{"_$lang":"zh-CN","_$altLang":"en-US","_$sz":"1400","_$b":"0","_$i":"0","_$u":"none","_$strike":"noStrike","_$baseline":"0","a:solidFill":{"a:sysClr":{"_$val":"windowText","_$lastClr":"000000","a:lumMod":{"_$val":"65000"},"a:lumOff":{"_$val":"35000"}}},"a:latin":{"_$typeface":"Calibri"},"a:ea":{"_$typeface":"宋体","_$panose":"02010600030101010101","_$pitchFamily":"2","_$charset":"-122"}},"a:t":t}]}}}}function rV(t){const e=new Date(`1970-01-01 ${t}`);return`TIME(${e.getHours()},${e.getMinutes()},${e.getSeconds()})`}function oV(t){const e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),o=e.getHours(),a=e.getMinutes(),s=e.getSeconds();if(o||a||s){const t=t=>String(t).padStart(2,"0");return`""${n}/${t(i)}/${t(r)} ${t(o)}:${t(a)}:${t(s)}""`}return`DATE(${n},${i},${r})`}function aV(t){return`'${String(t??"").replace(/'/g,"''")}'`}function sV(t,e){if(!t)return"";const n=[];if(void 0!==t.fo&&e.fonts[t.fo]){const i=e.fonts[t.fo];i.name&&n.push(`font-family:'${i.name}'`),i.size&&n.push(`font-size:${i.size}pt`),i.bold&&n.push("font-weight:bold"),i.italic&&n.push("font-style:italic"),i.color&&n.push(`color:${i.color}`),i.strike&&n.push("text-decoration:line-through"),i.underline&&n.push("text-decoration:underline")}if(void 0!==t.fi&&e.fills[t.fi]){const i=e.fills[t.fi];i.color&&n.push(`background-color:${i.color}`)}if(void 0!==t.a&&e.aligns[t.a]){const i=e.aligns[t.a];if(i.horizontal&&n.push(`text-align:${i.horizontal}`),i.vertical){const t="center"===i.vertical?"middle":i.vertical;n.push(`vertical-align:${t}`)}i.wrapText&&n.push("white-space:normal;word-wrap:break-word")}if(void 0!==t.b&&e.borders[t.b]){const i=e.borders[t.b];["top","right","bottom","left"].forEach(t=>{if(i[t]){const e=i[t],r="thin"===e.style?"1px":"medium"===e.style?"2px":"thick"===e.style?"3px":"1px",o=e.color||"#000";n.push(`border-${t}:${r} solid ${o}`)}})}return n.join(";")}function lV(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}class cV{constructor(t){this.$=t}async import(t){const e=this.$;if(!t)return;const n="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||t.name.toLowerCase().endsWith(".xlsx"),i="text/csv"===t.type||t.name.toLowerCase().endsWith(".csv"),r="application/json"===t.type||t.name.toLowerCase().endsWith(".json");if(!n&&!i&&!r)return e.Utils.toast(e.t("core.iO.iO.toast.xlsxCsvJson"));if(!e.License.isActivated&&t.size>1048576)return e.Utils.toast(e.t("core.iO.iO.toast.importSizeLimit",{sizeMB:(t.size/1024/1024).toFixed(2)}));if(i)await this.wx(t);else if(r)await this.xx(t);else if(n)try{const n=new FileReader;n.onload=t=>{e.Xml.Sg=[];const n=new SB;n.load(t.target.result),e.Xml.obj=n.files,e.$x()},n.readAsArrayBuffer(t),e.workbookName=t?.name?.replace(/\.[^/.]+$/,"")||e.t("workbook.defaultName")}catch(t){e.Utils.toast(e.t("core.iO.iO.toast.importUnexpectedError",{message:t.message}))}}async importFromUrl(t){const e=this.$;try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch file: ${n.status} ${n.statusText}`);const i=t.split("/"),r=i[i.length-1].split("?")[0]||"imported.xlsx",o=r.toLowerCase();if(!o.endsWith(".xlsx")&&!o.endsWith(".csv")&&!o.endsWith(".json"))return e.Utils.toast(e.t("core.iO.iO.toast.xlsxCsvJson003"));const a=await n.arrayBuffer(),s=o.endsWith(".csv")?"text/csv":o.endsWith(".json")?"application/json":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",l=new Blob([a],{type:s}),c=new File([l],r,{type:s});await this.import(c)}catch(t){const n=t.message.toLowerCase();n.includes("cors")||n.includes("cross-origin")||n.includes("failed to fetch")||"TypeError"===t.name&&n.includes("fetch")?e.Utils.toast(e.t("core.iO.iO.toast.cors")):e.Utils.toast(e.t("core.iO.iO.toast.importFromUrlFailed",{message:t.message}))}}export(t){const e=this.$;let n=0;for(const i of e.sheets)i.J(),n+=i.rowCount*i.colCount;if(!e.License.isActivated&&n>1e4)return e.Utils.toast(e.t("core.iO.iO.toast.exportCellLimit",{totalCells:n}));"CSV"===t?this.Mx():"JSON"===t?this.Cx():"HTML"===t?this.Sx():this.Rx()}exportAllImage(){const t=this.$,e=new SB;let n=0;for(const o of t.sheets){o.J();for(const t of o.Drawing.getAll())if("image"===t.type){const i=t.imageBase64;if(!i)continue;const r=t.imageSuffix||"png",a=i.split(",")[1];e.file(`${o.name}_${++n}.${r}`,a,{base64:!0})}}if(0===n)return t.Utils.toast(t.t("core.iO.iO.toast.msg005"));const i=e.generate({type:"blob"}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download=`${t.workbookName||"工作簿"}_images.zip`,r.click(),URL.revokeObjectURL(r.href),r.remove()}}Object.assign(cV.prototype,{getData:Mz,setData:Az,Cx:async function(){const t=this.$,e=await Mz.call(this),n=JSON.stringify(e),i=new Blob([n],{type:"application/json"});oz.saveAs(i,`${t.workbookName}.json`)},xx:async function(t){const e=this.$;try{const n=await t.text(),i=JSON.parse(n);Az.call(this,i)&&e.Utils.toast(e.t("core.iO.jsonIO.toast.json"))}catch(t){e.Utils.toast(e.t("core.iO.jsonIO.toast.importFailed",{message:t.message}))}},Mx:async function(){const t=this.$,e=(await Mz.call(this)).sheets.find(e=>e.name===t.activeSheet.name);if(!e||!e.rows||0===e.rows.length){const e=new Blob([""],{type:"text/csv;charset=utf-8;"});return void oz.saveAs(e,`${t.workbookName}.csv`)}let n=0,i=0;e.rows.forEach(t=>{n=Math.max(n,t.rIndex),t.cells.forEach(t=>{i=Math.max(i,t.c)})});const r=[];for(let s=0;s<=n;s++){const t=e.rows.find(t=>t.rIndex===s),n=[];for(let e=0;e<=i;e++){let i="";if(t){const n=t.cells.find(t=>t.c===e);n&&(void 0!==n.cv&&null!==n.cv?i=String(n.cv):void 0!==n.v&&null!==n.v?i=String(n.v):n.f&&(i=n.f))}(i.includes(",")||i.includes('"')||i.includes("\n")||i.includes("\r"))&&(i='"'+i.replace(/"/g,'""')+'"'),n.push(i)}r.push(n.join(","))}const o=r.join("\r\n"),a=new Blob(["\ufeff"+o],{type:"text/csv;charset=utf-8;"});oz.saveAs(a,`${t.workbookName}.csv`)},wx:async function(t){const e=this.$;try{const n=await function(t){return new Promise((e,n)=>{const i=new FileReader;i.onload=t=>{let n=t.target.result;65279===n.charCodeAt(0)&&(n=n.slice(1)),e(n)},i.onerror=n,i.readAsText(t,"UTF-8")})}(t),i=function(t){const e=[];let n=[],i="",r=!1;for(let o=0;o<t.length;o++){const a=t[o],s=t[o+1];if(r)'"'===a?'"'===s?(i+='"',o++):r=!1:i+=a;else if('"'===a)r=!0;else if(","===a)n.push(i),i="";else if("\r"===a){if("\n"===s)continue;n.push(i),e.push(n),n=[],i=""}else"\n"===a?(n.push(i),e.push(n),n=[],i=""):i+=a}return(i||n.length>0)&&n.push(i),n.length>0&&e.push(n),e}(n);if(0===i.length)return void e.Utils.toast(e.t("core.iO.csvIO.toast.csv"));const r=function(t,e="Sheet1"){const n=t.length,i=Math.max(...t.map(t=>t.length),0),r=[];return t.forEach((t,e)=>{const n={rIndex:e,h:0,cells:[]};t.forEach((t,e)=>{if(""!==t){const i={c:e};!function(t){if(""===t.trim())return!1;if(/^0\d+/.test(t))return!1;const e=Number(t);return!isNaN(e)&&isFinite(e)}(t)?i.v=t:i.v=Number(t),n.cells.push(i)}}),n.cells.length>0&&r.push(n)}),{version:"2.0",workbookName:e,activeSheet:e,styleTable:{fonts:[],fills:[],borders:[],aligns:[]},sizeTable:{rowHeights:[21],colWidths:[72]},sheets:[{name:e,hidden:!1,showGridLines:!0,showRowColHeaders:!0,frozenCols:0,frozenRows:0,defaultColWidth:72,defaultRowHeight:21,rowCount:Math.max(n,200),colCount:Math.max(i,32),cols:[],rows:r,merges:[],drawings:[]}]}}(i,t.name.replace(/\.[^/.]+$/,"")||"Sheet1");Az.call(this,r)&&e.Utils.toast(e.t("core.iO.csvIO.toast.csv003"))}catch(t){e.Utils.toast(e.t("core.iO.csvIO.toast.importFailed",{message:t.message}))}},Rx:function(){const t=this.$,e=t.o=new DD(t),n=t.Xml?.obj?.["xl/theme/theme1.xml"];n&&(e.obj["xl/theme/theme1.xml"]=JSON.parse(JSON.stringify(n))),e.sst;const i=t.Xml?.styleSheet?.dxfs?.dxf,r=Array.isArray(i)?i:i?[i]:[],o=new Map;let a=0,s=0,l=0,c=0;const h=function(t){const e=t.obj["xl/workbook.xml"];let n=e.workbook;n.definedNames||(n.definedNames={definedName:[]});const i=Array.isArray(n.definedNames.definedName)?n.definedNames.definedName:n.definedNames.definedName?[n.definedNames.definedName]:[];n.definedNames.definedName=i;const r=Object.keys(n),o=r.indexOf("calcPr"),a=r.indexOf("definedNames");if(-1!==o&&-1!==a&&a>o){const t={};for(const e of r)"calcPr"!==e?"definedNames"!==e&&(t[e]=n[e]):(t.definedNames=n.definedNames,t.calcPr=n.calcPr);t.definedNames||(t.definedNames=n.definedNames),e.workbook=t,n=t}let s=0;i.forEach(t=>{const e=t?._$name,n="string"==typeof e?e.match(/^_xlchart\.v(\d+)\./):null;if(n){const t=Number(n[1]);Number.isFinite(t)&&(s=Math.max(s,t))}});let l=s+1;return{nextPrefix:()=>"_xlchart.v"+l++,addDefinedName(t,e){i.push({"_$name":t,"_$hidden":"1","#text":e})}}}(e),u=t=>{if(!Number.isInteger(t)||t<0)return;if(o.has(t))return o.get(t);const n=r[t];if(!n)return;e.styleSheet.dxfs||(e.styleSheet.dxfs={"_$count":"0"}),e.styleSheet.dxfs.dxf?Array.isArray(e.styleSheet.dxfs.dxf)||(e.styleSheet.dxfs.dxf=[e.styleSheet.dxfs.dxf]):e.styleSheet.dxfs.dxf=[];const i=e.styleSheet.dxfs.dxf,a=i.length;return i.push(JSON.parse(JSON.stringify(n))),e.styleSheet.dxfs._$count=String(i.length),o.set(t,a),a};t.buildStyle={fills:{},fonts:{},numFmts:{},borders:{},xf:{},fillC:Number(e.styleSheet.fills._$count),fontC:Number(e.styleSheet.fonts._$count),numFmtC:164,borderC:Number(e.styleSheet.borders._$count),xfC:Number(e.styleSheet.cellXfs._$count)},t.sheets.forEach((n,i)=>{const r=`sheet${i+1}.xml`,o=e.getRelsByTarget(`worksheets/${r}`,!0);let d=e.obj[`xl/worksheets/${r}`]?.worksheet;d?e.sheets[i]._$name=n.name:d=e.addSheet(n.name,{hidden:n.hidden})?.worksheet,d.sheetViews||(d.sheetViews={sheetView:[{}]}),d.sheetViews.sheetView||(d.sheetViews.sheetView=[{}]);const f=d.sheetViews.sheetView[0]??(d.sheetViews.sheetView[0]={});f._$showGridLines=n.showGridLines?"1":"0",f._$showRowColHeaders=n.showRowColHeaders?"1":"0",f._$zoomScale=String(Math.round(100*(n.zoom??1)));const p=n.outlinePr||{},m={};p.applyStyles&&(m._$applyStyles="1"),!1===p.summaryBelow&&(m._$summaryBelow="0"),!1===p.summaryRight&&(m._$summaryRight="0"),!1===p.showOutlineSymbols&&(m._$showOutlineSymbols="0"),Object.keys(m).length>0?(d.sheetPr||(d.sheetPr={}),d.sheetPr.outlinePr=m):d.sheetPr?.outlinePr&&(delete d.sheetPr.outlinePr,0===Object.keys(d.sheetPr).length&&delete d.sheetPr),d.sheetFormatPr||(d.sheetFormatPr={});const g=Number(n.defaultColWidth);if(Number.isFinite(g)&&g>0){const t=Math.round(g/7.5*100)/100;d.sheetFormatPr._$defaultColWidth=String(t)}const v=Number(n.defaultRowHeight);if(Number.isFinite(v)&&v>0){const t=Math.round(v/1.333*100)/100;d.sheetFormatPr._$defaultRowHeight=String(t),Math.abs(t-15)>.01?d.sheetFormatPr._$customHeight="1":d.sheetFormatPr._$customHeight&&delete d.sheetFormatPr._$customHeight}d.dimension._$ref=`A1:${t.Utils.numToChar(n.cols.length-1)}${n.rows.length-1}`;const b=[];if(n.merges.forEach(e=>b.push({_$ref:t.Utils.rangeNumToStr(e)})),d.mergeCells={mergeCell:b},0==d.mergeCells.mergeCell.length&&delete d.mergeCells,n.AutoFilter){const t=n.AutoFilter.hasAnyActiveFilters?.()||n.AutoFilter.hasActiveFilters;if(n.AutoFilter.enabled){const t=n.AutoFilter.range;let e=!1;n.Table&&n.Table.size>0&&n.Table.forEach(n=>{const i=n.range;i&&t&&t.s.r>=i.s.r&&t.s.c>=i.s.c&&t.e.r<=i.e.r&&t.e.c<=i.e.c&&(e=!0)}),e||(d.AutoFilter=n.AutoFilter.buildXml())}t&&(d.sheetPr||(d.sheetPr={}),d.sheetPr._$filterMode="1")}const x=n.protection.buildXmlNode();if(x?d.sheetProtection=x:d.sheetProtection&&delete d.sheetProtection,n.frozenCols>0||n.frozenRows>0){const e={...f,"pane":{"_$xSplit":n.frozenCols,"_$ySplit":n.frozenRows,"_$topLeftCell":t.Utils.numToChar(n.frozenCols+1)+(n.frozenRows+1),"_$activePane":n.frozenCols&&n.frozenRows?"bottomRight":n.frozenCols?"topRight":n.frozenRows?"bottomLeft":"bottomRight","_$state":"frozen"},"selection":{"_$pane":n.frozenCols&&n.frozenRows?"bottomRight":n.frozenCols?"topRight":n.frozenRows?"bottomLeft":"bottomRight"},"_$workbookViewId":"0"};d.sheetViews={sheetView:[e]}}d.cols={col:[]},n.cols.forEach(e=>{if(!e.$t)return;const n={"_$min":e.cIndex+1,"_$max":e.cIndex+1,"_$width":e.width/7.5,"_$hidden":e.hidden?"1":"0","_$customWidth":"1"};if(e.outlineLevel>0&&(n._$outlineLevel=String(e.outlineLevel)),e.collapsed&&(n._$collapsed="1"),e.xt){const i=y(e.xt,t);null!=i&&(n._$style=i)}d.cols.col.push(n)}),0==d.cols.col.length&&delete d.cols,d.sheetData={row:[]},n.rows.forEach(e=>{if(!e.$t)return;const i={"c":e.cells.filter(t=>t?.$t).map(t=>{const e=t.buildXml;if(t.hyperlink)if(d.hyperlinks||(d.hyperlinks={hyperlink:[]}),t.hyperlink.location)d.hyperlinks.hyperlink.push({"_$ref":e._$r,"_$location":t.hyperlink.location});else{const n=`rId${o.length+1}`;o.push({"_$Id":n,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink","_$Target":t.hyperlink.target,"_$TargetMode":"External"}),d.hyperlinks.hyperlink.push({"_$ref":e._$r,"_$r:id":n})}if(t._){const n=t._;d.dataValidations||(d.dataValidations={dataValidation:[]});const i={"formula1":n.formula1,"formula2":n.formula2,"_$type":n.type,"_$errorStyle":n.errorStyle,"_$showDropDown":n.showDropDown?null:1,"_$allowBlank":n.allowBlank?1:null,"_$showInputMessage":n.showInputMessage?1:null,"_$showErrorMessage":n.showErrorMessage?1:null,"_$errorTitle":n.errorTitle,"_$error":n.error,"_$promptTitle":n.promptTitle,"_$prompt":n.prompt,"_$operator":n.operator,"_$sqref":e._$r};"list"==i._$type&&(i.formula1=`"${i.formula1.join(",")}"`),"date"===i._$type&&(i.formula1=oV(i.formula1),i.formula2&&(i.formula2=oV(i.formula2))),"time"===i._$type&&(i.formula1=rV(i.formula1),i.formula2&&(i.formula2=rV(i.formula2))),d.dataValidations.dataValidation.push(i)}return e}),"_$hidden":e.hidden?"1":"0","_$r":e.rIndex+1};if(e.outlineLevel>0&&(i._$outlineLevel=String(e.outlineLevel)),e.collapsed&&(i._$collapsed="1"),e.height!==n.defaultRowHeight&&(i._$customHeight="1",i._$ht=e.height/1.333),e.wt){const n=y(e.wt,t);null!=n&&(i._$s=n,i._$customFormat="1")}d.sheetData.row.push(i)}),d.dataValidations?.dataValidation?.length&&(d.dataValidations._$count=String(d.dataValidations.dataValidation.length)),t.Print?.applySettingsToWorksheet&&t.Print.applySettingsToWorksheet(n,d);const w=n.Drawing.getAll(),S=w.filter(t=>"slicer"!==t.type),C=w.filter(t=>"slicer"===t.type);if(S.length>0||C.length>0){const n=`rId${o.length+1}`;a++;const i=`drawing${a}.xml`;o.push({"_$Id":n,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing","_$Target":`../drawings/${i}`}),d.drawing={"_$r:id":n};const r=[],u=(t,e)=>{t._$editAs="oneCell"===e?"oneCell":"absolute"===e?"absolute":"twoCell"},f=e=>({fromNode:{"xdr:col":e.area.s.c,"xdr:colOff":t.Utils.pxToEmu(e.area.s.offsetX),"xdr:row":e.area.s.r,"xdr:rowOff":t.Utils.pxToEmu(e.area.s.offsetY)},toNode:{"xdr:col":e.area.e.c,"xdr:colOff":t.Utils.pxToEmu(e.area.e.offsetX),"xdr:row":e.area.e.r,"xdr:rowOff":t.Utils.pxToEmu(e.area.e.offsetY)}}),p=S.map((n,i)=>{const{fromNode:o,toNode:a}=f(n),d={"xdr:from":o,"xdr:to":a};if(u(d,n.anchorType),d.__anchorType=n.anchorType,"chart"==n.type){const o=function(t){const e=t.chartOption||{},n=Array.isArray(e.series)?e.series:[],i=e.__chartType||(e.__histogram?"histogram":null),r=n.find(t=>["sunburst","treemap","funnel"].includes(t?.type))?.type,o=i||r;if(!["sunburst","treemap","funnel","waterfall","histogram"].includes(o))return null;const a=e.__excelRef;return a?.categories&&Array.isArray(a.series)&&0!==a.series.length?{type:o,categories:a.categories,series:a.series,chartOption:e,hiddenFlags:e.__excelHidden,histogram:e.__histogram}:null}(n);if(o){const n="chartEx"+ ++l;d["xdr:graphicFrame"]=function(t){return{"xdr:nvGraphicFramePr":{"xdr:cNvPr":{"_$id":t+1,"_$name":`图表 ${t+1}`},"xdr:cNvGraphicFramePr":""},"xdr:xfrm":{"a:off":{"_$x":"0","_$y":"0"},"a:ext":{"_$cx":"0","_$cy":"0"}},"a:graphic":{"a:graphicData":{"_$uri":"http://schemas.microsoft.com/office/drawing/2014/chartex","cx:chart":{"_$xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$r:id":"rId"+(t+1)}}},"_$macro":""}}(i),r.push({"_$Id":"rId"+(i+1),"_$Type":"http://schemas.microsoft.com/office/2014/relationships/chartEx","_$Target":`../charts/${n}.xml`}),e.obj[`xl/charts/${n}.xml`]=function(t,e,n,i){const r=n.chartOption||{},o=i.nextPrefix(),a=new Map;let s=0;const l=t=>{if(a.has(t))return a.get(t);const e=`${o}.${s++}`;return i.addDefinedName(e,t),a.set(t,e),e},c=function(t,e,n,i){const r="histogram"===t.type?"clusteredColumn":t.type,o="histogram"===t.type,a="sunburst"===r||"treemap"===r,s=Array.isArray(t.hiddenFlags)?t.hiddenFlags:null;let l=null;return"treemap"===r?l={"_$pos":"inEnd","cx:visibility":{"_$seriesName":"0","_$categoryName":"1","_$value":"0"}}:"sunburst"===r?l={"_$pos":"ctr","cx:visibility":{"_$seriesName":"0","_$categoryName":"1","_$value":"0"}}:"waterfall"===r?l={"_$pos":"outEnd","cx:visibility":{"_$seriesName":"0","_$categoryName":"0","_$value":"1"}}:o||(l={"cx:visibility":{"_$seriesName":"0","_$categoryName":"0","_$value":"1"}}),e.map((e,c)=>{const h=n(e.name),u=n(e.data),d={"_$layoutId":r,"_$uniqueId":`{${LB()}}`,"_$formatIdx":String(c),"cx:tx":{"cx:txData":{"cx:f":h,"cx:v":String(nV(i,e.name)??"")}}};if(l&&(d["cx:dataLabels"]=l),d["cx:dataId"]={"_$val":String(c)},"treemap"===r&&(d["cx:layoutPr"]={"cx:parentLabelLayout":{"_$val":"overlapping"}}),"waterfall"===r&&(d["cx:layoutPr"]={"cx:subtotals":""}),o){const e=t.histogram?.intervalClosed||"r";d["cx:layoutPr"]={"cx:binning":{"_$intervalClosed":e}}}return(s?s[c]:c>0)&&(d._$hidden="1"),{series:d,dataRef:u,useSize:a}})}(n,n.series,l,t),h=l(n.categories),u={"cx:data":c.map((t,e)=>({"_$id":String(e),"cx:strDim":{"_$type":"cat","cx:f":{"_$dir":"row","#text":h}},"cx:numDim":{"_$type":t.useSize?"size":"val","cx:f":{"_$dir":"row","#text":t.dataRef}}}))},d={"cx:plotAreaRegion":{"cx:series":c.map(t=>t.series)}};"funnel"===n.type?d["cx:axis"]={"_$id":"0","cx:catScaling":{"_$gapWidth":"0.0599999987"},"cx:tickLabels":""}:"waterfall"===n.type?d["cx:axis"]=[{"_$id":"0","cx:catScaling":{"_$gapWidth":"0.5"},"cx:tickLabels":""},{"_$id":"1","cx:valScaling":"","cx:majorGridlines":"","cx:tickLabels":""}]:"histogram"===n.type&&(d["cx:axis"]=[{"_$id":"0","cx:catScaling":{"_$gapWidth":"0"},"cx:tickLabels":""},{"_$id":"1","cx:valScaling":"","cx:majorGridlines":"","cx:tickLabels":""}]);const f=r?.title?.text??"",p=function(t){if(!1===t?.show)return null;let e="b";return null!=t?.top&&(e="t"),null!=t?.left&&(e="l"),null!=t?.right&&(e="r"),{"_$pos":e,"_$align":"ctr","_$overlay":"0"}}(r.legend),m={"cx:title":iV(f),"cx:plotArea":d};return p&&(m["cx:legend"]=p),{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"cx:chartSpace":{"_$xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","cx:chartData":u,"cx:chart":m}}}(t,0,o,h),e.obj[`xl/charts/_rels/${n}.xml.rels`]=function(t){return{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":[{"_$Id":"rId1","_$Type":"http://schemas.microsoft.com/office/2011/relationships/chartStyle","_$Target":`style${t}.xml`},{"_$Id":"rId2","_$Type":"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle","_$Target":`colors${t}.xml`}],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}}}(l),e.obj[`xl/charts/style${l}.xml`]=function(t){const e=tV[t]||tV.sunburst;return JSON.parse(JSON.stringify(e))}(o.type),e.obj[`xl/charts/colors${l}.xml`]=JSON.parse(JSON.stringify(eV)),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/charts/${n}.xml`,"_$ContentType":"application/vnd.ms-office.chartex+xml"}),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/charts/style${l}.xml`,"_$ContentType":"application/vnd.ms-office.chartstyle+xml"}),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/charts/colors${l}.xml`,"_$ContentType":"application/vnd.ms-office.chartcolorstyle+xml"})}else{const o="chart"+ ++s;d["xdr:graphicFrame"]=function(t){return{"xdr:nvGraphicFramePr":{"xdr:cNvPr":{"_$id":t+1,"_$name":`图表 ${t+1}`},"xdr:cNvGraphicFramePr":""},"xdr:xfrm":{"a:off":{"_$x":"0","_$y":"0"},"a:ext":{"_$cx":"0","_$cy":"0"}},"a:graphic":{"a:graphicData":{"c:chart":{"_$xmlns:c":"http://schemas.openxmlformats.org/drawingml/2006/chart","_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$r:id":"rId"+(t+1)},"_$uri":"http://schemas.openxmlformats.org/drawingml/2006/chart"}},"_$macro":""}}(i),r.push({"_$Id":"rId"+(i+1),"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart","_$Target":`../charts/${o}.xml`}),e.obj[`xl/charts/${o}.xml`]=function(t,e){const n=function(t){const e=t||{},n=Array.isArray(e.series)?e.series:[],i=Array.isArray(e.xAxis)?e.xAxis[0]:e.xAxis,r=Array.isArray(e.yAxis)?e.yAxis[0]:e.yAxis,o=[];n.forEach(t=>{if(!t||!t.type)return;const e=Array.isArray(t.data)&&Array.isArray(t.data[0]);if("line"===t.type&&e)o.push({...t,type:"scatter",__lineLike:!0});else switch(t.type){case"bar":case"line":case"pie":case"scatter":{const e=!0===t.__bubble||"function"==typeof t.symbolSize;o.push(e?{...t,__bubble:!0}:t);break}case"radar":o.push(t);break;case"candlestick":{const e=Array.isArray(t.data)?t.data.map(t=>Array.isArray(t)?t[1]:t):[];o.push({...t,type:"line",data:KB(e)});break}case"funnel":case"treemap":case"sunburst":{const e=function(t){if(!Array.isArray(t))return[];const e=[];return t.forEach((t,n)=>{if(t)if("number"!=typeof t&&"string"!=typeof t){if(Array.isArray(t)){const i=t.length>1?t[1]:t[0];return void e.push({name:`项${n+1}`,value:DB(i,0)})}if("object"==typeof t){const i=t.name??`项${n+1}`;if(Object.prototype.hasOwnProperty.call(t,"value"))return void e.push({name:i,value:DB(t.value,0)});if(Array.isArray(t.children)){const n=t.children.reduce((t,e)=>t+DB(e?.value,0),0);e.push({name:i,value:n})}}}else e.push({name:`项${n+1}`,value:DB(t,0)})}),e}(t.data);o.push({...t,type:"pie",data:e});break}default:o.push({...t,type:"bar",data:KB(t.data)})}});const a=o.flatMap(t=>"radar"!==t?.type?[t]:Array.isArray(t.data)&&0!==t.data.length&&t.data.every(t=>t&&"object"==typeof t&&!Array.isArray(t)&&Object.prototype.hasOwnProperty.call(t,"value"))?t.data.map(e=>({...t,name:e.name??t.name,data:e.value})):[t]),s=i?.data||r?.data||function(t){if(!t?.length)return[];const e=t[0];return Array.isArray(e.data)?"pie"===e.type?e.data.map((t,e)=>t?.name??`项${e+1}`):e.data.map((t,e)=>t&&"object"==typeof t&&!Array.isArray(t)?t.name??`类别${e+1}`:`类别${e+1}`):[]}(a);let l=i,c=r;return!l&&!c&&s.length>0&&(l={type:"category",data:s},c={type:"value"}),{chartOption:e,series:a,xAxis:l||{},yAxis:c||{},radar:e.radar}}(e.chartOption),i=n.chartOption,r=n.xAxis||{},o=n.yAxis||{},a=n.radar,s=n.series,l={"c:layout":""},c=function(t){const e=t.filter(t=>"radar"===t?.type);return e.some(t=>t?.areaStyle)?"filled":e.some(t=>!0===t?.showSymbol||"number"==typeof t?.symbolSize&&t.symbolSize>0&&!1!==t?.showSymbol)?"marker":"standard"}(s);let h=1e9,u=++h,d=++h;const f=LB();let p=!1;if(s.forEach((e,n)=>{if("bar"==e.type){const t="total"==e.stack,i="category"===(r.type||"category")?"col":"bar",a=t&&WB("col"===i?o:r);if(l["c:barChart"])t&&(l["c:barChart"]["c:grouping"]={"_$val":a?"percentStacked":"stacked"});else{const e=a?"0%":"General";l["c:barChart"]=jB(u,d,t,i,a),l["c:catAx"]=GB(u,d,o),l["c:valAx"]=XB(u,d,r,e)}l["c:barChart"]["c:ser"].push({"c:idx":{"_$val":n},"c:order":{"_$val":n},"c:tx":ZB(e.name,"str"),"c:invertIfNegative":{"_$val":"1"},"c:cat":ZB("col"==i?r?.data??[]:o?.data??[],"str"),"c:val":ZB(e.data,"num"),"c:extLst":zB(n,f)}),p=!0}else if("line"==e.type){const t=e.areaStyle?"c:areaChart":"c:lineChart";if(l[t])e.stack&&(l[t]["c:grouping"]={"_$val":WB(o)?"percentStacked":"stacked"});else{const n=e.stack&&WB(o),i=e.stack?n?"percentStacked":"stacked":"standard";l[t]=function(t,e,n="standard"){return{"c:grouping":{"_$val":n},"c:varyColors":{"_$val":"0"},"c:ser":[],"c:dLbls":{"c:showLegendKey":{"_$val":"0"},"c:showVal":{"_$val":"0"},"c:showCatName":{"_$val":"0"},"c:showSerName":{"_$val":"0"},"c:showPercent":{"_$val":"0"},"c:showBubbleSize":{"_$val":"0"}},"c:smooth":{"_$val":"0"},"c:axId":[{"_$val":t},{"_$val":e}]}}(u,d,i),l["c:catAx"]=GB(u,d,o),l["c:valAx"]=XB(u,d,r,n?"0%":"General")}l[t]["c:ser"].push({"c:idx":{"_$val":n},"c:order":{"_$val":n},"c:tx":ZB(e.name,"str"),...OB(e),...BB(e),...VB(e)||{},"c:cat":ZB(r?.data,"str"),"c:val":ZB(e?.data,"num"),"c:smooth":{"_$val":"0"},"c:extLst":zB(n,f)}),p=!0}else if("scatter"==e.type&&e.__bubble){l["c:bubbleChart"]||(l["c:bubbleChart"]=function(t,e){return{"c:varyColors":{"_$val":"0"},"c:ser":[],"c:dLbls":{"c:showLegendKey":{"_$val":"0"},"c:showVal":{"_$val":"0"},"c:showCatName":{"_$val":"0"},"c:showSerName":{"_$val":"0"},"c:showPercent":{"_$val":"0"},"c:showBubbleSize":{"_$val":"0"}},"c:bubbleScale":{"_$val":"100"},"c:showNegBubbles":{"_$val":"0"},"c:sizeRep":{"_$val":"area"},"c:axId":[{"_$val":t},{"_$val":e}]}}(u,d),l["c:valAx"]=[YB(u,d,r,"b"),YB(d,u,o,"l")]);const t=(e.data||[]).map(t=>Array.isArray(t)?t[0]:t),i=(e.data||[]).map(t=>Array.isArray(t)?t[1]:t),a=(s=e.data||[],Array.isArray(s)?s.map(t=>{if(Array.isArray(t))return t.length>2?DB(t[2],0):t.length>1?DB(t[1],0):DB(t[0],0);if(t&&"object"==typeof t){const e=t.value;if(Array.isArray(e))return e.length>2?DB(e[2],0):e.length>1?DB(e[1],0):DB(e[0],0);if(Object.prototype.hasOwnProperty.call(t,"value"))return DB(t.value,0)}return DB(t,0)}):[]);l["c:bubbleChart"]["c:ser"].push({"c:idx":{"_$val":n},"c:order":{"_$val":n},"c:tx":ZB(e.name,"str"),"c:xVal":ZB(t,"num"),"c:yVal":ZB(i,"num"),"c:bubbleSize":ZB(a,"num"),"c:bubble3D":{"_$val":"0"},"c:extLst":zB(n,f)}),p=!0}else if("scatter"==e.type){if(l["c:scatterChart"]){const t=HB(e);"marker"!==t&&(l["c:scatterChart"]["c:scatterStyle"]={"_$val":t})}else{const t=HB(e);l["c:scatterChart"]=function(t,e,n="marker"){return{"c:scatterStyle":{"_$val":n},"c:varyColors":{"_$val":"0"},"c:ser":[],"c:axId":[{"_$val":t},{"_$val":e}]}}(u,d,t),l["c:valAx"]=[YB(u,d,r,"b"),YB(d,u,o,"l")]}const t=(e.data||[]).map(t=>Array.isArray(t)?t[0]:t),a=(e.data||[]).map(t=>Array.isArray(t)?t[1]:t),s=l["c:scatterChart"]?.["c:scatterStyle"]?._$val||"marker";l["c:scatterChart"]["c:ser"].push({"c:idx":{"_$val":n},"c:order":{"_$val":n},"c:tx":ZB(e.name,"str"),...UB(e),...qB(s,e),...(i=s,{"c:smooth":{"_$val":"smooth"===i||"smoothMarker"===i?"1":"0"}}),"c:xVal":ZB(t,"num"),"c:yVal":ZB(a,"num"),"c:extLst":zB(n,f)}),p=!0}else if("radar"==e.type){l["c:radarChart"]||(l["c:radarChart"]=function(t,e,n="standard"){return{"c:radarStyle":{"_$val":n},"c:varyColors":{"_$val":"0"},"c:ser":[],"c:dLbls":{"c:showLegendKey":{"_$val":"0"},"c:showVal":{"_$val":"0"},"c:showCatName":{"_$val":"0"},"c:showSerName":{"_$val":"0"},"c:showPercent":{"_$val":"0"},"c:showBubbleSize":{"_$val":"0"}},"c:axId":[{"_$val":t},{"_$val":e}]}}(u,d,c),l["c:catAx"]=GB(u,d,o),l["c:valAx"]=XB(u,d,r));const i=a?.indicator?.map(t=>t?.name)||r?.data||[],s=Array.isArray(i)?JB(t,i):i,h=Array.isArray(e.data)&&e.data[0]&&"object"==typeof e.data[0]&&!Array.isArray(e.data[0])&&Object.prototype.hasOwnProperty.call(e.data[0],"value")?e.data[0].value:e.data,m=Array.isArray(h)?JB(t,h):h;l["c:radarChart"]["c:ser"].push({"c:idx":{"_$val":n},"c:order":{"_$val":n},"c:tx":ZB(e.name,"str"),...OB(e),...BB(e),...VB(e)||{},"c:cat":ZB(s,"str"),"c:val":ZB(m,"num"),"c:extLst":zB(n,f)}),p=!0}else if("pie"==e.type){const i=Array.isArray(e.radius)?"c:doughnutChart":"c:pieChart";l["c:pieChart"]||l["c:doughnutChart"]||(l[i]=function(t){const e={"c:varyColors":{"_$val":"1"},"c:ser":{},"c:dLbls":{"c:showLegendKey":{"_$val":"0"},"c:showVal":{"_$val":"0"},"c:showCatName":{"_$val":"0"},"c:showSerName":{"_$val":"0"},"c:showPercent":{"_$val":"0"},"c:showBubbleSize":{"_$val":"0"},"c:showLeaderLines":{"_$val":"0"}},"c:firstSliceAng":{"_$val":"0"}};return Array.isArray(t.radius)&&(e["c:holeSize"]={_$val:"75"}),e}(e)),l[i]["c:ser"]={"c:idx":{"_$val":n},"c:order":{"_$val":n},"c:tx":ZB(e.name,"str"),"c:dPt":e.data.map((t,e)=>({"c:idx":{"_$val":e},"c:bubble3D":{"_$val":"0"}})),"c:cat":ZB(JB(t,e.data.map(t=>t.name)),"str"),"c:val":ZB(JB(t,e.data.map(t=>t.value)),"num"),"c:extLst":zB(n,f)},p=!0}var i,s}),!p&&s.length>0){const t=s[0];l["c:barChart"]=jB(u,d,!1,"col"),l["c:catAx"]=GB(u,d,o),l["c:valAx"]=XB(u,d,r),l["c:barChart"]["c:ser"].push({"c:idx":{"_$val":0},"c:order":{"_$val":0},"c:tx":ZB(t.name,"str"),"c:invertIfNegative":{"_$val":"1"},"c:cat":ZB(r?.data??[],"str"),"c:val":ZB(t.data??[],"num"),"c:extLst":zB(0,f)})}return{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"c:chartSpace":QB({...e,chartOption:i},l)}}(t,n),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/charts/${o}.xml`,"_$ContentType":"application/vnd.openxmlformats-officedocument.drawingml.chart+xml"})}}else if("image"==n.type){const t=`image${++c}.${n.imageSuffix}`;d["xdr:pic"]=function(t,e){const n={"a:off":{"_$x":"5381625","_$y":"590550"},"a:ext":{"_$cx":"1295238","_$cy":"1009524"}};return e&&(n._$rot=String(Math.round(6e4*e))),{"xdr:nvPicPr":{"xdr:cNvPr":{"_$id":t+1,"_$name":"图片 "+(t+1)},"xdr:cNvPicPr":{"a:picLocks":{"_$noChangeAspect":"1"}}},"xdr:blipFill":{"a:blip":{"_$xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","_$r:embed":"rId"+(t+1)},"a:stretch":{"a:fillRect":""}},"xdr:spPr":{"a:xfrm":n,"a:prstGeom":{"a:avLst":"","_$prst":"rect"}}}}(i,n.Fn),r.push({"_$Id":"rId"+(i+1),"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","_$Target":`../media/${t}`}),e.obj[`xl/media/${t}`]=n.imageBytes;const o=e.obj["[Content_Types].xml"].Types.Default;o.find(t=>t._$Extension==n.imageSuffix)||o.push({"_$Extension":n.imageSuffix,"_$ContentType":"image/"+n.imageSuffix})}else"shape"==n.type&&(n.isConnector?d["xdr:cxnSp"]=n.buildShapeXml(i):d["xdr:sp"]=n.buildShapeXml(i));return d["xdr:clientData"]="",d}),m=C.map((t,e)=>{const{fromNode:n,toNode:i}=f(t),r={"xdr:from":n,"xdr:to":i};return u(r,t.anchorType||"oneCell"),r.__anchorType=t.anchorType||"oneCell",r["mc:AlternateContent"]=function(t,e){const n=e||`Slicer_${t+1}`;return{"mc:Choice":{"_$Requires":"sle15","xdr:graphicFrame":{"xdr:nvGraphicFramePr":{"xdr:cNvPr":{"_$id":String(t+2),"_$name":n},"xdr:cNvGraphicFramePr":""},"xdr:xfrm":{"a:off":{"_$x":"0","_$y":"0"},"a:ext":{"_$cx":"0","_$cy":"0"}},"a:graphic":{"a:graphicData":{"_$uri":kB,"sle:slicer":{"_$xmlns:sle":kB,"_$name":n}}},"_$macro":""}},"_$xmlns:mc":$B,"_$xmlns:sle15":"http://schemas.microsoft.com/office/drawing/2012/slicer"}}(S.length+e,t.Slicer?.name||t.Slicer?.id||`Slicer_${e+1}`),r["xdr:clientData"]="",r}),g={"xdr:twoCellAnchor":p.concat(m).map(t=>(delete t.__anchorType,t)),"_$xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","_$xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","_$xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006"};e.obj[`xl/drawings/${i}`]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"xdr:wsDr":g},e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/drawings/${i}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.drawing+xml"}),r.length>0&&(e.obj[`xl/drawings/_rels/${i}.rels`]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":r,"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}})}if(n.Sparkline&&n.Sparkline.groups.length>0){const t=n.Sparkline.toXmlObj();t&&(d.extLst=t)}if(n.Comment&&n.Comment.map.size>0){const t=n.Comment.toXmlObject();if(t){const r=`comments${i+1}.xml`,a=`vmlDrawing${i+1}.vml`;e.obj[`xl/${r}`]=t,e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/${r}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"});const s=function(t){if(!t||0===t.length)return null;const e=t.map((t,e)=>{const{cellRef:n,visible:i,width:r,height:o,marginLeft:a,marginTop:s}=t;return{"_$id":`_x0000_s${1026+e}`,"_$type":"#_x0000_t202","_$style":`position:absolute;margin-left:${a}pt;margin-top:${s}pt;width:${r}pt;height:${o}pt;z-index:1;visibility:${i?"visible":"hidden"}`,"_$fillcolor":"#ffffe1","_$strokecolor":"#000000","v:fill":{"_$color2":"#ffffe1"},"v:shadow":{"_$on":"t","_$color":"black","_$obscured":"t"},"v:path":{"_$o:connecttype":"none"},"v:textbox":{"_$style":"mso-direction-alt:auto","div":{"_$style":"text-align:left"}},"x:ClientData":{"_$ObjectType":"Note","x:MoveWithCells":"","x:SizeWithCells":"","x:Anchor":`${t.cellPos.c+1}, 15, ${t.cellPos.r}, 10, ${t.cellPos.c+3}, 15, ${t.cellPos.r+3}, 10`,"x:AutoFill":"False","x:Row":t.cellPos.r,"x:Column":t.cellPos.c}}});return{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"xml":{"_$xmlns:v":"urn:schemas-microsoft-com:vml","_$xmlns:o":"urn:schemas-microsoft-com:office:office","_$xmlns:x":"urn:schemas-microsoft-com:office:excel","o:shapelayout":{"_$v:ext":"edit","o:idmap":{"_$v:ext":"edit","_$data":"1"}},"v:shapetype":{"_$id":"_x0000_t202","_$coordsize":"21600,21600","_$o:spt":"202","_$path":"m,l,21600r21600,l21600,xe","v:stroke":{"_$joinstyle":"miter"},"v:path":{"_$gradientshapeok":"t","_$o:connecttype":"rect"}},"v:shape":1===e.length?e[0]:e}}}(n.Comment.getAll());s&&(e.obj[`xl/drawings/${a}`]=s,e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/drawings/${a}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.vmlDrawing"}));const l=`rId${o.length+1}`,c=`rId${o.length+2}`;o.push({"_$Id":l,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","_$Target":`../${r}`}),o.push({"_$Id":c,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing","_$Target":`../drawings/${a}`}),d.legacyDrawing={"_$r:id":c}}}if(n.CF&&n.CF.rules.length>0){const t=(T=n.CF)&&0!==T.rules.length?T.toXmlObject():null;t&&(d.conditionalFormatting=t);const i=function(t){return t?t.getDxfList().map(t=>function(t){const e={};if(t.font){const n={};t.font.bold&&(n.b=""),t.font.italic&&(n.i=""),t.font.strike&&(n.strike=""),t.font.underline&&(n.u="single"===t.font.underline?"":{"_$val":t.font.underline}),t.font.color&&(n.color={"_$rgb":De(t.font.color)}),Object.keys(n).length>0&&(e.font=n)}if(t.fill){const n={};if("pattern"===t.fill.type||t.fill.fgColor){const e={"_$patternType":t.fill.pattern||"solid"};if(t.fill.fgColor){const n=De(t.fill.fgColor);e.fgColor={"_$rgb":n},e.bgColor={"_$rgb":n}}n.patternFill=e}Object.keys(n).length>0&&(e.fill=n)}if(t.border){const n={},i=["left","right","top","bottom"];for(const e of i)if(t.border[e]){const i={};t.border[e].style&&(i._$style=t.border[e].style),t.border[e].color&&(i.color={"_$rgb":De(t.border[e].color)}),Object.keys(i).length>0&&(n[e]=i)}Object.keys(n).length>0&&(e.border=n)}return e}(t)):[]}(n.CF);i.length>0&&function(t,e){e&&0!==e.length&&(t.dxfs||(t.dxfs={"_$count":"0"}),t.dxfs.dxf?Array.isArray(t.dxfs.dxf)||(t.dxfs.dxf=[t.dxfs.dxf]):t.dxfs.dxf=[],t.dxfs.dxf.push(...e),t.dxfs._$count=String(t.dxfs.dxf.length))}(e.styleSheet,i)}var T;if(n.Table&&n.Table.size>0){const t=function(t,e,n,i,r={}){const o=t.Table;if(!o||0===o.size)return 0;const a=r.mapDxfId;let s=0;const l=[];return o.forEach(t=>{s+=1;const r=100*i+s,o=`table${r}.xml`,c=function(t,e,n={}){const i=t.range;if(!i)return null;const r=n.mapDxfId,o=(t,e)=>{const n=function(t,e){if(!Number.isInteger(t))return;if("function"!=typeof e)return t;const n=e(t);return Number.isInteger(n)?n:void 0}(e,r);return Number.isInteger(n)?{[t]:n}:{}};t.syncColumnNames();const a=t.ref,s=e+1,l=t.columns.map((t,e)=>({"_$id":t.id||e+1,"_$name":t.name||`Column${e+1}`,...o("_$dataDxfId",t.dataDxfId),...t.totalsRowFunction?{"_$totalsRowFunction":t.totalsRowFunction}:{},...t.totalsRowLabel?{"_$totalsRowLabel":t.totalsRowLabel}:{}})),c=t.showTotalsRow?X({s:i.s,e:{r:i.e.r-1,c:i.e.c}}):a,h=t.sheet?.AutoFilter?.getTableScopeId?.(t.id),u=h?t.sheet.AutoFilter.buildXml(h):null,d=u?{...u,"_$ref":c}:{"_$ref":c};return{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},table:{"_$xmlns":"http://schemas.openxmlformats.org/spreadsheetml/2006/main","_$id":s,"_$name":t.name,"_$displayName":t.displayName||t.name,"_$ref":a,"_$totalsRowShown":"0",...o("_$headerRowDxfId",t.headerRowDxfId),...o("_$dataDxfId",t.dataDxfId),...o("_$headerRowBorderDxfId",t.headerRowBorderDxfId),...o("_$tableBorderDxfId",t.tableBorderDxfId),...o("_$totalsRowBorderDxfId",t.totalsRowBorderDxfId),...t.showHeaderRow?{}:{"_$headerRowCount":"0"},...t.showTotalsRow?{"_$totalsRowCount":"1"}:{},...t.autoFilterEnabled?{autoFilter:d}:{},tableColumns:{"_$count":l.length,tableColumn:l},tableStyleInfo:{"_$name":t.styleId,"_$showFirstColumn":t.showFirstColumn?"1":"0","_$showLastColumn":t.showLastColumn?"1":"0","_$showRowStripes":t.showRowStripes?"1":"0","_$showColumnStripes":t.showColumnStripes?"1":"0"}}}}(t,r,{mapDxfId:a});if(!c)return;e.obj[`xl/tables/${o}`]=c,e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/tables/${o}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"});const h=`rId${n.length+1}`;n.push({"_$Id":h,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table","_$Target":`../tables/${o}`}),l.push({"_$r:id":h})}),{count:s,tableParts:l}}(n,e,o,i,{mapDxfId:u});t.count>0&&(d.tableParts={"_$count":t.count,"tablePart":t.tableParts})}t.Utils.sortObjectInPlace(d,["worksheet","sheetPr","dimension","sheetViews","sheetFormatPr","cols","sheetData","sheetCalcPr","sheetProtection","protectedRanges","scenarios","autoFilter","sortState","dataConsolidate","customSheetViews","mergeCells","phoneticPr","conditionalFormatting","dataValidations","hyperlinks","printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","drawing","legacyDrawing","legacyDrawingHF","tableParts","extLst"])}),e.styleSheet.fonts._$count=t.buildStyle.fontC,e.styleSheet.fills._$count=t.buildStyle.fillC,e.styleSheet.borders._$count=t.buildStyle.borderC,e.styleSheet.cellXfs._$count=t.buildStyle.xfC;const d=e.styleSheet.numFmts?.numFmt,f=Array.isArray(d)?d.length:d?1:0;e.styleSheet.numFmts._$count=String(f);const p=t.Ax.findIndex(e=>e==t.activeSheet.name);e.obj["xl/workbook.xml"].workbook.bookViews.workbookView._$activeTab=p,t.readOnly?e.obj["xl/workbook.xml"].workbook.fileSharing={"_$readOnlyRecommended":"1"}:delete e.obj["xl/workbook.xml"].workbook.fileSharing,function(t,e){const n=e.obj["xl/workbook.xml"].workbook;n.definedNames||(n.definedNames={definedName:[]});const i=(Array.isArray(n.definedNames.definedName)?n.definedNames.definedName:n.definedNames.definedName?[n.definedNames.definedName]:[]).filter(t=>{const e=t?._$name;return!!e&&e.startsWith("_")&&!function(t){return"_xlnm.Print_Area"===t||"_xlnm.Print_Titles"===t}(e)}),r=function(t){if(!t?.sheets?.length)return[];const e=[];return t.sheets.forEach((n,i)=>{const r=t.Print?.ensureSettings?t.Print.ensureSettings(n):n?.printSettings;if(!r)return;const o=function(t,e,n){if(!n||!e)return"";let i=n;return"string"==typeof i&&(i=e.rangeStrToNum(i)),i?.s&&i?.e?`${aV(e.name)}!${t.Utils.rangeNumToStr(i,!0)}`:""}(t,n,r.printArea);o&&e.push({"_$name":"_xlnm.Print_Area","_$localSheetId":String(i),"#text":o});const a=function(t,e){if(!t||!e)return"";const n=[],i=function(t){if(!t||"string"!=typeof t)return"";const e=t.replace(/\$/g,"").replace(/\s+/g,"").match(/^(\d+):(\d+)$/);if(!e)return"";const n=Math.max(1,Number(e[1])),i=Math.max(1,Number(e[2]));return`$${Math.min(n,i)}:$${Math.max(n,i)}`}(e.rows),r=function(t){if(!t||"string"!=typeof t)return"";const e=t.replace(/\$/g,"").replace(/\s+/g,"").toUpperCase().match(/^([A-Z]+):([A-Z]+)$/);return e?`$${e[1]}:$${e[2]}`:""}(e.cols),o=`${aV(t.name)}!`;return i&&n.push(`${o}${i}`),r&&n.push(`${o}${r}`),n.join(",")}(n,r.printTitles);a&&e.push({"_$name":"_xlnm.Print_Titles","_$localSheetId":String(i),"#text":a})}),e}(t),o=Object.entries(t.yn||{}).filter(([t])=>!t.startsWith("_")).map(([t,e])=>({"_$name":t,"#text":e}));n.definedNames.definedName=[...i,...r,...o],0===n.definedNames.definedName.length&&delete n.definedNames}(t,e),function(t,e){if(function(t,e){Object.keys(e.obj).forEach(t=>{(t.startsWith("xl/pivotCache/")||t.startsWith("xl/pivotTables/"))&&delete e.obj[t]});const n=e.obj["[Content_Types].xml"]?.Types?.Override;Array.isArray(n)&&(e.obj["[Content_Types].xml"].Types.Override=n.filter(t=>{const e=t?._$PartName??"";return!e.startsWith("/xl/pivotCache/")&&!e.startsWith("/xl/pivotTables/")}));const i=e.obj["xl/workbook.xml"]?.workbook;i&&delete i.pivotCaches;const r=e.relationship;for(let o=r.length-1;o>=0;o--)r[o]?._$Type?.includes("pivotCacheDefinition")&&r.splice(o,1);t.sheets.forEach((t,n)=>{const i=Pn(e,n),r=e.getRelsByTarget(`worksheets/${i}`);if(Array.isArray(r))for(let e=r.length-1;e>=0;e--)r[e]?._$Type?.includes("pivotTable")&&r.splice(e,1)})}(t,e),!t.Mr||0===t.Mr.size)return;const n=new Map;let i=0;const r=e.relationship,o=e.obj["xl/workbook.xml"].workbook;o.pivotCaches={pivotCache:[]},t.sheets.forEach(t=>{t.PivotTable&&0!==t.PivotTable.size&&t.PivotTable.getAll().forEach(t=>{"function"==typeof t.prepareForExport&&t.prepareForExport()})});for(const[s,l]of t.Mr){i++;const t=`pivotCacheDefinition${i}.xml`,a=`pivotCacheRecords${i}.xml`;e.obj[`xl/pivotCache/${t}`]=l.toXmlDefinition(),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/pivotCache/${t}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml"}),e.obj[`xl/pivotCache/${a}`]=l.toXmlRecords(),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/pivotCache/${a}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml"});const c=`xl/pivotCache/_rels/${t}.rels`;e.obj[c]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":[{"_$Id":"rId1","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords","_$Target":a}],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}};const h=Ln(r);r.push({"_$Id":h,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition","_$Target":`pivotCache/${t}`}),o.pivotCaches.pivotCache.push({"_$cacheId":String(s),"_$r:id":h}),n.set(s,{defFileName:t,recordsFileName:a,rId:h})}let a=0;t.sheets.forEach((t,i)=>{if(!t.PivotTable||0===t.PivotTable.size)return;const r=Pn(e,i),o=e.getRelsByTarget(`worksheets/${r}`,!0);for(const s of t.PivotTable.getAll()){const t=n.get(s.cacheId);if(!t)continue;a++;const i=`pivotTable${a}.xml`;e.obj[`xl/pivotTables/${i}`]=s.toXml(),e.obj["[Content_Types].xml"].Types.Override.push({"_$PartName":`/xl/pivotTables/${i}`,"_$ContentType":"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml"});const r=`xl/pivotTables/_rels/${i}.rels`;e.obj[r]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Relationships":{"Relationship":[{"_$Id":"rId1","_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition","_$Target":`../pivotCache/${t.defFileName}`}],"_$xmlns":"http://schemas.openxmlformats.org/package/2006/relationships"}};const l=Ln(o);o.push({"_$Id":l,"_$Type":"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable","_$Target":`../pivotTables/${i}`})}})}(t,e),function(t,e){const n=function(t){const e=[];return t.sheets.forEach((t,n)=>{t.Slicer&&0!==t.Slicer.size&&t.Slicer.forEach(i=>{e.push({sheet:t,sheetIndex:n,slicer:i})})}),e}(t),i=Array.from(new Set(n.map(t=>t.slicer?.cacheId).filter(t=>null!=t))).map(e=>t?.zi?.get(e)).filter(Boolean);0===n.length&&0===i.length||(function(t,e,n,i){if(0===i.length&&0===n.length)return;const r=i.map(EB),o=n.map(({slicer:t})=>function(t){const e={"_$id":t.id,"_$name":t.name,"_$caption":t.caption??"","_$cacheId":String(t.cacheId??""),"_$sheet":t.sheet?.name??t.sourceSheet??"","_$sourceType":t.sourceType??"","_$sourceName":t.sourceName??"","_$fieldIndex":String(t.fieldIndex??0),"_$fieldName":t.fieldName??"","_$columns":String(t.columns??1),"_$buttonHeight":String(t.buttonHeight??22),"_$showHeader":t.showHeader?"1":"0","_$multiSelect":t.multiSelect?"1":"0","_$styleName":t.styleName??"SlicerStyleLight1"},n=function(t){const e=Array.from(t.selectedKeys||[]);return 0===e.length?null:{"sn:item":e.map(t=>({"_$key":t}))}}(t);n&&(e["sn:selection"]=n);const i=function(t){const e=t.Drawing;return e?{"_$startRow":String(e.startCell?.r??0),"_$startCol":String(e.startCell?.c??0),"_$offsetX":String(e.offsetX??0),"_$offsetY":String(e.offsetY??0),"_$width":String(e.width??0),"_$height":String(e.height??0)}:null}(t);return i&&(e["sn:anchor"]=i),e}(t));e.obj["xl/snSlicers.xml"]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"sn:slicers":{"_$xmlns:sn":"http://sheetnext/slicer","sn:caches":r.length>0?{"sn:cache":r}:void 0,"sn:slicer":o.length>0?o:void 0}},IB(e,"/xl/snSlicers.xml","application/vnd.sheetnext.Slicer+xml")}(0,e,n,i),function(t,e,n,i){if(0===n.length)return;const r=e.obj["xl/workbook.xml"]?.workbook,o=RB(e.relationship);t.yn||(t.yn={});const a=new Map;t.sheets.forEach((t,e)=>{a.set(t.name,function(t,e){const n=new Map;if(!t?.Table||0===t.Table.size)return n;let i=0;return t.Table.forEach(t=>{i+=1;const r=100*e+i+1;n.set(t.id,r),t.name&&n.set(`name:${t.name}`,r),t.displayName&&n.set(`name:${t.displayName}`,r)}),n}(t,e))});const s=new Map,l=[];let c=0;i.forEach(i=>{const r=n.find(t=>t.slicer.cacheId===i.cacheId),h=i.sourceSheet||r?.sheet?.name,u=a.get(h),d=function(t,e,n){if(!n||0===n.size)return 1;if(t?.sourceId&&n.has(t.sourceId))return n.get(t.sourceId);if(e?.sourceId&&n.has(e.sourceId))return n.get(e.sourceId);if(t?.sourceName&&n.has(`name:${t.sourceName}`))return n.get(`name:${t.sourceName}`);if(e?.sourceName&&n.has(`name:${e.sourceName}`))return n.get(`name:${e.sourceName}`);const i=n.values().next();return i.done?1:i.value}(i,r?.slicer,u),f=Math.max(1,_B(i.fieldIndex,0)+1),p=`slicerCache${++c}.xml`,m=`rId${FB(o)}`,g=i.ao||`SlicerCache_${r?.slicer?.name||i.fieldName||i.cacheId}`,v=String(g).replace(/\s+/g,"_"),y=i.fieldName||r?.slicer?.fieldName||"";var b;o.push({"_$Id":m,"_$Type":"http://schemas.microsoft.com/office/2007/relationships/slicerCache","_$Target":`slicerCaches/${p}`}),l.push(m),s.set(i.cacheId,{cacheName:v}),t.yn[v]=t.yn[v]||"#N/A",e.obj[`xl/slicerCaches/${p}`]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},slicerCacheDefinition:{"_$xmlns":CB,"_$xmlns:mc":$B,"_$mc:Ignorable":"x xr10","_$xmlns:x":TB,"_$xmlns:xr10":NB,"_$name":(b={cacheName:v,sourceName:y,tableId:d,column:f}).cacheName,"_$sourceName":b.sourceName,extLst:{"x:ext":{"_$uri":"{2F2917AC-EB37-4324-AD4E-5DD8C200BD13}","_$xmlns:x15":AB,"x15:tableSlicerCache":{"_$tableId":String(b.tableId),"_$column":String(b.column)}}}}},IB(e,`/xl/slicerCaches/${p}`,"application/vnd.ms-excel.slicerCache+xml")}),function(t,e){if(!t||0===e.length)return;const n=RB(t.extLst?.ext);let i=n.find(t=>t?.["x15:slicerCaches"]);i||(i={"_$uri":"{46BE6895-7355-4a93-B00E-2C351335B9C9}","_$xmlns:x15":AB,"x15:slicerCaches":{"_$xmlns:x14":MB,"x14:slicerCache":[]}},n.push(i)),i["x15:slicerCaches"]={"_$xmlns:x14":MB,"x14:slicerCache":e.map(t=>({"_$r:id":t}))},t.extLst={ext:n}}(r,l);let h=0;t.sheets.forEach((n,i)=>{if(!n?.Slicer||0===n.Slicer.size)return;const r=`sheet${i+1}.xml`,o=e.obj[`xl/worksheets/${r}`]?.worksheet,a=RB(e.getRelsByTarget(`worksheets/${r}`,!0)),l=[];n.Slicer.forEach(n=>{const i=s.get(n.cacheId);if(!i)return;const r=`slicer${++h}.xml`,o=`rId${FB(a)}`;a.push({"_$Id":o,"_$Type":"http://schemas.microsoft.com/office/2007/relationships/slicer","_$Target":`../slicers/${r}`}),l.push(o);const c=Math.max(1,Math.round(t.Utils.pxToEmu(_B(n.buttonHeight,22))));var u,d;e.obj[`xl/slicers/${r}`]=(u={name:n.name||n.id,caption:n.caption||n.fieldName||n.name||n.id,rowHeight:c,columnCount:Math.max(1,_B(n.columns,1)),showCaption:n.showHeader?"1":"0",styleName:n.styleName||"SlicerStyleLight1"},d=i.cacheName,{"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},slicers:{"_$xmlns":CB,"_$xmlns:mc":$B,"_$mc:Ignorable":"x xr10","_$xmlns:x":TB,"_$xmlns:xr10":NB,slicer:{"_$name":u.name,"_$cache":d,"_$caption":u.caption,"_$rowHeight":String(u.rowHeight),"_$columnCount":String(u.columnCount),"_$showCaption":u.showCaption,"_$style":u.styleName}}}),IB(e,`/xl/slicers/${r}`,"application/vnd.ms-excel.slicer+xml")}),function(t,e){if(!t||0===e.length)return;const n=RB(t.extLst?.ext);let i=n.find(t=>t?.["x14:slicerList"]);i||(i={"_$uri":"{3A4CF648-6AED-40f4-86FF-DC5316D8AED3}","_$xmlns:x15":AB,"x14:slicerList":{"_$xmlns:x14":MB,"x14:slicer":[]}},n.push(i)),i["x14:slicerList"]={"_$xmlns:x14":MB,"x14:slicer":e.map(t=>({"_$r:id":t}))},t.extLst={ext:n}}(o,l)})}(t,e,n,i))}(t,e),function(t){const e=["fileVersion","fileSharing","workbookPr","mc:AlternateContent","xr:revisionPtr","bookViews","sheets","functionGroups","externalReferences","definedNames","calcPr","oleSize","customWorkbookViews","pivotCaches","smartTagPr","smartTagTypes","webPublishing","fileRecoveryPr","webPublishObjects","extLst"],n={},i=Object.keys(t);for(const r of i)r.startsWith("_$")&&(n[r]=t[r]);for(const r of e)void 0!==t[r]&&(n[r]=t[r]);for(const r of i)n[r]||r.startsWith("_$")||(n[r]=t[r]);for(const r of Object.keys(t))delete t[r];Object.assign(t,n)}(e.obj["xl/workbook.xml"].workbook),function(t,e){const n=t.properties||{},i=e.obj;i["docProps/core.xml"]||(i["docProps/core.xml"]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"cp:coreProperties":{"_$xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","_$xmlns:dc":"http://purl.org/dc/elements/1.1/","_$xmlns:dcterms":"http://purl.org/dc/terms/","_$xmlns:dcmitype":"http://purl.org/dc/dcmitype/","_$xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"}}),i["docProps/app.xml"]||(i["docProps/app.xml"]={"?xml":{"_$version":"1.0","_$encoding":"UTF-8","_$standalone":"yes"},"Properties":{"_$xmlns":"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","_$xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}});const r=i["docProps/core.xml"]["cp:coreProperties"],o=i["docProps/app.xml"].Properties,a={title:"dc:title",subject:"dc:subject",creator:"dc:creator",keywords:"cp:keywords",description:"dc:description",lastModifiedBy:"cp:lastModifiedBy",category:"cp:category",contentStatus:"cp:contentStatus",revision:"cp:revision",language:"dc:language"},s={company:"Company",manager:"Manager",hyperlinkBase:"HyperlinkBase"};for(const[l,c]of Object.entries(a))n[l]?r[c]=n[l]:delete r[c];n.created&&(r["dcterms:created"]={"#text":n.created.includes("T")?n.created:new Date(n.created).toISOString(),"_$xsi:type":"dcterms:W3CDTF"}),r["dcterms:modified"]={"#text":(new Date).toISOString(),"_$xsi:type":"dcterms:W3CDTF"};for(const[l,c]of Object.entries(s))n[l]?o[c]=n[l]:delete o[c];o.Application="SheetNext Editor",o.AppVersion="1.0"}(t,e);const m=new SB;for(let v in e.obj){const t=e.obj[v];if(void 0!==t?.Pr)m.file(v,t.Pr);else if(t.Ln)m.file(v,t.Ln,{binary:!0});else{let e=DD.builder.build(t);"xl/sharedStrings.xml"===v&&(e=e.replaceAll("\n","&#10;")),m.file(v,e)}}const g=m.generate({type:"blob",compression:"DEFLATE"});oz.saveAs(g,`${t.workbookName}.xlsx`),t.o=null},Sx:async function(){const t=this.$,e=await Mz.call(this),n=e.sheets.find(e=>e.name===t.activeSheet.name),{styleTable:i,sizeTable:r}=e;if(!n||!n.rows||0===n.rows.length){const e=new Blob(["<table></table>"],{type:"text/html;charset=utf-8;"});return void oz.saveAs(e,`${t.workbookName}.html`)}let o=0,a=0;n.rows.forEach(t=>{o=Math.max(o,t.rIndex),t.cells.forEach(t=>{const e=void 0!==t.e?t.e:t.c;a=Math.max(a,e)})});const s=new Map,l=new Set;n.merges&&n.merges.forEach(t=>{const e=`${t.s.r},${t.s.c}`;s.set(e,{rowspan:t.e.r-t.s.r+1,colspan:t.e.c-t.s.c+1});for(let n=t.s.r;n<=t.e.r;n++)for(let e=t.s.c;e<=t.e.c;e++)n===t.s.r&&e===t.s.c||l.add(`${n},${e}`)});const c=new Map;n.rows.forEach(t=>{t.cells.forEach(e=>{const n=e.c,i=void 0!==e.e?e.e:e.c;for(let r=n;r<=i;r++)c.set(`${t.rIndex},${r}`,e)})});const h=[];for(let f=0;f<=a;f++){const t=n.cols?.find(t=>t.cIndex===f),e=void 0!==t?.w?r.colWidths[t.w]:n.defaultColWidth||72;h.push(e)}let u=`<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n<title>${t.workbookName}</title>\n<style>\ntable { border-collapse: collapse; table-layout: fixed; }\ntd { border: 1px solid #d0d0d0; padding: 2px 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }\n</style>\n</head>\n<body>\n<table>\n<colgroup>\n${h.map(t=>`<col style="width:${t}px">`).join("\n")}\n</colgroup>\n`;for(let f=0;f<=o;f++){const t=n.rows.find(t=>t.rIndex===f);u+=`<tr style="height:${void 0!==t?.h?r.rowHeights[t.h]:n.defaultRowHeight||21}px">`;for(let e=0;e<=a;e++){const t=`${f},${e}`;if(l.has(t))continue;const n=c.get(t),r=s.get(t);let o="";r&&(r.rowspan>1&&(o+=` rowspan="${r.rowspan}"`),r.colspan>1&&(o+=` colspan="${r.colspan}"`));const a=sV(n,i);a&&(o+=` style="${a}"`);let h="";n&&(void 0!==n.cv&&null!==n.cv?h=lV(String(n.cv)):void 0!==n.v&&null!==n.v&&(h=lV(String(n.v)))),u+=`<td${o}>${h}</td>`}u+="</tr>\n"}u+="</table>\n</body>\n</html>";const d=new Blob([u],{type:"text/html;charset=utf-8;"});oz.saveAs(d,`${t.workbookName}.html`)}});let hV=0;class uV{constructor(){this.items=[],this.kx=null}add(t){t&&(this.items.push(t),this.kx=null)}get size(){return this.items.length}get summary(){if(this.kx)return this.kx;const t={};for(const e of this.items){const n=e?.type||"unknown";t[n]=(t[n]||0)+1}return this.kx={total:this.items.length,counts:t},this.kx}}class dV{constructor(t,e={},n={}){this.id=++hV,this.type=t,this.data=e,this.startTime=Date.now(),this.endTime=null,this.duration=0,this.parentId=n.parentId??null,this.meta=n.meta??null,this.changes=n.trackChanges?new uV:null}addChange(t){this.changes&&this.changes.add(t)}end(){return this.endTime=Date.now(),this.duration=this.endTime-this.startTime,this}}function fV(t,e="",n={}){if(!t||"object"!=typeof t||Array.isArray(t))return n;for(const i of Object.keys(t)){const r=t[i],o=e?`${e}.${i}`:i;!r||"object"!=typeof r||Array.isArray(r)?"string"==typeof r&&(n[o]=r):fV(r,o,n)}return n}class pV{constructor(t="en-US",e="en-US"){this.locale=t||"en-US",this.fallbackLocale=e||"en-US",this.Tx=new Map}register(t,e){if(!t)return;const n=this.Tx.get(t)||{},i=fV(e);this.Tx.set(t,{...n,...i})}setLocale(t){t&&"string"==typeof t&&(this.locale=t)}t(t,e={}){if(!t||"string"!=typeof t)return"";const n=this.Tx.get(this.locale)||{},i=this.Tx.get(this.fallbackLocale)||{},r=n[t]??i[t]??t;return String(r).replace(/\{(\w+)\}/g,(t,n)=>Object.prototype.hasOwnProperty.call(e,n)?String(e[n]):`{${n}}`)}}function mV(t){return!!t&&"object"==typeof t&&!Array.isArray(t)}function gV(t){if(Array.isArray(t))return t.map(gV);if(mV(t)){const e={};for(const n of Object.keys(t))e[n]=gV(t[n]);return e}return t}function vV(t,e){if(!mV(t)||!mV(e))return t;for(const n of Object.keys(e)){const i=e[n],r=t[n];mV(i)&&mV(r)?vV(r,i):t[n]=i}return t}const yV=new Map;function bV(t,e){if(!t||!mV(e))return;const n=yV.get(t);n?vV(n,gV(e)):yV.set(t,gV(e))}yV.set("en-US",gV({"ai":{"panel":{"examples":{"item1":"Analyze the current sheet data, generate a chart, and provide key insights on a new sheet.","item2":"Generate a meeting notes template.","item3":"Highlight employees with salary above 10,000 using conditional formatting.","item4":"Generate a styled 2030 calendar: three months per row, distinct block colors, spacer rows/cols, and highlighted weekends.","item5":"Use SUMIF to summarize sales by department and generate a department summary table.","item6":"Add a dropdown list to column B with options: In Progress, Completed, Cancelled.","item7":"Generate a bar chart from the current data to show the proportion of each category."},"examplesTitle":"Examples","inputPlaceholder":"Describe what to do with the sheet...","quickImport":"Quick import xlsx, or generate content directly.","resetContext":"Reset Context","title":"SheetNext AI","uploadImage":"Upload Image"},"runtime":{"aiUrlNotConfigured":"AI_URL is not configured","askPlaceholder":"Or enter a custom answer...","cancel":"Cancel","clearChatConfirm":"Clear all chat history?","confirm":"Confirm","dataTruncated":"Data truncated","doneIn":"Done in {seconds} s","error":"Error","maxImages":"You can upload up to 4 images.","roundLimit":"Unlicensed version allows up to 3 AI rounds per session.","paused":"Paused","pausedPrompt":"Task paused. Anything to add?","running":"SheetNext AI is processing...","send":"Send","timeLabel":"Time","toolArgParseFailed":"Tool argument parse failed","tools":{"ask":"Ask User","edit":"Apply Edits","query":"Query Data","search":"Search","view":"View Snapshot"},"unknownTool":"Unknown tool","webSearching":"web searching..."}},"autoFilter":{"panel":{"clear":"Clear","field":"Field","searchPlaceholder":"Search...","selectAll":"Select All","sortAsc":"Sort Ascending","sortDesc":"Sort Descending","title":"Filter","titleColumn":"Filter - Column {column}","titleField":"Filter - {field}"}},"chart":{"category":{"area":"Area","bar":"Column","barh":"Bar","combo":"Combo","funnel":"Funnel","histogram":"Histogram","line":"Line","pie":"Pie","radar":"Radar","scatter":"XY (Scatter)","stock":"Stock","sunburst":"Sunburst","treemap":"Treemap","waterfall":"Waterfall"},"item":{"area_basic":"Area","area_percent":"100% Stacked Area","area_stacked":"Stacked Area","bar_clustered":"Clustered Column","bar_percent":"100% Stacked Column","bar_stacked":"Stacked Column","barh_clustered":"Clustered Bar","barh_percent":"100% Stacked Bar","barh_stacked":"Stacked Bar","combo_area_bar":"Stacked Area-Column Combo","combo_bar_line":"Column-Line Combo","funnel_basic":"Funnel","histogram_basic":"Histogram","line_basic":"Line","line_marker":"Line with Markers","line_marker_percent":"100% Stacked Line with Markers","line_marker_stacked":"Stacked Line with Markers","line_percent":"100% Stacked Line","line_stacked":"Stacked Line","pie_basic":"Pie","pie_doughnut":"Doughnut","radar_basic":"Radar","radar_filled":"Filled Radar","radar_marker":"Radar with Markers","scatter_basic":"Scatter","scatter_bubble":"Bubble","scatter_line":"Straight Lines","scatter_line_marker":"Straight Lines with Markers","scatter_smooth":"Smooth Lines","scatter_smooth_marker":"Smooth Lines with Markers","stock_hlc":"High-Low-Close","stock_ohlc":"Open-High-Low-Close","stock_vol_hlc":"Volume-High-Low-Close","stock_vol_ohlc":"Volume-Open-High-Low-Close","sunburst_basic":"Sunburst","treemap_basic":"Treemap","waterfall_basic":"Waterfall"},"defaultTitle":"Chart Title","modal":{"confirm":"Insert","title":"Insert Chart"},"toast":{"noType":"No chart type selected","rangeEmpty":"Selected range has no data","selectRange":"Please select a data range first","unsupportedType":"Unsupported chart type: {label}"}},"color":{"moreColors":"More Colors","noColor":"No Color","standardColors":"Standard Colors","themeColors":"Theme Colors"},"common":{"cancel":"Cancel","close":"Close","notice":"Notice","ok":"OK"},"dataTools":{"columnFallback":"Column","consolidate":{"completed":"Consolidate completed: wrote {count} cells.","destination":"Destination cell","destinationPlaceholder":"e.g. A1","errors":{"executeFailed":"Failed to execute consolidate.","invalidSourceRange":"Invalid source ranges format.","sourceRequired":"Please input at least one source range."},"function":"Function","invalidRange":"Invalid range: {range}","skipBlanks":"Ignore blank","sourceRanges":"Source ranges (one per line, e.g. A1:C10)","title":"Consolidate"},"function":{"average":"Average","count":"Count (non-empty)","countNums":"Count Numbers","max":"Max","min":"Min","product":"Product","stdev":"Standard Deviation","stdevp":"StdDev (Population)","sum":"Sum","var":"Variance","varp":"Variance (Population)"},"subtotal":{"addTo":"Add subtotal to","completed":{"grandTotalSuffix":", includes grand total","message":"Subtotal completed: {groupCount} groups, inserted {insertedRows} subtotal rows{grandTotal}."},"errors":{"executeFailed":"Failed to execute subtotal.","groupFieldRequired":"Please select a group field.","mergedCells":"Subtotal does not support ranges containing merged cells.","minColumns":"Subtotal requires at least two data columns.","subtotalColumnRequired":"Please select at least one subtotal column."},"function":"Subtotal function","grandTotal":"Add grand total row","groupField":"Group field","hasHeaders":"The first row contains headers","replaceExisting":"Replace current subtotals","summaryBelow":"Show summary rows below details","title":"Subtotal"}},"dataValidation":{"action":{"clear":"cleared","set":"set"},"allow":"Allow","allowBlank":"Ignore blank","data":"Data","errorContentPlaceholder":"Error content","errorStyle":{"information":"Information","stop":"Stop","warning":"Warning"},"errorTitlePlaceholder":"Error title","errors":{"clearFailed":"Failed to clear data validation.","conditionRequired":"Please input a condition value.","customFormulaRequired":"Please input a custom validation formula.","inputRuleMismatch":"The input does not meet the validation rules.","invalidConfig":"Invalid data validation settings.","listSourceRequired":"Please input at least one list value.","rangeConditionRequired":"This comparison mode requires two condition values.","setFailed":"Failed to set data validation."},"formula1":{"custom":"Formula (returns TRUE/FALSE)","date":"Date value (e.g. 2026-01-31)","default":"Min/Condition value","textLength":"Text length","time":"Time value (e.g. 08:30:00)"},"formula2":{"custom":"End value","date":"End date","default":"Max value","textLength":"Max length","time":"End time"},"inCellDropdown":"In-cell dropdown","listSource":"Source (comma separated)","listSourcePlaceholder":"e.g. Yes,No,Unknown","operator":{"between":"between","equal":"equal to","greaterThan":"greater than","greaterThanOrEqual":"greater than or equal to","lessThan":"less than","lessThanOrEqual":"less than or equal to","notBetween":"not between","notEqual":"not equal to"},"promptContentPlaceholder":"Prompt content","promptTitlePlaceholder":"Prompt title","showErrorAlert":"Show error alert after invalid data is entered","showInputPrompt":"Show input prompt when cell is selected","title":"Data Validation","toast":{"cleared":"Cleared data validation for {count} cell(s).","completed":"Data validation {action} completed, {count} cell(s) processed."},"type":{"any":"Any value","custom":"Custom formula","date":"Date","decimal":"Decimal","list":"List","textLength":"Text length","time":"Time","whole":"Whole number"}},"findReplace":{"close":"Close","error":{"invalidCellReference":"Invalid cell reference"},"findAll":"Find All","findNext":"Find Next","findWhat":"Find what:","gotoSpecial":"Go To Special","gotoSpecialTitle":"Go To Special:","lookIn":"Look in:","lookInFormulas":"Formulas","lookInValues":"Values","matchCase":"Match case","matchEntireCell":"Match entire cell contents","options":"Options","placeholder":{"replaceText":"Enter replacement text","searchText":"Enter search text"},"reference":"Reference:","referencePlaceholder":"e.g. A1, A1:B10, Sheet2!A1","replaceAll":"Replace All","replaceWith":"Replace with:","result":{"cell":"Cell","sheet":"Sheet","value":"Value"},"scope":{"sheet":"Sheet","workbook":"Workbook"},"search":"Search:","searchBy":{"columns":"By Columns","rows":"By Rows"},"special":{"blanks":"Blanks","columnDifferences":"Column Differences","comments":"Comments","conditionalFormats":"Conditional Formats","constants":"Constants","dataValidation":"Data Validation","dependents":"Dependents","errors":"Errors","formulas":"Formulas","lastCell":"Last Cell","mergedCells":"Merged Cells","precedents":"Precedents","rowDifferences":"Row Differences","visibleCells":"Visible Cells"},"status":{"enterSearchText":"Please enter search text","foundCount":"Found {count} cells","notFound":'"{text}" not found',"progress":"{current} / {total}","replaceCompleted":"Replace completed","replacedCount":"Replaced {count} occurrence(s)"},"tab":{"find":"Find","goto":"Go To","replace":"Replace"},"toast":{"enterReference":"Please enter a reference","invalidReference":"Invalid reference format","noMatchingCells":"No matching cells found","selectGoToCondition":"Please select a go-to condition","selectedCount":"Selected {count} cells","sheetNotFound":'Worksheet "{name}" not found'},"within":"Within:"},"layout":{"auto":{"example2de1ff5c":"0.60%","example46c5d49a":"0.006","example59160d28":"2024/10/1 12:00","example739db61c":"¥0.01","example92b9c712":"2 1/2","exampleB3542328":"0:08:38","exampleB975896c":"1900/1/1","exampleCb87bb63":"$0.01","exampleCd80dac4":"6.00E-03","exampleD718a29c":"0.01","label00724f4c":"Values and Number Formats","label04218143":"Error Checking","label046ee664":"General","label065032d4":"Validation","label067fc51e":"Active Field:","label06a5c768":"Freeze Panes","label071821ca":"Trace Dependents","label09162f60":"Bottom Align","label09f772c4":"Align Right","label0b046e3f":"Column Width","label0b9d2bac":"Clear","label0c22da14":"Count","label0fba4654":"Clear Filter","label10481acc":"Collapse Field","label12163f5a":"Freeze Top Row","label142c257c":"Grand Total","label15a1b75c":"Focus Mode","label16d80ff6":"Draw Horizontal Text Box","label170d7ba0":"Blank Row","label1a7e1503":"Protect","label1b11c6bc":"Refresh All","label1b148794":"Disable Rows/Cols","label1ceb2bd8":"11","label20989160":"50%","label20a672e0":"Financial","label2364c11e":"Show in Tabular Form","label240fc094":"Header Row","label24db7740":"Dedupe","label26529d60":"Move PivotTable","label27023994":"Design","label27c10e35":"Sort A to Z","label28152900":"Trim Spaces","label28d8b828":"75%","label2b1c08f4":"More Functions...","label2bb8d6d0":"Freeze","label2c508544":"Auto Filter","label2c95d4cc":"Delete Table","label2d0ee700":"Area Shot","label2d6a5a8c":"Top Align","label2d72febc":"Remove Arrows","label2e9bdfc6":"Vertical Text","label2eedfce4":"Uppercase to Lowercase","label2f97df3c":"100%","label2f9e586c":"Align Left","label304be598":"Sum","label328b35a0":"Sort","label32ac6bce":"Table Style Options","label32e3aa24":"Consolidate","label34005110":"Active Field","label36263538":"Find","label3661dfec":"Ungroup","label36cb3b80":"Formula Bar","label36d826ce":"No Borders","label37030c7c":"Banded Rows","label37d4df3d":"Split Cols","label38a173b8":"80%","label39583efc":"Value","label396990f1":"Home","label3a60f922":"Math","label3cd54380":"Rotate Up","label3d33e8d4":"Paste","label3dbdf26c":"Table","label3fdb3ab0":"Custom Sort...","label40bdc8a4":"Text to Number","label426d9dba":"Data","label42a69c1c":"Enable Rows/Cols","label45d4ed20":"Show All Subtotals at Top of Group","label4674137c":"₣ CHF","label46acc0ac":"Enable Columns","label46ecf058":"A$ AUD","label476f4998":"Lock/Hide Cells...","label47acfc84":"Insert","label47c40973":"₽ RUB","label4868045c":"Save as XLSX","label4b5562f8":"Define Name","label525c8b3c":"HK$ HKD","label52fa4c98":"Resize","label53f4d744":"Reapply","label54132264":"Properties","label54197afc":"Filter Button","label5613e7b9":"Formulas","label56ec896c":"Sort Z to A","label57267dc8":"PivotTable Styles","label5728db81":"Sheet Tabs","label58e5db03":"150%","label591efe60":"AutoFit Row Height","label5957a658":"Center","label5a640746":"£ GBP","label5d3d9fbc":"Max","label5d77ac8c":"Text","label5ed9f2ae":"Save as JSON","label5f1a7cbc":"Show Report Filter Pages","label60974ee4":"200%","label62002448":"Names","label62572410":"PivotTable Style Options","label637e3b1e":"Win/Loss","label64f57004":"Lowercase to Uppercase","label6561bb16":"Shapes","label669baeb8":"Do Not Repeat Item Labels","label694838cc":"Insert Slicer","label69e81956":"Show in Outline Form","label6ac6d174":"Formulas and Number Formats","label6d1763f6":"Calc Opt","label6d96702e":"PivotTable","label6e89ee74":"Remove Dependent Arrows","label6ea6ad84":"Unprotect Sheet","label6f816c60":"Manual","label6fbb5db4":"Subtotal","label72788608":"Hyperlink","label727a825c":"Table Styles","label765501ea":"Pivot Totals","label7673ae70":"Remove Precedent Arrows","label76fd7400":"Report Layout","label7844abc8":"₹ INR","label798a4a6c":"Last Column","label7af7db1c":"Banded Columns","label7c9ea1ac":"Remove All Arrows","label7cc4a190":"Repeat All Item Labels","label7d40574d":"C$ CAD","label7d9a5030":"View","label801897e0":"Quick Style","label805a4b6c":"Gridlines","label80c65db8":"Clear Contents","label81ccfc88":"Unmerge","label82496aef":"$ USD","label82b852ee":"Full Screen","label83c5b1ec":"Clear Borders","label880beb90":"Count Numbers","label89be961f":"Zoom","label8ad96a3c":"Custom...","label8b22223e":"Line Chart","label8b46f723":"Options...","label8b57557b":"Zoom Sel","label8c5bd7f4":"No Rotation","label8d9fe558":"Refresh","label8fd62c48":"Freeze to Current Row","label9026bf7c":"Symbols","label905e4698":"Size","label92d86c42":"Sparklines","label92f61dec":"Logical","label92fd0eec":"Date","label92ff62e4":"Fx","label9371a726":"Change Data Source","label97beaff2":"+/- Buttons","label9975a578":"Row Headers","label9c5bc988":"Format","label9d40cd00":"SimSun","label9d54bf30":"Calc Sheet","label9f1d3d34":"Tools","labelA05734b8":"Pivot","labelA0c3dddc":"Default Column Width","labelA6b39eb4":"To Range","labelA9ccb748":"70%","labelAac1ce9c":"Clear All","labelAb4a78ac":"Clear Formats","labelB0a4de64":"Insert Blank Line after Each Item","labelB0c44120":"Use in Formula","labelB191c97c":"Average","labelB1f1d5ca":"Angle CCW","labelB1fa2802":"Draw Vertical Text Box","labelB290c756":"Show in Compact Form","labelB2fe241c":"CF","labelB67479f3":"Number to Text","labelB683336c":"Clear All","labelB6f3db09":"No Subtotals","labelB7394238":"File","labelB99d153f":"Freeze 1st Col","labelB9b1a1f8":"Freeze to Current Column","labelC0185cac":"Total Row","labelC14245a4":"AutoFit Column Width","labelC1ea5002":"Angle CW","labelC2f55060":"Merge Cells","labelC602cd4a":"Merge","labelC6887918":"Controls","labelCa8595e4":"Expand Field","labelCacab6cb":"90%","labelCba453e4":"Picture","labelCbc4bc74":"Cmpct TB","labelCd612c50":"Column Headers","labelCdcccef2":"Remove Blank Line after Each Item","labelCf38367c":"Rotate Down","labelCfc23d16":"Show All","labelD006b2ec":"Cell Styles","labelD13c02d3":"Min","labelD27bcc48":"Group","labelD31c02a0":"Table Name:","labelD4037dd0":"Layout","labelD4fa30c8":"Table Design","labelD6d89414":"Comment","labelD7a9dd2c":"Merge Same Cells","labelD8bfe629":"Unfreeze","labelD8cbc426":"Pivot Name:","labelD932aecc":"Actions","labelD9d58d20":"Common","labelDa7a0418":"Pivot","labelDa8abb77":"¥ CNY","labelDba82348":"Freeze Top Row and First Column","labelDbb08c76":"Page Layout","labelDbcee390":"Set Column Width","labelDda0aee0":"Default Row Height","labelDfde92a4":"Merge & Center","labelDfebdd0c":"Show Formulas","labelE2433858":"₩ KRW","labelE2d8213c":"Automatic","labelE30beb48":"First Column","labelE3362dac":"Fmt","labelE5f2b110":"Bar Chart","labelE62a5aa0":"Save as CSV","labelE7274318":"Field Settings","labelE7546746":"Transpose","labelE8420025":"Headings","labelE8d30c78":"125%","labelE9cb6cfc":"Set Row Height","labelEa7f2a4b":"Protect Sheet","labelEac219e0":"Enable Rows","labelEb15f260":"Dedupe","labelEd8aca00":"Text Box","labelEdc074b8":"Flash Fill","labelEebdf267":"Options","labelEfe10954":"R/C","labelF0e14500":"Merge Contents","labelF189a560":"Trace Precedents","labelF2b067c8":"Middle Align","labelF328662a":"Conv","labelF3321014":"Evaluate Formula","labelF3e084a4":"Filter","labelF43382bc":"Field Headers","labelF53301bc":"Show All Subtotals at Bottom of Group","labelF5b9a3ae":"What-If","labelF5e868d8":"HL R/C","labelF7b3d440":"€ EUR","labelF82f77ee":"Show","labelFcc62550":"AI Chat","labelFd70269c":"Field List","labelFde78e74":"Clear Filters","labelFf7d7c40":"Recalc","title047aaa30":"Percent","title05adf36c":"Currency","title09162f60":"Bottom Align","title09f772c4":"Align Right","title1a808f64":"Decrease Font Size","title1c9e8d5c":"Undo","title1cabceb8":"Decrease Indent","title20d59678":"Borders","title2724f9ac":"Center","title27c68cf4":"Italic","title2d6a5a8c":"Top Align","title2f9e586c":"Align Left","title46adc7a1":"Cut","title4fcc8180":"Wrap Text","title57c65c9c":"Click: Use once\\nDouble-click: Keep active\\nESC: Cancel","title67656060":"Decrease Decimal","title7bd6a6c3":"Underline","title99310054":"Increase Indent","titleA8781ce4":"Increase Decimal","titleAb4a78ac":"Clear Formats","titleAb81d070":"Freeze Rows/Cols at Active Cell","titleB46e89c8":"Fill Color","titleC3cf1168":"Redo","titleD8b83d9c":"Thousands Separator","titleE3aeedb4":"Bold","titleF2b067c8":"Middle Align","titleF2e72f6d":"Increase Font Size","titleF9d572aa":"Copy","titleFaa5e594":"Text Orientation","titleFd05e5a8":"Strikethrough","titleFf0455e0":"Font Color"},"file":{"browserRestore":"Restore from Browser","browserSave":"Save to Browser","exportCsv":"Export CSV","exportHtml":"Export HTML","exportHtmlTitle":"Export as HTML table","exportImage":"Export Image","exportJson":"Export JSON","exportJsonTitle":"Export SheetNext JSON file","exportPdf":"Export PDF","exportXlsx":"Export XLSX","import":"Import File","importFromUrl":"Import from URL","newWorkbook":"New","printPreview":"Print","properties":"Document Properties","readOnlyAfterExport":"Read-only after export"},"menu":{"custom":"Custom...","dataValidation":{"clear":"Clear Data Validation","open":"Data Validation..."},"pageMargins":{"narrow":"Narrow","normal":"Normal","wide":"Wide"},"pageOrientation":{"landscape":"Landscape","portrait":"Portrait"},"paperSize":{"a4":"A4","letter":"Letter"},"printArea":{"clear":"Clear Print Area","set":"Set Print Area"}},"menuRightMinimalToolbar":"Compact Toolbar","menuRightMinimalToolbarTitle":"Toggle compact toolbar mode","page":{"addBreak":"Add Break","background":"Background","colors":"Color","fonts":"Font","headerFooter":"Header/Footer","margins":"Margins","orientation":"Orientation","pageBreaks":"Page Breaks","pagePreview":"Page Preview","paperSize":"Paper Size","printArea":"Print Area","printGridlines":"Gridlines","printHeadings":"Print Headings","printPreview":"Print Preview","printScale":"Print Scale","printTitles":"Print Titles","theme":"Theme"},"tab":{"data":"Data","file":"File","formula":"Formula","insert":"Insert","page":"Page Layout","pivotAnalyze":"PivotTable Analyze","pivotDesign":"Design","start":"Home","tableDesign":"Table Design","view":"View"},"zoomAverage":"Average","zoomCount":"Count","zoomSum":"Sum"},"layoutScrollTipCol":"Col","layoutScrollTipRow":"Row","pivot":{"changeSource":{"modal":{"sourcePlaceholder":"Sheet1!A1:D100","sourceRange":"Source range","sourceTip":"Source requires at least 1 header row and 1 data row.","title":"Change Pivot Source"},"toast":{"updateFailed":"Failed to update pivot source.","updated":"Pivot source updated."}},"chart":{"modal":{"chartType":"Chart type","includeTotals":"Include grand totals in chart source","title":"Insert Pivot Chart"},"toast":{"areaTooSmall":"Pivot table area is too small for chart creation.","inserted":"Pivot chart inserted.","invalidRange":"Cannot find a valid pivot table range."}},"common":{"apply":"Apply","create":"Create","move":"Move","targetCell":"Target cell","targetCellPlaceholder":"A3","targetSheet":"Target sheet"},"create":{"existingSheet":"Existing Worksheet","newSheet":"New Worksheet","placement":"Choose PivotTable Placement","sourceRange":"Select Data Source Range","title":"Create PivotTable"},"errors":{"createFailed":"Create failed: {reason}","invalidSourceRange":"Invalid source range format.","invalidTargetCell":"Invalid target cell reference.","resolveSourceSheetFailed":"Cannot resolve source sheet.","sheetNotExists":'Sheet "{name}" does not exist.',"sourceRangeMinRows":"The source range must contain at least 2 rows (1 header row + 1 data row).","sourceRangeRequired":"Please enter a source range.","targetSheetNotExists":"Target sheet does not exist.","worksheetNotExists":'Worksheet "{name}" does not exist.'},"field":{"fallbackName":"Field {index}"},"naming":{"defaultPivotTable":"PivotTable{index}","defaultDataFieldPattern":"{subtotal}:{fieldName}","subtotalItem":{"sum":"Sum","count":"Count","average":"Average","max":"Max","min":"Min","product":"Product","countNums":"Count Numbers","stdDev":"StdDev","stdDevp":"StdDevp","var":"Var","varp":"Varp"}},"dataField":{"subtotal":{"sum":"Sum","count":"Count","average":"Average","max":"Max","min":"Min","product":"Product","countNums":"Count Numbers","stdDev":"StdDev","stdDevp":"StdDevp","var":"Var","varp":"Varp"},"showAs":{"normal":"No Calculation","percentOfTotal":"% of Grand Total","percentOfRow":"% of Row Total","percentOfCol":"% of Column Total","difference":"Difference From","percentDiff":"% Difference From","runningTotal":"Running Total In","percentOfParentRow":"% of Parent Row Total","percentOfParentCol":"% of Parent Column Total","index":"Index"}},"render":{"rowLabels":"Row Labels","colLabels":"Column Labels"},"fieldSettings":{"customName":"Custom Name","layout":"Layout","showNoDataItems":"Show items with no data","sourceName":"Source Name","subtotalAtTop":"Show subtotals at top of each group","title":"Field Settings"},"move":{"modal":{"title":"Move Pivot Table"},"toast":{"failed":"Failed to move pivot table.","moved":"Pivot table moved."}},"options":{"calc":{"includeCalculated":"Include calculated items in PivotTable totals"},"data":{"enableEditing":"Enable cell editing in values area"},"display":{"contextTips":"Show contextual tooltips","drillButtons":"Show expand/collapse buttons","fieldHeaders":"Show field headers and filter drop-downs"},"layout":{"characters":"characters","compactIndent":"Indent row labels in compact form","emptyValue":"For empty cells show","errorValue":"For error values show","fieldsPerRow":"Report filter fields per row","horizontal":"Over, then down","mergeLabels":"Merge and center cells with labels","reportFilterLayout":"Report filter layout","vertical":"Down, then over"},"name":"PivotTable name","print":{"drillButtons":"Print expand/collapse buttons when shown on PivotTable","repeatLabels":"Repeat row labels on each printed page","setTitles":"Set print titles"},"tab":{"calc":"Calculation","data":"Data","display":"Display","layout":"Layout & Format","print":"Print","totals":"Totals & Filters"},"title":"PivotTable Options","totals":{"multiFilter":"Allow multiple filters per field","showCol":"Show column grand totals","showRow":"Show row grand totals"}},"recommend":{"modal":{"destination":"Destination","layouts":"Layouts","title":"Recommended PivotTable"},"toast":{"createFailed":"Failed to create recommended pivot table.","created":"Recommended pivot table created.","invalidSource":"Current pivot table does not have a valid source range.","noRecommendation":"No recommendation is available for current source data.","selectLayout":"Please select a layout."}},"recommendation":{"desc":{"crossSummary":"Rows: {row}; Columns: {column}; Values: Sum({value})","dualMetric":"Rows: {dimension}; Values: Sum({value1}), Sum({value2})","itemCount":"Rows: {dimension}; Values: Count","summaryBy":"Rows: {dimension}; Values: Sum({value})"},"title":{"crossSummary":"{row} x {column} cross summary","dualMetric":"{dimension} dual-metric analysis","itemCount":"{dimension} item count","summaryBy":"Summarize {value} by {dimension}"}},"reportFilter":{"defaultSheetBase":"PivotPage","itemFallback":"Item {index}","modal":{"filterField":"Filter field","sheetPrefix":"Sheet name prefix","title":"Show Report Filter Pages","visibleOnly":"Create pages for currently visible items only"},"toast":{"addFieldFirst":"Please add at least one report filter field first.","createFailed":"Failed to create report filter pages.","createdCount":"Created {count} report filter page(s).","invalidField":"Please choose a valid report filter field.","noItemsInField":"The selected filter field has no available items.","noItemsToGenerate":"No items available for page generation."}},"slicer":{"modal":{"selectFields":"Select fields to create slicers:","title":"Insert Slicer"},"toast":{"selectAtLeastOne":"Please select at least one field."}},"toast":{"blankRowsInserted":"Inserted blank rows after each item.","blankRowsRemoved":"Removed blank rows after each item.","cannotCollapseCell":"Current cell cannot be collapsed.","cannotExpandCell":"Current cell cannot be expanded.","cleared":"Pivot table cleared.","drillDisabled":"Expand/collapse is disabled for current pivot table.","filtersCleared":"Pivot filters cleared.","grandTotalsUpdated":"Grand total settings updated.","invalidName":"Please enter a valid name.","layoutUpdated":"Report layout updated.","noFieldToConfigure":"No configurable field in current pivot table.","noPivotInSheet":"No pivot table in current sheet.","refreshed":"Pivot table refreshed.","renamed":"Pivot table renamed.","repeatLabelsDisabled":"Repeat item labels disabled.","repeatLabelsEnabled":"Repeat item labels enabled.","subtotalsUpdated":"Subtotal settings updated."}},"toolbar":{"insert":{"chart":"Chart"},"numFmt":{"accounting":"Accounting","cny":"RMB","custom":"Custom","date":"Date","dateTime":"Date Time","fraction":"Fraction","general":"General","longDate":"Long Date","longDateExample":"January 1, 1900","number":"Number","percent":"Percentage","scientific":"Scientific","text":"Text","time":"Time","usd":"USD"}},"workbook":{"defaultName":"New SheetNext file","errors":{"lastVisibleSheetCannotDelete":"Cannot delete the last visible worksheet.","nameCannotBeEmpty":"Workbook name cannot be empty.","nameInvalidChars":'Workbook name cannot contain: \\ / : * ? " < > |',"nameMustBeString":"Workbook name must be a string.","nameTooLong":"Workbook name cannot exceed 255 characters.","sheetNameExists":'Worksheet "{name}" already exists.',"sheetNameInvalidChars":"Worksheet name cannot contain: : / \\\\ * ? [ ]","sheetNameInvalidType":"Invalid worksheet name.","sheetNameLength":"Worksheet name length must be 1-31 characters.","sheetNotFound":'Worksheet "{name}" does not exist.'},"importFromUrl":{"confirm":"Import","errors":{"urlRequired":"Please enter a URL."},"hint":"Supports xlsx/csv/json. Target server must enable CORS.","placeholder":"https://example.com/file.xlsx","title":"Import from URL"},"modal":{"newWorkbook":{"content":"Creating a new workbook will close the current one and discard unsaved data. Continue?","title":"New Workbook"}},"renamePrompt":"Please enter a new worksheet name:"},"action":{"condFormat":{"toast":{"msg001":"Please select a cell range first","msg002":"Please enter a comparison value","msg003":"Please enter text","msg004":"Please enter a formula","msg005":"There are no conditional formatting rules in the current worksheet","msg006":"Conditional formatting in the selected range has been cleared","msg007":"All conditional formatting in the worksheet has been cleared"},"modal":{"m001":{"title":"Conditional Formatting - ","confirm":"OK","cancel":"Cancel"},"m002":{"title":"Conditional Formatting - Text Contains","confirm":"OK","cancel":"Cancel"},"m003":{"title":"Conditional Formatting - Date Occurring","confirm":"OK","cancel":"Cancel"},"m004":{"title":"Conditional Formatting - Duplicate Values","confirm":"OK","cancel":"Cancel"},"m005":{"confirm":"OK","cancel":"Cancel","titleTopItems":"Conditional Formatting - Top Items","titleTopPercent":"Conditional Formatting - Top %","titleBottomItems":"Conditional Formatting - Bottom Items","titleBottomPercent":"Conditional Formatting - Bottom %"},"m006":{"title":"Conditional Formatting - Data Bars","confirm":"OK","cancel":"Cancel"},"m007":{"title":"Conditional Formatting - Color Scales","confirm":"OK","cancel":"Cancel"},"m008":{"title":"Conditional Formatting - Icon Sets","confirm":"OK","cancel":"Cancel"},"m009":{"title":"New Conditional Formatting Rule","confirm":"OK","cancel":"Cancel"},"m010":{"title":"Conditional Formatting - Use Formula","confirm":"OK","cancel":"Cancel"},"m011":{"title":"Manage Conditional Formatting Rules","confirm":"Close"}},"content":{"errorPrefix":"Conditional formatting error:","modalTitle":"Conditional Formatting - {title}","setTo":"Format with:","preview":"Preview:","title":{"containsText":"Text that Contains","timePeriod":"A Date Occurring","duplicate":"Duplicate Values","dataBar":"Data Bars","colorScale":"Color Scales","iconSet":"Icon Sets","expression":"Use a Formula"},"preset":{"lightRedText":"Light Red Fill with Dark Red Text","yellowText":"Yellow Fill with Dark Yellow Text","greenText":"Green Fill with Dark Green Text","lightRed":"Light Red Fill","yellow":"Yellow Fill","green":"Green Fill"},"operator":{"greaterThan":"Greater Than","lessThan":"Less Than","between":"Between","equal":"Equal To","notEqual":"Not Equal To","greaterThanOrEqual":"Greater Than or Equal To","lessThanOrEqual":"Less Than or Equal To"},"timePeriod":{"today":"Today","yesterday":"Yesterday","tomorrow":"Tomorrow","last7Days":"Last 7 Days","lastWeek":"Last Week","thisWeek":"This Week","nextWeek":"Next Week","lastMonth":"Last Month","thisMonth":"This Month","nextMonth":"Next Month","description":"Format cells with date:"},"cellIs":{"description":"Format cells that are {title}:","value1Placeholder":"Enter value or formula","and":"and","value2Placeholder":"Enter value"},"containsText":{"description":"Format cells that contain:","placeholder":"Enter text"},"duplicate":{"description":"Format all cells with:","duplicateValues":"Duplicate Values","uniqueValues":"Unique Values"},"top10":{"descriptionPrefix":"Format cells in the {target}","min":"lowest","max":"highest","items":"items","setFormat":"with this format"},"dataBar":{"fillType":"Fill type:","gradient":"Gradient Fill","solid":"Solid Fill","barColor":"Bar color:","showValue":"Show cell values"},"colorScale":{"type":"Scale type:","twoColors":"2-Color Scale","threeColors":"3-Color Scale","minColor":"Minimum color:","midColor":"Midpoint color:","maxColor":"Maximum color:"},"iconSet":{"style":"Icon style:","reverse":"Reverse icon order","showValue":"Show cell values"},"newRule":{"selectType":"Select rule type:","cellIs":"Format only cells that contain","containsText":"Text that contains","top10":"Top/Bottom ranked values","aboveAverage":"Above/Below average","duplicateValues":"Duplicate/Unique values","dataBar":"Data Bars","colorScale":"Color Scales","iconSet":"Icon Sets","expression":"Use a formula"},"expression":{"description":"Format values where this formula is TRUE:"},"manage":{"appliesTo":"Applies to: {sqref}","delete":"Delete"},"ruleType":{"cellIs":"Cell Value","colorScale":"Color Scale","dataBar":"Data Bar","iconSet":"Icon Set","containsText":"Contains Text","duplicateValues":"Duplicate Values","uniqueValues":"Unique Values","top10":"Top/Bottom","aboveAverage":"Above/Below Average","timePeriod":"Date","expression":"Formula"}},"menu":{"group":{"highlightCellRules":"Highlight Cells Rules","topBottomRules":"Top/Bottom Rules","dataBar":"Data Bars","colorScale":"Color Scales","iconSet":"Icon Sets","clearRules":"Clear Rules"},"section":{"gradientFill":"Gradient Fill","solidFill":"Solid Fill"},"highlightRules":{"greaterThan":"Greater Than...","lessThan":"Less Than...","between":"Between...","equalTo":"Equal To...","containsText":"Text that Contains...","dateOccurring":"A Date Occurring...","duplicateValues":"Duplicate Values..."},"topRules":{"top10Items":"Top 10 Items...","bottom10Items":"Bottom 10 Items...","top10Percent":"Top 10%...","bottom10Percent":"Bottom 10%...","aboveAverage":"Above Average","belowAverage":"Below Average"},"iconSetCategory":{"direction":"Direction","shapes":"Shapes","indicators":"Indicators","rating":"Rating"},"item":{"moreRules":"More Rules...","newRule":"New Rule...","clearSelection":"Clear Rules from Selected Cells","clearSheet":"Clear Rules from Entire Sheet","manageRules":"Manage Rules..."}}},"filter":{"toast":{"msg001":"No filter is currently enabled","msg002":"Filter has been reapplied","msg003":"Please select the range to sort first"}},"format":{"toast":{"msg001":'When selecting "Other" delimiter, please enter a delimiter character',"msg002":"Please select at least one delimiter","msg003":"Please select the range to split first","msg004":"Text to Columns only supports a single-column range; please select one column","msg005":"Text to Columns does not support ranges containing merged cells","a1":"Invalid target range, please enter an address like A1","msg007":"Text to Columns was not completed","msg008":"Please select the range to fill first","msg009":"Flash Fill only supports a single-column range; please select one column","msg010":"Flash Fill does not support ranges containing merged cells","msg011":"Flash Fill was not completed","msg012":"No cells can be filled. Please enter sample values or adjust the selection","textToColumnsFailed":"Text to Columns failed","textToColumnsDone":"Text to Columns completed: {rowCount} rows, {columnCount} columns","flashFillFailed":"Flash Fill failed","flashFillDone":"Flash Fill completed: filled {filledCount} cells"},"modal":{"m001":{"title":"Text to Columns","confirm":"OK","cancel":"Cancel"},"m002":{"title":"Custom Number Format","confirm":"Apply","cancel":"Cancel"}},"content":{"textToColumns":{"delimiter":{"label":"Delimiters","tab":"Tab","semicolon":"Semicolon (;)","comma":"Comma (,)","space":"Space","other":"Other"},"otherPlaceholder":"Enter one character","mergeConsecutive":"Treat consecutive delimiters as one","textQualifierLabel":"Text qualifier","textQualifier":{"doubleQuote":'Double quote (")',"singleQuote":"Single quote (')","none":"None"},"destinationLabel":"Destination","destinationPlaceholder":"e.g. A1"},"customNumFmt":{"currentLabel":"Current format:","none":"(None)","inputLabel":"Custom format:","inputPlaceholder":"Enter format code, e.g. 0.00%","previewLabel":"Preview:","placeholdersTitle":"Common placeholders","placeholder":{"zero":"Digit, pad with 0","hash":"Digit, hide if absent","question":"Digit, pad with space","dot":"Decimal point","comma":"Thousands separator","percent":"Percent (?100)","at":"Text placeholder","year":"4-digit year","month":"Month (1-2 digits)","day":"Day (1-2 digits)","time":"Time","red":"Display in red"},"quickLabel":"Quick formats:","quick":{"integer":"Thousands integer","decimal2":"2 decimals","percent":"Percent","currency":"Currency","date":"Date","time":"Time"}}}},"formula":{"toast":{"pleaseSelectAFunction":"Please select a function"},"modal":{"m001":{"title":"Insert Function","confirm":"Insert","cancel":"Cancel"}},"content":{"searchLabel":"Search:","searchPlaceholder":"Enter function name or description","categoryLabel":"Category:","functionLabel":"Function:","empty":"No functions","noDescription":"No description available.","detail":{"category":"Category","version":"Version"},"categories":{"all":"All","recent":"Recently Used","financial":"Financial","logical":"Logical","text":"Text","datetime":"Date & Time","lookup":"Lookup & Reference","math":"Math & Trig","statistical":"Statistical","engineering":"Engineering","information":"Information","compatibility":"Compatibility","database":"Database","web":"Web","cube":"Cube","addins":"Add-ins & Automation"}}},"formulaAudit":{"toast":{"msg001":"The current cell has no formula","msg002":"The formula does not reference other cells","msg003":"No other cells reference the current cell","msg004":"No formula errors were found","recalculatedWorkbook":"Workbook recalculated ({elapsed}ms)","recalculatedSheet":"Sheet recalculated ({elapsed}ms)","switchToManual":"Switched to manual calculation mode","switchToAuto":"Switched to automatic calculation mode","showFormulas":"Formulas displayed","showCalculatedValues":"Calculated values displayed"},"modal":{"m001":{"title":"Error Checking","confirm":"Close"},"m002":{"title":"Evaluate Formula","confirm":"Close"}},"content":{"errorSummary":"Found {count} errors","evaluate":{"formulaLabel":"Formula:","referenceReplaceLabel":"Reference replacement:","noReferences":"No cell references found in formula","replacedLabel":"After replacement:","resultLabel":"Result:"}}},"insert":{"toast":{"msg001":"The selected range has no valid data","msg002":"Please select a data range first","msg003":"Sparkline module is not initialized","pleaseEnterALinkAddress":"Please enter a link address"},"modal":{"m001":{"confirm":"OK","cancel":"Cancel","titleInsert":"Insert Note","titleEdit":"Edit Note"},"m003":{"title":"Insert Sparkline","confirm":"OK","cancel":"Cancel"},"m004":{"confirm":"OK","titleInsert":"Insert Hyperlink","titleEdit":"Edit Hyperlink","cancel":"Cancel","cancelRemove":"Remove Link","label":{"displayText":"Display Text","linkType":"Link Type","address":"Address","targetLocation":"Target Location","screenTip":"ScreenTip"},"option":{"external":"External Link","internal":"Worksheet Location"},"placeholder":{"displayText":"Cell display text","address":"e.g. https://www.example.com","cell":"e.g. A1","screenTip":"Shown when hovering the link"}}},"content":{"imagePickerNotSupported":"This feature is not supported in current browser. Please use a newer Chrome or Edge browser.","imageFileDescription":"Image files","textBox":{"defaultText":"Text Box"},"sparkline":{"type":{"line":"Line","column":"Column","winLoss":"Win/Loss"},"rangeRequired":"Please enter data range","sheetNotFound":'Sheet "{name}" not found',"rangeInvalid":"Invalid data range","locationRequired":"Please enter insert location","locationSingleCell":"Insert location must be a single cell","locationInvalid":"Invalid insert location","rangeLabel":"Data Range","locationLabel":"Insert Location","typeLabel":"Sparkline Type","moduleNotReady":"Sparkline module is not initialized"},"chart":{"defaultItem":"Item {index}","defaultSeries":"Data","volume":"Volume","assist":"Assist"}}},"nameManager":{"toast":{"msg001":"Please enter a name","msg002":"Invalid name format","msg003":"Please enter a reference","msg004":"This name already exists","msg005":"No defined names are available"},"content":{"scope":{"all":"All","workbook":"Workbook"},"button":{"new":"New...","edit":"Edit...","delete":"Delete"},"filterLabel":"Filter:","column":{"name":"Name","value":"Value","ref":"Refers To","scope":"Scope","comment":"Comment"},"refLabel":"Refers To:","empty":"No defined names","form":{"nameLabel":"Name:","namePlaceholder":"Enter a name","scopeLabel":"Scope:","commentLabel":"Comment:","commentPlaceholder":"Optional","refLabel":"Refers To:","refPlaceholder":"e.g. Sheet1!$A$1:$B$10"},"deleteConfirmTitle":"Confirm Delete","deleteConfirmBody":'Delete name "{name}"?',"deleteConfirmButton":"Delete"},"modal":{"m001":{"title":"Name Manager","confirm":"Close","cancel":"Cancel"},"m002":{"confirm":"OK","cancel":"Cancel","titleCreate":"Create Name","titleEdit":"Edit Name"},"m003":{"title":"Paste Name","confirm":"Paste","cancel":"Cancel"}}},"print":{"toast":{"pleaseSelectAValidCell":"Please select a valid cell first","aPageBreakAlreadyExists":"A page break already exists at this position","pageBreakInserted":"Page break inserted","marginsUpdated":"Margins updated","pleaseEnterANumberBetween":"Please enter a number between 10 and 400","pleaseSelectAPrintArea":"Please select a print area first","printAreaSet":"Print area set","printAreaCleared":"Print area cleared"},"modal":{"m001":{"title":"Margins","confirm":"OK","cancel":"Cancel"},"m002":{"title":"Print Scale","confirm":"OK","cancel":"Cancel"},"m003":{"title":"Print Titles","confirm":"OK","cancel":"Cancel"},"m004":{"title":"Background Image","confirm":"OK","cancel":"Cancel"},"m005":{"title":"Header/Footer","confirm":"OK","cancel":"Cancel"}}},"protection":{"toast":{"msg001":"Worksheet is protected","msg002":"Cell protection updated","msg003":"Protection is not enabled on the current worksheet","msg004":"Worksheet protection has been removed","msg005":"All permissions have been reset","permissionUpdated":"Permission updated: {type} = {value}"},"modal":{"m001":{"title":"Protect Sheet","confirm":"OK","cancel":"Cancel"},"m002":{"title":"Cell Protection","confirm":"OK","cancel":"Cancel"},"m003":{"title":"Unprotect Sheet","confirm":"OK","cancel":"Cancel"}},"content":{"sheet":{"passwordLabel":"Password to unprotect sheet:","passwordPlaceholder":"Optional","allowAllUsers":"Allow all users of this worksheet to:","options":{"selectLockedCells":"Select locked cells","selectUnlockedCells":"Select unlocked cells","formatCells":"Format cells","formatColumns":"Format columns","formatRows":"Format rows","insertColumns":"Insert columns","insertRows":"Insert rows","insertHyperlinks":"Insert hyperlinks","deleteColumns":"Delete columns","deleteRows":"Delete rows","sort":"Sort","autoFilter":"Use AutoFilter","pivotTables":"Use PivotTables","objects":"Edit objects"}},"cell":{"locked":"Locked","lockedDesc":"Note: Once locked, this cell cannot be edited after worksheet protection is enabled.","hiddenFormula":"Hidden formulas","hiddenFormulaDesc":"Note: Once hidden, the formula bar shows only results after worksheet protection is enabled.","tip":'Tip: Applies to the current selection; if none is selected, applies to the active cell. "Hidden formulas" takes effect after worksheet protection is enabled.'},"unprotect":{"passwordLabel":"Password:","passwordPlaceholder":"Enter password"}}},"style":{"cellStyle":{"group":{"goodBadNeutral":"Good, Bad, and Neutral","dataAndModel":"Data and Model","titlesAndHeadings":"Titles and Headings","themedCellStyles":"Themed Cell Styles","numberFormat":"Number Format"},"item":{"good":"Good","bad":"Bad","neutral":"Neutral","calculation":"Calculation","checkCell":"Check Cell","explanatory":"Explanatory Text","input":"Input","linkedCell":"Linked Cell","note":"Note","output":"Output","warningText":"Warning Text","title":"Title","heading1":"Heading 1","heading2":"Heading 2","heading3":"Heading 3","heading4":"Heading 4","total":"Total","comma":"Comma","commaNoDecimal":"Comma [0]","currency":"Currency","currencyNoDecimal":"Currency [0]","percent":"Percent","accent1_20":"20% - Accent Text Color 1","accent2_20":"20% - Accent Text Color 2","accent3_20":"20% - Accent Text Color 3","accent4_20":"20% - Accent Text Color 4","accent5_20":"20% - Accent Text Color 5","accent6_20":"20% - Accent Text Color 6","accent1_40":"40% - Accent Text Color 1","accent2_40":"40% - Accent Text Color 2","accent3_40":"40% - Accent Text Color 3","accent4_40":"40% - Accent Text Color 4","accent5_40":"40% - Accent Text Color 5","accent6_40":"40% - Accent Text Color 6","accent1_60":"60% - Accent Text Color 1","accent2_60":"60% - Accent Text Color 2","accent3_60":"60% - Accent Text Color 3","accent4_60":"60% - Accent Text Color 4","accent5_60":"60% - Accent Text Color 5","accent6_60":"60% - Accent Text Color 6"}},"border":{"position":{"none":"No Border","all":"All Borders","outer":"Outside Borders","inner":"Inside Borders","left":"Left Border","right":"Right Border","top":"Top Border","bottom":"Bottom Border","diagonalDown":"Diagonal Down Border","diagonalUp":"Diagonal Up Border"},"menu":{"color":"Border Color","style":"Border Style"}}},"storage":{"toast":{"msg001":"Storage space is full; please clear browser data","msg002":"No saved data found","msg003":"Saved data format is invalid","msg004":"Data decompression failed","msg005":"Restore completed successfully","msg006":"Local data has been cleared","saveTooLarge":"Cannot save: data too large\nOriginal: {originalSize}\nCompressed: {compressedSize}\nLimit: {limitSize}","saveInsufficientSpace":"Insufficient storage\nNeeded: {compressedSize}\nAvailable: {available}","saveSuccess":"Saved successfully\nCompression: {ratio}%\nSize: {compressedSize}","saveFailed":"Save failed: {message}","restoreFailed":"Restore failed: {message}"},"modal":{"restore":{"title":"Restore Workbook","content":"Restore {name}\nSaved at: {time}\n\nCurrent data will be overwritten. Continue?"}}},"table":{"toast":{"pleaseSelectARangeFirst":"Please select a range first","pleaseEnterAValidRange":"Please enter a valid range reference","theSelectedRangeOverlapsAn":"The selected range overlaps an existing table","msg004":"The current cell is not inside a table","msg005":"Converted to a normal range","msg006":"Please enter a valid range reference","msg007":"Table size has been adjusted","msg008":"Please enter a valid table name","msg009":"Table has been renamed","msg010":"Table has been deleted","msg011":"Please select a range first","msg012":"Please select at least one column","msg013":"No duplicate values were found","msg014":"Please select a cell in the table first","msg015":"Please select at least one field","createFailed":"Create table failed","resizeFailed":"Resize failed","renameFailed":"Rename failed","setTotalsFunctionFailed":"Failed to set totals function","removeDuplicatesDone":"Removed {duplicateCount} duplicates, kept {uniqueCount} unique rows"},"content":{"sourceRangeLabel":"Range where your table data is located:","sourceRangePlaceholder":"e.g. A1:D20","hasHeader":"My table has headers","convertToRangeBody":"Converting this table to a range will remove table features. Continue?","resizeRangeLabel":"New table range:","resizeRangePlaceholder":"e.g. A1:D30","renameLabel":"Table name:","renamePlaceholder":"Enter table name","deleteTableBody":"Delete this table and all its data?","removeDuplicates":{"hasHeader":"My data has headers","selectColumns":"Select columns:","selectAll":"Select All","deselectAll":"Deselect All"},"insertSlicer":{"selectFields":"Select fields:"}},"modal":{"m001":{"title":"Create Table","confirm":"OK","cancel":"Cancel"},"m002":{"title":"Format as Table","confirm":"OK","cancel":"Cancel"},"m003":{"title":"Convert to Range","confirm":"OK","cancel":"Cancel"},"m004":{"title":"Resize Table","confirm":"OK","cancel":"Cancel"},"m005":{"title":"Table Styles","confirm":"OK","cancel":"Cancel"},"m006":{"title":"Rename Table","confirm":"OK","cancel":"Cancel"},"m007":{"title":"Delete Table","confirm":"Delete","cancel":"Cancel"},"m008":{"title":"Remove Duplicates","confirm":"OK","cancel":"Cancel"},"m009":{"title":"Insert Slicer","confirm":"OK","cancel":"Cancel"}}},"view":{"toast":{"pleaseEnterANumberBetween":"Please enter a number between 10 and 400","msg002":"Please select the position to freeze","msg003":"Cannot freeze at the first row","msg004":"Cannot freeze at the first column"},"modal":{"m001":{"title":"Custom Zoom","confirm":"Apply","cancel":"Cancel"}}},"workbook":{"toast":{"propertiesSaved":"Properties saved"},"properties":{"section":{"properties":"Properties","people":"People","dates":"Dates"},"label":{"title":"Title","subject":"Subject","author":"Author","manager":"Manager","company":"Company","category":"Category","keywords":"Keywords","status":"Status","template":"Template","hyperlinkBase":"Hyperlink Base","lastModifiedBy":"Last Modified By","description":"Description","created":"Created","lastModified":"Last Modified","lastPrinted":"Last Printed","size":"Size"},"placeholder":{"title":"Enter workbook title","subject":"Enter workbook subject","author":"Enter author name","manager":"Enter manager name","company":"Enter company name","category":"Enter category","keywords":"Enter keywords, separated by commas","status":"Enter document status","template":"Enter template name","hyperlinkBase":"Enter hyperlink base URL","description":"Enter workbook description"},"avatar":{"manager":"Manager","authorFallback":"Author","userFallback":"User"},"notAvailable":"N/A","fileSize":"{size} KB"},"modal":{"m003":{"title":"Workbook Info","confirm":"Save","cancel":"Cancel"}}},"rowCol":{"unit":{"row":"row(s)","col":"column(s)"},"toast":{"group":{"selectTarget":"Please select {unitLabel} to group first","maxLevelReached":"Selected {unitLabel} already reached max outline level","completedWithLimited":"Group created: {changedCount} {unitLabel} updated, {limitedCount} {unitLabel} already at max level","completed":"Group created: {changedCount} {unitLabel} updated"},"ungroup":{"selectTarget":"Please select {unitLabel} to ungroup first","noGroup":"Selected {unitLabel} has no group to ungroup","completed":"Ungroup completed: {changedCount} {unitLabel} updated"}},"content":{"insert":{"countLabel":"Count:","positionLabel":"Position:"},"insertRow":{"positionAbove":"Insert above","positionBelow":"Insert below"},"insertCol":{"positionLeft":"Insert left","positionRight":"Insert right"},"rowHeight":{"label":"Row height:"},"colWidth":{"label":"Column width:"},"defaultRowHeight":{"label":"Default row height:"},"defaultColWidth":{"label":"Default column width:"}},"modal":{"m001":{"title":"Insert Row","confirm":"Insert","cancel":"Cancel"},"m002":{"title":"Insert Column","confirm":"Insert","cancel":"Cancel"},"m003":{"title":"Set Row Height","confirm":"OK","cancel":"Cancel"},"m004":{"title":"Set Column Width","confirm":"OK","cancel":"Cancel"},"m005":{"title":"Set Default Row Height","confirm":"OK","cancel":"Cancel"},"m006":{"title":"Set Default Column Width","confirm":"OK","cancel":"Cancel"}}}},"components":{"sortDialog":{"toast":{"msg001":"Please select a data range to sort first","msg002":"The sort range contains merged cells; please unmerge first"},"content":{"title":"Sort","close":"Close","toolbar":{"add":"Add Level","delete":"Delete Level","copy":"Copy Level"},"header":{"column":"Column","sortBy":"Sort By","order":"Order"},"options":{"hasHeader":"My data has headers","caseSensitive":"Case sensitive"},"cancel":"Cancel","confirm":"OK","columnFallback":"Column {colLetter}","level":{"primary":"Sort by","secondary":"Then by","nth":"Then by ({index})"},"sortBy":{"value":"Cell Values","cellColor":"Cell Color","fontColor":"Font Color"},"customList":{"editTitle":"Edit custom list","title":"Custom Sort List","presetLabel":"Preset lists:","selectPreset":"Select preset...","customOrderLabel":"Custom order (one value per line):","placeholder":"Enter custom sort order, one value per line\nFor example:\nHigh\nMedium\nLow","cancel":"Cancel","apply":"Apply"},"order":{"customPrefix":"Custom: {preview}","customList":"Custom List...","asc":"A to Z","desc":"Z to A","top":"On Top","bottom":"On Bottom"}}}},"core":{"iO":{"csvIO":{"toast":{"csv":"CSV file is empty","csv003":"CSV import completed","importFailed":"CSV import failed: {message}"}},"iO":{"toast":{"xlsxCsvJson":"Invalid file type. Please select a .xlsx, .csv, or .json file.","xlsxCsvJson003":"Only xlsx/csv/json formats are supported","cors":"Cross-origin access was blocked. The target server does not allow cross-origin requests. Please ensure the file server is configured with CORS response headers, or use a backend proxy service to download the file.","msg005":"No images available to export","importSizeLimit":"Unlicensed version only supports importing files within 1MB. Current size: {sizeMB}MB.","importUnexpectedError":"Error: {message}","importFromUrlFailed":"Import from URL failed: {message}","exportCellLimit":"Unlicensed version only supports exporting up to 10000 cells. Current total: {totalCells} cells."}},"jsonIO":{"toast":{"son":"Invalid JSON data format or version mismatch","json":"JSON import completed","loadFailed":"Data load failed: {message}","importFailed":"JSON import failed: {message}"}}},"layout":{"layout":{"toast":{"msg001":"Pivot table data source is empty","msg002":"Pivot table has been updated"},"modal":{"m001":{"title":"Field Settings","confirm":"OK","cancel":"Cancel"},"m002":{"title":"Value Field Settings","confirm":"OK","cancel":"Cancel"}},"pivotPanel":{"fieldFallback":"Field {idx}","remove":"Remove","fieldSettings":"Field Settings"}}},"print":{"print":{"toast":{"nothingToPrint":"Nothing to print"},"modal":{"m001":{"title":"Print Preview","confirm":"Print","cancel":"Close"}}}},"sheet":{"clipboard":{"toast":{"msg001":"Cannot paste inside the cut range"}},"sheet":{"toast":{"msg001":"At least one visible worksheet must remain"}},"sheetProtection":{"prompt":{"enterPassword":"Please enter password","passwordIncorrect":"Incorrect password","advancedNotSupported":"This sheet uses advanced encryption and cannot be verified yet"},"message":{"cellProtected":"This cell is protected and cannot be edited","insertRowsDenied":"Worksheet is protected, cannot insert rows","insertColsDenied":"Worksheet is protected, cannot insert columns","deleteRowsDenied":"Worksheet is protected, cannot delete rows","deleteColsDenied":"Worksheet is protected, cannot delete columns","mergeDenied":"Worksheet is protected, cannot merge cells","unmergeDenied":"Worksheet is protected, cannot unmerge cells","styleDenied":"Worksheet is protected, cannot change cell format","rowResizeDenied":"Worksheet is protected, cannot change row height","rowHideDenied":"Worksheet is protected, cannot hide rows","rowUnhideDenied":"Worksheet is protected, cannot unhide rows","colResizeDenied":"Worksheet is protected, cannot change column width","colHideDenied":"Worksheet is protected, cannot hide columns","colUnhideDenied":"Worksheet is protected, cannot unhide columns","hyperlinkDenied":"Worksheet is protected, cannot insert hyperlinks","sortDenied":"Worksheet is protected, cannot sort","autoFilterDenied":"Worksheet is protected, cannot use AutoFilter","pivotDenied":"Worksheet is protected, cannot modify PivotTable","addObjectDenied":"Worksheet is protected, cannot add objects","removeObjectDenied":"Worksheet is protected, cannot delete objects","selectionBlocked":"Worksheet is protected, selection is disabled","cannotSelectLocked":"Cannot select locked cells","cannotSelectUnlocked":"Cannot select unlocked cells"}}},"utils":{"sortUtils":{"toast":{"msg001":"The sort range contains merged cells. Please unmerge first."}},"utils":{"toast":{"imageDownloadFailed":"Image download failed: {message}"}}},"drawing":{"drawing":{"toast":{"unsupportedType":"Create drawing failed: unsupported type {type}","createFailedByType":"Create {label} failed: {error}"}}},"autoFilter":{"autoFilter":{"blank":"(Blanks)"}},"canvas":{"canvas":{"areaDropdown":{"empty":"No defined names"}},"pivotTableRenderer":{"placeholder":{"generateFrom":"To build a report, choose fields from","selectFields":"the PivotTable Fields list","clickToUse":"Click inside this area to use PivotTable"}}}}}));class xV{static Nx=0;static Fx=!1;static registerLocale(t,e){return bV(t,e),xV}static getLocale(t){return function(t){const e=yV.get(t);return e?gV(e):void 0}(t)}constructor(t,e={}){if(xV._x(),!(t instanceof HTMLElement))throw new Error("Please pass in the correct DOM!");t.style.boxSizing="border-box",t.style.background="#eef0f2",this.containerDom=t,this.namespace=this.Ex(),t.__sheetNextInstance=this,this.calcMode="auto",this.sheets=[],this.properties={},this.Event=new vt,this.License=new ZP(this,e.licenseKey),this.Utils=new gE(this),this.I18n=this.Ix(e),this.Print=new GP(this),this.Action=new PP(this),this.Layout=new XD(this,e),this.AI=new YP(this,e),this.Xml=new DD(this),this.IO=new cV(this),this.Formula=new $E(this),this.DependencyGraph=new JP(this),this.UndoRedo=new vE(this),this.Canvas=new mE(this),this.zx=!1,this.Dx=null,this.et={},this.lx=this.t("workbook.defaultName"),this.o=null,this.yn={},this.Mr=new Map,this.zi=new Map,this.Lx=[],this.Ox=!1,this.$x()}get activeSheet(){return this.Dx}set activeSheet(t){const e=this.Dx;if(e!==t){if(this.Event.hasListeners("beforeActiveSheetChange")&&this.Event.emit("beforeActiveSheetChange",{oldSheet:e,newSheet:t}).canceled)return;t.J(),this.Dx=t,this.Co(),this.Canvas.applyZoom(),this.xo(),this.ue(),this.Event.hasListeners("afterActiveSheetChange")&&this.Event.emit("afterActiveSheetChange",{oldSheet:e,newSheet:t})}}get workbookName(){return this.lx}set workbookName(t){if("string"!=typeof t)return this.Utils.toast(this.t("workbook.errors.nameMustBeString"));if(""===(t=t.trim()))return this.Utils.toast(this.t("workbook.errors.nameCannotBeEmpty"));if(t.length>255)return this.Utils.toast(this.t("workbook.errors.nameTooLong"));if(/[\\\/:\*\?"<>\|]/.test(t))return this.Utils.toast(this.t("workbook.errors.nameInvalidChars"));const e=this.lx;if(e===t)return;if(this.Event.hasListeners("beforeWorkbookRename")&&this.Event.emit("beforeWorkbookRename",{oldName:e,newName:t}).canceled)return;this.lx=t;const n=this.containerDom.querySelector(".sn-file-name");n&&(n.innerHTML=t),this.Event.hasListeners("afterWorkbookRename")&&this.Event.emit("afterWorkbookRename",{oldName:e,newName:t})}get readOnly(){return this.zx}set readOnly(t){this.zx=!!t,this.Layout?.StateSync?.notify("readOnly",this.zx)}addSheet(t){if(t){if("string"!=typeof t||""===t.trim())return this.Utils.toast(this.t("workbook.errors.sheetNameInvalidType"));if(this.Ax.some(e=>e.toLowerCase()===t.toLowerCase()))return this.Utils.toast(this.t("workbook.errors.sheetNameExists",{name:t}));if(t.length>31)return this.Utils.toast(this.t("workbook.errors.sheetNameLength"));if(/[:\/\\\*\?\[\]]/.test(t))return this.Utils.toast(this.t("workbook.errors.sheetNameInvalidChars"))}else{let e=1;for(;this.Ax.some(t=>t.toLowerCase()===`sheet${e}`.toLowerCase());)e++;t=`Sheet${e}`}if(this.Event.hasListeners("beforeSheetAdd")&&this.Event.emit("beforeSheetAdd",{name:t}).canceled)return null;const e=new hi({_$name:t},this);return e.J(),this.sheets.push(e),this.Co(),this.Event.hasListeners("afterSheetAdd")&&this.Event.emit("afterSheetAdd",{sheet:e,name:t}),e}delSheet(t){if(0==this.sheets.filter(e=>!e.hidden&&e.name!=t).length)return this.Utils.toast(this.t("workbook.errors.lastVisibleSheetCannotDelete"));const e=this.sheets.findIndex(e=>e.name==t);if(-1===e)return this.Utils.toast(this.t("workbook.errors.sheetNotFound",{name:t}));const n=this.sheets[e];this.Event.hasListeners("beforeSheetDelete")&&this.Event.emit("beforeSheetDelete",{sheet:n,name:t,index:e}).canceled||(this.sheets.splice(e,1),this.activeSheet.name==t&&(this.activeSheet=this.sheets.find(t=>!t.hidden)),this.Co(),this.Event.hasListeners("afterSheetDelete")&&this.Event.emit("afterSheetDelete",{sheet:n,name:t,index:e}))}getSheet(t){return this.sheets.find(e=>e.name==t)||null}recalculate(t=!1){if(this.DependencyGraph){if(t){const t=this.activeSheet;if(!t)return;for(let e=0;e<t.rowCount;e++){const n=t.rows[e];if(n)for(let t=0;t<n.cells.length;t++){const e=n.cells[t];e&&e.isFormula&&(e.H=void 0,e.U=void 0,e.K=void 0)}}this.DependencyGraph.rebuildForSheet(t)}else{this.DependencyGraph.recalculateVolatile();for(const t of this.sheets)if(t.initialized)for(let e=0;e<t.rowCount;e++){const n=t.rows[e];if(n)for(let t=0;t<n.cells.length;t++){const e=n.cells[t];e&&e.isFormula&&(e.H=void 0,e.U=void 0,e.K=void 0,e.calcVal)}}}this.ue()}}get Ax(){return this.sheets.map(t=>t.name)}get Px(){return this.Lx[this.Lx.length-1]||null}setLocale(t){this.I18n.setLocale(t),this.Layout?.refreshToolbar?.(),this.xo()}get locale(){return this.I18n.locale}t(t,e={}){return this.I18n.t(t,e)}Ix(t={}){const e=new pV(t.locale||"en-US","en-US"),n=function(){const t={};for(const[e,n]of yV.entries())t[e]=gV(n);return t}();for(const[i,r]of Object.entries(n))e.register(i,r);if(t.locales&&"object"==typeof t.locales)for(const[i,r]of Object.entries(t.locales))e.register(i,r);return e}static _x(){if(xV.Fx)return;xV.Fx=!0;const t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:null;if(!t)return;const e=t.__SHEETNEXT_PENDING_LOCALES__;if(e&&"object"==typeof e){for(const[t,n]of Object.entries(e))bV(t,n);delete t.__SHEETNEXT_PENDING_LOCALES__}}Ex(){const t="SN_"+xV.Nx++;return window[t]=this,t}$x(){this.Xml.obj=new Proxy(this.Xml.obj,{get:(t,e)=>t[e]?.Ln&&(e.endsWith(".xml")||e.endsWith(".rels"))?t[e]=DD.parser.parse(t[e].asText()):t[e]}),this.Vx(),this.Bx(),this.sheets=this.Xml.sheets.map(t=>new hi(t,this)),this.Mr=new Map,function(t,e){t.Mr||(t.Mr=new Map);const n=e.relationship;if(!n)return;const i=n.filter(t=>t._$Type&&t._$Type.includes("pivotCacheDefinition"));for(const r of i)try{const n=`xl/${r._$Target}`,i=e.obj[n];if(!i)continue;const o=e.getRelsByTarget(r._$Target);let a=null;if(o){const t=o.find(t=>t._$Type&&t._$Type.includes("pivotCacheRecords"));if(t){const i=Dn(n,t._$Target);a=e.obj[i]?.pivotCacheRecords}}const s=i.pivotCacheDefinition,l=Mn.fromXml(t,s,a),c=En(t,e,r._$Id);l.cacheId=c,t.Mr.set(c,l)}catch(t){}t.sheets.forEach((n,i)=>{const r=e.lo?.(n.rId)??`sheet${i+1}.xml`,o=e.getRelsByTarget(`worksheets/${r}`);if(!o)return;const a=o.filter(t=>t._$Type&&t._$Type.includes("pivotTable"));for(const s of a)try{const i=Dn(`xl/worksheets/${r}`,s._$Target),o=e.obj[i];if(!o)continue;const a=o.pivotTableDefinition;if(!a)continue;const l=Number(a._$cacheId),c=t.Mr.get(l),h=_n.fromXml(n,a,c);Fn(n).yr(h)}catch(t){}})}(this,this.Xml),function(t,e){const n=e.obj["xl/snSlicers.xml"]?.["sn:slicers"];t.zi||(t.zi=new Map),t.zi.clear(),t.so=[],n&&(un(n["sn:caches"]?.["sn:cache"]).forEach(e=>{const n=new nn(t,{cacheId:Number(e?._$id),sourceType:e?._$type,sourceSheet:e?._$sheet,sourceName:e?._$name,fieldIndex:Number(e?._$fieldIndex??0),fieldName:e?._$fieldName??""}),i=function(t){const e=t?.["sn:items"]?.["sn:item"],n=[];return un(e).forEach(t=>{const e=t?._$key;if(!e)return;const i=function(t){if(!t||t.length<2)return null;const e=t[0],n=t.slice(2);switch(e){case"m":return null;case"n":{const t=Number(n);return Number.isNaN(t)?null:t}case"b":return"1"===n;case"d":return n?new Date(n):null;default:return n}}(e);n.push({key:e,value:i,text:t?._$text??en(i),count:Number(t?._$count??0)})}),n}(e);n.items=i,n._i=new Map(i.map(t=>[t.key,t])),n.Ii=!1,n.Ei=1,t.zi.set(n.cacheId,n)}),t.so=un(n["sn:slicer"])),function(t,e){const n=e.obj["xl/workbook.xml"]?.workbook,i=un(n?.extLst?.ext),r=[];i.forEach(t=>{const e=t?.["x15:slicerCaches"];e&&un(e?.["x14:slicerCache"]).forEach(t=>{const e=t?.["_$r:id"];e&&r.push(e)})});const o=un(e.relationship),a=t.zi?Array.from(t.zi.keys()):[];let s=Math.max(0,...a)+1;t.oo=new Map,r.forEach(n=>{const i=o.find(t=>t?._$Id===n),r=function(t){return t?t.startsWith("xl/")?t:t.startsWith("../")?`xl/${t.substring(3)}`:`xl/${t}`:null}(i?._$Target),a=r?e.obj[r]?.slicerCacheDefinition:null;if(!a)return;let l=null;const c=un(a?.extLst?.["x:ext"]);for(const t of c)if(t?.["x15:tableSlicerCache"]){l=t["x15:tableSlicerCache"];break}const h=a?._$name||a?._$sourceName||n;t.oo.set(h,{cacheId:s++,cacheName:h,sourceName:a?._$sourceName||"",tableId:dn(l?._$tableId,NaN),column:dn(l?._$column,NaN)})})}(t,e)}(this,this.Xml);const t=this.Xml.obj["xl/workbook.xml"].workbook?.bookViews?.workbookView?._$activeTab??0;this.activeSheet=this.sheets[t]}Vx(){const t=this.Xml.obj,e=t["docProps/core.xml"]?.["cp:coreProperties"]||{},n=t["docProps/app.xml"]?.Properties||{},i=t=>t?"string"==typeof t?t:t["#text"]||"":"";this.properties={title:e["dc:title"]||"",subject:e["dc:subject"]||"",creator:e["dc:creator"]||"",keywords:e["cp:keywords"]||"",description:e["dc:description"]||"",lastModifiedBy:e["cp:lastModifiedBy"]||"",created:i(e["dcterms:created"]),modified:i(e["dcterms:modified"]),category:e["cp:category"]||"",contentStatus:e["cp:contentStatus"]||"",revision:e["cp:revision"]||"",language:e["dc:language"]||"",lastPrinted:i(e["cp:lastPrinted"]),application:n.Application||"",appVersion:n.AppVersion||"",company:n.Company||"",manager:n.Manager||"",hyperlinkBase:n.HyperlinkBase||"",template:n.Template||""}}Bx(){const t=this.Xml.obj["xl/workbook.xml"].workbook?.definedNames?.definedName,e=Array.isArray(t)?t:t?[t]:[],n={};e.forEach(t=>{const e=t?._$name,i=t?.["#text"];e&&"string"==typeof i&&(n[e]=i)}),this.yn=n}Co(){const t=this.namespace,e=this.activeSheet.name;let n="";this.sheets.forEach((i,r)=>{i.name==e||1==this.Ax.length?n+=`<button class="sheet-sel sn-sheet-item" onmousedown="this.classList.add('sheet-sel')" ontouchstart="this.classList.add('sheet-sel')">${i.name}</button>`:i.hidden||(n+=`<button class="sn-sheet-item" onmousedown="${t}.activeSheet=${t}.getSheet('${i.name}');this.classList.add('sheet-sel')" ontouchstart="${t}.activeSheet=${t}.getSheet('${i.name}');this.classList.add('sheet-sel')">${i.name}</button>`)});const i=this.containerDom.querySelector(".sn-sheet-scroll");i?i.innerHTML=n:this.containerDom.querySelector(".sn-sheet-list").innerHTML=`<div class="sn-sheet-scroll">${n}</div>`}ue(){this.Canvas.r()}xo(){const t=this.containerDom.querySelector(".sn-zoom-val");if(!t)return;const e=this.activeSheet?.zoom??1,n=Math.round(100*e);if("INPUT"!==t.tagName)t.textContent=`${n}%`;else{if(document.activeElement===t)return;t.value=n}}Hx(t=!0){return this.Ox=!!t,this}Ux(t,e={},n={}){const i=this.Px,r=n.trackChanges??(this.Ox||this.Event.hasListeners("afterOperation")||this.Event.hasListeners(`afterOperation:${t}`)),o=new dV(t,e,{parentId:i?.id??null,trackChanges:r}),a=this.Event.emit("beforeOperation",{operation:o,...e}),s=this.Event.emit(`beforeOperation:${t}`,{operation:o,...e});return!1!==n.cancelable&&(a.canceled||s.canceled)?null:(this.Lx.push(o),o)}Kx(t,e={}){if(!t)return null;if(this.Px===t)this.Lx.pop();else{const e=this.Lx.lastIndexOf(t);-1!==e&&this.Lx.splice(e,1)}t.end();const n={operation:t,changes:t.changes,summary:t.changes?.summary},i=this.Event.emitAsync("afterOperation",n),r=this.Event.emitAsync(`afterOperation:${t.type}`,n);return e.await?Promise.all([i,r]).then(()=>t):t}st(t,e,n,i={}){const r=this.Px,o=!1!==i.joinParent;if(r&&o)return n(r);const a=this.Ux(t,e,i);if(a)try{return n(a)}finally{this.Kx(a,i)}}ht(t){const e=this.Px;e&&e.changes&&e.addChange(t)}}return xV._x(),window.SheetNext=xV,xV.Enum=mt,xV});